Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.2577648162841797
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.394 Vali Acc: 0.048 Test Loss: 3.394 Test Acc: 0.048
Validation loss decreased (inf --> -0.048201).  Saving model ...
Epoch: 2 cost time: 0.5731027126312256
Epoch: 2, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.412 Vali Acc: 0.109 Test Loss: 3.412 Test Acc: 0.109
Validation loss decreased (-0.048201 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 0.5174682140350342
Epoch: 3, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.262 Vali Acc: 0.180 Test Loss: 3.262 Test Acc: 0.180
Validation loss decreased (-0.109378 --> -0.179967).  Saving model ...
Epoch: 4 cost time: 0.5321736335754395
Epoch: 4, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.437 Vali Acc: 0.188 Test Loss: 3.437 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188201).  Saving model ...
Epoch: 5 cost time: 0.5371260643005371
Epoch: 5, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.642 Vali Acc: 0.211 Test Loss: 3.642 Test Acc: 0.211
Validation loss decreased (-0.188201 --> -0.210552).  Saving model ...
Epoch: 6 cost time: 0.5083558559417725
Epoch: 6, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.943 Vali Acc: 0.211 Test Loss: 3.943 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.532583475112915
Epoch: 7, Steps: 10 | Train Loss: 0.267 Vali Loss: 4.281 Vali Acc: 0.226 Test Loss: 4.281 Test Acc: 0.226
Validation loss decreased (-0.210552 --> -0.225840).  Saving model ...
Epoch: 8 cost time: 0.5407109260559082
Epoch: 8, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.519 Vali Acc: 0.202 Test Loss: 4.519 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.529444694519043
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.648 Vali Acc: 0.256 Test Loss: 4.648 Test Acc: 0.256
Validation loss decreased (-0.225840 --> -0.256424).  Saving model ...
Epoch: 10 cost time: 0.5867917537689209
Epoch: 10, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.950 Vali Acc: 0.261 Test Loss: 4.950 Test Acc: 0.261
Validation loss decreased (-0.256424 --> -0.261127).  Saving model ...
Epoch: 11 cost time: 0.4710524082183838
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.169 Vali Acc: 0.260 Test Loss: 5.169 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5220179557800293
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.509 Vali Acc: 0.248 Test Loss: 5.509 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5212357044219971
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.527 Vali Acc: 0.254 Test Loss: 5.527 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5800492763519287
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.548 Vali Acc: 0.259 Test Loss: 5.548 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.48397374153137207
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.521 Vali Acc: 0.256 Test Loss: 5.521 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5370631217956543
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.510 Vali Acc: 0.261 Test Loss: 5.510 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5226268768310547
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.535 Vali Acc: 0.258 Test Loss: 5.535 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5458269119262695
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.259 Test Loss: 5.547 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.48044872283935547
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.554 Vali Acc: 0.266 Test Loss: 5.554 Test Acc: 0.266
Validation loss decreased (-0.261127 --> -0.265827).  Saving model ...
Epoch: 20 cost time: 0.507512092590332
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.552 Vali Acc: 0.267 Test Loss: 5.552 Test Acc: 0.267
Validation loss decreased (-0.265827 --> -0.267003).  Saving model ...
Epoch: 21 cost time: 0.49245738983154297
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.570 Vali Acc: 0.268 Test Loss: 5.570 Test Acc: 0.268
Validation loss decreased (-0.267003 --> -0.268180).  Saving model ...
Epoch: 22 cost time: 0.4966297149658203
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.571 Vali Acc: 0.267 Test Loss: 5.571 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4741346836090088
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.590 Vali Acc: 0.268 Test Loss: 5.590 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.48307204246520996
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.608 Vali Acc: 0.271 Test Loss: 5.608 Test Acc: 0.271
Validation loss decreased (-0.268180 --> -0.270532).  Saving model ...
Epoch: 25 cost time: 0.6177070140838623
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.612 Vali Acc: 0.269 Test Loss: 5.612 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5387265682220459
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.604 Vali Acc: 0.267 Test Loss: 5.604 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4602081775665283
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.622 Vali Acc: 0.268 Test Loss: 5.622 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5438632965087891
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.636 Vali Acc: 0.271 Test Loss: 5.636 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.609464168548584
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.664 Vali Acc: 0.272 Test Loss: 5.664 Test Acc: 0.272
Validation loss decreased (-0.270532 --> -0.271708).  Saving model ...
Epoch: 30 cost time: 0.6190700531005859
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.675 Vali Acc: 0.272 Test Loss: 5.675 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.49184083938598633
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.684 Vali Acc: 0.269 Test Loss: 5.684 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5942540168762207
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.685 Vali Acc: 0.272 Test Loss: 5.685 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5809638500213623
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.687 Vali Acc: 0.274 Test Loss: 5.687 Test Acc: 0.274
Validation loss decreased (-0.271708 --> -0.274061).  Saving model ...
Epoch: 34 cost time: 0.510082483291626
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.712 Vali Acc: 0.274 Test Loss: 5.712 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5863168239593506
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.711 Vali Acc: 0.274 Test Loss: 5.711 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5914626121520996
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.721 Vali Acc: 0.275 Test Loss: 5.721 Test Acc: 0.275
Validation loss decreased (-0.274061 --> -0.275237).  Saving model ...
Epoch: 37 cost time: 0.5881197452545166
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.743 Vali Acc: 0.274 Test Loss: 5.743 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5164711475372314
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.753 Vali Acc: 0.274 Test Loss: 5.753 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5910744667053223
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.746 Vali Acc: 0.275 Test Loss: 5.746 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5385613441467285
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.757 Vali Acc: 0.274 Test Loss: 5.757 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5440998077392578
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.785 Vali Acc: 0.274 Test Loss: 5.785 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5443878173828125
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.799 Vali Acc: 0.274 Test Loss: 5.799 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4899606704711914
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.803 Vali Acc: 0.274 Test Loss: 5.803 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5156731605529785
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.821 Vali Acc: 0.275 Test Loss: 5.821 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4877018928527832
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.815 Vali Acc: 0.274 Test Loss: 5.815 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4832782745361328
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.833 Vali Acc: 0.275 Test Loss: 5.833 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1157018
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.2170634269714355
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.354 Vali Acc: 0.034 Test Loss: 3.354 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4512941837310791
Epoch: 2, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.437 Vali Acc: 0.072 Test Loss: 3.437 Test Acc: 0.072
Validation loss decreased (-0.034084 --> -0.071730).  Saving model ...
Epoch: 3 cost time: 0.5600736141204834
Epoch: 3, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.277 Vali Acc: 0.136 Test Loss: 3.277 Test Acc: 0.136
Validation loss decreased (-0.071730 --> -0.136438).  Saving model ...
Epoch: 4 cost time: 0.4526207447052002
Epoch: 4, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.270 Vali Acc: 0.140 Test Loss: 3.270 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139967).  Saving model ...
Epoch: 5 cost time: 0.45148205757141113
Epoch: 5, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.367 Vali Acc: 0.188 Test Loss: 3.367 Test Acc: 0.188
Validation loss decreased (-0.139967 --> -0.188202).  Saving model ...
Epoch: 6 cost time: 0.5942666530609131
Epoch: 6, Steps: 10 | Train Loss: 1.057 Vali Loss: 3.458 Vali Acc: 0.209 Test Loss: 3.458 Test Acc: 0.209
Validation loss decreased (-0.188202 --> -0.209377).  Saving model ...
Epoch: 7 cost time: 0.5299293994903564
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.544 Vali Acc: 0.225 Test Loss: 3.544 Test Acc: 0.225
Validation loss decreased (-0.209377 --> -0.224670).  Saving model ...
Epoch: 8 cost time: 0.5809588432312012
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.714 Vali Acc: 0.247 Test Loss: 3.714 Test Acc: 0.247
Validation loss decreased (-0.224670 --> -0.247022).  Saving model ...
Epoch: 9 cost time: 0.486346960067749
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.906 Vali Acc: 0.226 Test Loss: 3.906 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6269171237945557
Epoch: 10, Steps: 10 | Train Loss: 0.184 Vali Loss: 4.138 Vali Acc: 0.240 Test Loss: 4.138 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5366668701171875
Epoch: 11, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.251 Vali Acc: 0.251 Test Loss: 4.251 Test Acc: 0.251
Validation loss decreased (-0.247022 --> -0.250546).  Saving model ...
Epoch: 12 cost time: 0.49506521224975586
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.425 Vali Acc: 0.252 Test Loss: 4.425 Test Acc: 0.252
Validation loss decreased (-0.250546 --> -0.251720).  Saving model ...
Epoch: 13 cost time: 0.4984891414642334
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.513 Vali Acc: 0.268 Test Loss: 4.513 Test Acc: 0.268
Validation loss decreased (-0.251720 --> -0.268190).  Saving model ...
Epoch: 14 cost time: 0.6359481811523438
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.597 Vali Acc: 0.267 Test Loss: 4.597 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5492465496063232
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.815 Vali Acc: 0.256 Test Loss: 4.815 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.45073628425598145
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.784 Vali Acc: 0.261 Test Loss: 4.784 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5570271015167236
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.766 Vali Acc: 0.265 Test Loss: 4.766 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5202085971832275
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.819 Vali Acc: 0.265 Test Loss: 4.819 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4927239418029785
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.844 Vali Acc: 0.262 Test Loss: 4.844 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5013980865478516
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.887 Vali Acc: 0.261 Test Loss: 4.887 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.587414026260376
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.900 Vali Acc: 0.264 Test Loss: 4.900 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5892853736877441
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.912 Vali Acc: 0.267 Test Loss: 4.912 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6094844341278076
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.932 Vali Acc: 0.269 Test Loss: 4.932 Test Acc: 0.269
Validation loss decreased (-0.268190 --> -0.269362).  Saving model ...
Epoch: 24 cost time: 0.47948122024536133
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.929 Vali Acc: 0.268 Test Loss: 4.929 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46111369132995605
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.954 Vali Acc: 0.272 Test Loss: 4.954 Test Acc: 0.272
Validation loss decreased (-0.269362 --> -0.271715).  Saving model ...
Epoch: 26 cost time: 0.4986300468444824
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.991 Vali Acc: 0.268 Test Loss: 4.991 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5066008567810059
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.013 Vali Acc: 0.265 Test Loss: 5.013 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.539179801940918
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.015 Vali Acc: 0.267 Test Loss: 5.015 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5203855037689209
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.029 Vali Acc: 0.271 Test Loss: 5.029 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5627248287200928
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.041 Vali Acc: 0.268 Test Loss: 5.041 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4945485591888428
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.057 Vali Acc: 0.275 Test Loss: 5.057 Test Acc: 0.275
Validation loss decreased (-0.271715 --> -0.275244).  Saving model ...
Epoch: 32 cost time: 0.5964720249176025
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.076 Vali Acc: 0.271 Test Loss: 5.076 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.48372840881347656
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.098 Vali Acc: 0.272 Test Loss: 5.098 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5377383232116699
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.117 Vali Acc: 0.268 Test Loss: 5.117 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.49714088439941406
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.129 Vali Acc: 0.266 Test Loss: 5.129 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5236706733703613
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.133 Vali Acc: 0.269 Test Loss: 5.133 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5600597858428955
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.157 Vali Acc: 0.273 Test Loss: 5.157 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.45453310012817383
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.170 Vali Acc: 0.273 Test Loss: 5.170 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5461463928222656
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.182 Vali Acc: 0.272 Test Loss: 5.182 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.44887256622314453
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.179 Vali Acc: 0.271 Test Loss: 5.179 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4923233985900879
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.192 Vali Acc: 0.271 Test Loss: 5.192 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 778138
model size : 5.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3160784244537354
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.347 Vali Acc: 0.036 Test Loss: 3.347 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5359237194061279
Epoch: 2, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.368 Vali Acc: 0.074 Test Loss: 3.368 Test Acc: 0.074
Validation loss decreased (-0.036437 --> -0.074084).  Saving model ...
Epoch: 3 cost time: 0.5169978141784668
Epoch: 3, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.365 Vali Acc: 0.111 Test Loss: 3.365 Test Acc: 0.111
Validation loss decreased (-0.074084 --> -0.110555).  Saving model ...
Epoch: 4 cost time: 0.5081000328063965
Epoch: 4, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.314 Vali Acc: 0.128 Test Loss: 3.314 Test Acc: 0.128
Validation loss decreased (-0.110555 --> -0.128202).  Saving model ...
Epoch: 5 cost time: 0.493152379989624
Epoch: 5, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.279 Vali Acc: 0.154 Test Loss: 3.279 Test Acc: 0.154
Validation loss decreased (-0.128202 --> -0.154085).  Saving model ...
Epoch: 6 cost time: 0.5117535591125488
Epoch: 6, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.322 Vali Acc: 0.173 Test Loss: 3.322 Test Acc: 0.173
Validation loss decreased (-0.154085 --> -0.172908).  Saving model ...
Epoch: 7 cost time: 0.5034959316253662
Epoch: 7, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.401 Vali Acc: 0.180 Test Loss: 3.401 Test Acc: 0.180
Validation loss decreased (-0.172908 --> -0.179966).  Saving model ...
Epoch: 8 cost time: 0.4900064468383789
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.484 Vali Acc: 0.218 Test Loss: 3.484 Test Acc: 0.218
Validation loss decreased (-0.179966 --> -0.217612).  Saving model ...
Epoch: 9 cost time: 0.5352153778076172
Epoch: 9, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.605 Vali Acc: 0.228 Test Loss: 3.605 Test Acc: 0.228
Validation loss decreased (-0.217612 --> -0.228199).  Saving model ...
Epoch: 10 cost time: 0.4901096820831299
Epoch: 10, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.730 Vali Acc: 0.238 Test Loss: 3.730 Test Acc: 0.238
Validation loss decreased (-0.228199 --> -0.237610).  Saving model ...
Epoch: 11 cost time: 0.5079259872436523
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.835 Vali Acc: 0.251 Test Loss: 3.835 Test Acc: 0.251
Validation loss decreased (-0.237610 --> -0.250550).  Saving model ...
Epoch: 12 cost time: 0.5264534950256348
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.002 Vali Acc: 0.240 Test Loss: 4.002 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.533458948135376
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.169 Vali Acc: 0.233 Test Loss: 4.169 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5039598941802979
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.293 Vali Acc: 0.234 Test Loss: 4.293 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4938807487487793
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.319 Vali Acc: 0.251 Test Loss: 4.319 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5370562076568604
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.419 Vali Acc: 0.258 Test Loss: 4.419 Test Acc: 0.258
Validation loss decreased (-0.250550 --> -0.257603).  Saving model ...
Epoch: 17 cost time: 0.5097236633300781
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.463 Vali Acc: 0.247 Test Loss: 4.463 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4849703311920166
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.532 Vali Acc: 0.242 Test Loss: 4.532 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5469522476196289
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.560 Vali Acc: 0.253 Test Loss: 4.560 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4994816780090332
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.579 Vali Acc: 0.254 Test Loss: 4.579 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.46539759635925293
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.615 Vali Acc: 0.253 Test Loss: 4.615 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5706477165222168
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.646 Vali Acc: 0.255 Test Loss: 4.646 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.49388980865478516
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.677 Vali Acc: 0.258 Test Loss: 4.677 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5183677673339844
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.703 Vali Acc: 0.255 Test Loss: 4.703 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.506462812423706
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.752 Vali Acc: 0.251 Test Loss: 4.752 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5570383071899414
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.763 Vali Acc: 0.251 Test Loss: 4.763 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 648858
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3661112785339355
Epoch: 1, Steps: 10 | Train Loss: 3.470 Vali Loss: 3.317 Vali Acc: 0.042 Test Loss: 3.317 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.4997544288635254
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.337 Vali Acc: 0.064 Test Loss: 3.337 Test Acc: 0.064
Validation loss decreased (-0.042320 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.4831364154815674
Epoch: 3, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.363 Vali Acc: 0.106 Test Loss: 3.363 Test Acc: 0.106
Validation loss decreased (-0.063496 --> -0.105849).  Saving model ...
Epoch: 4 cost time: 0.5198471546173096
Epoch: 4, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.289 Vali Acc: 0.134 Test Loss: 3.289 Test Acc: 0.134
Validation loss decreased (-0.105849 --> -0.134085).  Saving model ...
Epoch: 5 cost time: 0.46501803398132324
Epoch: 5, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.237 Vali Acc: 0.139 Test Loss: 3.237 Test Acc: 0.139
Validation loss decreased (-0.134085 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.5050098896026611
Epoch: 6, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.249 Vali Acc: 0.174 Test Loss: 3.249 Test Acc: 0.174
Validation loss decreased (-0.138791 --> -0.174085).  Saving model ...
Epoch: 7 cost time: 0.5189871788024902
Epoch: 7, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.306 Vali Acc: 0.185 Test Loss: 3.306 Test Acc: 0.185
Validation loss decreased (-0.174085 --> -0.184673).  Saving model ...
Epoch: 8 cost time: 0.43735265731811523
Epoch: 8, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.331 Vali Acc: 0.209 Test Loss: 3.331 Test Acc: 0.209
Validation loss decreased (-0.184673 --> -0.209378).  Saving model ...
Epoch: 9 cost time: 0.5055623054504395
Epoch: 9, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.460 Vali Acc: 0.222 Test Loss: 3.460 Test Acc: 0.222
Validation loss decreased (-0.209378 --> -0.222318).  Saving model ...
Epoch: 10 cost time: 0.5032970905303955
Epoch: 10, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.560 Vali Acc: 0.231 Test Loss: 3.560 Test Acc: 0.231
Validation loss decreased (-0.222318 --> -0.230553).  Saving model ...
Epoch: 11 cost time: 0.5153059959411621
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.623 Vali Acc: 0.245 Test Loss: 3.623 Test Acc: 0.245
Validation loss decreased (-0.230553 --> -0.244670).  Saving model ...
Epoch: 12 cost time: 0.4827091693878174
Epoch: 12, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.758 Vali Acc: 0.239 Test Loss: 3.758 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4520139694213867
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.875 Vali Acc: 0.240 Test Loss: 3.875 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.47164034843444824
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.065 Vali Acc: 0.249 Test Loss: 4.065 Test Acc: 0.249
Validation loss decreased (-0.244670 --> -0.249371).  Saving model ...
Epoch: 15 cost time: 0.5030670166015625
Epoch: 15, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.187 Vali Acc: 0.234 Test Loss: 4.187 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5127701759338379
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.250 Vali Acc: 0.254 Test Loss: 4.250 Test Acc: 0.254
Validation loss decreased (-0.249371 --> -0.254075).  Saving model ...
Epoch: 17 cost time: 0.49417901039123535
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.356 Vali Acc: 0.247 Test Loss: 4.356 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5076844692230225
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.375 Vali Acc: 0.251 Test Loss: 4.375 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4646310806274414
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.401 Vali Acc: 0.254 Test Loss: 4.401 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.435776948928833
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.433 Vali Acc: 0.256 Test Loss: 4.433 Test Acc: 0.256
Validation loss decreased (-0.254075 --> -0.256426).  Saving model ...
Epoch: 21 cost time: 0.5003647804260254
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.504 Vali Acc: 0.252 Test Loss: 4.504 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5050051212310791
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.561 Vali Acc: 0.252 Test Loss: 4.561 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4822084903717041
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.565 Vali Acc: 0.252 Test Loss: 4.565 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.496659517288208
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.580 Vali Acc: 0.256 Test Loss: 4.580 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4733455181121826
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.616 Vali Acc: 0.256 Test Loss: 4.616 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.47164225578308105
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.650 Vali Acc: 0.255 Test Loss: 4.650 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5187482833862305
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.662 Vali Acc: 0.256 Test Loss: 4.662 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.49398040771484375
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.695 Vali Acc: 0.253 Test Loss: 4.695 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5141263008117676
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.719 Vali Acc: 0.254 Test Loss: 4.719 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.45700645446777344
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.745 Vali Acc: 0.255 Test Loss: 4.745 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 589466
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5963666439056396
Epoch: 1, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.325 Vali Acc: 0.049 Test Loss: 3.325 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.4944417476654053
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.281 Vali Acc: 0.074 Test Loss: 3.281 Test Acc: 0.074
Validation loss decreased (-0.049379 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 0.5594196319580078
Epoch: 3, Steps: 10 | Train Loss: 3.013 Vali Loss: 3.271 Vali Acc: 0.094 Test Loss: 3.271 Test Acc: 0.094
Validation loss decreased (-0.074085 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.5054142475128174
Epoch: 4, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.273 Vali Acc: 0.098 Test Loss: 3.273 Test Acc: 0.098
Validation loss decreased (-0.094085 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 0.5374395847320557
Epoch: 5, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.260 Vali Acc: 0.116 Test Loss: 3.260 Test Acc: 0.116
Validation loss decreased (-0.097614 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.4506797790527344
Epoch: 6, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.235 Vali Acc: 0.144 Test Loss: 3.235 Test Acc: 0.144
Validation loss decreased (-0.116438 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 0.4861290454864502
Epoch: 7, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.229 Vali Acc: 0.162 Test Loss: 3.229 Test Acc: 0.162
Validation loss decreased (-0.143497 --> -0.162321).  Saving model ...
Epoch: 8 cost time: 0.5674200057983398
Epoch: 8, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.255 Vali Acc: 0.187 Test Loss: 3.255 Test Acc: 0.187
Validation loss decreased (-0.162321 --> -0.187026).  Saving model ...
Epoch: 9 cost time: 0.557593822479248
Epoch: 9, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.310 Vali Acc: 0.193 Test Loss: 3.310 Test Acc: 0.193
Validation loss decreased (-0.187026 --> -0.192908).  Saving model ...
Epoch: 10 cost time: 0.5153076648712158
Epoch: 10, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.367 Vali Acc: 0.216 Test Loss: 3.367 Test Acc: 0.216
Validation loss decreased (-0.192908 --> -0.216437).  Saving model ...
Epoch: 11 cost time: 0.56392502784729
Epoch: 11, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.409 Vali Acc: 0.224 Test Loss: 3.409 Test Acc: 0.224
Validation loss decreased (-0.216437 --> -0.223495).  Saving model ...
Epoch: 12 cost time: 0.5037400722503662
Epoch: 12, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.538 Vali Acc: 0.221 Test Loss: 3.538 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5081584453582764
Epoch: 13, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.609 Vali Acc: 0.218 Test Loss: 3.609 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5304660797119141
Epoch: 14, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.711 Vali Acc: 0.224 Test Loss: 3.711 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4705049991607666
Epoch: 15, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.753 Vali Acc: 0.238 Test Loss: 3.753 Test Acc: 0.238
Validation loss decreased (-0.223495 --> -0.237610).  Saving model ...
Epoch: 16 cost time: 0.535952091217041
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.844 Vali Acc: 0.242 Test Loss: 3.844 Test Acc: 0.242
Validation loss decreased (-0.237610 --> -0.242314).  Saving model ...
Epoch: 17 cost time: 0.4716308116912842
Epoch: 17, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.903 Vali Acc: 0.249 Test Loss: 3.903 Test Acc: 0.249
Validation loss decreased (-0.242314 --> -0.249373).  Saving model ...
Epoch: 18 cost time: 0.5132763385772705
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.985 Vali Acc: 0.253 Test Loss: 3.985 Test Acc: 0.253
Validation loss decreased (-0.249373 --> -0.252901).  Saving model ...
Epoch: 19 cost time: 0.5143613815307617
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.092 Vali Acc: 0.242 Test Loss: 4.092 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5075147151947021
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.124 Vali Acc: 0.242 Test Loss: 4.124 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4772000312805176
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.141 Vali Acc: 0.256 Test Loss: 4.141 Test Acc: 0.256
Validation loss decreased (-0.252901 --> -0.256429).  Saving model ...
Epoch: 22 cost time: 0.526439905166626
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.160 Vali Acc: 0.267 Test Loss: 4.160 Test Acc: 0.267
Validation loss decreased (-0.256429 --> -0.267017).  Saving model ...
Epoch: 23 cost time: 0.5541341304779053
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.218 Vali Acc: 0.259 Test Loss: 4.218 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5443887710571289
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.219 Vali Acc: 0.256 Test Loss: 4.219 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5306124687194824
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.223 Vali Acc: 0.259 Test Loss: 4.223 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4716029167175293
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.228 Vali Acc: 0.260 Test Loss: 4.228 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4778122901916504
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.247 Vali Acc: 0.262 Test Loss: 4.247 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5412683486938477
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.265 Vali Acc: 0.264 Test Loss: 4.265 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5111098289489746
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.286 Vali Acc: 0.264 Test Loss: 4.286 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.48905062675476074
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.298 Vali Acc: 0.272 Test Loss: 4.298 Test Acc: 0.272
Validation loss decreased (-0.267017 --> -0.271722).  Saving model ...
Epoch: 31 cost time: 0.5084431171417236
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.316 Vali Acc: 0.267 Test Loss: 4.316 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.525449275970459
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.330 Vali Acc: 0.266 Test Loss: 4.330 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5152664184570312
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.333 Vali Acc: 0.268 Test Loss: 4.333 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5220341682434082
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.357 Vali Acc: 0.268 Test Loss: 4.357 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4548189640045166
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.363 Vali Acc: 0.272 Test Loss: 4.363 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.46727728843688965
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.367 Vali Acc: 0.273 Test Loss: 4.367 Test Acc: 0.273
Validation loss decreased (-0.271722 --> -0.272898).  Saving model ...
Epoch: 37 cost time: 0.5160682201385498
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.376 Vali Acc: 0.275 Test Loss: 4.376 Test Acc: 0.275
Validation loss decreased (-0.272898 --> -0.275250).  Saving model ...
Epoch: 38 cost time: 0.514976978302002
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.389 Vali Acc: 0.274 Test Loss: 4.389 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5143105983734131
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.395 Vali Acc: 0.278 Test Loss: 4.395 Test Acc: 0.278
Validation loss decreased (-0.275250 --> -0.277603).  Saving model ...
Epoch: 40 cost time: 0.4715445041656494
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.409 Vali Acc: 0.276 Test Loss: 4.409 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5278308391571045
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.423 Vali Acc: 0.276 Test Loss: 4.423 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5470900535583496
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.429 Vali Acc: 0.276 Test Loss: 4.429 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5406210422515869
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.447 Vali Acc: 0.274 Test Loss: 4.447 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5317478179931641
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.466 Vali Acc: 0.272 Test Loss: 4.466 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.48618197441101074
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.467 Vali Acc: 0.275 Test Loss: 4.467 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.524308443069458
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.478 Vali Acc: 0.272 Test Loss: 4.478 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.48246145248413086
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.486 Vali Acc: 0.274 Test Loss: 4.486 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5702798366546631
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.494 Vali Acc: 0.275 Test Loss: 4.494 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.529242753982544
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.516 Vali Acc: 0.275 Test Loss: 4.516 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 520474
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4204628467559814
Epoch: 1, Steps: 10 | Train Loss: 3.460 Vali Loss: 3.355 Vali Acc: 0.035 Test Loss: 3.355 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5553092956542969
Epoch: 2, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.315 Vali Acc: 0.049 Test Loss: 3.315 Test Acc: 0.049
Validation loss decreased (-0.035261 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.49022936820983887
Epoch: 3, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.302 Vali Acc: 0.067 Test Loss: 3.302 Test Acc: 0.067
Validation loss decreased (-0.049379 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.4870319366455078
Epoch: 4, Steps: 10 | Train Loss: 2.733 Vali Loss: 3.310 Vali Acc: 0.084 Test Loss: 3.310 Test Acc: 0.084
Validation loss decreased (-0.067026 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.5605156421661377
Epoch: 5, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.299 Vali Acc: 0.096 Test Loss: 3.299 Test Acc: 0.096
Validation loss decreased (-0.083496 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 0.5148165225982666
Epoch: 6, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.283 Vali Acc: 0.115 Test Loss: 3.283 Test Acc: 0.115
Validation loss decreased (-0.096438 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 0.5190730094909668
Epoch: 7, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.268 Vali Acc: 0.147 Test Loss: 3.268 Test Acc: 0.147
Validation loss decreased (-0.115261 --> -0.147026).  Saving model ...
Epoch: 8 cost time: 0.5413401126861572
Epoch: 8, Steps: 10 | Train Loss: 1.654 Vali Loss: 3.278 Vali Acc: 0.168 Test Loss: 3.278 Test Acc: 0.168
Validation loss decreased (-0.147026 --> -0.168203).  Saving model ...
Epoch: 9 cost time: 0.5303573608398438
Epoch: 9, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.329 Vali Acc: 0.174 Test Loss: 3.329 Test Acc: 0.174
Validation loss decreased (-0.168203 --> -0.174084).  Saving model ...
Epoch: 10 cost time: 0.5427830219268799
Epoch: 10, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.342 Vali Acc: 0.185 Test Loss: 3.342 Test Acc: 0.185
Validation loss decreased (-0.174084 --> -0.184672).  Saving model ...
Epoch: 11 cost time: 0.477247953414917
Epoch: 11, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.390 Vali Acc: 0.202 Test Loss: 3.390 Test Acc: 0.202
Validation loss decreased (-0.184672 --> -0.202319).  Saving model ...
Epoch: 12 cost time: 0.5162334442138672
Epoch: 12, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.423 Vali Acc: 0.214 Test Loss: 3.423 Test Acc: 0.214
Validation loss decreased (-0.202319 --> -0.214083).  Saving model ...
Epoch: 13 cost time: 0.5269300937652588
Epoch: 13, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.503 Vali Acc: 0.218 Test Loss: 3.503 Test Acc: 0.218
Validation loss decreased (-0.214083 --> -0.217612).  Saving model ...
Epoch: 14 cost time: 0.47772884368896484
Epoch: 14, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.548 Vali Acc: 0.226 Test Loss: 3.548 Test Acc: 0.226
Validation loss decreased (-0.217612 --> -0.225847).  Saving model ...
Epoch: 15 cost time: 0.49514269828796387
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.653 Vali Acc: 0.234 Test Loss: 3.653 Test Acc: 0.234
Validation loss decreased (-0.225847 --> -0.234081).  Saving model ...
Epoch: 16 cost time: 0.4743499755859375
Epoch: 16, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.740 Vali Acc: 0.236 Test Loss: 3.740 Test Acc: 0.236
Validation loss decreased (-0.234081 --> -0.236433).  Saving model ...
Epoch: 17 cost time: 0.5235395431518555
Epoch: 17, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.819 Vali Acc: 0.249 Test Loss: 3.819 Test Acc: 0.249
Validation loss decreased (-0.236433 --> -0.249374).  Saving model ...
Epoch: 18 cost time: 0.510528564453125
Epoch: 18, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.835 Vali Acc: 0.254 Test Loss: 3.835 Test Acc: 0.254
Validation loss decreased (-0.249374 --> -0.254079).  Saving model ...
Epoch: 19 cost time: 0.5659027099609375
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.914 Vali Acc: 0.254 Test Loss: 3.914 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5348596572875977
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.989 Vali Acc: 0.258 Test Loss: 3.989 Test Acc: 0.258
Validation loss decreased (-0.254079 --> -0.257607).  Saving model ...
Epoch: 21 cost time: 0.5455734729766846
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.964 Vali Acc: 0.259 Test Loss: 3.964 Test Acc: 0.259
Validation loss decreased (-0.257607 --> -0.258784).  Saving model ...
Epoch: 22 cost time: 0.4684762954711914
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.958 Vali Acc: 0.261 Test Loss: 3.958 Test Acc: 0.261
Validation loss decreased (-0.258784 --> -0.261137).  Saving model ...
Epoch: 23 cost time: 0.4828019142150879
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.022 Vali Acc: 0.261 Test Loss: 4.022 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5278782844543457
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.091 Vali Acc: 0.259 Test Loss: 4.091 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4589254856109619
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.141 Vali Acc: 0.258 Test Loss: 4.141 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5078983306884766
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.164 Vali Acc: 0.259 Test Loss: 4.164 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5312328338623047
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.154 Vali Acc: 0.264 Test Loss: 4.154 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263488).  Saving model ...
Epoch: 28 cost time: 0.5448472499847412
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.175 Vali Acc: 0.259 Test Loss: 4.175 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5228312015533447
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.189 Vali Acc: 0.261 Test Loss: 4.189 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.477954626083374
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.231 Vali Acc: 0.262 Test Loss: 4.231 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5243744850158691
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.236 Vali Acc: 0.267 Test Loss: 4.236 Test Acc: 0.267
Validation loss decreased (-0.263488 --> -0.267016).  Saving model ...
Epoch: 32 cost time: 0.5058555603027344
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.243 Vali Acc: 0.261 Test Loss: 4.243 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5264952182769775
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.257 Vali Acc: 0.264 Test Loss: 4.257 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.482097864151001
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.275 Vali Acc: 0.265 Test Loss: 4.275 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.48615360260009766
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.285 Vali Acc: 0.265 Test Loss: 4.285 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5069186687469482
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.291 Vali Acc: 0.262 Test Loss: 4.291 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4859631061553955
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.311 Vali Acc: 0.265 Test Loss: 4.311 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4538547992706299
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.323 Vali Acc: 0.268 Test Loss: 4.323 Test Acc: 0.268
Validation loss decreased (-0.267016 --> -0.268192).  Saving model ...
Epoch: 39 cost time: 0.5280072689056396
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.335 Vali Acc: 0.266 Test Loss: 4.335 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5669116973876953
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.370 Vali Acc: 0.261 Test Loss: 4.370 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4867732524871826
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.384 Vali Acc: 0.260 Test Loss: 4.384 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5026247501373291
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.400 Vali Acc: 0.266 Test Loss: 4.400 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5568773746490479
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.406 Vali Acc: 0.264 Test Loss: 4.406 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5530006885528564
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.411 Vali Acc: 0.262 Test Loss: 4.411 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5146884918212891
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.406 Vali Acc: 0.266 Test Loss: 4.406 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5012280941009521
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.406 Vali Acc: 0.264 Test Loss: 4.406 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.44725608825683594
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.411 Vali Acc: 0.262 Test Loss: 4.411 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5338649749755859
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.418 Vali Acc: 0.262 Test Loss: 4.418 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 491546
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4681389331817627
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.347 Vali Acc: 0.034 Test Loss: 3.347 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.510115385055542
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.328 Vali Acc: 0.047 Test Loss: 3.328 Test Acc: 0.047
Validation loss decreased (-0.034084 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.4889068603515625
Epoch: 3, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.318 Vali Acc: 0.079 Test Loss: 3.318 Test Acc: 0.079
Validation loss decreased (-0.047026 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.5335836410522461
Epoch: 4, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.307 Vali Acc: 0.084 Test Loss: 3.307 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.4808833599090576
Epoch: 5, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.301 Vali Acc: 0.100 Test Loss: 3.301 Test Acc: 0.100
Validation loss decreased (-0.083496 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.5153706073760986
Epoch: 6, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.289 Vali Acc: 0.109 Test Loss: 3.289 Test Acc: 0.109
Validation loss decreased (-0.099967 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.4950225353240967
Epoch: 7, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.287 Vali Acc: 0.131 Test Loss: 3.287 Test Acc: 0.131
Validation loss decreased (-0.109379 --> -0.130555).  Saving model ...
Epoch: 8 cost time: 0.5378251075744629
Epoch: 8, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.293 Vali Acc: 0.148 Test Loss: 3.293 Test Acc: 0.148
Validation loss decreased (-0.130555 --> -0.148202).  Saving model ...
Epoch: 9 cost time: 0.4939286708831787
Epoch: 9, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.307 Vali Acc: 0.168 Test Loss: 3.307 Test Acc: 0.168
Validation loss decreased (-0.148202 --> -0.168202).  Saving model ...
Epoch: 10 cost time: 0.5145456790924072
Epoch: 10, Steps: 10 | Train Loss: 1.303 Vali Loss: 3.334 Vali Acc: 0.185 Test Loss: 3.334 Test Acc: 0.185
Validation loss decreased (-0.168202 --> -0.184673).  Saving model ...
Epoch: 11 cost time: 0.49141621589660645
Epoch: 11, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.377 Vali Acc: 0.201 Test Loss: 3.377 Test Acc: 0.201
Validation loss decreased (-0.184673 --> -0.201143).  Saving model ...
Epoch: 12 cost time: 0.6012580394744873
Epoch: 12, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.407 Vali Acc: 0.213 Test Loss: 3.407 Test Acc: 0.213
Validation loss decreased (-0.201143 --> -0.212907).  Saving model ...
Epoch: 13 cost time: 0.5267102718353271
Epoch: 13, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.450 Vali Acc: 0.212 Test Loss: 3.450 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5237417221069336
Epoch: 14, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.519 Vali Acc: 0.228 Test Loss: 3.519 Test Acc: 0.228
Validation loss decreased (-0.212907 --> -0.228200).  Saving model ...
Epoch: 15 cost time: 0.48967742919921875
Epoch: 15, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.606 Vali Acc: 0.234 Test Loss: 3.606 Test Acc: 0.234
Validation loss decreased (-0.228200 --> -0.234082).  Saving model ...
Epoch: 16 cost time: 0.5883767604827881
Epoch: 16, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.622 Vali Acc: 0.231 Test Loss: 3.622 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4941723346710205
Epoch: 17, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.642 Vali Acc: 0.244 Test Loss: 3.642 Test Acc: 0.244
Validation loss decreased (-0.234082 --> -0.243493).  Saving model ...
Epoch: 18 cost time: 0.49631428718566895
Epoch: 18, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.725 Vali Acc: 0.245 Test Loss: 3.725 Test Acc: 0.245
Validation loss decreased (-0.243493 --> -0.244669).  Saving model ...
Epoch: 19 cost time: 0.4999098777770996
Epoch: 19, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.777 Vali Acc: 0.259 Test Loss: 3.777 Test Acc: 0.259
Validation loss decreased (-0.244669 --> -0.258786).  Saving model ...
Epoch: 20 cost time: 0.48008155822753906
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.823 Vali Acc: 0.255 Test Loss: 3.823 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5447609424591064
Epoch: 21, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.850 Vali Acc: 0.259 Test Loss: 3.850 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.548673152923584
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.899 Vali Acc: 0.261 Test Loss: 3.899 Test Acc: 0.261
Validation loss decreased (-0.258786 --> -0.261137).  Saving model ...
Epoch: 23 cost time: 0.51552414894104
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.900 Vali Acc: 0.264 Test Loss: 3.900 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263490).  Saving model ...
Epoch: 24 cost time: 0.5078203678131104
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.916 Vali Acc: 0.267 Test Loss: 3.916 Test Acc: 0.267
Validation loss decreased (-0.263490 --> -0.267020).  Saving model ...
Epoch: 25 cost time: 0.5304281711578369
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.956 Vali Acc: 0.266 Test Loss: 3.956 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.512775182723999
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.000 Vali Acc: 0.265 Test Loss: 4.000 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5072305202484131
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.042 Vali Acc: 0.260 Test Loss: 4.042 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5070590972900391
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.089 Vali Acc: 0.269 Test Loss: 4.089 Test Acc: 0.269
Validation loss decreased (-0.267020 --> -0.269371).  Saving model ...
Epoch: 29 cost time: 0.48665356636047363
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.078 Vali Acc: 0.269 Test Loss: 4.078 Test Acc: 0.269
Validation loss decreased (-0.269371 --> -0.269371).  Saving model ...
Epoch: 30 cost time: 0.50844407081604
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.074 Vali Acc: 0.274 Test Loss: 4.074 Test Acc: 0.274
Validation loss decreased (-0.269371 --> -0.274077).  Saving model ...
Epoch: 31 cost time: 0.48465776443481445
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.065 Vali Acc: 0.268 Test Loss: 4.065 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4785346984863281
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.085 Vali Acc: 0.267 Test Loss: 4.085 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.49375486373901367
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.095 Vali Acc: 0.271 Test Loss: 4.095 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4932699203491211
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.157 Vali Acc: 0.272 Test Loss: 4.157 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.48053431510925293
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.184 Vali Acc: 0.272 Test Loss: 4.184 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4916672706604004
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.180 Vali Acc: 0.273 Test Loss: 4.180 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4858875274658203
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.172 Vali Acc: 0.278 Test Loss: 4.172 Test Acc: 0.278
Validation loss decreased (-0.274077 --> -0.277605).  Saving model ...
Epoch: 38 cost time: 0.49535512924194336
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.172 Vali Acc: 0.278 Test Loss: 4.172 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5221869945526123
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.196 Vali Acc: 0.279 Test Loss: 4.196 Test Acc: 0.279
Validation loss decreased (-0.277605 --> -0.278782).  Saving model ...
Epoch: 40 cost time: 0.4863412380218506
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.220 Vali Acc: 0.275 Test Loss: 4.220 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.486283540725708
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.243 Vali Acc: 0.271 Test Loss: 4.243 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5141873359680176
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.256 Vali Acc: 0.274 Test Loss: 4.256 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4834251403808594
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.245 Vali Acc: 0.269 Test Loss: 4.245 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.46498870849609375
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.252 Vali Acc: 0.278 Test Loss: 4.252 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5315747261047363
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.266 Vali Acc: 0.282 Test Loss: 4.266 Test Acc: 0.282
Validation loss decreased (-0.278782 --> -0.282310).  Saving model ...
Epoch: 46 cost time: 0.5442070960998535
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.256 Vali Acc: 0.281 Test Loss: 4.256 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.48462677001953125
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.266 Vali Acc: 0.282 Test Loss: 4.266 Test Acc: 0.282
Validation loss decreased (-0.282310 --> -0.282310).  Saving model ...
Epoch: 48 cost time: 0.5095527172088623
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.292 Vali Acc: 0.281 Test Loss: 4.292 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.48276782035827637
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.309 Vali Acc: 0.279 Test Loss: 4.309 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4523911476135254
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.317 Vali Acc: 0.284 Test Loss: 4.317 Test Acc: 0.284
Validation loss decreased (-0.282310 --> -0.283486).  Saving model ...
Epoch: 51 cost time: 0.49122142791748047
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.310 Vali Acc: 0.281 Test Loss: 4.310 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5026483535766602
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.328 Vali Acc: 0.282 Test Loss: 4.328 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5233068466186523
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.349 Vali Acc: 0.280 Test Loss: 4.349 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.4890422821044922
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.354 Vali Acc: 0.278 Test Loss: 4.354 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.47190403938293457
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.364 Vali Acc: 0.278 Test Loss: 4.364 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5122146606445312
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.387 Vali Acc: 0.276 Test Loss: 4.387 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5141363143920898
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.396 Vali Acc: 0.278 Test Loss: 4.396 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4963347911834717
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.387 Vali Acc: 0.275 Test Loss: 4.387 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.46344518661499023
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.392 Vali Acc: 0.279 Test Loss: 4.392 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5361206531524658
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.398 Vali Acc: 0.278 Test Loss: 4.398 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 482458
model size : 4.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.312396764755249
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.394 Vali Acc: 0.062 Test Loss: 3.394 Test Acc: 0.062
Validation loss decreased (inf --> -0.062319).  Saving model ...
Epoch: 2 cost time: 0.5038857460021973
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.442 Vali Acc: 0.101 Test Loss: 3.442 Test Acc: 0.101
Validation loss decreased (-0.062319 --> -0.101142).  Saving model ...
Epoch: 3 cost time: 0.6048526763916016
Epoch: 3, Steps: 10 | Train Loss: 2.163 Vali Loss: 3.240 Vali Acc: 0.178 Test Loss: 3.240 Test Acc: 0.178
Validation loss decreased (-0.101142 --> -0.177615).  Saving model ...
Epoch: 4 cost time: 0.5020174980163574
Epoch: 4, Steps: 10 | Train Loss: 1.537 Vali Loss: 3.494 Vali Acc: 0.189 Test Loss: 3.494 Test Acc: 0.189
Validation loss decreased (-0.177615 --> -0.189377).  Saving model ...
Epoch: 5 cost time: 0.5321128368377686
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.569 Vali Acc: 0.218 Test Loss: 3.569 Test Acc: 0.218
Validation loss decreased (-0.189377 --> -0.217611).  Saving model ...
Epoch: 6 cost time: 0.46958494186401367
Epoch: 6, Steps: 10 | Train Loss: 0.534 Vali Loss: 4.013 Vali Acc: 0.227 Test Loss: 4.013 Test Acc: 0.227
Validation loss decreased (-0.217611 --> -0.227019).  Saving model ...
Epoch: 7 cost time: 0.46611547470092773
Epoch: 7, Steps: 10 | Train Loss: 0.318 Vali Loss: 4.053 Vali Acc: 0.241 Test Loss: 4.053 Test Acc: 0.241
Validation loss decreased (-0.227019 --> -0.241136).  Saving model ...
Epoch: 8 cost time: 0.4580268859863281
Epoch: 8, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.587 Vali Acc: 0.235 Test Loss: 4.587 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5647647380828857
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.781 Vali Acc: 0.238 Test Loss: 4.781 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5260128974914551
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.902 Vali Acc: 0.254 Test Loss: 4.902 Test Acc: 0.254
Validation loss decreased (-0.241136 --> -0.254069).  Saving model ...
Epoch: 11 cost time: 0.46530795097351074
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 5.180 Vali Acc: 0.258 Test Loss: 5.180 Test Acc: 0.258
Validation loss decreased (-0.254069 --> -0.257595).  Saving model ...
Epoch: 12 cost time: 0.47381019592285156
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.676 Vali Acc: 0.228 Test Loss: 5.676 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4957132339477539
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.518 Vali Acc: 0.248 Test Loss: 5.518 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4939110279083252
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.876 Vali Acc: 0.234 Test Loss: 5.876 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46524572372436523
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.746 Vali Acc: 0.255 Test Loss: 5.746 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.44932985305786133
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.851 Vali Acc: 0.259 Test Loss: 5.851 Test Acc: 0.259
Validation loss decreased (-0.257595 --> -0.258765).  Saving model ...
Epoch: 17 cost time: 0.4518702030181885
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.837 Vali Acc: 0.267 Test Loss: 5.837 Test Acc: 0.267
Validation loss decreased (-0.258765 --> -0.267000).  Saving model ...
Epoch: 18 cost time: 0.4124901294708252
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.839 Vali Acc: 0.266 Test Loss: 5.839 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.48920249938964844
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.845 Vali Acc: 0.265 Test Loss: 5.845 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4596843719482422
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.845 Vali Acc: 0.266 Test Loss: 5.845 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5274381637573242
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.843 Vali Acc: 0.269 Test Loss: 5.843 Test Acc: 0.269
Validation loss decreased (-0.267000 --> -0.269353).  Saving model ...
Epoch: 22 cost time: 0.456329345703125
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.851 Vali Acc: 0.269 Test Loss: 5.851 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5377519130706787
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.851 Vali Acc: 0.267 Test Loss: 5.851 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4326322078704834
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.847 Vali Acc: 0.267 Test Loss: 5.847 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4739391803741455
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.840 Vali Acc: 0.268 Test Loss: 5.840 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.486494779586792
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.843 Vali Acc: 0.271 Test Loss: 5.843 Test Acc: 0.271
Validation loss decreased (-0.269353 --> -0.270530).  Saving model ...
Epoch: 27 cost time: 0.468425989151001
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.265 Test Loss: 5.848 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.451854944229126
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.867 Vali Acc: 0.271 Test Loss: 5.867 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4523618221282959
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.885 Vali Acc: 0.269 Test Loss: 5.885 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.49503064155578613
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.895 Vali Acc: 0.271 Test Loss: 5.895 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.517808198928833
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.885 Vali Acc: 0.271 Test Loss: 5.885 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.44492483139038086
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.889 Vali Acc: 0.272 Test Loss: 5.889 Test Acc: 0.272
Validation loss decreased (-0.270530 --> -0.271706).  Saving model ...
Epoch: 33 cost time: 0.4731926918029785
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.913 Vali Acc: 0.272 Test Loss: 5.913 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5177106857299805
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.912 Vali Acc: 0.271 Test Loss: 5.912 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4739420413970947
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.923 Vali Acc: 0.271 Test Loss: 5.923 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.500922441482544
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.925 Vali Acc: 0.269 Test Loss: 5.925 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.45861077308654785
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.928 Vali Acc: 0.268 Test Loss: 5.928 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.461956262588501
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.941 Vali Acc: 0.268 Test Loss: 5.941 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4483492374420166
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.940 Vali Acc: 0.271 Test Loss: 5.940 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.43716883659362793
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.271 Test Loss: 5.939 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.47864675521850586
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.273 Test Loss: 5.939 Test Acc: 0.273
Validation loss decreased (-0.271706 --> -0.272882).  Saving model ...
Epoch: 42 cost time: 0.4781355857849121
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.274 Test Loss: 5.956 Test Acc: 0.274
Validation loss decreased (-0.272882 --> -0.274058).  Saving model ...
Epoch: 43 cost time: 0.5148825645446777
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.965 Vali Acc: 0.274 Test Loss: 5.965 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.47861599922180176
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.968 Vali Acc: 0.274 Test Loss: 5.968 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.44405603408813477
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.972 Vali Acc: 0.272 Test Loss: 5.972 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.436614990234375
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.970 Vali Acc: 0.273 Test Loss: 5.970 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.48713207244873047
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.991 Vali Acc: 0.273 Test Loss: 5.991 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.488680362701416
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.990 Vali Acc: 0.272 Test Loss: 5.990 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.4964756965637207
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.995 Vali Acc: 0.272 Test Loss: 5.995 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5408933162689209
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.002 Vali Acc: 0.274 Test Loss: 6.002 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.4823026657104492
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.004 Vali Acc: 0.274 Test Loss: 6.004 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.503218412399292
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.009 Vali Acc: 0.272 Test Loss: 6.009 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 1058330
model size : 6.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.419297218322754
Epoch: 1, Steps: 10 | Train Loss: 3.383 Vali Loss: 3.346 Vali Acc: 0.051 Test Loss: 3.346 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.556389331817627
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.425 Vali Acc: 0.081 Test Loss: 3.425 Test Acc: 0.081
Validation loss decreased (-0.050555 --> -0.081142).  Saving model ...
Epoch: 3 cost time: 0.5184431076049805
Epoch: 3, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.306 Vali Acc: 0.131 Test Loss: 3.306 Test Acc: 0.131
Validation loss decreased (-0.081142 --> -0.130555).  Saving model ...
Epoch: 4 cost time: 0.5137219429016113
Epoch: 4, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.283 Vali Acc: 0.147 Test Loss: 3.283 Test Acc: 0.147
Validation loss decreased (-0.130555 --> -0.147026).  Saving model ...
Epoch: 5 cost time: 0.49812841415405273
Epoch: 5, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.365 Vali Acc: 0.172 Test Loss: 3.365 Test Acc: 0.172
Validation loss decreased (-0.147026 --> -0.171731).  Saving model ...
Epoch: 6 cost time: 0.478945255279541
Epoch: 6, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.446 Vali Acc: 0.184 Test Loss: 3.446 Test Acc: 0.184
Validation loss decreased (-0.171731 --> -0.183495).  Saving model ...
Epoch: 7 cost time: 0.5403213500976562
Epoch: 7, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.656 Vali Acc: 0.212 Test Loss: 3.656 Test Acc: 0.212
Validation loss decreased (-0.183495 --> -0.211728).  Saving model ...
Epoch: 8 cost time: 0.5622572898864746
Epoch: 8, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.692 Vali Acc: 0.233 Test Loss: 3.692 Test Acc: 0.233
Validation loss decreased (-0.211728 --> -0.232904).  Saving model ...
Epoch: 9 cost time: 0.5264337062835693
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.890 Vali Acc: 0.218 Test Loss: 3.890 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.44568705558776855
Epoch: 10, Steps: 10 | Train Loss: 0.206 Vali Loss: 4.009 Vali Acc: 0.236 Test Loss: 4.009 Test Acc: 0.236
Validation loss decreased (-0.232904 --> -0.236430).  Saving model ...
Epoch: 11 cost time: 0.471710205078125
Epoch: 11, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.161 Vali Acc: 0.242 Test Loss: 4.161 Test Acc: 0.242
Validation loss decreased (-0.236430 --> -0.242311).  Saving model ...
Epoch: 12 cost time: 0.5210409164428711
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.392 Vali Acc: 0.241 Test Loss: 4.392 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49529385566711426
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.370 Vali Acc: 0.267 Test Loss: 4.370 Test Acc: 0.267
Validation loss decreased (-0.242311 --> -0.267015).  Saving model ...
Epoch: 14 cost time: 0.5139241218566895
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.608 Vali Acc: 0.252 Test Loss: 4.608 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5255067348480225
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.809 Vali Acc: 0.241 Test Loss: 4.809 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47211480140686035
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.797 Vali Acc: 0.258 Test Loss: 4.797 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5272073745727539
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.792 Vali Acc: 0.264 Test Loss: 4.792 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4437892436981201
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.841 Vali Acc: 0.259 Test Loss: 4.841 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.48278212547302246
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.903 Vali Acc: 0.256 Test Loss: 4.903 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5040848255157471
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.937 Vali Acc: 0.262 Test Loss: 4.937 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4880537986755371
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.961 Vali Acc: 0.261 Test Loss: 4.961 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.43750500679016113
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.978 Vali Acc: 0.261 Test Loss: 4.978 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.48920392990112305
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.993 Vali Acc: 0.261 Test Loss: 4.993 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 679450
model size : 5.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.41800856590271
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.376 Vali Acc: 0.042 Test Loss: 3.376 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.503056526184082
Epoch: 2, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.385 Vali Acc: 0.069 Test Loss: 3.385 Test Acc: 0.069
Validation loss decreased (-0.042319 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.5258867740631104
Epoch: 3, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.360 Vali Acc: 0.100 Test Loss: 3.360 Test Acc: 0.100
Validation loss decreased (-0.069378 --> -0.099966).  Saving model ...
Epoch: 4 cost time: 0.4710721969604492
Epoch: 4, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.284 Vali Acc: 0.135 Test Loss: 3.284 Test Acc: 0.135
Validation loss decreased (-0.099966 --> -0.135261).  Saving model ...
Epoch: 5 cost time: 0.49703335762023926
Epoch: 5, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.298 Vali Acc: 0.154 Test Loss: 3.298 Test Acc: 0.154
Validation loss decreased (-0.135261 --> -0.154085).  Saving model ...
Epoch: 6 cost time: 0.4816126823425293
Epoch: 6, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.342 Vali Acc: 0.176 Test Loss: 3.342 Test Acc: 0.176
Validation loss decreased (-0.154085 --> -0.176437).  Saving model ...
Epoch: 7 cost time: 0.4724245071411133
Epoch: 7, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.420 Vali Acc: 0.192 Test Loss: 3.420 Test Acc: 0.192
Validation loss decreased (-0.176437 --> -0.191731).  Saving model ...
Epoch: 8 cost time: 0.5327372550964355
Epoch: 8, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.492 Vali Acc: 0.220 Test Loss: 3.492 Test Acc: 0.220
Validation loss decreased (-0.191731 --> -0.219965).  Saving model ...
Epoch: 9 cost time: 0.4913747310638428
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.599 Vali Acc: 0.229 Test Loss: 3.599 Test Acc: 0.229
Validation loss decreased (-0.219965 --> -0.229376).  Saving model ...
Epoch: 10 cost time: 0.4900987148284912
Epoch: 10, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.723 Vali Acc: 0.228 Test Loss: 3.723 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.502373456954956
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.866 Vali Acc: 0.247 Test Loss: 3.866 Test Acc: 0.247
Validation loss decreased (-0.229376 --> -0.247020).  Saving model ...
Epoch: 12 cost time: 0.45128655433654785
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.993 Vali Acc: 0.235 Test Loss: 3.993 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4969213008880615
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.171 Vali Acc: 0.245 Test Loss: 4.171 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4642305374145508
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.251 Vali Acc: 0.242 Test Loss: 4.251 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4967777729034424
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.386 Vali Acc: 0.239 Test Loss: 4.386 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.41272616386413574
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.446 Vali Acc: 0.248 Test Loss: 4.446 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248191).  Saving model ...
Epoch: 17 cost time: 0.45975351333618164
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.509 Vali Acc: 0.245 Test Loss: 4.509 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.49910712242126465
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.572 Vali Acc: 0.251 Test Loss: 4.572 Test Acc: 0.251
Validation loss decreased (-0.248191 --> -0.250543).  Saving model ...
Epoch: 19 cost time: 0.46982550621032715
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.657 Vali Acc: 0.246 Test Loss: 4.657 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4830594062805176
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.643 Vali Acc: 0.245 Test Loss: 4.643 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49907684326171875
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.614 Vali Acc: 0.251 Test Loss: 4.614 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.46335411071777344
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.641 Vali Acc: 0.253 Test Loss: 4.641 Test Acc: 0.253
Validation loss decreased (-0.250543 --> -0.252895).  Saving model ...
Epoch: 23 cost time: 0.46330928802490234
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.676 Vali Acc: 0.255 Test Loss: 4.676 Test Acc: 0.255
Validation loss decreased (-0.252895 --> -0.255247).  Saving model ...
Epoch: 24 cost time: 0.5184829235076904
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.703 Vali Acc: 0.253 Test Loss: 4.703 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4824681282043457
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.719 Vali Acc: 0.251 Test Loss: 4.719 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5104401111602783
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.736 Vali Acc: 0.259 Test Loss: 4.736 Test Acc: 0.259
Validation loss decreased (-0.255247 --> -0.258776).  Saving model ...
Epoch: 27 cost time: 0.49962806701660156
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.776 Vali Acc: 0.254 Test Loss: 4.776 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.517223596572876
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.801 Vali Acc: 0.254 Test Loss: 4.801 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.480696439743042
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.812 Vali Acc: 0.253 Test Loss: 4.812 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5183858871459961
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.813 Vali Acc: 0.254 Test Loss: 4.813 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5667097568511963
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.820 Vali Acc: 0.256 Test Loss: 4.820 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4898254871368408
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.847 Vali Acc: 0.256 Test Loss: 4.847 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.48766517639160156
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.855 Vali Acc: 0.255 Test Loss: 4.855 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5115137100219727
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.878 Vali Acc: 0.255 Test Loss: 4.878 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.543220043182373
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.896 Vali Acc: 0.253 Test Loss: 4.896 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4353334903717041
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.905 Vali Acc: 0.253 Test Loss: 4.905 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 550170
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3992173671722412
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.351 Vali Acc: 0.054 Test Loss: 3.351 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.4580395221710205
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.323 Vali Acc: 0.052 Test Loss: 3.323 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4718151092529297
Epoch: 3, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.347 Vali Acc: 0.092 Test Loss: 3.347 Test Acc: 0.092
Validation loss decreased (-0.054084 --> -0.091731).  Saving model ...
Epoch: 4 cost time: 0.5506877899169922
Epoch: 4, Steps: 10 | Train Loss: 2.423 Vali Loss: 3.299 Vali Acc: 0.121 Test Loss: 3.299 Test Acc: 0.121
Validation loss decreased (-0.091731 --> -0.121143).  Saving model ...
Epoch: 5 cost time: 0.49042654037475586
Epoch: 5, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.259 Vali Acc: 0.139 Test Loss: 3.259 Test Acc: 0.139
Validation loss decreased (-0.121143 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.5095224380493164
Epoch: 6, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.269 Vali Acc: 0.160 Test Loss: 3.269 Test Acc: 0.160
Validation loss decreased (-0.138791 --> -0.159967).  Saving model ...
Epoch: 7 cost time: 0.4706871509552002
Epoch: 7, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.310 Vali Acc: 0.175 Test Loss: 3.310 Test Acc: 0.175
Validation loss decreased (-0.159967 --> -0.175261).  Saving model ...
Epoch: 8 cost time: 0.5352554321289062
Epoch: 8, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.365 Vali Acc: 0.205 Test Loss: 3.365 Test Acc: 0.205
Validation loss decreased (-0.175261 --> -0.204672).  Saving model ...
Epoch: 9 cost time: 0.4676194190979004
Epoch: 9, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.441 Vali Acc: 0.215 Test Loss: 3.441 Test Acc: 0.215
Validation loss decreased (-0.204672 --> -0.215260).  Saving model ...
Epoch: 10 cost time: 0.47870945930480957
Epoch: 10, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.552 Vali Acc: 0.232 Test Loss: 3.552 Test Acc: 0.232
Validation loss decreased (-0.215260 --> -0.231729).  Saving model ...
Epoch: 11 cost time: 0.46705126762390137
Epoch: 11, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.605 Vali Acc: 0.247 Test Loss: 3.605 Test Acc: 0.247
Validation loss decreased (-0.231729 --> -0.247023).  Saving model ...
Epoch: 12 cost time: 0.456467866897583
Epoch: 12, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.712 Vali Acc: 0.251 Test Loss: 3.712 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250551).  Saving model ...
Epoch: 13 cost time: 0.5105414390563965
Epoch: 13, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.928 Vali Acc: 0.238 Test Loss: 3.928 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4719352722167969
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.028 Vali Acc: 0.235 Test Loss: 4.028 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.48488402366638184
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.121 Vali Acc: 0.247 Test Loss: 4.121 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4803500175476074
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.318 Vali Acc: 0.249 Test Loss: 4.318 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5019826889038086
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.360 Vali Acc: 0.247 Test Loss: 4.360 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5000388622283936
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.343 Vali Acc: 0.252 Test Loss: 4.343 Test Acc: 0.252
Validation loss decreased (-0.250551 --> -0.251721).  Saving model ...
Epoch: 19 cost time: 0.45201563835144043
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.390 Vali Acc: 0.249 Test Loss: 4.390 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5588502883911133
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.432 Vali Acc: 0.238 Test Loss: 4.432 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.45650434494018555
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.480 Vali Acc: 0.242 Test Loss: 4.480 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4861941337585449
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.515 Vali Acc: 0.242 Test Loss: 4.515 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4176325798034668
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.554 Vali Acc: 0.249 Test Loss: 4.554 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4252898693084717
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.593 Vali Acc: 0.254 Test Loss: 4.593 Test Acc: 0.254
Validation loss decreased (-0.251721 --> -0.254072).  Saving model ...
Epoch: 25 cost time: 0.48755788803100586
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.616 Vali Acc: 0.252 Test Loss: 4.616 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5188777446746826
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.632 Vali Acc: 0.253 Test Loss: 4.632 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4726533889770508
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.656 Vali Acc: 0.253 Test Loss: 4.656 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.480696439743042
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.682 Vali Acc: 0.253 Test Loss: 4.682 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4581484794616699
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.698 Vali Acc: 0.254 Test Loss: 4.698 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4834163188934326
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.740 Vali Acc: 0.254 Test Loss: 4.740 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4561011791229248
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.748 Vali Acc: 0.254 Test Loss: 4.748 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.46717000007629395
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.765 Vali Acc: 0.251 Test Loss: 4.765 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5090463161468506
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.776 Vali Acc: 0.251 Test Loss: 4.776 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.44222164154052734
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.806 Vali Acc: 0.246 Test Loss: 4.806 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 490778
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3656001091003418
Epoch: 1, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.372 Vali Acc: 0.034 Test Loss: 3.372 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4920775890350342
Epoch: 2, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.332 Vali Acc: 0.060 Test Loss: 3.332 Test Acc: 0.060
Validation loss decreased (-0.034084 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.5073208808898926
Epoch: 3, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.330 Vali Acc: 0.082 Test Loss: 3.330 Test Acc: 0.082
Validation loss decreased (-0.059967 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.5236234664916992
Epoch: 4, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.332 Vali Acc: 0.111 Test Loss: 3.332 Test Acc: 0.111
Validation loss decreased (-0.082320 --> -0.110555).  Saving model ...
Epoch: 5 cost time: 0.5505058765411377
Epoch: 5, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.322 Vali Acc: 0.114 Test Loss: 3.322 Test Acc: 0.114
Validation loss decreased (-0.110555 --> -0.114084).  Saving model ...
Epoch: 6 cost time: 0.5128390789031982
Epoch: 6, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.295 Vali Acc: 0.144 Test Loss: 3.295 Test Acc: 0.144
Validation loss decreased (-0.114084 --> -0.143496).  Saving model ...
Epoch: 7 cost time: 0.434833288192749
Epoch: 7, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.293 Vali Acc: 0.156 Test Loss: 3.293 Test Acc: 0.156
Validation loss decreased (-0.143496 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 0.5220115184783936
Epoch: 8, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.322 Vali Acc: 0.175 Test Loss: 3.322 Test Acc: 0.175
Validation loss decreased (-0.156438 --> -0.175261).  Saving model ...
Epoch: 9 cost time: 0.44435691833496094
Epoch: 9, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.351 Vali Acc: 0.194 Test Loss: 3.351 Test Acc: 0.194
Validation loss decreased (-0.175261 --> -0.194084).  Saving model ...
Epoch: 10 cost time: 0.5677299499511719
Epoch: 10, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.408 Vali Acc: 0.206 Test Loss: 3.408 Test Acc: 0.206
Validation loss decreased (-0.194084 --> -0.205848).  Saving model ...
Epoch: 11 cost time: 0.5537376403808594
Epoch: 11, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.504 Vali Acc: 0.213 Test Loss: 3.504 Test Acc: 0.213
Validation loss decreased (-0.205848 --> -0.212906).  Saving model ...
Epoch: 12 cost time: 0.544442892074585
Epoch: 12, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.555 Vali Acc: 0.219 Test Loss: 3.555 Test Acc: 0.219
Validation loss decreased (-0.212906 --> -0.218788).  Saving model ...
Epoch: 13 cost time: 0.49296140670776367
Epoch: 13, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.631 Vali Acc: 0.224 Test Loss: 3.631 Test Acc: 0.224
Validation loss decreased (-0.218788 --> -0.223493).  Saving model ...
Epoch: 14 cost time: 0.510875940322876
Epoch: 14, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.699 Vali Acc: 0.234 Test Loss: 3.699 Test Acc: 0.234
Validation loss decreased (-0.223493 --> -0.234081).  Saving model ...
Epoch: 15 cost time: 0.5401992797851562
Epoch: 15, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.765 Vali Acc: 0.239 Test Loss: 3.765 Test Acc: 0.239
Validation loss decreased (-0.234081 --> -0.238786).  Saving model ...
Epoch: 16 cost time: 0.5133910179138184
Epoch: 16, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.919 Vali Acc: 0.228 Test Loss: 3.919 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5068767070770264
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.010 Vali Acc: 0.234 Test Loss: 4.010 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4614543914794922
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.049 Vali Acc: 0.248 Test Loss: 4.049 Test Acc: 0.248
Validation loss decreased (-0.238786 --> -0.248195).  Saving model ...
Epoch: 19 cost time: 0.5832762718200684
Epoch: 19, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.047 Vali Acc: 0.261 Test Loss: 4.047 Test Acc: 0.261
Validation loss decreased (-0.248195 --> -0.261136).  Saving model ...
Epoch: 20 cost time: 0.5305469036102295
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.112 Vali Acc: 0.252 Test Loss: 4.112 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5212795734405518
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.176 Vali Acc: 0.260 Test Loss: 4.176 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.47464919090270996
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.207 Vali Acc: 0.262 Test Loss: 4.207 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262311).  Saving model ...
Epoch: 23 cost time: 0.48369932174682617
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.246 Vali Acc: 0.266 Test Loss: 4.246 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265840).  Saving model ...
Epoch: 24 cost time: 0.4633352756500244
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.285 Vali Acc: 0.268 Test Loss: 4.285 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268192).  Saving model ...
Epoch: 25 cost time: 0.4986691474914551
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.341 Vali Acc: 0.259 Test Loss: 4.341 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.520174503326416
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.355 Vali Acc: 0.265 Test Loss: 4.355 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5788576602935791
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.365 Vali Acc: 0.274 Test Loss: 4.365 Test Acc: 0.274
Validation loss decreased (-0.268192 --> -0.274074).  Saving model ...
Epoch: 28 cost time: 0.5196044445037842
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.377 Vali Acc: 0.274 Test Loss: 4.377 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4788177013397217
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.388 Vali Acc: 0.275 Test Loss: 4.388 Test Acc: 0.275
Validation loss decreased (-0.274074 --> -0.275250).  Saving model ...
Epoch: 30 cost time: 0.5105011463165283
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.396 Vali Acc: 0.274 Test Loss: 4.396 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5155448913574219
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.420 Vali Acc: 0.278 Test Loss: 4.420 Test Acc: 0.278
Validation loss decreased (-0.275250 --> -0.277603).  Saving model ...
Epoch: 32 cost time: 0.4913766384124756
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.441 Vali Acc: 0.278 Test Loss: 4.441 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5001978874206543
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.462 Vali Acc: 0.276 Test Loss: 4.462 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.48781323432922363
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.477 Vali Acc: 0.280 Test Loss: 4.477 Test Acc: 0.280
Validation loss decreased (-0.277603 --> -0.279955).  Saving model ...
Epoch: 35 cost time: 0.5136222839355469
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.496 Vali Acc: 0.282 Test Loss: 4.496 Test Acc: 0.282
Validation loss decreased (-0.279955 --> -0.282308).  Saving model ...
Epoch: 36 cost time: 0.5022509098052979
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.511 Vali Acc: 0.286 Test Loss: 4.511 Test Acc: 0.286
Validation loss decreased (-0.282308 --> -0.285837).  Saving model ...
Epoch: 37 cost time: 0.4716048240661621
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.518 Vali Acc: 0.285 Test Loss: 4.518 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5070221424102783
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.529 Vali Acc: 0.285 Test Loss: 4.529 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4315629005432129
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.539 Vali Acc: 0.286 Test Loss: 4.539 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5156738758087158
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.537 Vali Acc: 0.285 Test Loss: 4.537 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5255522727966309
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.555 Vali Acc: 0.288 Test Loss: 4.555 Test Acc: 0.288
Validation loss decreased (-0.285837 --> -0.288190).  Saving model ...
Epoch: 42 cost time: 0.4820272922515869
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.573 Vali Acc: 0.286 Test Loss: 4.573 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5258491039276123
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.577 Vali Acc: 0.286 Test Loss: 4.577 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5099060535430908
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.585 Vali Acc: 0.287 Test Loss: 4.585 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5528836250305176
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.597 Vali Acc: 0.289 Test Loss: 4.597 Test Acc: 0.289
Validation loss decreased (-0.288190 --> -0.289366).  Saving model ...
Epoch: 46 cost time: 0.4681282043457031
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.625 Vali Acc: 0.291 Test Loss: 4.625 Test Acc: 0.291
Validation loss decreased (-0.289366 --> -0.290542).  Saving model ...
Epoch: 47 cost time: 0.477313756942749
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.626 Vali Acc: 0.295 Test Loss: 4.626 Test Acc: 0.295
Validation loss decreased (-0.290542 --> -0.295248).  Saving model ...
Epoch: 48 cost time: 0.5103206634521484
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.620 Vali Acc: 0.291 Test Loss: 4.620 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.49033308029174805
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.619 Vali Acc: 0.292 Test Loss: 4.619 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4941554069519043
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.642 Vali Acc: 0.291 Test Loss: 4.642 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.49851489067077637
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.648 Vali Acc: 0.288 Test Loss: 4.648 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5296320915222168
Epoch: 52, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.661 Vali Acc: 0.289 Test Loss: 4.661 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4820709228515625
Epoch: 53, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.673 Vali Acc: 0.286 Test Loss: 4.673 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.47706079483032227
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.667 Vali Acc: 0.289 Test Loss: 4.667 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5298070907592773
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.682 Vali Acc: 0.288 Test Loss: 4.682 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.48784399032592773
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.707 Vali Acc: 0.287 Test Loss: 4.707 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5764446258544922
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.725 Vali Acc: 0.288 Test Loss: 4.725 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 421786
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.442704200744629
Epoch: 1, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.340 Vali Acc: 0.035 Test Loss: 3.340 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5224738121032715
Epoch: 2, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.315 Vali Acc: 0.060 Test Loss: 3.315 Test Acc: 0.060
Validation loss decreased (-0.035261 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.465212345123291
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.306 Vali Acc: 0.068 Test Loss: 3.306 Test Acc: 0.068
Validation loss decreased (-0.059967 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.48821377754211426
Epoch: 4, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.298 Vali Acc: 0.088 Test Loss: 3.298 Test Acc: 0.088
Validation loss decreased (-0.068202 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 0.5054512023925781
Epoch: 5, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.289 Vali Acc: 0.108 Test Loss: 3.289 Test Acc: 0.108
Validation loss decreased (-0.088202 --> -0.108202).  Saving model ...
Epoch: 6 cost time: 0.5113375186920166
Epoch: 6, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.286 Vali Acc: 0.116 Test Loss: 3.286 Test Acc: 0.116
Validation loss decreased (-0.108202 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.5665242671966553
Epoch: 7, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.271 Vali Acc: 0.140 Test Loss: 3.271 Test Acc: 0.140
Validation loss decreased (-0.116438 --> -0.139967).  Saving model ...
Epoch: 8 cost time: 0.5187311172485352
Epoch: 8, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.277 Vali Acc: 0.165 Test Loss: 3.277 Test Acc: 0.165
Validation loss decreased (-0.139967 --> -0.164673).  Saving model ...
Epoch: 9 cost time: 0.4853184223175049
Epoch: 9, Steps: 10 | Train Loss: 1.574 Vali Loss: 3.311 Vali Acc: 0.185 Test Loss: 3.311 Test Acc: 0.185
Validation loss decreased (-0.164673 --> -0.184673).  Saving model ...
Epoch: 10 cost time: 0.5152103900909424
Epoch: 10, Steps: 10 | Train Loss: 1.327 Vali Loss: 3.358 Vali Acc: 0.195 Test Loss: 3.358 Test Acc: 0.195
Validation loss decreased (-0.184673 --> -0.195261).  Saving model ...
Epoch: 11 cost time: 0.5236959457397461
Epoch: 11, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.395 Vali Acc: 0.199 Test Loss: 3.395 Test Acc: 0.199
Validation loss decreased (-0.195261 --> -0.198790).  Saving model ...
Epoch: 12 cost time: 0.4798305034637451
Epoch: 12, Steps: 10 | Train Loss: 0.892 Vali Loss: 3.464 Vali Acc: 0.220 Test Loss: 3.464 Test Acc: 0.220
Validation loss decreased (-0.198790 --> -0.219965).  Saving model ...
Epoch: 13 cost time: 0.5857608318328857
Epoch: 13, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.535 Vali Acc: 0.224 Test Loss: 3.535 Test Acc: 0.224
Validation loss decreased (-0.219965 --> -0.223494).  Saving model ...
Epoch: 14 cost time: 0.5123989582061768
Epoch: 14, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.608 Vali Acc: 0.226 Test Loss: 3.608 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225846).  Saving model ...
Epoch: 15 cost time: 0.5125138759613037
Epoch: 15, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.682 Vali Acc: 0.236 Test Loss: 3.682 Test Acc: 0.236
Validation loss decreased (-0.225846 --> -0.236434).  Saving model ...
Epoch: 16 cost time: 0.5242037773132324
Epoch: 16, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.714 Vali Acc: 0.244 Test Loss: 3.714 Test Acc: 0.244
Validation loss decreased (-0.236434 --> -0.243492).  Saving model ...
Epoch: 17 cost time: 0.5466876029968262
Epoch: 17, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.766 Vali Acc: 0.254 Test Loss: 3.766 Test Acc: 0.254
Validation loss decreased (-0.243492 --> -0.254080).  Saving model ...
Epoch: 18 cost time: 0.49509167671203613
Epoch: 18, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.861 Vali Acc: 0.258 Test Loss: 3.861 Test Acc: 0.258
Validation loss decreased (-0.254080 --> -0.257608).  Saving model ...
Epoch: 19 cost time: 0.5371999740600586
Epoch: 19, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.919 Vali Acc: 0.262 Test Loss: 3.919 Test Acc: 0.262
Validation loss decreased (-0.257608 --> -0.262314).  Saving model ...
Epoch: 20 cost time: 0.4965524673461914
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.946 Vali Acc: 0.266 Test Loss: 3.946 Test Acc: 0.266
Validation loss decreased (-0.262314 --> -0.265843).  Saving model ...
Epoch: 21 cost time: 0.520543098449707
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.018 Vali Acc: 0.265 Test Loss: 4.018 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5612642765045166
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.072 Vali Acc: 0.259 Test Loss: 4.072 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5215814113616943
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.097 Vali Acc: 0.254 Test Loss: 4.097 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.481614351272583
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.124 Vali Acc: 0.254 Test Loss: 4.124 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5044004917144775
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.149 Vali Acc: 0.264 Test Loss: 4.149 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.48214221000671387
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.198 Vali Acc: 0.264 Test Loss: 4.198 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4999358654022217
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.243 Vali Acc: 0.271 Test Loss: 4.243 Test Acc: 0.271
Validation loss decreased (-0.265843 --> -0.270546).  Saving model ...
Epoch: 28 cost time: 0.48363208770751953
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.256 Vali Acc: 0.267 Test Loss: 4.256 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.509552001953125
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.268 Vali Acc: 0.262 Test Loss: 4.268 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4680943489074707
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.272 Vali Acc: 0.265 Test Loss: 4.272 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5147964954376221
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.278 Vali Acc: 0.268 Test Loss: 4.278 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5655896663665771
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.303 Vali Acc: 0.274 Test Loss: 4.303 Test Acc: 0.274
Validation loss decreased (-0.270546 --> -0.274075).  Saving model ...
Epoch: 33 cost time: 0.5471646785736084
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.339 Vali Acc: 0.271 Test Loss: 4.339 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5748541355133057
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.334 Vali Acc: 0.271 Test Loss: 4.334 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6080238819122314
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.343 Vali Acc: 0.273 Test Loss: 4.343 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5181372165679932
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.359 Vali Acc: 0.275 Test Loss: 4.359 Test Acc: 0.275
Validation loss decreased (-0.274075 --> -0.275251).  Saving model ...
Epoch: 37 cost time: 0.47530531883239746
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.409 Vali Acc: 0.266 Test Loss: 4.409 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4556159973144531
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.417 Vali Acc: 0.266 Test Loss: 4.417 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.49913692474365234
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.422 Vali Acc: 0.272 Test Loss: 4.422 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.538468599319458
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.453 Vali Acc: 0.268 Test Loss: 4.453 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5197856426239014
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.460 Vali Acc: 0.273 Test Loss: 4.460 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5367376804351807
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.483 Vali Acc: 0.272 Test Loss: 4.483 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4952971935272217
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.502 Vali Acc: 0.267 Test Loss: 4.502 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5921437740325928
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.504 Vali Acc: 0.265 Test Loss: 4.504 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.512871503829956
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.502 Vali Acc: 0.275 Test Loss: 4.502 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5145044326782227
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.513 Vali Acc: 0.271 Test Loss: 4.513 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 392858
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.2686047554016113
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.300 Vali Acc: 0.036 Test Loss: 3.300 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.4904744625091553
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.271 Vali Acc: 0.055 Test Loss: 3.271 Test Acc: 0.055
Validation loss decreased (-0.036438 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.49673914909362793
Epoch: 3, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.263 Vali Acc: 0.076 Test Loss: 3.263 Test Acc: 0.076
Validation loss decreased (-0.055261 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.4118010997772217
Epoch: 4, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.258 Vali Acc: 0.095 Test Loss: 3.258 Test Acc: 0.095
Validation loss decreased (-0.076438 --> -0.095262).  Saving model ...
Epoch: 5 cost time: 0.48500657081604004
Epoch: 5, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.259 Vali Acc: 0.113 Test Loss: 3.259 Test Acc: 0.113
Validation loss decreased (-0.095262 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.48998332023620605
Epoch: 6, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.245 Vali Acc: 0.144 Test Loss: 3.245 Test Acc: 0.144
Validation loss decreased (-0.112909 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 0.496992826461792
Epoch: 7, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.250 Vali Acc: 0.151 Test Loss: 3.250 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.4891824722290039
Epoch: 8, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.269 Vali Acc: 0.162 Test Loss: 3.269 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162320).  Saving model ...
Epoch: 9 cost time: 0.5020828247070312
Epoch: 9, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.302 Vali Acc: 0.173 Test Loss: 3.302 Test Acc: 0.173
Validation loss decreased (-0.162320 --> -0.172908).  Saving model ...
Epoch: 10 cost time: 0.5002224445343018
Epoch: 10, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.325 Vali Acc: 0.182 Test Loss: 3.325 Test Acc: 0.182
Validation loss decreased (-0.172908 --> -0.182320).  Saving model ...
Epoch: 11 cost time: 0.45148277282714844
Epoch: 11, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.357 Vali Acc: 0.200 Test Loss: 3.357 Test Acc: 0.200
Validation loss decreased (-0.182320 --> -0.199966).  Saving model ...
Epoch: 12 cost time: 0.49764347076416016
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.387 Vali Acc: 0.204 Test Loss: 3.387 Test Acc: 0.204
Validation loss decreased (-0.199966 --> -0.203496).  Saving model ...
Epoch: 13 cost time: 0.4986269474029541
Epoch: 13, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.450 Vali Acc: 0.208 Test Loss: 3.450 Test Acc: 0.208
Validation loss decreased (-0.203496 --> -0.208201).  Saving model ...
Epoch: 14 cost time: 0.4732396602630615
Epoch: 14, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.529 Vali Acc: 0.220 Test Loss: 3.529 Test Acc: 0.220
Validation loss decreased (-0.208201 --> -0.219965).  Saving model ...
Epoch: 15 cost time: 0.5227847099304199
Epoch: 15, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.555 Vali Acc: 0.228 Test Loss: 3.555 Test Acc: 0.228
Validation loss decreased (-0.219965 --> -0.228200).  Saving model ...
Epoch: 16 cost time: 0.4666414260864258
Epoch: 16, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.580 Vali Acc: 0.229 Test Loss: 3.580 Test Acc: 0.229
Validation loss decreased (-0.228200 --> -0.229376).  Saving model ...
Epoch: 17 cost time: 0.46346497535705566
Epoch: 17, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.661 Vali Acc: 0.222 Test Loss: 3.661 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.454573392868042
Epoch: 18, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.698 Vali Acc: 0.232 Test Loss: 3.698 Test Acc: 0.232
Validation loss decreased (-0.229376 --> -0.231728).  Saving model ...
Epoch: 19 cost time: 0.4228346347808838
Epoch: 19, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.763 Vali Acc: 0.249 Test Loss: 3.763 Test Acc: 0.249
Validation loss decreased (-0.231728 --> -0.249374).  Saving model ...
Epoch: 20 cost time: 0.5271303653717041
Epoch: 20, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.795 Vali Acc: 0.252 Test Loss: 3.795 Test Acc: 0.252
Validation loss decreased (-0.249374 --> -0.251727).  Saving model ...
Epoch: 21 cost time: 0.5209524631500244
Epoch: 21, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.868 Vali Acc: 0.252 Test Loss: 3.868 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46857380867004395
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.889 Vali Acc: 0.249 Test Loss: 3.889 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45580363273620605
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.887 Vali Acc: 0.260 Test Loss: 3.887 Test Acc: 0.260
Validation loss decreased (-0.251727 --> -0.259961).  Saving model ...
Epoch: 24 cost time: 0.47097206115722656
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.922 Vali Acc: 0.262 Test Loss: 3.922 Test Acc: 0.262
Validation loss decreased (-0.259961 --> -0.262314).  Saving model ...
Epoch: 25 cost time: 0.4441983699798584
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.968 Vali Acc: 0.266 Test Loss: 3.968 Test Acc: 0.266
Validation loss decreased (-0.262314 --> -0.265843).  Saving model ...
Epoch: 26 cost time: 0.47212886810302734
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.989 Vali Acc: 0.269 Test Loss: 3.989 Test Acc: 0.269
Validation loss decreased (-0.265843 --> -0.269372).  Saving model ...
Epoch: 27 cost time: 0.46663355827331543
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.011 Vali Acc: 0.269 Test Loss: 4.011 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.49716639518737793
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.033 Vali Acc: 0.268 Test Loss: 4.033 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.48573899269104004
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.036 Vali Acc: 0.273 Test Loss: 4.036 Test Acc: 0.273
Validation loss decreased (-0.269372 --> -0.272901).  Saving model ...
Epoch: 30 cost time: 0.5133469104766846
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.044 Vali Acc: 0.273 Test Loss: 4.044 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5005955696105957
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.051 Vali Acc: 0.276 Test Loss: 4.051 Test Acc: 0.276
Validation loss decreased (-0.272901 --> -0.276430).  Saving model ...
Epoch: 32 cost time: 0.502572774887085
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.077 Vali Acc: 0.275 Test Loss: 4.077 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5266718864440918
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.123 Vali Acc: 0.281 Test Loss: 4.123 Test Acc: 0.281
Validation loss decreased (-0.276430 --> -0.281135).  Saving model ...
Epoch: 34 cost time: 0.4718470573425293
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.138 Vali Acc: 0.281 Test Loss: 4.138 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.49277305603027344
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.153 Vali Acc: 0.279 Test Loss: 4.153 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.48439812660217285
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.152 Vali Acc: 0.285 Test Loss: 4.152 Test Acc: 0.285
Validation loss decreased (-0.281135 --> -0.284664).  Saving model ...
Epoch: 37 cost time: 0.5536608695983887
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.162 Vali Acc: 0.280 Test Loss: 4.162 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4742457866668701
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.180 Vali Acc: 0.281 Test Loss: 4.180 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.47028136253356934
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.205 Vali Acc: 0.280 Test Loss: 4.205 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5183427333831787
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.212 Vali Acc: 0.286 Test Loss: 4.212 Test Acc: 0.286
Validation loss decreased (-0.284664 --> -0.285840).  Saving model ...
Epoch: 41 cost time: 0.532318115234375
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.213 Vali Acc: 0.287 Test Loss: 4.213 Test Acc: 0.287
Validation loss decreased (-0.285840 --> -0.287017).  Saving model ...
Epoch: 42 cost time: 0.4262104034423828
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.241 Vali Acc: 0.292 Test Loss: 4.241 Test Acc: 0.292
Validation loss decreased (-0.287017 --> -0.291722).  Saving model ...
Epoch: 43 cost time: 0.4896559715270996
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.255 Vali Acc: 0.293 Test Loss: 4.255 Test Acc: 0.293
Validation loss decreased (-0.291722 --> -0.292899).  Saving model ...
Epoch: 44 cost time: 0.49619150161743164
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.267 Vali Acc: 0.288 Test Loss: 4.267 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5164713859558105
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.271 Vali Acc: 0.282 Test Loss: 4.271 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5140349864959717
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.295 Vali Acc: 0.280 Test Loss: 4.295 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4767589569091797
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.317 Vali Acc: 0.286 Test Loss: 4.317 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4714815616607666
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.330 Vali Acc: 0.286 Test Loss: 4.330 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5052239894866943
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.339 Vali Acc: 0.291 Test Loss: 4.339 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.49495434761047363
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.341 Vali Acc: 0.292 Test Loss: 4.341 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5164632797241211
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.349 Vali Acc: 0.291 Test Loss: 4.349 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.48271679878234863
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.344 Vali Acc: 0.287 Test Loss: 4.344 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.4556541442871094
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.359 Vali Acc: 0.287 Test Loss: 4.359 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 383770
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.404921293258667
Epoch: 1, Steps: 10 | Train Loss: 3.490 Vali Loss: 3.351 Vali Acc: 0.058 Test Loss: 3.351 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.5288803577423096
Epoch: 2, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.416 Vali Acc: 0.114 Test Loss: 3.416 Test Acc: 0.114
Validation loss decreased (-0.057614 --> -0.114083).  Saving model ...
Epoch: 3 cost time: 0.4831230640411377
Epoch: 3, Steps: 10 | Train Loss: 2.229 Vali Loss: 3.238 Vali Acc: 0.160 Test Loss: 3.238 Test Acc: 0.160
Validation loss decreased (-0.114083 --> -0.159968).  Saving model ...
Epoch: 4 cost time: 0.5143153667449951
Epoch: 4, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.460 Vali Acc: 0.181 Test Loss: 3.460 Test Acc: 0.181
Validation loss decreased (-0.159968 --> -0.181142).  Saving model ...
Epoch: 5 cost time: 0.5265271663665771
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.595 Vali Acc: 0.204 Test Loss: 3.595 Test Acc: 0.204
Validation loss decreased (-0.181142 --> -0.203493).  Saving model ...
Epoch: 6 cost time: 0.4970879554748535
Epoch: 6, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.835 Vali Acc: 0.222 Test Loss: 3.835 Test Acc: 0.222
Validation loss decreased (-0.203493 --> -0.222315).  Saving model ...
Epoch: 7 cost time: 0.4606668949127197
Epoch: 7, Steps: 10 | Train Loss: 0.286 Vali Loss: 4.109 Vali Acc: 0.228 Test Loss: 4.109 Test Acc: 0.228
Validation loss decreased (-0.222315 --> -0.228194).  Saving model ...
Epoch: 8 cost time: 0.5150411128997803
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.479 Vali Acc: 0.224 Test Loss: 4.479 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48830389976501465
Epoch: 9, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.721 Vali Acc: 0.218 Test Loss: 4.721 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.45291638374328613
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 5.032 Vali Acc: 0.225 Test Loss: 5.032 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4517068862915039
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 5.327 Vali Acc: 0.219 Test Loss: 5.327 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5011727809906006
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.366 Vali Acc: 0.242 Test Loss: 5.366 Test Acc: 0.242
Validation loss decreased (-0.228194 --> -0.242299).  Saving model ...
Epoch: 13 cost time: 0.4736177921295166
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.681 Vali Acc: 0.234 Test Loss: 5.681 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5256462097167969
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.576 Vali Acc: 0.255 Test Loss: 5.576 Test Acc: 0.255
Validation loss decreased (-0.242299 --> -0.255238).  Saving model ...
Epoch: 15 cost time: 0.4684443473815918
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.891 Vali Acc: 0.232 Test Loss: 5.891 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5294888019561768
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.014 Vali Acc: 0.251 Test Loss: 6.014 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.509833812713623
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.927 Vali Acc: 0.259 Test Loss: 5.927 Test Acc: 0.259
Validation loss decreased (-0.255238 --> -0.258764).  Saving model ...
Epoch: 18 cost time: 0.508556604385376
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.942 Vali Acc: 0.268 Test Loss: 5.942 Test Acc: 0.268
Validation loss decreased (-0.258764 --> -0.268176).  Saving model ...
Epoch: 19 cost time: 0.574622392654419
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.952 Vali Acc: 0.268 Test Loss: 5.952 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5494420528411865
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.946 Vali Acc: 0.268 Test Loss: 5.946 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.47884273529052734
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.960 Vali Acc: 0.269 Test Loss: 5.960 Test Acc: 0.269
Validation loss decreased (-0.268176 --> -0.269352).  Saving model ...
Epoch: 22 cost time: 0.4955782890319824
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.951 Vali Acc: 0.269 Test Loss: 5.951 Test Acc: 0.269
Validation loss decreased (-0.269352 --> -0.269352).  Saving model ...
Epoch: 23 cost time: 0.519420862197876
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.971 Vali Acc: 0.271 Test Loss: 5.971 Test Acc: 0.271
Validation loss decreased (-0.269352 --> -0.270529).  Saving model ...
Epoch: 24 cost time: 0.47461485862731934
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.964 Vali Acc: 0.269 Test Loss: 5.964 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5274405479431152
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.952 Vali Acc: 0.269 Test Loss: 5.952 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4560971260070801
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.971 Vali Acc: 0.268 Test Loss: 5.971 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5002264976501465
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.975 Vali Acc: 0.269 Test Loss: 5.975 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.49335551261901855
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.979 Vali Acc: 0.269 Test Loss: 5.979 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5291342735290527
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.992 Vali Acc: 0.269 Test Loss: 5.992 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5017898082733154
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.987 Vali Acc: 0.271 Test Loss: 5.987 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4834249019622803
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.994 Vali Acc: 0.268 Test Loss: 5.994 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.47037386894226074
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.002 Vali Acc: 0.268 Test Loss: 6.002 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.45891690254211426
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.010 Vali Acc: 0.267 Test Loss: 6.010 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 1008986
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3395233154296875
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.303 Vali Acc: 0.051 Test Loss: 3.303 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.5034229755401611
Epoch: 2, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.395 Vali Acc: 0.074 Test Loss: 3.395 Test Acc: 0.074
Validation loss decreased (-0.050555 --> -0.074084).  Saving model ...
Epoch: 3 cost time: 0.5105800628662109
Epoch: 3, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.273 Vali Acc: 0.128 Test Loss: 3.273 Test Acc: 0.128
Validation loss decreased (-0.074084 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 0.5216126441955566
Epoch: 4, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.229 Vali Acc: 0.140 Test Loss: 3.229 Test Acc: 0.140
Validation loss decreased (-0.128203 --> -0.139968).  Saving model ...
Epoch: 5 cost time: 0.5217788219451904
Epoch: 5, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.370 Vali Acc: 0.175 Test Loss: 3.370 Test Acc: 0.175
Validation loss decreased (-0.139968 --> -0.175260).  Saving model ...
Epoch: 6 cost time: 0.49178171157836914
Epoch: 6, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.425 Vali Acc: 0.192 Test Loss: 3.425 Test Acc: 0.192
Validation loss decreased (-0.175260 --> -0.191730).  Saving model ...
Epoch: 7 cost time: 0.5577375888824463
Epoch: 7, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.538 Vali Acc: 0.227 Test Loss: 3.538 Test Acc: 0.227
Validation loss decreased (-0.191730 --> -0.227023).  Saving model ...
Epoch: 8 cost time: 0.502208948135376
Epoch: 8, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.747 Vali Acc: 0.228 Test Loss: 3.747 Test Acc: 0.228
Validation loss decreased (-0.227023 --> -0.228198).  Saving model ...
Epoch: 9 cost time: 0.4769704341888428
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.843 Vali Acc: 0.220 Test Loss: 3.843 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4809756278991699
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.116 Vali Acc: 0.240 Test Loss: 4.116 Test Acc: 0.240
Validation loss decreased (-0.228198 --> -0.239959).  Saving model ...
Epoch: 11 cost time: 0.5365145206451416
Epoch: 11, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.158 Vali Acc: 0.233 Test Loss: 4.158 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5553328990936279
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.429 Vali Acc: 0.241 Test Loss: 4.429 Test Acc: 0.241
Validation loss decreased (-0.239959 --> -0.241132).  Saving model ...
Epoch: 13 cost time: 0.4866163730621338
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.655 Vali Acc: 0.245 Test Loss: 4.655 Test Acc: 0.245
Validation loss decreased (-0.241132 --> -0.244659).  Saving model ...
Epoch: 14 cost time: 0.4926023483276367
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.690 Vali Acc: 0.254 Test Loss: 4.690 Test Acc: 0.254
Validation loss decreased (-0.244659 --> -0.254071).  Saving model ...
Epoch: 15 cost time: 0.4939305782318115
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.703 Vali Acc: 0.248 Test Loss: 4.703 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5549905300140381
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.869 Vali Acc: 0.239 Test Loss: 4.869 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5360651016235352
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.950 Vali Acc: 0.244 Test Loss: 4.950 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4713139533996582
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.962 Vali Acc: 0.247 Test Loss: 4.962 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5352346897125244
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.995 Vali Acc: 0.253 Test Loss: 4.995 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5065078735351562
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.007 Vali Acc: 0.256 Test Loss: 5.007 Test Acc: 0.256
Validation loss decreased (-0.254071 --> -0.256421).  Saving model ...
Epoch: 21 cost time: 0.5509219169616699
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.022 Vali Acc: 0.252 Test Loss: 5.022 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.525853157043457
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.049 Vali Acc: 0.251 Test Loss: 5.049 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4684429168701172
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.067 Vali Acc: 0.254 Test Loss: 5.067 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5039010047912598
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.128 Vali Acc: 0.244 Test Loss: 5.128 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5076339244842529
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.125 Vali Acc: 0.247 Test Loss: 5.125 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.49730587005615234
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.113 Vali Acc: 0.247 Test Loss: 5.113 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5242099761962891
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.130 Vali Acc: 0.249 Test Loss: 5.130 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5808155536651611
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.134 Vali Acc: 0.251 Test Loss: 5.134 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5106451511383057
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.147 Vali Acc: 0.251 Test Loss: 5.147 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.500342607498169
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.170 Vali Acc: 0.252 Test Loss: 5.170 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 630106
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.40657377243042
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.348 Vali Acc: 0.034 Test Loss: 3.348 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4478292465209961
Epoch: 2, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.382 Vali Acc: 0.073 Test Loss: 3.382 Test Acc: 0.073
Validation loss decreased (-0.034084 --> -0.072907).  Saving model ...
Epoch: 3 cost time: 0.4495723247528076
Epoch: 3, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.342 Vali Acc: 0.104 Test Loss: 3.342 Test Acc: 0.104
Validation loss decreased (-0.072907 --> -0.103496).  Saving model ...
Epoch: 4 cost time: 0.5084109306335449
Epoch: 4, Steps: 10 | Train Loss: 2.330 Vali Loss: 3.275 Vali Acc: 0.120 Test Loss: 3.275 Test Acc: 0.120
Validation loss decreased (-0.103496 --> -0.119967).  Saving model ...
Epoch: 5 cost time: 0.49458932876586914
Epoch: 5, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.253 Vali Acc: 0.154 Test Loss: 3.253 Test Acc: 0.154
Validation loss decreased (-0.119967 --> -0.154085).  Saving model ...
Epoch: 6 cost time: 0.4877150058746338
Epoch: 6, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.308 Vali Acc: 0.175 Test Loss: 3.308 Test Acc: 0.175
Validation loss decreased (-0.154085 --> -0.175261).  Saving model ...
Epoch: 7 cost time: 0.6128082275390625
Epoch: 7, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.397 Vali Acc: 0.181 Test Loss: 3.397 Test Acc: 0.181
Validation loss decreased (-0.175261 --> -0.181143).  Saving model ...
Epoch: 8 cost time: 0.606734037399292
Epoch: 8, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.432 Vali Acc: 0.211 Test Loss: 3.432 Test Acc: 0.211
Validation loss decreased (-0.181143 --> -0.210554).  Saving model ...
Epoch: 9 cost time: 0.5332143306732178
Epoch: 9, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.541 Vali Acc: 0.227 Test Loss: 3.541 Test Acc: 0.227
Validation loss decreased (-0.210554 --> -0.227023).  Saving model ...
Epoch: 10 cost time: 0.5284602642059326
Epoch: 10, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.679 Vali Acc: 0.222 Test Loss: 3.679 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5617754459381104
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.769 Vali Acc: 0.245 Test Loss: 3.769 Test Acc: 0.245
Validation loss decreased (-0.227023 --> -0.244668).  Saving model ...
Epoch: 12 cost time: 0.5241611003875732
Epoch: 12, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.997 Vali Acc: 0.240 Test Loss: 3.997 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5405724048614502
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.024 Vali Acc: 0.252 Test Loss: 4.024 Test Acc: 0.252
Validation loss decreased (-0.244668 --> -0.251724).  Saving model ...
Epoch: 14 cost time: 0.5442972183227539
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.156 Vali Acc: 0.253 Test Loss: 4.156 Test Acc: 0.253
Validation loss decreased (-0.251724 --> -0.252900).  Saving model ...
Epoch: 15 cost time: 0.560882568359375
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.352 Vali Acc: 0.244 Test Loss: 4.352 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5207192897796631
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.346 Vali Acc: 0.256 Test Loss: 4.346 Test Acc: 0.256
Validation loss decreased (-0.252900 --> -0.256427).  Saving model ...
Epoch: 17 cost time: 0.5518126487731934
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.406 Vali Acc: 0.258 Test Loss: 4.406 Test Acc: 0.258
Validation loss decreased (-0.256427 --> -0.257603).  Saving model ...
Epoch: 18 cost time: 0.5483999252319336
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.444 Vali Acc: 0.259 Test Loss: 4.444 Test Acc: 0.259
Validation loss decreased (-0.257603 --> -0.258779).  Saving model ...
Epoch: 19 cost time: 0.557915210723877
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.407 Vali Acc: 0.259 Test Loss: 4.407 Test Acc: 0.259
Validation loss decreased (-0.258779 --> -0.258779).  Saving model ...
Epoch: 20 cost time: 0.6212561130523682
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.490 Vali Acc: 0.258 Test Loss: 4.490 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5838644504547119
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.585 Vali Acc: 0.261 Test Loss: 4.585 Test Acc: 0.261
Validation loss decreased (-0.258779 --> -0.261131).  Saving model ...
Epoch: 22 cost time: 0.543137788772583
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.602 Vali Acc: 0.261 Test Loss: 4.602 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5060679912567139
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.586 Vali Acc: 0.262 Test Loss: 4.586 Test Acc: 0.262
Validation loss decreased (-0.261131 --> -0.262307).  Saving model ...
Epoch: 24 cost time: 0.5789852142333984
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.586 Vali Acc: 0.259 Test Loss: 4.586 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5115232467651367
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.602 Vali Acc: 0.264 Test Loss: 4.602 Test Acc: 0.264
Validation loss decreased (-0.262307 --> -0.263483).  Saving model ...
Epoch: 26 cost time: 0.5293195247650146
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.632 Vali Acc: 0.261 Test Loss: 4.632 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4279017448425293
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.663 Vali Acc: 0.268 Test Loss: 4.663 Test Acc: 0.268
Validation loss decreased (-0.263483 --> -0.268189).  Saving model ...
Epoch: 28 cost time: 0.4966132640838623
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.677 Vali Acc: 0.267 Test Loss: 4.677 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5317890644073486
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.710 Vali Acc: 0.266 Test Loss: 4.710 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.550708532333374
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.721 Vali Acc: 0.272 Test Loss: 4.721 Test Acc: 0.272
Validation loss decreased (-0.268189 --> -0.271717).  Saving model ...
Epoch: 31 cost time: 0.509610652923584
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.729 Vali Acc: 0.269 Test Loss: 4.729 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5614662170410156
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.738 Vali Acc: 0.269 Test Loss: 4.738 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5140643119812012
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.746 Vali Acc: 0.269 Test Loss: 4.746 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.507164478302002
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.757 Vali Acc: 0.272 Test Loss: 4.757 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5449113845825195
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.768 Vali Acc: 0.274 Test Loss: 4.768 Test Acc: 0.274
Validation loss decreased (-0.271717 --> -0.274070).  Saving model ...
Epoch: 36 cost time: 0.5613312721252441
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.780 Vali Acc: 0.273 Test Loss: 4.780 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5475172996520996
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.801 Vali Acc: 0.274 Test Loss: 4.801 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5200469493865967
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.824 Vali Acc: 0.272 Test Loss: 4.824 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5133228302001953
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.831 Vali Acc: 0.276 Test Loss: 4.831 Test Acc: 0.276
Validation loss decreased (-0.274070 --> -0.276422).  Saving model ...
Epoch: 40 cost time: 0.5572991371154785
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.845 Vali Acc: 0.275 Test Loss: 4.845 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5466842651367188
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.849 Vali Acc: 0.275 Test Loss: 4.849 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5436716079711914
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.858 Vali Acc: 0.279 Test Loss: 4.858 Test Acc: 0.279
Validation loss decreased (-0.276422 --> -0.278775).  Saving model ...
Epoch: 43 cost time: 0.5819556713104248
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.877 Vali Acc: 0.278 Test Loss: 4.877 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5289771556854248
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.895 Vali Acc: 0.276 Test Loss: 4.895 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5180239677429199
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.908 Vali Acc: 0.279 Test Loss: 4.908 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5179057121276855
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.932 Vali Acc: 0.278 Test Loss: 4.932 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5270669460296631
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.934 Vali Acc: 0.280 Test Loss: 4.934 Test Acc: 0.280
Validation loss decreased (-0.278775 --> -0.279951).  Saving model ...
Epoch: 48 cost time: 0.4870476722717285
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.929 Vali Acc: 0.276 Test Loss: 4.929 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5013160705566406
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.940 Vali Acc: 0.278 Test Loss: 4.940 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5336055755615234
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.944 Vali Acc: 0.274 Test Loss: 4.944 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5073556900024414
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.951 Vali Acc: 0.279 Test Loss: 4.951 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.49377870559692383
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.960 Vali Acc: 0.280 Test Loss: 4.960 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5976748466491699
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.977 Vali Acc: 0.288 Test Loss: 4.977 Test Acc: 0.288
Validation loss decreased (-0.279951 --> -0.288186).  Saving model ...
Epoch: 54 cost time: 0.5881240367889404
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.994 Vali Acc: 0.286 Test Loss: 4.994 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5407674312591553
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.999 Vali Acc: 0.285 Test Loss: 4.999 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5998818874359131
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.006 Vali Acc: 0.285 Test Loss: 5.006 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5925376415252686
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.020 Vali Acc: 0.284 Test Loss: 5.020 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5434310436248779
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.032 Vali Acc: 0.286 Test Loss: 5.032 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5010638236999512
Epoch: 59, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.045 Vali Acc: 0.281 Test Loss: 5.045 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5521037578582764
Epoch: 60, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.058 Vali Acc: 0.281 Test Loss: 5.058 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5380074977874756
Epoch: 61, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.059 Vali Acc: 0.284 Test Loss: 5.059 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5167486667633057
Epoch: 62, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.051 Vali Acc: 0.286 Test Loss: 5.051 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.6016480922698975
Epoch: 63, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.061 Vali Acc: 0.284 Test Loss: 5.061 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 500826
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5496795177459717
Epoch: 1, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.309 Vali Acc: 0.054 Test Loss: 3.309 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.5413649082183838
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.286 Vali Acc: 0.080 Test Loss: 3.286 Test Acc: 0.080
Validation loss decreased (-0.054085 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 0.4945187568664551
Epoch: 3, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.296 Vali Acc: 0.102 Test Loss: 3.296 Test Acc: 0.102
Validation loss decreased (-0.079967 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 0.4935495853424072
Epoch: 4, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.229 Vali Acc: 0.112 Test Loss: 3.229 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 0.5272159576416016
Epoch: 5, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.177 Vali Acc: 0.148 Test Loss: 3.177 Test Acc: 0.148
Validation loss decreased (-0.111732 --> -0.148204).  Saving model ...
Epoch: 6 cost time: 0.4731428623199463
Epoch: 6, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.181 Vali Acc: 0.180 Test Loss: 3.181 Test Acc: 0.180
Validation loss decreased (-0.148204 --> -0.179968).  Saving model ...
Epoch: 7 cost time: 0.4903597831726074
Epoch: 7, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.263 Vali Acc: 0.182 Test Loss: 3.263 Test Acc: 0.182
Validation loss decreased (-0.179968 --> -0.182320).  Saving model ...
Epoch: 8 cost time: 0.5036461353302002
Epoch: 8, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.304 Vali Acc: 0.201 Test Loss: 3.304 Test Acc: 0.201
Validation loss decreased (-0.182320 --> -0.201143).  Saving model ...
Epoch: 9 cost time: 0.5249207019805908
Epoch: 9, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.352 Vali Acc: 0.207 Test Loss: 3.352 Test Acc: 0.207
Validation loss decreased (-0.201143 --> -0.207025).  Saving model ...
Epoch: 10 cost time: 0.5410778522491455
Epoch: 10, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.439 Vali Acc: 0.233 Test Loss: 3.439 Test Acc: 0.233
Validation loss decreased (-0.207025 --> -0.232907).  Saving model ...
Epoch: 11 cost time: 0.544424295425415
Epoch: 11, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.540 Vali Acc: 0.235 Test Loss: 3.540 Test Acc: 0.235
Validation loss decreased (-0.232907 --> -0.235259).  Saving model ...
Epoch: 12 cost time: 0.5069704055786133
Epoch: 12, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.669 Vali Acc: 0.240 Test Loss: 3.669 Test Acc: 0.240
Validation loss decreased (-0.235259 --> -0.239963).  Saving model ...
Epoch: 13 cost time: 0.5462558269500732
Epoch: 13, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.822 Vali Acc: 0.239 Test Loss: 3.822 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.58060622215271
Epoch: 14, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.955 Vali Acc: 0.242 Test Loss: 3.955 Test Acc: 0.242
Validation loss decreased (-0.239963 --> -0.242313).  Saving model ...
Epoch: 15 cost time: 0.5123898983001709
Epoch: 15, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.116 Vali Acc: 0.248 Test Loss: 4.116 Test Acc: 0.248
Validation loss decreased (-0.242313 --> -0.248194).  Saving model ...
Epoch: 16 cost time: 0.5376825332641602
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.142 Vali Acc: 0.244 Test Loss: 4.142 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5411622524261475
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.165 Vali Acc: 0.242 Test Loss: 4.165 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.543595552444458
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.275 Vali Acc: 0.249 Test Loss: 4.275 Test Acc: 0.249
Validation loss decreased (-0.248194 --> -0.249369).  Saving model ...
Epoch: 19 cost time: 0.530998706817627
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.386 Vali Acc: 0.241 Test Loss: 4.386 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5230700969696045
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.404 Vali Acc: 0.239 Test Loss: 4.404 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5777275562286377
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.397 Vali Acc: 0.252 Test Loss: 4.397 Test Acc: 0.252
Validation loss decreased (-0.249369 --> -0.251721).  Saving model ...
Epoch: 22 cost time: 0.5489523410797119
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.419 Vali Acc: 0.253 Test Loss: 4.419 Test Acc: 0.253
Validation loss decreased (-0.251721 --> -0.252897).  Saving model ...
Epoch: 23 cost time: 0.5702047348022461
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.465 Vali Acc: 0.256 Test Loss: 4.465 Test Acc: 0.256
Validation loss decreased (-0.252897 --> -0.256426).  Saving model ...
Epoch: 24 cost time: 0.5073451995849609
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.505 Vali Acc: 0.262 Test Loss: 4.505 Test Acc: 0.262
Validation loss decreased (-0.256426 --> -0.262308).  Saving model ...
Epoch: 25 cost time: 0.5158753395080566
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.532 Vali Acc: 0.255 Test Loss: 4.532 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5254344940185547
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.571 Vali Acc: 0.247 Test Loss: 4.571 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5270161628723145
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.577 Vali Acc: 0.248 Test Loss: 4.577 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5322933197021484
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.574 Vali Acc: 0.251 Test Loss: 4.574 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5642340183258057
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.591 Vali Acc: 0.248 Test Loss: 4.591 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5668492317199707
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.612 Vali Acc: 0.249 Test Loss: 4.612 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5101680755615234
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.651 Vali Acc: 0.252 Test Loss: 4.651 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5126867294311523
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.665 Vali Acc: 0.254 Test Loss: 4.665 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5439267158508301
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.669 Vali Acc: 0.255 Test Loss: 4.669 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5247595310211182
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.700 Vali Acc: 0.252 Test Loss: 4.700 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 441434
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8393332958221436
Epoch: 1, Steps: 10 | Train Loss: 3.395 Vali Loss: 3.326 Vali Acc: 0.051 Test Loss: 3.326 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.5501463413238525
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.309 Vali Acc: 0.067 Test Loss: 3.309 Test Acc: 0.067
Validation loss decreased (-0.050555 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.5290682315826416
Epoch: 3, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.313 Vali Acc: 0.089 Test Loss: 3.313 Test Acc: 0.089
Validation loss decreased (-0.067026 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.5277841091156006
Epoch: 4, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.321 Vali Acc: 0.101 Test Loss: 3.321 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101143).  Saving model ...
Epoch: 5 cost time: 0.573420524597168
Epoch: 5, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.272 Vali Acc: 0.124 Test Loss: 3.272 Test Acc: 0.124
Validation loss decreased (-0.101143 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.47595667839050293
Epoch: 6, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.257 Vali Acc: 0.155 Test Loss: 3.257 Test Acc: 0.155
Validation loss decreased (-0.123497 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.5736603736877441
Epoch: 7, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.264 Vali Acc: 0.171 Test Loss: 3.264 Test Acc: 0.171
Validation loss decreased (-0.155262 --> -0.170556).  Saving model ...
Epoch: 8 cost time: 0.5439643859863281
Epoch: 8, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.281 Vali Acc: 0.191 Test Loss: 3.281 Test Acc: 0.191
Validation loss decreased (-0.170556 --> -0.190555).  Saving model ...
Epoch: 9 cost time: 0.5538833141326904
Epoch: 9, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.310 Vali Acc: 0.201 Test Loss: 3.310 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201143).  Saving model ...
Epoch: 10 cost time: 0.5439193248748779
Epoch: 10, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.364 Vali Acc: 0.219 Test Loss: 3.364 Test Acc: 0.219
Validation loss decreased (-0.201143 --> -0.218790).  Saving model ...
Epoch: 11 cost time: 0.4937877655029297
Epoch: 11, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.416 Vali Acc: 0.227 Test Loss: 3.416 Test Acc: 0.227
Validation loss decreased (-0.218790 --> -0.227025).  Saving model ...
Epoch: 12 cost time: 0.5084202289581299
Epoch: 12, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.479 Vali Acc: 0.238 Test Loss: 3.479 Test Acc: 0.238
Validation loss decreased (-0.227025 --> -0.237612).  Saving model ...
Epoch: 13 cost time: 0.537543535232544
Epoch: 13, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.559 Vali Acc: 0.239 Test Loss: 3.559 Test Acc: 0.239
Validation loss decreased (-0.237612 --> -0.238788).  Saving model ...
Epoch: 14 cost time: 0.5805368423461914
Epoch: 14, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.650 Vali Acc: 0.232 Test Loss: 3.650 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4999551773071289
Epoch: 15, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.756 Vali Acc: 0.240 Test Loss: 3.756 Test Acc: 0.240
Validation loss decreased (-0.238788 --> -0.239962).  Saving model ...
Epoch: 16 cost time: 0.4961719512939453
Epoch: 16, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.889 Vali Acc: 0.234 Test Loss: 3.889 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5100324153900146
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.935 Vali Acc: 0.253 Test Loss: 3.935 Test Acc: 0.253
Validation loss decreased (-0.239962 --> -0.252902).  Saving model ...
Epoch: 18 cost time: 0.5103285312652588
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.995 Vali Acc: 0.260 Test Loss: 3.995 Test Acc: 0.260
Validation loss decreased (-0.252902 --> -0.259960).  Saving model ...
Epoch: 19 cost time: 0.5418989658355713
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.031 Vali Acc: 0.256 Test Loss: 4.031 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5167834758758545
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.086 Vali Acc: 0.254 Test Loss: 4.086 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4708549976348877
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.125 Vali Acc: 0.251 Test Loss: 4.125 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5188412666320801
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.186 Vali Acc: 0.260 Test Loss: 4.186 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5146389007568359
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.199 Vali Acc: 0.260 Test Loss: 4.199 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5628535747528076
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.205 Vali Acc: 0.265 Test Loss: 4.205 Test Acc: 0.265
Validation loss decreased (-0.259960 --> -0.264664).  Saving model ...
Epoch: 25 cost time: 0.5068156719207764
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.222 Vali Acc: 0.267 Test Loss: 4.222 Test Acc: 0.267
Validation loss decreased (-0.264664 --> -0.267017).  Saving model ...
Epoch: 26 cost time: 0.4804551601409912
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.245 Vali Acc: 0.271 Test Loss: 4.245 Test Acc: 0.271
Validation loss decreased (-0.267017 --> -0.270546).  Saving model ...
Epoch: 27 cost time: 0.5132019519805908
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.254 Vali Acc: 0.269 Test Loss: 4.254 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5271070003509521
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.293 Vali Acc: 0.265 Test Loss: 4.293 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4826185703277588
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.313 Vali Acc: 0.261 Test Loss: 4.313 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5205910205841064
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.342 Vali Acc: 0.258 Test Loss: 4.342 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.49279141426086426
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.354 Vali Acc: 0.265 Test Loss: 4.354 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4726388454437256
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.374 Vali Acc: 0.268 Test Loss: 4.374 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5283098220825195
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.383 Vali Acc: 0.273 Test Loss: 4.383 Test Acc: 0.273
Validation loss decreased (-0.270546 --> -0.272897).  Saving model ...
Epoch: 34 cost time: 0.5110387802124023
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.403 Vali Acc: 0.269 Test Loss: 4.403 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.552786111831665
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.416 Vali Acc: 0.267 Test Loss: 4.416 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5039544105529785
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.421 Vali Acc: 0.265 Test Loss: 4.421 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.48205089569091797
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.431 Vali Acc: 0.268 Test Loss: 4.431 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5812957286834717
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.444 Vali Acc: 0.269 Test Loss: 4.444 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5510978698730469
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.448 Vali Acc: 0.272 Test Loss: 4.448 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5424330234527588
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.454 Vali Acc: 0.273 Test Loss: 4.454 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5735471248626709
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.472 Vali Acc: 0.275 Test Loss: 4.472 Test Acc: 0.275
Validation loss decreased (-0.272897 --> -0.275249).  Saving model ...
Epoch: 42 cost time: 0.5306634902954102
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.492 Vali Acc: 0.278 Test Loss: 4.492 Test Acc: 0.278
Validation loss decreased (-0.275249 --> -0.277602).  Saving model ...
Epoch: 43 cost time: 0.5834321975708008
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.500 Vali Acc: 0.280 Test Loss: 4.500 Test Acc: 0.280
Validation loss decreased (-0.277602 --> -0.279955).  Saving model ...
Epoch: 44 cost time: 0.5649526119232178
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.501 Vali Acc: 0.280 Test Loss: 4.501 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4899928569793701
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.511 Vali Acc: 0.280 Test Loss: 4.511 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.44861865043640137
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.525 Vali Acc: 0.280 Test Loss: 4.525 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5589630603790283
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.537 Vali Acc: 0.284 Test Loss: 4.537 Test Acc: 0.284
Validation loss decreased (-0.279955 --> -0.283484).  Saving model ...
Epoch: 48 cost time: 0.5733389854431152
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.554 Vali Acc: 0.282 Test Loss: 4.554 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5362029075622559
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.558 Vali Acc: 0.286 Test Loss: 4.558 Test Acc: 0.286
Validation loss decreased (-0.283484 --> -0.285837).  Saving model ...
Epoch: 50 cost time: 0.5554487705230713
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.558 Vali Acc: 0.287 Test Loss: 4.558 Test Acc: 0.287
Validation loss decreased (-0.285837 --> -0.287013).  Saving model ...
Epoch: 51 cost time: 0.5480806827545166
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.567 Vali Acc: 0.288 Test Loss: 4.567 Test Acc: 0.288
Validation loss decreased (-0.287013 --> -0.288190).  Saving model ...
Epoch: 52 cost time: 0.5641310214996338
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.574 Vali Acc: 0.287 Test Loss: 4.574 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5341167449951172
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.583 Vali Acc: 0.282 Test Loss: 4.583 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5559916496276855
Epoch: 54, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.593 Vali Acc: 0.284 Test Loss: 4.593 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5258309841156006
Epoch: 55, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.602 Vali Acc: 0.285 Test Loss: 4.602 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4925520420074463
Epoch: 56, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.612 Vali Acc: 0.281 Test Loss: 4.612 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5056753158569336
Epoch: 57, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.627 Vali Acc: 0.287 Test Loss: 4.627 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5430560111999512
Epoch: 58, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.634 Vali Acc: 0.285 Test Loss: 4.634 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5488295555114746
Epoch: 59, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.648 Vali Acc: 0.282 Test Loss: 4.648 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5027174949645996
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.657 Vali Acc: 0.282 Test Loss: 4.657 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5123546123504639
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.657 Vali Acc: 0.285 Test Loss: 4.657 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 372442
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5618207454681396
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.365 Vali Acc: 0.029 Test Loss: 3.365 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.47618532180786133
Epoch: 2, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.339 Vali Acc: 0.048 Test Loss: 3.339 Test Acc: 0.048
Validation loss decreased (-0.029378 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.4660170078277588
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.323 Vali Acc: 0.081 Test Loss: 3.323 Test Acc: 0.081
Validation loss decreased (-0.048202 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.5175638198852539
Epoch: 4, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.315 Vali Acc: 0.089 Test Loss: 3.315 Test Acc: 0.089
Validation loss decreased (-0.081143 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 0.50758957862854
Epoch: 5, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.298 Vali Acc: 0.107 Test Loss: 3.298 Test Acc: 0.107
Validation loss decreased (-0.089379 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 0.5299882888793945
Epoch: 6, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.286 Vali Acc: 0.121 Test Loss: 3.286 Test Acc: 0.121
Validation loss decreased (-0.107026 --> -0.121144).  Saving model ...
Epoch: 7 cost time: 0.48853564262390137
Epoch: 7, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.283 Vali Acc: 0.134 Test Loss: 3.283 Test Acc: 0.134
Validation loss decreased (-0.121144 --> -0.134085).  Saving model ...
Epoch: 8 cost time: 0.49775266647338867
Epoch: 8, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.285 Vali Acc: 0.154 Test Loss: 3.285 Test Acc: 0.154
Validation loss decreased (-0.134085 --> -0.154085).  Saving model ...
Epoch: 9 cost time: 0.5110797882080078
Epoch: 9, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.306 Vali Acc: 0.179 Test Loss: 3.306 Test Acc: 0.179
Validation loss decreased (-0.154085 --> -0.178790).  Saving model ...
Epoch: 10 cost time: 0.5170800685882568
Epoch: 10, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.359 Vali Acc: 0.184 Test Loss: 3.359 Test Acc: 0.184
Validation loss decreased (-0.178790 --> -0.183496).  Saving model ...
Epoch: 11 cost time: 0.5196969509124756
Epoch: 11, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.424 Vali Acc: 0.186 Test Loss: 3.424 Test Acc: 0.186
Validation loss decreased (-0.183496 --> -0.185848).  Saving model ...
Epoch: 12 cost time: 0.546945333480835
Epoch: 12, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.455 Vali Acc: 0.194 Test Loss: 3.455 Test Acc: 0.194
Validation loss decreased (-0.185848 --> -0.194083).  Saving model ...
Epoch: 13 cost time: 0.4959373474121094
Epoch: 13, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.535 Vali Acc: 0.200 Test Loss: 3.535 Test Acc: 0.200
Validation loss decreased (-0.194083 --> -0.199965).  Saving model ...
Epoch: 14 cost time: 0.5434515476226807
Epoch: 14, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.620 Vali Acc: 0.214 Test Loss: 3.620 Test Acc: 0.214
Validation loss decreased (-0.199965 --> -0.214081).  Saving model ...
Epoch: 15 cost time: 0.5375638008117676
Epoch: 15, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.676 Vali Acc: 0.224 Test Loss: 3.676 Test Acc: 0.224
Validation loss decreased (-0.214081 --> -0.223493).  Saving model ...
Epoch: 16 cost time: 0.4929158687591553
Epoch: 16, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.759 Vali Acc: 0.221 Test Loss: 3.759 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5092480182647705
Epoch: 17, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.884 Vali Acc: 0.227 Test Loss: 3.884 Test Acc: 0.227
Validation loss decreased (-0.223493 --> -0.227020).  Saving model ...
Epoch: 18 cost time: 0.5674912929534912
Epoch: 18, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.964 Vali Acc: 0.233 Test Loss: 3.964 Test Acc: 0.233
Validation loss decreased (-0.227020 --> -0.232902).  Saving model ...
Epoch: 19 cost time: 0.5069282054901123
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.069 Vali Acc: 0.233 Test Loss: 4.069 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5373055934906006
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.100 Vali Acc: 0.242 Test Loss: 4.100 Test Acc: 0.242
Validation loss decreased (-0.232902 --> -0.242312).  Saving model ...
Epoch: 21 cost time: 0.45372748374938965
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.086 Vali Acc: 0.247 Test Loss: 4.086 Test Acc: 0.247
Validation loss decreased (-0.242312 --> -0.247018).  Saving model ...
Epoch: 22 cost time: 0.5500040054321289
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.093 Vali Acc: 0.249 Test Loss: 4.093 Test Acc: 0.249
Validation loss decreased (-0.247018 --> -0.249371).  Saving model ...
Epoch: 23 cost time: 0.49794530868530273
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.136 Vali Acc: 0.254 Test Loss: 4.136 Test Acc: 0.254
Validation loss decreased (-0.249371 --> -0.254076).  Saving model ...
Epoch: 24 cost time: 0.49561119079589844
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.201 Vali Acc: 0.251 Test Loss: 4.201 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5287895202636719
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.273 Vali Acc: 0.255 Test Loss: 4.273 Test Acc: 0.255
Validation loss decreased (-0.254076 --> -0.255251).  Saving model ...
Epoch: 26 cost time: 0.5251970291137695
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.301 Vali Acc: 0.252 Test Loss: 4.301 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5592043399810791
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.263 Vali Acc: 0.259 Test Loss: 4.263 Test Acc: 0.259
Validation loss decreased (-0.255251 --> -0.258781).  Saving model ...
Epoch: 28 cost time: 0.5195136070251465
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.275 Vali Acc: 0.261 Test Loss: 4.275 Test Acc: 0.261
Validation loss decreased (-0.258781 --> -0.261134).  Saving model ...
Epoch: 29 cost time: 0.5511157512664795
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.372 Vali Acc: 0.246 Test Loss: 4.372 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5199191570281982
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.372 Vali Acc: 0.252 Test Loss: 4.372 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5338823795318604
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.407 Vali Acc: 0.251 Test Loss: 4.407 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5572755336761475
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.398 Vali Acc: 0.253 Test Loss: 4.398 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5265672206878662
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.403 Vali Acc: 0.252 Test Loss: 4.403 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.517935037612915
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.421 Vali Acc: 0.254 Test Loss: 4.421 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5290381908416748
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.442 Vali Acc: 0.254 Test Loss: 4.442 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5188374519348145
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.458 Vali Acc: 0.259 Test Loss: 4.458 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.55303955078125
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.470 Vali Acc: 0.261 Test Loss: 4.470 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5462765693664551
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.461 Vali Acc: 0.260 Test Loss: 4.461 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 343514
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5207481384277344
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.328 Vali Acc: 0.031 Test Loss: 3.328 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.550764799118042
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.306 Vali Acc: 0.047 Test Loss: 3.306 Test Acc: 0.047
Validation loss decreased (-0.030555 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.5225460529327393
Epoch: 3, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.296 Vali Acc: 0.086 Test Loss: 3.296 Test Acc: 0.086
Validation loss decreased (-0.047026 --> -0.085849).  Saving model ...
Epoch: 4 cost time: 0.5534486770629883
Epoch: 4, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.290 Vali Acc: 0.098 Test Loss: 3.290 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 0.5432004928588867
Epoch: 5, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.290 Vali Acc: 0.111 Test Loss: 3.290 Test Acc: 0.111
Validation loss decreased (-0.097614 --> -0.110555).  Saving model ...
Epoch: 6 cost time: 0.5540578365325928
Epoch: 6, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.293 Vali Acc: 0.115 Test Loss: 3.293 Test Acc: 0.115
Validation loss decreased (-0.110555 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 0.5552377700805664
Epoch: 7, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.296 Vali Acc: 0.138 Test Loss: 3.296 Test Acc: 0.138
Validation loss decreased (-0.115261 --> -0.137614).  Saving model ...
Epoch: 8 cost time: 0.4981975555419922
Epoch: 8, Steps: 10 | Train Loss: 1.908 Vali Loss: 3.300 Vali Acc: 0.160 Test Loss: 3.300 Test Acc: 0.160
Validation loss decreased (-0.137614 --> -0.159967).  Saving model ...
Epoch: 9 cost time: 0.53098464012146
Epoch: 9, Steps: 10 | Train Loss: 1.668 Vali Loss: 3.311 Vali Acc: 0.167 Test Loss: 3.311 Test Acc: 0.167
Validation loss decreased (-0.159967 --> -0.167026).  Saving model ...
Epoch: 10 cost time: 0.5393004417419434
Epoch: 10, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.340 Vali Acc: 0.171 Test Loss: 3.340 Test Acc: 0.171
Validation loss decreased (-0.167026 --> -0.170555).  Saving model ...
Epoch: 11 cost time: 0.5082218647003174
Epoch: 11, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.372 Vali Acc: 0.191 Test Loss: 3.372 Test Acc: 0.191
Validation loss decreased (-0.170555 --> -0.190555).  Saving model ...
Epoch: 12 cost time: 0.5093894004821777
Epoch: 12, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.419 Vali Acc: 0.200 Test Loss: 3.419 Test Acc: 0.200
Validation loss decreased (-0.190555 --> -0.199966).  Saving model ...
Epoch: 13 cost time: 0.5386505126953125
Epoch: 13, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.464 Vali Acc: 0.225 Test Loss: 3.464 Test Acc: 0.225
Validation loss decreased (-0.199966 --> -0.224671).  Saving model ...
Epoch: 14 cost time: 0.4829854965209961
Epoch: 14, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.514 Vali Acc: 0.222 Test Loss: 3.514 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5430598258972168
Epoch: 15, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.585 Vali Acc: 0.231 Test Loss: 3.585 Test Acc: 0.231
Validation loss decreased (-0.224671 --> -0.230552).  Saving model ...
Epoch: 16 cost time: 0.6050102710723877
Epoch: 16, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.628 Vali Acc: 0.222 Test Loss: 3.628 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5007979869842529
Epoch: 17, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.699 Vali Acc: 0.226 Test Loss: 3.699 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5245010852813721
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.731 Vali Acc: 0.244 Test Loss: 3.731 Test Acc: 0.244
Validation loss decreased (-0.230552 --> -0.243492).  Saving model ...
Epoch: 19 cost time: 0.534168004989624
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.818 Vali Acc: 0.255 Test Loss: 3.818 Test Acc: 0.255
Validation loss decreased (-0.243492 --> -0.255256).  Saving model ...
Epoch: 20 cost time: 0.5420894622802734
Epoch: 20, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.863 Vali Acc: 0.259 Test Loss: 3.863 Test Acc: 0.259
Validation loss decreased (-0.255256 --> -0.258785).  Saving model ...
Epoch: 21 cost time: 0.5037176609039307
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.864 Vali Acc: 0.266 Test Loss: 3.864 Test Acc: 0.266
Validation loss decreased (-0.258785 --> -0.265844).  Saving model ...
Epoch: 22 cost time: 0.5086228847503662
Epoch: 22, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.955 Vali Acc: 0.269 Test Loss: 3.955 Test Acc: 0.269
Validation loss decreased (-0.265844 --> -0.269372).  Saving model ...
Epoch: 23 cost time: 0.5268852710723877
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.986 Vali Acc: 0.264 Test Loss: 3.986 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5135402679443359
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.009 Vali Acc: 0.267 Test Loss: 4.009 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4994025230407715
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.009 Vali Acc: 0.265 Test Loss: 4.009 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5008664131164551
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.060 Vali Acc: 0.268 Test Loss: 4.060 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5318341255187988
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.074 Vali Acc: 0.269 Test Loss: 4.074 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.49756908416748047
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.095 Vali Acc: 0.271 Test Loss: 4.095 Test Acc: 0.271
Validation loss decreased (-0.269372 --> -0.270547).  Saving model ...
Epoch: 29 cost time: 0.5210790634155273
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.147 Vali Acc: 0.274 Test Loss: 4.147 Test Acc: 0.274
Validation loss decreased (-0.270547 --> -0.274076).  Saving model ...
Epoch: 30 cost time: 0.48651909828186035
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.169 Vali Acc: 0.275 Test Loss: 4.169 Test Acc: 0.275
Validation loss decreased (-0.274076 --> -0.275252).  Saving model ...
Epoch: 31 cost time: 0.5395636558532715
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.187 Vali Acc: 0.281 Test Loss: 4.187 Test Acc: 0.281
Validation loss decreased (-0.275252 --> -0.281135).  Saving model ...
Epoch: 32 cost time: 0.47715187072753906
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.186 Vali Acc: 0.282 Test Loss: 4.186 Test Acc: 0.282
Validation loss decreased (-0.281135 --> -0.282311).  Saving model ...
Epoch: 33 cost time: 0.5272014141082764
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.206 Vali Acc: 0.278 Test Loss: 4.206 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5190203189849854
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.236 Vali Acc: 0.271 Test Loss: 4.236 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5040853023529053
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.267 Vali Acc: 0.280 Test Loss: 4.267 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5394895076751709
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.287 Vali Acc: 0.280 Test Loss: 4.287 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5140130519866943
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.297 Vali Acc: 0.280 Test Loss: 4.297 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5419318675994873
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.320 Vali Acc: 0.279 Test Loss: 4.320 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4981250762939453
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.338 Vali Acc: 0.278 Test Loss: 4.338 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5168867111206055
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.347 Vali Acc: 0.278 Test Loss: 4.347 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5408389568328857
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.344 Vali Acc: 0.281 Test Loss: 4.344 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4716458320617676
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.361 Vali Acc: 0.284 Test Loss: 4.361 Test Acc: 0.284
Validation loss decreased (-0.282311 --> -0.283486).  Saving model ...
Epoch: 43 cost time: 0.487964391708374
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.374 Vali Acc: 0.282 Test Loss: 4.374 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4782140254974365
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.399 Vali Acc: 0.286 Test Loss: 4.399 Test Acc: 0.286
Validation loss decreased (-0.283486 --> -0.285838).  Saving model ...
Epoch: 45 cost time: 0.5172684192657471
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.415 Vali Acc: 0.285 Test Loss: 4.415 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5302379131317139
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.419 Vali Acc: 0.284 Test Loss: 4.419 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4820828437805176
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.427 Vali Acc: 0.286 Test Loss: 4.427 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.49299144744873047
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.428 Vali Acc: 0.287 Test Loss: 4.428 Test Acc: 0.287
Validation loss decreased (-0.285838 --> -0.287015).  Saving model ...
Epoch: 49 cost time: 0.5018880367279053
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.435 Vali Acc: 0.288 Test Loss: 4.435 Test Acc: 0.288
Validation loss decreased (-0.287015 --> -0.288191).  Saving model ...
Epoch: 50 cost time: 0.488400936126709
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.454 Vali Acc: 0.291 Test Loss: 4.454 Test Acc: 0.291
Validation loss decreased (-0.288191 --> -0.290544).  Saving model ...
Epoch: 51 cost time: 0.5180308818817139
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.473 Vali Acc: 0.286 Test Loss: 4.473 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5156137943267822
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.495 Vali Acc: 0.282 Test Loss: 4.495 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.45025634765625
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.503 Vali Acc: 0.285 Test Loss: 4.503 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.487626314163208
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.529 Vali Acc: 0.285 Test Loss: 4.529 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5501084327697754
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.527 Vali Acc: 0.285 Test Loss: 4.527 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.47980737686157227
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.532 Vali Acc: 0.284 Test Loss: 4.532 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5441808700561523
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.557 Vali Acc: 0.289 Test Loss: 4.557 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.526331901550293
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.580 Vali Acc: 0.286 Test Loss: 4.580 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.5079731941223145
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.577 Vali Acc: 0.286 Test Loss: 4.577 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5946681499481201
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.582 Vali Acc: 0.287 Test Loss: 4.582 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm128_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 334426
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5977911949157715
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.309 Vali Acc: 0.067 Test Loss: 3.309 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 0.6626193523406982
Epoch: 2, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.361 Vali Acc: 0.101 Test Loss: 3.361 Test Acc: 0.101
Validation loss decreased (-0.067026 --> -0.101143).  Saving model ...
Epoch: 3 cost time: 0.6521625518798828
Epoch: 3, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.284 Vali Acc: 0.132 Test Loss: 3.284 Test Acc: 0.132
Validation loss decreased (-0.101143 --> -0.131732).  Saving model ...
Epoch: 4 cost time: 0.6431269645690918
Epoch: 4, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.247 Vali Acc: 0.169 Test Loss: 3.247 Test Acc: 0.169
Validation loss decreased (-0.131732 --> -0.169379).  Saving model ...
Epoch: 5 cost time: 0.4645404815673828
Epoch: 5, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.308 Vali Acc: 0.198 Test Loss: 3.308 Test Acc: 0.198
Validation loss decreased (-0.169379 --> -0.197614).  Saving model ...
Epoch: 6 cost time: 0.5859909057617188
Epoch: 6, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.473 Vali Acc: 0.204 Test Loss: 3.473 Test Acc: 0.204
Validation loss decreased (-0.197614 --> -0.203495).  Saving model ...
Epoch: 7 cost time: 0.6022486686706543
Epoch: 7, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.520 Vali Acc: 0.233 Test Loss: 3.520 Test Acc: 0.233
Validation loss decreased (-0.203495 --> -0.232906).  Saving model ...
Epoch: 8 cost time: 0.5695981979370117
Epoch: 8, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.667 Vali Acc: 0.235 Test Loss: 3.667 Test Acc: 0.235
Validation loss decreased (-0.232906 --> -0.235257).  Saving model ...
Epoch: 9 cost time: 0.591456413269043
Epoch: 9, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.866 Vali Acc: 0.248 Test Loss: 3.866 Test Acc: 0.248
Validation loss decreased (-0.235257 --> -0.248197).  Saving model ...
Epoch: 10 cost time: 0.5603070259094238
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.048 Vali Acc: 0.239 Test Loss: 4.048 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6697094440460205
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.208 Vali Acc: 0.251 Test Loss: 4.208 Test Acc: 0.251
Validation loss decreased (-0.248197 --> -0.250546).  Saving model ...
Epoch: 12 cost time: 0.5431423187255859
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.416 Vali Acc: 0.252 Test Loss: 4.416 Test Acc: 0.252
Validation loss decreased (-0.250546 --> -0.251721).  Saving model ...
Epoch: 13 cost time: 0.5870885848999023
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.475 Vali Acc: 0.261 Test Loss: 4.475 Test Acc: 0.261
Validation loss decreased (-0.251721 --> -0.261132).  Saving model ...
Epoch: 14 cost time: 0.6126236915588379
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.521 Vali Acc: 0.266 Test Loss: 4.521 Test Acc: 0.266
Validation loss decreased (-0.261132 --> -0.265837).  Saving model ...
Epoch: 15 cost time: 0.627575159072876
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.649 Vali Acc: 0.265 Test Loss: 4.649 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.659597635269165
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.747 Vali Acc: 0.264 Test Loss: 4.747 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6597697734832764
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.742 Vali Acc: 0.269 Test Loss: 4.742 Test Acc: 0.269
Validation loss decreased (-0.265837 --> -0.269364).  Saving model ...
Epoch: 18 cost time: 0.6651012897491455
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.760 Vali Acc: 0.269 Test Loss: 4.760 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6190407276153564
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.775 Vali Acc: 0.275 Test Loss: 4.775 Test Acc: 0.275
Validation loss decreased (-0.269364 --> -0.275246).  Saving model ...
Epoch: 20 cost time: 0.6465013027191162
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.790 Vali Acc: 0.274 Test Loss: 4.790 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6632285118103027
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.829 Vali Acc: 0.275 Test Loss: 4.829 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6472253799438477
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.841 Vali Acc: 0.280 Test Loss: 4.841 Test Acc: 0.280
Validation loss decreased (-0.275246 --> -0.279952).  Saving model ...
Epoch: 23 cost time: 0.693234920501709
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.854 Vali Acc: 0.276 Test Loss: 4.854 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6434030532836914
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.875 Vali Acc: 0.274 Test Loss: 4.875 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.663445234298706
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.893 Vali Acc: 0.273 Test Loss: 4.893 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6209092140197754
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.913 Vali Acc: 0.276 Test Loss: 4.913 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5858240127563477
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.927 Vali Acc: 0.278 Test Loss: 4.927 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5913546085357666
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.930 Vali Acc: 0.274 Test Loss: 4.930 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6075210571289062
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.956 Vali Acc: 0.272 Test Loss: 4.956 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5866689682006836
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.964 Vali Acc: 0.274 Test Loss: 4.964 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5357587337493896
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.983 Vali Acc: 0.275 Test Loss: 4.983 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.684316873550415
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.004 Vali Acc: 0.274 Test Loss: 5.004 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 529754
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.493340015411377
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.317 Vali Acc: 0.040 Test Loss: 3.317 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.5143423080444336
Epoch: 2, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.303 Vali Acc: 0.064 Test Loss: 3.303 Test Acc: 0.064
Validation loss decreased (-0.039967 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.5272228717803955
Epoch: 3, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.333 Vali Acc: 0.091 Test Loss: 3.333 Test Acc: 0.091
Validation loss decreased (-0.063496 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 0.4671156406402588
Epoch: 4, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.269 Vali Acc: 0.118 Test Loss: 3.269 Test Acc: 0.118
Validation loss decreased (-0.090555 --> -0.117614).  Saving model ...
Epoch: 5 cost time: 0.48504114151000977
Epoch: 5, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.209 Vali Acc: 0.139 Test Loss: 3.209 Test Acc: 0.139
Validation loss decreased (-0.117614 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.532881498336792
Epoch: 6, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.218 Vali Acc: 0.172 Test Loss: 3.218 Test Acc: 0.172
Validation loss decreased (-0.138791 --> -0.171733).  Saving model ...
Epoch: 7 cost time: 0.48335742950439453
Epoch: 7, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.245 Vali Acc: 0.187 Test Loss: 3.245 Test Acc: 0.187
Validation loss decreased (-0.171733 --> -0.187026).  Saving model ...
Epoch: 8 cost time: 0.5210745334625244
Epoch: 8, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.315 Vali Acc: 0.201 Test Loss: 3.315 Test Acc: 0.201
Validation loss decreased (-0.187026 --> -0.201143).  Saving model ...
Epoch: 9 cost time: 0.5070052146911621
Epoch: 9, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.410 Vali Acc: 0.224 Test Loss: 3.410 Test Acc: 0.224
Validation loss decreased (-0.201143 --> -0.223495).  Saving model ...
Epoch: 10 cost time: 0.5286242961883545
Epoch: 10, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.452 Vali Acc: 0.239 Test Loss: 3.452 Test Acc: 0.239
Validation loss decreased (-0.223495 --> -0.238789).  Saving model ...
Epoch: 11 cost time: 0.5052917003631592
Epoch: 11, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.556 Vali Acc: 0.245 Test Loss: 3.556 Test Acc: 0.245
Validation loss decreased (-0.238789 --> -0.244670).  Saving model ...
Epoch: 12 cost time: 0.5141146183013916
Epoch: 12, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.680 Vali Acc: 0.253 Test Loss: 3.680 Test Acc: 0.253
Validation loss decreased (-0.244670 --> -0.252904).  Saving model ...
Epoch: 13 cost time: 0.5156714916229248
Epoch: 13, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.720 Vali Acc: 0.261 Test Loss: 3.720 Test Acc: 0.261
Validation loss decreased (-0.252904 --> -0.261139).  Saving model ...
Epoch: 14 cost time: 0.5299530029296875
Epoch: 14, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.898 Vali Acc: 0.254 Test Loss: 3.898 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.545107364654541
Epoch: 15, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.952 Vali Acc: 0.256 Test Loss: 3.952 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5147929191589355
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.996 Vali Acc: 0.267 Test Loss: 3.996 Test Acc: 0.267
Validation loss decreased (-0.261139 --> -0.267019).  Saving model ...
Epoch: 17 cost time: 0.4980175495147705
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.082 Vali Acc: 0.275 Test Loss: 4.082 Test Acc: 0.275
Validation loss decreased (-0.267019 --> -0.275253).  Saving model ...
Epoch: 18 cost time: 0.53922438621521
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.157 Vali Acc: 0.279 Test Loss: 4.157 Test Acc: 0.279
Validation loss decreased (-0.275253 --> -0.278782).  Saving model ...
Epoch: 19 cost time: 0.5336294174194336
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.155 Vali Acc: 0.276 Test Loss: 4.155 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.502220869064331
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.160 Vali Acc: 0.279 Test Loss: 4.160 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5672781467437744
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.241 Vali Acc: 0.276 Test Loss: 4.241 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5138256549835205
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.285 Vali Acc: 0.274 Test Loss: 4.285 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5167703628540039
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.299 Vali Acc: 0.284 Test Loss: 4.299 Test Acc: 0.284
Validation loss decreased (-0.278782 --> -0.283486).  Saving model ...
Epoch: 24 cost time: 0.5645051002502441
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.309 Vali Acc: 0.282 Test Loss: 4.309 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5223381519317627
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.350 Vali Acc: 0.284 Test Loss: 4.350 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5376064777374268
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.370 Vali Acc: 0.281 Test Loss: 4.370 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5498225688934326
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.386 Vali Acc: 0.280 Test Loss: 4.386 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5368311405181885
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.437 Vali Acc: 0.279 Test Loss: 4.437 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5250728130340576
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.459 Vali Acc: 0.275 Test Loss: 4.459 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4876821041107178
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.474 Vali Acc: 0.272 Test Loss: 4.474 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.517542839050293
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.474 Vali Acc: 0.276 Test Loss: 4.474 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5195918083190918
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.483 Vali Acc: 0.276 Test Loss: 4.483 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5134315490722656
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.493 Vali Acc: 0.280 Test Loss: 4.493 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 340314
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8242976665496826
Epoch: 1, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.336 Vali Acc: 0.044 Test Loss: 3.336 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.5322751998901367
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.327 Vali Acc: 0.061 Test Loss: 3.327 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.5090651512145996
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.329 Vali Acc: 0.081 Test Loss: 3.329 Test Acc: 0.081
Validation loss decreased (-0.061143 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.5003151893615723
Epoch: 4, Steps: 10 | Train Loss: 2.744 Vali Loss: 3.324 Vali Acc: 0.094 Test Loss: 3.324 Test Acc: 0.094
Validation loss decreased (-0.081143 --> -0.094084).  Saving model ...
Epoch: 5 cost time: 0.4941995143890381
Epoch: 5, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.272 Vali Acc: 0.116 Test Loss: 3.272 Test Acc: 0.116
Validation loss decreased (-0.094084 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.48514771461486816
Epoch: 6, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.238 Vali Acc: 0.142 Test Loss: 3.238 Test Acc: 0.142
Validation loss decreased (-0.116438 --> -0.142321).  Saving model ...
Epoch: 7 cost time: 0.46576738357543945
Epoch: 7, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.220 Vali Acc: 0.169 Test Loss: 3.220 Test Acc: 0.169
Validation loss decreased (-0.142321 --> -0.169380).  Saving model ...
Epoch: 8 cost time: 0.49775028228759766
Epoch: 8, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.234 Vali Acc: 0.176 Test Loss: 3.234 Test Acc: 0.176
Validation loss decreased (-0.169380 --> -0.176438).  Saving model ...
Epoch: 9 cost time: 0.4963202476501465
Epoch: 9, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.286 Vali Acc: 0.193 Test Loss: 3.286 Test Acc: 0.193
Validation loss decreased (-0.176438 --> -0.192908).  Saving model ...
Epoch: 10 cost time: 0.5339243412017822
Epoch: 10, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.301 Vali Acc: 0.214 Test Loss: 3.301 Test Acc: 0.214
Validation loss decreased (-0.192908 --> -0.214085).  Saving model ...
Epoch: 11 cost time: 0.5397675037384033
Epoch: 11, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.363 Vali Acc: 0.228 Test Loss: 3.363 Test Acc: 0.228
Validation loss decreased (-0.214085 --> -0.228202).  Saving model ...
Epoch: 12 cost time: 0.47736406326293945
Epoch: 12, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.417 Vali Acc: 0.241 Test Loss: 3.417 Test Acc: 0.241
Validation loss decreased (-0.228202 --> -0.241142).  Saving model ...
Epoch: 13 cost time: 0.44336724281311035
Epoch: 13, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.505 Vali Acc: 0.249 Test Loss: 3.505 Test Acc: 0.249
Validation loss decreased (-0.241142 --> -0.249377).  Saving model ...
Epoch: 14 cost time: 0.5127904415130615
Epoch: 14, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.587 Vali Acc: 0.249 Test Loss: 3.587 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5209124088287354
Epoch: 15, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.652 Vali Acc: 0.249 Test Loss: 3.652 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5226876735687256
Epoch: 16, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.763 Vali Acc: 0.255 Test Loss: 3.763 Test Acc: 0.255
Validation loss decreased (-0.249377 --> -0.255256).  Saving model ...
Epoch: 17 cost time: 0.5100893974304199
Epoch: 17, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.868 Vali Acc: 0.258 Test Loss: 3.868 Test Acc: 0.258
Validation loss decreased (-0.255256 --> -0.257608).  Saving model ...
Epoch: 18 cost time: 0.5153913497924805
Epoch: 18, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.937 Vali Acc: 0.256 Test Loss: 3.937 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5056178569793701
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.981 Vali Acc: 0.253 Test Loss: 3.981 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5012855529785156
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.072 Vali Acc: 0.255 Test Loss: 4.072 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5190622806549072
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.088 Vali Acc: 0.264 Test Loss: 4.088 Test Acc: 0.264
Validation loss decreased (-0.257608 --> -0.263489).  Saving model ...
Epoch: 22 cost time: 0.5562899112701416
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.117 Vali Acc: 0.264 Test Loss: 4.117 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5099947452545166
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.155 Vali Acc: 0.264 Test Loss: 4.155 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.44759464263916016
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.186 Vali Acc: 0.265 Test Loss: 4.186 Test Acc: 0.265
Validation loss decreased (-0.263489 --> -0.264664).  Saving model ...
Epoch: 25 cost time: 0.523679256439209
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.217 Vali Acc: 0.268 Test Loss: 4.217 Test Acc: 0.268
Validation loss decreased (-0.264664 --> -0.268193).  Saving model ...
Epoch: 26 cost time: 0.5091025829315186
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.244 Vali Acc: 0.267 Test Loss: 4.244 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43200063705444336
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.312 Vali Acc: 0.264 Test Loss: 4.312 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6011509895324707
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.343 Vali Acc: 0.262 Test Loss: 4.343 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5098915100097656
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.358 Vali Acc: 0.262 Test Loss: 4.358 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4332616329193115
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.364 Vali Acc: 0.266 Test Loss: 4.364 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4424560070037842
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.390 Vali Acc: 0.265 Test Loss: 4.390 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.498870849609375
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.422 Vali Acc: 0.267 Test Loss: 4.422 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5201406478881836
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.436 Vali Acc: 0.272 Test Loss: 4.436 Test Acc: 0.272
Validation loss decreased (-0.268193 --> -0.271720).  Saving model ...
Epoch: 34 cost time: 0.49686765670776367
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.451 Vali Acc: 0.267 Test Loss: 4.451 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4727468490600586
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.462 Vali Acc: 0.266 Test Loss: 4.462 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.46860718727111816
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.469 Vali Acc: 0.262 Test Loss: 4.469 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5311460494995117
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.492 Vali Acc: 0.264 Test Loss: 4.492 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5650765895843506
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.510 Vali Acc: 0.267 Test Loss: 4.510 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5570521354675293
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.516 Vali Acc: 0.268 Test Loss: 4.516 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.575251579284668
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.535 Vali Acc: 0.268 Test Loss: 4.535 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5650055408477783
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.556 Vali Acc: 0.264 Test Loss: 4.556 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5199284553527832
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.563 Vali Acc: 0.267 Test Loss: 4.563 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5736632347106934
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.578 Vali Acc: 0.269 Test Loss: 4.578 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 275674
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.606325387954712
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.346 Vali Acc: 0.036 Test Loss: 3.346 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5716400146484375
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.317 Vali Acc: 0.045 Test Loss: 3.317 Test Acc: 0.045
Validation loss decreased (-0.036437 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.5668063163757324
Epoch: 3, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.309 Vali Acc: 0.067 Test Loss: 3.309 Test Acc: 0.067
Validation loss decreased (-0.044673 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.5673158168792725
Epoch: 4, Steps: 10 | Train Loss: 2.824 Vali Loss: 3.304 Vali Acc: 0.091 Test Loss: 3.304 Test Acc: 0.091
Validation loss decreased (-0.067026 --> -0.090555).  Saving model ...
Epoch: 5 cost time: 0.5685665607452393
Epoch: 5, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.276 Vali Acc: 0.108 Test Loss: 3.276 Test Acc: 0.108
Validation loss decreased (-0.090555 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 0.6072232723236084
Epoch: 6, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.268 Vali Acc: 0.116 Test Loss: 3.268 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.5762696266174316
Epoch: 7, Steps: 10 | Train Loss: 2.064 Vali Loss: 3.236 Vali Acc: 0.128 Test Loss: 3.236 Test Acc: 0.128
Validation loss decreased (-0.116438 --> -0.128203).  Saving model ...
Epoch: 8 cost time: 0.5708708763122559
Epoch: 8, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.221 Vali Acc: 0.159 Test Loss: 3.221 Test Acc: 0.159
Validation loss decreased (-0.128203 --> -0.158791).  Saving model ...
Epoch: 9 cost time: 0.5602328777313232
Epoch: 9, Steps: 10 | Train Loss: 1.649 Vali Loss: 3.248 Vali Acc: 0.176 Test Loss: 3.248 Test Acc: 0.176
Validation loss decreased (-0.158791 --> -0.176438).  Saving model ...
Epoch: 10 cost time: 0.6144444942474365
Epoch: 10, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.253 Vali Acc: 0.186 Test Loss: 3.253 Test Acc: 0.186
Validation loss decreased (-0.176438 --> -0.185850).  Saving model ...
Epoch: 11 cost time: 0.5955262184143066
Epoch: 11, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.300 Vali Acc: 0.194 Test Loss: 3.300 Test Acc: 0.194
Validation loss decreased (-0.185850 --> -0.194085).  Saving model ...
Epoch: 12 cost time: 0.5695362091064453
Epoch: 12, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.338 Vali Acc: 0.211 Test Loss: 3.338 Test Acc: 0.211
Validation loss decreased (-0.194085 --> -0.210555).  Saving model ...
Epoch: 13 cost time: 0.566007137298584
Epoch: 13, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.380 Vali Acc: 0.228 Test Loss: 3.380 Test Acc: 0.228
Validation loss decreased (-0.210555 --> -0.228201).  Saving model ...
Epoch: 14 cost time: 0.541313648223877
Epoch: 14, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.468 Vali Acc: 0.220 Test Loss: 3.468 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5787289142608643
Epoch: 15, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.507 Vali Acc: 0.244 Test Loss: 3.507 Test Acc: 0.244
Validation loss decreased (-0.228201 --> -0.243494).  Saving model ...
Epoch: 16 cost time: 0.5987281799316406
Epoch: 16, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.547 Vali Acc: 0.248 Test Loss: 3.547 Test Acc: 0.248
Validation loss decreased (-0.243494 --> -0.248200).  Saving model ...
Epoch: 17 cost time: 0.6004724502563477
Epoch: 17, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.618 Vali Acc: 0.248 Test Loss: 3.618 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5264053344726562
Epoch: 18, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.722 Vali Acc: 0.252 Test Loss: 3.722 Test Acc: 0.252
Validation loss decreased (-0.248200 --> -0.251727).  Saving model ...
Epoch: 19 cost time: 0.5767967700958252
Epoch: 19, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.784 Vali Acc: 0.256 Test Loss: 3.784 Test Acc: 0.256
Validation loss decreased (-0.251727 --> -0.256433).  Saving model ...
Epoch: 20 cost time: 0.5306856632232666
Epoch: 20, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.855 Vali Acc: 0.256 Test Loss: 3.855 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5328152179718018
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.952 Vali Acc: 0.247 Test Loss: 3.952 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5438964366912842
Epoch: 22, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.015 Vali Acc: 0.246 Test Loss: 4.015 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5933105945587158
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.046 Vali Acc: 0.254 Test Loss: 4.046 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5696229934692383
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.124 Vali Acc: 0.253 Test Loss: 4.124 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5897853374481201
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.171 Vali Acc: 0.254 Test Loss: 4.171 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5734162330627441
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.200 Vali Acc: 0.253 Test Loss: 4.200 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5801324844360352
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.198 Vali Acc: 0.252 Test Loss: 4.198 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5245301723480225
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.227 Vali Acc: 0.253 Test Loss: 4.227 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5472197532653809
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.255 Vali Acc: 0.253 Test Loss: 4.255 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 245978
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.720247507095337
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5307965278625488
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.305 Vali Acc: 0.065 Test Loss: 3.305 Test Acc: 0.065
Validation loss decreased (-0.038790 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.5558130741119385
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.301 Vali Acc: 0.076 Test Loss: 3.301 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.5851590633392334
Epoch: 4, Steps: 10 | Train Loss: 2.960 Vali Loss: 3.302 Vali Acc: 0.086 Test Loss: 3.302 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 0.5384588241577148
Epoch: 5, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.307 Vali Acc: 0.098 Test Loss: 3.307 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.5809304714202881
Epoch: 6, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.296 Vali Acc: 0.108 Test Loss: 3.296 Test Acc: 0.108
Validation loss decreased (-0.097614 --> -0.108202).  Saving model ...
Epoch: 7 cost time: 0.5714395046234131
Epoch: 7, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.286 Vali Acc: 0.107 Test Loss: 3.286 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5809273719787598
Epoch: 8, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.273 Vali Acc: 0.122 Test Loss: 3.273 Test Acc: 0.122
Validation loss decreased (-0.108202 --> -0.122320).  Saving model ...
Epoch: 9 cost time: 0.5638267993927002
Epoch: 9, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.270 Vali Acc: 0.129 Test Loss: 3.270 Test Acc: 0.129
Validation loss decreased (-0.122320 --> -0.129379).  Saving model ...
Epoch: 10 cost time: 0.5561954975128174
Epoch: 10, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.276 Vali Acc: 0.149 Test Loss: 3.276 Test Acc: 0.149
Validation loss decreased (-0.129379 --> -0.149379).  Saving model ...
Epoch: 11 cost time: 0.5794525146484375
Epoch: 11, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.293 Vali Acc: 0.153 Test Loss: 3.293 Test Acc: 0.153
Validation loss decreased (-0.149379 --> -0.152908).  Saving model ...
Epoch: 12 cost time: 0.6126253604888916
Epoch: 12, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.303 Vali Acc: 0.169 Test Loss: 3.303 Test Acc: 0.169
Validation loss decreased (-0.152908 --> -0.169379).  Saving model ...
Epoch: 13 cost time: 0.6241312026977539
Epoch: 13, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.326 Vali Acc: 0.178 Test Loss: 3.326 Test Acc: 0.178
Validation loss decreased (-0.169379 --> -0.177614).  Saving model ...
Epoch: 14 cost time: 0.5953526496887207
Epoch: 14, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.365 Vali Acc: 0.192 Test Loss: 3.365 Test Acc: 0.192
Validation loss decreased (-0.177614 --> -0.191731).  Saving model ...
Epoch: 15 cost time: 0.5759296417236328
Epoch: 15, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.391 Vali Acc: 0.194 Test Loss: 3.391 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194084).  Saving model ...
Epoch: 16 cost time: 0.6141490936279297
Epoch: 16, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.423 Vali Acc: 0.198 Test Loss: 3.423 Test Acc: 0.198
Validation loss decreased (-0.194084 --> -0.197613).  Saving model ...
Epoch: 17 cost time: 0.5649421215057373
Epoch: 17, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.471 Vali Acc: 0.201 Test Loss: 3.471 Test Acc: 0.201
Validation loss decreased (-0.197613 --> -0.201142).  Saving model ...
Epoch: 18 cost time: 0.608891487121582
Epoch: 18, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.518 Vali Acc: 0.206 Test Loss: 3.518 Test Acc: 0.206
Validation loss decreased (-0.201142 --> -0.205847).  Saving model ...
Epoch: 19 cost time: 0.6131329536437988
Epoch: 19, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.557 Vali Acc: 0.212 Test Loss: 3.557 Test Acc: 0.212
Validation loss decreased (-0.205847 --> -0.211729).  Saving model ...
Epoch: 20 cost time: 0.5455617904663086
Epoch: 20, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.606 Vali Acc: 0.221 Test Loss: 3.606 Test Acc: 0.221
Validation loss decreased (-0.211729 --> -0.221140).  Saving model ...
Epoch: 21 cost time: 0.5582942962646484
Epoch: 21, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.675 Vali Acc: 0.227 Test Loss: 3.675 Test Acc: 0.227
Validation loss decreased (-0.221140 --> -0.227022).  Saving model ...
Epoch: 22 cost time: 0.5700371265411377
Epoch: 22, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.702 Vali Acc: 0.228 Test Loss: 3.702 Test Acc: 0.228
Validation loss decreased (-0.227022 --> -0.228198).  Saving model ...
Epoch: 23 cost time: 0.5223472118377686
Epoch: 23, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.764 Vali Acc: 0.234 Test Loss: 3.764 Test Acc: 0.234
Validation loss decreased (-0.228198 --> -0.234080).  Saving model ...
Epoch: 24 cost time: 0.5433754920959473
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.804 Vali Acc: 0.235 Test Loss: 3.804 Test Acc: 0.235
Validation loss decreased (-0.234080 --> -0.235256).  Saving model ...
Epoch: 25 cost time: 0.5646800994873047
Epoch: 25, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.803 Vali Acc: 0.238 Test Loss: 3.803 Test Acc: 0.238
Validation loss decreased (-0.235256 --> -0.237609).  Saving model ...
Epoch: 26 cost time: 0.6393234729766846
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.835 Vali Acc: 0.239 Test Loss: 3.835 Test Acc: 0.239
Validation loss decreased (-0.237609 --> -0.238785).  Saving model ...
Epoch: 27 cost time: 0.5720174312591553
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.875 Vali Acc: 0.242 Test Loss: 3.875 Test Acc: 0.242
Validation loss decreased (-0.238785 --> -0.242314).  Saving model ...
Epoch: 28 cost time: 0.6195001602172852
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.902 Vali Acc: 0.246 Test Loss: 3.902 Test Acc: 0.246
Validation loss decreased (-0.242314 --> -0.245843).  Saving model ...
Epoch: 29 cost time: 0.5950267314910889
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.923 Vali Acc: 0.249 Test Loss: 3.923 Test Acc: 0.249
Validation loss decreased (-0.245843 --> -0.249373).  Saving model ...
Epoch: 30 cost time: 0.5721824169158936
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.948 Vali Acc: 0.247 Test Loss: 3.948 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.49099016189575195
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.993 Vali Acc: 0.247 Test Loss: 3.993 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5753743648529053
Epoch: 32, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.014 Vali Acc: 0.249 Test Loss: 4.014 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4988524913787842
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.017 Vali Acc: 0.252 Test Loss: 4.017 Test Acc: 0.252
Validation loss decreased (-0.249373 --> -0.251725).  Saving model ...
Epoch: 34 cost time: 0.5347256660461426
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.041 Vali Acc: 0.254 Test Loss: 4.041 Test Acc: 0.254
Validation loss decreased (-0.251725 --> -0.254077).  Saving model ...
Epoch: 35 cost time: 0.5680444240570068
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.056 Vali Acc: 0.259 Test Loss: 4.056 Test Acc: 0.259
Validation loss decreased (-0.254077 --> -0.258783).  Saving model ...
Epoch: 36 cost time: 0.5415515899658203
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.078 Vali Acc: 0.258 Test Loss: 4.078 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.56697678565979
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.092 Vali Acc: 0.256 Test Loss: 4.092 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6055572032928467
Epoch: 38, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.097 Vali Acc: 0.258 Test Loss: 4.097 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5515332221984863
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.106 Vali Acc: 0.256 Test Loss: 4.106 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6190860271453857
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.143 Vali Acc: 0.256 Test Loss: 4.143 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5828111171722412
Epoch: 41, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.151 Vali Acc: 0.259 Test Loss: 4.151 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5515127182006836
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.163 Vali Acc: 0.260 Test Loss: 4.163 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259958).  Saving model ...
Epoch: 43 cost time: 0.5418720245361328
Epoch: 43, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.169 Vali Acc: 0.259 Test Loss: 4.169 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6250319480895996
Epoch: 44, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.182 Vali Acc: 0.256 Test Loss: 4.182 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6274092197418213
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.185 Vali Acc: 0.256 Test Loss: 4.185 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5954992771148682
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.205 Vali Acc: 0.256 Test Loss: 4.205 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.627068281173706
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.233 Vali Acc: 0.256 Test Loss: 4.233 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6373100280761719
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.238 Vali Acc: 0.254 Test Loss: 4.238 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5952708721160889
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.263 Vali Acc: 0.258 Test Loss: 4.263 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5800390243530273
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.268 Vali Acc: 0.259 Test Loss: 4.268 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5935609340667725
Epoch: 51, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.272 Vali Acc: 0.261 Test Loss: 4.272 Test Acc: 0.261
Validation loss decreased (-0.259958 --> -0.261134).  Saving model ...
Epoch: 52 cost time: 0.6262369155883789
Epoch: 52, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.273 Vali Acc: 0.262 Test Loss: 4.273 Test Acc: 0.262
Validation loss decreased (-0.261134 --> -0.262310).  Saving model ...
Epoch: 53 cost time: 0.561955451965332
Epoch: 53, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.280 Vali Acc: 0.262 Test Loss: 4.280 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.535747766494751
Epoch: 54, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.289 Vali Acc: 0.260 Test Loss: 4.289 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5878632068634033
Epoch: 55, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.305 Vali Acc: 0.262 Test Loss: 4.305 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.558056116104126
Epoch: 56, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.307 Vali Acc: 0.264 Test Loss: 4.307 Test Acc: 0.264
Validation loss decreased (-0.262310 --> -0.263486).  Saving model ...
Epoch: 57 cost time: 0.6741807460784912
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.327 Vali Acc: 0.260 Test Loss: 4.327 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.61781907081604
Epoch: 58, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.328 Vali Acc: 0.261 Test Loss: 4.328 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5725009441375732
Epoch: 59, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.327 Vali Acc: 0.266 Test Loss: 4.327 Test Acc: 0.266
Validation loss decreased (-0.263486 --> -0.265839).  Saving model ...
Epoch: 60 cost time: 0.5744326114654541
Epoch: 60, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.332 Vali Acc: 0.269 Test Loss: 4.332 Test Acc: 0.269
Validation loss decreased (-0.265839 --> -0.269368).  Saving model ...
Epoch: 61 cost time: 0.6679275035858154
Epoch: 61, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.356 Vali Acc: 0.268 Test Loss: 4.356 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5589725971221924
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.373 Vali Acc: 0.269 Test Loss: 4.373 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5681290626525879
Epoch: 63, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.364 Vali Acc: 0.268 Test Loss: 4.364 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5258831977844238
Epoch: 64, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.376 Vali Acc: 0.271 Test Loss: 4.376 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270544).  Saving model ...
Epoch: 65 cost time: 0.5441887378692627
Epoch: 65, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.394 Vali Acc: 0.267 Test Loss: 4.394 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5518271923065186
Epoch: 66, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.406 Vali Acc: 0.266 Test Loss: 4.406 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5590176582336426
Epoch: 67, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.412 Vali Acc: 0.265 Test Loss: 4.412 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5591471195220947
Epoch: 68, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.421 Vali Acc: 0.265 Test Loss: 4.421 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6305804252624512
Epoch: 69, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.422 Vali Acc: 0.266 Test Loss: 4.422 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.5784666538238525
Epoch: 70, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.428 Vali Acc: 0.264 Test Loss: 4.428 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.6215391159057617
Epoch: 71, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.444 Vali Acc: 0.265 Test Loss: 4.444 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.5879130363464355
Epoch: 72, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.454 Vali Acc: 0.262 Test Loss: 4.454 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.5612916946411133
Epoch: 73, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.454 Vali Acc: 0.261 Test Loss: 4.454 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.5430266857147217
Epoch: 74, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.456 Vali Acc: 0.264 Test Loss: 4.456 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 211482
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6954662799835205
Epoch: 1, Steps: 10 | Train Loss: 3.456 Vali Loss: 3.366 Vali Acc: 0.036 Test Loss: 3.366 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5891909599304199
Epoch: 2, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.356 Vali Acc: 0.032 Test Loss: 3.356 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6016430854797363
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.342 Vali Acc: 0.039 Test Loss: 3.342 Test Acc: 0.039
Validation loss decreased (-0.036437 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 0.6142196655273438
Epoch: 4, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.327 Vali Acc: 0.062 Test Loss: 3.327 Test Acc: 0.062
Validation loss decreased (-0.038790 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.5955414772033691
Epoch: 5, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.320 Vali Acc: 0.079 Test Loss: 3.320 Test Acc: 0.079
Validation loss decreased (-0.062320 --> -0.078790).  Saving model ...
Epoch: 6 cost time: 0.5153558254241943
Epoch: 6, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.310 Vali Acc: 0.092 Test Loss: 3.310 Test Acc: 0.092
Validation loss decreased (-0.078790 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.5986568927764893
Epoch: 7, Steps: 10 | Train Loss: 2.505 Vali Loss: 3.295 Vali Acc: 0.101 Test Loss: 3.295 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.5502204895019531
Epoch: 8, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.290 Vali Acc: 0.106 Test Loss: 3.290 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 0.5903687477111816
Epoch: 9, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.279 Vali Acc: 0.119 Test Loss: 3.279 Test Acc: 0.119
Validation loss decreased (-0.105849 --> -0.118791).  Saving model ...
Epoch: 10 cost time: 0.5762205123901367
Epoch: 10, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.258 Vali Acc: 0.139 Test Loss: 3.258 Test Acc: 0.139
Validation loss decreased (-0.118791 --> -0.138791).  Saving model ...
Epoch: 11 cost time: 0.6119844913482666
Epoch: 11, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.269 Vali Acc: 0.141 Test Loss: 3.269 Test Acc: 0.141
Validation loss decreased (-0.138791 --> -0.141144).  Saving model ...
Epoch: 12 cost time: 0.6160976886749268
Epoch: 12, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.268 Vali Acc: 0.147 Test Loss: 3.268 Test Acc: 0.147
Validation loss decreased (-0.141144 --> -0.147026).  Saving model ...
Epoch: 13 cost time: 0.6261651515960693
Epoch: 13, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.288 Vali Acc: 0.154 Test Loss: 3.288 Test Acc: 0.154
Validation loss decreased (-0.147026 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.5784378051757812
Epoch: 14, Steps: 10 | Train Loss: 1.342 Vali Loss: 3.303 Vali Acc: 0.153 Test Loss: 3.303 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5914967060089111
Epoch: 15, Steps: 10 | Train Loss: 1.199 Vali Loss: 3.331 Vali Acc: 0.167 Test Loss: 3.331 Test Acc: 0.167
Validation loss decreased (-0.154085 --> -0.167026).  Saving model ...
Epoch: 16 cost time: 0.571784496307373
Epoch: 16, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.357 Vali Acc: 0.178 Test Loss: 3.357 Test Acc: 0.178
Validation loss decreased (-0.167026 --> -0.177613).  Saving model ...
Epoch: 17 cost time: 0.512108564376831
Epoch: 17, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.367 Vali Acc: 0.189 Test Loss: 3.367 Test Acc: 0.189
Validation loss decreased (-0.177613 --> -0.189378).  Saving model ...
Epoch: 18 cost time: 0.5907530784606934
Epoch: 18, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.387 Vali Acc: 0.199 Test Loss: 3.387 Test Acc: 0.199
Validation loss decreased (-0.189378 --> -0.198790).  Saving model ...
Epoch: 19 cost time: 0.5707120895385742
Epoch: 19, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.420 Vali Acc: 0.192 Test Loss: 3.420 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5587430000305176
Epoch: 20, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.444 Vali Acc: 0.213 Test Loss: 3.444 Test Acc: 0.213
Validation loss decreased (-0.198790 --> -0.212907).  Saving model ...
Epoch: 21 cost time: 0.5464997291564941
Epoch: 21, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.503 Vali Acc: 0.206 Test Loss: 3.503 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.535592794418335
Epoch: 22, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.534 Vali Acc: 0.224 Test Loss: 3.534 Test Acc: 0.224
Validation loss decreased (-0.212907 --> -0.223494).  Saving model ...
Epoch: 23 cost time: 0.5508310794830322
Epoch: 23, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.573 Vali Acc: 0.228 Test Loss: 3.573 Test Acc: 0.228
Validation loss decreased (-0.223494 --> -0.228200).  Saving model ...
Epoch: 24 cost time: 0.5695407390594482
Epoch: 24, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.604 Vali Acc: 0.231 Test Loss: 3.604 Test Acc: 0.231
Validation loss decreased (-0.228200 --> -0.230552).  Saving model ...
Epoch: 25 cost time: 0.6225388050079346
Epoch: 25, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.673 Vali Acc: 0.236 Test Loss: 3.673 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236434).  Saving model ...
Epoch: 26 cost time: 0.5991027355194092
Epoch: 26, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.736 Vali Acc: 0.233 Test Loss: 3.736 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6182892322540283
Epoch: 27, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.779 Vali Acc: 0.227 Test Loss: 3.779 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6597099304199219
Epoch: 28, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.788 Vali Acc: 0.226 Test Loss: 3.788 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5698580741882324
Epoch: 29, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.801 Vali Acc: 0.228 Test Loss: 3.801 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5356881618499756
Epoch: 30, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.826 Vali Acc: 0.228 Test Loss: 3.826 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5303783416748047
Epoch: 31, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.869 Vali Acc: 0.229 Test Loss: 3.869 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5963215827941895
Epoch: 32, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.884 Vali Acc: 0.229 Test Loss: 3.884 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5755569934844971
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.884 Vali Acc: 0.227 Test Loss: 3.884 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5796680450439453
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.934 Vali Acc: 0.235 Test Loss: 3.934 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5415492057800293
Epoch: 35, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.977 Vali Acc: 0.227 Test Loss: 3.977 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 197018
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5220468044281006
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.362 Vali Acc: 0.042 Test Loss: 3.362 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.5830130577087402
Epoch: 2, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.335 Vali Acc: 0.051 Test Loss: 3.335 Test Acc: 0.051
Validation loss decreased (-0.042319 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.6263387203216553
Epoch: 3, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.315 Vali Acc: 0.052 Test Loss: 3.315 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.541846513748169
Epoch: 4, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.302 Vali Acc: 0.054 Test Loss: 3.302 Test Acc: 0.054
Validation loss decreased (-0.051732 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.5263066291809082
Epoch: 5, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.295 Vali Acc: 0.073 Test Loss: 3.295 Test Acc: 0.073
Validation loss decreased (-0.054085 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 0.561455488204956
Epoch: 6, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.286 Vali Acc: 0.089 Test Loss: 3.286 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 0.5494062900543213
Epoch: 7, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.277 Vali Acc: 0.095 Test Loss: 3.277 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095261).  Saving model ...
Epoch: 8 cost time: 0.5037214756011963
Epoch: 8, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.271 Vali Acc: 0.106 Test Loss: 3.271 Test Acc: 0.106
Validation loss decreased (-0.095261 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.5865731239318848
Epoch: 9, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.262 Vali Acc: 0.127 Test Loss: 3.262 Test Acc: 0.127
Validation loss decreased (-0.105850 --> -0.127026).  Saving model ...
Epoch: 10 cost time: 0.5755691528320312
Epoch: 10, Steps: 10 | Train Loss: 2.094 Vali Loss: 3.253 Vali Acc: 0.134 Test Loss: 3.253 Test Acc: 0.134
Validation loss decreased (-0.127026 --> -0.134085).  Saving model ...
Epoch: 11 cost time: 0.5670161247253418
Epoch: 11, Steps: 10 | Train Loss: 1.928 Vali Loss: 3.238 Vali Acc: 0.152 Test Loss: 3.238 Test Acc: 0.152
Validation loss decreased (-0.134085 --> -0.151732).  Saving model ...
Epoch: 12 cost time: 0.5242440700531006
Epoch: 12, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.253 Vali Acc: 0.160 Test Loss: 3.253 Test Acc: 0.160
Validation loss decreased (-0.151732 --> -0.159967).  Saving model ...
Epoch: 13 cost time: 0.5479598045349121
Epoch: 13, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.258 Vali Acc: 0.165 Test Loss: 3.258 Test Acc: 0.165
Validation loss decreased (-0.159967 --> -0.164673).  Saving model ...
Epoch: 14 cost time: 0.549506664276123
Epoch: 14, Steps: 10 | Train Loss: 1.528 Vali Loss: 3.287 Vali Acc: 0.179 Test Loss: 3.287 Test Acc: 0.179
Validation loss decreased (-0.164673 --> -0.178791).  Saving model ...
Epoch: 15 cost time: 0.5798149108886719
Epoch: 15, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.318 Vali Acc: 0.182 Test Loss: 3.318 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 16 cost time: 0.5808305740356445
Epoch: 16, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.310 Vali Acc: 0.193 Test Loss: 3.310 Test Acc: 0.193
Validation loss decreased (-0.182320 --> -0.192908).  Saving model ...
Epoch: 17 cost time: 0.5780291557312012
Epoch: 17, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.335 Vali Acc: 0.195 Test Loss: 3.335 Test Acc: 0.195
Validation loss decreased (-0.192908 --> -0.195261).  Saving model ...
Epoch: 18 cost time: 0.5849735736846924
Epoch: 18, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.364 Vali Acc: 0.205 Test Loss: 3.364 Test Acc: 0.205
Validation loss decreased (-0.195261 --> -0.204672).  Saving model ...
Epoch: 19 cost time: 0.586444616317749
Epoch: 19, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.412 Vali Acc: 0.212 Test Loss: 3.412 Test Acc: 0.212
Validation loss decreased (-0.204672 --> -0.211731).  Saving model ...
Epoch: 20 cost time: 0.5029067993164062
Epoch: 20, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.436 Vali Acc: 0.216 Test Loss: 3.436 Test Acc: 0.216
Validation loss decreased (-0.211731 --> -0.216436).  Saving model ...
Epoch: 21 cost time: 0.5527398586273193
Epoch: 21, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.445 Vali Acc: 0.238 Test Loss: 3.445 Test Acc: 0.238
Validation loss decreased (-0.216436 --> -0.237613).  Saving model ...
Epoch: 22 cost time: 0.5617249011993408
Epoch: 22, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.475 Vali Acc: 0.240 Test Loss: 3.475 Test Acc: 0.240
Validation loss decreased (-0.237613 --> -0.239965).  Saving model ...
Epoch: 23 cost time: 0.5579605102539062
Epoch: 23, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.521 Vali Acc: 0.241 Test Loss: 3.521 Test Acc: 0.241
Validation loss decreased (-0.239965 --> -0.241141).  Saving model ...
Epoch: 24 cost time: 0.5722732543945312
Epoch: 24, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.552 Vali Acc: 0.241 Test Loss: 3.552 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5390293598175049
Epoch: 25, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.566 Vali Acc: 0.248 Test Loss: 3.566 Test Acc: 0.248
Validation loss decreased (-0.241141 --> -0.248200).  Saving model ...
Epoch: 26 cost time: 0.5755412578582764
Epoch: 26, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.608 Vali Acc: 0.248 Test Loss: 3.608 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5199198722839355
Epoch: 27, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.627 Vali Acc: 0.247 Test Loss: 3.627 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5335135459899902
Epoch: 28, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.653 Vali Acc: 0.248 Test Loss: 3.653 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5858345031738281
Epoch: 29, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.677 Vali Acc: 0.248 Test Loss: 3.677 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5335962772369385
Epoch: 30, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.697 Vali Acc: 0.255 Test Loss: 3.697 Test Acc: 0.255
Validation loss decreased (-0.248200 --> -0.255257).  Saving model ...
Epoch: 31 cost time: 0.5581979751586914
Epoch: 31, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.737 Vali Acc: 0.255 Test Loss: 3.737 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5596294403076172
Epoch: 32, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.777 Vali Acc: 0.258 Test Loss: 3.777 Test Acc: 0.258
Validation loss decreased (-0.255257 --> -0.257609).  Saving model ...
Epoch: 33 cost time: 0.5283005237579346
Epoch: 33, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.786 Vali Acc: 0.260 Test Loss: 3.786 Test Acc: 0.260
Validation loss decreased (-0.257609 --> -0.259962).  Saving model ...
Epoch: 34 cost time: 0.5808124542236328
Epoch: 34, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.809 Vali Acc: 0.260 Test Loss: 3.809 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5597965717315674
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.834 Vali Acc: 0.255 Test Loss: 3.834 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5324761867523193
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.840 Vali Acc: 0.256 Test Loss: 3.840 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5581409931182861
Epoch: 37, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.862 Vali Acc: 0.256 Test Loss: 3.862 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5471763610839844
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.861 Vali Acc: 0.261 Test Loss: 3.861 Test Acc: 0.261
Validation loss decreased (-0.259962 --> -0.261138).  Saving model ...
Epoch: 39 cost time: 0.5699076652526855
Epoch: 39, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.888 Vali Acc: 0.258 Test Loss: 3.888 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.44580531120300293
Epoch: 40, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.898 Vali Acc: 0.265 Test Loss: 3.898 Test Acc: 0.265
Validation loss decreased (-0.261138 --> -0.264667).  Saving model ...
Epoch: 41 cost time: 0.5671677589416504
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.919 Vali Acc: 0.269 Test Loss: 3.919 Test Acc: 0.269
Validation loss decreased (-0.264667 --> -0.269373).  Saving model ...
Epoch: 42 cost time: 0.5752217769622803
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.933 Vali Acc: 0.256 Test Loss: 3.933 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5401034355163574
Epoch: 43, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.939 Vali Acc: 0.251 Test Loss: 3.939 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6359767913818359
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.975 Vali Acc: 0.261 Test Loss: 3.975 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5567843914031982
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.996 Vali Acc: 0.266 Test Loss: 3.996 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5582404136657715
Epoch: 46, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.005 Vali Acc: 0.268 Test Loss: 4.005 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5655107498168945
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.025 Vali Acc: 0.271 Test Loss: 4.025 Test Acc: 0.271
Validation loss decreased (-0.269373 --> -0.270548).  Saving model ...
Epoch: 48 cost time: 0.5715785026550293
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.043 Vali Acc: 0.272 Test Loss: 4.043 Test Acc: 0.272
Validation loss decreased (-0.270548 --> -0.271724).  Saving model ...
Epoch: 49 cost time: 0.5257468223571777
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.042 Vali Acc: 0.266 Test Loss: 4.042 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5963876247406006
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.051 Vali Acc: 0.265 Test Loss: 4.051 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5568068027496338
Epoch: 51, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.042 Vali Acc: 0.266 Test Loss: 4.042 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5276775360107422
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.038 Vali Acc: 0.271 Test Loss: 4.038 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5398991107940674
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.062 Vali Acc: 0.271 Test Loss: 4.062 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.580986499786377
Epoch: 54, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.061 Vali Acc: 0.279 Test Loss: 4.061 Test Acc: 0.279
Validation loss decreased (-0.271724 --> -0.278783).  Saving model ...
Epoch: 55 cost time: 0.5408780574798584
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.091 Vali Acc: 0.280 Test Loss: 4.091 Test Acc: 0.280
Validation loss decreased (-0.278783 --> -0.279959).  Saving model ...
Epoch: 56 cost time: 0.5524969100952148
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.113 Vali Acc: 0.282 Test Loss: 4.113 Test Acc: 0.282
Validation loss decreased (-0.279959 --> -0.282312).  Saving model ...
Epoch: 57 cost time: 0.4931943416595459
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.115 Vali Acc: 0.281 Test Loss: 4.115 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5746009349822998
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.103 Vali Acc: 0.284 Test Loss: 4.103 Test Acc: 0.284
Validation loss decreased (-0.282312 --> -0.283488).  Saving model ...
Epoch: 59 cost time: 0.5502417087554932
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.117 Vali Acc: 0.279 Test Loss: 4.117 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5721538066864014
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.130 Vali Acc: 0.282 Test Loss: 4.130 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5812041759490967
Epoch: 61, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.118 Vali Acc: 0.278 Test Loss: 4.118 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5627725124359131
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.132 Vali Acc: 0.278 Test Loss: 4.132 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5084743499755859
Epoch: 63, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.157 Vali Acc: 0.278 Test Loss: 4.157 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5789988040924072
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.169 Vali Acc: 0.278 Test Loss: 4.169 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.553013801574707
Epoch: 65, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.194 Vali Acc: 0.278 Test Loss: 4.194 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5271503925323486
Epoch: 66, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.205 Vali Acc: 0.282 Test Loss: 4.205 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5725324153900146
Epoch: 67, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.220 Vali Acc: 0.282 Test Loss: 4.220 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5524709224700928
Epoch: 68, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.216 Vali Acc: 0.280 Test Loss: 4.216 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 192474
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7442882061004639
Epoch: 1, Steps: 10 | Train Loss: 3.541 Vali Loss: 3.333 Vali Acc: 0.036 Test Loss: 3.333 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.6634259223937988
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.492 Vali Acc: 0.067 Test Loss: 3.492 Test Acc: 0.067
Validation loss decreased (-0.036437 --> -0.067024).  Saving model ...
Epoch: 3 cost time: 0.6544172763824463
Epoch: 3, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.292 Vali Acc: 0.112 Test Loss: 3.292 Test Acc: 0.112
Validation loss decreased (-0.067024 --> -0.111732).  Saving model ...
Epoch: 4 cost time: 0.6579470634460449
Epoch: 4, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.273 Vali Acc: 0.135 Test Loss: 3.273 Test Acc: 0.135
Validation loss decreased (-0.111732 --> -0.135261).  Saving model ...
Epoch: 5 cost time: 0.7049481868743896
Epoch: 5, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.301 Vali Acc: 0.176 Test Loss: 3.301 Test Acc: 0.176
Validation loss decreased (-0.135261 --> -0.176438).  Saving model ...
Epoch: 6 cost time: 0.688392162322998
Epoch: 6, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.381 Vali Acc: 0.194 Test Loss: 3.381 Test Acc: 0.194
Validation loss decreased (-0.176438 --> -0.194084).  Saving model ...
Epoch: 7 cost time: 0.6551358699798584
Epoch: 7, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.487 Vali Acc: 0.225 Test Loss: 3.487 Test Acc: 0.225
Validation loss decreased (-0.194084 --> -0.224671).  Saving model ...
Epoch: 8 cost time: 0.6665549278259277
Epoch: 8, Steps: 10 | Train Loss: 0.546 Vali Loss: 3.643 Vali Acc: 0.227 Test Loss: 3.643 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227022).  Saving model ...
Epoch: 9 cost time: 0.588559627532959
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.772 Vali Acc: 0.236 Test Loss: 3.772 Test Acc: 0.236
Validation loss decreased (-0.227022 --> -0.236433).  Saving model ...
Epoch: 10 cost time: 0.776597261428833
Epoch: 10, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.872 Vali Acc: 0.248 Test Loss: 3.872 Test Acc: 0.248
Validation loss decreased (-0.236433 --> -0.248197).  Saving model ...
Epoch: 11 cost time: 0.8088104724884033
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.115 Vali Acc: 0.252 Test Loss: 4.115 Test Acc: 0.252
Validation loss decreased (-0.248197 --> -0.251724).  Saving model ...
Epoch: 12 cost time: 0.7809712886810303
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.382 Vali Acc: 0.246 Test Loss: 4.382 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7695496082305908
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.452 Vali Acc: 0.244 Test Loss: 4.452 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7643506526947021
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.449 Vali Acc: 0.255 Test Loss: 4.449 Test Acc: 0.255
Validation loss decreased (-0.251724 --> -0.255250).  Saving model ...
Epoch: 15 cost time: 0.7933034896850586
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.529 Vali Acc: 0.261 Test Loss: 4.529 Test Acc: 0.261
Validation loss decreased (-0.255250 --> -0.261131).  Saving model ...
Epoch: 16 cost time: 0.8218708038330078
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.632 Vali Acc: 0.259 Test Loss: 4.632 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.79054856300354
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.719 Vali Acc: 0.256 Test Loss: 4.719 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8014609813690186
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.741 Vali Acc: 0.260 Test Loss: 4.741 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7935962677001953
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.770 Vali Acc: 0.262 Test Loss: 4.770 Test Acc: 0.262
Validation loss decreased (-0.261131 --> -0.262305).  Saving model ...
Epoch: 20 cost time: 0.7871212959289551
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.794 Vali Acc: 0.262 Test Loss: 4.794 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7975811958312988
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.832 Vali Acc: 0.260 Test Loss: 4.832 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7764310836791992
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.840 Vali Acc: 0.261 Test Loss: 4.840 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7751455307006836
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.846 Vali Acc: 0.264 Test Loss: 4.846 Test Acc: 0.264
Validation loss decreased (-0.262305 --> -0.263481).  Saving model ...
Epoch: 24 cost time: 0.7862420082092285
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.864 Vali Acc: 0.266 Test Loss: 4.864 Test Acc: 0.266
Validation loss decreased (-0.263481 --> -0.265834).  Saving model ...
Epoch: 25 cost time: 0.7551450729370117
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.905 Vali Acc: 0.273 Test Loss: 4.905 Test Acc: 0.273
Validation loss decreased (-0.265834 --> -0.272892).  Saving model ...
Epoch: 26 cost time: 0.7589635848999023
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.927 Vali Acc: 0.271 Test Loss: 4.927 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7943940162658691
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.946 Vali Acc: 0.271 Test Loss: 4.946 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7595779895782471
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.959 Vali Acc: 0.272 Test Loss: 4.959 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8073348999023438
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.981 Vali Acc: 0.271 Test Loss: 4.981 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7632901668548584
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.998 Vali Acc: 0.269 Test Loss: 4.998 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7891237735748291
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.014 Vali Acc: 0.268 Test Loss: 5.014 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5015819072723389
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.020 Vali Acc: 0.269 Test Loss: 5.020 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6888895034790039
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.024 Vali Acc: 0.271 Test Loss: 5.024 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6501753330230713
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.051 Vali Acc: 0.268 Test Loss: 5.051 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6684362888336182
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.076 Vali Acc: 0.268 Test Loss: 5.076 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 480218
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6729907989501953
Epoch: 1, Steps: 10 | Train Loss: 3.503 Vali Loss: 3.348 Vali Acc: 0.048 Test Loss: 3.348 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.590052604675293
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.352 Vali Acc: 0.054 Test Loss: 3.352 Test Acc: 0.054
Validation loss decreased (-0.048202 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.5991442203521729
Epoch: 3, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.370 Vali Acc: 0.072 Test Loss: 3.370 Test Acc: 0.072
Validation loss decreased (-0.054084 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.6491284370422363
Epoch: 4, Steps: 10 | Train Loss: 2.625 Vali Loss: 3.285 Vali Acc: 0.113 Test Loss: 3.285 Test Acc: 0.113
Validation loss decreased (-0.071731 --> -0.112908).  Saving model ...
Epoch: 5 cost time: 0.600515604019165
Epoch: 5, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.244 Vali Acc: 0.148 Test Loss: 3.244 Test Acc: 0.148
Validation loss decreased (-0.112908 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.5881223678588867
Epoch: 6, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.262 Vali Acc: 0.169 Test Loss: 3.262 Test Acc: 0.169
Validation loss decreased (-0.148203 --> -0.169379).  Saving model ...
Epoch: 7 cost time: 0.578967809677124
Epoch: 7, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.286 Vali Acc: 0.178 Test Loss: 3.286 Test Acc: 0.178
Validation loss decreased (-0.169379 --> -0.177614).  Saving model ...
Epoch: 8 cost time: 0.5836119651794434
Epoch: 8, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.339 Vali Acc: 0.191 Test Loss: 3.339 Test Acc: 0.191
Validation loss decreased (-0.177614 --> -0.190555).  Saving model ...
Epoch: 9 cost time: 0.6260251998901367
Epoch: 9, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.401 Vali Acc: 0.216 Test Loss: 3.401 Test Acc: 0.216
Validation loss decreased (-0.190555 --> -0.216437).  Saving model ...
Epoch: 10 cost time: 0.619166374206543
Epoch: 10, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.490 Vali Acc: 0.232 Test Loss: 3.490 Test Acc: 0.232
Validation loss decreased (-0.216437 --> -0.231730).  Saving model ...
Epoch: 11 cost time: 0.6056058406829834
Epoch: 11, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.574 Vali Acc: 0.239 Test Loss: 3.574 Test Acc: 0.239
Validation loss decreased (-0.231730 --> -0.238788).  Saving model ...
Epoch: 12 cost time: 0.613776683807373
Epoch: 12, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.646 Vali Acc: 0.241 Test Loss: 3.646 Test Acc: 0.241
Validation loss decreased (-0.238788 --> -0.241140).  Saving model ...
Epoch: 13 cost time: 0.6344814300537109
Epoch: 13, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.755 Vali Acc: 0.247 Test Loss: 3.755 Test Acc: 0.247
Validation loss decreased (-0.241140 --> -0.247021).  Saving model ...
Epoch: 14 cost time: 0.5980501174926758
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.843 Vali Acc: 0.253 Test Loss: 3.843 Test Acc: 0.253
Validation loss decreased (-0.247021 --> -0.252903).  Saving model ...
Epoch: 15 cost time: 0.5798876285552979
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.006 Vali Acc: 0.251 Test Loss: 4.006 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5789885520935059
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.112 Vali Acc: 0.254 Test Loss: 4.112 Test Acc: 0.254
Validation loss decreased (-0.252903 --> -0.254077).  Saving model ...
Epoch: 17 cost time: 0.6438071727752686
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.158 Vali Acc: 0.262 Test Loss: 4.158 Test Acc: 0.262
Validation loss decreased (-0.254077 --> -0.262311).  Saving model ...
Epoch: 18 cost time: 0.6311554908752441
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.226 Vali Acc: 0.269 Test Loss: 4.226 Test Acc: 0.269
Validation loss decreased (-0.262311 --> -0.269370).  Saving model ...
Epoch: 19 cost time: 0.6422626972198486
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.260 Vali Acc: 0.272 Test Loss: 4.260 Test Acc: 0.272
Validation loss decreased (-0.269370 --> -0.271722).  Saving model ...
Epoch: 20 cost time: 0.6603572368621826
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.402 Vali Acc: 0.260 Test Loss: 4.402 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6133565902709961
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.382 Vali Acc: 0.256 Test Loss: 4.382 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6077730655670166
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.357 Vali Acc: 0.268 Test Loss: 4.357 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6137609481811523
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.401 Vali Acc: 0.266 Test Loss: 4.401 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6045782566070557
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.469 Vali Acc: 0.269 Test Loss: 4.469 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6234011650085449
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.521 Vali Acc: 0.266 Test Loss: 4.521 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6316752433776855
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.517 Vali Acc: 0.265 Test Loss: 4.517 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6396536827087402
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.544 Vali Acc: 0.265 Test Loss: 4.544 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6509637832641602
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.576 Vali Acc: 0.268 Test Loss: 4.576 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5830526351928711
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.613 Vali Acc: 0.265 Test Loss: 4.613 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 290778
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7158558368682861
Epoch: 1, Steps: 10 | Train Loss: 3.504 Vali Loss: 3.347 Vali Acc: 0.019 Test Loss: 3.347 Test Acc: 0.019
Validation loss decreased (inf --> -0.018790).  Saving model ...
Epoch: 2 cost time: 0.6173629760742188
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.325 Vali Acc: 0.041 Test Loss: 3.325 Test Acc: 0.041
Validation loss decreased (-0.018790 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.5681920051574707
Epoch: 3, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.349 Vali Acc: 0.087 Test Loss: 3.349 Test Acc: 0.087
Validation loss decreased (-0.041143 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 0.6234779357910156
Epoch: 4, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.311 Vali Acc: 0.108 Test Loss: 3.311 Test Acc: 0.108
Validation loss decreased (-0.087025 --> -0.108202).  Saving model ...
Epoch: 5 cost time: 0.610184907913208
Epoch: 5, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.287 Vali Acc: 0.120 Test Loss: 3.287 Test Acc: 0.120
Validation loss decreased (-0.108202 --> -0.119967).  Saving model ...
Epoch: 6 cost time: 0.6375167369842529
Epoch: 6, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.262 Vali Acc: 0.139 Test Loss: 3.262 Test Acc: 0.139
Validation loss decreased (-0.119967 --> -0.138791).  Saving model ...
Epoch: 7 cost time: 0.5970985889434814
Epoch: 7, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.241 Vali Acc: 0.154 Test Loss: 3.241 Test Acc: 0.154
Validation loss decreased (-0.138791 --> -0.154085).  Saving model ...
Epoch: 8 cost time: 0.6279270648956299
Epoch: 8, Steps: 10 | Train Loss: 1.721 Vali Loss: 3.248 Vali Acc: 0.184 Test Loss: 3.248 Test Acc: 0.184
Validation loss decreased (-0.154085 --> -0.183497).  Saving model ...
Epoch: 9 cost time: 0.5667269229888916
Epoch: 9, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.303 Vali Acc: 0.192 Test Loss: 3.303 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191732).  Saving model ...
Epoch: 10 cost time: 0.5839390754699707
Epoch: 10, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.345 Vali Acc: 0.196 Test Loss: 3.345 Test Acc: 0.196
Validation loss decreased (-0.191732 --> -0.196437).  Saving model ...
Epoch: 11 cost time: 0.5600910186767578
Epoch: 11, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.388 Vali Acc: 0.207 Test Loss: 3.388 Test Acc: 0.207
Validation loss decreased (-0.196437 --> -0.207025).  Saving model ...
Epoch: 12 cost time: 0.5500149726867676
Epoch: 12, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.435 Vali Acc: 0.231 Test Loss: 3.435 Test Acc: 0.231
Validation loss decreased (-0.207025 --> -0.230554).  Saving model ...
Epoch: 13 cost time: 0.5645074844360352
Epoch: 13, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.510 Vali Acc: 0.235 Test Loss: 3.510 Test Acc: 0.235
Validation loss decreased (-0.230554 --> -0.235259).  Saving model ...
Epoch: 14 cost time: 0.5858910083770752
Epoch: 14, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.548 Vali Acc: 0.236 Test Loss: 3.548 Test Acc: 0.236
Validation loss decreased (-0.235259 --> -0.236435).  Saving model ...
Epoch: 15 cost time: 0.5849764347076416
Epoch: 15, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.675 Vali Acc: 0.235 Test Loss: 3.675 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.562197208404541
Epoch: 16, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.766 Vali Acc: 0.232 Test Loss: 3.766 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5879900455474854
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.890 Vali Acc: 0.241 Test Loss: 3.890 Test Acc: 0.241
Validation loss decreased (-0.236435 --> -0.241138).  Saving model ...
Epoch: 18 cost time: 0.5907676219940186
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.971 Vali Acc: 0.245 Test Loss: 3.971 Test Acc: 0.245
Validation loss decreased (-0.241138 --> -0.244666).  Saving model ...
Epoch: 19 cost time: 0.5784642696380615
Epoch: 19, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.028 Vali Acc: 0.251 Test Loss: 4.028 Test Acc: 0.251
Validation loss decreased (-0.244666 --> -0.250548).  Saving model ...
Epoch: 20 cost time: 0.5809028148651123
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.047 Vali Acc: 0.251 Test Loss: 4.047 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6433234214782715
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.104 Vali Acc: 0.258 Test Loss: 4.104 Test Acc: 0.258
Validation loss decreased (-0.250548 --> -0.257606).  Saving model ...
Epoch: 22 cost time: 0.5941565036773682
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.156 Vali Acc: 0.258 Test Loss: 4.156 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5848007202148438
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.233 Vali Acc: 0.254 Test Loss: 4.233 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.585845947265625
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.280 Vali Acc: 0.252 Test Loss: 4.280 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6355688571929932
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.294 Vali Acc: 0.258 Test Loss: 4.294 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6156280040740967
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.305 Vali Acc: 0.258 Test Loss: 4.305 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6210315227508545
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.367 Vali Acc: 0.254 Test Loss: 4.367 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6003212928771973
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.391 Vali Acc: 0.255 Test Loss: 4.391 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6272101402282715
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.396 Vali Acc: 0.256 Test Loss: 4.396 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5868606567382812
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.411 Vali Acc: 0.265 Test Loss: 4.411 Test Acc: 0.265
Validation loss decreased (-0.257606 --> -0.264662).  Saving model ...
Epoch: 31 cost time: 0.6557333469390869
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.452 Vali Acc: 0.261 Test Loss: 4.452 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5788679122924805
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.492 Vali Acc: 0.261 Test Loss: 4.492 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.64371657371521
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.505 Vali Acc: 0.264 Test Loss: 4.505 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6086111068725586
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.511 Vali Acc: 0.264 Test Loss: 4.511 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6025385856628418
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.510 Vali Acc: 0.271 Test Loss: 4.510 Test Acc: 0.271
Validation loss decreased (-0.264662 --> -0.270543).  Saving model ...
Epoch: 36 cost time: 0.6015779972076416
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.512 Vali Acc: 0.272 Test Loss: 4.512 Test Acc: 0.272
Validation loss decreased (-0.270543 --> -0.271720).  Saving model ...
Epoch: 37 cost time: 0.6471598148345947
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.523 Vali Acc: 0.271 Test Loss: 4.523 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6158444881439209
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.566 Vali Acc: 0.272 Test Loss: 4.566 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.590491533279419
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.567 Vali Acc: 0.273 Test Loss: 4.567 Test Acc: 0.273
Validation loss decreased (-0.271720 --> -0.272896).  Saving model ...
Epoch: 40 cost time: 0.6523449420928955
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.584 Vali Acc: 0.272 Test Loss: 4.584 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5746860504150391
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.594 Vali Acc: 0.268 Test Loss: 4.594 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6184616088867188
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.624 Vali Acc: 0.266 Test Loss: 4.624 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6029832363128662
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.632 Vali Acc: 0.268 Test Loss: 4.632 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6000180244445801
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.656 Vali Acc: 0.268 Test Loss: 4.656 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5733962059020996
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.660 Vali Acc: 0.272 Test Loss: 4.660 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6259970664978027
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.680 Vali Acc: 0.272 Test Loss: 4.680 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5596551895141602
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.694 Vali Acc: 0.269 Test Loss: 4.694 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5620954036712646
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.697 Vali Acc: 0.268 Test Loss: 4.697 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6032228469848633
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.712 Vali Acc: 0.269 Test Loss: 4.712 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 226138
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7776150703430176
Epoch: 1, Steps: 10 | Train Loss: 3.451 Vali Loss: 3.361 Vali Acc: 0.045 Test Loss: 3.361 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.5552520751953125
Epoch: 2, Steps: 10 | Train Loss: 3.380 Vali Loss: 3.334 Vali Acc: 0.052 Test Loss: 3.334 Test Acc: 0.052
Validation loss decreased (-0.044672 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.47786545753479004
Epoch: 3, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.344 Vali Acc: 0.060 Test Loss: 3.344 Test Acc: 0.060
Validation loss decreased (-0.051731 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.5519270896911621
Epoch: 4, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.340 Vali Acc: 0.080 Test Loss: 3.340 Test Acc: 0.080
Validation loss decreased (-0.059967 --> -0.079967).  Saving model ...
Epoch: 5 cost time: 0.5691971778869629
Epoch: 5, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.314 Vali Acc: 0.094 Test Loss: 3.314 Test Acc: 0.094
Validation loss decreased (-0.079967 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.5872979164123535
Epoch: 6, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.283 Vali Acc: 0.104 Test Loss: 3.283 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 0.5342133045196533
Epoch: 7, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.263 Vali Acc: 0.116 Test Loss: 3.263 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 0.5582678318023682
Epoch: 8, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.243 Vali Acc: 0.145 Test Loss: 3.243 Test Acc: 0.145
Validation loss decreased (-0.116438 --> -0.144673).  Saving model ...
Epoch: 9 cost time: 0.5546042919158936
Epoch: 9, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.253 Vali Acc: 0.152 Test Loss: 3.253 Test Acc: 0.152
Validation loss decreased (-0.144673 --> -0.151732).  Saving model ...
Epoch: 10 cost time: 0.5659101009368896
Epoch: 10, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.294 Vali Acc: 0.164 Test Loss: 3.294 Test Acc: 0.164
Validation loss decreased (-0.151732 --> -0.163496).  Saving model ...
Epoch: 11 cost time: 0.5893917083740234
Epoch: 11, Steps: 10 | Train Loss: 1.235 Vali Loss: 3.338 Vali Acc: 0.176 Test Loss: 3.338 Test Acc: 0.176
Validation loss decreased (-0.163496 --> -0.176437).  Saving model ...
Epoch: 12 cost time: 0.5695531368255615
Epoch: 12, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.347 Vali Acc: 0.194 Test Loss: 3.347 Test Acc: 0.194
Validation loss decreased (-0.176437 --> -0.194084).  Saving model ...
Epoch: 13 cost time: 0.5648634433746338
Epoch: 13, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.401 Vali Acc: 0.205 Test Loss: 3.401 Test Acc: 0.205
Validation loss decreased (-0.194084 --> -0.204672).  Saving model ...
Epoch: 14 cost time: 0.5748391151428223
Epoch: 14, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.490 Vali Acc: 0.221 Test Loss: 3.490 Test Acc: 0.221
Validation loss decreased (-0.204672 --> -0.221142).  Saving model ...
Epoch: 15 cost time: 0.5879130363464355
Epoch: 15, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.509 Vali Acc: 0.234 Test Loss: 3.509 Test Acc: 0.234
Validation loss decreased (-0.221142 --> -0.234083).  Saving model ...
Epoch: 16 cost time: 0.5383174419403076
Epoch: 16, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.564 Vali Acc: 0.234 Test Loss: 3.564 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5845041275024414
Epoch: 17, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.621 Vali Acc: 0.241 Test Loss: 3.621 Test Acc: 0.241
Validation loss decreased (-0.234083 --> -0.241140).  Saving model ...
Epoch: 18 cost time: 0.5250439643859863
Epoch: 18, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.727 Vali Acc: 0.239 Test Loss: 3.727 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.581618070602417
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.806 Vali Acc: 0.245 Test Loss: 3.806 Test Acc: 0.245
Validation loss decreased (-0.241140 --> -0.244668).  Saving model ...
Epoch: 20 cost time: 0.5972585678100586
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.861 Vali Acc: 0.266 Test Loss: 3.861 Test Acc: 0.266
Validation loss decreased (-0.244668 --> -0.265844).  Saving model ...
Epoch: 21 cost time: 0.5819838047027588
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.968 Vali Acc: 0.259 Test Loss: 3.968 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5514254570007324
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.030 Vali Acc: 0.252 Test Loss: 4.030 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5314569473266602
Epoch: 23, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.127 Vali Acc: 0.253 Test Loss: 4.127 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.569366455078125
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.110 Vali Acc: 0.256 Test Loss: 4.110 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5311388969421387
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.143 Vali Acc: 0.256 Test Loss: 4.143 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5124506950378418
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.183 Vali Acc: 0.262 Test Loss: 4.183 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5594549179077148
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.222 Vali Acc: 0.261 Test Loss: 4.222 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5345122814178467
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.280 Vali Acc: 0.259 Test Loss: 4.280 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.550396203994751
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.302 Vali Acc: 0.258 Test Loss: 4.302 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5695579051971436
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.326 Vali Acc: 0.259 Test Loss: 4.326 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 196442
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.666914701461792
Epoch: 1, Steps: 10 | Train Loss: 3.422 Vali Loss: 3.318 Vali Acc: 0.047 Test Loss: 3.318 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.5718998908996582
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.299 Vali Acc: 0.051 Test Loss: 3.299 Test Acc: 0.051
Validation loss decreased (-0.047026 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.5731809139251709
Epoch: 3, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.293 Vali Acc: 0.059 Test Loss: 3.293 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.5974690914154053
Epoch: 4, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.296 Vali Acc: 0.084 Test Loss: 3.296 Test Acc: 0.084
Validation loss decreased (-0.058791 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.582827091217041
Epoch: 5, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.290 Vali Acc: 0.091 Test Loss: 3.290 Test Acc: 0.091
Validation loss decreased (-0.083496 --> -0.090555).  Saving model ...
Epoch: 6 cost time: 0.5431537628173828
Epoch: 6, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.274 Vali Acc: 0.098 Test Loss: 3.274 Test Acc: 0.098
Validation loss decreased (-0.090555 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.6167886257171631
Epoch: 7, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.264 Vali Acc: 0.113 Test Loss: 3.264 Test Acc: 0.113
Validation loss decreased (-0.097614 --> -0.112909).  Saving model ...
Epoch: 8 cost time: 0.5840635299682617
Epoch: 8, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.255 Vali Acc: 0.127 Test Loss: 3.255 Test Acc: 0.127
Validation loss decreased (-0.112909 --> -0.127026).  Saving model ...
Epoch: 9 cost time: 0.5385994911193848
Epoch: 9, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.237 Vali Acc: 0.146 Test Loss: 3.237 Test Acc: 0.146
Validation loss decreased (-0.127026 --> -0.145850).  Saving model ...
Epoch: 10 cost time: 0.6009573936462402
Epoch: 10, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.244 Vali Acc: 0.152 Test Loss: 3.244 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 11 cost time: 0.5819211006164551
Epoch: 11, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.256 Vali Acc: 0.162 Test Loss: 3.256 Test Acc: 0.162
Validation loss decreased (-0.151732 --> -0.162320).  Saving model ...
Epoch: 12 cost time: 0.5403003692626953
Epoch: 12, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.262 Vali Acc: 0.180 Test Loss: 3.262 Test Acc: 0.180
Validation loss decreased (-0.162320 --> -0.179967).  Saving model ...
Epoch: 13 cost time: 0.5844194889068604
Epoch: 13, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.286 Vali Acc: 0.178 Test Loss: 3.286 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5724947452545166
Epoch: 14, Steps: 10 | Train Loss: 1.153 Vali Loss: 3.305 Vali Acc: 0.194 Test Loss: 3.305 Test Acc: 0.194
Validation loss decreased (-0.179967 --> -0.194085).  Saving model ...
Epoch: 15 cost time: 0.5969870090484619
Epoch: 15, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.342 Vali Acc: 0.205 Test Loss: 3.342 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204672).  Saving model ...
Epoch: 16 cost time: 0.5900757312774658
Epoch: 16, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.392 Vali Acc: 0.199 Test Loss: 3.392 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5712273120880127
Epoch: 17, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.427 Vali Acc: 0.211 Test Loss: 3.427 Test Acc: 0.211
Validation loss decreased (-0.204672 --> -0.210554).  Saving model ...
Epoch: 18 cost time: 0.5747888088226318
Epoch: 18, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.477 Vali Acc: 0.212 Test Loss: 3.477 Test Acc: 0.212
Validation loss decreased (-0.210554 --> -0.211730).  Saving model ...
Epoch: 19 cost time: 0.5306439399719238
Epoch: 19, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.505 Vali Acc: 0.227 Test Loss: 3.505 Test Acc: 0.227
Validation loss decreased (-0.211730 --> -0.227024).  Saving model ...
Epoch: 20 cost time: 0.6208994388580322
Epoch: 20, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.558 Vali Acc: 0.242 Test Loss: 3.558 Test Acc: 0.242
Validation loss decreased (-0.227024 --> -0.242317).  Saving model ...
Epoch: 21 cost time: 0.5807652473449707
Epoch: 21, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.590 Vali Acc: 0.231 Test Loss: 3.590 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5416185855865479
Epoch: 22, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.643 Vali Acc: 0.240 Test Loss: 3.643 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5858540534973145
Epoch: 23, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.711 Vali Acc: 0.239 Test Loss: 3.711 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6542670726776123
Epoch: 24, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.780 Vali Acc: 0.241 Test Loss: 3.780 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5556962490081787
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.814 Vali Acc: 0.239 Test Loss: 3.814 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5762155055999756
Epoch: 26, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.838 Vali Acc: 0.235 Test Loss: 3.838 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5811662673950195
Epoch: 27, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.871 Vali Acc: 0.241 Test Loss: 3.871 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.57377028465271
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.881 Vali Acc: 0.249 Test Loss: 3.881 Test Acc: 0.249
Validation loss decreased (-0.242317 --> -0.249373).  Saving model ...
Epoch: 29 cost time: 0.5739412307739258
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.901 Vali Acc: 0.246 Test Loss: 3.901 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5750837326049805
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.954 Vali Acc: 0.244 Test Loss: 3.954 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5719830989837646
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.966 Vali Acc: 0.248 Test Loss: 3.966 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5294790267944336
Epoch: 32, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.967 Vali Acc: 0.254 Test Loss: 3.967 Test Acc: 0.254
Validation loss decreased (-0.249373 --> -0.254078).  Saving model ...
Epoch: 33 cost time: 0.5588531494140625
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.982 Vali Acc: 0.261 Test Loss: 3.982 Test Acc: 0.261
Validation loss decreased (-0.254078 --> -0.261137).  Saving model ...
Epoch: 34 cost time: 0.5345351696014404
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.996 Vali Acc: 0.264 Test Loss: 3.996 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263489).  Saving model ...
Epoch: 35 cost time: 0.5408010482788086
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.027 Vali Acc: 0.259 Test Loss: 4.027 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5832934379577637
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.046 Vali Acc: 0.259 Test Loss: 4.046 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5174963474273682
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.072 Vali Acc: 0.260 Test Loss: 4.072 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5559241771697998
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.094 Vali Acc: 0.266 Test Loss: 4.094 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265841).  Saving model ...
Epoch: 39 cost time: 0.5611655712127686
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.099 Vali Acc: 0.267 Test Loss: 4.099 Test Acc: 0.267
Validation loss decreased (-0.265841 --> -0.267018).  Saving model ...
Epoch: 40 cost time: 0.5349018573760986
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.112 Vali Acc: 0.272 Test Loss: 4.112 Test Acc: 0.272
Validation loss decreased (-0.267018 --> -0.271724).  Saving model ...
Epoch: 41 cost time: 0.557379961013794
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.125 Vali Acc: 0.267 Test Loss: 4.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5689151287078857
Epoch: 42, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.136 Vali Acc: 0.273 Test Loss: 4.136 Test Acc: 0.273
Validation loss decreased (-0.271724 --> -0.272900).  Saving model ...
Epoch: 43 cost time: 0.5320186614990234
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.137 Vali Acc: 0.271 Test Loss: 4.137 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5763287544250488
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.156 Vali Acc: 0.275 Test Loss: 4.156 Test Acc: 0.275
Validation loss decreased (-0.272900 --> -0.275253).  Saving model ...
Epoch: 45 cost time: 0.5599920749664307
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.157 Vali Acc: 0.274 Test Loss: 4.157 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5862507820129395
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.172 Vali Acc: 0.275 Test Loss: 4.172 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.538100004196167
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.203 Vali Acc: 0.279 Test Loss: 4.203 Test Acc: 0.279
Validation loss decreased (-0.275253 --> -0.278782).  Saving model ...
Epoch: 48 cost time: 0.5951578617095947
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.210 Vali Acc: 0.275 Test Loss: 4.210 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5503687858581543
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.228 Vali Acc: 0.271 Test Loss: 4.228 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6309144496917725
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.241 Vali Acc: 0.268 Test Loss: 4.241 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.558711051940918
Epoch: 51, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.254 Vali Acc: 0.268 Test Loss: 4.254 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5708169937133789
Epoch: 52, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.243 Vali Acc: 0.272 Test Loss: 4.243 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.555811882019043
Epoch: 53, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.251 Vali Acc: 0.275 Test Loss: 4.251 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.5467860698699951
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.259 Vali Acc: 0.278 Test Loss: 4.259 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5420424938201904
Epoch: 55, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.285 Vali Acc: 0.274 Test Loss: 4.285 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.556760311126709
Epoch: 56, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.295 Vali Acc: 0.272 Test Loss: 4.295 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5481457710266113
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.303 Vali Acc: 0.275 Test Loss: 4.303 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 161946
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6466774940490723
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.381 Vali Acc: 0.034 Test Loss: 3.381 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.5826077461242676
Epoch: 2, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.357 Vali Acc: 0.036 Test Loss: 3.357 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.5795109272003174
Epoch: 3, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.333 Vali Acc: 0.045 Test Loss: 3.333 Test Acc: 0.045
Validation loss decreased (-0.036437 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.5572609901428223
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.314 Vali Acc: 0.061 Test Loss: 3.314 Test Acc: 0.061
Validation loss decreased (-0.044673 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.5501439571380615
Epoch: 5, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.306 Vali Acc: 0.076 Test Loss: 3.306 Test Acc: 0.076
Validation loss decreased (-0.061143 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.5566203594207764
Epoch: 6, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.291 Vali Acc: 0.093 Test Loss: 3.291 Test Acc: 0.093
Validation loss decreased (-0.076438 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 0.5687117576599121
Epoch: 7, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.283 Vali Acc: 0.108 Test Loss: 3.283 Test Acc: 0.108
Validation loss decreased (-0.092908 --> -0.108202).  Saving model ...
Epoch: 8 cost time: 0.57977294921875
Epoch: 8, Steps: 10 | Train Loss: 2.402 Vali Loss: 3.278 Vali Acc: 0.116 Test Loss: 3.278 Test Acc: 0.116
Validation loss decreased (-0.108202 --> -0.116438).  Saving model ...
Epoch: 9 cost time: 0.5540862083435059
Epoch: 9, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.269 Vali Acc: 0.133 Test Loss: 3.269 Test Acc: 0.133
Validation loss decreased (-0.116438 --> -0.132908).  Saving model ...
Epoch: 10 cost time: 0.533963680267334
Epoch: 10, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.263 Vali Acc: 0.139 Test Loss: 3.263 Test Acc: 0.139
Validation loss decreased (-0.132908 --> -0.138791).  Saving model ...
Epoch: 11 cost time: 0.5732264518737793
Epoch: 11, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.270 Vali Acc: 0.152 Test Loss: 3.270 Test Acc: 0.152
Validation loss decreased (-0.138791 --> -0.151732).  Saving model ...
Epoch: 12 cost time: 0.4932076930999756
Epoch: 12, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.289 Vali Acc: 0.152 Test Loss: 3.289 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5935699939727783
Epoch: 13, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.297 Vali Acc: 0.167 Test Loss: 3.297 Test Acc: 0.167
Validation loss decreased (-0.151732 --> -0.167026).  Saving model ...
Epoch: 14 cost time: 0.5904784202575684
Epoch: 14, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.314 Vali Acc: 0.169 Test Loss: 3.314 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 15 cost time: 0.5454013347625732
Epoch: 15, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.343 Vali Acc: 0.172 Test Loss: 3.343 Test Acc: 0.172
Validation loss decreased (-0.169379 --> -0.171731).  Saving model ...
Epoch: 16 cost time: 0.5759391784667969
Epoch: 16, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.361 Vali Acc: 0.175 Test Loss: 3.361 Test Acc: 0.175
Validation loss decreased (-0.171731 --> -0.175261).  Saving model ...
Epoch: 17 cost time: 0.5629565715789795
Epoch: 17, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.383 Vali Acc: 0.191 Test Loss: 3.383 Test Acc: 0.191
Validation loss decreased (-0.175261 --> -0.190554).  Saving model ...
Epoch: 18 cost time: 0.5824337005615234
Epoch: 18, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.422 Vali Acc: 0.192 Test Loss: 3.422 Test Acc: 0.192
Validation loss decreased (-0.190554 --> -0.191730).  Saving model ...
Epoch: 19 cost time: 0.5867974758148193
Epoch: 19, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.458 Vali Acc: 0.209 Test Loss: 3.458 Test Acc: 0.209
Validation loss decreased (-0.191730 --> -0.209377).  Saving model ...
Epoch: 20 cost time: 0.5036256313323975
Epoch: 20, Steps: 10 | Train Loss: 0.678 Vali Loss: 3.504 Vali Acc: 0.213 Test Loss: 3.504 Test Acc: 0.213
Validation loss decreased (-0.209377 --> -0.212906).  Saving model ...
Epoch: 21 cost time: 0.5745983123779297
Epoch: 21, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.529 Vali Acc: 0.216 Test Loss: 3.529 Test Acc: 0.216
Validation loss decreased (-0.212906 --> -0.216435).  Saving model ...
Epoch: 22 cost time: 0.5613539218902588
Epoch: 22, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.580 Vali Acc: 0.216 Test Loss: 3.580 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5952048301696777
Epoch: 23, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.628 Vali Acc: 0.224 Test Loss: 3.628 Test Acc: 0.224
Validation loss decreased (-0.216435 --> -0.223493).  Saving model ...
Epoch: 24 cost time: 0.5666437149047852
Epoch: 24, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.694 Vali Acc: 0.234 Test Loss: 3.694 Test Acc: 0.234
Validation loss decreased (-0.223493 --> -0.234081).  Saving model ...
Epoch: 25 cost time: 0.6091911792755127
Epoch: 25, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.742 Vali Acc: 0.235 Test Loss: 3.742 Test Acc: 0.235
Validation loss decreased (-0.234081 --> -0.235257).  Saving model ...
Epoch: 26 cost time: 0.5597279071807861
Epoch: 26, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.782 Vali Acc: 0.238 Test Loss: 3.782 Test Acc: 0.238
Validation loss decreased (-0.235257 --> -0.237609).  Saving model ...
Epoch: 27 cost time: 0.5493669509887695
Epoch: 27, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.792 Vali Acc: 0.248 Test Loss: 3.792 Test Acc: 0.248
Validation loss decreased (-0.237609 --> -0.248197).  Saving model ...
Epoch: 28 cost time: 0.547978401184082
Epoch: 28, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.827 Vali Acc: 0.246 Test Loss: 3.827 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5562906265258789
Epoch: 29, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.873 Vali Acc: 0.245 Test Loss: 3.873 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5750715732574463
Epoch: 30, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.897 Vali Acc: 0.248 Test Loss: 3.897 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5574185848236084
Epoch: 31, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.927 Vali Acc: 0.251 Test Loss: 3.927 Test Acc: 0.251
Validation loss decreased (-0.248197 --> -0.250549).  Saving model ...
Epoch: 32 cost time: 0.5671095848083496
Epoch: 32, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.971 Vali Acc: 0.252 Test Loss: 3.971 Test Acc: 0.252
Validation loss decreased (-0.250549 --> -0.251725).  Saving model ...
Epoch: 33 cost time: 0.5954904556274414
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.017 Vali Acc: 0.258 Test Loss: 4.017 Test Acc: 0.258
Validation loss decreased (-0.251725 --> -0.257607).  Saving model ...
Epoch: 34 cost time: 0.5841865539550781
Epoch: 34, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.021 Vali Acc: 0.254 Test Loss: 4.021 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5486307144165039
Epoch: 35, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.060 Vali Acc: 0.252 Test Loss: 4.060 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.566643238067627
Epoch: 36, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.081 Vali Acc: 0.249 Test Loss: 4.081 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5739717483520508
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.087 Vali Acc: 0.251 Test Loss: 4.087 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.550755500793457
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.108 Vali Acc: 0.254 Test Loss: 4.108 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5744824409484863
Epoch: 39, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.130 Vali Acc: 0.254 Test Loss: 4.130 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5406606197357178
Epoch: 40, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6602883338928223
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.173 Vali Acc: 0.248 Test Loss: 4.173 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6257894039154053
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.182 Vali Acc: 0.255 Test Loss: 4.182 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5886673927307129
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.199 Vali Acc: 0.260 Test Loss: 4.199 Test Acc: 0.260
Validation loss decreased (-0.257607 --> -0.259958).  Saving model ...
Epoch: 44 cost time: 0.5979695320129395
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.209 Vali Acc: 0.259 Test Loss: 4.209 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.567598819732666
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.207 Vali Acc: 0.261 Test Loss: 4.207 Test Acc: 0.261
Validation loss decreased (-0.259958 --> -0.261134).  Saving model ...
Epoch: 46 cost time: 0.5521640777587891
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.229 Vali Acc: 0.260 Test Loss: 4.229 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5725066661834717
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.235 Vali Acc: 0.262 Test Loss: 4.235 Test Acc: 0.262
Validation loss decreased (-0.261134 --> -0.262311).  Saving model ...
Epoch: 48 cost time: 0.573930025100708
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.250 Vali Acc: 0.264 Test Loss: 4.250 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 49 cost time: 0.595379114151001
Epoch: 49, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.273 Vali Acc: 0.261 Test Loss: 4.273 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5972838401794434
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.281 Vali Acc: 0.260 Test Loss: 4.281 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5765678882598877
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.297 Vali Acc: 0.262 Test Loss: 4.297 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5252065658569336
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.313 Vali Acc: 0.262 Test Loss: 4.313 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5822653770446777
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.321 Vali Acc: 0.260 Test Loss: 4.321 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5979843139648438
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.313 Vali Acc: 0.264 Test Loss: 4.313 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6029987335205078
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.341 Vali Acc: 0.265 Test Loss: 4.341 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264662).  Saving model ...
Epoch: 56 cost time: 0.5830466747283936
Epoch: 56, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.353 Vali Acc: 0.264 Test Loss: 4.353 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5748500823974609
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.371 Vali Acc: 0.262 Test Loss: 4.371 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5996370315551758
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.382 Vali Acc: 0.262 Test Loss: 4.382 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5912041664123535
Epoch: 59, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.411 Vali Acc: 0.262 Test Loss: 4.411 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5655345916748047
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.417 Vali Acc: 0.265 Test Loss: 4.417 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5481407642364502
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.413 Vali Acc: 0.265 Test Loss: 4.413 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6104874610900879
Epoch: 62, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.424 Vali Acc: 0.262 Test Loss: 4.424 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5873813629150391
Epoch: 63, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.442 Vali Acc: 0.265 Test Loss: 4.442 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.6288294792175293
Epoch: 64, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.461 Vali Acc: 0.262 Test Loss: 4.461 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5872418880462646
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.482 Vali Acc: 0.259 Test Loss: 4.482 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 147482
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5923428535461426
Epoch: 1, Steps: 10 | Train Loss: 3.393 Vali Loss: 3.361 Vali Acc: 0.049 Test Loss: 3.361 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.5463125705718994
Epoch: 2, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.341 Vali Acc: 0.054 Test Loss: 3.341 Test Acc: 0.054
Validation loss decreased (-0.049378 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.5194447040557861
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.321 Vali Acc: 0.068 Test Loss: 3.321 Test Acc: 0.068
Validation loss decreased (-0.054084 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.5584850311279297
Epoch: 4, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.305 Vali Acc: 0.075 Test Loss: 3.305 Test Acc: 0.075
Validation loss decreased (-0.068202 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.553947925567627
Epoch: 5, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.5488548278808594
Epoch: 6, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.290 Vali Acc: 0.091 Test Loss: 3.290 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090555).  Saving model ...
Epoch: 7 cost time: 0.5525081157684326
Epoch: 7, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.285 Vali Acc: 0.106 Test Loss: 3.285 Test Acc: 0.106
Validation loss decreased (-0.090555 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 0.5651891231536865
Epoch: 8, Steps: 10 | Train Loss: 2.407 Vali Loss: 3.280 Vali Acc: 0.115 Test Loss: 3.280 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115261).  Saving model ...
Epoch: 9 cost time: 0.5829353332519531
Epoch: 9, Steps: 10 | Train Loss: 2.325 Vali Loss: 3.275 Vali Acc: 0.127 Test Loss: 3.275 Test Acc: 0.127
Validation loss decreased (-0.115261 --> -0.127026).  Saving model ...
Epoch: 10 cost time: 0.5910317897796631
Epoch: 10, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.270 Vali Acc: 0.132 Test Loss: 3.270 Test Acc: 0.132
Validation loss decreased (-0.127026 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 0.5315418243408203
Epoch: 11, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.266 Vali Acc: 0.141 Test Loss: 3.266 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 12 cost time: 0.5417661666870117
Epoch: 12, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.272 Vali Acc: 0.158 Test Loss: 3.272 Test Acc: 0.158
Validation loss decreased (-0.141144 --> -0.157614).  Saving model ...
Epoch: 13 cost time: 0.5417108535766602
Epoch: 13, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.282 Vali Acc: 0.160 Test Loss: 3.282 Test Acc: 0.160
Validation loss decreased (-0.157614 --> -0.159967).  Saving model ...
Epoch: 14 cost time: 0.5642604827880859
Epoch: 14, Steps: 10 | Train Loss: 1.549 Vali Loss: 3.301 Vali Acc: 0.161 Test Loss: 3.301 Test Acc: 0.161
Validation loss decreased (-0.159967 --> -0.161143).  Saving model ...
Epoch: 15 cost time: 0.5705475807189941
Epoch: 15, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.318 Vali Acc: 0.169 Test Loss: 3.318 Test Acc: 0.169
Validation loss decreased (-0.161143 --> -0.169379).  Saving model ...
Epoch: 16 cost time: 0.5559432506561279
Epoch: 16, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.345 Vali Acc: 0.179 Test Loss: 3.345 Test Acc: 0.179
Validation loss decreased (-0.169379 --> -0.178790).  Saving model ...
Epoch: 17 cost time: 0.5353705883026123
Epoch: 17, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.348 Vali Acc: 0.184 Test Loss: 3.348 Test Acc: 0.184
Validation loss decreased (-0.178790 --> -0.183496).  Saving model ...
Epoch: 18 cost time: 0.5607719421386719
Epoch: 18, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.378 Vali Acc: 0.189 Test Loss: 3.378 Test Acc: 0.189
Validation loss decreased (-0.183496 --> -0.189378).  Saving model ...
Epoch: 19 cost time: 0.6184532642364502
Epoch: 19, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.396 Vali Acc: 0.199 Test Loss: 3.396 Test Acc: 0.199
Validation loss decreased (-0.189378 --> -0.198790).  Saving model ...
Epoch: 20 cost time: 0.572702169418335
Epoch: 20, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.413 Vali Acc: 0.206 Test Loss: 3.413 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205848).  Saving model ...
Epoch: 21 cost time: 0.5640184879302979
Epoch: 21, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.448 Vali Acc: 0.218 Test Loss: 3.448 Test Acc: 0.218
Validation loss decreased (-0.205848 --> -0.217613).  Saving model ...
Epoch: 22 cost time: 0.5685403347015381
Epoch: 22, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.484 Vali Acc: 0.213 Test Loss: 3.484 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.60318922996521
Epoch: 23, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.523 Vali Acc: 0.221 Test Loss: 3.523 Test Acc: 0.221
Validation loss decreased (-0.217613 --> -0.221141).  Saving model ...
Epoch: 24 cost time: 0.6188645362854004
Epoch: 24, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.536 Vali Acc: 0.235 Test Loss: 3.536 Test Acc: 0.235
Validation loss decreased (-0.221141 --> -0.235259).  Saving model ...
Epoch: 25 cost time: 0.617210865020752
Epoch: 25, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.577 Vali Acc: 0.239 Test Loss: 3.577 Test Acc: 0.239
Validation loss decreased (-0.235259 --> -0.238788).  Saving model ...
Epoch: 26 cost time: 0.5541026592254639
Epoch: 26, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.623 Vali Acc: 0.242 Test Loss: 3.623 Test Acc: 0.242
Validation loss decreased (-0.238788 --> -0.242317).  Saving model ...
Epoch: 27 cost time: 0.6074879169464111
Epoch: 27, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.653 Vali Acc: 0.245 Test Loss: 3.653 Test Acc: 0.245
Validation loss decreased (-0.242317 --> -0.244669).  Saving model ...
Epoch: 28 cost time: 0.5835278034210205
Epoch: 28, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.674 Vali Acc: 0.251 Test Loss: 3.674 Test Acc: 0.251
Validation loss decreased (-0.244669 --> -0.250551).  Saving model ...
Epoch: 29 cost time: 0.606128454208374
Epoch: 29, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.697 Vali Acc: 0.239 Test Loss: 3.697 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5751428604125977
Epoch: 30, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.721 Vali Acc: 0.240 Test Loss: 3.721 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5420050621032715
Epoch: 31, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.739 Vali Acc: 0.252 Test Loss: 3.739 Test Acc: 0.252
Validation loss decreased (-0.250551 --> -0.251727).  Saving model ...
Epoch: 32 cost time: 0.5361783504486084
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.761 Vali Acc: 0.254 Test Loss: 3.761 Test Acc: 0.254
Validation loss decreased (-0.251727 --> -0.254080).  Saving model ...
Epoch: 33 cost time: 0.5609662532806396
Epoch: 33, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.791 Vali Acc: 0.248 Test Loss: 3.791 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5528552532196045
Epoch: 34, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.806 Vali Acc: 0.252 Test Loss: 3.806 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5809242725372314
Epoch: 35, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.819 Vali Acc: 0.258 Test Loss: 3.819 Test Acc: 0.258
Validation loss decreased (-0.254080 --> -0.257609).  Saving model ...
Epoch: 36 cost time: 0.5962774753570557
Epoch: 36, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.830 Vali Acc: 0.259 Test Loss: 3.830 Test Acc: 0.259
Validation loss decreased (-0.257609 --> -0.258785).  Saving model ...
Epoch: 37 cost time: 0.5408878326416016
Epoch: 37, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.881 Vali Acc: 0.259 Test Loss: 3.881 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5500202178955078
Epoch: 38, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.900 Vali Acc: 0.265 Test Loss: 3.900 Test Acc: 0.265
Validation loss decreased (-0.258785 --> -0.264667).  Saving model ...
Epoch: 39 cost time: 0.5746936798095703
Epoch: 39, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.909 Vali Acc: 0.258 Test Loss: 3.909 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5840108394622803
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.921 Vali Acc: 0.255 Test Loss: 3.921 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.535322904586792
Epoch: 41, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.934 Vali Acc: 0.251 Test Loss: 3.934 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.546180248260498
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.949 Vali Acc: 0.253 Test Loss: 3.949 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5696372985839844
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.971 Vali Acc: 0.251 Test Loss: 3.971 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5551903247833252
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.010 Vali Acc: 0.255 Test Loss: 4.010 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5638489723205566
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.017 Vali Acc: 0.258 Test Loss: 4.017 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5324957370758057
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.011 Vali Acc: 0.266 Test Loss: 4.011 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265842).  Saving model ...
Epoch: 47 cost time: 0.5184221267700195
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.016 Vali Acc: 0.264 Test Loss: 4.016 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6065454483032227
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.014 Vali Acc: 0.260 Test Loss: 4.014 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5491912364959717
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.023 Vali Acc: 0.265 Test Loss: 4.023 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.44199085235595703
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.046 Vali Acc: 0.261 Test Loss: 4.046 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5659759044647217
Epoch: 51, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.079 Vali Acc: 0.262 Test Loss: 4.079 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.49416637420654297
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.090 Vali Acc: 0.268 Test Loss: 4.090 Test Acc: 0.268
Validation loss decreased (-0.265842 --> -0.268194).  Saving model ...
Epoch: 53 cost time: 0.4663815498352051
Epoch: 53, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.102 Vali Acc: 0.266 Test Loss: 4.102 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5178143978118896
Epoch: 54, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.111 Vali Acc: 0.265 Test Loss: 4.111 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.49315643310546875
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.107 Vali Acc: 0.261 Test Loss: 4.107 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5136473178863525
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.116 Vali Acc: 0.261 Test Loss: 4.116 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5591635704040527
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.115 Vali Acc: 0.261 Test Loss: 4.115 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5001804828643799
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.121 Vali Acc: 0.269 Test Loss: 4.121 Test Acc: 0.269
Validation loss decreased (-0.268194 --> -0.269371).  Saving model ...
Epoch: 59 cost time: 0.5009310245513916
Epoch: 59, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.129 Vali Acc: 0.268 Test Loss: 4.129 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5248713493347168
Epoch: 60, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.129 Vali Acc: 0.273 Test Loss: 4.129 Test Acc: 0.273
Validation loss decreased (-0.269371 --> -0.272900).  Saving model ...
Epoch: 61 cost time: 0.5322964191436768
Epoch: 61, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.141 Vali Acc: 0.272 Test Loss: 4.141 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5330703258514404
Epoch: 62, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.161 Vali Acc: 0.274 Test Loss: 4.161 Test Acc: 0.274
Validation loss decreased (-0.272900 --> -0.274076).  Saving model ...
Epoch: 63 cost time: 0.5289528369903564
Epoch: 63, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.168 Vali Acc: 0.279 Test Loss: 4.168 Test Acc: 0.279
Validation loss decreased (-0.274076 --> -0.278782).  Saving model ...
Epoch: 64 cost time: 0.5586185455322266
Epoch: 64, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.176 Vali Acc: 0.269 Test Loss: 4.176 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5680184364318848
Epoch: 65, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.154 Vali Acc: 0.267 Test Loss: 4.154 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5236833095550537
Epoch: 66, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.164 Vali Acc: 0.271 Test Loss: 4.164 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6092877388000488
Epoch: 67, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.212 Vali Acc: 0.271 Test Loss: 4.212 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5760724544525146
Epoch: 68, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.219 Vali Acc: 0.271 Test Loss: 4.219 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5507769584655762
Epoch: 69, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.230 Vali Acc: 0.269 Test Loss: 4.230 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5144221782684326
Epoch: 70, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.252 Vali Acc: 0.268 Test Loss: 4.252 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.522613525390625
Epoch: 71, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.261 Vali Acc: 0.271 Test Loss: 4.261 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5754446983337402
Epoch: 72, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.255 Vali Acc: 0.274 Test Loss: 4.255 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.5426311492919922
Epoch: 73, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.252 Vali Acc: 0.275 Test Loss: 4.252 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 142938
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7045094966888428
Epoch: 1, Steps: 10 | Train Loss: 3.442 Vali Loss: 3.361 Vali Acc: 0.045 Test Loss: 3.361 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.5841917991638184
Epoch: 2, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.432 Vali Acc: 0.104 Test Loss: 3.432 Test Acc: 0.104
Validation loss decreased (-0.044672 --> -0.103495).  Saving model ...
Epoch: 3 cost time: 0.6003425121307373
Epoch: 3, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.282 Vali Acc: 0.126 Test Loss: 3.282 Test Acc: 0.126
Validation loss decreased (-0.103495 --> -0.125850).  Saving model ...
Epoch: 4 cost time: 0.6367061138153076
Epoch: 4, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.280 Vali Acc: 0.142 Test Loss: 3.280 Test Acc: 0.142
Validation loss decreased (-0.125850 --> -0.142320).  Saving model ...
Epoch: 5 cost time: 0.587181568145752
Epoch: 5, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.315 Vali Acc: 0.174 Test Loss: 3.315 Test Acc: 0.174
Validation loss decreased (-0.142320 --> -0.174084).  Saving model ...
Epoch: 6 cost time: 0.6325585842132568
Epoch: 6, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.499 Vali Acc: 0.193 Test Loss: 3.499 Test Acc: 0.193
Validation loss decreased (-0.174084 --> -0.192906).  Saving model ...
Epoch: 7 cost time: 0.5948505401611328
Epoch: 7, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.501 Vali Acc: 0.216 Test Loss: 3.501 Test Acc: 0.216
Validation loss decreased (-0.192906 --> -0.216436).  Saving model ...
Epoch: 8 cost time: 0.6283149719238281
Epoch: 8, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.602 Vali Acc: 0.231 Test Loss: 3.602 Test Acc: 0.231
Validation loss decreased (-0.216436 --> -0.230552).  Saving model ...
Epoch: 9 cost time: 0.7261826992034912
Epoch: 9, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.857 Vali Acc: 0.233 Test Loss: 3.857 Test Acc: 0.233
Validation loss decreased (-0.230552 --> -0.232903).  Saving model ...
Epoch: 10 cost time: 0.7367799282073975
Epoch: 10, Steps: 10 | Train Loss: 0.202 Vali Loss: 4.008 Vali Acc: 0.242 Test Loss: 4.008 Test Acc: 0.242
Validation loss decreased (-0.232903 --> -0.242313).  Saving model ...
Epoch: 11 cost time: 0.7027771472930908
Epoch: 11, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.223 Vali Acc: 0.222 Test Loss: 4.223 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7198386192321777
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.362 Vali Acc: 0.239 Test Loss: 4.362 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7155542373657227
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.568 Vali Acc: 0.249 Test Loss: 4.568 Test Acc: 0.249
Validation loss decreased (-0.242313 --> -0.249366).  Saving model ...
Epoch: 14 cost time: 0.6974582672119141
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.684 Vali Acc: 0.258 Test Loss: 4.684 Test Acc: 0.258
Validation loss decreased (-0.249366 --> -0.257600).  Saving model ...
Epoch: 15 cost time: 0.7078711986541748
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.697 Vali Acc: 0.260 Test Loss: 4.697 Test Acc: 0.260
Validation loss decreased (-0.257600 --> -0.259953).  Saving model ...
Epoch: 16 cost time: 0.7353310585021973
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.913 Vali Acc: 0.248 Test Loss: 4.913 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6898233890533447
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.884 Vali Acc: 0.259 Test Loss: 4.884 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7008411884307861
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.852 Vali Acc: 0.264 Test Loss: 4.852 Test Acc: 0.264
Validation loss decreased (-0.259953 --> -0.263481).  Saving model ...
Epoch: 19 cost time: 0.747734785079956
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.882 Vali Acc: 0.268 Test Loss: 4.882 Test Acc: 0.268
Validation loss decreased (-0.263481 --> -0.268186).  Saving model ...
Epoch: 20 cost time: 0.737797737121582
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.873 Vali Acc: 0.265 Test Loss: 4.873 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7638158798217773
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.905 Vali Acc: 0.267 Test Loss: 4.905 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7470993995666504
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.918 Vali Acc: 0.269 Test Loss: 4.918 Test Acc: 0.269
Validation loss decreased (-0.268186 --> -0.269363).  Saving model ...
Epoch: 23 cost time: 0.7296926975250244
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.928 Vali Acc: 0.274 Test Loss: 4.928 Test Acc: 0.274
Validation loss decreased (-0.269363 --> -0.274068).  Saving model ...
Epoch: 24 cost time: 0.49598264694213867
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.948 Vali Acc: 0.274 Test Loss: 4.948 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6192793846130371
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.974 Vali Acc: 0.276 Test Loss: 4.974 Test Acc: 0.276
Validation loss decreased (-0.274068 --> -0.276421).  Saving model ...
Epoch: 26 cost time: 0.6183788776397705
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.992 Vali Acc: 0.273 Test Loss: 4.992 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6682860851287842
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.996 Vali Acc: 0.273 Test Loss: 4.996 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6251726150512695
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.008 Vali Acc: 0.273 Test Loss: 5.008 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6146197319030762
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.019 Vali Acc: 0.278 Test Loss: 5.019 Test Acc: 0.278
Validation loss decreased (-0.276421 --> -0.277597).  Saving model ...
Epoch: 30 cost time: 0.5792496204376221
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.043 Vali Acc: 0.279 Test Loss: 5.043 Test Acc: 0.279
Validation loss decreased (-0.277597 --> -0.278773).  Saving model ...
Epoch: 31 cost time: 0.5956976413726807
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.050 Vali Acc: 0.282 Test Loss: 5.050 Test Acc: 0.282
Validation loss decreased (-0.278773 --> -0.282302).  Saving model ...
Epoch: 32 cost time: 0.5923213958740234
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.059 Vali Acc: 0.280 Test Loss: 5.059 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6627638339996338
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.098 Vali Acc: 0.278 Test Loss: 5.098 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6644570827484131
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.117 Vali Acc: 0.278 Test Loss: 5.117 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6117234230041504
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.125 Vali Acc: 0.275 Test Loss: 5.125 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5947482585906982
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.146 Vali Acc: 0.279 Test Loss: 5.146 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5211472511291504
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.170 Vali Acc: 0.278 Test Loss: 5.170 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7136983871459961
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.182 Vali Acc: 0.279 Test Loss: 5.182 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7181775569915771
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.195 Vali Acc: 0.280 Test Loss: 5.195 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6772449016571045
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.213 Vali Acc: 0.280 Test Loss: 5.213 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7054777145385742
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.220 Vali Acc: 0.279 Test Loss: 5.220 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 455450
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5603926181793213
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.321 Vali Acc: 0.035 Test Loss: 3.321 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.560809850692749
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.335 Vali Acc: 0.059 Test Loss: 3.335 Test Acc: 0.059
Validation loss decreased (-0.035261 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.5589563846588135
Epoch: 3, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.379 Vali Acc: 0.081 Test Loss: 3.379 Test Acc: 0.081
Validation loss decreased (-0.058790 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.5553627014160156
Epoch: 4, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.277 Vali Acc: 0.126 Test Loss: 3.277 Test Acc: 0.126
Validation loss decreased (-0.081143 --> -0.125850).  Saving model ...
Epoch: 5 cost time: 0.5883119106292725
Epoch: 5, Steps: 10 | Train Loss: 2.203 Vali Loss: 3.224 Vali Acc: 0.148 Test Loss: 3.224 Test Acc: 0.148
Validation loss decreased (-0.125850 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.5866219997406006
Epoch: 6, Steps: 10 | Train Loss: 1.822 Vali Loss: 3.270 Vali Acc: 0.156 Test Loss: 3.270 Test Acc: 0.156
Validation loss decreased (-0.148203 --> -0.156438).  Saving model ...
Epoch: 7 cost time: 0.504551887512207
Epoch: 7, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.253 Vali Acc: 0.184 Test Loss: 3.253 Test Acc: 0.184
Validation loss decreased (-0.156438 --> -0.183497).  Saving model ...
Epoch: 8 cost time: 0.5371537208557129
Epoch: 8, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.324 Vali Acc: 0.191 Test Loss: 3.324 Test Acc: 0.191
Validation loss decreased (-0.183497 --> -0.190555).  Saving model ...
Epoch: 9 cost time: 0.5306591987609863
Epoch: 9, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.379 Vali Acc: 0.209 Test Loss: 3.379 Test Acc: 0.209
Validation loss decreased (-0.190555 --> -0.209378).  Saving model ...
Epoch: 10 cost time: 0.5787630081176758
Epoch: 10, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.459 Vali Acc: 0.226 Test Loss: 3.459 Test Acc: 0.226
Validation loss decreased (-0.209378 --> -0.225848).  Saving model ...
Epoch: 11 cost time: 0.5746586322784424
Epoch: 11, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.543 Vali Acc: 0.228 Test Loss: 3.543 Test Acc: 0.228
Validation loss decreased (-0.225848 --> -0.228200).  Saving model ...
Epoch: 12 cost time: 0.5547609329223633
Epoch: 12, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.641 Vali Acc: 0.238 Test Loss: 3.641 Test Acc: 0.238
Validation loss decreased (-0.228200 --> -0.237611).  Saving model ...
Epoch: 13 cost time: 0.5455982685089111
Epoch: 13, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.727 Vali Acc: 0.242 Test Loss: 3.727 Test Acc: 0.242
Validation loss decreased (-0.237611 --> -0.242316).  Saving model ...
Epoch: 14 cost time: 0.5619451999664307
Epoch: 14, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.860 Vali Acc: 0.254 Test Loss: 3.860 Test Acc: 0.254
Validation loss decreased (-0.242316 --> -0.254079).  Saving model ...
Epoch: 15 cost time: 0.5825858116149902
Epoch: 15, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.944 Vali Acc: 0.254 Test Loss: 3.944 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5476813316345215
Epoch: 16, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.019 Vali Acc: 0.252 Test Loss: 4.019 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5551958084106445
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.118 Vali Acc: 0.252 Test Loss: 4.118 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.541759729385376
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.226 Vali Acc: 0.261 Test Loss: 4.226 Test Acc: 0.261
Validation loss decreased (-0.254079 --> -0.261134).  Saving model ...
Epoch: 19 cost time: 0.6034884452819824
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.250 Vali Acc: 0.260 Test Loss: 4.250 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4947242736816406
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.281 Vali Acc: 0.269 Test Loss: 4.281 Test Acc: 0.269
Validation loss decreased (-0.261134 --> -0.269369).  Saving model ...
Epoch: 21 cost time: 0.5753540992736816
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.360 Vali Acc: 0.268 Test Loss: 4.360 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5831038951873779
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.422 Vali Acc: 0.268 Test Loss: 4.422 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5591981410980225
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.453 Vali Acc: 0.266 Test Loss: 4.453 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5507628917694092
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.462 Vali Acc: 0.273 Test Loss: 4.462 Test Acc: 0.273
Validation loss decreased (-0.269369 --> -0.272897).  Saving model ...
Epoch: 25 cost time: 0.5442521572113037
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.467 Vali Acc: 0.272 Test Loss: 4.467 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5676374435424805
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.500 Vali Acc: 0.281 Test Loss: 4.500 Test Acc: 0.281
Validation loss decreased (-0.272897 --> -0.281131).  Saving model ...
Epoch: 27 cost time: 0.5844948291778564
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.520 Vali Acc: 0.278 Test Loss: 4.520 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5559830665588379
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.552 Vali Acc: 0.276 Test Loss: 4.552 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5682144165039062
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.561 Vali Acc: 0.279 Test Loss: 4.561 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5461950302124023
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.575 Vali Acc: 0.272 Test Loss: 4.575 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5610857009887695
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.597 Vali Acc: 0.271 Test Loss: 4.597 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.599956750869751
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.274 Test Loss: 4.610 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5445737838745117
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.641 Vali Acc: 0.273 Test Loss: 4.641 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5929241180419922
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.662 Vali Acc: 0.275 Test Loss: 4.662 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.5982151031494141
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.677 Vali Acc: 0.272 Test Loss: 4.677 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5040919780731201
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.688 Vali Acc: 0.273 Test Loss: 4.688 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 266010
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8778076171875
Epoch: 1, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.374 Vali Acc: 0.048 Test Loss: 3.374 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5202150344848633
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.330 Vali Acc: 0.058 Test Loss: 3.330 Test Acc: 0.058
Validation loss decreased (-0.048202 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.4694199562072754
Epoch: 3, Steps: 10 | Train Loss: 3.038 Vali Loss: 3.340 Vali Acc: 0.082 Test Loss: 3.340 Test Acc: 0.082
Validation loss decreased (-0.057614 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.5323362350463867
Epoch: 4, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.310 Vali Acc: 0.089 Test Loss: 3.310 Test Acc: 0.089
Validation loss decreased (-0.082320 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 0.5504326820373535
Epoch: 5, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.273 Vali Acc: 0.116 Test Loss: 3.273 Test Acc: 0.116
Validation loss decreased (-0.089379 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.48795247077941895
Epoch: 6, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.266 Vali Acc: 0.128 Test Loss: 3.266 Test Acc: 0.128
Validation loss decreased (-0.116438 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 0.4951794147491455
Epoch: 7, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.240 Vali Acc: 0.145 Test Loss: 3.240 Test Acc: 0.145
Validation loss decreased (-0.128203 --> -0.144673).  Saving model ...
Epoch: 8 cost time: 0.5419631004333496
Epoch: 8, Steps: 10 | Train Loss: 1.644 Vali Loss: 3.269 Vali Acc: 0.161 Test Loss: 3.269 Test Acc: 0.161
Validation loss decreased (-0.144673 --> -0.161144).  Saving model ...
Epoch: 9 cost time: 0.5836536884307861
Epoch: 9, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.337 Vali Acc: 0.175 Test Loss: 3.337 Test Acc: 0.175
Validation loss decreased (-0.161144 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 0.5439314842224121
Epoch: 10, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.330 Vali Acc: 0.188 Test Loss: 3.330 Test Acc: 0.188
Validation loss decreased (-0.175261 --> -0.188202).  Saving model ...
Epoch: 11 cost time: 0.5328872203826904
Epoch: 11, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.362 Vali Acc: 0.195 Test Loss: 3.362 Test Acc: 0.195
Validation loss decreased (-0.188202 --> -0.195260).  Saving model ...
Epoch: 12 cost time: 0.5624239444732666
Epoch: 12, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.420 Vali Acc: 0.215 Test Loss: 3.420 Test Acc: 0.215
Validation loss decreased (-0.195260 --> -0.215260).  Saving model ...
Epoch: 13 cost time: 0.5064108371734619
Epoch: 13, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.520 Vali Acc: 0.224 Test Loss: 3.520 Test Acc: 0.224
Validation loss decreased (-0.215260 --> -0.223494).  Saving model ...
Epoch: 14 cost time: 0.5379621982574463
Epoch: 14, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.597 Vali Acc: 0.231 Test Loss: 3.597 Test Acc: 0.231
Validation loss decreased (-0.223494 --> -0.230552).  Saving model ...
Epoch: 15 cost time: 0.5420839786529541
Epoch: 15, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.648 Vali Acc: 0.236 Test Loss: 3.648 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236434).  Saving model ...
Epoch: 16 cost time: 0.5314180850982666
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.715 Vali Acc: 0.247 Test Loss: 3.715 Test Acc: 0.247
Validation loss decreased (-0.236434 --> -0.247022).  Saving model ...
Epoch: 17 cost time: 0.5288705825805664
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.822 Vali Acc: 0.242 Test Loss: 3.822 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5329148769378662
Epoch: 18, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.916 Vali Acc: 0.244 Test Loss: 3.916 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5466747283935547
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.952 Vali Acc: 0.247 Test Loss: 3.952 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5226233005523682
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.057 Vali Acc: 0.242 Test Loss: 4.057 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.544156551361084
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.138 Vali Acc: 0.248 Test Loss: 4.138 Test Acc: 0.248
Validation loss decreased (-0.247022 --> -0.248194).  Saving model ...
Epoch: 22 cost time: 0.5607123374938965
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.186 Vali Acc: 0.241 Test Loss: 4.186 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4571051597595215
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.255 Vali Acc: 0.239 Test Loss: 4.255 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5686571598052979
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.264 Vali Acc: 0.244 Test Loss: 4.264 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6421971321105957
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.273 Vali Acc: 0.244 Test Loss: 4.273 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5715687274932861
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.324 Vali Acc: 0.251 Test Loss: 4.324 Test Acc: 0.251
Validation loss decreased (-0.248194 --> -0.250545).  Saving model ...
Epoch: 27 cost time: 0.5415968894958496
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.398 Vali Acc: 0.248 Test Loss: 4.398 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6024045944213867
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.428 Vali Acc: 0.248 Test Loss: 4.428 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5649604797363281
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.445 Vali Acc: 0.253 Test Loss: 4.445 Test Acc: 0.253
Validation loss decreased (-0.250545 --> -0.252897).  Saving model ...
Epoch: 30 cost time: 0.5270333290100098
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.468 Vali Acc: 0.246 Test Loss: 4.468 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5293571949005127
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.473 Vali Acc: 0.248 Test Loss: 4.473 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5273184776306152
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.498 Vali Acc: 0.249 Test Loss: 4.498 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5603463649749756
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.522 Vali Acc: 0.252 Test Loss: 4.522 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.49857473373413086
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.539 Vali Acc: 0.256 Test Loss: 4.539 Test Acc: 0.256
Validation loss decreased (-0.252897 --> -0.256425).  Saving model ...
Epoch: 35 cost time: 0.5223264694213867
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.551 Vali Acc: 0.254 Test Loss: 4.551 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5333988666534424
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.567 Vali Acc: 0.254 Test Loss: 4.567 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5721790790557861
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.585 Vali Acc: 0.256 Test Loss: 4.585 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5223071575164795
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.604 Vali Acc: 0.255 Test Loss: 4.604 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5306050777435303
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.636 Vali Acc: 0.253 Test Loss: 4.636 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5385620594024658
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.647 Vali Acc: 0.253 Test Loss: 4.647 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5279874801635742
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.664 Vali Acc: 0.253 Test Loss: 4.664 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5707671642303467
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.659 Vali Acc: 0.253 Test Loss: 4.659 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5725159645080566
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.677 Vali Acc: 0.252 Test Loss: 4.677 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5552730560302734
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.703 Vali Acc: 0.254 Test Loss: 4.703 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 201370
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4723458290100098
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.362 Vali Acc: 0.040 Test Loss: 3.362 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.6698176860809326
Epoch: 2, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.334 Vali Acc: 0.058 Test Loss: 3.334 Test Acc: 0.058
Validation loss decreased (-0.039966 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.5491106510162354
Epoch: 3, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.348 Vali Acc: 0.065 Test Loss: 3.348 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 0.5914931297302246
Epoch: 4, Steps: 10 | Train Loss: 2.892 Vali Loss: 3.370 Vali Acc: 0.081 Test Loss: 3.370 Test Acc: 0.081
Validation loss decreased (-0.064672 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.5682516098022461
Epoch: 5, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.353 Vali Acc: 0.106 Test Loss: 3.353 Test Acc: 0.106
Validation loss decreased (-0.081143 --> -0.105849).  Saving model ...
Epoch: 6 cost time: 0.6027426719665527
Epoch: 6, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.298 Vali Acc: 0.116 Test Loss: 3.298 Test Acc: 0.116
Validation loss decreased (-0.105849 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.5883388519287109
Epoch: 7, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.287 Vali Acc: 0.135 Test Loss: 3.287 Test Acc: 0.135
Validation loss decreased (-0.116438 --> -0.135261).  Saving model ...
Epoch: 8 cost time: 0.6306405067443848
Epoch: 8, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.298 Vali Acc: 0.148 Test Loss: 3.298 Test Acc: 0.148
Validation loss decreased (-0.135261 --> -0.148202).  Saving model ...
Epoch: 9 cost time: 0.545335054397583
Epoch: 9, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.271 Vali Acc: 0.164 Test Loss: 3.271 Test Acc: 0.164
Validation loss decreased (-0.148202 --> -0.163497).  Saving model ...
Epoch: 10 cost time: 0.5314130783081055
Epoch: 10, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.299 Vali Acc: 0.178 Test Loss: 3.299 Test Acc: 0.178
Validation loss decreased (-0.163497 --> -0.177614).  Saving model ...
Epoch: 11 cost time: 0.5636734962463379
Epoch: 11, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.330 Vali Acc: 0.195 Test Loss: 3.330 Test Acc: 0.195
Validation loss decreased (-0.177614 --> -0.195261).  Saving model ...
Epoch: 12 cost time: 0.5715982913970947
Epoch: 12, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.395 Vali Acc: 0.192 Test Loss: 3.395 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6394243240356445
Epoch: 13, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.428 Vali Acc: 0.212 Test Loss: 3.428 Test Acc: 0.212
Validation loss decreased (-0.195261 --> -0.211730).  Saving model ...
Epoch: 14 cost time: 0.5665197372436523
Epoch: 14, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.457 Vali Acc: 0.212 Test Loss: 3.457 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.581730842590332
Epoch: 15, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.516 Vali Acc: 0.219 Test Loss: 3.516 Test Acc: 0.219
Validation loss decreased (-0.211730 --> -0.218788).  Saving model ...
Epoch: 16 cost time: 0.584125280380249
Epoch: 16, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.587 Vali Acc: 0.235 Test Loss: 3.587 Test Acc: 0.235
Validation loss decreased (-0.218788 --> -0.235258).  Saving model ...
Epoch: 17 cost time: 0.5805597305297852
Epoch: 17, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.683 Vali Acc: 0.222 Test Loss: 3.683 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5846052169799805
Epoch: 18, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.744 Vali Acc: 0.234 Test Loss: 3.744 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.545142412185669
Epoch: 19, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.830 Vali Acc: 0.238 Test Loss: 3.830 Test Acc: 0.238
Validation loss decreased (-0.235258 --> -0.237609).  Saving model ...
Epoch: 20 cost time: 0.5707187652587891
Epoch: 20, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.871 Vali Acc: 0.235 Test Loss: 3.871 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5892202854156494
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.952 Vali Acc: 0.235 Test Loss: 3.952 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6355996131896973
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.051 Vali Acc: 0.236 Test Loss: 4.051 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5709781646728516
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.123 Vali Acc: 0.238 Test Loss: 4.123 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5839378833770752
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.131 Vali Acc: 0.238 Test Loss: 4.131 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5366499423980713
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.202 Vali Acc: 0.244 Test Loss: 4.202 Test Acc: 0.244
Validation loss decreased (-0.237609 --> -0.243487).  Saving model ...
Epoch: 26 cost time: 0.5880239009857178
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.253 Vali Acc: 0.248 Test Loss: 4.253 Test Acc: 0.248
Validation loss decreased (-0.243487 --> -0.248193).  Saving model ...
Epoch: 27 cost time: 0.49805569648742676
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.306 Vali Acc: 0.242 Test Loss: 4.306 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5728542804718018
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.356 Vali Acc: 0.240 Test Loss: 4.356 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6050119400024414
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.362 Vali Acc: 0.238 Test Loss: 4.362 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5867524147033691
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.364 Vali Acc: 0.235 Test Loss: 4.364 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5829670429229736
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.414 Vali Acc: 0.239 Test Loss: 4.414 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5659189224243164
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.467 Vali Acc: 0.244 Test Loss: 4.467 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5903658866882324
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.477 Vali Acc: 0.246 Test Loss: 4.477 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6687753200531006
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.492 Vali Acc: 0.246 Test Loss: 4.492 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6098732948303223
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.497 Vali Acc: 0.245 Test Loss: 4.497 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5372748374938965
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.509 Vali Acc: 0.248 Test Loss: 4.509 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 171674
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5695600509643555
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.352 Vali Acc: 0.041 Test Loss: 3.352 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.4712529182434082
Epoch: 2, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.318 Vali Acc: 0.065 Test Loss: 3.318 Test Acc: 0.065
Validation loss decreased (-0.041143 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.463284969329834
Epoch: 3, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.304 Vali Acc: 0.071 Test Loss: 3.304 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.561312198638916
Epoch: 4, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.299 Vali Acc: 0.085 Test Loss: 3.299 Test Acc: 0.085
Validation loss decreased (-0.070555 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 0.5490093231201172
Epoch: 5, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.298 Vali Acc: 0.094 Test Loss: 3.298 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.5360093116760254
Epoch: 6, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.287 Vali Acc: 0.106 Test Loss: 3.287 Test Acc: 0.106
Validation loss decreased (-0.094085 --> -0.105849).  Saving model ...
Epoch: 7 cost time: 0.5579147338867188
Epoch: 7, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.270 Vali Acc: 0.114 Test Loss: 3.270 Test Acc: 0.114
Validation loss decreased (-0.105849 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.5438675880432129
Epoch: 8, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.255 Vali Acc: 0.127 Test Loss: 3.255 Test Acc: 0.127
Validation loss decreased (-0.114085 --> -0.127026).  Saving model ...
Epoch: 9 cost time: 0.5362064838409424
Epoch: 9, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.242 Vali Acc: 0.140 Test Loss: 3.242 Test Acc: 0.140
Validation loss decreased (-0.127026 --> -0.139968).  Saving model ...
Epoch: 10 cost time: 0.5207614898681641
Epoch: 10, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.243 Vali Acc: 0.149 Test Loss: 3.243 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 11 cost time: 0.510385274887085
Epoch: 11, Steps: 10 | Train Loss: 1.695 Vali Loss: 3.253 Vali Acc: 0.161 Test Loss: 3.253 Test Acc: 0.161
Validation loss decreased (-0.149379 --> -0.161144).  Saving model ...
Epoch: 12 cost time: 0.5005073547363281
Epoch: 12, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.275 Vali Acc: 0.175 Test Loss: 3.275 Test Acc: 0.175
Validation loss decreased (-0.161144 --> -0.175261).  Saving model ...
Epoch: 13 cost time: 0.5719337463378906
Epoch: 13, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.304 Vali Acc: 0.189 Test Loss: 3.304 Test Acc: 0.189
Validation loss decreased (-0.175261 --> -0.189379).  Saving model ...
Epoch: 14 cost time: 0.4795496463775635
Epoch: 14, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.341 Vali Acc: 0.187 Test Loss: 3.341 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5248987674713135
Epoch: 15, Steps: 10 | Train Loss: 1.021 Vali Loss: 3.387 Vali Acc: 0.194 Test Loss: 3.387 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194084).  Saving model ...
Epoch: 16 cost time: 0.5109586715698242
Epoch: 16, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.423 Vali Acc: 0.202 Test Loss: 3.423 Test Acc: 0.202
Validation loss decreased (-0.194084 --> -0.202319).  Saving model ...
Epoch: 17 cost time: 0.4942960739135742
Epoch: 17, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.480 Vali Acc: 0.212 Test Loss: 3.480 Test Acc: 0.212
Validation loss decreased (-0.202319 --> -0.211730).  Saving model ...
Epoch: 18 cost time: 0.5477132797241211
Epoch: 18, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.515 Vali Acc: 0.224 Test Loss: 3.515 Test Acc: 0.224
Validation loss decreased (-0.211730 --> -0.223494).  Saving model ...
Epoch: 19 cost time: 0.5319056510925293
Epoch: 19, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.572 Vali Acc: 0.224 Test Loss: 3.572 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5020110607147217
Epoch: 20, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.626 Vali Acc: 0.225 Test Loss: 3.626 Test Acc: 0.225
Validation loss decreased (-0.223494 --> -0.224670).  Saving model ...
Epoch: 21 cost time: 0.45293116569519043
Epoch: 21, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.692 Vali Acc: 0.224 Test Loss: 3.692 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5484602451324463
Epoch: 22, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.755 Vali Acc: 0.231 Test Loss: 3.755 Test Acc: 0.231
Validation loss decreased (-0.224670 --> -0.230551).  Saving model ...
Epoch: 23 cost time: 0.4751434326171875
Epoch: 23, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.799 Vali Acc: 0.238 Test Loss: 3.799 Test Acc: 0.238
Validation loss decreased (-0.230551 --> -0.237609).  Saving model ...
Epoch: 24 cost time: 0.46561121940612793
Epoch: 24, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.854 Vali Acc: 0.242 Test Loss: 3.854 Test Acc: 0.242
Validation loss decreased (-0.237609 --> -0.242314).  Saving model ...
Epoch: 25 cost time: 0.5264930725097656
Epoch: 25, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.904 Vali Acc: 0.241 Test Loss: 3.904 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4980182647705078
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.943 Vali Acc: 0.239 Test Loss: 3.943 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5079679489135742
Epoch: 27, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.971 Vali Acc: 0.244 Test Loss: 3.971 Test Acc: 0.244
Validation loss decreased (-0.242314 --> -0.243490).  Saving model ...
Epoch: 28 cost time: 0.500169038772583
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.020 Vali Acc: 0.241 Test Loss: 4.020 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4722580909729004
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.071 Vali Acc: 0.235 Test Loss: 4.071 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4843559265136719
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.092 Vali Acc: 0.240 Test Loss: 4.092 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4816246032714844
Epoch: 31, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.125 Vali Acc: 0.242 Test Loss: 4.125 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5042972564697266
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.138 Vali Acc: 0.248 Test Loss: 4.138 Test Acc: 0.248
Validation loss decreased (-0.243490 --> -0.248194).  Saving model ...
Epoch: 33 cost time: 0.5019683837890625
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5272476673126221
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.182 Vali Acc: 0.249 Test Loss: 4.182 Test Acc: 0.249
Validation loss decreased (-0.248194 --> -0.249370).  Saving model ...
Epoch: 35 cost time: 0.5004856586456299
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.209 Vali Acc: 0.249 Test Loss: 4.209 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5211312770843506
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.238 Vali Acc: 0.253 Test Loss: 4.238 Test Acc: 0.253
Validation loss decreased (-0.249370 --> -0.252899).  Saving model ...
Epoch: 37 cost time: 0.5237927436828613
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.248 Vali Acc: 0.252 Test Loss: 4.248 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5161449909210205
Epoch: 38, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.283 Vali Acc: 0.252 Test Loss: 4.283 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5303008556365967
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.290 Vali Acc: 0.252 Test Loss: 4.290 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4902665615081787
Epoch: 40, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.303 Vali Acc: 0.252 Test Loss: 4.303 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4905424118041992
Epoch: 41, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.310 Vali Acc: 0.254 Test Loss: 4.310 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254075).  Saving model ...
Epoch: 42 cost time: 0.4787771701812744
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.327 Vali Acc: 0.252 Test Loss: 4.327 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5304050445556641
Epoch: 43, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.349 Vali Acc: 0.251 Test Loss: 4.349 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.47821903228759766
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.361 Vali Acc: 0.253 Test Loss: 4.361 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.49637722969055176
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.400 Vali Acc: 0.256 Test Loss: 4.400 Test Acc: 0.256
Validation loss decreased (-0.254075 --> -0.256427).  Saving model ...
Epoch: 46 cost time: 0.5370895862579346
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.417 Vali Acc: 0.251 Test Loss: 4.417 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.44244956970214844
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.431 Vali Acc: 0.255 Test Loss: 4.431 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5097172260284424
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.445 Vali Acc: 0.255 Test Loss: 4.445 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4918346405029297
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.460 Vali Acc: 0.256 Test Loss: 4.460 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.49727678298950195
Epoch: 50, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.456 Vali Acc: 0.258 Test Loss: 4.456 Test Acc: 0.258
Validation loss decreased (-0.256427 --> -0.257603).  Saving model ...
Epoch: 51 cost time: 0.47563886642456055
Epoch: 51, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.465 Vali Acc: 0.256 Test Loss: 4.465 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.503554105758667
Epoch: 52, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.469 Vali Acc: 0.255 Test Loss: 4.469 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.4866635799407959
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.488 Vali Acc: 0.255 Test Loss: 4.488 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.3924710750579834
Epoch: 54, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.515 Vali Acc: 0.256 Test Loss: 4.515 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.538360595703125
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.521 Vali Acc: 0.256 Test Loss: 4.521 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.47657251358032227
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.524 Vali Acc: 0.258 Test Loss: 4.524 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.49456048011779785
Epoch: 57, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.534 Vali Acc: 0.256 Test Loss: 4.534 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4522385597229004
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.540 Vali Acc: 0.259 Test Loss: 4.540 Test Acc: 0.259
Validation loss decreased (-0.257603 --> -0.258778).  Saving model ...
Epoch: 59 cost time: 0.5058495998382568
Epoch: 59, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.548 Vali Acc: 0.255 Test Loss: 4.548 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.512321949005127
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.587 Vali Acc: 0.254 Test Loss: 4.587 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.4850642681121826
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.625 Vali Acc: 0.251 Test Loss: 4.625 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.511655330657959
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.614 Vali Acc: 0.252 Test Loss: 4.614 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.4960813522338867
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.623 Vali Acc: 0.254 Test Loss: 4.623 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5508241653442383
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.623 Vali Acc: 0.254 Test Loss: 4.623 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.47748827934265137
Epoch: 65, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.628 Vali Acc: 0.253 Test Loss: 4.628 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5012049674987793
Epoch: 66, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.636 Vali Acc: 0.254 Test Loss: 4.636 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5105953216552734
Epoch: 67, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.665 Vali Acc: 0.252 Test Loss: 4.665 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5110929012298584
Epoch: 68, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.689 Vali Acc: 0.253 Test Loss: 4.689 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 137178
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4823822975158691
Epoch: 1, Steps: 10 | Train Loss: 3.505 Vali Loss: 3.365 Vali Acc: 0.048 Test Loss: 3.365 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.4756808280944824
Epoch: 2, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.344 Vali Acc: 0.052 Test Loss: 3.344 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.5017507076263428
Epoch: 3, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.323 Vali Acc: 0.062 Test Loss: 3.323 Test Acc: 0.062
Validation loss decreased (-0.051731 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.48502540588378906
Epoch: 4, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.311 Vali Acc: 0.075 Test Loss: 3.311 Test Acc: 0.075
Validation loss decreased (-0.062320 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.5311934947967529
Epoch: 5, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.298 Vali Acc: 0.084 Test Loss: 3.298 Test Acc: 0.084
Validation loss decreased (-0.075261 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 0.5293807983398438
Epoch: 6, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.288 Vali Acc: 0.095 Test Loss: 3.288 Test Acc: 0.095
Validation loss decreased (-0.083496 --> -0.095261).  Saving model ...
Epoch: 7 cost time: 0.5047636032104492
Epoch: 7, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.286 Vali Acc: 0.101 Test Loss: 3.286 Test Acc: 0.101
Validation loss decreased (-0.095261 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.5397632122039795
Epoch: 8, Steps: 10 | Train Loss: 2.383 Vali Loss: 3.276 Vali Acc: 0.112 Test Loss: 3.276 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 0.5333077907562256
Epoch: 9, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.267 Vali Acc: 0.134 Test Loss: 3.267 Test Acc: 0.134
Validation loss decreased (-0.111732 --> -0.134085).  Saving model ...
Epoch: 10 cost time: 0.5019407272338867
Epoch: 10, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.260 Vali Acc: 0.136 Test Loss: 3.260 Test Acc: 0.136
Validation loss decreased (-0.134085 --> -0.136438).  Saving model ...
Epoch: 11 cost time: 0.4757833480834961
Epoch: 11, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.260 Vali Acc: 0.152 Test Loss: 3.260 Test Acc: 0.152
Validation loss decreased (-0.136438 --> -0.151732).  Saving model ...
Epoch: 12 cost time: 0.49420595169067383
Epoch: 12, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.267 Vali Acc: 0.160 Test Loss: 3.267 Test Acc: 0.160
Validation loss decreased (-0.151732 --> -0.159967).  Saving model ...
Epoch: 13 cost time: 0.5021488666534424
Epoch: 13, Steps: 10 | Train Loss: 1.640 Vali Loss: 3.276 Vali Acc: 0.169 Test Loss: 3.276 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169379).  Saving model ...
Epoch: 14 cost time: 0.5314474105834961
Epoch: 14, Steps: 10 | Train Loss: 1.440 Vali Loss: 3.292 Vali Acc: 0.167 Test Loss: 3.292 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5172040462493896
Epoch: 15, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.316 Vali Acc: 0.180 Test Loss: 3.316 Test Acc: 0.180
Validation loss decreased (-0.169379 --> -0.179967).  Saving model ...
Epoch: 16 cost time: 0.4960150718688965
Epoch: 16, Steps: 10 | Train Loss: 1.178 Vali Loss: 3.337 Vali Acc: 0.186 Test Loss: 3.337 Test Acc: 0.186
Validation loss decreased (-0.179967 --> -0.185849).  Saving model ...
Epoch: 17 cost time: 0.5358314514160156
Epoch: 17, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.360 Vali Acc: 0.201 Test Loss: 3.360 Test Acc: 0.201
Validation loss decreased (-0.185849 --> -0.201143).  Saving model ...
Epoch: 18 cost time: 0.5050489902496338
Epoch: 18, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.396 Vali Acc: 0.198 Test Loss: 3.396 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5263957977294922
Epoch: 19, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.430 Vali Acc: 0.207 Test Loss: 3.430 Test Acc: 0.207
Validation loss decreased (-0.201143 --> -0.207025).  Saving model ...
Epoch: 20 cost time: 0.533250093460083
Epoch: 20, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.487 Vali Acc: 0.208 Test Loss: 3.487 Test Acc: 0.208
Validation loss decreased (-0.207025 --> -0.208200).  Saving model ...
Epoch: 21 cost time: 0.5293228626251221
Epoch: 21, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.522 Vali Acc: 0.213 Test Loss: 3.522 Test Acc: 0.213
Validation loss decreased (-0.208200 --> -0.212906).  Saving model ...
Epoch: 22 cost time: 0.5457456111907959
Epoch: 22, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.558 Vali Acc: 0.224 Test Loss: 3.558 Test Acc: 0.224
Validation loss decreased (-0.212906 --> -0.223494).  Saving model ...
Epoch: 23 cost time: 0.5301814079284668
Epoch: 23, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.589 Vali Acc: 0.234 Test Loss: 3.589 Test Acc: 0.234
Validation loss decreased (-0.223494 --> -0.234082).  Saving model ...
Epoch: 24 cost time: 0.49790000915527344
Epoch: 24, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.665 Vali Acc: 0.228 Test Loss: 3.665 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.526106595993042
Epoch: 25, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.751 Vali Acc: 0.224 Test Loss: 3.751 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5233592987060547
Epoch: 26, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.775 Vali Acc: 0.229 Test Loss: 3.775 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5676255226135254
Epoch: 27, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.816 Vali Acc: 0.228 Test Loss: 3.816 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.555882453918457
Epoch: 28, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.854 Vali Acc: 0.224 Test Loss: 3.854 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5300297737121582
Epoch: 29, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.891 Vali Acc: 0.228 Test Loss: 3.891 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5367932319641113
Epoch: 30, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.895 Vali Acc: 0.231 Test Loss: 3.895 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5446326732635498
Epoch: 31, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.953 Vali Acc: 0.234 Test Loss: 3.953 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6157424449920654
Epoch: 32, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.992 Vali Acc: 0.236 Test Loss: 3.992 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236431).  Saving model ...
Epoch: 33 cost time: 0.5512197017669678
Epoch: 33, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.993 Vali Acc: 0.241 Test Loss: 3.993 Test Acc: 0.241
Validation loss decreased (-0.236431 --> -0.241137).  Saving model ...
Epoch: 34 cost time: 0.5358109474182129
Epoch: 34, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.022 Vali Acc: 0.238 Test Loss: 4.022 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4933483600616455
Epoch: 35, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.057 Vali Acc: 0.239 Test Loss: 4.057 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5280539989471436
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.063 Vali Acc: 0.240 Test Loss: 4.063 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5244078636169434
Epoch: 37, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.081 Vali Acc: 0.234 Test Loss: 4.081 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5246114730834961
Epoch: 38, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.110 Vali Acc: 0.233 Test Loss: 4.110 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5267877578735352
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.127 Vali Acc: 0.244 Test Loss: 4.127 Test Acc: 0.244
Validation loss decreased (-0.241137 --> -0.243488).  Saving model ...
Epoch: 40 cost time: 0.532651424407959
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.149 Vali Acc: 0.241 Test Loss: 4.149 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5079238414764404
Epoch: 41, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.188 Vali Acc: 0.236 Test Loss: 4.188 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5141386985778809
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.193 Vali Acc: 0.242 Test Loss: 4.193 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5427358150482178
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.194 Vali Acc: 0.244 Test Loss: 4.194 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5202333927154541
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.216 Vali Acc: 0.244 Test Loss: 4.216 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5176796913146973
Epoch: 45, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.236 Vali Acc: 0.246 Test Loss: 4.236 Test Acc: 0.246
Validation loss decreased (-0.243488 --> -0.245840).  Saving model ...
Epoch: 46 cost time: 0.50874924659729
Epoch: 46, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.260 Vali Acc: 0.246 Test Loss: 4.260 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.49904847145080566
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.274 Vali Acc: 0.242 Test Loss: 4.274 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5475828647613525
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.298 Vali Acc: 0.245 Test Loss: 4.298 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5643966197967529
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.320 Vali Acc: 0.241 Test Loss: 4.320 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5662062168121338
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.321 Vali Acc: 0.240 Test Loss: 4.321 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5262336730957031
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.332 Vali Acc: 0.240 Test Loss: 4.332 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5429642200469971
Epoch: 52, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.336 Vali Acc: 0.247 Test Loss: 4.336 Test Acc: 0.247
Validation loss decreased (-0.245840 --> -0.247015).  Saving model ...
Epoch: 53 cost time: 0.5361855030059814
Epoch: 53, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.346 Vali Acc: 0.246 Test Loss: 4.346 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5671219825744629
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.354 Vali Acc: 0.251 Test Loss: 4.354 Test Acc: 0.251
Validation loss decreased (-0.247015 --> -0.250545).  Saving model ...
Epoch: 55 cost time: 0.49950218200683594
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.367 Vali Acc: 0.248 Test Loss: 4.367 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.526841402053833
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.385 Vali Acc: 0.246 Test Loss: 4.385 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5459027290344238
Epoch: 57, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.405 Vali Acc: 0.245 Test Loss: 4.405 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5236973762512207
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.412 Vali Acc: 0.247 Test Loss: 4.412 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5364580154418945
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.421 Vali Acc: 0.246 Test Loss: 4.421 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.518122673034668
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.439 Vali Acc: 0.247 Test Loss: 4.439 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.5350642204284668
Epoch: 61, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.435 Vali Acc: 0.247 Test Loss: 4.435 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.5188663005828857
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.436 Vali Acc: 0.247 Test Loss: 4.436 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.4622173309326172
Epoch: 63, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.472 Vali Acc: 0.245 Test Loss: 4.472 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5094516277313232
Epoch: 64, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.478 Vali Acc: 0.245 Test Loss: 4.478 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 122714
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6479918956756592
Epoch: 1, Steps: 10 | Train Loss: 3.406 Vali Loss: 3.390 Vali Acc: 0.031 Test Loss: 3.390 Test Acc: 0.031
Validation loss decreased (inf --> -0.030554).  Saving model ...
Epoch: 2 cost time: 0.4818382263183594
Epoch: 2, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.368 Vali Acc: 0.042 Test Loss: 3.368 Test Acc: 0.042
Validation loss decreased (-0.030554 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.517953634262085
Epoch: 3, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.348 Vali Acc: 0.051 Test Loss: 3.348 Test Acc: 0.051
Validation loss decreased (-0.042319 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.47936296463012695
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.332 Vali Acc: 0.065 Test Loss: 3.332 Test Acc: 0.065
Validation loss decreased (-0.050555 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.5022521018981934
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.319 Vali Acc: 0.084 Test Loss: 3.319 Test Acc: 0.084
Validation loss decreased (-0.064673 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 0.4626784324645996
Epoch: 6, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.317 Vali Acc: 0.095 Test Loss: 3.317 Test Acc: 0.095
Validation loss decreased (-0.083496 --> -0.095261).  Saving model ...
Epoch: 7 cost time: 0.4783658981323242
Epoch: 7, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.313 Vali Acc: 0.105 Test Loss: 3.313 Test Acc: 0.105
Validation loss decreased (-0.095261 --> -0.104673).  Saving model ...
Epoch: 8 cost time: 0.5573544502258301
Epoch: 8, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.302 Vali Acc: 0.106 Test Loss: 3.302 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 0.5361747741699219
Epoch: 9, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.293 Vali Acc: 0.111 Test Loss: 3.293 Test Acc: 0.111
Validation loss decreased (-0.105849 --> -0.110555).  Saving model ...
Epoch: 10 cost time: 0.5152533054351807
Epoch: 10, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.292 Vali Acc: 0.125 Test Loss: 3.292 Test Acc: 0.125
Validation loss decreased (-0.110555 --> -0.124673).  Saving model ...
Epoch: 11 cost time: 0.5060036182403564
Epoch: 11, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.296 Vali Acc: 0.134 Test Loss: 3.296 Test Acc: 0.134
Validation loss decreased (-0.124673 --> -0.134085).  Saving model ...
Epoch: 12 cost time: 0.5690562725067139
Epoch: 12, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.293 Vali Acc: 0.147 Test Loss: 3.293 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147026).  Saving model ...
Epoch: 13 cost time: 0.5609183311462402
Epoch: 13, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.308 Vali Acc: 0.156 Test Loss: 3.308 Test Acc: 0.156
Validation loss decreased (-0.147026 --> -0.156438).  Saving model ...
Epoch: 14 cost time: 0.49633359909057617
Epoch: 14, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.332 Vali Acc: 0.162 Test Loss: 3.332 Test Acc: 0.162
Validation loss decreased (-0.156438 --> -0.162320).  Saving model ...
Epoch: 15 cost time: 0.5222828388214111
Epoch: 15, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.348 Vali Acc: 0.169 Test Loss: 3.348 Test Acc: 0.169
Validation loss decreased (-0.162320 --> -0.169378).  Saving model ...
Epoch: 16 cost time: 0.5247621536254883
Epoch: 16, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.355 Vali Acc: 0.176 Test Loss: 3.355 Test Acc: 0.176
Validation loss decreased (-0.169378 --> -0.176437).  Saving model ...
Epoch: 17 cost time: 0.5364081859588623
Epoch: 17, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.367 Vali Acc: 0.185 Test Loss: 3.367 Test Acc: 0.185
Validation loss decreased (-0.176437 --> -0.184672).  Saving model ...
Epoch: 18 cost time: 0.5454413890838623
Epoch: 18, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.382 Vali Acc: 0.198 Test Loss: 3.382 Test Acc: 0.198
Validation loss decreased (-0.184672 --> -0.197613).  Saving model ...
Epoch: 19 cost time: 0.5509598255157471
Epoch: 19, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.416 Vali Acc: 0.201 Test Loss: 3.416 Test Acc: 0.201
Validation loss decreased (-0.197613 --> -0.201142).  Saving model ...
Epoch: 20 cost time: 0.5239450931549072
Epoch: 20, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.449 Vali Acc: 0.208 Test Loss: 3.449 Test Acc: 0.208
Validation loss decreased (-0.201142 --> -0.208201).  Saving model ...
Epoch: 21 cost time: 0.5242035388946533
Epoch: 21, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.487 Vali Acc: 0.215 Test Loss: 3.487 Test Acc: 0.215
Validation loss decreased (-0.208201 --> -0.215259).  Saving model ...
Epoch: 22 cost time: 0.5507681369781494
Epoch: 22, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.518 Vali Acc: 0.219 Test Loss: 3.518 Test Acc: 0.219
Validation loss decreased (-0.215259 --> -0.218788).  Saving model ...
Epoch: 23 cost time: 0.4928591251373291
Epoch: 23, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.556 Vali Acc: 0.214 Test Loss: 3.556 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4778015613555908
Epoch: 24, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.601 Vali Acc: 0.224 Test Loss: 3.601 Test Acc: 0.224
Validation loss decreased (-0.218788 --> -0.223493).  Saving model ...
Epoch: 25 cost time: 0.5133407115936279
Epoch: 25, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.632 Vali Acc: 0.225 Test Loss: 3.632 Test Acc: 0.225
Validation loss decreased (-0.223493 --> -0.224670).  Saving model ...
Epoch: 26 cost time: 0.5583798885345459
Epoch: 26, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.669 Vali Acc: 0.228 Test Loss: 3.669 Test Acc: 0.228
Validation loss decreased (-0.224670 --> -0.228199).  Saving model ...
Epoch: 27 cost time: 0.5360465049743652
Epoch: 27, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.712 Vali Acc: 0.228 Test Loss: 3.712 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4885141849517822
Epoch: 28, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.779 Vali Acc: 0.228 Test Loss: 3.779 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5467395782470703
Epoch: 29, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.829 Vali Acc: 0.227 Test Loss: 3.829 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5155835151672363
Epoch: 30, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.831 Vali Acc: 0.234 Test Loss: 3.831 Test Acc: 0.234
Validation loss decreased (-0.228199 --> -0.234079).  Saving model ...
Epoch: 31 cost time: 0.49123525619506836
Epoch: 31, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.842 Vali Acc: 0.228 Test Loss: 3.842 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5192043781280518
Epoch: 32, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.876 Vali Acc: 0.236 Test Loss: 3.876 Test Acc: 0.236
Validation loss decreased (-0.234079 --> -0.236432).  Saving model ...
Epoch: 33 cost time: 0.5602331161499023
Epoch: 33, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.905 Vali Acc: 0.240 Test Loss: 3.905 Test Acc: 0.240
Validation loss decreased (-0.236432 --> -0.239961).  Saving model ...
Epoch: 34 cost time: 0.4796416759490967
Epoch: 34, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.932 Vali Acc: 0.252 Test Loss: 3.932 Test Acc: 0.252
Validation loss decreased (-0.239961 --> -0.251725).  Saving model ...
Epoch: 35 cost time: 0.5297114849090576
Epoch: 35, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.947 Vali Acc: 0.252 Test Loss: 3.947 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5048203468322754
Epoch: 36, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.962 Vali Acc: 0.247 Test Loss: 3.962 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5228025913238525
Epoch: 37, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.001 Vali Acc: 0.245 Test Loss: 4.001 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5119197368621826
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.027 Vali Acc: 0.248 Test Loss: 4.027 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5348236560821533
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.025 Vali Acc: 0.253 Test Loss: 4.025 Test Acc: 0.253
Validation loss decreased (-0.251725 --> -0.252901).  Saving model ...
Epoch: 40 cost time: 0.5529241561889648
Epoch: 40, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.040 Vali Acc: 0.252 Test Loss: 4.040 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5102746486663818
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.055 Vali Acc: 0.260 Test Loss: 4.055 Test Acc: 0.260
Validation loss decreased (-0.252901 --> -0.259959).  Saving model ...
Epoch: 42 cost time: 0.5330483913421631
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.064 Vali Acc: 0.260 Test Loss: 4.064 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5160830020904541
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.080 Vali Acc: 0.256 Test Loss: 4.080 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5537450313568115
Epoch: 44, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.108 Vali Acc: 0.256 Test Loss: 4.108 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5132641792297363
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.124 Vali Acc: 0.259 Test Loss: 4.124 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5271515846252441
Epoch: 46, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.151 Vali Acc: 0.258 Test Loss: 4.151 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5252034664154053
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.164 Vali Acc: 0.259 Test Loss: 4.164 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5592637062072754
Epoch: 48, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.175 Vali Acc: 0.262 Test Loss: 4.175 Test Acc: 0.262
Validation loss decreased (-0.259959 --> -0.262311).  Saving model ...
Epoch: 49 cost time: 0.5188543796539307
Epoch: 49, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.194 Vali Acc: 0.261 Test Loss: 4.194 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5252151489257812
Epoch: 50, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.187 Vali Acc: 0.267 Test Loss: 4.187 Test Acc: 0.267
Validation loss decreased (-0.262311 --> -0.267017).  Saving model ...
Epoch: 51 cost time: 0.5257365703582764
Epoch: 51, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.189 Vali Acc: 0.262 Test Loss: 4.189 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4423646926879883
Epoch: 52, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.210 Vali Acc: 0.264 Test Loss: 4.210 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5874717235565186
Epoch: 53, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.216 Vali Acc: 0.262 Test Loss: 4.216 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.53798508644104
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.232 Vali Acc: 0.266 Test Loss: 4.232 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5382218360900879
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.236 Vali Acc: 0.266 Test Loss: 4.236 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6009914875030518
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.229 Vali Acc: 0.268 Test Loss: 4.229 Test Acc: 0.268
Validation loss decreased (-0.267017 --> -0.268193).  Saving model ...
Epoch: 57 cost time: 0.5178647041320801
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.250 Vali Acc: 0.273 Test Loss: 4.250 Test Acc: 0.273
Validation loss decreased (-0.268193 --> -0.272899).  Saving model ...
Epoch: 58 cost time: 0.515728235244751
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.266 Vali Acc: 0.268 Test Loss: 4.266 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5201730728149414
Epoch: 59, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.293 Vali Acc: 0.267 Test Loss: 4.293 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5348761081695557
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.307 Vali Acc: 0.268 Test Loss: 4.307 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5528402328491211
Epoch: 61, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.306 Vali Acc: 0.262 Test Loss: 4.306 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5667788982391357
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.327 Vali Acc: 0.267 Test Loss: 4.327 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5057833194732666
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.331 Vali Acc: 0.266 Test Loss: 4.331 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5066237449645996
Epoch: 64, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.330 Vali Acc: 0.264 Test Loss: 4.330 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5251524448394775
Epoch: 65, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.344 Vali Acc: 0.266 Test Loss: 4.344 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5324423313140869
Epoch: 66, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.344 Vali Acc: 0.271 Test Loss: 4.344 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.5430800914764404
Epoch: 67, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.348 Vali Acc: 0.272 Test Loss: 4.348 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm64_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 118170
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.649979591369629
Epoch: 1, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.323 Vali Acc: 0.024 Test Loss: 3.323 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.567432165145874
Epoch: 2, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.364 Vali Acc: 0.044 Test Loss: 3.364 Test Acc: 0.044
Validation loss decreased (-0.023496 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.5732507705688477
Epoch: 3, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.347 Vali Acc: 0.081 Test Loss: 3.347 Test Acc: 0.081
Validation loss decreased (-0.043496 --> -0.081143).  Saving model ...
Epoch: 4 cost time: 0.5922830104827881
Epoch: 4, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.256 Vali Acc: 0.116 Test Loss: 3.256 Test Acc: 0.116
Validation loss decreased (-0.081143 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.5956969261169434
Epoch: 5, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.230 Vali Acc: 0.139 Test Loss: 3.230 Test Acc: 0.139
Validation loss decreased (-0.116438 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.5850746631622314
Epoch: 6, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.228 Vali Acc: 0.154 Test Loss: 3.228 Test Acc: 0.154
Validation loss decreased (-0.138791 --> -0.154085).  Saving model ...
Epoch: 7 cost time: 0.5746583938598633
Epoch: 7, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.244 Vali Acc: 0.188 Test Loss: 3.244 Test Acc: 0.188
Validation loss decreased (-0.154085 --> -0.188203).  Saving model ...
Epoch: 8 cost time: 0.5814909934997559
Epoch: 8, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.296 Vali Acc: 0.206 Test Loss: 3.296 Test Acc: 0.206
Validation loss decreased (-0.188203 --> -0.205849).  Saving model ...
Epoch: 9 cost time: 0.5409674644470215
Epoch: 9, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.332 Vali Acc: 0.213 Test Loss: 3.332 Test Acc: 0.213
Validation loss decreased (-0.205849 --> -0.212908).  Saving model ...
Epoch: 10 cost time: 0.5465011596679688
Epoch: 10, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.376 Vali Acc: 0.240 Test Loss: 3.376 Test Acc: 0.240
Validation loss decreased (-0.212908 --> -0.239966).  Saving model ...
Epoch: 11 cost time: 0.5512435436248779
Epoch: 11, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.487 Vali Acc: 0.244 Test Loss: 3.487 Test Acc: 0.244
Validation loss decreased (-0.239966 --> -0.243495).  Saving model ...
Epoch: 12 cost time: 0.5616772174835205
Epoch: 12, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.584 Vali Acc: 0.247 Test Loss: 3.584 Test Acc: 0.247
Validation loss decreased (-0.243495 --> -0.247023).  Saving model ...
Epoch: 13 cost time: 0.5092086791992188
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.685 Vali Acc: 0.272 Test Loss: 3.685 Test Acc: 0.272
Validation loss decreased (-0.247023 --> -0.271728).  Saving model ...
Epoch: 14 cost time: 0.5485553741455078
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.784 Vali Acc: 0.280 Test Loss: 3.784 Test Acc: 0.280
Validation loss decreased (-0.271728 --> -0.279962).  Saving model ...
Epoch: 15 cost time: 0.5447273254394531
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.956 Vali Acc: 0.279 Test Loss: 3.956 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4486255645751953
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.066 Vali Acc: 0.268 Test Loss: 4.066 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5309250354766846
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.071 Vali Acc: 0.271 Test Loss: 4.071 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5745968818664551
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.134 Vali Acc: 0.274 Test Loss: 4.134 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.531419038772583
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.176 Vali Acc: 0.278 Test Loss: 4.176 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5720090866088867
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.231 Vali Acc: 0.281 Test Loss: 4.231 Test Acc: 0.281
Validation loss decreased (-0.279962 --> -0.281134).  Saving model ...
Epoch: 21 cost time: 0.5496630668640137
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.258 Vali Acc: 0.282 Test Loss: 4.258 Test Acc: 0.282
Validation loss decreased (-0.281134 --> -0.282310).  Saving model ...
Epoch: 22 cost time: 0.5985207557678223
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.298 Vali Acc: 0.285 Test Loss: 4.298 Test Acc: 0.285
Validation loss decreased (-0.282310 --> -0.284663).  Saving model ...
Epoch: 23 cost time: 0.5860869884490967
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.313 Vali Acc: 0.287 Test Loss: 4.313 Test Acc: 0.287
Validation loss decreased (-0.284663 --> -0.287016).  Saving model ...
Epoch: 24 cost time: 0.5540924072265625
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.335 Vali Acc: 0.282 Test Loss: 4.335 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5987625122070312
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.359 Vali Acc: 0.278 Test Loss: 4.359 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5806236267089844
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.387 Vali Acc: 0.279 Test Loss: 4.387 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5904064178466797
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.415 Vali Acc: 0.287 Test Loss: 4.415 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.610569953918457
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.438 Vali Acc: 0.285 Test Loss: 4.438 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5618741512298584
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.456 Vali Acc: 0.284 Test Loss: 4.456 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5990893840789795
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.449 Vali Acc: 0.286 Test Loss: 4.449 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5543315410614014
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.484 Vali Acc: 0.286 Test Loss: 4.484 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5701980590820312
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.509 Vali Acc: 0.284 Test Loss: 4.509 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5908253192901611
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.528 Vali Acc: 0.288 Test Loss: 4.528 Test Acc: 0.288
Validation loss decreased (-0.287016 --> -0.288190).  Saving model ...
Epoch: 34 cost time: 0.5765869617462158
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.538 Vali Acc: 0.286 Test Loss: 4.538 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5728473663330078
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.552 Vali Acc: 0.284 Test Loss: 4.552 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5978877544403076
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.566 Vali Acc: 0.285 Test Loss: 4.566 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6045072078704834
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.587 Vali Acc: 0.288 Test Loss: 4.587 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5583081245422363
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.602 Vali Acc: 0.288 Test Loss: 4.602 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4912135601043701
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.621 Vali Acc: 0.292 Test Loss: 4.621 Test Acc: 0.292
Validation loss decreased (-0.288190 --> -0.291718).  Saving model ...
Epoch: 40 cost time: 0.5453999042510986
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.618 Vali Acc: 0.291 Test Loss: 4.618 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5529327392578125
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.633 Vali Acc: 0.286 Test Loss: 4.633 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5538327693939209
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.649 Vali Acc: 0.286 Test Loss: 4.649 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5423300266265869
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.651 Vali Acc: 0.287 Test Loss: 4.651 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5210146903991699
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.669 Vali Acc: 0.289 Test Loss: 4.669 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5259382724761963
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.677 Vali Acc: 0.292 Test Loss: 4.677 Test Acc: 0.292
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5002446174621582
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.709 Vali Acc: 0.288 Test Loss: 4.709 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5468318462371826
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.714 Vali Acc: 0.289 Test Loss: 4.714 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5465900897979736
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.715 Vali Acc: 0.286 Test Loss: 4.715 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5353653430938721
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.748 Vali Acc: 0.288 Test Loss: 4.748 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 252986
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.513719081878662
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.359 Vali Acc: 0.033 Test Loss: 3.359 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.5588395595550537
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.329 Vali Acc: 0.064 Test Loss: 3.329 Test Acc: 0.064
Validation loss decreased (-0.032908 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.5216240882873535
Epoch: 3, Steps: 10 | Train Loss: 3.036 Vali Loss: 3.337 Vali Acc: 0.066 Test Loss: 3.337 Test Acc: 0.066
Validation loss decreased (-0.063496 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.5057995319366455
Epoch: 4, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.338 Vali Acc: 0.089 Test Loss: 3.338 Test Acc: 0.089
Validation loss decreased (-0.065849 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 0.5134961605072021
Epoch: 5, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.301 Vali Acc: 0.101 Test Loss: 3.301 Test Acc: 0.101
Validation loss decreased (-0.089378 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 0.5411732196807861
Epoch: 6, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.260 Vali Acc: 0.115 Test Loss: 3.260 Test Acc: 0.115
Validation loss decreased (-0.101143 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 0.41272425651550293
Epoch: 7, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.245 Vali Acc: 0.127 Test Loss: 3.245 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127026).  Saving model ...
Epoch: 8 cost time: 0.5127236843109131
Epoch: 8, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.245 Vali Acc: 0.142 Test Loss: 3.245 Test Acc: 0.142
Validation loss decreased (-0.127026 --> -0.142320).  Saving model ...
Epoch: 9 cost time: 0.4876878261566162
Epoch: 9, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.271 Vali Acc: 0.149 Test Loss: 3.271 Test Acc: 0.149
Validation loss decreased (-0.142320 --> -0.149379).  Saving model ...
Epoch: 10 cost time: 0.4905402660369873
Epoch: 10, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.295 Vali Acc: 0.168 Test Loss: 3.295 Test Acc: 0.168
Validation loss decreased (-0.149379 --> -0.168202).  Saving model ...
Epoch: 11 cost time: 0.5191867351531982
Epoch: 11, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.320 Vali Acc: 0.188 Test Loss: 3.320 Test Acc: 0.188
Validation loss decreased (-0.168202 --> -0.188202).  Saving model ...
Epoch: 12 cost time: 0.479097843170166
Epoch: 12, Steps: 10 | Train Loss: 1.107 Vali Loss: 3.369 Vali Acc: 0.205 Test Loss: 3.369 Test Acc: 0.205
Validation loss decreased (-0.188202 --> -0.204672).  Saving model ...
Epoch: 13 cost time: 0.5211830139160156
Epoch: 13, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.407 Vali Acc: 0.204 Test Loss: 3.407 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48026442527770996
Epoch: 14, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.434 Vali Acc: 0.225 Test Loss: 3.434 Test Acc: 0.225
Validation loss decreased (-0.204672 --> -0.224672).  Saving model ...
Epoch: 15 cost time: 0.49436402320861816
Epoch: 15, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.506 Vali Acc: 0.226 Test Loss: 3.506 Test Acc: 0.226
Validation loss decreased (-0.224672 --> -0.225847).  Saving model ...
Epoch: 16 cost time: 0.4650912284851074
Epoch: 16, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.545 Vali Acc: 0.226 Test Loss: 3.545 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5178635120391846
Epoch: 17, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.610 Vali Acc: 0.242 Test Loss: 3.610 Test Acc: 0.242
Validation loss decreased (-0.225847 --> -0.242317).  Saving model ...
Epoch: 18 cost time: 0.5346357822418213
Epoch: 18, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.635 Vali Acc: 0.252 Test Loss: 3.635 Test Acc: 0.252
Validation loss decreased (-0.242317 --> -0.251728).  Saving model ...
Epoch: 19 cost time: 0.5447983741760254
Epoch: 19, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.716 Vali Acc: 0.260 Test Loss: 3.716 Test Acc: 0.260
Validation loss decreased (-0.251728 --> -0.259963).  Saving model ...
Epoch: 20 cost time: 0.5493607521057129
Epoch: 20, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.766 Vali Acc: 0.258 Test Loss: 3.766 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5032751560211182
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.833 Vali Acc: 0.256 Test Loss: 3.833 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5671463012695312
Epoch: 22, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.909 Vali Acc: 0.256 Test Loss: 3.909 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5320761203765869
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.940 Vali Acc: 0.248 Test Loss: 3.940 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5112326145172119
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.989 Vali Acc: 0.256 Test Loss: 3.989 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5012624263763428
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.039 Vali Acc: 0.264 Test Loss: 4.039 Test Acc: 0.264
Validation loss decreased (-0.259963 --> -0.263489).  Saving model ...
Epoch: 26 cost time: 0.5343034267425537
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.072 Vali Acc: 0.261 Test Loss: 4.072 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5394001007080078
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.114 Vali Acc: 0.264 Test Loss: 4.114 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5221140384674072
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.121 Vali Acc: 0.264 Test Loss: 4.121 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5129516124725342
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.125 Vali Acc: 0.262 Test Loss: 4.125 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5264444351196289
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.148 Vali Acc: 0.261 Test Loss: 4.148 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5106086730957031
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.182 Vali Acc: 0.264 Test Loss: 4.182 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5200455188751221
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.205 Vali Acc: 0.266 Test Loss: 4.205 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265840).  Saving model ...
Epoch: 33 cost time: 0.5610024929046631
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.214 Vali Acc: 0.264 Test Loss: 4.214 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.553337574005127
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.230 Vali Acc: 0.262 Test Loss: 4.230 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5314326286315918
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.252 Vali Acc: 0.264 Test Loss: 4.252 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5342650413513184
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.273 Vali Acc: 0.266 Test Loss: 4.273 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5278811454772949
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.279 Vali Acc: 0.265 Test Loss: 4.279 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.548410177230835
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.304 Vali Acc: 0.266 Test Loss: 4.304 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5446093082427979
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.341 Vali Acc: 0.265 Test Loss: 4.341 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5462191104888916
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.357 Vali Acc: 0.269 Test Loss: 4.357 Test Acc: 0.269
Validation loss decreased (-0.265840 --> -0.269368).  Saving model ...
Epoch: 41 cost time: 0.5264222621917725
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.357 Vali Acc: 0.269 Test Loss: 4.357 Test Acc: 0.269
Validation loss decreased (-0.269368 --> -0.269368).  Saving model ...
Epoch: 42 cost time: 0.5147790908813477
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.368 Vali Acc: 0.271 Test Loss: 4.368 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270545).  Saving model ...
Epoch: 43 cost time: 0.5010433197021484
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.383 Vali Acc: 0.268 Test Loss: 4.383 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5235936641693115
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.383 Vali Acc: 0.272 Test Loss: 4.383 Test Acc: 0.272
Validation loss decreased (-0.270545 --> -0.271721).  Saving model ...
Epoch: 45 cost time: 0.5133154392242432
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.399 Vali Acc: 0.276 Test Loss: 4.399 Test Acc: 0.276
Validation loss decreased (-0.271721 --> -0.276427).  Saving model ...
Epoch: 46 cost time: 0.5294928550720215
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.389 Vali Acc: 0.274 Test Loss: 4.389 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5394494533538818
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.413 Vali Acc: 0.275 Test Loss: 4.413 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5218424797058105
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.439 Vali Acc: 0.275 Test Loss: 4.439 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5319733619689941
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.458 Vali Acc: 0.275 Test Loss: 4.458 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.528033971786499
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.475 Vali Acc: 0.273 Test Loss: 4.475 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5493991374969482
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.482 Vali Acc: 0.276 Test Loss: 4.482 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5528943538665771
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.500 Vali Acc: 0.273 Test Loss: 4.500 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5435123443603516
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.496 Vali Acc: 0.275 Test Loss: 4.496 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.5478074550628662
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.510 Vali Acc: 0.278 Test Loss: 4.510 Test Acc: 0.278
Validation loss decreased (-0.276427 --> -0.277602).  Saving model ...
Epoch: 55 cost time: 0.5734584331512451
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.523 Vali Acc: 0.278 Test Loss: 4.523 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5459432601928711
Epoch: 56, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.517 Vali Acc: 0.276 Test Loss: 4.517 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5436761379241943
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.516 Vali Acc: 0.280 Test Loss: 4.516 Test Acc: 0.280
Validation loss decreased (-0.277602 --> -0.279955).  Saving model ...
Epoch: 58 cost time: 0.5380024909973145
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.524 Vali Acc: 0.279 Test Loss: 4.524 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5299055576324463
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.548 Vali Acc: 0.281 Test Loss: 4.548 Test Acc: 0.281
Validation loss decreased (-0.279955 --> -0.281131).  Saving model ...
Epoch: 60 cost time: 0.5170385837554932
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.563 Vali Acc: 0.280 Test Loss: 4.563 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5088193416595459
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.573 Vali Acc: 0.281 Test Loss: 4.573 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5349938869476318
Epoch: 62, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.574 Vali Acc: 0.279 Test Loss: 4.574 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5480315685272217
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.590 Vali Acc: 0.275 Test Loss: 4.590 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5339810848236084
Epoch: 64, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.596 Vali Acc: 0.279 Test Loss: 4.596 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5144994258880615
Epoch: 65, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.606 Vali Acc: 0.276 Test Loss: 4.606 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5189404487609863
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.625 Vali Acc: 0.275 Test Loss: 4.625 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5080928802490234
Epoch: 67, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.616 Vali Acc: 0.279 Test Loss: 4.616 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.5430233478546143
Epoch: 68, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.624 Vali Acc: 0.284 Test Loss: 4.624 Test Acc: 0.284
Validation loss decreased (-0.281131 --> -0.283483).  Saving model ...
Epoch: 69 cost time: 0.5940876007080078
Epoch: 69, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.631 Vali Acc: 0.279 Test Loss: 4.631 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5017964839935303
Epoch: 70, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.638 Vali Acc: 0.282 Test Loss: 4.638 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5063073635101318
Epoch: 71, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.662 Vali Acc: 0.281 Test Loss: 4.662 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5251593589782715
Epoch: 72, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.652 Vali Acc: 0.280 Test Loss: 4.652 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.530193567276001
Epoch: 73, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.669 Vali Acc: 0.282 Test Loss: 4.669 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5074584484100342
Epoch: 74, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.672 Vali Acc: 0.286 Test Loss: 4.672 Test Acc: 0.286
Validation loss decreased (-0.283483 --> -0.285836).  Saving model ...
Epoch: 75 cost time: 0.5882019996643066
Epoch: 75, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.680 Vali Acc: 0.288 Test Loss: 4.680 Test Acc: 0.288
Validation loss decreased (-0.285836 --> -0.288188).  Saving model ...
Epoch: 76 cost time: 0.5020112991333008
Epoch: 76, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.678 Vali Acc: 0.289 Test Loss: 4.678 Test Acc: 0.289
Validation loss decreased (-0.288188 --> -0.289365).  Saving model ...
Epoch: 77 cost time: 0.5276546478271484
Epoch: 77, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.699 Vali Acc: 0.285 Test Loss: 4.699 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.4842820167541504
Epoch: 78, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.702 Vali Acc: 0.287 Test Loss: 4.702 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.534449577331543
Epoch: 79, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.713 Vali Acc: 0.285 Test Loss: 4.713 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.5363430976867676
Epoch: 80, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.720 Vali Acc: 0.287 Test Loss: 4.720 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5318596363067627
Epoch: 81, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.731 Vali Acc: 0.286 Test Loss: 4.731 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.5487384796142578
Epoch: 82, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.729 Vali Acc: 0.287 Test Loss: 4.729 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.5323154926300049
Epoch: 83, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.739 Vali Acc: 0.286 Test Loss: 4.739 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.5106968879699707
Epoch: 84, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.757 Vali Acc: 0.286 Test Loss: 4.757 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.5877399444580078
Epoch: 85, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.773 Vali Acc: 0.287 Test Loss: 4.773 Test Acc: 0.287
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.5349183082580566
Epoch: 86, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.779 Vali Acc: 0.286 Test Loss: 4.779 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 158266
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6472973823547363
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.365 Vali Acc: 0.034 Test Loss: 3.365 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.5110478401184082
Epoch: 2, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.339 Vali Acc: 0.044 Test Loss: 3.339 Test Acc: 0.044
Validation loss decreased (-0.034084 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.5152561664581299
Epoch: 3, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.334 Vali Acc: 0.067 Test Loss: 3.334 Test Acc: 0.067
Validation loss decreased (-0.043496 --> -0.067025).  Saving model ...
Epoch: 4 cost time: 0.545142650604248
Epoch: 4, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.341 Vali Acc: 0.078 Test Loss: 3.341 Test Acc: 0.078
Validation loss decreased (-0.067025 --> -0.077614).  Saving model ...
Epoch: 5 cost time: 0.4765937328338623
Epoch: 5, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.344 Vali Acc: 0.089 Test Loss: 3.344 Test Acc: 0.089
Validation loss decreased (-0.077614 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 0.5534043312072754
Epoch: 6, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.325 Vali Acc: 0.099 Test Loss: 3.325 Test Acc: 0.099
Validation loss decreased (-0.089378 --> -0.098790).  Saving model ...
Epoch: 7 cost time: 0.5289037227630615
Epoch: 7, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.300 Vali Acc: 0.115 Test Loss: 3.300 Test Acc: 0.115
Validation loss decreased (-0.098790 --> -0.115261).  Saving model ...
Epoch: 8 cost time: 0.5286622047424316
Epoch: 8, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.269 Vali Acc: 0.131 Test Loss: 3.269 Test Acc: 0.131
Validation loss decreased (-0.115261 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 0.5525212287902832
Epoch: 9, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.262 Vali Acc: 0.142 Test Loss: 3.262 Test Acc: 0.142
Validation loss decreased (-0.130556 --> -0.142320).  Saving model ...
Epoch: 10 cost time: 0.5333602428436279
Epoch: 10, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.246 Vali Acc: 0.159 Test Loss: 3.246 Test Acc: 0.159
Validation loss decreased (-0.142320 --> -0.158791).  Saving model ...
Epoch: 11 cost time: 0.6095995903015137
Epoch: 11, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.253 Vali Acc: 0.167 Test Loss: 3.253 Test Acc: 0.167
Validation loss decreased (-0.158791 --> -0.167026).  Saving model ...
Epoch: 12 cost time: 0.5336744785308838
Epoch: 12, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.272 Vali Acc: 0.172 Test Loss: 3.272 Test Acc: 0.172
Validation loss decreased (-0.167026 --> -0.171732).  Saving model ...
Epoch: 13 cost time: 0.5298619270324707
Epoch: 13, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.288 Vali Acc: 0.186 Test Loss: 3.288 Test Acc: 0.186
Validation loss decreased (-0.171732 --> -0.185849).  Saving model ...
Epoch: 14 cost time: 0.5581264495849609
Epoch: 14, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.299 Vali Acc: 0.202 Test Loss: 3.299 Test Acc: 0.202
Validation loss decreased (-0.185849 --> -0.202320).  Saving model ...
Epoch: 15 cost time: 0.5910093784332275
Epoch: 15, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.341 Vali Acc: 0.202 Test Loss: 3.341 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4709463119506836
Epoch: 16, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.384 Vali Acc: 0.224 Test Loss: 3.384 Test Acc: 0.224
Validation loss decreased (-0.202320 --> -0.223496).  Saving model ...
Epoch: 17 cost time: 0.5461461544036865
Epoch: 17, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.396 Vali Acc: 0.227 Test Loss: 3.396 Test Acc: 0.227
Validation loss decreased (-0.223496 --> -0.227025).  Saving model ...
Epoch: 18 cost time: 0.5523037910461426
Epoch: 18, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.432 Vali Acc: 0.240 Test Loss: 3.432 Test Acc: 0.240
Validation loss decreased (-0.227025 --> -0.239966).  Saving model ...
Epoch: 19 cost time: 0.5482590198516846
Epoch: 19, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.504 Vali Acc: 0.235 Test Loss: 3.504 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5465528964996338
Epoch: 20, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.547 Vali Acc: 0.241 Test Loss: 3.547 Test Acc: 0.241
Validation loss decreased (-0.239966 --> -0.241141).  Saving model ...
Epoch: 21 cost time: 0.49711108207702637
Epoch: 21, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.638 Vali Acc: 0.242 Test Loss: 3.638 Test Acc: 0.242
Validation loss decreased (-0.241141 --> -0.242317).  Saving model ...
Epoch: 22 cost time: 0.4893815517425537
Epoch: 22, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.669 Vali Acc: 0.252 Test Loss: 3.669 Test Acc: 0.252
Validation loss decreased (-0.242317 --> -0.251728).  Saving model ...
Epoch: 23 cost time: 0.539560079574585
Epoch: 23, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.717 Vali Acc: 0.249 Test Loss: 3.717 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5728969573974609
Epoch: 24, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.752 Vali Acc: 0.246 Test Loss: 3.752 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5301389694213867
Epoch: 25, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.798 Vali Acc: 0.245 Test Loss: 3.798 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5666224956512451
Epoch: 26, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.835 Vali Acc: 0.248 Test Loss: 3.835 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6125094890594482
Epoch: 27, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.905 Vali Acc: 0.246 Test Loss: 3.905 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.551079273223877
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.927 Vali Acc: 0.245 Test Loss: 3.927 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5539968013763428
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.960 Vali Acc: 0.246 Test Loss: 3.960 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5851447582244873
Epoch: 30, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.996 Vali Acc: 0.248 Test Loss: 3.996 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5536675453186035
Epoch: 31, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.042 Vali Acc: 0.246 Test Loss: 4.042 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5230107307434082
Epoch: 32, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.046 Vali Acc: 0.249 Test Loss: 4.046 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 125946
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8861656188964844
Epoch: 1, Steps: 10 | Train Loss: 3.423 Vali Loss: 3.392 Vali Acc: 0.038 Test Loss: 3.392 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.512364387512207
Epoch: 2, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.356 Vali Acc: 0.042 Test Loss: 3.356 Test Acc: 0.042
Validation loss decreased (-0.037613 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.5463228225708008
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.339 Vali Acc: 0.056 Test Loss: 3.339 Test Acc: 0.056
Validation loss decreased (-0.042319 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.5384986400604248
Epoch: 4, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.331 Vali Acc: 0.074 Test Loss: 3.331 Test Acc: 0.074
Validation loss decreased (-0.056437 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 0.5338413715362549
Epoch: 5, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.331 Vali Acc: 0.085 Test Loss: 3.331 Test Acc: 0.085
Validation loss decreased (-0.074084 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.5605804920196533
Epoch: 6, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.318 Vali Acc: 0.100 Test Loss: 3.318 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 0.5882763862609863
Epoch: 7, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.298 Vali Acc: 0.106 Test Loss: 3.298 Test Acc: 0.106
Validation loss decreased (-0.099967 --> -0.105849).  Saving model ...
Epoch: 8 cost time: 0.5855457782745361
Epoch: 8, Steps: 10 | Train Loss: 2.524 Vali Loss: 3.270 Vali Acc: 0.114 Test Loss: 3.270 Test Acc: 0.114
Validation loss decreased (-0.105849 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.5233221054077148
Epoch: 9, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.249 Vali Acc: 0.126 Test Loss: 3.249 Test Acc: 0.126
Validation loss decreased (-0.114085 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 0.5143589973449707
Epoch: 10, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.249 Vali Acc: 0.132 Test Loss: 3.249 Test Acc: 0.132
Validation loss decreased (-0.125850 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 0.5752153396606445
Epoch: 11, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.238 Vali Acc: 0.140 Test Loss: 3.238 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139968).  Saving model ...
Epoch: 12 cost time: 0.5593068599700928
Epoch: 12, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.231 Vali Acc: 0.149 Test Loss: 3.231 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 13 cost time: 0.6087489128112793
Epoch: 13, Steps: 10 | Train Loss: 1.679 Vali Loss: 3.239 Vali Acc: 0.151 Test Loss: 3.239 Test Acc: 0.151
Validation loss decreased (-0.149379 --> -0.150556).  Saving model ...
Epoch: 14 cost time: 0.5456349849700928
Epoch: 14, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.249 Vali Acc: 0.162 Test Loss: 3.249 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162320).  Saving model ...
Epoch: 15 cost time: 0.5336675643920898
Epoch: 15, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.254 Vali Acc: 0.172 Test Loss: 3.254 Test Acc: 0.172
Validation loss decreased (-0.162320 --> -0.171732).  Saving model ...
Epoch: 16 cost time: 0.5956549644470215
Epoch: 16, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.281 Vali Acc: 0.180 Test Loss: 3.281 Test Acc: 0.180
Validation loss decreased (-0.171732 --> -0.179967).  Saving model ...
Epoch: 17 cost time: 0.5791008472442627
Epoch: 17, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.306 Vali Acc: 0.196 Test Loss: 3.306 Test Acc: 0.196
Validation loss decreased (-0.179967 --> -0.196438).  Saving model ...
Epoch: 18 cost time: 0.4853851795196533
Epoch: 18, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.323 Vali Acc: 0.206 Test Loss: 3.323 Test Acc: 0.206
Validation loss decreased (-0.196438 --> -0.205849).  Saving model ...
Epoch: 19 cost time: 0.5200088024139404
Epoch: 19, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.342 Vali Acc: 0.219 Test Loss: 3.342 Test Acc: 0.219
Validation loss decreased (-0.205849 --> -0.218790).  Saving model ...
Epoch: 20 cost time: 0.5834980010986328
Epoch: 20, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.338 Vali Acc: 0.233 Test Loss: 3.338 Test Acc: 0.233
Validation loss decreased (-0.218790 --> -0.232908).  Saving model ...
Epoch: 21 cost time: 0.5659959316253662
Epoch: 21, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.393 Vali Acc: 0.235 Test Loss: 3.393 Test Acc: 0.235
Validation loss decreased (-0.232908 --> -0.235260).  Saving model ...
Epoch: 22 cost time: 0.5553333759307861
Epoch: 22, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.431 Vali Acc: 0.233 Test Loss: 3.431 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5698723793029785
Epoch: 23, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.469 Vali Acc: 0.238 Test Loss: 3.469 Test Acc: 0.238
Validation loss decreased (-0.235260 --> -0.237612).  Saving model ...
Epoch: 24 cost time: 0.49312567710876465
Epoch: 24, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.529 Vali Acc: 0.239 Test Loss: 3.529 Test Acc: 0.239
Validation loss decreased (-0.237612 --> -0.238788).  Saving model ...
Epoch: 25 cost time: 0.45592832565307617
Epoch: 25, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.572 Vali Acc: 0.241 Test Loss: 3.572 Test Acc: 0.241
Validation loss decreased (-0.238788 --> -0.241141).  Saving model ...
Epoch: 26 cost time: 0.5873494148254395
Epoch: 26, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.608 Vali Acc: 0.244 Test Loss: 3.608 Test Acc: 0.244
Validation loss decreased (-0.241141 --> -0.243493).  Saving model ...
Epoch: 27 cost time: 0.5407059192657471
Epoch: 27, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.611 Vali Acc: 0.258 Test Loss: 3.611 Test Acc: 0.258
Validation loss decreased (-0.243493 --> -0.257611).  Saving model ...
Epoch: 28 cost time: 0.6246919631958008
Epoch: 28, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.656 Vali Acc: 0.258 Test Loss: 3.656 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.57206130027771
Epoch: 29, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.691 Vali Acc: 0.262 Test Loss: 3.691 Test Acc: 0.262
Validation loss decreased (-0.257611 --> -0.262316).  Saving model ...
Epoch: 30 cost time: 0.45723390579223633
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.712 Vali Acc: 0.261 Test Loss: 3.712 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.49569225311279297
Epoch: 31, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.721 Vali Acc: 0.261 Test Loss: 3.721 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5941784381866455
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.765 Vali Acc: 0.262 Test Loss: 3.765 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5486242771148682
Epoch: 33, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.797 Vali Acc: 0.261 Test Loss: 3.797 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5686333179473877
Epoch: 34, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.835 Vali Acc: 0.258 Test Loss: 3.835 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5339193344116211
Epoch: 35, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.851 Vali Acc: 0.258 Test Loss: 3.851 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.590355634689331
Epoch: 36, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.890 Vali Acc: 0.264 Test Loss: 3.890 Test Acc: 0.264
Validation loss decreased (-0.262316 --> -0.263491).  Saving model ...
Epoch: 37 cost time: 0.6308078765869141
Epoch: 37, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.895 Vali Acc: 0.265 Test Loss: 3.895 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 38 cost time: 0.5197763442993164
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.916 Vali Acc: 0.261 Test Loss: 3.916 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5548954010009766
Epoch: 39, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.946 Vali Acc: 0.260 Test Loss: 3.946 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5956406593322754
Epoch: 40, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.941 Vali Acc: 0.260 Test Loss: 3.941 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5978195667266846
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.960 Vali Acc: 0.261 Test Loss: 3.960 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5291647911071777
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.960 Vali Acc: 0.264 Test Loss: 3.960 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5052878856658936
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.978 Vali Acc: 0.261 Test Loss: 3.978 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5533292293548584
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.018 Vali Acc: 0.266 Test Loss: 4.018 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265842).  Saving model ...
Epoch: 45 cost time: 0.5542867183685303
Epoch: 45, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.033 Vali Acc: 0.264 Test Loss: 4.033 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5742967128753662
Epoch: 46, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.052 Vali Acc: 0.265 Test Loss: 4.052 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5633628368377686
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.069 Vali Acc: 0.264 Test Loss: 4.069 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6529421806335449
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.088 Vali Acc: 0.260 Test Loss: 4.088 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5699646472930908
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.077 Vali Acc: 0.260 Test Loss: 4.077 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.563910961151123
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.104 Vali Acc: 0.264 Test Loss: 4.104 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5867824554443359
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.116 Vali Acc: 0.259 Test Loss: 4.116 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6092348098754883
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.125 Vali Acc: 0.260 Test Loss: 4.125 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5626125335693359
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.134 Vali Acc: 0.265 Test Loss: 4.134 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5403892993927002
Epoch: 54, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.148 Vali Acc: 0.261 Test Loss: 4.148 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 111098
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4842267036437988
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.353 Vali Acc: 0.047 Test Loss: 3.353 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.5196418762207031
Epoch: 2, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.341 Vali Acc: 0.046 Test Loss: 3.341 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5696489810943604
Epoch: 3, Steps: 10 | Train Loss: 3.156 Vali Loss: 3.334 Vali Acc: 0.038 Test Loss: 3.334 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5309641361236572
Epoch: 4, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48992919921875
Epoch: 5, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.316 Vali Acc: 0.066 Test Loss: 3.316 Test Acc: 0.066
Validation loss decreased (-0.047025 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.5604274272918701
Epoch: 6, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.313 Vali Acc: 0.072 Test Loss: 3.313 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.5414724349975586
Epoch: 7, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.311 Vali Acc: 0.085 Test Loss: 3.311 Test Acc: 0.085
Validation loss decreased (-0.071732 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.5486550331115723
Epoch: 8, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.297 Vali Acc: 0.081 Test Loss: 3.297 Test Acc: 0.081
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5789246559143066
Epoch: 9, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.291 Vali Acc: 0.094 Test Loss: 3.291 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.5539610385894775
Epoch: 10, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.282 Vali Acc: 0.098 Test Loss: 3.282 Test Acc: 0.098
Validation loss decreased (-0.094085 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 0.5387294292449951
Epoch: 11, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.281 Vali Acc: 0.114 Test Loss: 3.281 Test Acc: 0.114
Validation loss decreased (-0.097614 --> -0.114085).  Saving model ...
Epoch: 12 cost time: 0.45768117904663086
Epoch: 12, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.272 Vali Acc: 0.116 Test Loss: 3.272 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 0.5254685878753662
Epoch: 13, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.268 Vali Acc: 0.132 Test Loss: 3.268 Test Acc: 0.132
Validation loss decreased (-0.116438 --> -0.131732).  Saving model ...
Epoch: 14 cost time: 0.5125324726104736
Epoch: 14, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.272 Vali Acc: 0.140 Test Loss: 3.272 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139967).  Saving model ...
Epoch: 15 cost time: 0.5744912624359131
Epoch: 15, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.275 Vali Acc: 0.148 Test Loss: 3.275 Test Acc: 0.148
Validation loss decreased (-0.139967 --> -0.148203).  Saving model ...
Epoch: 16 cost time: 0.5293772220611572
Epoch: 16, Steps: 10 | Train Loss: 1.560 Vali Loss: 3.290 Vali Acc: 0.156 Test Loss: 3.290 Test Acc: 0.156
Validation loss decreased (-0.148203 --> -0.156438).  Saving model ...
Epoch: 17 cost time: 0.5516598224639893
Epoch: 17, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.299 Vali Acc: 0.173 Test Loss: 3.299 Test Acc: 0.173
Validation loss decreased (-0.156438 --> -0.172908).  Saving model ...
Epoch: 18 cost time: 0.5153424739837646
Epoch: 18, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.311 Vali Acc: 0.176 Test Loss: 3.311 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176437).  Saving model ...
Epoch: 19 cost time: 0.5638527870178223
Epoch: 19, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.327 Vali Acc: 0.187 Test Loss: 3.327 Test Acc: 0.187
Validation loss decreased (-0.176437 --> -0.187026).  Saving model ...
Epoch: 20 cost time: 0.5530643463134766
Epoch: 20, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.345 Vali Acc: 0.187 Test Loss: 3.345 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5134224891662598
Epoch: 21, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.370 Vali Acc: 0.198 Test Loss: 3.370 Test Acc: 0.198
Validation loss decreased (-0.187026 --> -0.197613).  Saving model ...
Epoch: 22 cost time: 0.5468168258666992
Epoch: 22, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.377 Vali Acc: 0.202 Test Loss: 3.377 Test Acc: 0.202
Validation loss decreased (-0.197613 --> -0.202319).  Saving model ...
Epoch: 23 cost time: 0.5055699348449707
Epoch: 23, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.398 Vali Acc: 0.209 Test Loss: 3.398 Test Acc: 0.209
Validation loss decreased (-0.202319 --> -0.209378).  Saving model ...
Epoch: 24 cost time: 0.4650592803955078
Epoch: 24, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.431 Vali Acc: 0.212 Test Loss: 3.431 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211730).  Saving model ...
Epoch: 25 cost time: 0.5753281116485596
Epoch: 25, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.442 Vali Acc: 0.222 Test Loss: 3.442 Test Acc: 0.222
Validation loss decreased (-0.211730 --> -0.222319).  Saving model ...
Epoch: 26 cost time: 0.5674211978912354
Epoch: 26, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.483 Vali Acc: 0.224 Test Loss: 3.483 Test Acc: 0.224
Validation loss decreased (-0.222319 --> -0.223495).  Saving model ...
Epoch: 27 cost time: 0.5327980518341064
Epoch: 27, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.516 Vali Acc: 0.226 Test Loss: 3.516 Test Acc: 0.226
Validation loss decreased (-0.223495 --> -0.225847).  Saving model ...
Epoch: 28 cost time: 0.49680280685424805
Epoch: 28, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.547 Vali Acc: 0.234 Test Loss: 3.547 Test Acc: 0.234
Validation loss decreased (-0.225847 --> -0.234082).  Saving model ...
Epoch: 29 cost time: 0.5158133506774902
Epoch: 29, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.556 Vali Acc: 0.232 Test Loss: 3.556 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.47993993759155273
Epoch: 30, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.584 Vali Acc: 0.228 Test Loss: 3.584 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5155813694000244
Epoch: 31, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.623 Vali Acc: 0.233 Test Loss: 3.623 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5430867671966553
Epoch: 32, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.665 Vali Acc: 0.236 Test Loss: 3.665 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236434).  Saving model ...
Epoch: 33 cost time: 0.5154671669006348
Epoch: 33, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.672 Vali Acc: 0.233 Test Loss: 3.672 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5811059474945068
Epoch: 34, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.682 Vali Acc: 0.234 Test Loss: 3.682 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5414066314697266
Epoch: 35, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.727 Vali Acc: 0.226 Test Loss: 3.727 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5563507080078125
Epoch: 36, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.746 Vali Acc: 0.231 Test Loss: 3.746 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6439149379730225
Epoch: 37, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.772 Vali Acc: 0.229 Test Loss: 3.772 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5188016891479492
Epoch: 38, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.784 Vali Acc: 0.234 Test Loss: 3.784 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6235716342926025
Epoch: 39, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.784 Vali Acc: 0.239 Test Loss: 3.784 Test Acc: 0.239
Validation loss decreased (-0.236434 --> -0.238786).  Saving model ...
Epoch: 40 cost time: 0.5848808288574219
Epoch: 40, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.795 Vali Acc: 0.239 Test Loss: 3.795 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5472621917724609
Epoch: 41, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.844 Vali Acc: 0.241 Test Loss: 3.844 Test Acc: 0.241
Validation loss decreased (-0.238786 --> -0.241138).  Saving model ...
Epoch: 42 cost time: 0.6148614883422852
Epoch: 42, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.865 Vali Acc: 0.240 Test Loss: 3.865 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5564367771148682
Epoch: 43, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.871 Vali Acc: 0.244 Test Loss: 3.871 Test Acc: 0.244
Validation loss decreased (-0.241138 --> -0.243491).  Saving model ...
Epoch: 44 cost time: 0.482241153717041
Epoch: 44, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.874 Vali Acc: 0.244 Test Loss: 3.874 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5141432285308838
Epoch: 45, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.888 Vali Acc: 0.244 Test Loss: 3.888 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4935038089752197
Epoch: 46, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.916 Vali Acc: 0.244 Test Loss: 3.916 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6174845695495605
Epoch: 47, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.927 Vali Acc: 0.242 Test Loss: 3.927 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.566727876663208
Epoch: 48, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.958 Vali Acc: 0.244 Test Loss: 3.958 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5295839309692383
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.969 Vali Acc: 0.242 Test Loss: 3.969 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5129749774932861
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.977 Vali Acc: 0.242 Test Loss: 3.977 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5542037487030029
Epoch: 51, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.992 Vali Acc: 0.245 Test Loss: 3.992 Test Acc: 0.245
Validation loss decreased (-0.243491 --> -0.244666).  Saving model ...
Epoch: 52 cost time: 0.5459470748901367
Epoch: 52, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.999 Vali Acc: 0.244 Test Loss: 3.999 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.47417426109313965
Epoch: 53, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.005 Vali Acc: 0.244 Test Loss: 4.005 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5218632221221924
Epoch: 54, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.028 Vali Acc: 0.242 Test Loss: 4.028 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.580040693283081
Epoch: 55, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.030 Vali Acc: 0.247 Test Loss: 4.030 Test Acc: 0.247
Validation loss decreased (-0.244666 --> -0.247019).  Saving model ...
Epoch: 56 cost time: 0.5311856269836426
Epoch: 56, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.024 Vali Acc: 0.242 Test Loss: 4.024 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5537905693054199
Epoch: 57, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.032 Vali Acc: 0.249 Test Loss: 4.032 Test Acc: 0.249
Validation loss decreased (-0.247019 --> -0.249371).  Saving model ...
Epoch: 58 cost time: 0.508399248123169
Epoch: 58, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.051 Vali Acc: 0.249 Test Loss: 4.051 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5591669082641602
Epoch: 59, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.054 Vali Acc: 0.251 Test Loss: 4.054 Test Acc: 0.251
Validation loss decreased (-0.249371 --> -0.250548).  Saving model ...
Epoch: 60 cost time: 0.5334529876708984
Epoch: 60, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.081 Vali Acc: 0.249 Test Loss: 4.081 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.574974775314331
Epoch: 61, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.091 Vali Acc: 0.251 Test Loss: 4.091 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5805699825286865
Epoch: 62, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.110 Vali Acc: 0.252 Test Loss: 4.110 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251724).  Saving model ...
Epoch: 63 cost time: 0.509209394454956
Epoch: 63, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.117 Vali Acc: 0.248 Test Loss: 4.117 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5193288326263428
Epoch: 64, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.144 Vali Acc: 0.246 Test Loss: 4.144 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5450634956359863
Epoch: 65, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.157 Vali Acc: 0.247 Test Loss: 4.157 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5460951328277588
Epoch: 66, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.169 Vali Acc: 0.253 Test Loss: 4.169 Test Acc: 0.253
Validation loss decreased (-0.251724 --> -0.252899).  Saving model ...
Epoch: 67 cost time: 0.5207319259643555
Epoch: 67, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.170 Vali Acc: 0.259 Test Loss: 4.170 Test Acc: 0.259
Validation loss decreased (-0.252899 --> -0.258782).  Saving model ...
Epoch: 68 cost time: 0.5242068767547607
Epoch: 68, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.168 Vali Acc: 0.255 Test Loss: 4.168 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5315842628479004
Epoch: 69, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.169 Vali Acc: 0.255 Test Loss: 4.169 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.54111647605896
Epoch: 70, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.189 Vali Acc: 0.255 Test Loss: 4.189 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5510334968566895
Epoch: 71, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.192 Vali Acc: 0.253 Test Loss: 4.192 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.4928014278411865
Epoch: 72, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.192 Vali Acc: 0.253 Test Loss: 4.192 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.6017413139343262
Epoch: 73, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.204 Vali Acc: 0.253 Test Loss: 4.204 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5506014823913574
Epoch: 74, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.201 Vali Acc: 0.256 Test Loss: 4.201 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5475730895996094
Epoch: 75, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.221 Vali Acc: 0.254 Test Loss: 4.221 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.5280115604400635
Epoch: 76, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.233 Vali Acc: 0.259 Test Loss: 4.233 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.5158488750457764
Epoch: 77, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.226 Vali Acc: 0.256 Test Loss: 4.226 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 93850
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6961967945098877
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.366 Vali Acc: 0.039 Test Loss: 3.366 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5108473300933838
Epoch: 2, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.343 Vali Acc: 0.034 Test Loss: 3.343 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5629160404205322
Epoch: 3, Steps: 10 | Train Loss: 3.360 Vali Loss: 3.329 Vali Acc: 0.035 Test Loss: 3.329 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.496859073638916
Epoch: 4, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.317 Vali Acc: 0.045 Test Loss: 3.317 Test Acc: 0.045
Validation loss decreased (-0.038790 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.5164916515350342
Epoch: 5, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.307 Vali Acc: 0.046 Test Loss: 3.307 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045849).  Saving model ...
Epoch: 6 cost time: 0.4860420227050781
Epoch: 6, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.297 Vali Acc: 0.051 Test Loss: 3.297 Test Acc: 0.051
Validation loss decreased (-0.045849 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 0.56221604347229
Epoch: 7, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.288 Vali Acc: 0.059 Test Loss: 3.288 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 0.515404462814331
Epoch: 8, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.284 Vali Acc: 0.072 Test Loss: 3.284 Test Acc: 0.072
Validation loss decreased (-0.058791 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 0.47576189041137695
Epoch: 9, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.279 Vali Acc: 0.079 Test Loss: 3.279 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.5168008804321289
Epoch: 10, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.275 Vali Acc: 0.089 Test Loss: 3.275 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089379).  Saving model ...
Epoch: 11 cost time: 0.5072488784790039
Epoch: 11, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.262 Vali Acc: 0.101 Test Loss: 3.262 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 0.5571730136871338
Epoch: 12, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.253 Vali Acc: 0.119 Test Loss: 3.253 Test Acc: 0.119
Validation loss decreased (-0.101144 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.5137450695037842
Epoch: 13, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.255 Vali Acc: 0.114 Test Loss: 3.255 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6236279010772705
Epoch: 14, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.244 Vali Acc: 0.129 Test Loss: 3.244 Test Acc: 0.129
Validation loss decreased (-0.118791 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 0.5159051418304443
Epoch: 15, Steps: 10 | Train Loss: 2.134 Vali Loss: 3.247 Vali Acc: 0.131 Test Loss: 3.247 Test Acc: 0.131
Validation loss decreased (-0.129379 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.529655933380127
Epoch: 16, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.240 Vali Acc: 0.140 Test Loss: 3.240 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.5457444190979004
Epoch: 17, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.236 Vali Acc: 0.142 Test Loss: 3.236 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 18 cost time: 0.5408673286437988
Epoch: 18, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.236 Vali Acc: 0.154 Test Loss: 3.236 Test Acc: 0.154
Validation loss decreased (-0.142321 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.5129597187042236
Epoch: 19, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.234 Vali Acc: 0.171 Test Loss: 3.234 Test Acc: 0.171
Validation loss decreased (-0.154085 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.5630536079406738
Epoch: 20, Steps: 10 | Train Loss: 1.468 Vali Loss: 3.238 Vali Acc: 0.169 Test Loss: 3.238 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5449960231781006
Epoch: 21, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.253 Vali Acc: 0.171 Test Loss: 3.253 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4497952461242676
Epoch: 22, Steps: 10 | Train Loss: 1.241 Vali Loss: 3.262 Vali Acc: 0.180 Test Loss: 3.262 Test Acc: 0.180
Validation loss decreased (-0.170556 --> -0.179967).  Saving model ...
Epoch: 23 cost time: 0.5507402420043945
Epoch: 23, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.276 Vali Acc: 0.186 Test Loss: 3.276 Test Acc: 0.186
Validation loss decreased (-0.179967 --> -0.185850).  Saving model ...
Epoch: 24 cost time: 0.5431203842163086
Epoch: 24, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.287 Vali Acc: 0.196 Test Loss: 3.287 Test Acc: 0.196
Validation loss decreased (-0.185850 --> -0.196438).  Saving model ...
Epoch: 25 cost time: 0.5129380226135254
Epoch: 25, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.309 Vali Acc: 0.195 Test Loss: 3.309 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4716618061065674
Epoch: 26, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.322 Vali Acc: 0.207 Test Loss: 3.322 Test Acc: 0.207
Validation loss decreased (-0.196438 --> -0.207026).  Saving model ...
Epoch: 27 cost time: 0.5282068252563477
Epoch: 27, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.344 Vali Acc: 0.207 Test Loss: 3.344 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.48728322982788086
Epoch: 28, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.347 Vali Acc: 0.209 Test Loss: 3.347 Test Acc: 0.209
Validation loss decreased (-0.207026 --> -0.209378).  Saving model ...
Epoch: 29 cost time: 0.48827672004699707
Epoch: 29, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.364 Vali Acc: 0.211 Test Loss: 3.364 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210555).  Saving model ...
Epoch: 30 cost time: 0.5225791931152344
Epoch: 30, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.406 Vali Acc: 0.213 Test Loss: 3.406 Test Acc: 0.213
Validation loss decreased (-0.210555 --> -0.212907).  Saving model ...
Epoch: 31 cost time: 0.48591089248657227
Epoch: 31, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.419 Vali Acc: 0.214 Test Loss: 3.419 Test Acc: 0.214
Validation loss decreased (-0.212907 --> -0.214083).  Saving model ...
Epoch: 32 cost time: 0.5580222606658936
Epoch: 32, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.454 Vali Acc: 0.225 Test Loss: 3.454 Test Acc: 0.225
Validation loss decreased (-0.214083 --> -0.224671).  Saving model ...
Epoch: 33 cost time: 0.5460009574890137
Epoch: 33, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.463 Vali Acc: 0.222 Test Loss: 3.463 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5396695137023926
Epoch: 34, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.446 Vali Acc: 0.225 Test Loss: 3.446 Test Acc: 0.225
Validation loss decreased (-0.224671 --> -0.224671).  Saving model ...
Epoch: 35 cost time: 0.5102443695068359
Epoch: 35, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.461 Vali Acc: 0.226 Test Loss: 3.461 Test Acc: 0.226
Validation loss decreased (-0.224671 --> -0.225848).  Saving model ...
Epoch: 36 cost time: 0.4748663902282715
Epoch: 36, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.519 Vali Acc: 0.228 Test Loss: 3.519 Test Acc: 0.228
Validation loss decreased (-0.225848 --> -0.228200).  Saving model ...
Epoch: 37 cost time: 0.5335390567779541
Epoch: 37, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.588 Vali Acc: 0.224 Test Loss: 3.588 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5612270832061768
Epoch: 38, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.566 Vali Acc: 0.218 Test Loss: 3.566 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5168135166168213
Epoch: 39, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.606 Vali Acc: 0.224 Test Loss: 3.606 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.535393238067627
Epoch: 40, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.627 Vali Acc: 0.235 Test Loss: 3.627 Test Acc: 0.235
Validation loss decreased (-0.228200 --> -0.235258).  Saving model ...
Epoch: 41 cost time: 0.513554573059082
Epoch: 41, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.592 Vali Acc: 0.227 Test Loss: 3.592 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5094165802001953
Epoch: 42, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.607 Vali Acc: 0.234 Test Loss: 3.607 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5268781185150146
Epoch: 43, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.617 Vali Acc: 0.229 Test Loss: 3.617 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5403320789337158
Epoch: 44, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.656 Vali Acc: 0.240 Test Loss: 3.656 Test Acc: 0.240
Validation loss decreased (-0.235258 --> -0.239963).  Saving model ...
Epoch: 45 cost time: 0.5705811977386475
Epoch: 45, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.684 Vali Acc: 0.236 Test Loss: 3.684 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5257606506347656
Epoch: 46, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.715 Vali Acc: 0.240 Test Loss: 3.715 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5052089691162109
Epoch: 47, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.719 Vali Acc: 0.235 Test Loss: 3.719 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5951583385467529
Epoch: 48, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.728 Vali Acc: 0.239 Test Loss: 3.728 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5323677062988281
Epoch: 49, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.750 Vali Acc: 0.240 Test Loss: 3.750 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5496532917022705
Epoch: 50, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.751 Vali Acc: 0.245 Test Loss: 3.751 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244668).  Saving model ...
Epoch: 51 cost time: 0.4998176097869873
Epoch: 51, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.749 Vali Acc: 0.246 Test Loss: 3.749 Test Acc: 0.246
Validation loss decreased (-0.244668 --> -0.245845).  Saving model ...
Epoch: 52 cost time: 0.5766749382019043
Epoch: 52, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.771 Vali Acc: 0.244 Test Loss: 3.771 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5392987728118896
Epoch: 53, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.804 Vali Acc: 0.247 Test Loss: 3.804 Test Acc: 0.247
Validation loss decreased (-0.245845 --> -0.247021).  Saving model ...
Epoch: 54 cost time: 0.5658245086669922
Epoch: 54, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.786 Vali Acc: 0.246 Test Loss: 3.786 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5423924922943115
Epoch: 55, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.800 Vali Acc: 0.245 Test Loss: 3.800 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.525601863861084
Epoch: 56, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.849 Vali Acc: 0.245 Test Loss: 3.849 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5702035427093506
Epoch: 57, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.872 Vali Acc: 0.248 Test Loss: 3.872 Test Acc: 0.248
Validation loss decreased (-0.247021 --> -0.248197).  Saving model ...
Epoch: 58 cost time: 0.5272116661071777
Epoch: 58, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.862 Vali Acc: 0.251 Test Loss: 3.862 Test Acc: 0.251
Validation loss decreased (-0.248197 --> -0.250550).  Saving model ...
Epoch: 59 cost time: 0.5278632640838623
Epoch: 59, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.854 Vali Acc: 0.246 Test Loss: 3.854 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5536966323852539
Epoch: 60, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.855 Vali Acc: 0.245 Test Loss: 3.855 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5253043174743652
Epoch: 61, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.904 Vali Acc: 0.248 Test Loss: 3.904 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5007390975952148
Epoch: 62, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.921 Vali Acc: 0.254 Test Loss: 3.921 Test Acc: 0.254
Validation loss decreased (-0.250550 --> -0.254078).  Saving model ...
Epoch: 63 cost time: 0.5342667102813721
Epoch: 63, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.898 Vali Acc: 0.252 Test Loss: 3.898 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5800528526306152
Epoch: 64, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.884 Vali Acc: 0.253 Test Loss: 3.884 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5653388500213623
Epoch: 65, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.882 Vali Acc: 0.253 Test Loss: 3.882 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6712338924407959
Epoch: 66, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.884 Vali Acc: 0.255 Test Loss: 3.884 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255255).  Saving model ...
Epoch: 67 cost time: 0.5135784149169922
Epoch: 67, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.890 Vali Acc: 0.252 Test Loss: 3.890 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.4963390827178955
Epoch: 68, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.911 Vali Acc: 0.252 Test Loss: 3.911 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.4895145893096924
Epoch: 69, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.921 Vali Acc: 0.252 Test Loss: 3.921 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6268649101257324
Epoch: 70, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.946 Vali Acc: 0.249 Test Loss: 3.946 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5346026420593262
Epoch: 71, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.966 Vali Acc: 0.248 Test Loss: 3.966 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5587866306304932
Epoch: 72, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.984 Vali Acc: 0.247 Test Loss: 3.984 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5114459991455078
Epoch: 73, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.026 Vali Acc: 0.248 Test Loss: 4.026 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5131881237030029
Epoch: 74, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.064 Vali Acc: 0.251 Test Loss: 4.064 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.5315821170806885
Epoch: 75, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.024 Vali Acc: 0.252 Test Loss: 4.024 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.5217857360839844
Epoch: 76, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.996 Vali Acc: 0.252 Test Loss: 3.996 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 86618
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5402355194091797
Epoch: 1, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.347 Vali Acc: 0.038 Test Loss: 3.347 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.5204758644104004
Epoch: 2, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.332 Vali Acc: 0.034 Test Loss: 3.332 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5183420181274414
Epoch: 3, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.324 Vali Acc: 0.038 Test Loss: 3.324 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.5520486831665039
Epoch: 4, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.312 Vali Acc: 0.048 Test Loss: 3.312 Test Acc: 0.048
Validation loss decreased (-0.037614 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.558373212814331
Epoch: 5, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.306 Vali Acc: 0.060 Test Loss: 3.306 Test Acc: 0.060
Validation loss decreased (-0.048202 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.46270060539245605
Epoch: 6, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.299 Vali Acc: 0.069 Test Loss: 3.299 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 0.5108742713928223
Epoch: 7, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.294 Vali Acc: 0.084 Test Loss: 3.294 Test Acc: 0.084
Validation loss decreased (-0.069379 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 0.6579720973968506
Epoch: 8, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.289 Vali Acc: 0.088 Test Loss: 3.289 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 9 cost time: 0.5832960605621338
Epoch: 9, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.280 Vali Acc: 0.091 Test Loss: 3.280 Test Acc: 0.091
Validation loss decreased (-0.088202 --> -0.090555).  Saving model ...
Epoch: 10 cost time: 0.577918529510498
Epoch: 10, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.267 Vali Acc: 0.104 Test Loss: 3.267 Test Acc: 0.104
Validation loss decreased (-0.090555 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.48520445823669434
Epoch: 11, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.252 Vali Acc: 0.115 Test Loss: 3.252 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.5535786151885986
Epoch: 12, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.244 Vali Acc: 0.124 Test Loss: 3.244 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 0.5427851676940918
Epoch: 13, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.236 Vali Acc: 0.126 Test Loss: 3.236 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.516956090927124
Epoch: 14, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.231 Vali Acc: 0.146 Test Loss: 3.231 Test Acc: 0.146
Validation loss decreased (-0.125850 --> -0.145850).  Saving model ...
Epoch: 15 cost time: 0.5340220928192139
Epoch: 15, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.231 Vali Acc: 0.152 Test Loss: 3.231 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 16 cost time: 0.559668779373169
Epoch: 16, Steps: 10 | Train Loss: 1.922 Vali Loss: 3.227 Vali Acc: 0.166 Test Loss: 3.227 Test Acc: 0.166
Validation loss decreased (-0.151732 --> -0.165850).  Saving model ...
Epoch: 17 cost time: 0.48100996017456055
Epoch: 17, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.223 Vali Acc: 0.173 Test Loss: 3.223 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172909).  Saving model ...
Epoch: 18 cost time: 0.5518703460693359
Epoch: 18, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.228 Vali Acc: 0.173 Test Loss: 3.228 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46224355697631836
Epoch: 19, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.234 Vali Acc: 0.175 Test Loss: 3.234 Test Acc: 0.175
Validation loss decreased (-0.172909 --> -0.175262).  Saving model ...
Epoch: 20 cost time: 0.552901029586792
Epoch: 20, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.238 Vali Acc: 0.176 Test Loss: 3.238 Test Acc: 0.176
Validation loss decreased (-0.175262 --> -0.176438).  Saving model ...
Epoch: 21 cost time: 0.5194087028503418
Epoch: 21, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.239 Vali Acc: 0.191 Test Loss: 3.239 Test Acc: 0.191
Validation loss decreased (-0.176438 --> -0.190556).  Saving model ...
Epoch: 22 cost time: 0.5881390571594238
Epoch: 22, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.232 Vali Acc: 0.193 Test Loss: 3.232 Test Acc: 0.193
Validation loss decreased (-0.190556 --> -0.192909).  Saving model ...
Epoch: 23 cost time: 0.5620846748352051
Epoch: 23, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.252 Vali Acc: 0.191 Test Loss: 3.252 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5303013324737549
Epoch: 24, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.258 Vali Acc: 0.189 Test Loss: 3.258 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5184464454650879
Epoch: 25, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.272 Vali Acc: 0.187 Test Loss: 3.272 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.48021650314331055
Epoch: 26, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.285 Vali Acc: 0.198 Test Loss: 3.285 Test Acc: 0.198
Validation loss decreased (-0.192909 --> -0.197614).  Saving model ...
Epoch: 27 cost time: 0.566709041595459
Epoch: 27, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.296 Vali Acc: 0.209 Test Loss: 3.296 Test Acc: 0.209
Validation loss decreased (-0.197614 --> -0.209379).  Saving model ...
Epoch: 28 cost time: 0.552685022354126
Epoch: 28, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.306 Vali Acc: 0.214 Test Loss: 3.306 Test Acc: 0.214
Validation loss decreased (-0.209379 --> -0.214085).  Saving model ...
Epoch: 29 cost time: 0.5239055156707764
Epoch: 29, Steps: 10 | Train Loss: 0.772 Vali Loss: 3.324 Vali Acc: 0.216 Test Loss: 3.324 Test Acc: 0.216
Validation loss decreased (-0.214085 --> -0.216437).  Saving model ...
Epoch: 30 cost time: 0.5550909042358398
Epoch: 30, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.344 Vali Acc: 0.224 Test Loss: 3.344 Test Acc: 0.224
Validation loss decreased (-0.216437 --> -0.223496).  Saving model ...
Epoch: 31 cost time: 0.5563125610351562
Epoch: 31, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.368 Vali Acc: 0.221 Test Loss: 3.368 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.552933931350708
Epoch: 32, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.369 Vali Acc: 0.232 Test Loss: 3.369 Test Acc: 0.232
Validation loss decreased (-0.223496 --> -0.231731).  Saving model ...
Epoch: 33 cost time: 0.5410847663879395
Epoch: 33, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.407 Vali Acc: 0.240 Test Loss: 3.407 Test Acc: 0.240
Validation loss decreased (-0.231731 --> -0.239966).  Saving model ...
Epoch: 34 cost time: 0.6155900955200195
Epoch: 34, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.430 Vali Acc: 0.235 Test Loss: 3.430 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5281457901000977
Epoch: 35, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.411 Vali Acc: 0.227 Test Loss: 3.411 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5364692211151123
Epoch: 36, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.434 Vali Acc: 0.232 Test Loss: 3.434 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5393593311309814
Epoch: 37, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.478 Vali Acc: 0.241 Test Loss: 3.478 Test Acc: 0.241
Validation loss decreased (-0.239966 --> -0.241142).  Saving model ...
Epoch: 38 cost time: 0.5590701103210449
Epoch: 38, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.493 Vali Acc: 0.234 Test Loss: 3.493 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5404701232910156
Epoch: 39, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.490 Vali Acc: 0.239 Test Loss: 3.490 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.548731803894043
Epoch: 40, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.494 Vali Acc: 0.236 Test Loss: 3.494 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4573805332183838
Epoch: 41, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.525 Vali Acc: 0.232 Test Loss: 3.525 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4789299964904785
Epoch: 42, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.530 Vali Acc: 0.240 Test Loss: 3.530 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4934244155883789
Epoch: 43, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.560 Vali Acc: 0.240 Test Loss: 3.560 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.534334659576416
Epoch: 44, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.534 Vali Acc: 0.238 Test Loss: 3.534 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4893820285797119
Epoch: 45, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.548 Vali Acc: 0.244 Test Loss: 3.548 Test Acc: 0.244
Validation loss decreased (-0.241142 --> -0.243494).  Saving model ...
Epoch: 46 cost time: 0.503389835357666
Epoch: 46, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.591 Vali Acc: 0.244 Test Loss: 3.591 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5506694316864014
Epoch: 47, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.591 Vali Acc: 0.245 Test Loss: 3.591 Test Acc: 0.245
Validation loss decreased (-0.243494 --> -0.244670).  Saving model ...
Epoch: 48 cost time: 0.4952406883239746
Epoch: 48, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.600 Vali Acc: 0.248 Test Loss: 3.600 Test Acc: 0.248
Validation loss decreased (-0.244670 --> -0.248199).  Saving model ...
Epoch: 49 cost time: 0.49788999557495117
Epoch: 49, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.614 Vali Acc: 0.252 Test Loss: 3.614 Test Acc: 0.252
Validation loss decreased (-0.248199 --> -0.251729).  Saving model ...
Epoch: 50 cost time: 0.4958524703979492
Epoch: 50, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.632 Vali Acc: 0.256 Test Loss: 3.632 Test Acc: 0.256
Validation loss decreased (-0.251729 --> -0.256434).  Saving model ...
Epoch: 51 cost time: 0.5396246910095215
Epoch: 51, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.635 Vali Acc: 0.255 Test Loss: 3.635 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6380071640014648
Epoch: 52, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.618 Vali Acc: 0.260 Test Loss: 3.618 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259964).  Saving model ...
Epoch: 53 cost time: 0.5488622188568115
Epoch: 53, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.668 Vali Acc: 0.261 Test Loss: 3.668 Test Acc: 0.261
Validation loss decreased (-0.259964 --> -0.261140).  Saving model ...
Epoch: 54 cost time: 0.47455739974975586
Epoch: 54, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.694 Vali Acc: 0.261 Test Loss: 3.694 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5537471771240234
Epoch: 55, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.690 Vali Acc: 0.253 Test Loss: 3.690 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5984387397766113
Epoch: 56, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.678 Vali Acc: 0.258 Test Loss: 3.678 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.562950611114502
Epoch: 57, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.703 Vali Acc: 0.262 Test Loss: 3.703 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262316).  Saving model ...
Epoch: 58 cost time: 0.5595617294311523
Epoch: 58, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.717 Vali Acc: 0.268 Test Loss: 3.717 Test Acc: 0.268
Validation loss decreased (-0.262316 --> -0.268198).  Saving model ...
Epoch: 59 cost time: 0.5918807983398438
Epoch: 59, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.698 Vali Acc: 0.266 Test Loss: 3.698 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5357151031494141
Epoch: 60, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.705 Vali Acc: 0.267 Test Loss: 3.705 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.604346513748169
Epoch: 61, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.725 Vali Acc: 0.269 Test Loss: 3.725 Test Acc: 0.269
Validation loss decreased (-0.268198 --> -0.269375).  Saving model ...
Epoch: 62 cost time: 0.5325210094451904
Epoch: 62, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.744 Vali Acc: 0.266 Test Loss: 3.744 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5427343845367432
Epoch: 63, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.755 Vali Acc: 0.266 Test Loss: 3.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5078098773956299
Epoch: 64, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.764 Vali Acc: 0.271 Test Loss: 3.764 Test Acc: 0.271
Validation loss decreased (-0.269375 --> -0.270551).  Saving model ...
Epoch: 65 cost time: 0.5888550281524658
Epoch: 65, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.763 Vali Acc: 0.271 Test Loss: 3.763 Test Acc: 0.271
Validation loss decreased (-0.270551 --> -0.270551).  Saving model ...
Epoch: 66 cost time: 0.5526437759399414
Epoch: 66, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.772 Vali Acc: 0.272 Test Loss: 3.772 Test Acc: 0.272
Validation loss decreased (-0.270551 --> -0.271727).  Saving model ...
Epoch: 67 cost time: 0.5333981513977051
Epoch: 67, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.788 Vali Acc: 0.273 Test Loss: 3.788 Test Acc: 0.273
Validation loss decreased (-0.271727 --> -0.272903).  Saving model ...
Epoch: 68 cost time: 0.539747953414917
Epoch: 68, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.794 Vali Acc: 0.273 Test Loss: 3.794 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5297567844390869
Epoch: 69, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.805 Vali Acc: 0.282 Test Loss: 3.805 Test Acc: 0.282
Validation loss decreased (-0.272903 --> -0.282315).  Saving model ...
Epoch: 70 cost time: 0.5531752109527588
Epoch: 70, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.816 Vali Acc: 0.281 Test Loss: 3.816 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.547919511795044
Epoch: 71, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.841 Vali Acc: 0.284 Test Loss: 3.841 Test Acc: 0.284
Validation loss decreased (-0.282315 --> -0.283491).  Saving model ...
Epoch: 72 cost time: 0.6095309257507324
Epoch: 72, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.822 Vali Acc: 0.281 Test Loss: 3.822 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5063934326171875
Epoch: 73, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.835 Vali Acc: 0.284 Test Loss: 3.835 Test Acc: 0.284
Validation loss decreased (-0.283491 --> -0.283491).  Saving model ...
Epoch: 74 cost time: 0.5232837200164795
Epoch: 74, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.842 Vali Acc: 0.282 Test Loss: 3.842 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.4582076072692871
Epoch: 75, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.847 Vali Acc: 0.276 Test Loss: 3.847 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.5266168117523193
Epoch: 76, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.862 Vali Acc: 0.278 Test Loss: 3.862 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5373659133911133
Epoch: 77, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.853 Vali Acc: 0.276 Test Loss: 3.853 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.5827486515045166
Epoch: 78, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.864 Vali Acc: 0.280 Test Loss: 3.864 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.5477428436279297
Epoch: 79, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.864 Vali Acc: 0.279 Test Loss: 3.864 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.5561492443084717
Epoch: 80, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.861 Vali Acc: 0.274 Test Loss: 3.861 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.5886869430541992
Epoch: 81, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.864 Vali Acc: 0.276 Test Loss: 3.864 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.5295555591583252
Epoch: 82, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.896 Vali Acc: 0.279 Test Loss: 3.896 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5519111156463623
Epoch: 83, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.906 Vali Acc: 0.281 Test Loss: 3.906 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 84346
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7032935619354248
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.307 Vali Acc: 0.036 Test Loss: 3.307 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.558380126953125
Epoch: 2, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.334 Vali Acc: 0.051 Test Loss: 3.334 Test Acc: 0.051
Validation loss decreased (-0.036438 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.5354137420654297
Epoch: 3, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.352 Vali Acc: 0.084 Test Loss: 3.352 Test Acc: 0.084
Validation loss decreased (-0.050555 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.582273006439209
Epoch: 4, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.275 Vali Acc: 0.099 Test Loss: 3.275 Test Acc: 0.099
Validation loss decreased (-0.083496 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.5506613254547119
Epoch: 5, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.235 Vali Acc: 0.113 Test Loss: 3.235 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.5399646759033203
Epoch: 6, Steps: 10 | Train Loss: 1.972 Vali Loss: 3.203 Vali Acc: 0.149 Test Loss: 3.203 Test Acc: 0.149
Validation loss decreased (-0.112909 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 0.4949812889099121
Epoch: 7, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.259 Vali Acc: 0.173 Test Loss: 3.259 Test Acc: 0.173
Validation loss decreased (-0.149380 --> -0.172909).  Saving model ...
Epoch: 8 cost time: 0.5545053482055664
Epoch: 8, Steps: 10 | Train Loss: 1.380 Vali Loss: 3.289 Vali Acc: 0.199 Test Loss: 3.289 Test Acc: 0.199
Validation loss decreased (-0.172909 --> -0.198791).  Saving model ...
Epoch: 9 cost time: 0.5556588172912598
Epoch: 9, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.344 Vali Acc: 0.212 Test Loss: 3.344 Test Acc: 0.212
Validation loss decreased (-0.198791 --> -0.211731).  Saving model ...
Epoch: 10 cost time: 0.5127596855163574
Epoch: 10, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.422 Vali Acc: 0.211 Test Loss: 3.422 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5284843444824219
Epoch: 11, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.488 Vali Acc: 0.231 Test Loss: 3.488 Test Acc: 0.231
Validation loss decreased (-0.211731 --> -0.230553).  Saving model ...
Epoch: 12 cost time: 0.5447249412536621
Epoch: 12, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.563 Vali Acc: 0.234 Test Loss: 3.563 Test Acc: 0.234
Validation loss decreased (-0.230553 --> -0.234082).  Saving model ...
Epoch: 13 cost time: 0.5207712650299072
Epoch: 13, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.737 Vali Acc: 0.233 Test Loss: 3.737 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5880804061889648
Epoch: 14, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.728 Vali Acc: 0.256 Test Loss: 3.728 Test Acc: 0.256
Validation loss decreased (-0.234082 --> -0.256433).  Saving model ...
Epoch: 15 cost time: 0.5698428153991699
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.853 Vali Acc: 0.242 Test Loss: 3.853 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5511631965637207
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.091 Vali Acc: 0.229 Test Loss: 4.091 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.647705078125
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.024 Vali Acc: 0.247 Test Loss: 4.024 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5079360008239746
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.127 Vali Acc: 0.267 Test Loss: 4.127 Test Acc: 0.267
Validation loss decreased (-0.256433 --> -0.267018).  Saving model ...
Epoch: 19 cost time: 0.5773720741271973
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.160 Vali Acc: 0.264 Test Loss: 4.160 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5609230995178223
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.206 Vali Acc: 0.269 Test Loss: 4.206 Test Acc: 0.269
Validation loss decreased (-0.267018 --> -0.269370).  Saving model ...
Epoch: 21 cost time: 0.5368707180023193
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.250 Vali Acc: 0.269 Test Loss: 4.250 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5303564071655273
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.273 Vali Acc: 0.274 Test Loss: 4.273 Test Acc: 0.274
Validation loss decreased (-0.269370 --> -0.274075).  Saving model ...
Epoch: 23 cost time: 0.5792713165283203
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.307 Vali Acc: 0.272 Test Loss: 4.307 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5016145706176758
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.335 Vali Acc: 0.269 Test Loss: 4.335 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5556716918945312
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.368 Vali Acc: 0.268 Test Loss: 4.368 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5193603038787842
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.401 Vali Acc: 0.265 Test Loss: 4.401 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5379390716552734
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.418 Vali Acc: 0.269 Test Loss: 4.418 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4873075485229492
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.435 Vali Acc: 0.268 Test Loss: 4.435 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.546764612197876
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.442 Vali Acc: 0.271 Test Loss: 4.442 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5322003364562988
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.468 Vali Acc: 0.262 Test Loss: 4.468 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5173189640045166
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.495 Vali Acc: 0.265 Test Loss: 4.495 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5187704563140869
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.514 Vali Acc: 0.262 Test Loss: 4.514 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 228026
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3968186378479004
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.380 Vali Acc: 0.047 Test Loss: 3.380 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.5032174587249756
Epoch: 2, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.333 Vali Acc: 0.059 Test Loss: 3.333 Test Acc: 0.059
Validation loss decreased (-0.047025 --> -0.058790).  Saving model ...
Epoch: 3 cost time: 0.5418949127197266
Epoch: 3, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.350 Vali Acc: 0.047 Test Loss: 3.350 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5215873718261719
Epoch: 4, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.348 Vali Acc: 0.082 Test Loss: 3.348 Test Acc: 0.082
Validation loss decreased (-0.058790 --> -0.082319).  Saving model ...
Epoch: 5 cost time: 0.48595499992370605
Epoch: 5, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.303 Vali Acc: 0.101 Test Loss: 3.303 Test Acc: 0.101
Validation loss decreased (-0.082319 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 0.515709638595581
Epoch: 6, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.291 Vali Acc: 0.127 Test Loss: 3.291 Test Acc: 0.127
Validation loss decreased (-0.101143 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 0.5076003074645996
Epoch: 7, Steps: 10 | Train Loss: 2.270 Vali Loss: 3.282 Vali Acc: 0.141 Test Loss: 3.282 Test Acc: 0.141
Validation loss decreased (-0.127026 --> -0.141144).  Saving model ...
Epoch: 8 cost time: 0.5326070785522461
Epoch: 8, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.281 Vali Acc: 0.149 Test Loss: 3.281 Test Acc: 0.149
Validation loss decreased (-0.141144 --> -0.149379).  Saving model ...
Epoch: 9 cost time: 0.5055050849914551
Epoch: 9, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.279 Vali Acc: 0.165 Test Loss: 3.279 Test Acc: 0.165
Validation loss decreased (-0.149379 --> -0.164673).  Saving model ...
Epoch: 10 cost time: 0.5338215827941895
Epoch: 10, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.308 Vali Acc: 0.178 Test Loss: 3.308 Test Acc: 0.178
Validation loss decreased (-0.164673 --> -0.177614).  Saving model ...
Epoch: 11 cost time: 0.4893381595611572
Epoch: 11, Steps: 10 | Train Loss: 1.303 Vali Loss: 3.339 Vali Acc: 0.185 Test Loss: 3.339 Test Acc: 0.185
Validation loss decreased (-0.177614 --> -0.184672).  Saving model ...
Epoch: 12 cost time: 0.47154664993286133
Epoch: 12, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.384 Vali Acc: 0.196 Test Loss: 3.384 Test Acc: 0.196
Validation loss decreased (-0.184672 --> -0.196437).  Saving model ...
Epoch: 13 cost time: 0.5305483341217041
Epoch: 13, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.425 Vali Acc: 0.196 Test Loss: 3.425 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5182654857635498
Epoch: 14, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.470 Vali Acc: 0.204 Test Loss: 3.470 Test Acc: 0.204
Validation loss decreased (-0.196437 --> -0.203495).  Saving model ...
Epoch: 15 cost time: 0.49405717849731445
Epoch: 15, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.509 Vali Acc: 0.215 Test Loss: 3.509 Test Acc: 0.215
Validation loss decreased (-0.203495 --> -0.215259).  Saving model ...
Epoch: 16 cost time: 0.5207319259643555
Epoch: 16, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.579 Vali Acc: 0.221 Test Loss: 3.579 Test Acc: 0.221
Validation loss decreased (-0.215259 --> -0.221141).  Saving model ...
Epoch: 17 cost time: 0.5255434513092041
Epoch: 17, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.644 Vali Acc: 0.235 Test Loss: 3.644 Test Acc: 0.235
Validation loss decreased (-0.221141 --> -0.235258).  Saving model ...
Epoch: 18 cost time: 0.49529218673706055
Epoch: 18, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.690 Vali Acc: 0.236 Test Loss: 3.690 Test Acc: 0.236
Validation loss decreased (-0.235258 --> -0.236434).  Saving model ...
Epoch: 19 cost time: 0.5499541759490967
Epoch: 19, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.742 Vali Acc: 0.244 Test Loss: 3.742 Test Acc: 0.244
Validation loss decreased (-0.236434 --> -0.243492).  Saving model ...
Epoch: 20 cost time: 0.5035429000854492
Epoch: 20, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.816 Vali Acc: 0.251 Test Loss: 3.816 Test Acc: 0.251
Validation loss decreased (-0.243492 --> -0.250550).  Saving model ...
Epoch: 21 cost time: 0.5263946056365967
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.919 Vali Acc: 0.246 Test Loss: 3.919 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5160484313964844
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.957 Vali Acc: 0.249 Test Loss: 3.957 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6719973087310791
Epoch: 23, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.019 Vali Acc: 0.246 Test Loss: 4.019 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5711755752563477
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.014 Vali Acc: 0.253 Test Loss: 4.014 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252901).  Saving model ...
Epoch: 25 cost time: 0.5424902439117432
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.056 Vali Acc: 0.258 Test Loss: 4.056 Test Acc: 0.258
Validation loss decreased (-0.252901 --> -0.257606).  Saving model ...
Epoch: 26 cost time: 0.5433506965637207
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.068 Vali Acc: 0.261 Test Loss: 4.068 Test Acc: 0.261
Validation loss decreased (-0.257606 --> -0.261136).  Saving model ...
Epoch: 27 cost time: 0.5541975498199463
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.134 Vali Acc: 0.255 Test Loss: 4.134 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5271778106689453
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.154 Vali Acc: 0.258 Test Loss: 4.154 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5186350345611572
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.168 Vali Acc: 0.261 Test Loss: 4.168 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5486729145050049
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.176 Vali Acc: 0.264 Test Loss: 4.176 Test Acc: 0.264
Validation loss decreased (-0.261136 --> -0.263488).  Saving model ...
Epoch: 31 cost time: 0.5369081497192383
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.200 Vali Acc: 0.256 Test Loss: 4.200 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5348644256591797
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.271 Vali Acc: 0.253 Test Loss: 4.271 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.492171049118042
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.280 Vali Acc: 0.258 Test Loss: 4.280 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.49185943603515625
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.256 Vali Acc: 0.264 Test Loss: 4.256 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5007996559143066
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.285 Vali Acc: 0.267 Test Loss: 4.285 Test Acc: 0.267
Validation loss decreased (-0.263488 --> -0.267016).  Saving model ...
Epoch: 36 cost time: 0.5172791481018066
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.317 Vali Acc: 0.262 Test Loss: 4.317 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5478723049163818
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.363 Vali Acc: 0.262 Test Loss: 4.363 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5460038185119629
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.374 Vali Acc: 0.267 Test Loss: 4.374 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5376994609832764
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.383 Vali Acc: 0.265 Test Loss: 4.383 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5088925361633301
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.378 Vali Acc: 0.267 Test Loss: 4.378 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.48866915702819824
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.410 Vali Acc: 0.264 Test Loss: 4.410 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5418837070465088
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.427 Vali Acc: 0.267 Test Loss: 4.427 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5439503192901611
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.445 Vali Acc: 0.265 Test Loss: 4.445 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5311474800109863
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.452 Vali Acc: 0.264 Test Loss: 4.452 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5393753051757812
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.462 Vali Acc: 0.266 Test Loss: 4.462 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 133306
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6967434883117676
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.358 Vali Acc: 0.036 Test Loss: 3.358 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5084924697875977
Epoch: 2, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.330 Vali Acc: 0.041 Test Loss: 3.330 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.5568842887878418
Epoch: 3, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.324 Vali Acc: 0.067 Test Loss: 3.324 Test Acc: 0.067
Validation loss decreased (-0.041143 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.5238211154937744
Epoch: 4, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.322 Vali Acc: 0.084 Test Loss: 3.322 Test Acc: 0.084
Validation loss decreased (-0.067026 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.518805980682373
Epoch: 5, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.307 Vali Acc: 0.102 Test Loss: 3.307 Test Acc: 0.102
Validation loss decreased (-0.083496 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 0.49982404708862305
Epoch: 6, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.287 Vali Acc: 0.102 Test Loss: 3.287 Test Acc: 0.102
Validation loss decreased (-0.102320 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.524756669998169
Epoch: 7, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.266 Vali Acc: 0.114 Test Loss: 3.266 Test Acc: 0.114
Validation loss decreased (-0.102320 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.4980645179748535
Epoch: 8, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.241 Vali Acc: 0.141 Test Loss: 3.241 Test Acc: 0.141
Validation loss decreased (-0.114085 --> -0.141144).  Saving model ...
Epoch: 9 cost time: 0.5440096855163574
Epoch: 9, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.243 Vali Acc: 0.153 Test Loss: 3.243 Test Acc: 0.153
Validation loss decreased (-0.141144 --> -0.152909).  Saving model ...
Epoch: 10 cost time: 0.4803884029388428
Epoch: 10, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.223 Vali Acc: 0.161 Test Loss: 3.223 Test Acc: 0.161
Validation loss decreased (-0.152909 --> -0.161144).  Saving model ...
Epoch: 11 cost time: 0.5178523063659668
Epoch: 11, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.226 Vali Acc: 0.178 Test Loss: 3.226 Test Acc: 0.178
Validation loss decreased (-0.161144 --> -0.177615).  Saving model ...
Epoch: 12 cost time: 0.5045492649078369
Epoch: 12, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.211 Vali Acc: 0.181 Test Loss: 3.211 Test Acc: 0.181
Validation loss decreased (-0.177615 --> -0.181144).  Saving model ...
Epoch: 13 cost time: 0.5048682689666748
Epoch: 13, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.247 Vali Acc: 0.196 Test Loss: 3.247 Test Acc: 0.196
Validation loss decreased (-0.181144 --> -0.196438).  Saving model ...
Epoch: 14 cost time: 0.5371401309967041
Epoch: 14, Steps: 10 | Train Loss: 1.196 Vali Loss: 3.272 Vali Acc: 0.204 Test Loss: 3.272 Test Acc: 0.204
Validation loss decreased (-0.196438 --> -0.203497).  Saving model ...
Epoch: 15 cost time: 0.6136975288391113
Epoch: 15, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.298 Vali Acc: 0.212 Test Loss: 3.298 Test Acc: 0.212
Validation loss decreased (-0.203497 --> -0.211732).  Saving model ...
Epoch: 16 cost time: 0.5093331336975098
Epoch: 16, Steps: 10 | Train Loss: 0.942 Vali Loss: 3.313 Vali Acc: 0.227 Test Loss: 3.313 Test Acc: 0.227
Validation loss decreased (-0.211732 --> -0.227026).  Saving model ...
Epoch: 17 cost time: 0.49715733528137207
Epoch: 17, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.372 Vali Acc: 0.229 Test Loss: 3.372 Test Acc: 0.229
Validation loss decreased (-0.227026 --> -0.229378).  Saving model ...
Epoch: 18 cost time: 0.45902252197265625
Epoch: 18, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.410 Vali Acc: 0.232 Test Loss: 3.410 Test Acc: 0.232
Validation loss decreased (-0.229378 --> -0.231731).  Saving model ...
Epoch: 19 cost time: 0.512178897857666
Epoch: 19, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.470 Vali Acc: 0.242 Test Loss: 3.470 Test Acc: 0.242
Validation loss decreased (-0.231731 --> -0.242318).  Saving model ...
Epoch: 20 cost time: 0.5193929672241211
Epoch: 20, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.505 Vali Acc: 0.240 Test Loss: 3.505 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4807474613189697
Epoch: 21, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.584 Vali Acc: 0.240 Test Loss: 3.584 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5367982387542725
Epoch: 22, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.635 Vali Acc: 0.240 Test Loss: 3.635 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5267350673675537
Epoch: 23, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.671 Vali Acc: 0.240 Test Loss: 3.671 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5075302124023438
Epoch: 24, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.686 Vali Acc: 0.246 Test Loss: 3.686 Test Acc: 0.246
Validation loss decreased (-0.242318 --> -0.245845).  Saving model ...
Epoch: 25 cost time: 0.6260490417480469
Epoch: 25, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.717 Vali Acc: 0.253 Test Loss: 3.717 Test Acc: 0.253
Validation loss decreased (-0.245845 --> -0.252904).  Saving model ...
Epoch: 26 cost time: 0.5147445201873779
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.769 Vali Acc: 0.251 Test Loss: 3.769 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.541118860244751
Epoch: 27, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.835 Vali Acc: 0.244 Test Loss: 3.835 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5231959819793701
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.868 Vali Acc: 0.241 Test Loss: 3.868 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5046961307525635
Epoch: 29, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.917 Vali Acc: 0.244 Test Loss: 3.917 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5126430988311768
Epoch: 30, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.953 Vali Acc: 0.247 Test Loss: 3.953 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.566582202911377
Epoch: 31, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.958 Vali Acc: 0.241 Test Loss: 3.958 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5237233638763428
Epoch: 32, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.995 Vali Acc: 0.249 Test Loss: 3.995 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5646028518676758
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.047 Vali Acc: 0.251 Test Loss: 4.047 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.53458571434021
Epoch: 34, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.063 Vali Acc: 0.253 Test Loss: 4.063 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5362696647644043
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.087 Vali Acc: 0.249 Test Loss: 4.087 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 100986
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7881746292114258
Epoch: 1, Steps: 10 | Train Loss: 3.518 Vali Loss: 3.318 Vali Acc: 0.054 Test Loss: 3.318 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 0.5456907749176025
Epoch: 2, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.297 Vali Acc: 0.051 Test Loss: 3.297 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5680220127105713
Epoch: 3, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.288 Vali Acc: 0.062 Test Loss: 3.288 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.5877640247344971
Epoch: 4, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.288 Vali Acc: 0.079 Test Loss: 3.288 Test Acc: 0.079
Validation loss decreased (-0.062320 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.47888708114624023
Epoch: 5, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.293 Vali Acc: 0.091 Test Loss: 3.293 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090555).  Saving model ...
Epoch: 6 cost time: 0.5387685298919678
Epoch: 6, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.288 Vali Acc: 0.109 Test Loss: 3.288 Test Acc: 0.109
Validation loss decreased (-0.090555 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.49759554862976074
Epoch: 7, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.273 Vali Acc: 0.126 Test Loss: 3.273 Test Acc: 0.126
Validation loss decreased (-0.109379 --> -0.125850).  Saving model ...
Epoch: 8 cost time: 0.515312910079956
Epoch: 8, Steps: 10 | Train Loss: 2.560 Vali Loss: 3.260 Vali Acc: 0.133 Test Loss: 3.260 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.5683400630950928
Epoch: 9, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.248 Vali Acc: 0.141 Test Loss: 3.248 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 10 cost time: 0.5163614749908447
Epoch: 10, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.225 Vali Acc: 0.151 Test Loss: 3.225 Test Acc: 0.151
Validation loss decreased (-0.141144 --> -0.150556).  Saving model ...
Epoch: 11 cost time: 0.5372500419616699
Epoch: 11, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.220 Vali Acc: 0.155 Test Loss: 3.220 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 12 cost time: 0.5225224494934082
Epoch: 12, Steps: 10 | Train Loss: 1.922 Vali Loss: 3.224 Vali Acc: 0.154 Test Loss: 3.224 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4974820613861084
Epoch: 13, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.216 Vali Acc: 0.175 Test Loss: 3.216 Test Acc: 0.175
Validation loss decreased (-0.155262 --> -0.175262).  Saving model ...
Epoch: 14 cost time: 0.5588645935058594
Epoch: 14, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.226 Vali Acc: 0.192 Test Loss: 3.226 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191732).  Saving model ...
Epoch: 15 cost time: 0.4886167049407959
Epoch: 15, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.249 Vali Acc: 0.202 Test Loss: 3.249 Test Acc: 0.202
Validation loss decreased (-0.191732 --> -0.202320).  Saving model ...
Epoch: 16 cost time: 0.4826817512512207
Epoch: 16, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.267 Vali Acc: 0.205 Test Loss: 3.267 Test Acc: 0.205
Validation loss decreased (-0.202320 --> -0.204673).  Saving model ...
Epoch: 17 cost time: 0.5410540103912354
Epoch: 17, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.283 Vali Acc: 0.222 Test Loss: 3.283 Test Acc: 0.222
Validation loss decreased (-0.204673 --> -0.222320).  Saving model ...
Epoch: 18 cost time: 0.5938985347747803
Epoch: 18, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.303 Vali Acc: 0.227 Test Loss: 3.303 Test Acc: 0.227
Validation loss decreased (-0.222320 --> -0.227026).  Saving model ...
Epoch: 19 cost time: 0.5175008773803711
Epoch: 19, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.321 Vali Acc: 0.233 Test Loss: 3.321 Test Acc: 0.233
Validation loss decreased (-0.227026 --> -0.232908).  Saving model ...
Epoch: 20 cost time: 0.5375659465789795
Epoch: 20, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.362 Vali Acc: 0.245 Test Loss: 3.362 Test Acc: 0.245
Validation loss decreased (-0.232908 --> -0.244672).  Saving model ...
Epoch: 21 cost time: 0.49846363067626953
Epoch: 21, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.377 Vali Acc: 0.247 Test Loss: 3.377 Test Acc: 0.247
Validation loss decreased (-0.244672 --> -0.247025).  Saving model ...
Epoch: 22 cost time: 0.5187215805053711
Epoch: 22, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.406 Vali Acc: 0.249 Test Loss: 3.406 Test Acc: 0.249
Validation loss decreased (-0.247025 --> -0.249378).  Saving model ...
Epoch: 23 cost time: 0.5423893928527832
Epoch: 23, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.450 Vali Acc: 0.258 Test Loss: 3.450 Test Acc: 0.258
Validation loss decreased (-0.249378 --> -0.257613).  Saving model ...
Epoch: 24 cost time: 0.5223395824432373
Epoch: 24, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.506 Vali Acc: 0.259 Test Loss: 3.506 Test Acc: 0.259
Validation loss decreased (-0.257613 --> -0.258788).  Saving model ...
Epoch: 25 cost time: 0.5368325710296631
Epoch: 25, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.576 Vali Acc: 0.261 Test Loss: 3.576 Test Acc: 0.261
Validation loss decreased (-0.258788 --> -0.261141).  Saving model ...
Epoch: 26 cost time: 0.5300147533416748
Epoch: 26, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.596 Vali Acc: 0.255 Test Loss: 3.596 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5544424057006836
Epoch: 27, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.636 Vali Acc: 0.265 Test Loss: 3.636 Test Acc: 0.265
Validation loss decreased (-0.261141 --> -0.264670).  Saving model ...
Epoch: 28 cost time: 0.5453634262084961
Epoch: 28, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.693 Vali Acc: 0.254 Test Loss: 3.693 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5041384696960449
Epoch: 29, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.751 Vali Acc: 0.253 Test Loss: 3.751 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5248258113861084
Epoch: 30, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.801 Vali Acc: 0.254 Test Loss: 3.801 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5552282333374023
Epoch: 31, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.788 Vali Acc: 0.265 Test Loss: 3.788 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5501368045806885
Epoch: 32, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.812 Vali Acc: 0.264 Test Loss: 3.812 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.554668664932251
Epoch: 33, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.846 Vali Acc: 0.255 Test Loss: 3.846 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5142347812652588
Epoch: 34, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.874 Vali Acc: 0.261 Test Loss: 3.874 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5374796390533447
Epoch: 35, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.896 Vali Acc: 0.260 Test Loss: 3.896 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5146224498748779
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.956 Vali Acc: 0.262 Test Loss: 3.956 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5273096561431885
Epoch: 37, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.979 Vali Acc: 0.267 Test Loss: 3.979 Test Acc: 0.267
Validation loss decreased (-0.264670 --> -0.267019).  Saving model ...
Epoch: 38 cost time: 0.5147430896759033
Epoch: 38, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.001 Vali Acc: 0.259 Test Loss: 4.001 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5420055389404297
Epoch: 39, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.033 Vali Acc: 0.251 Test Loss: 4.033 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.49473071098327637
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.061 Vali Acc: 0.252 Test Loss: 4.061 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5260612964630127
Epoch: 41, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.105 Vali Acc: 0.258 Test Loss: 4.105 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4862806797027588
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.133 Vali Acc: 0.258 Test Loss: 4.133 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6190497875213623
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.138 Vali Acc: 0.260 Test Loss: 4.138 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5443744659423828
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.123 Vali Acc: 0.262 Test Loss: 4.123 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5536086559295654
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.127 Vali Acc: 0.256 Test Loss: 4.127 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5319485664367676
Epoch: 46, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.163 Vali Acc: 0.256 Test Loss: 4.163 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5255694389343262
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.195 Vali Acc: 0.259 Test Loss: 4.195 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 86138
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4566080570220947
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.371 Vali Acc: 0.029 Test Loss: 3.371 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.5229873657226562
Epoch: 2, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.356 Vali Acc: 0.045 Test Loss: 3.356 Test Acc: 0.045
Validation loss decreased (-0.029378 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.4996190071105957
Epoch: 3, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.342 Vali Acc: 0.047 Test Loss: 3.342 Test Acc: 0.047
Validation loss decreased (-0.044672 --> -0.047025).  Saving model ...
Epoch: 4 cost time: 0.48531556129455566
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.325 Vali Acc: 0.059 Test Loss: 3.325 Test Acc: 0.059
Validation loss decreased (-0.047025 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.5626657009124756
Epoch: 5, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.315 Vali Acc: 0.061 Test Loss: 3.315 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 0.5058143138885498
Epoch: 6, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.312 Vali Acc: 0.071 Test Loss: 3.312 Test Acc: 0.071
Validation loss decreased (-0.061143 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 0.5609142780303955
Epoch: 7, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.309 Vali Acc: 0.072 Test Loss: 3.309 Test Acc: 0.072
Validation loss decreased (-0.070555 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 0.5198702812194824
Epoch: 8, Steps: 10 | Train Loss: 2.660 Vali Loss: 3.305 Vali Acc: 0.079 Test Loss: 3.305 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078790).  Saving model ...
Epoch: 9 cost time: 0.52475905418396
Epoch: 9, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.299 Vali Acc: 0.087 Test Loss: 3.299 Test Acc: 0.087
Validation loss decreased (-0.078790 --> -0.087026).  Saving model ...
Epoch: 10 cost time: 0.5554332733154297
Epoch: 10, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.296 Vali Acc: 0.100 Test Loss: 3.296 Test Acc: 0.100
Validation loss decreased (-0.087026 --> -0.099967).  Saving model ...
Epoch: 11 cost time: 0.5683748722076416
Epoch: 11, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.288 Vali Acc: 0.104 Test Loss: 3.288 Test Acc: 0.104
Validation loss decreased (-0.099967 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.5264403820037842
Epoch: 12, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.280 Vali Acc: 0.107 Test Loss: 3.280 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.5826432704925537
Epoch: 13, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.276 Vali Acc: 0.116 Test Loss: 3.276 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116438).  Saving model ...
Epoch: 14 cost time: 0.5072648525238037
Epoch: 14, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.271 Vali Acc: 0.129 Test Loss: 3.271 Test Acc: 0.129
Validation loss decreased (-0.116438 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 0.5287857055664062
Epoch: 15, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.276 Vali Acc: 0.136 Test Loss: 3.276 Test Acc: 0.136
Validation loss decreased (-0.129379 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.5380444526672363
Epoch: 16, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.282 Vali Acc: 0.146 Test Loss: 3.282 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 17 cost time: 0.47041869163513184
Epoch: 17, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.296 Vali Acc: 0.155 Test Loss: 3.296 Test Acc: 0.155
Validation loss decreased (-0.145850 --> -0.155261).  Saving model ...
Epoch: 18 cost time: 0.49750828742980957
Epoch: 18, Steps: 10 | Train Loss: 1.442 Vali Loss: 3.307 Vali Acc: 0.166 Test Loss: 3.307 Test Acc: 0.166
Validation loss decreased (-0.155261 --> -0.165849).  Saving model ...
Epoch: 19 cost time: 0.5636227130889893
Epoch: 19, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.324 Vali Acc: 0.171 Test Loss: 3.324 Test Acc: 0.171
Validation loss decreased (-0.165849 --> -0.170555).  Saving model ...
Epoch: 20 cost time: 0.5281267166137695
Epoch: 20, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.327 Vali Acc: 0.180 Test Loss: 3.327 Test Acc: 0.180
Validation loss decreased (-0.170555 --> -0.179967).  Saving model ...
Epoch: 21 cost time: 0.45908665657043457
Epoch: 21, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.332 Vali Acc: 0.188 Test Loss: 3.332 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188202).  Saving model ...
Epoch: 22 cost time: 0.48809075355529785
Epoch: 22, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.358 Vali Acc: 0.189 Test Loss: 3.358 Test Acc: 0.189
Validation loss decreased (-0.188202 --> -0.189378).  Saving model ...
Epoch: 23 cost time: 0.5509021282196045
Epoch: 23, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.379 Vali Acc: 0.196 Test Loss: 3.379 Test Acc: 0.196
Validation loss decreased (-0.189378 --> -0.196437).  Saving model ...
Epoch: 24 cost time: 0.5387585163116455
Epoch: 24, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.394 Vali Acc: 0.198 Test Loss: 3.394 Test Acc: 0.198
Validation loss decreased (-0.196437 --> -0.197613).  Saving model ...
Epoch: 25 cost time: 0.5550422668457031
Epoch: 25, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.432 Vali Acc: 0.199 Test Loss: 3.432 Test Acc: 0.199
Validation loss decreased (-0.197613 --> -0.198789).  Saving model ...
Epoch: 26 cost time: 0.56833815574646
Epoch: 26, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.440 Vali Acc: 0.213 Test Loss: 3.440 Test Acc: 0.213
Validation loss decreased (-0.198789 --> -0.212907).  Saving model ...
Epoch: 27 cost time: 0.5126991271972656
Epoch: 27, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.461 Vali Acc: 0.215 Test Loss: 3.461 Test Acc: 0.215
Validation loss decreased (-0.212907 --> -0.215260).  Saving model ...
Epoch: 28 cost time: 0.5818853378295898
Epoch: 28, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.495 Vali Acc: 0.214 Test Loss: 3.495 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5783116817474365
Epoch: 29, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.537 Vali Acc: 0.213 Test Loss: 3.537 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.551715612411499
Epoch: 30, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.573 Vali Acc: 0.221 Test Loss: 3.573 Test Acc: 0.221
Validation loss decreased (-0.215260 --> -0.221141).  Saving model ...
Epoch: 31 cost time: 0.5383782386779785
Epoch: 31, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.618 Vali Acc: 0.221 Test Loss: 3.618 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5436971187591553
Epoch: 32, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.644 Vali Acc: 0.226 Test Loss: 3.644 Test Acc: 0.226
Validation loss decreased (-0.221141 --> -0.225846).  Saving model ...
Epoch: 33 cost time: 0.527860164642334
Epoch: 33, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.662 Vali Acc: 0.225 Test Loss: 3.662 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5292222499847412
Epoch: 34, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.677 Vali Acc: 0.231 Test Loss: 3.677 Test Acc: 0.231
Validation loss decreased (-0.225846 --> -0.230551).  Saving model ...
Epoch: 35 cost time: 0.5783300399780273
Epoch: 35, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.705 Vali Acc: 0.232 Test Loss: 3.705 Test Acc: 0.232
Validation loss decreased (-0.230551 --> -0.231728).  Saving model ...
Epoch: 36 cost time: 0.5433015823364258
Epoch: 36, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.720 Vali Acc: 0.234 Test Loss: 3.720 Test Acc: 0.234
Validation loss decreased (-0.231728 --> -0.234080).  Saving model ...
Epoch: 37 cost time: 0.522341251373291
Epoch: 37, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.765 Vali Acc: 0.233 Test Loss: 3.765 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.555466890335083
Epoch: 38, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.821 Vali Acc: 0.234 Test Loss: 3.821 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5274195671081543
Epoch: 39, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.795 Vali Acc: 0.240 Test Loss: 3.795 Test Acc: 0.240
Validation loss decreased (-0.234080 --> -0.239962).  Saving model ...
Epoch: 40 cost time: 0.5449960231781006
Epoch: 40, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.803 Vali Acc: 0.239 Test Loss: 3.803 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5385925769805908
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.803 Vali Acc: 0.241 Test Loss: 3.803 Test Acc: 0.241
Validation loss decreased (-0.239962 --> -0.241138).  Saving model ...
Epoch: 42 cost time: 0.49269890785217285
Epoch: 42, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.831 Vali Acc: 0.245 Test Loss: 3.831 Test Acc: 0.245
Validation loss decreased (-0.241138 --> -0.244668).  Saving model ...
Epoch: 43 cost time: 0.5701968669891357
Epoch: 43, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.862 Vali Acc: 0.244 Test Loss: 3.862 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5252406597137451
Epoch: 44, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.896 Vali Acc: 0.255 Test Loss: 3.896 Test Acc: 0.255
Validation loss decreased (-0.244668 --> -0.255255).  Saving model ...
Epoch: 45 cost time: 0.529533863067627
Epoch: 45, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.901 Vali Acc: 0.251 Test Loss: 3.901 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5049326419830322
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.908 Vali Acc: 0.247 Test Loss: 3.908 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5158333778381348
Epoch: 47, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.950 Vali Acc: 0.244 Test Loss: 3.950 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5112576484680176
Epoch: 48, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.955 Vali Acc: 0.240 Test Loss: 3.955 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.541318416595459
Epoch: 49, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.937 Vali Acc: 0.242 Test Loss: 3.937 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5106923580169678
Epoch: 50, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.968 Vali Acc: 0.241 Test Loss: 3.968 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5077669620513916
Epoch: 51, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.978 Vali Acc: 0.242 Test Loss: 3.978 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5890662670135498
Epoch: 52, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.004 Vali Acc: 0.245 Test Loss: 4.004 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5151171684265137
Epoch: 53, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.001 Vali Acc: 0.252 Test Loss: 4.001 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5709140300750732
Epoch: 54, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.012 Vali Acc: 0.251 Test Loss: 4.012 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 68890
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6724269390106201
Epoch: 1, Steps: 10 | Train Loss: 3.423 Vali Loss: 3.346 Vali Acc: 0.026 Test Loss: 3.346 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 0.5243434906005859
Epoch: 2, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.330 Vali Acc: 0.039 Test Loss: 3.330 Test Acc: 0.039
Validation loss decreased (-0.025849 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.5101902484893799
Epoch: 3, Steps: 10 | Train Loss: 3.239 Vali Loss: 3.317 Vali Acc: 0.041 Test Loss: 3.317 Test Acc: 0.041
Validation loss decreased (-0.038790 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.556121826171875
Epoch: 4, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.304 Vali Acc: 0.052 Test Loss: 3.304 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.5632002353668213
Epoch: 5, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.296 Vali Acc: 0.060 Test Loss: 3.296 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.5417599678039551
Epoch: 6, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.291 Vali Acc: 0.066 Test Loss: 3.291 Test Acc: 0.066
Validation loss decreased (-0.059967 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.515498161315918
Epoch: 7, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.287 Vali Acc: 0.069 Test Loss: 3.287 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 0.4870123863220215
Epoch: 8, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.284 Vali Acc: 0.074 Test Loss: 3.284 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 0.5647354125976562
Epoch: 9, Steps: 10 | Train Loss: 2.746 Vali Loss: 3.282 Vali Acc: 0.081 Test Loss: 3.282 Test Acc: 0.081
Validation loss decreased (-0.074085 --> -0.081144).  Saving model ...
Epoch: 10 cost time: 0.5182881355285645
Epoch: 10, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.278 Vali Acc: 0.081 Test Loss: 3.278 Test Acc: 0.081
Validation loss decreased (-0.081144 --> -0.081144).  Saving model ...
Epoch: 11 cost time: 0.5111618041992188
Epoch: 11, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.274 Vali Acc: 0.085 Test Loss: 3.274 Test Acc: 0.085
Validation loss decreased (-0.081144 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 0.5448219776153564
Epoch: 12, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.268 Vali Acc: 0.096 Test Loss: 3.268 Test Acc: 0.096
Validation loss decreased (-0.084673 --> -0.096438).  Saving model ...
Epoch: 13 cost time: 0.4798712730407715
Epoch: 13, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.252 Vali Acc: 0.114 Test Loss: 3.252 Test Acc: 0.114
Validation loss decreased (-0.096438 --> -0.114085).  Saving model ...
Epoch: 14 cost time: 0.5431997776031494
Epoch: 14, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.255 Vali Acc: 0.118 Test Loss: 3.255 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117615).  Saving model ...
Epoch: 15 cost time: 0.5088913440704346
Epoch: 15, Steps: 10 | Train Loss: 2.061 Vali Loss: 3.255 Vali Acc: 0.122 Test Loss: 3.255 Test Acc: 0.122
Validation loss decreased (-0.117615 --> -0.122320).  Saving model ...
Epoch: 16 cost time: 0.48120903968811035
Epoch: 16, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.254 Vali Acc: 0.125 Test Loss: 3.254 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 17 cost time: 0.5670468807220459
Epoch: 17, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.260 Vali Acc: 0.128 Test Loss: 3.260 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 0.5267071723937988
Epoch: 18, Steps: 10 | Train Loss: 1.738 Vali Loss: 3.258 Vali Acc: 0.136 Test Loss: 3.258 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 0.562544584274292
Epoch: 19, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.253 Vali Acc: 0.146 Test Loss: 3.253 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 20 cost time: 0.5028810501098633
Epoch: 20, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.272 Vali Acc: 0.155 Test Loss: 3.272 Test Acc: 0.155
Validation loss decreased (-0.145850 --> -0.155261).  Saving model ...
Epoch: 21 cost time: 0.558119535446167
Epoch: 21, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.280 Vali Acc: 0.162 Test Loss: 3.280 Test Acc: 0.162
Validation loss decreased (-0.155261 --> -0.162320).  Saving model ...
Epoch: 22 cost time: 0.5175225734710693
Epoch: 22, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.277 Vali Acc: 0.162 Test Loss: 3.277 Test Acc: 0.162
Validation loss decreased (-0.162320 --> -0.162320).  Saving model ...
Epoch: 23 cost time: 0.5274801254272461
Epoch: 23, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.296 Vali Acc: 0.167 Test Loss: 3.296 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167026).  Saving model ...
Epoch: 24 cost time: 0.48602914810180664
Epoch: 24, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.312 Vali Acc: 0.173 Test Loss: 3.312 Test Acc: 0.173
Validation loss decreased (-0.167026 --> -0.172908).  Saving model ...
Epoch: 25 cost time: 0.5173375606536865
Epoch: 25, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.339 Vali Acc: 0.174 Test Loss: 3.339 Test Acc: 0.174
Validation loss decreased (-0.172908 --> -0.174084).  Saving model ...
Epoch: 26 cost time: 0.4986238479614258
Epoch: 26, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.370 Vali Acc: 0.173 Test Loss: 3.370 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.48415040969848633
Epoch: 27, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.379 Vali Acc: 0.189 Test Loss: 3.379 Test Acc: 0.189
Validation loss decreased (-0.174084 --> -0.189378).  Saving model ...
Epoch: 28 cost time: 0.5259804725646973
Epoch: 28, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.390 Vali Acc: 0.200 Test Loss: 3.390 Test Acc: 0.200
Validation loss decreased (-0.189378 --> -0.199966).  Saving model ...
Epoch: 29 cost time: 0.5177981853485107
Epoch: 29, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.411 Vali Acc: 0.201 Test Loss: 3.411 Test Acc: 0.201
Validation loss decreased (-0.199966 --> -0.201142).  Saving model ...
Epoch: 30 cost time: 0.49485206604003906
Epoch: 30, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.437 Vali Acc: 0.196 Test Loss: 3.437 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5574965476989746
Epoch: 31, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.464 Vali Acc: 0.206 Test Loss: 3.464 Test Acc: 0.206
Validation loss decreased (-0.201142 --> -0.205848).  Saving model ...
Epoch: 32 cost time: 0.5217392444610596
Epoch: 32, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.485 Vali Acc: 0.209 Test Loss: 3.485 Test Acc: 0.209
Validation loss decreased (-0.205848 --> -0.209377).  Saving model ...
Epoch: 33 cost time: 0.5029568672180176
Epoch: 33, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.522 Vali Acc: 0.208 Test Loss: 3.522 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5703911781311035
Epoch: 34, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.532 Vali Acc: 0.218 Test Loss: 3.532 Test Acc: 0.218
Validation loss decreased (-0.209377 --> -0.217612).  Saving model ...
Epoch: 35 cost time: 0.4982447624206543
Epoch: 35, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.561 Vali Acc: 0.226 Test Loss: 3.561 Test Acc: 0.226
Validation loss decreased (-0.217612 --> -0.225847).  Saving model ...
Epoch: 36 cost time: 0.5094025135040283
Epoch: 36, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.564 Vali Acc: 0.228 Test Loss: 3.564 Test Acc: 0.228
Validation loss decreased (-0.225847 --> -0.228200).  Saving model ...
Epoch: 37 cost time: 0.5608458518981934
Epoch: 37, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.606 Vali Acc: 0.227 Test Loss: 3.606 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5196514129638672
Epoch: 38, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.649 Vali Acc: 0.233 Test Loss: 3.649 Test Acc: 0.233
Validation loss decreased (-0.228200 --> -0.232905).  Saving model ...
Epoch: 39 cost time: 0.5148448944091797
Epoch: 39, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.669 Vali Acc: 0.239 Test Loss: 3.669 Test Acc: 0.239
Validation loss decreased (-0.232905 --> -0.238787).  Saving model ...
Epoch: 40 cost time: 0.4987480640411377
Epoch: 40, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.674 Vali Acc: 0.234 Test Loss: 3.674 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5377209186553955
Epoch: 41, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.679 Vali Acc: 0.232 Test Loss: 3.679 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4879748821258545
Epoch: 42, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.720 Vali Acc: 0.234 Test Loss: 3.720 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5237269401550293
Epoch: 43, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.720 Vali Acc: 0.232 Test Loss: 3.720 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5461347103118896
Epoch: 44, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.745 Vali Acc: 0.235 Test Loss: 3.745 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.48862147331237793
Epoch: 45, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.780 Vali Acc: 0.240 Test Loss: 3.780 Test Acc: 0.240
Validation loss decreased (-0.238787 --> -0.239962).  Saving model ...
Epoch: 46 cost time: 0.479982852935791
Epoch: 46, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.800 Vali Acc: 0.239 Test Loss: 3.800 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5143001079559326
Epoch: 47, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.822 Vali Acc: 0.245 Test Loss: 3.822 Test Acc: 0.245
Validation loss decreased (-0.239962 --> -0.244668).  Saving model ...
Epoch: 48 cost time: 0.5121023654937744
Epoch: 48, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.839 Vali Acc: 0.247 Test Loss: 3.839 Test Acc: 0.247
Validation loss decreased (-0.244668 --> -0.247020).  Saving model ...
Epoch: 49 cost time: 0.5183389186859131
Epoch: 49, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.861 Vali Acc: 0.245 Test Loss: 3.861 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5461864471435547
Epoch: 50, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.858 Vali Acc: 0.248 Test Loss: 3.858 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248197).  Saving model ...
Epoch: 51 cost time: 0.5164611339569092
Epoch: 51, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.878 Vali Acc: 0.246 Test Loss: 3.878 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4727778434753418
Epoch: 52, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.895 Vali Acc: 0.252 Test Loss: 3.895 Test Acc: 0.252
Validation loss decreased (-0.248197 --> -0.251726).  Saving model ...
Epoch: 53 cost time: 0.5150296688079834
Epoch: 53, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.912 Vali Acc: 0.251 Test Loss: 3.912 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5349512100219727
Epoch: 54, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.908 Vali Acc: 0.248 Test Loss: 3.908 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5903763771057129
Epoch: 55, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.932 Vali Acc: 0.244 Test Loss: 3.932 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5288369655609131
Epoch: 56, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.945 Vali Acc: 0.251 Test Loss: 3.945 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5849025249481201
Epoch: 57, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.949 Vali Acc: 0.252 Test Loss: 3.949 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5594563484191895
Epoch: 58, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.972 Vali Acc: 0.247 Test Loss: 3.972 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.569359302520752
Epoch: 59, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.993 Vali Acc: 0.245 Test Loss: 3.993 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.54189133644104
Epoch: 60, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.997 Vali Acc: 0.249 Test Loss: 3.997 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5588831901550293
Epoch: 61, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.998 Vali Acc: 0.253 Test Loss: 3.998 Test Acc: 0.253
Validation loss decreased (-0.251726 --> -0.252901).  Saving model ...
Epoch: 62 cost time: 0.5115547180175781
Epoch: 62, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.020 Vali Acc: 0.249 Test Loss: 4.020 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.536564826965332
Epoch: 63, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.022 Vali Acc: 0.249 Test Loss: 4.022 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5193798542022705
Epoch: 64, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.025 Vali Acc: 0.254 Test Loss: 4.025 Test Acc: 0.254
Validation loss decreased (-0.252901 --> -0.254077).  Saving model ...
Epoch: 65 cost time: 0.5306980609893799
Epoch: 65, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.060 Vali Acc: 0.253 Test Loss: 4.060 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.48743367195129395
Epoch: 66, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.080 Vali Acc: 0.248 Test Loss: 4.080 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5594496726989746
Epoch: 67, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.095 Vali Acc: 0.247 Test Loss: 4.095 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5553553104400635
Epoch: 68, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.100 Vali Acc: 0.248 Test Loss: 4.100 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.5425894260406494
Epoch: 69, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.096 Vali Acc: 0.251 Test Loss: 4.096 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.5516979694366455
Epoch: 70, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.088 Vali Acc: 0.252 Test Loss: 4.088 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5069890022277832
Epoch: 71, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.092 Vali Acc: 0.251 Test Loss: 4.092 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.4922809600830078
Epoch: 72, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.117 Vali Acc: 0.248 Test Loss: 4.117 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.5356972217559814
Epoch: 73, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.131 Vali Acc: 0.248 Test Loss: 4.131 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.5405619144439697
Epoch: 74, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.136 Vali Acc: 0.253 Test Loss: 4.136 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 61658
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6322135925292969
Epoch: 1, Steps: 10 | Train Loss: 3.470 Vali Loss: 3.401 Vali Acc: 0.033 Test Loss: 3.401 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 0.47730422019958496
Epoch: 2, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.388 Vali Acc: 0.025 Test Loss: 3.388 Test Acc: 0.025
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49505162239074707
Epoch: 3, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.372 Vali Acc: 0.019 Test Loss: 3.372 Test Acc: 0.019
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44161486625671387
Epoch: 4, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.356 Vali Acc: 0.027 Test Loss: 3.356 Test Acc: 0.027
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5118823051452637
Epoch: 5, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.340 Vali Acc: 0.039 Test Loss: 3.340 Test Acc: 0.039
Validation loss decreased (-0.032907 --> -0.038790).  Saving model ...
Epoch: 6 cost time: 0.5302548408508301
Epoch: 6, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.330 Vali Acc: 0.054 Test Loss: 3.330 Test Acc: 0.054
Validation loss decreased (-0.038790 --> -0.054084).  Saving model ...
Epoch: 7 cost time: 0.5347716808319092
Epoch: 7, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.321 Vali Acc: 0.067 Test Loss: 3.321 Test Acc: 0.067
Validation loss decreased (-0.054084 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 0.5368537902832031
Epoch: 8, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.316 Vali Acc: 0.071 Test Loss: 3.316 Test Acc: 0.071
Validation loss decreased (-0.067026 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 0.5131280422210693
Epoch: 9, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.308 Vali Acc: 0.082 Test Loss: 3.308 Test Acc: 0.082
Validation loss decreased (-0.070555 --> -0.082320).  Saving model ...
Epoch: 10 cost time: 0.5188577175140381
Epoch: 10, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.297 Vali Acc: 0.084 Test Loss: 3.297 Test Acc: 0.084
Validation loss decreased (-0.082320 --> -0.083496).  Saving model ...
Epoch: 11 cost time: 0.4739983081817627
Epoch: 11, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.293 Vali Acc: 0.091 Test Loss: 3.293 Test Acc: 0.091
Validation loss decreased (-0.083496 --> -0.090555).  Saving model ...
Epoch: 12 cost time: 0.5187571048736572
Epoch: 12, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.288 Vali Acc: 0.094 Test Loss: 3.288 Test Acc: 0.094
Validation loss decreased (-0.090555 --> -0.094085).  Saving model ...
Epoch: 13 cost time: 0.4792671203613281
Epoch: 13, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.283 Vali Acc: 0.102 Test Loss: 3.283 Test Acc: 0.102
Validation loss decreased (-0.094085 --> -0.102320).  Saving model ...
Epoch: 14 cost time: 0.5129969120025635
Epoch: 14, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.283 Vali Acc: 0.112 Test Loss: 3.283 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 15 cost time: 0.5033423900604248
Epoch: 15, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.282 Vali Acc: 0.122 Test Loss: 3.282 Test Acc: 0.122
Validation loss decreased (-0.111732 --> -0.122320).  Saving model ...
Epoch: 16 cost time: 0.5601406097412109
Epoch: 16, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.289 Vali Acc: 0.126 Test Loss: 3.289 Test Acc: 0.126
Validation loss decreased (-0.122320 --> -0.125849).  Saving model ...
Epoch: 17 cost time: 0.5115513801574707
Epoch: 17, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.287 Vali Acc: 0.133 Test Loss: 3.287 Test Acc: 0.133
Validation loss decreased (-0.125849 --> -0.132908).  Saving model ...
Epoch: 18 cost time: 0.4738197326660156
Epoch: 18, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.289 Vali Acc: 0.139 Test Loss: 3.289 Test Acc: 0.139
Validation loss decreased (-0.132908 --> -0.138791).  Saving model ...
Epoch: 19 cost time: 0.4573187828063965
Epoch: 19, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.296 Vali Acc: 0.151 Test Loss: 3.296 Test Acc: 0.151
Validation loss decreased (-0.138791 --> -0.150555).  Saving model ...
Epoch: 20 cost time: 0.4837071895599365
Epoch: 20, Steps: 10 | Train Loss: 1.656 Vali Loss: 3.306 Vali Acc: 0.153 Test Loss: 3.306 Test Acc: 0.153
Validation loss decreased (-0.150555 --> -0.152908).  Saving model ...
Epoch: 21 cost time: 0.4801907539367676
Epoch: 21, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.308 Vali Acc: 0.167 Test Loss: 3.308 Test Acc: 0.167
Validation loss decreased (-0.152908 --> -0.167026).  Saving model ...
Epoch: 22 cost time: 0.49128293991088867
Epoch: 22, Steps: 10 | Train Loss: 1.543 Vali Loss: 3.313 Vali Acc: 0.169 Test Loss: 3.313 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 23 cost time: 0.49805712699890137
Epoch: 23, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.322 Vali Acc: 0.179 Test Loss: 3.322 Test Acc: 0.179
Validation loss decreased (-0.169379 --> -0.178790).  Saving model ...
Epoch: 24 cost time: 0.4085686206817627
Epoch: 24, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.342 Vali Acc: 0.181 Test Loss: 3.342 Test Acc: 0.181
Validation loss decreased (-0.178790 --> -0.181143).  Saving model ...
Epoch: 25 cost time: 0.5593283176422119
Epoch: 25, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.345 Vali Acc: 0.184 Test Loss: 3.345 Test Acc: 0.184
Validation loss decreased (-0.181143 --> -0.183496).  Saving model ...
Epoch: 26 cost time: 0.48015809059143066
Epoch: 26, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.361 Vali Acc: 0.184 Test Loss: 3.361 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5461688041687012
Epoch: 27, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.392 Vali Acc: 0.189 Test Loss: 3.392 Test Acc: 0.189
Validation loss decreased (-0.183496 --> -0.189378).  Saving model ...
Epoch: 28 cost time: 0.5116207599639893
Epoch: 28, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.416 Vali Acc: 0.187 Test Loss: 3.416 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5425965785980225
Epoch: 29, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.435 Vali Acc: 0.191 Test Loss: 3.435 Test Acc: 0.191
Validation loss decreased (-0.189378 --> -0.190554).  Saving model ...
Epoch: 30 cost time: 0.539191722869873
Epoch: 30, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.454 Vali Acc: 0.199 Test Loss: 3.454 Test Acc: 0.199
Validation loss decreased (-0.190554 --> -0.198789).  Saving model ...
Epoch: 31 cost time: 0.5582234859466553
Epoch: 31, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.488 Vali Acc: 0.202 Test Loss: 3.488 Test Acc: 0.202
Validation loss decreased (-0.198789 --> -0.202318).  Saving model ...
Epoch: 32 cost time: 0.5579833984375
Epoch: 32, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.514 Vali Acc: 0.207 Test Loss: 3.514 Test Acc: 0.207
Validation loss decreased (-0.202318 --> -0.207024).  Saving model ...
Epoch: 33 cost time: 0.6068522930145264
Epoch: 33, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.543 Vali Acc: 0.209 Test Loss: 3.543 Test Acc: 0.209
Validation loss decreased (-0.207024 --> -0.209376).  Saving model ...
Epoch: 34 cost time: 0.5624005794525146
Epoch: 34, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.557 Vali Acc: 0.212 Test Loss: 3.557 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211729).  Saving model ...
Epoch: 35 cost time: 0.5596315860748291
Epoch: 35, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.581 Vali Acc: 0.213 Test Loss: 3.581 Test Acc: 0.213
Validation loss decreased (-0.211729 --> -0.212905).  Saving model ...
Epoch: 36 cost time: 0.5167808532714844
Epoch: 36, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.600 Vali Acc: 0.213 Test Loss: 3.600 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5526533126831055
Epoch: 37, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.608 Vali Acc: 0.220 Test Loss: 3.608 Test Acc: 0.220
Validation loss decreased (-0.212905 --> -0.219964).  Saving model ...
Epoch: 38 cost time: 0.5288553237915039
Epoch: 38, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.623 Vali Acc: 0.218 Test Loss: 3.623 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5091128349304199
Epoch: 39, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.678 Vali Acc: 0.215 Test Loss: 3.678 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5041003227233887
Epoch: 40, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.708 Vali Acc: 0.216 Test Loss: 3.708 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5097415447235107
Epoch: 41, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.732 Vali Acc: 0.220 Test Loss: 3.732 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5317740440368652
Epoch: 42, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.722 Vali Acc: 0.221 Test Loss: 3.722 Test Acc: 0.221
Validation loss decreased (-0.219964 --> -0.221139).  Saving model ...
Epoch: 43 cost time: 0.5300962924957275
Epoch: 43, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.766 Vali Acc: 0.222 Test Loss: 3.766 Test Acc: 0.222
Validation loss decreased (-0.221139 --> -0.222315).  Saving model ...
Epoch: 44 cost time: 0.4934251308441162
Epoch: 44, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.815 Vali Acc: 0.224 Test Loss: 3.815 Test Acc: 0.224
Validation loss decreased (-0.222315 --> -0.223491).  Saving model ...
Epoch: 45 cost time: 0.4864013195037842
Epoch: 45, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.813 Vali Acc: 0.222 Test Loss: 3.813 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5676424503326416
Epoch: 46, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.856 Vali Acc: 0.231 Test Loss: 3.856 Test Acc: 0.231
Validation loss decreased (-0.223491 --> -0.230550).  Saving model ...
Epoch: 47 cost time: 0.5481579303741455
Epoch: 47, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.864 Vali Acc: 0.232 Test Loss: 3.864 Test Acc: 0.232
Validation loss decreased (-0.230550 --> -0.231726).  Saving model ...
Epoch: 48 cost time: 0.5135231018066406
Epoch: 48, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.882 Vali Acc: 0.231 Test Loss: 3.882 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5235130786895752
Epoch: 49, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.867 Vali Acc: 0.231 Test Loss: 3.867 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6004190444946289
Epoch: 50, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.884 Vali Acc: 0.233 Test Loss: 3.884 Test Acc: 0.233
Validation loss decreased (-0.231726 --> -0.232902).  Saving model ...
Epoch: 51 cost time: 0.5800178050994873
Epoch: 51, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.906 Vali Acc: 0.233 Test Loss: 3.906 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6550686359405518
Epoch: 52, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.922 Vali Acc: 0.228 Test Loss: 3.922 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6163604259490967
Epoch: 53, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.911 Vali Acc: 0.234 Test Loss: 3.911 Test Acc: 0.234
Validation loss decreased (-0.232902 --> -0.234079).  Saving model ...
Epoch: 54 cost time: 0.46718811988830566
Epoch: 54, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.947 Vali Acc: 0.233 Test Loss: 3.947 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5198624134063721
Epoch: 55, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.971 Vali Acc: 0.234 Test Loss: 3.971 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5447549819946289
Epoch: 56, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.984 Vali Acc: 0.235 Test Loss: 3.984 Test Acc: 0.235
Validation loss decreased (-0.234079 --> -0.235254).  Saving model ...
Epoch: 57 cost time: 0.47933292388916016
Epoch: 57, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.007 Vali Acc: 0.233 Test Loss: 4.007 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.4943976402282715
Epoch: 58, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.021 Vali Acc: 0.236 Test Loss: 4.021 Test Acc: 0.236
Validation loss decreased (-0.235254 --> -0.236430).  Saving model ...
Epoch: 59 cost time: 0.49068760871887207
Epoch: 59, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.049 Vali Acc: 0.242 Test Loss: 4.049 Test Acc: 0.242
Validation loss decreased (-0.236430 --> -0.242312).  Saving model ...
Epoch: 60 cost time: 0.5496807098388672
Epoch: 60, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.053 Vali Acc: 0.241 Test Loss: 4.053 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5097427368164062
Epoch: 61, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.045 Vali Acc: 0.244 Test Loss: 4.045 Test Acc: 0.244
Validation loss decreased (-0.242312 --> -0.243489).  Saving model ...
Epoch: 62 cost time: 0.49898338317871094
Epoch: 62, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.065 Vali Acc: 0.246 Test Loss: 4.065 Test Acc: 0.246
Validation loss decreased (-0.243489 --> -0.245842).  Saving model ...
Epoch: 63 cost time: 0.5130026340484619
Epoch: 63, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.092 Vali Acc: 0.246 Test Loss: 4.092 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.529259443283081
Epoch: 64, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.091 Vali Acc: 0.249 Test Loss: 4.091 Test Acc: 0.249
Validation loss decreased (-0.245842 --> -0.249371).  Saving model ...
Epoch: 65 cost time: 0.5057547092437744
Epoch: 65, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.099 Vali Acc: 0.246 Test Loss: 4.099 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5714719295501709
Epoch: 66, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.118 Vali Acc: 0.247 Test Loss: 4.118 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5852556228637695
Epoch: 67, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.156 Vali Acc: 0.245 Test Loss: 4.156 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5609333515167236
Epoch: 68, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.157 Vali Acc: 0.244 Test Loss: 4.157 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.5964028835296631
Epoch: 69, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.171 Vali Acc: 0.256 Test Loss: 4.171 Test Acc: 0.256
Validation loss decreased (-0.249371 --> -0.256429).  Saving model ...
Epoch: 70 cost time: 0.5441222190856934
Epoch: 70, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.174 Vali Acc: 0.256 Test Loss: 4.174 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5550808906555176
Epoch: 71, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.187 Vali Acc: 0.249 Test Loss: 4.187 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5516843795776367
Epoch: 72, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.177 Vali Acc: 0.245 Test Loss: 4.177 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5535116195678711
Epoch: 73, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.204 Vali Acc: 0.245 Test Loss: 4.204 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5150017738342285
Epoch: 74, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.236 Vali Acc: 0.252 Test Loss: 4.236 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.567983865737915
Epoch: 75, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.253 Vali Acc: 0.248 Test Loss: 4.253 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.54685378074646
Epoch: 76, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.265 Vali Acc: 0.248 Test Loss: 4.265 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.5681617259979248
Epoch: 77, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.269 Vali Acc: 0.249 Test Loss: 4.269 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.5641214847564697
Epoch: 78, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.269 Vali Acc: 0.252 Test Loss: 4.269 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.5329117774963379
Epoch: 79, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.264 Vali Acc: 0.252 Test Loss: 4.264 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 59386
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4764621257781982
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.369 Vali Acc: 0.033 Test Loss: 3.369 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 0.41208505630493164
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.394 Vali Acc: 0.054 Test Loss: 3.394 Test Acc: 0.054
Validation loss decreased (-0.032907 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.488767147064209
Epoch: 3, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.389 Vali Acc: 0.087 Test Loss: 3.389 Test Acc: 0.087
Validation loss decreased (-0.054084 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 0.4969348907470703
Epoch: 4, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.349 Vali Acc: 0.099 Test Loss: 3.349 Test Acc: 0.099
Validation loss decreased (-0.087025 --> -0.098790).  Saving model ...
Epoch: 5 cost time: 0.5043706893920898
Epoch: 5, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.260 Vali Acc: 0.140 Test Loss: 3.260 Test Acc: 0.140
Validation loss decreased (-0.098790 --> -0.139967).  Saving model ...
Epoch: 6 cost time: 0.4642364978790283
Epoch: 6, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.273 Vali Acc: 0.155 Test Loss: 3.273 Test Acc: 0.155
Validation loss decreased (-0.139967 --> -0.155261).  Saving model ...
Epoch: 7 cost time: 0.5025286674499512
Epoch: 7, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.285 Vali Acc: 0.176 Test Loss: 3.285 Test Acc: 0.176
Validation loss decreased (-0.155261 --> -0.176438).  Saving model ...
Epoch: 8 cost time: 0.5062224864959717
Epoch: 8, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.326 Vali Acc: 0.193 Test Loss: 3.326 Test Acc: 0.193
Validation loss decreased (-0.176438 --> -0.192908).  Saving model ...
Epoch: 9 cost time: 0.4850897789001465
Epoch: 9, Steps: 10 | Train Loss: 1.015 Vali Loss: 3.377 Vali Acc: 0.215 Test Loss: 3.377 Test Acc: 0.215
Validation loss decreased (-0.192908 --> -0.215260).  Saving model ...
Epoch: 10 cost time: 0.4473392963409424
Epoch: 10, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.411 Vali Acc: 0.239 Test Loss: 3.411 Test Acc: 0.239
Validation loss decreased (-0.215260 --> -0.238789).  Saving model ...
Epoch: 11 cost time: 0.4870476722717285
Epoch: 11, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.535 Vali Acc: 0.228 Test Loss: 3.535 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45430660247802734
Epoch: 12, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.609 Vali Acc: 0.241 Test Loss: 3.609 Test Acc: 0.241
Validation loss decreased (-0.238789 --> -0.241140).  Saving model ...
Epoch: 13 cost time: 0.48950958251953125
Epoch: 13, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.673 Vali Acc: 0.252 Test Loss: 3.673 Test Acc: 0.252
Validation loss decreased (-0.241140 --> -0.251728).  Saving model ...
Epoch: 14 cost time: 0.471327543258667
Epoch: 14, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.876 Vali Acc: 0.245 Test Loss: 3.876 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.44833850860595703
Epoch: 15, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.923 Vali Acc: 0.272 Test Loss: 3.923 Test Acc: 0.272
Validation loss decreased (-0.251728 --> -0.271725).  Saving model ...
Epoch: 16 cost time: 0.4989159107208252
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.929 Vali Acc: 0.262 Test Loss: 3.929 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5050272941589355
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.079 Vali Acc: 0.259 Test Loss: 4.079 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5165228843688965
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.189 Vali Acc: 0.265 Test Loss: 4.189 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5132362842559814
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.215 Vali Acc: 0.268 Test Loss: 4.215 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.41569995880126953
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.278 Vali Acc: 0.274 Test Loss: 4.278 Test Acc: 0.274
Validation loss decreased (-0.271725 --> -0.274075).  Saving model ...
Epoch: 21 cost time: 0.4917159080505371
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.335 Vali Acc: 0.269 Test Loss: 4.335 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.486814022064209
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.374 Vali Acc: 0.271 Test Loss: 4.374 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5040583610534668
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.399 Vali Acc: 0.268 Test Loss: 4.399 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5065062046051025
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.443 Vali Acc: 0.268 Test Loss: 4.443 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.42916011810302734
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.465 Vali Acc: 0.269 Test Loss: 4.465 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5097241401672363
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.470 Vali Acc: 0.271 Test Loss: 4.470 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5125007629394531
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.469 Vali Acc: 0.275 Test Loss: 4.469 Test Acc: 0.275
Validation loss decreased (-0.274075 --> -0.275249).  Saving model ...
Epoch: 28 cost time: 0.5408957004547119
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.493 Vali Acc: 0.268 Test Loss: 4.493 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45913100242614746
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.515 Vali Acc: 0.278 Test Loss: 4.515 Test Acc: 0.278
Validation loss decreased (-0.275249 --> -0.277602).  Saving model ...
Epoch: 30 cost time: 0.5072858333587646
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.538 Vali Acc: 0.281 Test Loss: 4.538 Test Acc: 0.281
Validation loss decreased (-0.277602 --> -0.281131).  Saving model ...
Epoch: 31 cost time: 0.4514150619506836
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.557 Vali Acc: 0.279 Test Loss: 4.557 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4685969352722168
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.531 Vali Acc: 0.284 Test Loss: 4.531 Test Acc: 0.284
Validation loss decreased (-0.281131 --> -0.283484).  Saving model ...
Epoch: 33 cost time: 0.4892432689666748
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.560 Vali Acc: 0.282 Test Loss: 4.560 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.45426416397094727
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.608 Vali Acc: 0.278 Test Loss: 4.608 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.49568629264831543
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.640 Vali Acc: 0.274 Test Loss: 4.640 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.46157169342041016
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.655 Vali Acc: 0.276 Test Loss: 4.655 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5068261623382568
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.654 Vali Acc: 0.279 Test Loss: 4.654 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4913344383239746
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.660 Vali Acc: 0.280 Test Loss: 4.660 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5005390644073486
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.683 Vali Acc: 0.282 Test Loss: 4.683 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.45568418502807617
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.696 Vali Acc: 0.281 Test Loss: 4.696 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4980654716491699
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.706 Vali Acc: 0.274 Test Loss: 4.706 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4971275329589844
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.736 Vali Acc: 0.279 Test Loss: 4.736 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 215546
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4736638069152832
Epoch: 1, Steps: 10 | Train Loss: 3.490 Vali Loss: 3.370 Vali Acc: 0.052 Test Loss: 3.370 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.5495810508728027
Epoch: 2, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.314 Vali Acc: 0.064 Test Loss: 3.314 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.5339319705963135
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.325 Vali Acc: 0.064 Test Loss: 3.325 Test Acc: 0.064
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5119540691375732
Epoch: 4, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.336 Vali Acc: 0.076 Test Loss: 3.336 Test Acc: 0.076
Validation loss decreased (-0.063496 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.4999845027923584
Epoch: 5, Steps: 10 | Train Loss: 2.755 Vali Loss: 3.325 Vali Acc: 0.107 Test Loss: 3.325 Test Acc: 0.107
Validation loss decreased (-0.076437 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 0.52449631690979
Epoch: 6, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.293 Vali Acc: 0.127 Test Loss: 3.293 Test Acc: 0.127
Validation loss decreased (-0.107026 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 0.5277485847473145
Epoch: 7, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.257 Vali Acc: 0.145 Test Loss: 3.257 Test Acc: 0.145
Validation loss decreased (-0.127026 --> -0.144673).  Saving model ...
Epoch: 8 cost time: 0.5300858020782471
Epoch: 8, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.233 Vali Acc: 0.164 Test Loss: 3.233 Test Acc: 0.164
Validation loss decreased (-0.144673 --> -0.163497).  Saving model ...
Epoch: 9 cost time: 0.47771263122558594
Epoch: 9, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.248 Vali Acc: 0.171 Test Loss: 3.248 Test Acc: 0.171
Validation loss decreased (-0.163497 --> -0.170556).  Saving model ...
Epoch: 10 cost time: 0.49605560302734375
Epoch: 10, Steps: 10 | Train Loss: 1.671 Vali Loss: 3.255 Vali Acc: 0.192 Test Loss: 3.255 Test Acc: 0.192
Validation loss decreased (-0.170556 --> -0.191732).  Saving model ...
Epoch: 11 cost time: 0.5325453281402588
Epoch: 11, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.285 Vali Acc: 0.200 Test Loss: 3.285 Test Acc: 0.200
Validation loss decreased (-0.191732 --> -0.199967).  Saving model ...
Epoch: 12 cost time: 0.5057408809661865
Epoch: 12, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.321 Vali Acc: 0.207 Test Loss: 3.321 Test Acc: 0.207
Validation loss decreased (-0.199967 --> -0.207026).  Saving model ...
Epoch: 13 cost time: 0.5360212326049805
Epoch: 13, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.348 Vali Acc: 0.228 Test Loss: 3.348 Test Acc: 0.228
Validation loss decreased (-0.207026 --> -0.228202).  Saving model ...
Epoch: 14 cost time: 0.5185885429382324
Epoch: 14, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.376 Vali Acc: 0.249 Test Loss: 3.376 Test Acc: 0.249
Validation loss decreased (-0.228202 --> -0.249378).  Saving model ...
Epoch: 15 cost time: 0.5356278419494629
Epoch: 15, Steps: 10 | Train Loss: 0.740 Vali Loss: 3.442 Vali Acc: 0.235 Test Loss: 3.442 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.531008243560791
Epoch: 16, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.525 Vali Acc: 0.241 Test Loss: 3.525 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.523113489151001
Epoch: 17, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.577 Vali Acc: 0.252 Test Loss: 3.577 Test Acc: 0.252
Validation loss decreased (-0.249378 --> -0.251729).  Saving model ...
Epoch: 18 cost time: 0.544039249420166
Epoch: 18, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.616 Vali Acc: 0.259 Test Loss: 3.616 Test Acc: 0.259
Validation loss decreased (-0.251729 --> -0.258787).  Saving model ...
Epoch: 19 cost time: 0.5582375526428223
Epoch: 19, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.677 Vali Acc: 0.273 Test Loss: 3.677 Test Acc: 0.273
Validation loss decreased (-0.258787 --> -0.272904).  Saving model ...
Epoch: 20 cost time: 0.5244095325469971
Epoch: 20, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.768 Vali Acc: 0.261 Test Loss: 3.768 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.529315710067749
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.838 Vali Acc: 0.262 Test Loss: 3.838 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.48955273628234863
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.909 Vali Acc: 0.266 Test Loss: 3.909 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5014691352844238
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.941 Vali Acc: 0.267 Test Loss: 3.941 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.48963236808776855
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.999 Vali Acc: 0.269 Test Loss: 3.999 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5598354339599609
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.050 Vali Acc: 0.272 Test Loss: 4.050 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.524970293045044
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.085 Vali Acc: 0.278 Test Loss: 4.085 Test Acc: 0.278
Validation loss decreased (-0.272904 --> -0.277606).  Saving model ...
Epoch: 27 cost time: 0.5281004905700684
Epoch: 27, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.109 Vali Acc: 0.275 Test Loss: 4.109 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5315513610839844
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.119 Vali Acc: 0.279 Test Loss: 4.119 Test Acc: 0.279
Validation loss decreased (-0.277606 --> -0.278782).  Saving model ...
Epoch: 29 cost time: 0.5083916187286377
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.170 Vali Acc: 0.275 Test Loss: 4.170 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4709317684173584
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.213 Vali Acc: 0.272 Test Loss: 4.213 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.49512648582458496
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.229 Vali Acc: 0.278 Test Loss: 4.229 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5111374855041504
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.253 Vali Acc: 0.273 Test Loss: 4.253 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4670674800872803
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.262 Vali Acc: 0.275 Test Loss: 4.262 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5469591617584229
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.298 Vali Acc: 0.275 Test Loss: 4.298 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5350759029388428
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.325 Vali Acc: 0.278 Test Loss: 4.325 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.49547362327575684
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.324 Vali Acc: 0.279 Test Loss: 4.324 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5811152458190918
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.350 Vali Acc: 0.280 Test Loss: 4.350 Test Acc: 0.280
Validation loss decreased (-0.278782 --> -0.279957).  Saving model ...
Epoch: 38 cost time: 0.49799132347106934
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.362 Vali Acc: 0.280 Test Loss: 4.362 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.542485237121582
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.389 Vali Acc: 0.281 Test Loss: 4.389 Test Acc: 0.281
Validation loss decreased (-0.279957 --> -0.281133).  Saving model ...
Epoch: 40 cost time: 0.556727409362793
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.401 Vali Acc: 0.279 Test Loss: 4.401 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5338084697723389
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.419 Vali Acc: 0.284 Test Loss: 4.419 Test Acc: 0.284
Validation loss decreased (-0.281133 --> -0.283485).  Saving model ...
Epoch: 42 cost time: 0.5492172241210938
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.428 Vali Acc: 0.287 Test Loss: 4.428 Test Acc: 0.287
Validation loss decreased (-0.283485 --> -0.287015).  Saving model ...
Epoch: 43 cost time: 0.47606372833251953
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.438 Vali Acc: 0.287 Test Loss: 4.438 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.505695104598999
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.452 Vali Acc: 0.281 Test Loss: 4.452 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5274159908294678
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.447 Vali Acc: 0.279 Test Loss: 4.447 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5270013809204102
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.464 Vali Acc: 0.279 Test Loss: 4.464 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5216457843780518
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.479 Vali Acc: 0.286 Test Loss: 4.479 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5450708866119385
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.500 Vali Acc: 0.282 Test Loss: 4.500 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.48273611068725586
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.506 Vali Acc: 0.284 Test Loss: 4.506 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5092625617980957
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.519 Vali Acc: 0.279 Test Loss: 4.519 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5270378589630127
Epoch: 51, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.539 Vali Acc: 0.276 Test Loss: 4.539 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5470783710479736
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.553 Vali Acc: 0.278 Test Loss: 4.553 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 120826
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5368869304656982
Epoch: 1, Steps: 10 | Train Loss: 3.473 Vali Loss: 3.375 Vali Acc: 0.046 Test Loss: 3.375 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.5131611824035645
Epoch: 2, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.354 Vali Acc: 0.044 Test Loss: 3.354 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5011851787567139
Epoch: 3, Steps: 10 | Train Loss: 3.194 Vali Loss: 3.350 Vali Acc: 0.049 Test Loss: 3.350 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 0.5023109912872314
Epoch: 4, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.362 Vali Acc: 0.066 Test Loss: 3.362 Test Acc: 0.066
Validation loss decreased (-0.049378 --> -0.065849).  Saving model ...
Epoch: 5 cost time: 0.48166632652282715
Epoch: 5, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.364 Vali Acc: 0.071 Test Loss: 3.364 Test Acc: 0.071
Validation loss decreased (-0.065849 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.4353601932525635
Epoch: 6, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.348 Vali Acc: 0.093 Test Loss: 3.348 Test Acc: 0.093
Validation loss decreased (-0.070555 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 0.4951291084289551
Epoch: 7, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.320 Vali Acc: 0.108 Test Loss: 3.320 Test Acc: 0.108
Validation loss decreased (-0.092908 --> -0.108202).  Saving model ...
Epoch: 8 cost time: 0.5199441909790039
Epoch: 8, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.306 Vali Acc: 0.115 Test Loss: 3.306 Test Acc: 0.115
Validation loss decreased (-0.108202 --> -0.115261).  Saving model ...
Epoch: 9 cost time: 0.5025017261505127
Epoch: 9, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.285 Vali Acc: 0.126 Test Loss: 3.285 Test Acc: 0.126
Validation loss decreased (-0.115261 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 0.5128240585327148
Epoch: 10, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.266 Vali Acc: 0.151 Test Loss: 3.266 Test Acc: 0.151
Validation loss decreased (-0.125850 --> -0.150556).  Saving model ...
Epoch: 11 cost time: 0.4810354709625244
Epoch: 11, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.268 Vali Acc: 0.154 Test Loss: 3.268 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154085).  Saving model ...
Epoch: 12 cost time: 0.5326318740844727
Epoch: 12, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.288 Vali Acc: 0.169 Test Loss: 3.288 Test Acc: 0.169
Validation loss decreased (-0.154085 --> -0.169379).  Saving model ...
Epoch: 13 cost time: 0.5308685302734375
Epoch: 13, Steps: 10 | Train Loss: 1.502 Vali Loss: 3.287 Vali Acc: 0.181 Test Loss: 3.287 Test Acc: 0.181
Validation loss decreased (-0.169379 --> -0.181144).  Saving model ...
Epoch: 14 cost time: 0.5317902565002441
Epoch: 14, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.297 Vali Acc: 0.195 Test Loss: 3.297 Test Acc: 0.195
Validation loss decreased (-0.181144 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 0.498201847076416
Epoch: 15, Steps: 10 | Train Loss: 1.143 Vali Loss: 3.324 Vali Acc: 0.200 Test Loss: 3.324 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 16 cost time: 0.4796164035797119
Epoch: 16, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.353 Vali Acc: 0.202 Test Loss: 3.353 Test Acc: 0.202
Validation loss decreased (-0.199967 --> -0.202319).  Saving model ...
Epoch: 17 cost time: 0.509758710861206
Epoch: 17, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.401 Vali Acc: 0.211 Test Loss: 3.401 Test Acc: 0.211
Validation loss decreased (-0.202319 --> -0.210554).  Saving model ...
Epoch: 18 cost time: 0.47968173027038574
Epoch: 18, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.408 Vali Acc: 0.221 Test Loss: 3.408 Test Acc: 0.221
Validation loss decreased (-0.210554 --> -0.221142).  Saving model ...
Epoch: 19 cost time: 0.47435808181762695
Epoch: 19, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.449 Vali Acc: 0.236 Test Loss: 3.449 Test Acc: 0.236
Validation loss decreased (-0.221142 --> -0.236436).  Saving model ...
Epoch: 20 cost time: 0.5288262367248535
Epoch: 20, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.510 Vali Acc: 0.238 Test Loss: 3.510 Test Acc: 0.238
Validation loss decreased (-0.236436 --> -0.237612).  Saving model ...
Epoch: 21 cost time: 0.4814467430114746
Epoch: 21, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.590 Vali Acc: 0.235 Test Loss: 3.590 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4868788719177246
Epoch: 22, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.664 Vali Acc: 0.241 Test Loss: 3.664 Test Acc: 0.241
Validation loss decreased (-0.237612 --> -0.241140).  Saving model ...
Epoch: 23 cost time: 0.5324862003326416
Epoch: 23, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.667 Vali Acc: 0.249 Test Loss: 3.667 Test Acc: 0.249
Validation loss decreased (-0.241140 --> -0.249375).  Saving model ...
Epoch: 24 cost time: 0.48891162872314453
Epoch: 24, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.725 Vali Acc: 0.247 Test Loss: 3.725 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4924752712249756
Epoch: 25, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.801 Vali Acc: 0.235 Test Loss: 3.801 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5065581798553467
Epoch: 26, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.856 Vali Acc: 0.241 Test Loss: 3.856 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4830210208892822
Epoch: 27, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.884 Vali Acc: 0.245 Test Loss: 3.884 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.47635912895202637
Epoch: 28, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.929 Vali Acc: 0.244 Test Loss: 3.929 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49410104751586914
Epoch: 29, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.981 Vali Acc: 0.251 Test Loss: 3.981 Test Acc: 0.251
Validation loss decreased (-0.249375 --> -0.250548).  Saving model ...
Epoch: 30 cost time: 0.685706377029419
Epoch: 30, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.028 Vali Acc: 0.251 Test Loss: 4.028 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.46234750747680664
Epoch: 31, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.085 Vali Acc: 0.253 Test Loss: 4.085 Test Acc: 0.253
Validation loss decreased (-0.250548 --> -0.252900).  Saving model ...
Epoch: 32 cost time: 0.48644208908081055
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.078 Vali Acc: 0.248 Test Loss: 4.078 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5379762649536133
Epoch: 33, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.095 Vali Acc: 0.255 Test Loss: 4.095 Test Acc: 0.255
Validation loss decreased (-0.252900 --> -0.255253).  Saving model ...
Epoch: 34 cost time: 0.47862672805786133
Epoch: 34, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.127 Vali Acc: 0.249 Test Loss: 4.127 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5621812343597412
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.160 Vali Acc: 0.247 Test Loss: 4.160 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5263791084289551
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.171 Vali Acc: 0.247 Test Loss: 4.171 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.49317121505737305
Epoch: 37, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.185 Vali Acc: 0.251 Test Loss: 4.185 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.46271467208862305
Epoch: 38, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.226 Vali Acc: 0.254 Test Loss: 4.226 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.47632384300231934
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.257 Vali Acc: 0.248 Test Loss: 4.257 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.49007463455200195
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.282 Vali Acc: 0.247 Test Loss: 4.282 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4345717430114746
Epoch: 41, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.321 Vali Acc: 0.254 Test Loss: 4.321 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5294737815856934
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.340 Vali Acc: 0.260 Test Loss: 4.340 Test Acc: 0.260
Validation loss decreased (-0.255253 --> -0.259957).  Saving model ...
Epoch: 43 cost time: 0.5216360092163086
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.347 Vali Acc: 0.262 Test Loss: 4.347 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262309).  Saving model ...
Epoch: 44 cost time: 0.5208182334899902
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.317 Vali Acc: 0.262 Test Loss: 4.317 Test Acc: 0.262
Validation loss decreased (-0.262309 --> -0.262310).  Saving model ...
Epoch: 45 cost time: 0.5265200138092041
Epoch: 45, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.327 Vali Acc: 0.267 Test Loss: 4.327 Test Acc: 0.267
Validation loss decreased (-0.262310 --> -0.267016).  Saving model ...
Epoch: 46 cost time: 0.5159614086151123
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.364 Vali Acc: 0.264 Test Loss: 4.364 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5382387638092041
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.376 Vali Acc: 0.264 Test Loss: 4.376 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4999513626098633
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.376 Vali Acc: 0.262 Test Loss: 4.376 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.48424744606018066
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.395 Vali Acc: 0.262 Test Loss: 4.395 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.502528190612793
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.415 Vali Acc: 0.264 Test Loss: 4.415 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.45851635932922363
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.428 Vali Acc: 0.264 Test Loss: 4.428 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5082862377166748
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.450 Vali Acc: 0.265 Test Loss: 4.450 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.47105836868286133
Epoch: 53, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.456 Vali Acc: 0.261 Test Loss: 4.456 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.4896998405456543
Epoch: 54, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.451 Vali Acc: 0.265 Test Loss: 4.451 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.4875786304473877
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.452 Vali Acc: 0.266 Test Loss: 4.452 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 88506
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.626631498336792
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.364 Vali Acc: 0.038 Test Loss: 3.364 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.45594334602355957
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.340 Vali Acc: 0.039 Test Loss: 3.340 Test Acc: 0.039
Validation loss decreased (-0.037613 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.5234875679016113
Epoch: 3, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.324 Vali Acc: 0.053 Test Loss: 3.324 Test Acc: 0.053
Validation loss decreased (-0.038790 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.4885120391845703
Epoch: 4, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.322 Vali Acc: 0.054 Test Loss: 3.322 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054084).  Saving model ...
Epoch: 5 cost time: 0.47805261611938477
Epoch: 5, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.318 Vali Acc: 0.072 Test Loss: 3.318 Test Acc: 0.072
Validation loss decreased (-0.054084 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.5169646739959717
Epoch: 6, Steps: 10 | Train Loss: 2.851 Vali Loss: 3.318 Vali Acc: 0.082 Test Loss: 3.318 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.479358434677124
Epoch: 7, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.307 Vali Acc: 0.091 Test Loss: 3.307 Test Acc: 0.091
Validation loss decreased (-0.082320 --> -0.090555).  Saving model ...
Epoch: 8 cost time: 0.4710114002227783
Epoch: 8, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.296 Vali Acc: 0.106 Test Loss: 3.296 Test Acc: 0.106
Validation loss decreased (-0.090555 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 0.499422550201416
Epoch: 9, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.271 Vali Acc: 0.121 Test Loss: 3.271 Test Acc: 0.121
Validation loss decreased (-0.105849 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.5056378841400146
Epoch: 10, Steps: 10 | Train Loss: 2.270 Vali Loss: 3.266 Vali Acc: 0.135 Test Loss: 3.266 Test Acc: 0.135
Validation loss decreased (-0.121144 --> -0.135261).  Saving model ...
Epoch: 11 cost time: 0.47510457038879395
Epoch: 11, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.258 Vali Acc: 0.145 Test Loss: 3.258 Test Acc: 0.145
Validation loss decreased (-0.135261 --> -0.144673).  Saving model ...
Epoch: 12 cost time: 0.51924729347229
Epoch: 12, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.268 Vali Acc: 0.149 Test Loss: 3.268 Test Acc: 0.149
Validation loss decreased (-0.144673 --> -0.149379).  Saving model ...
Epoch: 13 cost time: 0.4813976287841797
Epoch: 13, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.268 Vali Acc: 0.154 Test Loss: 3.268 Test Acc: 0.154
Validation loss decreased (-0.149379 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.5157246589660645
Epoch: 14, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.261 Vali Acc: 0.167 Test Loss: 3.261 Test Acc: 0.167
Validation loss decreased (-0.154085 --> -0.167026).  Saving model ...
Epoch: 15 cost time: 0.5303339958190918
Epoch: 15, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.292 Vali Acc: 0.166 Test Loss: 3.292 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5187413692474365
Epoch: 16, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.312 Vali Acc: 0.175 Test Loss: 3.312 Test Acc: 0.175
Validation loss decreased (-0.167026 --> -0.175261).  Saving model ...
Epoch: 17 cost time: 0.49156665802001953
Epoch: 17, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.315 Vali Acc: 0.193 Test Loss: 3.315 Test Acc: 0.193
Validation loss decreased (-0.175261 --> -0.192908).  Saving model ...
Epoch: 18 cost time: 0.5114908218383789
Epoch: 18, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.330 Vali Acc: 0.198 Test Loss: 3.330 Test Acc: 0.198
Validation loss decreased (-0.192908 --> -0.197614).  Saving model ...
Epoch: 19 cost time: 0.4848310947418213
Epoch: 19, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.357 Vali Acc: 0.213 Test Loss: 3.357 Test Acc: 0.213
Validation loss decreased (-0.197614 --> -0.212908).  Saving model ...
Epoch: 20 cost time: 0.5080611705780029
Epoch: 20, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.401 Vali Acc: 0.213 Test Loss: 3.401 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49030113220214844
Epoch: 21, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.438 Vali Acc: 0.219 Test Loss: 3.438 Test Acc: 0.219
Validation loss decreased (-0.212908 --> -0.218789).  Saving model ...
Epoch: 22 cost time: 0.5219335556030273
Epoch: 22, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.460 Vali Acc: 0.226 Test Loss: 3.460 Test Acc: 0.226
Validation loss decreased (-0.218789 --> -0.225848).  Saving model ...
Epoch: 23 cost time: 0.5340425968170166
Epoch: 23, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.488 Vali Acc: 0.225 Test Loss: 3.488 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.46216583251953125
Epoch: 24, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.537 Vali Acc: 0.234 Test Loss: 3.537 Test Acc: 0.234
Validation loss decreased (-0.225848 --> -0.234082).  Saving model ...
Epoch: 25 cost time: 0.4887723922729492
Epoch: 25, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.563 Vali Acc: 0.232 Test Loss: 3.563 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4625203609466553
Epoch: 26, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.604 Vali Acc: 0.236 Test Loss: 3.604 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236435).  Saving model ...
Epoch: 27 cost time: 0.5101604461669922
Epoch: 27, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.666 Vali Acc: 0.240 Test Loss: 3.666 Test Acc: 0.240
Validation loss decreased (-0.236435 --> -0.239963).  Saving model ...
Epoch: 28 cost time: 0.5063700675964355
Epoch: 28, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.732 Vali Acc: 0.236 Test Loss: 3.732 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47685670852661133
Epoch: 29, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.771 Vali Acc: 0.239 Test Loss: 3.771 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5118272304534912
Epoch: 30, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.790 Vali Acc: 0.247 Test Loss: 3.790 Test Acc: 0.247
Validation loss decreased (-0.239963 --> -0.247021).  Saving model ...
Epoch: 31 cost time: 0.49074888229370117
Epoch: 31, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.824 Vali Acc: 0.242 Test Loss: 3.824 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4947192668914795
Epoch: 32, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.854 Vali Acc: 0.241 Test Loss: 3.854 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4853956699371338
Epoch: 33, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.901 Vali Acc: 0.242 Test Loss: 3.901 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.49919724464416504
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.930 Vali Acc: 0.248 Test Loss: 3.930 Test Acc: 0.248
Validation loss decreased (-0.247021 --> -0.248196).  Saving model ...
Epoch: 35 cost time: 0.4402198791503906
Epoch: 35, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.929 Vali Acc: 0.258 Test Loss: 3.929 Test Acc: 0.258
Validation loss decreased (-0.248196 --> -0.257608).  Saving model ...
Epoch: 36 cost time: 0.46834778785705566
Epoch: 36, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.977 Vali Acc: 0.260 Test Loss: 3.977 Test Acc: 0.260
Validation loss decreased (-0.257608 --> -0.259960).  Saving model ...
Epoch: 37 cost time: 0.4836721420288086
Epoch: 37, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.044 Vali Acc: 0.252 Test Loss: 4.044 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.42415452003479004
Epoch: 38, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.075 Vali Acc: 0.248 Test Loss: 4.075 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5125439167022705
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.044 Vali Acc: 0.255 Test Loss: 4.044 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4753241539001465
Epoch: 40, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.063 Vali Acc: 0.256 Test Loss: 4.063 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4764211177825928
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.085 Vali Acc: 0.258 Test Loss: 4.085 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.46039485931396484
Epoch: 42, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.119 Vali Acc: 0.258 Test Loss: 4.119 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.47249293327331543
Epoch: 43, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.162 Vali Acc: 0.253 Test Loss: 4.162 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5058588981628418
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.203 Vali Acc: 0.256 Test Loss: 4.203 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5204501152038574
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.213 Vali Acc: 0.255 Test Loss: 4.213 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.510368824005127
Epoch: 46, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.203 Vali Acc: 0.261 Test Loss: 4.203 Test Acc: 0.261
Validation loss decreased (-0.259960 --> -0.261134).  Saving model ...
Epoch: 47 cost time: 0.4654412269592285
Epoch: 47, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.228 Vali Acc: 0.259 Test Loss: 4.228 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5215301513671875
Epoch: 48, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.237 Vali Acc: 0.255 Test Loss: 4.237 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.46027469635009766
Epoch: 49, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.257 Vali Acc: 0.258 Test Loss: 4.257 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.47043776512145996
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.252 Vali Acc: 0.258 Test Loss: 4.252 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.4921691417694092
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.276 Vali Acc: 0.256 Test Loss: 4.276 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.4988541603088379
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.294 Vali Acc: 0.262 Test Loss: 4.294 Test Acc: 0.262
Validation loss decreased (-0.261134 --> -0.262310).  Saving model ...
Epoch: 53 cost time: 0.4763059616088867
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.307 Vali Acc: 0.265 Test Loss: 4.307 Test Acc: 0.265
Validation loss decreased (-0.262310 --> -0.264663).  Saving model ...
Epoch: 54 cost time: 0.4496891498565674
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.307 Vali Acc: 0.265 Test Loss: 4.307 Test Acc: 0.265
Validation loss decreased (-0.264663 --> -0.264663).  Saving model ...
Epoch: 55 cost time: 0.5140304565429688
Epoch: 55, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.314 Vali Acc: 0.260 Test Loss: 4.314 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.4912416934967041
Epoch: 56, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.349 Vali Acc: 0.256 Test Loss: 4.349 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4968852996826172
Epoch: 57, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.381 Vali Acc: 0.260 Test Loss: 4.381 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.4524540901184082
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.374 Vali Acc: 0.260 Test Loss: 4.374 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.4994642734527588
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.395 Vali Acc: 0.259 Test Loss: 4.395 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.5104432106018066
Epoch: 60, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.413 Vali Acc: 0.256 Test Loss: 4.413 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.5274724960327148
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.428 Vali Acc: 0.254 Test Loss: 4.428 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.49702954292297363
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.429 Vali Acc: 0.254 Test Loss: 4.429 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.49337244033813477
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.429 Vali Acc: 0.256 Test Loss: 4.429 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.49140000343322754
Epoch: 64, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.438 Vali Acc: 0.258 Test Loss: 4.438 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 73658
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4884066581726074
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.358 Vali Acc: 0.040 Test Loss: 3.358 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.5569150447845459
Epoch: 2, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.351 Vali Acc: 0.038 Test Loss: 3.351 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5434801578521729
Epoch: 3, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.339 Vali Acc: 0.047 Test Loss: 3.339 Test Acc: 0.047
Validation loss decreased (-0.039966 --> -0.047025).  Saving model ...
Epoch: 4 cost time: 0.5311732292175293
Epoch: 4, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.327 Vali Acc: 0.056 Test Loss: 3.327 Test Acc: 0.056
Validation loss decreased (-0.047025 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 0.495868444442749
Epoch: 5, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.319 Vali Acc: 0.065 Test Loss: 3.319 Test Acc: 0.065
Validation loss decreased (-0.056437 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 0.5792694091796875
Epoch: 6, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.312 Vali Acc: 0.074 Test Loss: 3.312 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.6025607585906982
Epoch: 7, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.305 Vali Acc: 0.085 Test Loss: 3.305 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.5348858833312988
Epoch: 8, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.297 Vali Acc: 0.092 Test Loss: 3.297 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.5434889793395996
Epoch: 9, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.295 Vali Acc: 0.105 Test Loss: 3.295 Test Acc: 0.105
Validation loss decreased (-0.091732 --> -0.104673).  Saving model ...
Epoch: 10 cost time: 0.5071218013763428
Epoch: 10, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.292 Vali Acc: 0.109 Test Loss: 3.292 Test Acc: 0.109
Validation loss decreased (-0.104673 --> -0.109379).  Saving model ...
Epoch: 11 cost time: 0.5038690567016602
Epoch: 11, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.282 Vali Acc: 0.120 Test Loss: 3.282 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119967).  Saving model ...
Epoch: 12 cost time: 0.6181714534759521
Epoch: 12, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.275 Vali Acc: 0.127 Test Loss: 3.275 Test Acc: 0.127
Validation loss decreased (-0.119967 --> -0.127026).  Saving model ...
Epoch: 13 cost time: 0.5129146575927734
Epoch: 13, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.264 Vali Acc: 0.133 Test Loss: 3.264 Test Acc: 0.133
Validation loss decreased (-0.127026 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.5154094696044922
Epoch: 14, Steps: 10 | Train Loss: 2.110 Vali Loss: 3.268 Vali Acc: 0.134 Test Loss: 3.268 Test Acc: 0.134
Validation loss decreased (-0.132909 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.5566694736480713
Epoch: 15, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.270 Vali Acc: 0.145 Test Loss: 3.270 Test Acc: 0.145
Validation loss decreased (-0.134085 --> -0.144673).  Saving model ...
Epoch: 16 cost time: 0.5158894062042236
Epoch: 16, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.264 Vali Acc: 0.155 Test Loss: 3.264 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155261).  Saving model ...
Epoch: 17 cost time: 0.5392875671386719
Epoch: 17, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.275 Vali Acc: 0.158 Test Loss: 3.275 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 18 cost time: 0.5456721782684326
Epoch: 18, Steps: 10 | Train Loss: 1.546 Vali Loss: 3.287 Vali Acc: 0.172 Test Loss: 3.287 Test Acc: 0.172
Validation loss decreased (-0.157614 --> -0.171732).  Saving model ...
Epoch: 19 cost time: 0.5084140300750732
Epoch: 19, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.304 Vali Acc: 0.175 Test Loss: 3.304 Test Acc: 0.175
Validation loss decreased (-0.171732 --> -0.175261).  Saving model ...
Epoch: 20 cost time: 0.4743213653564453
Epoch: 20, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.324 Vali Acc: 0.185 Test Loss: 3.324 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184673).  Saving model ...
Epoch: 21 cost time: 0.5486962795257568
Epoch: 21, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.341 Vali Acc: 0.191 Test Loss: 3.341 Test Acc: 0.191
Validation loss decreased (-0.184673 --> -0.190555).  Saving model ...
Epoch: 22 cost time: 0.5345578193664551
Epoch: 22, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.362 Vali Acc: 0.196 Test Loss: 3.362 Test Acc: 0.196
Validation loss decreased (-0.190555 --> -0.196437).  Saving model ...
Epoch: 23 cost time: 0.5057964324951172
Epoch: 23, Steps: 10 | Train Loss: 1.057 Vali Loss: 3.378 Vali Acc: 0.202 Test Loss: 3.378 Test Acc: 0.202
Validation loss decreased (-0.196437 --> -0.202319).  Saving model ...
Epoch: 24 cost time: 0.4993147850036621
Epoch: 24, Steps: 10 | Train Loss: 0.989 Vali Loss: 3.411 Vali Acc: 0.213 Test Loss: 3.411 Test Acc: 0.213
Validation loss decreased (-0.202319 --> -0.212907).  Saving model ...
Epoch: 25 cost time: 0.44184088706970215
Epoch: 25, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.438 Vali Acc: 0.212 Test Loss: 3.438 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5050890445709229
Epoch: 26, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.454 Vali Acc: 0.220 Test Loss: 3.454 Test Acc: 0.220
Validation loss decreased (-0.212907 --> -0.219965).  Saving model ...
Epoch: 27 cost time: 0.45636749267578125
Epoch: 27, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.482 Vali Acc: 0.226 Test Loss: 3.482 Test Acc: 0.226
Validation loss decreased (-0.219965 --> -0.225848).  Saving model ...
Epoch: 28 cost time: 0.5140261650085449
Epoch: 28, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.515 Vali Acc: 0.221 Test Loss: 3.515 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.485668420791626
Epoch: 29, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.531 Vali Acc: 0.228 Test Loss: 3.531 Test Acc: 0.228
Validation loss decreased (-0.225848 --> -0.228200).  Saving model ...
Epoch: 30 cost time: 0.47951745986938477
Epoch: 30, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.569 Vali Acc: 0.227 Test Loss: 3.569 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47208595275878906
Epoch: 31, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.620 Vali Acc: 0.225 Test Loss: 3.620 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5252470970153809
Epoch: 32, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.637 Vali Acc: 0.232 Test Loss: 3.637 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231728).  Saving model ...
Epoch: 33 cost time: 0.5604586601257324
Epoch: 33, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.672 Vali Acc: 0.229 Test Loss: 3.672 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5248193740844727
Epoch: 34, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.700 Vali Acc: 0.225 Test Loss: 3.700 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.558114767074585
Epoch: 35, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.722 Vali Acc: 0.222 Test Loss: 3.722 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5481235980987549
Epoch: 36, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.744 Vali Acc: 0.229 Test Loss: 3.744 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5373969078063965
Epoch: 37, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.769 Vali Acc: 0.234 Test Loss: 3.769 Test Acc: 0.234
Validation loss decreased (-0.231728 --> -0.234080).  Saving model ...
Epoch: 38 cost time: 0.5392556190490723
Epoch: 38, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.792 Vali Acc: 0.242 Test Loss: 3.792 Test Acc: 0.242
Validation loss decreased (-0.234080 --> -0.242315).  Saving model ...
Epoch: 39 cost time: 0.4923522472381592
Epoch: 39, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.842 Vali Acc: 0.246 Test Loss: 3.842 Test Acc: 0.246
Validation loss decreased (-0.242315 --> -0.245844).  Saving model ...
Epoch: 40 cost time: 0.5594618320465088
Epoch: 40, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.843 Vali Acc: 0.246 Test Loss: 3.843 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5496656894683838
Epoch: 41, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.858 Vali Acc: 0.246 Test Loss: 3.858 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5392658710479736
Epoch: 42, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.894 Vali Acc: 0.249 Test Loss: 3.894 Test Acc: 0.249
Validation loss decreased (-0.245844 --> -0.249373).  Saving model ...
Epoch: 43 cost time: 0.5136740207672119
Epoch: 43, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.908 Vali Acc: 0.251 Test Loss: 3.908 Test Acc: 0.251
Validation loss decreased (-0.249373 --> -0.250549).  Saving model ...
Epoch: 44 cost time: 0.5670828819274902
Epoch: 44, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.947 Vali Acc: 0.244 Test Loss: 3.947 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.485079288482666
Epoch: 45, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.967 Vali Acc: 0.241 Test Loss: 3.967 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.48798465728759766
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.982 Vali Acc: 0.242 Test Loss: 3.982 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5287132263183594
Epoch: 47, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.991 Vali Acc: 0.249 Test Loss: 3.991 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5367248058319092
Epoch: 48, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.989 Vali Acc: 0.246 Test Loss: 3.989 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5096883773803711
Epoch: 49, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.984 Vali Acc: 0.251 Test Loss: 3.984 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5830411911010742
Epoch: 50, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.018 Vali Acc: 0.242 Test Loss: 4.018 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5287630558013916
Epoch: 51, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.057 Vali Acc: 0.244 Test Loss: 4.057 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.47232890129089355
Epoch: 52, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.053 Vali Acc: 0.246 Test Loss: 4.053 Test Acc: 0.246
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5274076461791992
Epoch: 53, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.062 Vali Acc: 0.252 Test Loss: 4.062 Test Acc: 0.252
Validation loss decreased (-0.250549 --> -0.251724).  Saving model ...
Epoch: 54 cost time: 0.5254056453704834
Epoch: 54, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.094 Vali Acc: 0.246 Test Loss: 4.094 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5318045616149902
Epoch: 55, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.108 Vali Acc: 0.252 Test Loss: 4.108 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6120789051055908
Epoch: 56, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.116 Vali Acc: 0.248 Test Loss: 4.116 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5328707695007324
Epoch: 57, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.131 Vali Acc: 0.251 Test Loss: 4.131 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5512194633483887
Epoch: 58, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.149 Vali Acc: 0.253 Test Loss: 4.149 Test Acc: 0.253
Validation loss decreased (-0.251724 --> -0.252900).  Saving model ...
Epoch: 59 cost time: 0.5642299652099609
Epoch: 59, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.172 Vali Acc: 0.248 Test Loss: 4.172 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5651586055755615
Epoch: 60, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.174 Vali Acc: 0.252 Test Loss: 4.174 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5207464694976807
Epoch: 61, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.182 Vali Acc: 0.252 Test Loss: 4.182 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5582370758056641
Epoch: 62, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.191 Vali Acc: 0.248 Test Loss: 4.191 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.48687267303466797
Epoch: 63, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.218 Vali Acc: 0.247 Test Loss: 4.218 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.595562219619751
Epoch: 64, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.216 Vali Acc: 0.249 Test Loss: 4.216 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6143660545349121
Epoch: 65, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.220 Vali Acc: 0.249 Test Loss: 4.220 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5268402099609375
Epoch: 66, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.229 Vali Acc: 0.252 Test Loss: 4.229 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5135233402252197
Epoch: 67, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.244 Vali Acc: 0.251 Test Loss: 4.244 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5733363628387451
Epoch: 68, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.269 Vali Acc: 0.246 Test Loss: 4.269 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 56410
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5320854187011719
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.350 Vali Acc: 0.042 Test Loss: 3.350 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.4528987407684326
Epoch: 2, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.351 Vali Acc: 0.040 Test Loss: 3.351 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5032718181610107
Epoch: 3, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.348 Vali Acc: 0.038 Test Loss: 3.348 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5062365531921387
Epoch: 4, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.338 Vali Acc: 0.044 Test Loss: 3.338 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043496).  Saving model ...
Epoch: 5 cost time: 0.5304133892059326
Epoch: 5, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.331 Vali Acc: 0.049 Test Loss: 3.331 Test Acc: 0.049
Validation loss decreased (-0.043496 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 0.5051450729370117
Epoch: 6, Steps: 10 | Train Loss: 3.022 Vali Loss: 3.325 Vali Acc: 0.052 Test Loss: 3.325 Test Acc: 0.052
Validation loss decreased (-0.049378 --> -0.051731).  Saving model ...
Epoch: 7 cost time: 0.5263495445251465
Epoch: 7, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.320 Vali Acc: 0.061 Test Loss: 3.320 Test Acc: 0.061
Validation loss decreased (-0.051731 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 0.47818636894226074
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.319 Vali Acc: 0.074 Test Loss: 3.319 Test Acc: 0.074
Validation loss decreased (-0.061143 --> -0.074084).  Saving model ...
Epoch: 9 cost time: 0.5019214153289795
Epoch: 9, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.315 Vali Acc: 0.076 Test Loss: 3.315 Test Acc: 0.076
Validation loss decreased (-0.074084 --> -0.076437).  Saving model ...
Epoch: 10 cost time: 0.5169107913970947
Epoch: 10, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.309 Vali Acc: 0.089 Test Loss: 3.309 Test Acc: 0.089
Validation loss decreased (-0.076437 --> -0.089379).  Saving model ...
Epoch: 11 cost time: 0.5272221565246582
Epoch: 11, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.306 Vali Acc: 0.096 Test Loss: 3.306 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.5420138835906982
Epoch: 12, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.306 Vali Acc: 0.101 Test Loss: 3.306 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101143).  Saving model ...
Epoch: 13 cost time: 0.5070004463195801
Epoch: 13, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.305 Vali Acc: 0.109 Test Loss: 3.305 Test Acc: 0.109
Validation loss decreased (-0.101143 --> -0.109379).  Saving model ...
Epoch: 14 cost time: 0.44544053077697754
Epoch: 14, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.308 Vali Acc: 0.119 Test Loss: 3.308 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118790).  Saving model ...
Epoch: 15 cost time: 0.4635744094848633
Epoch: 15, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.318 Vali Acc: 0.121 Test Loss: 3.318 Test Acc: 0.121
Validation loss decreased (-0.118790 --> -0.121143).  Saving model ...
Epoch: 16 cost time: 0.49669599533081055
Epoch: 16, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.304 Vali Acc: 0.136 Test Loss: 3.304 Test Acc: 0.136
Validation loss decreased (-0.121143 --> -0.136438).  Saving model ...
Epoch: 17 cost time: 0.4311375617980957
Epoch: 17, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.305 Vali Acc: 0.139 Test Loss: 3.305 Test Acc: 0.139
Validation loss decreased (-0.136438 --> -0.138790).  Saving model ...
Epoch: 18 cost time: 0.4909932613372803
Epoch: 18, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.307 Vali Acc: 0.142 Test Loss: 3.307 Test Acc: 0.142
Validation loss decreased (-0.138790 --> -0.142320).  Saving model ...
Epoch: 19 cost time: 0.47300076484680176
Epoch: 19, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.312 Vali Acc: 0.151 Test Loss: 3.312 Test Acc: 0.151
Validation loss decreased (-0.142320 --> -0.150555).  Saving model ...
Epoch: 20 cost time: 0.49122071266174316
Epoch: 20, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.318 Vali Acc: 0.154 Test Loss: 3.318 Test Acc: 0.154
Validation loss decreased (-0.150555 --> -0.154084).  Saving model ...
Epoch: 21 cost time: 0.47486019134521484
Epoch: 21, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.335 Vali Acc: 0.156 Test Loss: 3.335 Test Acc: 0.156
Validation loss decreased (-0.154084 --> -0.156437).  Saving model ...
Epoch: 22 cost time: 0.44556331634521484
Epoch: 22, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.341 Vali Acc: 0.171 Test Loss: 3.341 Test Acc: 0.171
Validation loss decreased (-0.156437 --> -0.170555).  Saving model ...
Epoch: 23 cost time: 0.5033104419708252
Epoch: 23, Steps: 10 | Train Loss: 1.342 Vali Loss: 3.362 Vali Acc: 0.168 Test Loss: 3.362 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.46769261360168457
Epoch: 24, Steps: 10 | Train Loss: 1.188 Vali Loss: 3.372 Vali Acc: 0.175 Test Loss: 3.372 Test Acc: 0.175
Validation loss decreased (-0.170555 --> -0.175260).  Saving model ...
Epoch: 25 cost time: 0.4772508144378662
Epoch: 25, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.385 Vali Acc: 0.178 Test Loss: 3.385 Test Acc: 0.178
Validation loss decreased (-0.175260 --> -0.177613).  Saving model ...
Epoch: 26 cost time: 0.4995689392089844
Epoch: 26, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.397 Vali Acc: 0.185 Test Loss: 3.397 Test Acc: 0.185
Validation loss decreased (-0.177613 --> -0.184672).  Saving model ...
Epoch: 27 cost time: 0.4806537628173828
Epoch: 27, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.420 Vali Acc: 0.191 Test Loss: 3.420 Test Acc: 0.191
Validation loss decreased (-0.184672 --> -0.190554).  Saving model ...
Epoch: 28 cost time: 0.46561455726623535
Epoch: 28, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.451 Vali Acc: 0.194 Test Loss: 3.451 Test Acc: 0.194
Validation loss decreased (-0.190554 --> -0.194083).  Saving model ...
Epoch: 29 cost time: 0.5289068222045898
Epoch: 29, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.468 Vali Acc: 0.199 Test Loss: 3.468 Test Acc: 0.199
Validation loss decreased (-0.194083 --> -0.198789).  Saving model ...
Epoch: 30 cost time: 0.5171082019805908
Epoch: 30, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.498 Vali Acc: 0.196 Test Loss: 3.498 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.44836997985839844
Epoch: 31, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.520 Vali Acc: 0.206 Test Loss: 3.520 Test Acc: 0.206
Validation loss decreased (-0.198789 --> -0.205847).  Saving model ...
Epoch: 32 cost time: 0.5082283020019531
Epoch: 32, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.533 Vali Acc: 0.208 Test Loss: 3.533 Test Acc: 0.208
Validation loss decreased (-0.205847 --> -0.208200).  Saving model ...
Epoch: 33 cost time: 0.5270774364471436
Epoch: 33, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.577 Vali Acc: 0.209 Test Loss: 3.577 Test Acc: 0.209
Validation loss decreased (-0.208200 --> -0.209376).  Saving model ...
Epoch: 34 cost time: 0.49720191955566406
Epoch: 34, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.613 Vali Acc: 0.220 Test Loss: 3.613 Test Acc: 0.220
Validation loss decreased (-0.209376 --> -0.219964).  Saving model ...
Epoch: 35 cost time: 0.5495545864105225
Epoch: 35, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.641 Vali Acc: 0.222 Test Loss: 3.641 Test Acc: 0.222
Validation loss decreased (-0.219964 --> -0.222317).  Saving model ...
Epoch: 36 cost time: 0.43924880027770996
Epoch: 36, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.685 Vali Acc: 0.228 Test Loss: 3.685 Test Acc: 0.228
Validation loss decreased (-0.222317 --> -0.228198).  Saving model ...
Epoch: 37 cost time: 0.4965245723724365
Epoch: 37, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.709 Vali Acc: 0.229 Test Loss: 3.709 Test Acc: 0.229
Validation loss decreased (-0.228198 --> -0.229375).  Saving model ...
Epoch: 38 cost time: 0.4946482181549072
Epoch: 38, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.729 Vali Acc: 0.221 Test Loss: 3.729 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4925508499145508
Epoch: 39, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.732 Vali Acc: 0.227 Test Loss: 3.732 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.48803257942199707
Epoch: 40, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.756 Vali Acc: 0.220 Test Loss: 3.756 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.46582913398742676
Epoch: 41, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.787 Vali Acc: 0.224 Test Loss: 3.787 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5111186504364014
Epoch: 42, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.817 Vali Acc: 0.216 Test Loss: 3.817 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.43276119232177734
Epoch: 43, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.835 Vali Acc: 0.226 Test Loss: 3.835 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5135476589202881
Epoch: 44, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.853 Vali Acc: 0.229 Test Loss: 3.853 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5097246170043945
Epoch: 45, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.869 Vali Acc: 0.232 Test Loss: 3.869 Test Acc: 0.232
Validation loss decreased (-0.229375 --> -0.231726).  Saving model ...
Epoch: 46 cost time: 0.5150737762451172
Epoch: 46, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.892 Vali Acc: 0.233 Test Loss: 3.892 Test Acc: 0.233
Validation loss decreased (-0.231726 --> -0.232902).  Saving model ...
Epoch: 47 cost time: 0.4758477210998535
Epoch: 47, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.942 Vali Acc: 0.231 Test Loss: 3.942 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.47510313987731934
Epoch: 48, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.924 Vali Acc: 0.225 Test Loss: 3.924 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5526459217071533
Epoch: 49, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.938 Vali Acc: 0.221 Test Loss: 3.938 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5154151916503906
Epoch: 50, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.964 Vali Acc: 0.222 Test Loss: 3.964 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.4772913455963135
Epoch: 51, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.992 Vali Acc: 0.233 Test Loss: 3.992 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5554258823394775
Epoch: 52, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.010 Vali Acc: 0.235 Test Loss: 4.010 Test Acc: 0.235
Validation loss decreased (-0.232902 --> -0.235254).  Saving model ...
Epoch: 53 cost time: 0.5474967956542969
Epoch: 53, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.022 Vali Acc: 0.238 Test Loss: 4.022 Test Acc: 0.238
Validation loss decreased (-0.235254 --> -0.237607).  Saving model ...
Epoch: 54 cost time: 0.5142035484313965
Epoch: 54, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.039 Vali Acc: 0.235 Test Loss: 4.039 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5490598678588867
Epoch: 55, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.051 Vali Acc: 0.241 Test Loss: 4.051 Test Acc: 0.241
Validation loss decreased (-0.237607 --> -0.241136).  Saving model ...
Epoch: 56 cost time: 0.5261931419372559
Epoch: 56, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.064 Vali Acc: 0.238 Test Loss: 4.064 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.49678754806518555
Epoch: 57, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.077 Vali Acc: 0.241 Test Loss: 4.077 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.49694180488586426
Epoch: 58, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.111 Vali Acc: 0.245 Test Loss: 4.111 Test Acc: 0.245
Validation loss decreased (-0.241136 --> -0.244665).  Saving model ...
Epoch: 59 cost time: 0.49558115005493164
Epoch: 59, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.135 Vali Acc: 0.244 Test Loss: 4.135 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.4995231628417969
Epoch: 60, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.49411654472351074
Epoch: 61, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.151 Vali Acc: 0.241 Test Loss: 4.151 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.4927387237548828
Epoch: 62, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.154 Vali Acc: 0.239 Test Loss: 4.154 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.46979546546936035
Epoch: 63, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.159 Vali Acc: 0.244 Test Loss: 4.159 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.46552395820617676
Epoch: 64, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.171 Vali Acc: 0.241 Test Loss: 4.171 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.5334086418151855
Epoch: 65, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.195 Vali Acc: 0.249 Test Loss: 4.195 Test Acc: 0.249
Validation loss decreased (-0.244665 --> -0.249370).  Saving model ...
Epoch: 66 cost time: 0.5104966163635254
Epoch: 66, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.213 Vali Acc: 0.245 Test Loss: 4.213 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5457367897033691
Epoch: 67, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.219 Vali Acc: 0.244 Test Loss: 4.219 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6091115474700928
Epoch: 68, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.235 Vali Acc: 0.248 Test Loss: 4.235 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.4803040027618408
Epoch: 69, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.270 Vali Acc: 0.240 Test Loss: 4.270 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5374081134796143
Epoch: 70, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.285 Vali Acc: 0.246 Test Loss: 4.285 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.5187697410583496
Epoch: 71, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.284 Vali Acc: 0.251 Test Loss: 4.284 Test Acc: 0.251
Validation loss decreased (-0.249370 --> -0.250545).  Saving model ...
Epoch: 72 cost time: 0.4906952381134033
Epoch: 72, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.305 Vali Acc: 0.252 Test Loss: 4.305 Test Acc: 0.252
Validation loss decreased (-0.250545 --> -0.251722).  Saving model ...
Epoch: 73 cost time: 0.4959297180175781
Epoch: 73, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.309 Vali Acc: 0.252 Test Loss: 4.309 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5089046955108643
Epoch: 74, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.331 Vali Acc: 0.249 Test Loss: 4.331 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.4490203857421875
Epoch: 75, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.345 Vali Acc: 0.252 Test Loss: 4.345 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.4098670482635498
Epoch: 76, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.353 Vali Acc: 0.245 Test Loss: 4.353 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.502044677734375
Epoch: 77, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.368 Vali Acc: 0.246 Test Loss: 4.368 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5383048057556152
Epoch: 78, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.384 Vali Acc: 0.246 Test Loss: 4.384 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5270347595214844
Epoch: 79, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.384 Vali Acc: 0.246 Test Loss: 4.384 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.4971749782562256
Epoch: 80, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.396 Vali Acc: 0.247 Test Loss: 4.396 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.4896266460418701
Epoch: 81, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.400 Vali Acc: 0.248 Test Loss: 4.400 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.5058295726776123
Epoch: 82, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.392 Vali Acc: 0.247 Test Loss: 4.392 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 49178
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4985740184783936
Epoch: 1, Steps: 10 | Train Loss: 3.519 Vali Loss: 3.373 Vali Acc: 0.039 Test Loss: 3.373 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5340228080749512
Epoch: 2, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.360 Vali Acc: 0.049 Test Loss: 3.360 Test Acc: 0.049
Validation loss decreased (-0.038790 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.5324959754943848
Epoch: 3, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.349 Vali Acc: 0.053 Test Loss: 3.349 Test Acc: 0.053
Validation loss decreased (-0.049378 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.49202752113342285
Epoch: 4, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.336 Vali Acc: 0.055 Test Loss: 3.336 Test Acc: 0.055
Validation loss decreased (-0.052908 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.5479905605316162
Epoch: 5, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.324 Vali Acc: 0.065 Test Loss: 3.324 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 0.48314547538757324
Epoch: 6, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.316 Vali Acc: 0.067 Test Loss: 3.316 Test Acc: 0.067
Validation loss decreased (-0.064673 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.5222866535186768
Epoch: 7, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.310 Vali Acc: 0.074 Test Loss: 3.310 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 8 cost time: 0.5250422954559326
Epoch: 8, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.300 Vali Acc: 0.081 Test Loss: 3.300 Test Acc: 0.081
Validation loss decreased (-0.074085 --> -0.081143).  Saving model ...
Epoch: 9 cost time: 0.5170795917510986
Epoch: 9, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.293 Vali Acc: 0.088 Test Loss: 3.293 Test Acc: 0.088
Validation loss decreased (-0.081143 --> -0.088202).  Saving model ...
Epoch: 10 cost time: 0.5331082344055176
Epoch: 10, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.290 Vali Acc: 0.091 Test Loss: 3.290 Test Acc: 0.091
Validation loss decreased (-0.088202 --> -0.090555).  Saving model ...
Epoch: 11 cost time: 0.650303840637207
Epoch: 11, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.287 Vali Acc: 0.093 Test Loss: 3.287 Test Acc: 0.093
Validation loss decreased (-0.090555 --> -0.092908).  Saving model ...
Epoch: 12 cost time: 0.5264348983764648
Epoch: 12, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.285 Vali Acc: 0.096 Test Loss: 3.285 Test Acc: 0.096
Validation loss decreased (-0.092908 --> -0.096438).  Saving model ...
Epoch: 13 cost time: 0.49476099014282227
Epoch: 13, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.280 Vali Acc: 0.105 Test Loss: 3.280 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 14 cost time: 0.6413264274597168
Epoch: 14, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.277 Vali Acc: 0.113 Test Loss: 3.277 Test Acc: 0.113
Validation loss decreased (-0.104673 --> -0.112908).  Saving model ...
Epoch: 15 cost time: 0.5056312084197998
Epoch: 15, Steps: 10 | Train Loss: 2.227 Vali Loss: 3.271 Vali Acc: 0.120 Test Loss: 3.271 Test Acc: 0.120
Validation loss decreased (-0.112908 --> -0.119967).  Saving model ...
Epoch: 16 cost time: 0.4697694778442383
Epoch: 16, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.264 Vali Acc: 0.129 Test Loss: 3.264 Test Acc: 0.129
Validation loss decreased (-0.119967 --> -0.129379).  Saving model ...
Epoch: 17 cost time: 0.50942063331604
Epoch: 17, Steps: 10 | Train Loss: 2.101 Vali Loss: 3.270 Vali Acc: 0.138 Test Loss: 3.270 Test Acc: 0.138
Validation loss decreased (-0.129379 --> -0.137614).  Saving model ...
Epoch: 18 cost time: 0.5368165969848633
Epoch: 18, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.267 Vali Acc: 0.147 Test Loss: 3.267 Test Acc: 0.147
Validation loss decreased (-0.137614 --> -0.147026).  Saving model ...
Epoch: 19 cost time: 0.4804115295410156
Epoch: 19, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.274 Vali Acc: 0.148 Test Loss: 3.274 Test Acc: 0.148
Validation loss decreased (-0.147026 --> -0.148203).  Saving model ...
Epoch: 20 cost time: 0.5114364624023438
Epoch: 20, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.284 Vali Acc: 0.155 Test Loss: 3.284 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155261).  Saving model ...
Epoch: 21 cost time: 0.511695146560669
Epoch: 21, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.290 Vali Acc: 0.160 Test Loss: 3.290 Test Acc: 0.160
Validation loss decreased (-0.155261 --> -0.159967).  Saving model ...
Epoch: 22 cost time: 0.47975945472717285
Epoch: 22, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.306 Vali Acc: 0.158 Test Loss: 3.306 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5513172149658203
Epoch: 23, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.323 Vali Acc: 0.159 Test Loss: 3.323 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4970088005065918
Epoch: 24, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.327 Vali Acc: 0.168 Test Loss: 3.327 Test Acc: 0.168
Validation loss decreased (-0.159967 --> -0.168202).  Saving model ...
Epoch: 25 cost time: 0.4693868160247803
Epoch: 25, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.334 Vali Acc: 0.179 Test Loss: 3.334 Test Acc: 0.179
Validation loss decreased (-0.168202 --> -0.178790).  Saving model ...
Epoch: 26 cost time: 0.5218760967254639
Epoch: 26, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.352 Vali Acc: 0.184 Test Loss: 3.352 Test Acc: 0.184
Validation loss decreased (-0.178790 --> -0.183496).  Saving model ...
Epoch: 27 cost time: 0.5357046127319336
Epoch: 27, Steps: 10 | Train Loss: 1.153 Vali Loss: 3.360 Vali Acc: 0.189 Test Loss: 3.360 Test Acc: 0.189
Validation loss decreased (-0.183496 --> -0.189378).  Saving model ...
Epoch: 28 cost time: 0.5450234413146973
Epoch: 28, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.383 Vali Acc: 0.195 Test Loss: 3.383 Test Acc: 0.195
Validation loss decreased (-0.189378 --> -0.195260).  Saving model ...
Epoch: 29 cost time: 0.4767920970916748
Epoch: 29, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.392 Vali Acc: 0.199 Test Loss: 3.392 Test Acc: 0.199
Validation loss decreased (-0.195260 --> -0.198790).  Saving model ...
Epoch: 30 cost time: 0.5236167907714844
Epoch: 30, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.413 Vali Acc: 0.204 Test Loss: 3.413 Test Acc: 0.204
Validation loss decreased (-0.198790 --> -0.203495).  Saving model ...
Epoch: 31 cost time: 0.5462441444396973
Epoch: 31, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.446 Vali Acc: 0.201 Test Loss: 3.446 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5050370693206787
Epoch: 32, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.462 Vali Acc: 0.209 Test Loss: 3.462 Test Acc: 0.209
Validation loss decreased (-0.203495 --> -0.209377).  Saving model ...
Epoch: 33 cost time: 0.508967399597168
Epoch: 33, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.462 Vali Acc: 0.220 Test Loss: 3.462 Test Acc: 0.220
Validation loss decreased (-0.209377 --> -0.219965).  Saving model ...
Epoch: 34 cost time: 0.5143654346466064
Epoch: 34, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.486 Vali Acc: 0.224 Test Loss: 3.486 Test Acc: 0.224
Validation loss decreased (-0.219965 --> -0.223495).  Saving model ...
Epoch: 35 cost time: 0.5247464179992676
Epoch: 35, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.508 Vali Acc: 0.221 Test Loss: 3.508 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5139343738555908
Epoch: 36, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.560 Vali Acc: 0.227 Test Loss: 3.560 Test Acc: 0.227
Validation loss decreased (-0.223495 --> -0.227023).  Saving model ...
Epoch: 37 cost time: 0.5258772373199463
Epoch: 37, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.552 Vali Acc: 0.229 Test Loss: 3.552 Test Acc: 0.229
Validation loss decreased (-0.227023 --> -0.229376).  Saving model ...
Epoch: 38 cost time: 0.4886150360107422
Epoch: 38, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.564 Vali Acc: 0.226 Test Loss: 3.564 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5062048435211182
Epoch: 39, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.578 Vali Acc: 0.224 Test Loss: 3.578 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.48474550247192383
Epoch: 40, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.610 Vali Acc: 0.226 Test Loss: 3.610 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5193147659301758
Epoch: 41, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.644 Vali Acc: 0.228 Test Loss: 3.644 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5761492252349854
Epoch: 42, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.657 Vali Acc: 0.232 Test Loss: 3.657 Test Acc: 0.232
Validation loss decreased (-0.229376 --> -0.231728).  Saving model ...
Epoch: 43 cost time: 0.5444657802581787
Epoch: 43, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.694 Vali Acc: 0.231 Test Loss: 3.694 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5242657661437988
Epoch: 44, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.691 Vali Acc: 0.236 Test Loss: 3.691 Test Acc: 0.236
Validation loss decreased (-0.231728 --> -0.236434).  Saving model ...
Epoch: 45 cost time: 0.5141375064849854
Epoch: 45, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.703 Vali Acc: 0.239 Test Loss: 3.703 Test Acc: 0.239
Validation loss decreased (-0.236434 --> -0.238786).  Saving model ...
Epoch: 46 cost time: 0.5167801380157471
Epoch: 46, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.720 Vali Acc: 0.235 Test Loss: 3.720 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5342259407043457
Epoch: 47, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.737 Vali Acc: 0.238 Test Loss: 3.737 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5114879608154297
Epoch: 48, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.755 Vali Acc: 0.239 Test Loss: 3.755 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5332581996917725
Epoch: 49, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.773 Vali Acc: 0.240 Test Loss: 3.773 Test Acc: 0.240
Validation loss decreased (-0.238786 --> -0.239962).  Saving model ...
Epoch: 50 cost time: 0.46646928787231445
Epoch: 50, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.796 Vali Acc: 0.241 Test Loss: 3.796 Test Acc: 0.241
Validation loss decreased (-0.239962 --> -0.241139).  Saving model ...
Epoch: 51 cost time: 0.5098578929901123
Epoch: 51, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.816 Vali Acc: 0.239 Test Loss: 3.816 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.45586061477661133
Epoch: 52, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.810 Vali Acc: 0.235 Test Loss: 3.810 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5502133369445801
Epoch: 53, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.831 Vali Acc: 0.239 Test Loss: 3.831 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5002691745758057
Epoch: 54, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.846 Vali Acc: 0.246 Test Loss: 3.846 Test Acc: 0.246
Validation loss decreased (-0.241139 --> -0.245844).  Saving model ...
Epoch: 55 cost time: 0.5685710906982422
Epoch: 55, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.866 Vali Acc: 0.247 Test Loss: 3.866 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247020).  Saving model ...
Epoch: 56 cost time: 0.5036163330078125
Epoch: 56, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.860 Vali Acc: 0.253 Test Loss: 3.860 Test Acc: 0.253
Validation loss decreased (-0.247020 --> -0.252903).  Saving model ...
Epoch: 57 cost time: 0.4872395992279053
Epoch: 57, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.888 Vali Acc: 0.252 Test Loss: 3.888 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.497434139251709
Epoch: 58, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.888 Vali Acc: 0.251 Test Loss: 3.888 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5050759315490723
Epoch: 59, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.903 Vali Acc: 0.255 Test Loss: 3.903 Test Acc: 0.255
Validation loss decreased (-0.252903 --> -0.255255).  Saving model ...
Epoch: 60 cost time: 0.4896986484527588
Epoch: 60, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.925 Vali Acc: 0.253 Test Loss: 3.925 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5303745269775391
Epoch: 61, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.939 Vali Acc: 0.249 Test Loss: 3.939 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.514052152633667
Epoch: 62, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.934 Vali Acc: 0.256 Test Loss: 3.934 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256431).  Saving model ...
Epoch: 63 cost time: 0.4924767017364502
Epoch: 63, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.962 Vali Acc: 0.256 Test Loss: 3.962 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5140326023101807
Epoch: 64, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.966 Vali Acc: 0.253 Test Loss: 3.966 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5123825073242188
Epoch: 65, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.978 Vali Acc: 0.255 Test Loss: 3.978 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.4805467128753662
Epoch: 66, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.994 Vali Acc: 0.256 Test Loss: 3.994 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5039749145507812
Epoch: 67, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.009 Vali Acc: 0.254 Test Loss: 4.009 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.4979114532470703
Epoch: 68, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.029 Vali Acc: 0.248 Test Loss: 4.029 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.5809378623962402
Epoch: 69, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.033 Vali Acc: 0.251 Test Loss: 4.033 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.559748649597168
Epoch: 70, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.033 Vali Acc: 0.254 Test Loss: 4.033 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.5053141117095947
Epoch: 71, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.024 Vali Acc: 0.259 Test Loss: 4.024 Test Acc: 0.259
Validation loss decreased (-0.256431 --> -0.258783).  Saving model ...
Epoch: 72 cost time: 0.5590794086456299
Epoch: 72, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.025 Vali Acc: 0.258 Test Loss: 4.025 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.48154568672180176
Epoch: 73, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.055 Vali Acc: 0.253 Test Loss: 4.055 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5253593921661377
Epoch: 74, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.058 Vali Acc: 0.253 Test Loss: 4.058 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5052664279937744
Epoch: 75, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.066 Vali Acc: 0.249 Test Loss: 4.066 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.616478443145752
Epoch: 76, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.078 Vali Acc: 0.252 Test Loss: 4.078 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.5353798866271973
Epoch: 77, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.087 Vali Acc: 0.252 Test Loss: 4.087 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.42885327339172363
Epoch: 78, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.095 Vali Acc: 0.254 Test Loss: 4.095 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5245223045349121
Epoch: 79, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.109 Vali Acc: 0.258 Test Loss: 4.109 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.5649781227111816
Epoch: 80, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.123 Vali Acc: 0.255 Test Loss: 4.123 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.5374159812927246
Epoch: 81, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.131 Vali Acc: 0.260 Test Loss: 4.131 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259959).  Saving model ...
Epoch: 82 cost time: 0.5213818550109863
Epoch: 82, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.134 Vali Acc: 0.259 Test Loss: 4.134 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.64422607421875
Epoch: 83, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.135 Vali Acc: 0.256 Test Loss: 4.135 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.5505406856536865
Epoch: 84, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.147 Vali Acc: 0.258 Test Loss: 4.147 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.5459318161010742
Epoch: 85, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.159 Vali Acc: 0.260 Test Loss: 4.159 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.5344841480255127
Epoch: 86, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.174 Vali Acc: 0.261 Test Loss: 4.174 Test Acc: 0.261
Validation loss decreased (-0.259959 --> -0.261135).  Saving model ...
Epoch: 87 cost time: 0.4981701374053955
Epoch: 87, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.190 Vali Acc: 0.259 Test Loss: 4.190 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.4622948169708252
Epoch: 88, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.195 Vali Acc: 0.260 Test Loss: 4.195 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.5112466812133789
Epoch: 89, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.195 Vali Acc: 0.265 Test Loss: 4.195 Test Acc: 0.265
Validation loss decreased (-0.261135 --> -0.264664).  Saving model ...
Epoch: 90 cost time: 0.538330078125
Epoch: 90, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.220 Vali Acc: 0.259 Test Loss: 4.220 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.5175719261169434
Epoch: 91, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.232 Vali Acc: 0.255 Test Loss: 4.232 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.531280517578125
Epoch: 92, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.237 Vali Acc: 0.259 Test Loss: 4.237 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.5386512279510498
Epoch: 93, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.250 Vali Acc: 0.262 Test Loss: 4.250 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.5374350547790527
Epoch: 94, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.246 Vali Acc: 0.261 Test Loss: 4.246 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.5347869396209717
Epoch: 95, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.276 Vali Acc: 0.259 Test Loss: 4.276 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.5056898593902588
Epoch: 96, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.302 Vali Acc: 0.258 Test Loss: 4.302 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.5181355476379395
Epoch: 97, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.320 Vali Acc: 0.260 Test Loss: 4.320 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.5722496509552002
Epoch: 98, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.315 Vali Acc: 0.256 Test Loss: 4.315 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.5090739727020264
Epoch: 99, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.319 Vali Acc: 0.255 Test Loss: 4.319 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm32_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 46906
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3844223022460938
Epoch: 1, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.344 Vali Acc: 0.035 Test Loss: 3.344 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5092127323150635
Epoch: 2, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.348 Vali Acc: 0.039 Test Loss: 3.348 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.4934499263763428
Epoch: 3, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.380 Vali Acc: 0.053 Test Loss: 3.380 Test Acc: 0.053
Validation loss decreased (-0.038790 --> -0.052907).  Saving model ...
Epoch: 4 cost time: 0.4937245845794678
Epoch: 4, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.347 Vali Acc: 0.076 Test Loss: 3.347 Test Acc: 0.076
Validation loss decreased (-0.052907 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.5175435543060303
Epoch: 5, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.310 Vali Acc: 0.092 Test Loss: 3.310 Test Acc: 0.092
Validation loss decreased (-0.076437 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.5159850120544434
Epoch: 6, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.267 Vali Acc: 0.115 Test Loss: 3.267 Test Acc: 0.115
Validation loss decreased (-0.091732 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 0.512805700302124
Epoch: 7, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.234 Vali Acc: 0.129 Test Loss: 3.234 Test Acc: 0.129
Validation loss decreased (-0.115261 --> -0.129379).  Saving model ...
Epoch: 8 cost time: 0.5194199085235596
Epoch: 8, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.232 Vali Acc: 0.148 Test Loss: 3.232 Test Acc: 0.148
Validation loss decreased (-0.129379 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.48913049697875977
Epoch: 9, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.275 Vali Acc: 0.149 Test Loss: 3.275 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149379).  Saving model ...
Epoch: 10 cost time: 0.5447835922241211
Epoch: 10, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.229 Vali Acc: 0.184 Test Loss: 3.229 Test Acc: 0.184
Validation loss decreased (-0.149379 --> -0.183497).  Saving model ...
Epoch: 11 cost time: 0.5176079273223877
Epoch: 11, Steps: 10 | Train Loss: 1.415 Vali Loss: 3.264 Vali Acc: 0.185 Test Loss: 3.264 Test Acc: 0.185
Validation loss decreased (-0.183497 --> -0.184673).  Saving model ...
Epoch: 12 cost time: 0.5284280776977539
Epoch: 12, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.294 Vali Acc: 0.199 Test Loss: 3.294 Test Acc: 0.199
Validation loss decreased (-0.184673 --> -0.198791).  Saving model ...
Epoch: 13 cost time: 0.5167546272277832
Epoch: 13, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.337 Vali Acc: 0.209 Test Loss: 3.337 Test Acc: 0.209
Validation loss decreased (-0.198791 --> -0.209378).  Saving model ...
Epoch: 14 cost time: 0.5113210678100586
Epoch: 14, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.411 Vali Acc: 0.219 Test Loss: 3.411 Test Acc: 0.219
Validation loss decreased (-0.209378 --> -0.218789).  Saving model ...
Epoch: 15 cost time: 0.519981861114502
Epoch: 15, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.449 Vali Acc: 0.225 Test Loss: 3.449 Test Acc: 0.225
Validation loss decreased (-0.218789 --> -0.224671).  Saving model ...
Epoch: 16 cost time: 0.5277440547943115
Epoch: 16, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.466 Vali Acc: 0.235 Test Loss: 3.466 Test Acc: 0.235
Validation loss decreased (-0.224671 --> -0.235259).  Saving model ...
Epoch: 17 cost time: 0.5194981098175049
Epoch: 17, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.564 Vali Acc: 0.249 Test Loss: 3.564 Test Acc: 0.249
Validation loss decreased (-0.235259 --> -0.249376).  Saving model ...
Epoch: 18 cost time: 0.5103344917297363
Epoch: 18, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.669 Vali Acc: 0.239 Test Loss: 3.669 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.504237174987793
Epoch: 19, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.728 Vali Acc: 0.255 Test Loss: 3.728 Test Acc: 0.255
Validation loss decreased (-0.249376 --> -0.255257).  Saving model ...
Epoch: 20 cost time: 0.5633423328399658
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.800 Vali Acc: 0.245 Test Loss: 3.800 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5240936279296875
Epoch: 21, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.879 Vali Acc: 0.252 Test Loss: 3.879 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5365386009216309
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.904 Vali Acc: 0.249 Test Loss: 3.904 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.516643762588501
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.916 Vali Acc: 0.264 Test Loss: 3.916 Test Acc: 0.264
Validation loss decreased (-0.255257 --> -0.263490).  Saving model ...
Epoch: 24 cost time: 0.533419132232666
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.978 Vali Acc: 0.266 Test Loss: 3.978 Test Acc: 0.266
Validation loss decreased (-0.263490 --> -0.265843).  Saving model ...
Epoch: 25 cost time: 0.5485198497772217
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.017 Vali Acc: 0.267 Test Loss: 4.017 Test Acc: 0.267
Validation loss decreased (-0.265843 --> -0.267019).  Saving model ...
Epoch: 26 cost time: 0.5679550170898438
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.042 Vali Acc: 0.264 Test Loss: 4.042 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5629796981811523
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.079 Vali Acc: 0.269 Test Loss: 4.079 Test Acc: 0.269
Validation loss decreased (-0.267019 --> -0.269371).  Saving model ...
Epoch: 28 cost time: 0.5181443691253662
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.115 Vali Acc: 0.268 Test Loss: 4.115 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.567091703414917
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.147 Vali Acc: 0.271 Test Loss: 4.147 Test Acc: 0.271
Validation loss decreased (-0.269371 --> -0.270547).  Saving model ...
Epoch: 30 cost time: 0.5146820545196533
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.176 Vali Acc: 0.267 Test Loss: 4.176 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5549125671386719
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.189 Vali Acc: 0.269 Test Loss: 4.189 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.47325968742370605
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.238 Vali Acc: 0.264 Test Loss: 4.238 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5439989566802979
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.251 Vali Acc: 0.268 Test Loss: 4.251 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.45417046546936035
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.265 Vali Acc: 0.271 Test Loss: 4.265 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5351855754852295
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.280 Vali Acc: 0.274 Test Loss: 4.280 Test Acc: 0.274
Validation loss decreased (-0.270547 --> -0.274075).  Saving model ...
Epoch: 36 cost time: 0.5897078514099121
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.285 Vali Acc: 0.273 Test Loss: 4.285 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5336284637451172
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.303 Vali Acc: 0.273 Test Loss: 4.303 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5166435241699219
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.331 Vali Acc: 0.269 Test Loss: 4.331 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5011699199676514
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.337 Vali Acc: 0.271 Test Loss: 4.337 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5419015884399414
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.353 Vali Acc: 0.276 Test Loss: 4.353 Test Acc: 0.276
Validation loss decreased (-0.274075 --> -0.276427).  Saving model ...
Epoch: 41 cost time: 0.5188610553741455
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.385 Vali Acc: 0.274 Test Loss: 4.385 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.504429817199707
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.381 Vali Acc: 0.274 Test Loss: 4.381 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.49733614921569824
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.383 Vali Acc: 0.272 Test Loss: 4.383 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5271682739257812
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.393 Vali Acc: 0.274 Test Loss: 4.393 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5623667240142822
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.398 Vali Acc: 0.280 Test Loss: 4.398 Test Acc: 0.280
Validation loss decreased (-0.276427 --> -0.279956).  Saving model ...
Epoch: 46 cost time: 0.5297586917877197
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.418 Vali Acc: 0.278 Test Loss: 4.418 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5019478797912598
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.452 Vali Acc: 0.281 Test Loss: 4.452 Test Acc: 0.281
Validation loss decreased (-0.279956 --> -0.281132).  Saving model ...
Epoch: 48 cost time: 0.49489498138427734
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.471 Vali Acc: 0.279 Test Loss: 4.471 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5237183570861816
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.481 Vali Acc: 0.278 Test Loss: 4.481 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5235488414764404
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.492 Vali Acc: 0.281 Test Loss: 4.492 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5535292625427246
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.485 Vali Acc: 0.284 Test Loss: 4.485 Test Acc: 0.284
Validation loss decreased (-0.281132 --> -0.283485).  Saving model ...
Epoch: 52 cost time: 0.5426075458526611
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.511 Vali Acc: 0.281 Test Loss: 4.511 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5509405136108398
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.521 Vali Acc: 0.279 Test Loss: 4.521 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.540503978729248
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.530 Vali Acc: 0.280 Test Loss: 4.530 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5213809013366699
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.546 Vali Acc: 0.278 Test Loss: 4.546 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5670068264007568
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.551 Vali Acc: 0.276 Test Loss: 4.551 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5381317138671875
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.566 Vali Acc: 0.276 Test Loss: 4.566 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5418534278869629
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.578 Vali Acc: 0.278 Test Loss: 4.578 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.546837329864502
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.588 Vali Acc: 0.278 Test Loss: 4.588 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5692551136016846
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.604 Vali Acc: 0.279 Test Loss: 4.604 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.534642219543457
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.607 Vali Acc: 0.279 Test Loss: 4.607 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 123818
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5897443294525146
Epoch: 1, Steps: 10 | Train Loss: 3.438 Vali Loss: 3.361 Vali Acc: 0.049 Test Loss: 3.361 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.5094270706176758
Epoch: 2, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.328 Vali Acc: 0.028 Test Loss: 3.328 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4782533645629883
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.328 Vali Acc: 0.035 Test Loss: 3.328 Test Acc: 0.035
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5936789512634277
Epoch: 4, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.340 Vali Acc: 0.046 Test Loss: 3.340 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49825072288513184
Epoch: 5, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.340 Vali Acc: 0.055 Test Loss: 3.340 Test Acc: 0.055
Validation loss decreased (-0.049378 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.5479393005371094
Epoch: 6, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.327 Vali Acc: 0.069 Test Loss: 3.327 Test Acc: 0.069
Validation loss decreased (-0.055261 --> -0.069378).  Saving model ...
Epoch: 7 cost time: 0.5958085060119629
Epoch: 7, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.300 Vali Acc: 0.092 Test Loss: 3.300 Test Acc: 0.092
Validation loss decreased (-0.069378 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.5177133083343506
Epoch: 8, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.292 Vali Acc: 0.104 Test Loss: 3.292 Test Acc: 0.104
Validation loss decreased (-0.091732 --> -0.103496).  Saving model ...
Epoch: 9 cost time: 0.5641565322875977
Epoch: 9, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.257 Vali Acc: 0.122 Test Loss: 3.257 Test Acc: 0.122
Validation loss decreased (-0.103496 --> -0.122320).  Saving model ...
Epoch: 10 cost time: 0.5301744937896729
Epoch: 10, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.248 Vali Acc: 0.132 Test Loss: 3.248 Test Acc: 0.132
Validation loss decreased (-0.122320 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 0.5357654094696045
Epoch: 11, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.241 Vali Acc: 0.144 Test Loss: 3.241 Test Acc: 0.144
Validation loss decreased (-0.131732 --> -0.143497).  Saving model ...
Epoch: 12 cost time: 0.5166201591491699
Epoch: 12, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.235 Vali Acc: 0.155 Test Loss: 3.235 Test Acc: 0.155
Validation loss decreased (-0.143497 --> -0.155262).  Saving model ...
Epoch: 13 cost time: 0.5143897533416748
Epoch: 13, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.241 Vali Acc: 0.167 Test Loss: 3.241 Test Acc: 0.167
Validation loss decreased (-0.155262 --> -0.167026).  Saving model ...
Epoch: 14 cost time: 0.5520777702331543
Epoch: 14, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.264 Vali Acc: 0.167 Test Loss: 3.264 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5535640716552734
Epoch: 15, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.289 Vali Acc: 0.173 Test Loss: 3.289 Test Acc: 0.173
Validation loss decreased (-0.167026 --> -0.172908).  Saving model ...
Epoch: 16 cost time: 0.5397040843963623
Epoch: 16, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.304 Vali Acc: 0.196 Test Loss: 3.304 Test Acc: 0.196
Validation loss decreased (-0.172908 --> -0.196438).  Saving model ...
Epoch: 17 cost time: 0.5359969139099121
Epoch: 17, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.322 Vali Acc: 0.202 Test Loss: 3.322 Test Acc: 0.202
Validation loss decreased (-0.196438 --> -0.202320).  Saving model ...
Epoch: 18 cost time: 0.551128625869751
Epoch: 18, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.351 Vali Acc: 0.214 Test Loss: 3.351 Test Acc: 0.214
Validation loss decreased (-0.202320 --> -0.214084).  Saving model ...
Epoch: 19 cost time: 0.5340650081634521
Epoch: 19, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.381 Vali Acc: 0.216 Test Loss: 3.381 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216437).  Saving model ...
Epoch: 20 cost time: 0.5389232635498047
Epoch: 20, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.416 Vali Acc: 0.231 Test Loss: 3.416 Test Acc: 0.231
Validation loss decreased (-0.216437 --> -0.230554).  Saving model ...
Epoch: 21 cost time: 0.546623706817627
Epoch: 21, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.453 Vali Acc: 0.229 Test Loss: 3.453 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5244073867797852
Epoch: 22, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.483 Vali Acc: 0.236 Test Loss: 3.483 Test Acc: 0.236
Validation loss decreased (-0.230554 --> -0.236436).  Saving model ...
Epoch: 23 cost time: 0.5640883445739746
Epoch: 23, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.534 Vali Acc: 0.241 Test Loss: 3.534 Test Acc: 0.241
Validation loss decreased (-0.236436 --> -0.241141).  Saving model ...
Epoch: 24 cost time: 0.5455629825592041
Epoch: 24, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.574 Vali Acc: 0.241 Test Loss: 3.574 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.49483156204223633
Epoch: 25, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.598 Vali Acc: 0.248 Test Loss: 3.598 Test Acc: 0.248
Validation loss decreased (-0.241141 --> -0.248199).  Saving model ...
Epoch: 26 cost time: 0.5704362392425537
Epoch: 26, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.636 Vali Acc: 0.240 Test Loss: 3.636 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5390069484710693
Epoch: 27, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.713 Vali Acc: 0.247 Test Loss: 3.713 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5447320938110352
Epoch: 28, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.759 Vali Acc: 0.253 Test Loss: 3.759 Test Acc: 0.253
Validation loss decreased (-0.248199 --> -0.252904).  Saving model ...
Epoch: 29 cost time: 0.5397427082061768
Epoch: 29, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.766 Vali Acc: 0.252 Test Loss: 3.766 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5352838039398193
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.826 Vali Acc: 0.251 Test Loss: 3.826 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5676016807556152
Epoch: 31, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.833 Vali Acc: 0.255 Test Loss: 3.833 Test Acc: 0.255
Validation loss decreased (-0.252904 --> -0.255256).  Saving model ...
Epoch: 32 cost time: 0.5898046493530273
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.845 Vali Acc: 0.268 Test Loss: 3.845 Test Acc: 0.268
Validation loss decreased (-0.255256 --> -0.268197).  Saving model ...
Epoch: 33 cost time: 0.5525696277618408
Epoch: 33, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.894 Vali Acc: 0.260 Test Loss: 3.894 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5680735111236572
Epoch: 34, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.939 Vali Acc: 0.265 Test Loss: 3.939 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5247342586517334
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.941 Vali Acc: 0.259 Test Loss: 3.941 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5786056518554688
Epoch: 36, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.998 Vali Acc: 0.249 Test Loss: 3.998 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5557637214660645
Epoch: 37, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.033 Vali Acc: 0.258 Test Loss: 4.033 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5342352390289307
Epoch: 38, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.054 Vali Acc: 0.258 Test Loss: 4.054 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5251147747039795
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.052 Vali Acc: 0.249 Test Loss: 4.052 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.505889892578125
Epoch: 40, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.057 Vali Acc: 0.252 Test Loss: 4.057 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5206749439239502
Epoch: 41, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.081 Vali Acc: 0.261 Test Loss: 4.081 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5429120063781738
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.090 Vali Acc: 0.262 Test Loss: 4.090 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 76458
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.718538761138916
Epoch: 1, Steps: 10 | Train Loss: 3.466 Vali Loss: 3.402 Vali Acc: 0.040 Test Loss: 3.402 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.48027944564819336
Epoch: 2, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.358 Vali Acc: 0.036 Test Loss: 3.358 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.602653980255127
Epoch: 3, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.334 Vali Acc: 0.041 Test Loss: 3.334 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.5176537036895752
Epoch: 4, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.320 Vali Acc: 0.055 Test Loss: 3.320 Test Acc: 0.055
Validation loss decreased (-0.041143 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.5213305950164795
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.320 Vali Acc: 0.075 Test Loss: 3.320 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.5237131118774414
Epoch: 6, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.322 Vali Acc: 0.082 Test Loss: 3.322 Test Acc: 0.082
Validation loss decreased (-0.075261 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.501704216003418
Epoch: 7, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.315 Vali Acc: 0.087 Test Loss: 3.315 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.4788637161254883
Epoch: 8, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.303 Vali Acc: 0.098 Test Loss: 3.303 Test Acc: 0.098
Validation loss decreased (-0.087026 --> -0.097614).  Saving model ...
Epoch: 9 cost time: 0.5031416416168213
Epoch: 9, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.278 Vali Acc: 0.102 Test Loss: 3.278 Test Acc: 0.102
Validation loss decreased (-0.097614 --> -0.102320).  Saving model ...
Epoch: 10 cost time: 0.5593404769897461
Epoch: 10, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.261 Vali Acc: 0.106 Test Loss: 3.261 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.4986999034881592
Epoch: 11, Steps: 10 | Train Loss: 2.406 Vali Loss: 3.249 Vali Acc: 0.121 Test Loss: 3.249 Test Acc: 0.121
Validation loss decreased (-0.105850 --> -0.121144).  Saving model ...
Epoch: 12 cost time: 0.4868028163909912
Epoch: 12, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.235 Vali Acc: 0.128 Test Loss: 3.235 Test Acc: 0.128
Validation loss decreased (-0.121144 --> -0.128203).  Saving model ...
Epoch: 13 cost time: 0.5206153392791748
Epoch: 13, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.224 Vali Acc: 0.136 Test Loss: 3.224 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136438).  Saving model ...
Epoch: 14 cost time: 0.5403597354888916
Epoch: 14, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.210 Vali Acc: 0.142 Test Loss: 3.210 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 0.5304126739501953
Epoch: 15, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.213 Vali Acc: 0.149 Test Loss: 3.213 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 16 cost time: 0.5054581165313721
Epoch: 16, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.226 Vali Acc: 0.158 Test Loss: 3.226 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157615).  Saving model ...
Epoch: 17 cost time: 0.5098893642425537
Epoch: 17, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.231 Vali Acc: 0.159 Test Loss: 3.231 Test Acc: 0.159
Validation loss decreased (-0.157615 --> -0.158791).  Saving model ...
Epoch: 18 cost time: 0.5236093997955322
Epoch: 18, Steps: 10 | Train Loss: 1.498 Vali Loss: 3.240 Vali Acc: 0.166 Test Loss: 3.240 Test Acc: 0.166
Validation loss decreased (-0.158791 --> -0.165850).  Saving model ...
Epoch: 19 cost time: 0.4969303607940674
Epoch: 19, Steps: 10 | Train Loss: 1.333 Vali Loss: 3.258 Vali Acc: 0.180 Test Loss: 3.258 Test Acc: 0.180
Validation loss decreased (-0.165850 --> -0.179967).  Saving model ...
Epoch: 20 cost time: 0.5312633514404297
Epoch: 20, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.259 Vali Acc: 0.185 Test Loss: 3.259 Test Acc: 0.185
Validation loss decreased (-0.179967 --> -0.184673).  Saving model ...
Epoch: 21 cost time: 0.5154745578765869
Epoch: 21, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.272 Vali Acc: 0.187 Test Loss: 3.272 Test Acc: 0.187
Validation loss decreased (-0.184673 --> -0.187026).  Saving model ...
Epoch: 22 cost time: 0.5081183910369873
Epoch: 22, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.283 Vali Acc: 0.195 Test Loss: 3.283 Test Acc: 0.195
Validation loss decreased (-0.187026 --> -0.195261).  Saving model ...
Epoch: 23 cost time: 0.4994478225708008
Epoch: 23, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.302 Vali Acc: 0.196 Test Loss: 3.302 Test Acc: 0.196
Validation loss decreased (-0.195261 --> -0.196438).  Saving model ...
Epoch: 24 cost time: 0.5012812614440918
Epoch: 24, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.322 Vali Acc: 0.204 Test Loss: 3.322 Test Acc: 0.204
Validation loss decreased (-0.196438 --> -0.203496).  Saving model ...
Epoch: 25 cost time: 0.5217485427856445
Epoch: 25, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.346 Vali Acc: 0.216 Test Loss: 3.346 Test Acc: 0.216
Validation loss decreased (-0.203496 --> -0.216437).  Saving model ...
Epoch: 26 cost time: 0.48393940925598145
Epoch: 26, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.362 Vali Acc: 0.216 Test Loss: 3.362 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5083377361297607
Epoch: 27, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.375 Vali Acc: 0.226 Test Loss: 3.375 Test Acc: 0.226
Validation loss decreased (-0.216437 --> -0.225849).  Saving model ...
Epoch: 28 cost time: 0.5642411708831787
Epoch: 28, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.425 Vali Acc: 0.224 Test Loss: 3.425 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5002532005310059
Epoch: 29, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.482 Vali Acc: 0.228 Test Loss: 3.482 Test Acc: 0.228
Validation loss decreased (-0.225849 --> -0.228200).  Saving model ...
Epoch: 30 cost time: 0.5330395698547363
Epoch: 30, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.497 Vali Acc: 0.231 Test Loss: 3.497 Test Acc: 0.231
Validation loss decreased (-0.228200 --> -0.230553).  Saving model ...
Epoch: 31 cost time: 0.5707285404205322
Epoch: 31, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.521 Vali Acc: 0.225 Test Loss: 3.521 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5191187858581543
Epoch: 32, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.528 Vali Acc: 0.225 Test Loss: 3.528 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5378050804138184
Epoch: 33, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.603 Vali Acc: 0.225 Test Loss: 3.603 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5564548969268799
Epoch: 34, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.670 Vali Acc: 0.221 Test Loss: 3.670 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5876846313476562
Epoch: 35, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.670 Vali Acc: 0.229 Test Loss: 3.670 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.46761584281921387
Epoch: 36, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.674 Vali Acc: 0.226 Test Loss: 3.674 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4828362464904785
Epoch: 37, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.681 Vali Acc: 0.231 Test Loss: 3.681 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5042870044708252
Epoch: 38, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.745 Vali Acc: 0.231 Test Loss: 3.745 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5018332004547119
Epoch: 39, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.778 Vali Acc: 0.229 Test Loss: 3.778 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5235190391540527
Epoch: 40, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.784 Vali Acc: 0.231 Test Loss: 3.784 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23058823529411765
model parameter : 60298
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7103495597839355
Epoch: 1, Steps: 10 | Train Loss: 3.502 Vali Loss: 3.337 Vali Acc: 0.033 Test Loss: 3.337 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.5288307666778564
Epoch: 2, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.322 Vali Acc: 0.036 Test Loss: 3.322 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.5020463466644287
Epoch: 3, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.308 Vali Acc: 0.047 Test Loss: 3.308 Test Acc: 0.047
Validation loss decreased (-0.036437 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.5158817768096924
Epoch: 4, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.300 Vali Acc: 0.058 Test Loss: 3.300 Test Acc: 0.058
Validation loss decreased (-0.047026 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.5286407470703125
Epoch: 5, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.296 Vali Acc: 0.061 Test Loss: 3.296 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.4938802719116211
Epoch: 6, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.296 Vali Acc: 0.076 Test Loss: 3.296 Test Acc: 0.076
Validation loss decreased (-0.061144 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.559600830078125
Epoch: 7, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.300 Vali Acc: 0.085 Test Loss: 3.300 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.5547454357147217
Epoch: 8, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.292 Vali Acc: 0.093 Test Loss: 3.292 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092908).  Saving model ...
Epoch: 9 cost time: 0.523874044418335
Epoch: 9, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.288 Vali Acc: 0.098 Test Loss: 3.288 Test Acc: 0.098
Validation loss decreased (-0.092908 --> -0.097614).  Saving model ...
Epoch: 10 cost time: 0.4988703727722168
Epoch: 10, Steps: 10 | Train Loss: 2.657 Vali Loss: 3.277 Vali Acc: 0.106 Test Loss: 3.277 Test Acc: 0.106
Validation loss decreased (-0.097614 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.5597827434539795
Epoch: 11, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.267 Vali Acc: 0.105 Test Loss: 3.267 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5098810195922852
Epoch: 12, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.254 Vali Acc: 0.118 Test Loss: 3.254 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.46968722343444824
Epoch: 13, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.247 Vali Acc: 0.131 Test Loss: 3.247 Test Acc: 0.131
Validation loss decreased (-0.117615 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 0.5063226222991943
Epoch: 14, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.239 Vali Acc: 0.134 Test Loss: 3.239 Test Acc: 0.134
Validation loss decreased (-0.130556 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.5236349105834961
Epoch: 15, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.240 Vali Acc: 0.145 Test Loss: 3.240 Test Acc: 0.145
Validation loss decreased (-0.134085 --> -0.144673).  Saving model ...
Epoch: 16 cost time: 0.5018236637115479
Epoch: 16, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.228 Vali Acc: 0.149 Test Loss: 3.228 Test Acc: 0.149
Validation loss decreased (-0.144673 --> -0.149379).  Saving model ...
Epoch: 17 cost time: 0.5315408706665039
Epoch: 17, Steps: 10 | Train Loss: 1.922 Vali Loss: 3.227 Vali Acc: 0.164 Test Loss: 3.227 Test Acc: 0.164
Validation loss decreased (-0.149379 --> -0.163497).  Saving model ...
Epoch: 18 cost time: 0.45952463150024414
Epoch: 18, Steps: 10 | Train Loss: 1.779 Vali Loss: 3.226 Vali Acc: 0.165 Test Loss: 3.226 Test Acc: 0.165
Validation loss decreased (-0.163497 --> -0.164674).  Saving model ...
Epoch: 19 cost time: 0.4577512741088867
Epoch: 19, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.234 Vali Acc: 0.166 Test Loss: 3.234 Test Acc: 0.166
Validation loss decreased (-0.164674 --> -0.165850).  Saving model ...
Epoch: 20 cost time: 0.5157382488250732
Epoch: 20, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.242 Vali Acc: 0.175 Test Loss: 3.242 Test Acc: 0.175
Validation loss decreased (-0.165850 --> -0.175262).  Saving model ...
Epoch: 21 cost time: 0.5242409706115723
Epoch: 21, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.253 Vali Acc: 0.189 Test Loss: 3.253 Test Acc: 0.189
Validation loss decreased (-0.175262 --> -0.189379).  Saving model ...
Epoch: 22 cost time: 0.5370945930480957
Epoch: 22, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.263 Vali Acc: 0.188 Test Loss: 3.263 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.48772406578063965
Epoch: 23, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.279 Vali Acc: 0.206 Test Loss: 3.279 Test Acc: 0.206
Validation loss decreased (-0.189379 --> -0.205850).  Saving model ...
Epoch: 24 cost time: 0.48072218894958496
Epoch: 24, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.292 Vali Acc: 0.209 Test Loss: 3.292 Test Acc: 0.209
Validation loss decreased (-0.205850 --> -0.209379).  Saving model ...
Epoch: 25 cost time: 0.5135140419006348
Epoch: 25, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.305 Vali Acc: 0.221 Test Loss: 3.305 Test Acc: 0.221
Validation loss decreased (-0.209379 --> -0.221143).  Saving model ...
Epoch: 26 cost time: 0.4805278778076172
Epoch: 26, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.303 Vali Acc: 0.225 Test Loss: 3.303 Test Acc: 0.225
Validation loss decreased (-0.221143 --> -0.224673).  Saving model ...
Epoch: 27 cost time: 0.5257554054260254
Epoch: 27, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.325 Vali Acc: 0.225 Test Loss: 3.325 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5040311813354492
Epoch: 28, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.350 Vali Acc: 0.226 Test Loss: 3.350 Test Acc: 0.226
Validation loss decreased (-0.224673 --> -0.225849).  Saving model ...
Epoch: 29 cost time: 0.5276784896850586
Epoch: 29, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.368 Vali Acc: 0.235 Test Loss: 3.368 Test Acc: 0.235
Validation loss decreased (-0.225849 --> -0.235260).  Saving model ...
Epoch: 30 cost time: 0.5344498157501221
Epoch: 30, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.391 Vali Acc: 0.235 Test Loss: 3.391 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5129213333129883
Epoch: 31, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.418 Vali Acc: 0.236 Test Loss: 3.418 Test Acc: 0.236
Validation loss decreased (-0.235260 --> -0.236436).  Saving model ...
Epoch: 32 cost time: 0.49959588050842285
Epoch: 32, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.429 Vali Acc: 0.234 Test Loss: 3.429 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5371303558349609
Epoch: 33, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.465 Vali Acc: 0.245 Test Loss: 3.465 Test Acc: 0.245
Validation loss decreased (-0.236436 --> -0.244671).  Saving model ...
Epoch: 34 cost time: 0.507300853729248
Epoch: 34, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.492 Vali Acc: 0.245 Test Loss: 3.492 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.558307409286499
Epoch: 35, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.524 Vali Acc: 0.242 Test Loss: 3.524 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5235555171966553
Epoch: 36, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.516 Vali Acc: 0.244 Test Loss: 3.516 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5796773433685303
Epoch: 37, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.545 Vali Acc: 0.249 Test Loss: 3.545 Test Acc: 0.249
Validation loss decreased (-0.244671 --> -0.249376).  Saving model ...
Epoch: 38 cost time: 0.5277678966522217
Epoch: 38, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.576 Vali Acc: 0.247 Test Loss: 3.576 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.532057523727417
Epoch: 39, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.577 Vali Acc: 0.244 Test Loss: 3.577 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5712223052978516
Epoch: 40, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.637 Vali Acc: 0.245 Test Loss: 3.637 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5362968444824219
Epoch: 41, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.657 Vali Acc: 0.245 Test Loss: 3.657 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5207643508911133
Epoch: 42, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.711 Vali Acc: 0.244 Test Loss: 3.711 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6428380012512207
Epoch: 43, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.688 Vali Acc: 0.249 Test Loss: 3.688 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.47419261932373047
Epoch: 44, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.720 Vali Acc: 0.248 Test Loss: 3.720 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.533954381942749
Epoch: 45, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.748 Vali Acc: 0.246 Test Loss: 3.748 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5620641708374023
Epoch: 46, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.750 Vali Acc: 0.242 Test Loss: 3.750 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5724186897277832
Epoch: 47, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.779 Vali Acc: 0.247 Test Loss: 3.779 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 52874
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.527669906616211
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.367 Vali Acc: 0.052 Test Loss: 3.367 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.46394777297973633
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.355 Vali Acc: 0.051 Test Loss: 3.355 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46885085105895996
Epoch: 3, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.346 Vali Acc: 0.053 Test Loss: 3.346 Test Acc: 0.053
Validation loss decreased (-0.051731 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.4849553108215332
Epoch: 4, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.338 Vali Acc: 0.053 Test Loss: 3.338 Test Acc: 0.053
Validation loss decreased (-0.052908 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.5033044815063477
Epoch: 5, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.330 Vali Acc: 0.059 Test Loss: 3.330 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 0.544764518737793
Epoch: 6, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.324 Vali Acc: 0.060 Test Loss: 3.324 Test Acc: 0.060
Validation loss decreased (-0.058790 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.505845308303833
Epoch: 7, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.313 Vali Acc: 0.072 Test Loss: 3.313 Test Acc: 0.072
Validation loss decreased (-0.059967 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 0.48183465003967285
Epoch: 8, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.307 Vali Acc: 0.075 Test Loss: 3.307 Test Acc: 0.075
Validation loss decreased (-0.071732 --> -0.075261).  Saving model ...
Epoch: 9 cost time: 0.5635623931884766
Epoch: 9, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.298 Vali Acc: 0.079 Test Loss: 3.298 Test Acc: 0.079
Validation loss decreased (-0.075261 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.5225424766540527
Epoch: 10, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.293 Vali Acc: 0.082 Test Loss: 3.293 Test Acc: 0.082
Validation loss decreased (-0.078791 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 0.5131409168243408
Epoch: 11, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.289 Vali Acc: 0.100 Test Loss: 3.289 Test Acc: 0.100
Validation loss decreased (-0.082320 --> -0.099967).  Saving model ...
Epoch: 12 cost time: 0.542543888092041
Epoch: 12, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.281 Vali Acc: 0.096 Test Loss: 3.281 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49372196197509766
Epoch: 13, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.274 Vali Acc: 0.105 Test Loss: 3.274 Test Acc: 0.105
Validation loss decreased (-0.099967 --> -0.104673).  Saving model ...
Epoch: 14 cost time: 0.5200057029724121
Epoch: 14, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.264 Vali Acc: 0.107 Test Loss: 3.264 Test Acc: 0.107
Validation loss decreased (-0.104673 --> -0.107026).  Saving model ...
Epoch: 15 cost time: 0.5170254707336426
Epoch: 15, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.259 Vali Acc: 0.115 Test Loss: 3.259 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115262).  Saving model ...
Epoch: 16 cost time: 0.4798579216003418
Epoch: 16, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.251 Vali Acc: 0.119 Test Loss: 3.251 Test Acc: 0.119
Validation loss decreased (-0.115262 --> -0.118791).  Saving model ...
Epoch: 17 cost time: 0.48583269119262695
Epoch: 17, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.240 Vali Acc: 0.127 Test Loss: 3.240 Test Acc: 0.127
Validation loss decreased (-0.118791 --> -0.127026).  Saving model ...
Epoch: 18 cost time: 0.4857022762298584
Epoch: 18, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.231 Vali Acc: 0.129 Test Loss: 3.231 Test Acc: 0.129
Validation loss decreased (-0.127026 --> -0.129379).  Saving model ...
Epoch: 19 cost time: 0.5076403617858887
Epoch: 19, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.232 Vali Acc: 0.133 Test Loss: 3.232 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 20 cost time: 0.47590017318725586
Epoch: 20, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.225 Vali Acc: 0.135 Test Loss: 3.225 Test Acc: 0.135
Validation loss decreased (-0.132909 --> -0.135262).  Saving model ...
Epoch: 21 cost time: 0.5286436080932617
Epoch: 21, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.228 Vali Acc: 0.138 Test Loss: 3.228 Test Acc: 0.138
Validation loss decreased (-0.135262 --> -0.137615).  Saving model ...
Epoch: 22 cost time: 0.5728127956390381
Epoch: 22, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.231 Vali Acc: 0.142 Test Loss: 3.231 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 23 cost time: 0.46708011627197266
Epoch: 23, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.240 Vali Acc: 0.149 Test Loss: 3.240 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149379).  Saving model ...
Epoch: 24 cost time: 0.4632070064544678
Epoch: 24, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.242 Vali Acc: 0.158 Test Loss: 3.242 Test Acc: 0.158
Validation loss decreased (-0.149379 --> -0.157615).  Saving model ...
Epoch: 25 cost time: 0.4556922912597656
Epoch: 25, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.254 Vali Acc: 0.158 Test Loss: 3.254 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5389435291290283
Epoch: 26, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.264 Vali Acc: 0.162 Test Loss: 3.264 Test Acc: 0.162
Validation loss decreased (-0.157615 --> -0.162320).  Saving model ...
Epoch: 27 cost time: 0.5230042934417725
Epoch: 27, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.268 Vali Acc: 0.160 Test Loss: 3.268 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.525681734085083
Epoch: 28, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.270 Vali Acc: 0.159 Test Loss: 3.270 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4936697483062744
Epoch: 29, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.279 Vali Acc: 0.168 Test Loss: 3.279 Test Acc: 0.168
Validation loss decreased (-0.162320 --> -0.168203).  Saving model ...
Epoch: 30 cost time: 0.49199748039245605
Epoch: 30, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.294 Vali Acc: 0.173 Test Loss: 3.294 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172908).  Saving model ...
Epoch: 31 cost time: 0.5329077243804932
Epoch: 31, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.300 Vali Acc: 0.175 Test Loss: 3.300 Test Acc: 0.175
Validation loss decreased (-0.172908 --> -0.175261).  Saving model ...
Epoch: 32 cost time: 0.49534034729003906
Epoch: 32, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.319 Vali Acc: 0.172 Test Loss: 3.319 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5174274444580078
Epoch: 33, Steps: 10 | Train Loss: 1.035 Vali Loss: 3.314 Vali Acc: 0.179 Test Loss: 3.314 Test Acc: 0.179
Validation loss decreased (-0.175261 --> -0.178790).  Saving model ...
Epoch: 34 cost time: 0.4808216094970703
Epoch: 34, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.341 Vali Acc: 0.185 Test Loss: 3.341 Test Acc: 0.185
Validation loss decreased (-0.178790 --> -0.184672).  Saving model ...
Epoch: 35 cost time: 0.4999570846557617
Epoch: 35, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.355 Vali Acc: 0.192 Test Loss: 3.355 Test Acc: 0.192
Validation loss decreased (-0.184672 --> -0.191731).  Saving model ...
Epoch: 36 cost time: 0.4662022590637207
Epoch: 36, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.368 Vali Acc: 0.189 Test Loss: 3.368 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4594759941101074
Epoch: 37, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.404 Vali Acc: 0.188 Test Loss: 3.404 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5123722553253174
Epoch: 38, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.406 Vali Acc: 0.187 Test Loss: 3.406 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.48195838928222656
Epoch: 39, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.408 Vali Acc: 0.195 Test Loss: 3.408 Test Acc: 0.195
Validation loss decreased (-0.191731 --> -0.195260).  Saving model ...
Epoch: 40 cost time: 0.4451711177825928
Epoch: 40, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.422 Vali Acc: 0.195 Test Loss: 3.422 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5791850090026855
Epoch: 41, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.449 Vali Acc: 0.204 Test Loss: 3.449 Test Acc: 0.204
Validation loss decreased (-0.195260 --> -0.203495).  Saving model ...
Epoch: 42 cost time: 0.45511579513549805
Epoch: 42, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.481 Vali Acc: 0.207 Test Loss: 3.481 Test Acc: 0.207
Validation loss decreased (-0.203495 --> -0.207024).  Saving model ...
Epoch: 43 cost time: 0.4731111526489258
Epoch: 43, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.500 Vali Acc: 0.206 Test Loss: 3.500 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4884781837463379
Epoch: 44, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.515 Vali Acc: 0.204 Test Loss: 3.515 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.530663013458252
Epoch: 45, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.533 Vali Acc: 0.208 Test Loss: 3.533 Test Acc: 0.208
Validation loss decreased (-0.207024 --> -0.208200).  Saving model ...
Epoch: 46 cost time: 0.4867691993713379
Epoch: 46, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.551 Vali Acc: 0.213 Test Loss: 3.551 Test Acc: 0.213
Validation loss decreased (-0.208200 --> -0.212906).  Saving model ...
Epoch: 47 cost time: 0.5365447998046875
Epoch: 47, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.581 Vali Acc: 0.211 Test Loss: 3.581 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5303874015808105
Epoch: 48, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.589 Vali Acc: 0.214 Test Loss: 3.589 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214082).  Saving model ...
Epoch: 49 cost time: 0.5085318088531494
Epoch: 49, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.593 Vali Acc: 0.228 Test Loss: 3.593 Test Acc: 0.228
Validation loss decreased (-0.214082 --> -0.228199).  Saving model ...
Epoch: 50 cost time: 0.5175609588623047
Epoch: 50, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.612 Vali Acc: 0.229 Test Loss: 3.612 Test Acc: 0.229
Validation loss decreased (-0.228199 --> -0.229376).  Saving model ...
Epoch: 51 cost time: 0.5192978382110596
Epoch: 51, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.609 Vali Acc: 0.229 Test Loss: 3.609 Test Acc: 0.229
Validation loss decreased (-0.229376 --> -0.229376).  Saving model ...
Epoch: 52 cost time: 0.541053056716919
Epoch: 52, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.617 Vali Acc: 0.225 Test Loss: 3.617 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5074717998504639
Epoch: 53, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.643 Vali Acc: 0.231 Test Loss: 3.643 Test Acc: 0.231
Validation loss decreased (-0.229376 --> -0.230552).  Saving model ...
Epoch: 54 cost time: 0.5119912624359131
Epoch: 54, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.663 Vali Acc: 0.234 Test Loss: 3.663 Test Acc: 0.234
Validation loss decreased (-0.230552 --> -0.234081).  Saving model ...
Epoch: 55 cost time: 0.4805421829223633
Epoch: 55, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.684 Vali Acc: 0.240 Test Loss: 3.684 Test Acc: 0.240
Validation loss decreased (-0.234081 --> -0.239963).  Saving model ...
Epoch: 56 cost time: 0.5009329319000244
Epoch: 56, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.702 Vali Acc: 0.245 Test Loss: 3.702 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244669).  Saving model ...
Epoch: 57 cost time: 0.47708845138549805
Epoch: 57, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.717 Vali Acc: 0.244 Test Loss: 3.717 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.529738187789917
Epoch: 58, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.733 Vali Acc: 0.235 Test Loss: 3.733 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4831583499908447
Epoch: 59, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.756 Vali Acc: 0.235 Test Loss: 3.756 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5249557495117188
Epoch: 60, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.789 Vali Acc: 0.234 Test Loss: 3.789 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5469768047332764
Epoch: 61, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.759 Vali Acc: 0.240 Test Loss: 3.759 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.4872128963470459
Epoch: 62, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.766 Vali Acc: 0.246 Test Loss: 3.766 Test Acc: 0.246
Validation loss decreased (-0.244669 --> -0.245845).  Saving model ...
Epoch: 63 cost time: 0.5666763782501221
Epoch: 63, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.800 Vali Acc: 0.244 Test Loss: 3.800 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5020284652709961
Epoch: 64, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.824 Vali Acc: 0.235 Test Loss: 3.824 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4964475631713867
Epoch: 65, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.807 Vali Acc: 0.239 Test Loss: 3.807 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5279359817504883
Epoch: 66, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.817 Vali Acc: 0.239 Test Loss: 3.817 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5244777202606201
Epoch: 67, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.839 Vali Acc: 0.241 Test Loss: 3.839 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5134046077728271
Epoch: 68, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.862 Vali Acc: 0.241 Test Loss: 3.862 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.5259969234466553
Epoch: 69, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.871 Vali Acc: 0.245 Test Loss: 3.871 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5053718090057373
Epoch: 70, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.890 Vali Acc: 0.245 Test Loss: 3.890 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.5436222553253174
Epoch: 71, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.941 Vali Acc: 0.244 Test Loss: 3.941 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.5119390487670898
Epoch: 72, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.915 Vali Acc: 0.242 Test Loss: 3.915 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 44250
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6328513622283936
Epoch: 1, Steps: 10 | Train Loss: 3.438 Vali Loss: 3.381 Vali Acc: 0.039 Test Loss: 3.381 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5706901550292969
Epoch: 2, Steps: 10 | Train Loss: 3.432 Vali Loss: 3.376 Vali Acc: 0.040 Test Loss: 3.376 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.5038137435913086
Epoch: 3, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.363 Vali Acc: 0.034 Test Loss: 3.363 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5234658718109131
Epoch: 4, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.348 Vali Acc: 0.040 Test Loss: 3.348 Test Acc: 0.040
Validation loss decreased (-0.039966 --> -0.039967).  Saving model ...
Epoch: 5 cost time: 0.551837682723999
Epoch: 5, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.336 Vali Acc: 0.049 Test Loss: 3.336 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 0.5373106002807617
Epoch: 6, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.324 Vali Acc: 0.059 Test Loss: 3.324 Test Acc: 0.059
Validation loss decreased (-0.049378 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 0.5005626678466797
Epoch: 7, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.315 Vali Acc: 0.061 Test Loss: 3.315 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 0.5573475360870361
Epoch: 8, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.311 Vali Acc: 0.061 Test Loss: 3.311 Test Acc: 0.061
Validation loss decreased (-0.061143 --> -0.061143).  Saving model ...
Epoch: 9 cost time: 0.5876471996307373
Epoch: 9, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.308 Vali Acc: 0.068 Test Loss: 3.308 Test Acc: 0.068
Validation loss decreased (-0.061143 --> -0.068202).  Saving model ...
Epoch: 10 cost time: 0.5692415237426758
Epoch: 10, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.310 Vali Acc: 0.067 Test Loss: 3.310 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5616397857666016
Epoch: 11, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.309 Vali Acc: 0.068 Test Loss: 3.309 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5522701740264893
Epoch: 12, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.307 Vali Acc: 0.074 Test Loss: 3.307 Test Acc: 0.074
Validation loss decreased (-0.068202 --> -0.074085).  Saving model ...
Epoch: 13 cost time: 0.5288515090942383
Epoch: 13, Steps: 10 | Train Loss: 2.776 Vali Loss: 3.303 Vali Acc: 0.074 Test Loss: 3.303 Test Acc: 0.074
Validation loss decreased (-0.074085 --> -0.074085).  Saving model ...
Epoch: 14 cost time: 0.5353171825408936
Epoch: 14, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.297 Vali Acc: 0.075 Test Loss: 3.297 Test Acc: 0.075
Validation loss decreased (-0.074085 --> -0.075261).  Saving model ...
Epoch: 15 cost time: 0.49959254264831543
Epoch: 15, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.300 Vali Acc: 0.076 Test Loss: 3.300 Test Acc: 0.076
Validation loss decreased (-0.075261 --> -0.076438).  Saving model ...
Epoch: 16 cost time: 0.5518324375152588
Epoch: 16, Steps: 10 | Train Loss: 2.569 Vali Loss: 3.298 Vali Acc: 0.084 Test Loss: 3.298 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083496).  Saving model ...
Epoch: 17 cost time: 0.5111901760101318
Epoch: 17, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.295 Vali Acc: 0.086 Test Loss: 3.295 Test Acc: 0.086
Validation loss decreased (-0.083496 --> -0.085849).  Saving model ...
Epoch: 18 cost time: 0.5232119560241699
Epoch: 18, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.293 Vali Acc: 0.094 Test Loss: 3.293 Test Acc: 0.094
Validation loss decreased (-0.085849 --> -0.094085).  Saving model ...
Epoch: 19 cost time: 0.5300650596618652
Epoch: 19, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.294 Vali Acc: 0.096 Test Loss: 3.294 Test Acc: 0.096
Validation loss decreased (-0.094085 --> -0.096438).  Saving model ...
Epoch: 20 cost time: 0.5148847103118896
Epoch: 20, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.289 Vali Acc: 0.104 Test Loss: 3.289 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 21 cost time: 0.4945955276489258
Epoch: 21, Steps: 10 | Train Loss: 2.215 Vali Loss: 3.295 Vali Acc: 0.107 Test Loss: 3.295 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 22 cost time: 0.5162475109100342
Epoch: 22, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.297 Vali Acc: 0.108 Test Loss: 3.297 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108202).  Saving model ...
Epoch: 23 cost time: 0.46418166160583496
Epoch: 23, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.303 Vali Acc: 0.112 Test Loss: 3.303 Test Acc: 0.112
Validation loss decreased (-0.108202 --> -0.111732).  Saving model ...
Epoch: 24 cost time: 0.5061531066894531
Epoch: 24, Steps: 10 | Train Loss: 1.980 Vali Loss: 3.303 Vali Acc: 0.119 Test Loss: 3.303 Test Acc: 0.119
Validation loss decreased (-0.111732 --> -0.118790).  Saving model ...
Epoch: 25 cost time: 0.5060575008392334
Epoch: 25, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.312 Vali Acc: 0.119 Test Loss: 3.312 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5689928531646729
Epoch: 26, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.316 Vali Acc: 0.133 Test Loss: 3.316 Test Acc: 0.133
Validation loss decreased (-0.118790 --> -0.132908).  Saving model ...
Epoch: 27 cost time: 0.5263485908508301
Epoch: 27, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.327 Vali Acc: 0.138 Test Loss: 3.327 Test Acc: 0.138
Validation loss decreased (-0.132908 --> -0.137614).  Saving model ...
Epoch: 28 cost time: 0.5418968200683594
Epoch: 28, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.325 Vali Acc: 0.144 Test Loss: 3.325 Test Acc: 0.144
Validation loss decreased (-0.137614 --> -0.143496).  Saving model ...
Epoch: 29 cost time: 0.5392727851867676
Epoch: 29, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.330 Vali Acc: 0.155 Test Loss: 3.330 Test Acc: 0.155
Validation loss decreased (-0.143496 --> -0.155261).  Saving model ...
Epoch: 30 cost time: 0.5458660125732422
Epoch: 30, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.348 Vali Acc: 0.158 Test Loss: 3.348 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 31 cost time: 0.5668988227844238
Epoch: 31, Steps: 10 | Train Loss: 1.501 Vali Loss: 3.358 Vali Acc: 0.154 Test Loss: 3.358 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6220710277557373
Epoch: 32, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.374 Vali Acc: 0.160 Test Loss: 3.374 Test Acc: 0.160
Validation loss decreased (-0.157614 --> -0.159966).  Saving model ...
Epoch: 33 cost time: 0.5469143390655518
Epoch: 33, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.380 Vali Acc: 0.169 Test Loss: 3.380 Test Acc: 0.169
Validation loss decreased (-0.159966 --> -0.169378).  Saving model ...
Epoch: 34 cost time: 0.5215945243835449
Epoch: 34, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.386 Vali Acc: 0.168 Test Loss: 3.386 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5176024436950684
Epoch: 35, Steps: 10 | Train Loss: 1.205 Vali Loss: 3.388 Vali Acc: 0.169 Test Loss: 3.388 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5190613269805908
Epoch: 36, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.402 Vali Acc: 0.168 Test Loss: 3.402 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5075564384460449
Epoch: 37, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.427 Vali Acc: 0.171 Test Loss: 3.427 Test Acc: 0.171
Validation loss decreased (-0.169378 --> -0.170554).  Saving model ...
Epoch: 38 cost time: 0.5480914115905762
Epoch: 38, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.444 Vali Acc: 0.169 Test Loss: 3.444 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5768606662750244
Epoch: 39, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.461 Vali Acc: 0.171 Test Loss: 3.461 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.47376251220703125
Epoch: 40, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.471 Vali Acc: 0.176 Test Loss: 3.471 Test Acc: 0.176
Validation loss decreased (-0.170554 --> -0.176436).  Saving model ...
Epoch: 41 cost time: 0.5738348960876465
Epoch: 41, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.498 Vali Acc: 0.182 Test Loss: 3.498 Test Acc: 0.182
Validation loss decreased (-0.176436 --> -0.182318).  Saving model ...
Epoch: 42 cost time: 0.5350098609924316
Epoch: 42, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.507 Vali Acc: 0.181 Test Loss: 3.507 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5582547187805176
Epoch: 43, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.507 Vali Acc: 0.180 Test Loss: 3.507 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5299971103668213
Epoch: 44, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.509 Vali Acc: 0.179 Test Loss: 3.509 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.4646472930908203
Epoch: 45, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.528 Vali Acc: 0.185 Test Loss: 3.528 Test Acc: 0.185
Validation loss decreased (-0.182318 --> -0.184671).  Saving model ...
Epoch: 46 cost time: 0.5425257682800293
Epoch: 46, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.562 Vali Acc: 0.193 Test Loss: 3.562 Test Acc: 0.193
Validation loss decreased (-0.184671 --> -0.192906).  Saving model ...
Epoch: 47 cost time: 0.5423431396484375
Epoch: 47, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.592 Vali Acc: 0.186 Test Loss: 3.592 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5226631164550781
Epoch: 48, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.586 Vali Acc: 0.188 Test Loss: 3.586 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.539914608001709
Epoch: 49, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.589 Vali Acc: 0.195 Test Loss: 3.589 Test Acc: 0.195
Validation loss decreased (-0.192906 --> -0.195258).  Saving model ...
Epoch: 50 cost time: 0.527010440826416
Epoch: 50, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.608 Vali Acc: 0.200 Test Loss: 3.608 Test Acc: 0.200
Validation loss decreased (-0.195258 --> -0.199964).  Saving model ...
Epoch: 51 cost time: 0.5278079509735107
Epoch: 51, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.622 Vali Acc: 0.201 Test Loss: 3.622 Test Acc: 0.201
Validation loss decreased (-0.199964 --> -0.201140).  Saving model ...
Epoch: 52 cost time: 0.5259449481964111
Epoch: 52, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.652 Vali Acc: 0.207 Test Loss: 3.652 Test Acc: 0.207
Validation loss decreased (-0.201140 --> -0.207022).  Saving model ...
Epoch: 53 cost time: 0.5473272800445557
Epoch: 53, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.688 Vali Acc: 0.206 Test Loss: 3.688 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4479103088378906
Epoch: 54, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.701 Vali Acc: 0.200 Test Loss: 3.701 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.4879031181335449
Epoch: 55, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.739 Vali Acc: 0.200 Test Loss: 3.739 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5051164627075195
Epoch: 56, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.739 Vali Acc: 0.199 Test Loss: 3.739 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.520378589630127
Epoch: 57, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.709 Vali Acc: 0.204 Test Loss: 3.709 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5362448692321777
Epoch: 58, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.725 Vali Acc: 0.205 Test Loss: 3.725 Test Acc: 0.205
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.4948544502258301
Epoch: 59, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.770 Vali Acc: 0.201 Test Loss: 3.770 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.5089247226715088
Epoch: 60, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.778 Vali Acc: 0.200 Test Loss: 3.778 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5185370445251465
Epoch: 61, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.778 Vali Acc: 0.207 Test Loss: 3.778 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.4950096607208252
Epoch: 62, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.770 Vali Acc: 0.206 Test Loss: 3.770 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.20705882352941177
model parameter : 40634
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.705317497253418
Epoch: 1, Steps: 10 | Train Loss: 3.506 Vali Loss: 3.342 Vali Acc: 0.031 Test Loss: 3.342 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.4617342948913574
Epoch: 2, Steps: 10 | Train Loss: 3.511 Vali Loss: 3.337 Vali Acc: 0.035 Test Loss: 3.337 Test Acc: 0.035
Validation loss decreased (-0.030555 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.5230991840362549
Epoch: 3, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.334 Vali Acc: 0.038 Test Loss: 3.334 Test Acc: 0.038
Validation loss decreased (-0.035261 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.517390251159668
Epoch: 4, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.330 Vali Acc: 0.038 Test Loss: 3.330 Test Acc: 0.038
Validation loss decreased (-0.037614 --> -0.037614).  Saving model ...
Epoch: 5 cost time: 0.4874539375305176
Epoch: 5, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.322 Vali Acc: 0.039 Test Loss: 3.322 Test Acc: 0.039
Validation loss decreased (-0.037614 --> -0.038790).  Saving model ...
Epoch: 6 cost time: 0.5384972095489502
Epoch: 6, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.315 Vali Acc: 0.044 Test Loss: 3.315 Test Acc: 0.044
Validation loss decreased (-0.038790 --> -0.043496).  Saving model ...
Epoch: 7 cost time: 0.4731566905975342
Epoch: 7, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.310 Vali Acc: 0.060 Test Loss: 3.310 Test Acc: 0.060
Validation loss decreased (-0.043496 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 0.5123710632324219
Epoch: 8, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.303 Vali Acc: 0.062 Test Loss: 3.303 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062320).  Saving model ...
Epoch: 9 cost time: 0.45057129859924316
Epoch: 9, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.298 Vali Acc: 0.067 Test Loss: 3.298 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 10 cost time: 0.47827863693237305
Epoch: 10, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.292 Vali Acc: 0.073 Test Loss: 3.292 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072908).  Saving model ...
Epoch: 11 cost time: 0.500525951385498
Epoch: 11, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.288 Vali Acc: 0.079 Test Loss: 3.288 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078791).  Saving model ...
Epoch: 12 cost time: 0.48958492279052734
Epoch: 12, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.282 Vali Acc: 0.080 Test Loss: 3.282 Test Acc: 0.080
Validation loss decreased (-0.078791 --> -0.079967).  Saving model ...
Epoch: 13 cost time: 0.4721403121948242
Epoch: 13, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.280 Vali Acc: 0.080 Test Loss: 3.280 Test Acc: 0.080
Validation loss decreased (-0.079967 --> -0.079967).  Saving model ...
Epoch: 14 cost time: 0.47594547271728516
Epoch: 14, Steps: 10 | Train Loss: 2.793 Vali Loss: 3.272 Vali Acc: 0.092 Test Loss: 3.272 Test Acc: 0.092
Validation loss decreased (-0.079967 --> -0.091732).  Saving model ...
Epoch: 15 cost time: 0.4893209934234619
Epoch: 15, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.268 Vali Acc: 0.101 Test Loss: 3.268 Test Acc: 0.101
Validation loss decreased (-0.091732 --> -0.101144).  Saving model ...
Epoch: 16 cost time: 0.582542896270752
Epoch: 16, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.258 Vali Acc: 0.106 Test Loss: 3.258 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 17 cost time: 0.5349242687225342
Epoch: 17, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.251 Vali Acc: 0.107 Test Loss: 3.251 Test Acc: 0.107
Validation loss decreased (-0.105850 --> -0.107026).  Saving model ...
Epoch: 18 cost time: 0.5218086242675781
Epoch: 18, Steps: 10 | Train Loss: 2.479 Vali Loss: 3.244 Vali Acc: 0.112 Test Loss: 3.244 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 19 cost time: 0.5148680210113525
Epoch: 19, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.244 Vali Acc: 0.114 Test Loss: 3.244 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 20 cost time: 0.545802116394043
Epoch: 20, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.241 Vali Acc: 0.119 Test Loss: 3.241 Test Acc: 0.119
Validation loss decreased (-0.114085 --> -0.118791).  Saving model ...
Epoch: 21 cost time: 0.4975728988647461
Epoch: 21, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.237 Vali Acc: 0.128 Test Loss: 3.237 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128203).  Saving model ...
Epoch: 22 cost time: 0.49982523918151855
Epoch: 22, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.239 Vali Acc: 0.134 Test Loss: 3.239 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 23 cost time: 0.4825279712677002
Epoch: 23, Steps: 10 | Train Loss: 2.116 Vali Loss: 3.236 Vali Acc: 0.145 Test Loss: 3.236 Test Acc: 0.145
Validation loss decreased (-0.134085 --> -0.144674).  Saving model ...
Epoch: 24 cost time: 0.537055253982544
Epoch: 24, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.231 Vali Acc: 0.149 Test Loss: 3.231 Test Acc: 0.149
Validation loss decreased (-0.144674 --> -0.149379).  Saving model ...
Epoch: 25 cost time: 0.52994704246521
Epoch: 25, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.234 Vali Acc: 0.152 Test Loss: 3.234 Test Acc: 0.152
Validation loss decreased (-0.149379 --> -0.151732).  Saving model ...
Epoch: 26 cost time: 0.5196373462677002
Epoch: 26, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.244 Vali Acc: 0.154 Test Loss: 3.244 Test Acc: 0.154
Validation loss decreased (-0.151732 --> -0.154085).  Saving model ...
Epoch: 27 cost time: 0.5278596878051758
Epoch: 27, Steps: 10 | Train Loss: 1.853 Vali Loss: 3.260 Vali Acc: 0.165 Test Loss: 3.260 Test Acc: 0.165
Validation loss decreased (-0.154085 --> -0.164673).  Saving model ...
Epoch: 28 cost time: 0.4742312431335449
Epoch: 28, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.261 Vali Acc: 0.165 Test Loss: 3.261 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.554581880569458
Epoch: 29, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.267 Vali Acc: 0.166 Test Loss: 3.267 Test Acc: 0.166
Validation loss decreased (-0.164673 --> -0.165850).  Saving model ...
Epoch: 30 cost time: 0.492750883102417
Epoch: 30, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.261 Vali Acc: 0.173 Test Loss: 3.261 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172909).  Saving model ...
Epoch: 31 cost time: 0.5288453102111816
Epoch: 31, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.259 Vali Acc: 0.181 Test Loss: 3.259 Test Acc: 0.181
Validation loss decreased (-0.172909 --> -0.181144).  Saving model ...
Epoch: 32 cost time: 0.5062870979309082
Epoch: 32, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.270 Vali Acc: 0.179 Test Loss: 3.270 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5368471145629883
Epoch: 33, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.272 Vali Acc: 0.189 Test Loss: 3.272 Test Acc: 0.189
Validation loss decreased (-0.181144 --> -0.189379).  Saving model ...
Epoch: 34 cost time: 0.5482170581817627
Epoch: 34, Steps: 10 | Train Loss: 1.399 Vali Loss: 3.291 Vali Acc: 0.187 Test Loss: 3.291 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5364892482757568
Epoch: 35, Steps: 10 | Train Loss: 1.345 Vali Loss: 3.289 Vali Acc: 0.194 Test Loss: 3.289 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194085).  Saving model ...
Epoch: 36 cost time: 0.4949064254760742
Epoch: 36, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.300 Vali Acc: 0.191 Test Loss: 3.300 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48026490211486816
Epoch: 37, Steps: 10 | Train Loss: 1.169 Vali Loss: 3.315 Vali Acc: 0.194 Test Loss: 3.315 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5872623920440674
Epoch: 38, Steps: 10 | Train Loss: 1.194 Vali Loss: 3.319 Vali Acc: 0.204 Test Loss: 3.319 Test Acc: 0.204
Validation loss decreased (-0.194085 --> -0.203496).  Saving model ...
Epoch: 39 cost time: 0.5569350719451904
Epoch: 39, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.328 Vali Acc: 0.208 Test Loss: 3.328 Test Acc: 0.208
Validation loss decreased (-0.203496 --> -0.208202).  Saving model ...
Epoch: 40 cost time: 0.538196325302124
Epoch: 40, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.342 Vali Acc: 0.205 Test Loss: 3.342 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5222907066345215
Epoch: 41, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.345 Vali Acc: 0.209 Test Loss: 3.345 Test Acc: 0.209
Validation loss decreased (-0.208202 --> -0.209378).  Saving model ...
Epoch: 42 cost time: 0.4884510040283203
Epoch: 42, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.373 Vali Acc: 0.209 Test Loss: 3.373 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.566375732421875
Epoch: 43, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.371 Vali Acc: 0.211 Test Loss: 3.371 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210555).  Saving model ...
Epoch: 44 cost time: 0.5382411479949951
Epoch: 44, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.390 Vali Acc: 0.216 Test Loss: 3.390 Test Acc: 0.216
Validation loss decreased (-0.210555 --> -0.216437).  Saving model ...
Epoch: 45 cost time: 0.5651347637176514
Epoch: 45, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.426 Vali Acc: 0.220 Test Loss: 3.426 Test Acc: 0.220
Validation loss decreased (-0.216437 --> -0.219966).  Saving model ...
Epoch: 46 cost time: 0.5586485862731934
Epoch: 46, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.426 Vali Acc: 0.219 Test Loss: 3.426 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5507926940917969
Epoch: 47, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.394 Vali Acc: 0.219 Test Loss: 3.394 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5081517696380615
Epoch: 48, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.422 Vali Acc: 0.218 Test Loss: 3.422 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4970512390136719
Epoch: 49, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.432 Vali Acc: 0.222 Test Loss: 3.432 Test Acc: 0.222
Validation loss decreased (-0.219966 --> -0.222319).  Saving model ...
Epoch: 50 cost time: 0.530465841293335
Epoch: 50, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.464 Vali Acc: 0.227 Test Loss: 3.464 Test Acc: 0.227
Validation loss decreased (-0.222319 --> -0.227024).  Saving model ...
Epoch: 51 cost time: 0.5349912643432617
Epoch: 51, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.488 Vali Acc: 0.224 Test Loss: 3.488 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5421328544616699
Epoch: 52, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.496 Vali Acc: 0.226 Test Loss: 3.496 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.48650383949279785
Epoch: 53, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.493 Vali Acc: 0.226 Test Loss: 3.493 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5399363040924072
Epoch: 54, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.504 Vali Acc: 0.231 Test Loss: 3.504 Test Acc: 0.231
Validation loss decreased (-0.227024 --> -0.230553).  Saving model ...
Epoch: 55 cost time: 0.5576748847961426
Epoch: 55, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.496 Vali Acc: 0.229 Test Loss: 3.496 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5164785385131836
Epoch: 56, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.491 Vali Acc: 0.229 Test Loss: 3.491 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5491876602172852
Epoch: 57, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.539 Vali Acc: 0.235 Test Loss: 3.539 Test Acc: 0.235
Validation loss decreased (-0.230553 --> -0.235259).  Saving model ...
Epoch: 58 cost time: 0.5244319438934326
Epoch: 58, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.567 Vali Acc: 0.234 Test Loss: 3.567 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5139374732971191
Epoch: 59, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.563 Vali Acc: 0.228 Test Loss: 3.563 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5725171566009521
Epoch: 60, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.557 Vali Acc: 0.232 Test Loss: 3.557 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5308053493499756
Epoch: 61, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.625 Vali Acc: 0.236 Test Loss: 3.625 Test Acc: 0.236
Validation loss decreased (-0.235259 --> -0.236434).  Saving model ...
Epoch: 62 cost time: 0.5131068229675293
Epoch: 62, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.651 Vali Acc: 0.232 Test Loss: 3.651 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5253150463104248
Epoch: 63, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.600 Vali Acc: 0.241 Test Loss: 3.600 Test Acc: 0.241
Validation loss decreased (-0.236434 --> -0.241140).  Saving model ...
Epoch: 64 cost time: 0.5216155052185059
Epoch: 64, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.624 Vali Acc: 0.245 Test Loss: 3.624 Test Acc: 0.245
Validation loss decreased (-0.241140 --> -0.244670).  Saving model ...
Epoch: 65 cost time: 0.5534584522247314
Epoch: 65, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.652 Vali Acc: 0.246 Test Loss: 3.652 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245846).  Saving model ...
Epoch: 66 cost time: 0.5417912006378174
Epoch: 66, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.646 Vali Acc: 0.241 Test Loss: 3.646 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5195262432098389
Epoch: 67, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.660 Vali Acc: 0.251 Test Loss: 3.660 Test Acc: 0.251
Validation loss decreased (-0.245846 --> -0.250552).  Saving model ...
Epoch: 68 cost time: 0.49840354919433594
Epoch: 68, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.655 Vali Acc: 0.255 Test Loss: 3.655 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255258).  Saving model ...
Epoch: 69 cost time: 0.5519888401031494
Epoch: 69, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.658 Vali Acc: 0.251 Test Loss: 3.658 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5032315254211426
Epoch: 70, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.663 Vali Acc: 0.242 Test Loss: 3.663 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5187172889709473
Epoch: 71, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.676 Vali Acc: 0.249 Test Loss: 3.676 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5071613788604736
Epoch: 72, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.710 Vali Acc: 0.254 Test Loss: 3.710 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.549809455871582
Epoch: 73, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.742 Vali Acc: 0.253 Test Loss: 3.742 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5388538837432861
Epoch: 74, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.745 Vali Acc: 0.248 Test Loss: 3.745 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5595574378967285
Epoch: 75, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.751 Vali Acc: 0.251 Test Loss: 3.751 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.4736597537994385
Epoch: 76, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.764 Vali Acc: 0.245 Test Loss: 3.764 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.48127079010009766
Epoch: 77, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.763 Vali Acc: 0.245 Test Loss: 3.763 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.4971935749053955
Epoch: 78, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.766 Vali Acc: 0.245 Test Loss: 3.766 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 39498
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6567327976226807
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.333 Vali Acc: 0.051 Test Loss: 3.333 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.4887843132019043
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.339 Vali Acc: 0.058 Test Loss: 3.339 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.5205042362213135
Epoch: 3, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.323 Vali Acc: 0.078 Test Loss: 3.323 Test Acc: 0.078
Validation loss decreased (-0.057614 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.4902615547180176
Epoch: 4, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.326 Vali Acc: 0.081 Test Loss: 3.326 Test Acc: 0.081
Validation loss decreased (-0.077614 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.4656035900115967
Epoch: 5, Steps: 10 | Train Loss: 2.824 Vali Loss: 3.290 Vali Acc: 0.124 Test Loss: 3.290 Test Acc: 0.124
Validation loss decreased (-0.081143 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.5367000102996826
Epoch: 6, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.255 Vali Acc: 0.142 Test Loss: 3.255 Test Acc: 0.142
Validation loss decreased (-0.123497 --> -0.142320).  Saving model ...
Epoch: 7 cost time: 0.49026918411254883
Epoch: 7, Steps: 10 | Train Loss: 2.496 Vali Loss: 3.207 Vali Acc: 0.152 Test Loss: 3.207 Test Acc: 0.152
Validation loss decreased (-0.142320 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 0.5620748996734619
Epoch: 8, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.216 Vali Acc: 0.147 Test Loss: 3.216 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.46520161628723145
Epoch: 9, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.212 Vali Acc: 0.154 Test Loss: 3.212 Test Acc: 0.154
Validation loss decreased (-0.151733 --> -0.154086).  Saving model ...
Epoch: 10 cost time: 0.5229949951171875
Epoch: 10, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.226 Vali Acc: 0.179 Test Loss: 3.226 Test Acc: 0.179
Validation loss decreased (-0.154086 --> -0.178791).  Saving model ...
Epoch: 11 cost time: 0.4912686347961426
Epoch: 11, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.206 Vali Acc: 0.187 Test Loss: 3.206 Test Acc: 0.187
Validation loss decreased (-0.178791 --> -0.187027).  Saving model ...
Epoch: 12 cost time: 0.47701549530029297
Epoch: 12, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.267 Vali Acc: 0.187 Test Loss: 3.267 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.501023530960083
Epoch: 13, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.299 Vali Acc: 0.199 Test Loss: 3.299 Test Acc: 0.199
Validation loss decreased (-0.187027 --> -0.198791).  Saving model ...
Epoch: 14 cost time: 0.49994730949401855
Epoch: 14, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.344 Vali Acc: 0.201 Test Loss: 3.344 Test Acc: 0.201
Validation loss decreased (-0.198791 --> -0.201143).  Saving model ...
Epoch: 15 cost time: 0.5078942775726318
Epoch: 15, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.372 Vali Acc: 0.215 Test Loss: 3.372 Test Acc: 0.215
Validation loss decreased (-0.201143 --> -0.215260).  Saving model ...
Epoch: 16 cost time: 0.5207540988922119
Epoch: 16, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.433 Vali Acc: 0.239 Test Loss: 3.433 Test Acc: 0.239
Validation loss decreased (-0.215260 --> -0.238789).  Saving model ...
Epoch: 17 cost time: 0.5334491729736328
Epoch: 17, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.511 Vali Acc: 0.234 Test Loss: 3.511 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.47754883766174316
Epoch: 18, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.566 Vali Acc: 0.232 Test Loss: 3.566 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5004169940948486
Epoch: 19, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.666 Vali Acc: 0.245 Test Loss: 3.666 Test Acc: 0.245
Validation loss decreased (-0.238789 --> -0.244669).  Saving model ...
Epoch: 20 cost time: 0.4866046905517578
Epoch: 20, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.778 Vali Acc: 0.238 Test Loss: 3.778 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5228943824768066
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.820 Vali Acc: 0.251 Test Loss: 3.820 Test Acc: 0.251
Validation loss decreased (-0.244669 --> -0.250550).  Saving model ...
Epoch: 22 cost time: 0.5484917163848877
Epoch: 22, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.900 Vali Acc: 0.249 Test Loss: 3.900 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5272519588470459
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.937 Vali Acc: 0.249 Test Loss: 3.937 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5304737091064453
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.980 Vali Acc: 0.259 Test Loss: 3.980 Test Acc: 0.259
Validation loss decreased (-0.250550 --> -0.258784).  Saving model ...
Epoch: 25 cost time: 0.541895866394043
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.022 Vali Acc: 0.262 Test Loss: 4.022 Test Acc: 0.262
Validation loss decreased (-0.258784 --> -0.262313).  Saving model ...
Epoch: 26 cost time: 0.5193164348602295
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.079 Vali Acc: 0.255 Test Loss: 4.079 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5078599452972412
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.112 Vali Acc: 0.254 Test Loss: 4.112 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5326738357543945
Epoch: 28, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.153 Vali Acc: 0.256 Test Loss: 4.153 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4885103702545166
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.203 Vali Acc: 0.255 Test Loss: 4.203 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5409340858459473
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.234 Vali Acc: 0.258 Test Loss: 4.234 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.49854087829589844
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.257 Vali Acc: 0.251 Test Loss: 4.257 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5729537010192871
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.284 Vali Acc: 0.255 Test Loss: 4.284 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5533738136291504
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.283 Vali Acc: 0.259 Test Loss: 4.283 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5212879180908203
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.305 Vali Acc: 0.258 Test Loss: 4.305 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5337719917297363
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.330 Vali Acc: 0.260 Test Loss: 4.330 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 111146
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7083261013031006
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.391 Vali Acc: 0.033 Test Loss: 3.391 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 0.4801149368286133
Epoch: 2, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.352 Vali Acc: 0.047 Test Loss: 3.352 Test Acc: 0.047
Validation loss decreased (-0.032907 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.5385005474090576
Epoch: 3, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.349 Vali Acc: 0.060 Test Loss: 3.349 Test Acc: 0.060
Validation loss decreased (-0.047025 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.5308961868286133
Epoch: 4, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.351 Vali Acc: 0.069 Test Loss: 3.351 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 0.48850488662719727
Epoch: 5, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.348 Vali Acc: 0.076 Test Loss: 3.348 Test Acc: 0.076
Validation loss decreased (-0.069378 --> -0.076437).  Saving model ...
Epoch: 6 cost time: 0.48843812942504883
Epoch: 6, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.335 Vali Acc: 0.086 Test Loss: 3.335 Test Acc: 0.086
Validation loss decreased (-0.076437 --> -0.085849).  Saving model ...
Epoch: 7 cost time: 0.511765718460083
Epoch: 7, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.322 Vali Acc: 0.096 Test Loss: 3.322 Test Acc: 0.096
Validation loss decreased (-0.085849 --> -0.096437).  Saving model ...
Epoch: 8 cost time: 0.4755415916442871
Epoch: 8, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.299 Vali Acc: 0.106 Test Loss: 3.299 Test Acc: 0.106
Validation loss decreased (-0.096437 --> -0.105849).  Saving model ...
Epoch: 9 cost time: 0.5118210315704346
Epoch: 9, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.290 Vali Acc: 0.118 Test Loss: 3.290 Test Acc: 0.118
Validation loss decreased (-0.105849 --> -0.117614).  Saving model ...
Epoch: 10 cost time: 0.5155060291290283
Epoch: 10, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.275 Vali Acc: 0.122 Test Loss: 3.275 Test Acc: 0.122
Validation loss decreased (-0.117614 --> -0.122320).  Saving model ...
Epoch: 11 cost time: 0.4795396327972412
Epoch: 11, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.263 Vali Acc: 0.121 Test Loss: 3.263 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47745347023010254
Epoch: 12, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.260 Vali Acc: 0.144 Test Loss: 3.260 Test Acc: 0.144
Validation loss decreased (-0.122320 --> -0.143497).  Saving model ...
Epoch: 13 cost time: 0.4418301582336426
Epoch: 13, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.264 Vali Acc: 0.160 Test Loss: 3.264 Test Acc: 0.160
Validation loss decreased (-0.143497 --> -0.159967).  Saving model ...
Epoch: 14 cost time: 0.5403995513916016
Epoch: 14, Steps: 10 | Train Loss: 1.644 Vali Loss: 3.270 Vali Acc: 0.171 Test Loss: 3.270 Test Acc: 0.171
Validation loss decreased (-0.159967 --> -0.170556).  Saving model ...
Epoch: 15 cost time: 0.5273609161376953
Epoch: 15, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.283 Vali Acc: 0.187 Test Loss: 3.283 Test Acc: 0.187
Validation loss decreased (-0.170556 --> -0.187026).  Saving model ...
Epoch: 16 cost time: 0.48764753341674805
Epoch: 16, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.300 Vali Acc: 0.193 Test Loss: 3.300 Test Acc: 0.193
Validation loss decreased (-0.187026 --> -0.192908).  Saving model ...
Epoch: 17 cost time: 0.46285104751586914
Epoch: 17, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.321 Vali Acc: 0.202 Test Loss: 3.321 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 18 cost time: 0.5158183574676514
Epoch: 18, Steps: 10 | Train Loss: 1.070 Vali Loss: 3.353 Vali Acc: 0.202 Test Loss: 3.353 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5410652160644531
Epoch: 19, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.404 Vali Acc: 0.207 Test Loss: 3.404 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207025).  Saving model ...
Epoch: 20 cost time: 0.5343301296234131
Epoch: 20, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.434 Vali Acc: 0.218 Test Loss: 3.434 Test Acc: 0.218
Validation loss decreased (-0.207025 --> -0.217613).  Saving model ...
Epoch: 21 cost time: 0.5212335586547852
Epoch: 21, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.455 Vali Acc: 0.227 Test Loss: 3.455 Test Acc: 0.227
Validation loss decreased (-0.217613 --> -0.227024).  Saving model ...
Epoch: 22 cost time: 0.48662543296813965
Epoch: 22, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.478 Vali Acc: 0.227 Test Loss: 3.478 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5384714603424072
Epoch: 23, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.517 Vali Acc: 0.234 Test Loss: 3.517 Test Acc: 0.234
Validation loss decreased (-0.227024 --> -0.234082).  Saving model ...
Epoch: 24 cost time: 0.4902467727661133
Epoch: 24, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.576 Vali Acc: 0.231 Test Loss: 3.576 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5520036220550537
Epoch: 25, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.625 Vali Acc: 0.236 Test Loss: 3.625 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236434).  Saving model ...
Epoch: 26 cost time: 0.5359575748443604
Epoch: 26, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.692 Vali Acc: 0.252 Test Loss: 3.692 Test Acc: 0.252
Validation loss decreased (-0.236434 --> -0.251728).  Saving model ...
Epoch: 27 cost time: 0.4667396545410156
Epoch: 27, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.715 Vali Acc: 0.249 Test Loss: 3.715 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5400774478912354
Epoch: 28, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.770 Vali Acc: 0.264 Test Loss: 3.770 Test Acc: 0.264
Validation loss decreased (-0.251728 --> -0.263492).  Saving model ...
Epoch: 29 cost time: 0.528200626373291
Epoch: 29, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.826 Vali Acc: 0.259 Test Loss: 3.826 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.535851240158081
Epoch: 30, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.835 Vali Acc: 0.248 Test Loss: 3.835 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5011372566223145
Epoch: 31, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.828 Vali Acc: 0.261 Test Loss: 3.828 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.48508381843566895
Epoch: 32, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.876 Vali Acc: 0.260 Test Loss: 3.876 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.51021409034729
Epoch: 33, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.941 Vali Acc: 0.255 Test Loss: 3.941 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5170037746429443
Epoch: 34, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.950 Vali Acc: 0.262 Test Loss: 3.950 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5166189670562744
Epoch: 35, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.970 Vali Acc: 0.256 Test Loss: 3.970 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5530588626861572
Epoch: 36, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.967 Vali Acc: 0.265 Test Loss: 3.967 Test Acc: 0.265
Validation loss decreased (-0.263492 --> -0.264666).  Saving model ...
Epoch: 37 cost time: 0.530102014541626
Epoch: 37, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.029 Vali Acc: 0.259 Test Loss: 4.029 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5077760219573975
Epoch: 38, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.074 Vali Acc: 0.254 Test Loss: 4.074 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5296728610992432
Epoch: 39, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.109 Vali Acc: 0.259 Test Loss: 4.109 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5112700462341309
Epoch: 40, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.147 Vali Acc: 0.261 Test Loss: 4.147 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5574724674224854
Epoch: 41, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.189 Vali Acc: 0.261 Test Loss: 4.189 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5471417903900146
Epoch: 42, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.188 Vali Acc: 0.256 Test Loss: 4.188 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.48049354553222656
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.180 Vali Acc: 0.255 Test Loss: 4.180 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4591853618621826
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.199 Vali Acc: 0.254 Test Loss: 4.199 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.524101734161377
Epoch: 45, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.214 Vali Acc: 0.256 Test Loss: 4.214 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.48478007316589355
Epoch: 46, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.232 Vali Acc: 0.262 Test Loss: 4.232 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 63786
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5054831504821777
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.363 Vali Acc: 0.048 Test Loss: 3.363 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.488757848739624
Epoch: 2, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.352 Vali Acc: 0.042 Test Loss: 3.352 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5221207141876221
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.341 Vali Acc: 0.048 Test Loss: 3.341 Test Acc: 0.048
Validation loss decreased (-0.048202 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.5127568244934082
Epoch: 4, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.333 Vali Acc: 0.048 Test Loss: 3.333 Test Acc: 0.048
Validation loss decreased (-0.048202 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.49602270126342773
Epoch: 5, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.321 Vali Acc: 0.066 Test Loss: 3.321 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065849).  Saving model ...
Epoch: 6 cost time: 0.5341536998748779
Epoch: 6, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.318 Vali Acc: 0.075 Test Loss: 3.318 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.5205681324005127
Epoch: 7, Steps: 10 | Train Loss: 2.802 Vali Loss: 3.308 Vali Acc: 0.085 Test Loss: 3.308 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.5021743774414062
Epoch: 8, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.289 Vali Acc: 0.086 Test Loss: 3.289 Test Acc: 0.086
Validation loss decreased (-0.084673 --> -0.085849).  Saving model ...
Epoch: 9 cost time: 0.45577335357666016
Epoch: 9, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.276 Vali Acc: 0.096 Test Loss: 3.276 Test Acc: 0.096
Validation loss decreased (-0.085849 --> -0.096438).  Saving model ...
Epoch: 10 cost time: 0.5440981388092041
Epoch: 10, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.265 Vali Acc: 0.101 Test Loss: 3.265 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.5575289726257324
Epoch: 11, Steps: 10 | Train Loss: 2.446 Vali Loss: 3.247 Vali Acc: 0.109 Test Loss: 3.247 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 0.5094523429870605
Epoch: 12, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.234 Vali Acc: 0.120 Test Loss: 3.234 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.47780299186706543
Epoch: 13, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.224 Vali Acc: 0.125 Test Loss: 3.224 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124674).  Saving model ...
Epoch: 14 cost time: 0.5003910064697266
Epoch: 14, Steps: 10 | Train Loss: 2.067 Vali Loss: 3.215 Vali Acc: 0.134 Test Loss: 3.215 Test Acc: 0.134
Validation loss decreased (-0.124674 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.5405266284942627
Epoch: 15, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.212 Vali Acc: 0.147 Test Loss: 3.212 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147027).  Saving model ...
Epoch: 16 cost time: 0.5180909633636475
Epoch: 16, Steps: 10 | Train Loss: 1.744 Vali Loss: 3.206 Vali Acc: 0.153 Test Loss: 3.206 Test Acc: 0.153
Validation loss decreased (-0.147027 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.5943472385406494
Epoch: 17, Steps: 10 | Train Loss: 1.705 Vali Loss: 3.211 Vali Acc: 0.160 Test Loss: 3.211 Test Acc: 0.160
Validation loss decreased (-0.152909 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.5256781578063965
Epoch: 18, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.223 Vali Acc: 0.167 Test Loss: 3.223 Test Acc: 0.167
Validation loss decreased (-0.159968 --> -0.167027).  Saving model ...
Epoch: 19 cost time: 0.5467233657836914
Epoch: 19, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.234 Vali Acc: 0.180 Test Loss: 3.234 Test Acc: 0.180
Validation loss decreased (-0.167027 --> -0.179968).  Saving model ...
Epoch: 20 cost time: 0.5436828136444092
Epoch: 20, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.242 Vali Acc: 0.186 Test Loss: 3.242 Test Acc: 0.186
Validation loss decreased (-0.179968 --> -0.185850).  Saving model ...
Epoch: 21 cost time: 0.540269136428833
Epoch: 21, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.254 Vali Acc: 0.202 Test Loss: 3.254 Test Acc: 0.202
Validation loss decreased (-0.185850 --> -0.202320).  Saving model ...
Epoch: 22 cost time: 0.4938223361968994
Epoch: 22, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.284 Vali Acc: 0.209 Test Loss: 3.284 Test Acc: 0.209
Validation loss decreased (-0.202320 --> -0.209379).  Saving model ...
Epoch: 23 cost time: 0.5476541519165039
Epoch: 23, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.308 Vali Acc: 0.206 Test Loss: 3.308 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49846363067626953
Epoch: 24, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.313 Vali Acc: 0.212 Test Loss: 3.313 Test Acc: 0.212
Validation loss decreased (-0.209379 --> -0.211732).  Saving model ...
Epoch: 25 cost time: 0.5842797756195068
Epoch: 25, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.343 Vali Acc: 0.215 Test Loss: 3.343 Test Acc: 0.215
Validation loss decreased (-0.211732 --> -0.215261).  Saving model ...
Epoch: 26 cost time: 0.5200927257537842
Epoch: 26, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.360 Vali Acc: 0.215 Test Loss: 3.360 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.535902738571167
Epoch: 27, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.388 Vali Acc: 0.218 Test Loss: 3.388 Test Acc: 0.218
Validation loss decreased (-0.215261 --> -0.217613).  Saving model ...
Epoch: 28 cost time: 0.5199763774871826
Epoch: 28, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.413 Vali Acc: 0.231 Test Loss: 3.413 Test Acc: 0.231
Validation loss decreased (-0.217613 --> -0.230554).  Saving model ...
Epoch: 29 cost time: 0.5039055347442627
Epoch: 29, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.438 Vali Acc: 0.231 Test Loss: 3.438 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5306797027587891
Epoch: 30, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.476 Vali Acc: 0.238 Test Loss: 3.476 Test Acc: 0.238
Validation loss decreased (-0.230554 --> -0.237612).  Saving model ...
Epoch: 31 cost time: 0.5411078929901123
Epoch: 31, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.486 Vali Acc: 0.240 Test Loss: 3.486 Test Acc: 0.240
Validation loss decreased (-0.237612 --> -0.239965).  Saving model ...
Epoch: 32 cost time: 0.513157844543457
Epoch: 32, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.518 Vali Acc: 0.245 Test Loss: 3.518 Test Acc: 0.245
Validation loss decreased (-0.239965 --> -0.244671).  Saving model ...
Epoch: 33 cost time: 0.5286498069763184
Epoch: 33, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.567 Vali Acc: 0.239 Test Loss: 3.567 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.548069953918457
Epoch: 34, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.581 Vali Acc: 0.244 Test Loss: 3.581 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5573816299438477
Epoch: 35, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.606 Vali Acc: 0.246 Test Loss: 3.606 Test Acc: 0.246
Validation loss decreased (-0.244671 --> -0.245846).  Saving model ...
Epoch: 36 cost time: 0.5686390399932861
Epoch: 36, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.623 Vali Acc: 0.246 Test Loss: 3.623 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5643813610076904
Epoch: 37, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.637 Vali Acc: 0.252 Test Loss: 3.637 Test Acc: 0.252
Validation loss decreased (-0.245846 --> -0.251728).  Saving model ...
Epoch: 38 cost time: 0.5002865791320801
Epoch: 38, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.686 Vali Acc: 0.258 Test Loss: 3.686 Test Acc: 0.258
Validation loss decreased (-0.251728 --> -0.257610).  Saving model ...
Epoch: 39 cost time: 0.4436361789703369
Epoch: 39, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.729 Vali Acc: 0.252 Test Loss: 3.729 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5503756999969482
Epoch: 40, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.726 Vali Acc: 0.251 Test Loss: 3.726 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5016348361968994
Epoch: 41, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.747 Vali Acc: 0.255 Test Loss: 3.747 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5308926105499268
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.761 Vali Acc: 0.253 Test Loss: 3.761 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5507087707519531
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.778 Vali Acc: 0.254 Test Loss: 3.778 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5548930168151855
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.791 Vali Acc: 0.255 Test Loss: 3.791 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6190545558929443
Epoch: 45, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.829 Vali Acc: 0.252 Test Loss: 3.829 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.49596571922302246
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.847 Vali Acc: 0.254 Test Loss: 3.847 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5387027263641357
Epoch: 47, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.863 Vali Acc: 0.259 Test Loss: 3.863 Test Acc: 0.259
Validation loss decreased (-0.257610 --> -0.258785).  Saving model ...
Epoch: 48 cost time: 0.4809839725494385
Epoch: 48, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.854 Vali Acc: 0.261 Test Loss: 3.854 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261138).  Saving model ...
Epoch: 49 cost time: 0.6212320327758789
Epoch: 49, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.862 Vali Acc: 0.258 Test Loss: 3.862 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5340967178344727
Epoch: 50, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.908 Vali Acc: 0.255 Test Loss: 3.908 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5436902046203613
Epoch: 51, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.943 Vali Acc: 0.252 Test Loss: 3.943 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5910425186157227
Epoch: 52, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.937 Vali Acc: 0.253 Test Loss: 3.937 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5345594882965088
Epoch: 53, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.954 Vali Acc: 0.253 Test Loss: 3.954 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5048553943634033
Epoch: 54, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.983 Vali Acc: 0.254 Test Loss: 3.983 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.5060772895812988
Epoch: 55, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.993 Vali Acc: 0.253 Test Loss: 3.993 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.5436809062957764
Epoch: 56, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.990 Vali Acc: 0.254 Test Loss: 3.990 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.5429825782775879
Epoch: 57, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.012 Vali Acc: 0.259 Test Loss: 4.012 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.5374748706817627
Epoch: 58, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.041 Vali Acc: 0.252 Test Loss: 4.041 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 47626
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6777267456054688
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.390 Vali Acc: 0.046 Test Loss: 3.390 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 0.5549521446228027
Epoch: 2, Steps: 10 | Train Loss: 3.453 Vali Loss: 3.365 Vali Acc: 0.047 Test Loss: 3.365 Test Acc: 0.047
Validation loss decreased (-0.045848 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.5868649482727051
Epoch: 3, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.349 Vali Acc: 0.058 Test Loss: 3.349 Test Acc: 0.058
Validation loss decreased (-0.047025 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.499251127243042
Epoch: 4, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.333 Vali Acc: 0.061 Test Loss: 3.333 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.5229358673095703
Epoch: 5, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.322 Vali Acc: 0.072 Test Loss: 3.322 Test Acc: 0.072
Validation loss decreased (-0.061143 --> -0.071731).  Saving model ...
Epoch: 6 cost time: 0.5499539375305176
Epoch: 6, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.319 Vali Acc: 0.073 Test Loss: 3.319 Test Acc: 0.073
Validation loss decreased (-0.071731 --> -0.072908).  Saving model ...
Epoch: 7 cost time: 0.5436773300170898
Epoch: 7, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.313 Vali Acc: 0.084 Test Loss: 3.313 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 0.5712437629699707
Epoch: 8, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.303 Vali Acc: 0.092 Test Loss: 3.303 Test Acc: 0.092
Validation loss decreased (-0.083496 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.518012523651123
Epoch: 9, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.286 Vali Acc: 0.098 Test Loss: 3.286 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 10 cost time: 0.555553674697876
Epoch: 10, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.275 Vali Acc: 0.098 Test Loss: 3.275 Test Acc: 0.098
Validation loss decreased (-0.097614 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 0.5126340389251709
Epoch: 11, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.261 Vali Acc: 0.102 Test Loss: 3.261 Test Acc: 0.102
Validation loss decreased (-0.097614 --> -0.102320).  Saving model ...
Epoch: 12 cost time: 0.4394998550415039
Epoch: 12, Steps: 10 | Train Loss: 2.505 Vali Loss: 3.249 Vali Acc: 0.106 Test Loss: 3.249 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 13 cost time: 0.533383846282959
Epoch: 13, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.237 Vali Acc: 0.108 Test Loss: 3.237 Test Acc: 0.108
Validation loss decreased (-0.105850 --> -0.108203).  Saving model ...
Epoch: 14 cost time: 0.5046319961547852
Epoch: 14, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.223 Vali Acc: 0.112 Test Loss: 3.223 Test Acc: 0.112
Validation loss decreased (-0.108203 --> -0.111732).  Saving model ...
Epoch: 15 cost time: 0.5592489242553711
Epoch: 15, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.217 Vali Acc: 0.119 Test Loss: 3.217 Test Acc: 0.119
Validation loss decreased (-0.111732 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 0.49668288230895996
Epoch: 16, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.198 Vali Acc: 0.131 Test Loss: 3.198 Test Acc: 0.131
Validation loss decreased (-0.118791 --> -0.130556).  Saving model ...
Epoch: 17 cost time: 0.4999868869781494
Epoch: 17, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.201 Vali Acc: 0.135 Test Loss: 3.201 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135262).  Saving model ...
Epoch: 18 cost time: 0.5227642059326172
Epoch: 18, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.189 Vali Acc: 0.140 Test Loss: 3.189 Test Acc: 0.140
Validation loss decreased (-0.135262 --> -0.139968).  Saving model ...
Epoch: 19 cost time: 0.5414760112762451
Epoch: 19, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.187 Vali Acc: 0.153 Test Loss: 3.187 Test Acc: 0.153
Validation loss decreased (-0.139968 --> -0.152909).  Saving model ...
Epoch: 20 cost time: 0.5090193748474121
Epoch: 20, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.188 Vali Acc: 0.164 Test Loss: 3.188 Test Acc: 0.164
Validation loss decreased (-0.152909 --> -0.163498).  Saving model ...
Epoch: 21 cost time: 0.515932559967041
Epoch: 21, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.202 Vali Acc: 0.168 Test Loss: 3.202 Test Acc: 0.168
Validation loss decreased (-0.163498 --> -0.168203).  Saving model ...
Epoch: 22 cost time: 0.5329000949859619
Epoch: 22, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.210 Vali Acc: 0.176 Test Loss: 3.210 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 23 cost time: 0.5040056705474854
Epoch: 23, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.230 Vali Acc: 0.193 Test Loss: 3.230 Test Acc: 0.193
Validation loss decreased (-0.176438 --> -0.192909).  Saving model ...
Epoch: 24 cost time: 0.49175167083740234
Epoch: 24, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.244 Vali Acc: 0.196 Test Loss: 3.244 Test Acc: 0.196
Validation loss decreased (-0.192909 --> -0.196438).  Saving model ...
Epoch: 25 cost time: 0.5300123691558838
Epoch: 25, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.249 Vali Acc: 0.213 Test Loss: 3.249 Test Acc: 0.213
Validation loss decreased (-0.196438 --> -0.212909).  Saving model ...
Epoch: 26 cost time: 0.5093417167663574
Epoch: 26, Steps: 10 | Train Loss: 1.098 Vali Loss: 3.259 Vali Acc: 0.218 Test Loss: 3.259 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217614).  Saving model ...
Epoch: 27 cost time: 0.5418574810028076
Epoch: 27, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.266 Vali Acc: 0.222 Test Loss: 3.266 Test Acc: 0.222
Validation loss decreased (-0.217614 --> -0.222320).  Saving model ...
Epoch: 28 cost time: 0.5459909439086914
Epoch: 28, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.282 Vali Acc: 0.235 Test Loss: 3.282 Test Acc: 0.235
Validation loss decreased (-0.222320 --> -0.235261).  Saving model ...
Epoch: 29 cost time: 0.5520341396331787
Epoch: 29, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.310 Vali Acc: 0.235 Test Loss: 3.310 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5194368362426758
Epoch: 30, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.329 Vali Acc: 0.238 Test Loss: 3.329 Test Acc: 0.238
Validation loss decreased (-0.235261 --> -0.237614).  Saving model ...
Epoch: 31 cost time: 0.5593924522399902
Epoch: 31, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.352 Vali Acc: 0.245 Test Loss: 3.352 Test Acc: 0.245
Validation loss decreased (-0.237614 --> -0.244672).  Saving model ...
Epoch: 32 cost time: 0.49870967864990234
Epoch: 32, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.371 Vali Acc: 0.251 Test Loss: 3.371 Test Acc: 0.251
Validation loss decreased (-0.244672 --> -0.250555).  Saving model ...
Epoch: 33 cost time: 0.6090140342712402
Epoch: 33, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.406 Vali Acc: 0.245 Test Loss: 3.406 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5428574085235596
Epoch: 34, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.416 Vali Acc: 0.255 Test Loss: 3.416 Test Acc: 0.255
Validation loss decreased (-0.250555 --> -0.255260).  Saving model ...
Epoch: 35 cost time: 0.5108540058135986
Epoch: 35, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.422 Vali Acc: 0.256 Test Loss: 3.422 Test Acc: 0.256
Validation loss decreased (-0.255260 --> -0.256436).  Saving model ...
Epoch: 36 cost time: 0.5749173164367676
Epoch: 36, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.466 Vali Acc: 0.260 Test Loss: 3.466 Test Acc: 0.260
Validation loss decreased (-0.256436 --> -0.259965).  Saving model ...
Epoch: 37 cost time: 0.5497016906738281
Epoch: 37, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.489 Vali Acc: 0.266 Test Loss: 3.489 Test Acc: 0.266
Validation loss decreased (-0.259965 --> -0.265847).  Saving model ...
Epoch: 38 cost time: 0.5323762893676758
Epoch: 38, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.510 Vali Acc: 0.266 Test Loss: 3.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5271379947662354
Epoch: 39, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.538 Vali Acc: 0.262 Test Loss: 3.538 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5678577423095703
Epoch: 40, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.538 Vali Acc: 0.266 Test Loss: 3.538 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5283463001251221
Epoch: 41, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.564 Vali Acc: 0.265 Test Loss: 3.564 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.553901195526123
Epoch: 42, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.591 Vali Acc: 0.266 Test Loss: 3.591 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5083346366882324
Epoch: 43, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.629 Vali Acc: 0.265 Test Loss: 3.629 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5402414798736572
Epoch: 44, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.623 Vali Acc: 0.266 Test Loss: 3.623 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5577514171600342
Epoch: 45, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.636 Vali Acc: 0.271 Test Loss: 3.636 Test Acc: 0.271
Validation loss decreased (-0.265847 --> -0.270552).  Saving model ...
Epoch: 46 cost time: 0.572014570236206
Epoch: 46, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.666 Vali Acc: 0.267 Test Loss: 3.666 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5014421939849854
Epoch: 47, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.723 Vali Acc: 0.264 Test Loss: 3.723 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5256867408752441
Epoch: 48, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.717 Vali Acc: 0.268 Test Loss: 3.717 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5242278575897217
Epoch: 49, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.735 Vali Acc: 0.272 Test Loss: 3.735 Test Acc: 0.272
Validation loss decreased (-0.270552 --> -0.271727).  Saving model ...
Epoch: 50 cost time: 0.5094976425170898
Epoch: 50, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.732 Vali Acc: 0.267 Test Loss: 3.732 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.566338062286377
Epoch: 51, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.752 Vali Acc: 0.265 Test Loss: 3.752 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.529228687286377
Epoch: 52, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.809 Vali Acc: 0.265 Test Loss: 3.809 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.561593770980835
Epoch: 53, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.815 Vali Acc: 0.262 Test Loss: 3.815 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.47771334648132324
Epoch: 54, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.808 Vali Acc: 0.264 Test Loss: 3.808 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5472660064697266
Epoch: 55, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.791 Vali Acc: 0.271 Test Loss: 3.791 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.483447790145874
Epoch: 56, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.842 Vali Acc: 0.269 Test Loss: 3.842 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5432071685791016
Epoch: 57, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.857 Vali Acc: 0.271 Test Loss: 3.857 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.4387326240539551
Epoch: 58, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.871 Vali Acc: 0.269 Test Loss: 3.871 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.47539687156677246
Epoch: 59, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.892 Vali Acc: 0.269 Test Loss: 3.892 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 40202
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4708576202392578
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.319 Vali Acc: 0.038 Test Loss: 3.319 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.4878380298614502
Epoch: 2, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.305 Vali Acc: 0.046 Test Loss: 3.305 Test Acc: 0.046
Validation loss decreased (-0.037614 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.44179272651672363
Epoch: 3, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.298 Vali Acc: 0.049 Test Loss: 3.298 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.521852970123291
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.291 Vali Acc: 0.052 Test Loss: 3.291 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.5022029876708984
Epoch: 5, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.284 Vali Acc: 0.058 Test Loss: 3.284 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.5027227401733398
Epoch: 6, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.278 Vali Acc: 0.068 Test Loss: 3.278 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068203).  Saving model ...
Epoch: 7 cost time: 0.4742889404296875
Epoch: 7, Steps: 10 | Train Loss: 3.048 Vali Loss: 3.275 Vali Acc: 0.074 Test Loss: 3.275 Test Acc: 0.074
Validation loss decreased (-0.068203 --> -0.074085).  Saving model ...
Epoch: 8 cost time: 0.489837646484375
Epoch: 8, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.275 Vali Acc: 0.089 Test Loss: 3.275 Test Acc: 0.089
Validation loss decreased (-0.074085 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 0.5062170028686523
Epoch: 9, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.271 Vali Acc: 0.095 Test Loss: 3.271 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.47321128845214844
Epoch: 10, Steps: 10 | Train Loss: 2.841 Vali Loss: 3.270 Vali Acc: 0.098 Test Loss: 3.270 Test Acc: 0.098
Validation loss decreased (-0.095261 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 0.4353158473968506
Epoch: 11, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.268 Vali Acc: 0.104 Test Loss: 3.268 Test Acc: 0.104
Validation loss decreased (-0.097614 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.5287032127380371
Epoch: 12, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.264 Vali Acc: 0.107 Test Loss: 3.264 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.48353099822998047
Epoch: 13, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.255 Vali Acc: 0.107 Test Loss: 3.255 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 14 cost time: 0.45618748664855957
Epoch: 14, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.252 Vali Acc: 0.115 Test Loss: 3.252 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115262).  Saving model ...
Epoch: 15 cost time: 0.5919251441955566
Epoch: 15, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.249 Vali Acc: 0.122 Test Loss: 3.249 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122320).  Saving model ...
Epoch: 16 cost time: 0.5155889987945557
Epoch: 16, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.247 Vali Acc: 0.125 Test Loss: 3.247 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 17 cost time: 0.45452070236206055
Epoch: 17, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.241 Vali Acc: 0.128 Test Loss: 3.241 Test Acc: 0.128
Validation loss decreased (-0.124673 --> -0.128203).  Saving model ...
Epoch: 18 cost time: 0.510373592376709
Epoch: 18, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.239 Vali Acc: 0.129 Test Loss: 3.239 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 19 cost time: 0.46877026557922363
Epoch: 19, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.240 Vali Acc: 0.134 Test Loss: 3.240 Test Acc: 0.134
Validation loss decreased (-0.129379 --> -0.134085).  Saving model ...
Epoch: 20 cost time: 0.47090983390808105
Epoch: 20, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.240 Vali Acc: 0.135 Test Loss: 3.240 Test Acc: 0.135
Validation loss decreased (-0.134085 --> -0.135262).  Saving model ...
Epoch: 21 cost time: 0.5190911293029785
Epoch: 21, Steps: 10 | Train Loss: 1.966 Vali Loss: 3.251 Vali Acc: 0.144 Test Loss: 3.251 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143497).  Saving model ...
Epoch: 22 cost time: 0.5023133754730225
Epoch: 22, Steps: 10 | Train Loss: 1.856 Vali Loss: 3.258 Vali Acc: 0.152 Test Loss: 3.258 Test Acc: 0.152
Validation loss decreased (-0.143497 --> -0.151732).  Saving model ...
Epoch: 23 cost time: 0.5243868827819824
Epoch: 23, Steps: 10 | Train Loss: 1.774 Vali Loss: 3.260 Vali Acc: 0.152 Test Loss: 3.260 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.48978090286254883
Epoch: 24, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.260 Vali Acc: 0.155 Test Loss: 3.260 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155262).  Saving model ...
Epoch: 25 cost time: 0.4908926486968994
Epoch: 25, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.274 Vali Acc: 0.158 Test Loss: 3.274 Test Acc: 0.158
Validation loss decreased (-0.155262 --> -0.157614).  Saving model ...
Epoch: 26 cost time: 0.5082211494445801
Epoch: 26, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.288 Vali Acc: 0.165 Test Loss: 3.288 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164673).  Saving model ...
Epoch: 27 cost time: 0.4566078186035156
Epoch: 27, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.296 Vali Acc: 0.174 Test Loss: 3.296 Test Acc: 0.174
Validation loss decreased (-0.164673 --> -0.174085).  Saving model ...
Epoch: 28 cost time: 0.5291612148284912
Epoch: 28, Steps: 10 | Train Loss: 1.355 Vali Loss: 3.301 Vali Acc: 0.184 Test Loss: 3.301 Test Acc: 0.184
Validation loss decreased (-0.174085 --> -0.183496).  Saving model ...
Epoch: 29 cost time: 0.5164010524749756
Epoch: 29, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.317 Vali Acc: 0.187 Test Loss: 3.317 Test Acc: 0.187
Validation loss decreased (-0.183496 --> -0.187026).  Saving model ...
Epoch: 30 cost time: 0.5311276912689209
Epoch: 30, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.322 Vali Acc: 0.185 Test Loss: 3.322 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5169386863708496
Epoch: 31, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.337 Vali Acc: 0.191 Test Loss: 3.337 Test Acc: 0.191
Validation loss decreased (-0.187026 --> -0.190555).  Saving model ...
Epoch: 32 cost time: 0.5363826751708984
Epoch: 32, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.350 Vali Acc: 0.194 Test Loss: 3.350 Test Acc: 0.194
Validation loss decreased (-0.190555 --> -0.194084).  Saving model ...
Epoch: 33 cost time: 0.5222611427307129
Epoch: 33, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.369 Vali Acc: 0.199 Test Loss: 3.369 Test Acc: 0.199
Validation loss decreased (-0.194084 --> -0.198790).  Saving model ...
Epoch: 34 cost time: 0.5238773822784424
Epoch: 34, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.382 Vali Acc: 0.201 Test Loss: 3.382 Test Acc: 0.201
Validation loss decreased (-0.198790 --> -0.201143).  Saving model ...
Epoch: 35 cost time: 0.5091145038604736
Epoch: 35, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.395 Vali Acc: 0.200 Test Loss: 3.395 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47330188751220703
Epoch: 36, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.404 Vali Acc: 0.199 Test Loss: 3.404 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.46817946434020996
Epoch: 37, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.409 Vali Acc: 0.200 Test Loss: 3.409 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5051639080047607
Epoch: 38, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.428 Vali Acc: 0.195 Test Loss: 3.428 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4464402198791504
Epoch: 39, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.452 Vali Acc: 0.206 Test Loss: 3.452 Test Acc: 0.206
Validation loss decreased (-0.201143 --> -0.205848).  Saving model ...
Epoch: 40 cost time: 0.47403573989868164
Epoch: 40, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.474 Vali Acc: 0.225 Test Loss: 3.474 Test Acc: 0.225
Validation loss decreased (-0.205848 --> -0.224671).  Saving model ...
Epoch: 41 cost time: 0.49810218811035156
Epoch: 41, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.493 Vali Acc: 0.227 Test Loss: 3.493 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227024).  Saving model ...
Epoch: 42 cost time: 0.4739048480987549
Epoch: 42, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.502 Vali Acc: 0.221 Test Loss: 3.502 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5645558834075928
Epoch: 43, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.514 Vali Acc: 0.226 Test Loss: 3.514 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5238044261932373
Epoch: 44, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.535 Vali Acc: 0.228 Test Loss: 3.535 Test Acc: 0.228
Validation loss decreased (-0.227024 --> -0.228200).  Saving model ...
Epoch: 45 cost time: 0.4694187641143799
Epoch: 45, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.551 Vali Acc: 0.232 Test Loss: 3.551 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231729).  Saving model ...
Epoch: 46 cost time: 0.5813252925872803
Epoch: 46, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.568 Vali Acc: 0.233 Test Loss: 3.568 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232906).  Saving model ...
Epoch: 47 cost time: 0.49504852294921875
Epoch: 47, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.587 Vali Acc: 0.236 Test Loss: 3.587 Test Acc: 0.236
Validation loss decreased (-0.232906 --> -0.236435).  Saving model ...
Epoch: 48 cost time: 0.536858320236206
Epoch: 48, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.606 Vali Acc: 0.236 Test Loss: 3.606 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5056099891662598
Epoch: 49, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.620 Vali Acc: 0.235 Test Loss: 3.620 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5603768825531006
Epoch: 50, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.655 Vali Acc: 0.240 Test Loss: 3.655 Test Acc: 0.240
Validation loss decreased (-0.236435 --> -0.239963).  Saving model ...
Epoch: 51 cost time: 0.5220541954040527
Epoch: 51, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.668 Vali Acc: 0.234 Test Loss: 3.668 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5138661861419678
Epoch: 52, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.687 Vali Acc: 0.235 Test Loss: 3.687 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.46526503562927246
Epoch: 53, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.694 Vali Acc: 0.236 Test Loss: 3.694 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5952348709106445
Epoch: 54, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.716 Vali Acc: 0.234 Test Loss: 3.716 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5452492237091064
Epoch: 55, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.734 Vali Acc: 0.240 Test Loss: 3.734 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.54323410987854
Epoch: 56, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.732 Vali Acc: 0.244 Test Loss: 3.732 Test Acc: 0.244
Validation loss decreased (-0.239963 --> -0.243492).  Saving model ...
Epoch: 57 cost time: 0.5501248836517334
Epoch: 57, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.761 Vali Acc: 0.242 Test Loss: 3.761 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5385046005249023
Epoch: 58, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.803 Vali Acc: 0.240 Test Loss: 3.803 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.6034259796142578
Epoch: 59, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.803 Vali Acc: 0.239 Test Loss: 3.803 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5602579116821289
Epoch: 60, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.820 Vali Acc: 0.244 Test Loss: 3.820 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.545640230178833
Epoch: 61, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.831 Vali Acc: 0.241 Test Loss: 3.831 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.530562162399292
Epoch: 62, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.840 Vali Acc: 0.242 Test Loss: 3.840 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.552077054977417
Epoch: 63, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.854 Vali Acc: 0.246 Test Loss: 3.854 Test Acc: 0.246
Validation loss decreased (-0.243492 --> -0.245844).  Saving model ...
Epoch: 64 cost time: 0.5506134033203125
Epoch: 64, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.873 Vali Acc: 0.240 Test Loss: 3.873 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5881936550140381
Epoch: 65, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.892 Vali Acc: 0.241 Test Loss: 3.892 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5748858451843262
Epoch: 66, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.898 Vali Acc: 0.246 Test Loss: 3.898 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5698819160461426
Epoch: 67, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.925 Vali Acc: 0.251 Test Loss: 3.925 Test Acc: 0.251
Validation loss decreased (-0.245844 --> -0.250549).  Saving model ...
Epoch: 68 cost time: 0.5405831336975098
Epoch: 68, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.921 Vali Acc: 0.244 Test Loss: 3.921 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5713801383972168
Epoch: 69, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.932 Vali Acc: 0.242 Test Loss: 3.932 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5898761749267578
Epoch: 70, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.960 Vali Acc: 0.242 Test Loss: 3.960 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5076816082000732
Epoch: 71, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.978 Vali Acc: 0.236 Test Loss: 3.978 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5672175884246826
Epoch: 72, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.994 Vali Acc: 0.238 Test Loss: 3.994 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5460906028747559
Epoch: 73, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.002 Vali Acc: 0.244 Test Loss: 4.002 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5472531318664551
Epoch: 74, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.014 Vali Acc: 0.240 Test Loss: 4.014 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5932009220123291
Epoch: 75, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.018 Vali Acc: 0.241 Test Loss: 4.018 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.617525577545166
Epoch: 76, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.044 Vali Acc: 0.242 Test Loss: 4.044 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.641899824142456
Epoch: 77, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.047 Vali Acc: 0.242 Test Loss: 4.047 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 31578
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.892547607421875
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.338 Vali Acc: 0.051 Test Loss: 3.338 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.4965016841888428
Epoch: 2, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.330 Vali Acc: 0.044 Test Loss: 3.330 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5586934089660645
Epoch: 3, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.325 Vali Acc: 0.051 Test Loss: 3.325 Test Acc: 0.051
Validation loss decreased (-0.050555 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.5632498264312744
Epoch: 4, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.317 Vali Acc: 0.049 Test Loss: 3.317 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.549821138381958
Epoch: 5, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.310 Vali Acc: 0.058 Test Loss: 3.310 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.5923850536346436
Epoch: 6, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.305 Vali Acc: 0.060 Test Loss: 3.305 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.5791122913360596
Epoch: 7, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.301 Vali Acc: 0.065 Test Loss: 3.301 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 8 cost time: 0.5731189250946045
Epoch: 8, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.295 Vali Acc: 0.071 Test Loss: 3.295 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 0.5460693836212158
Epoch: 9, Steps: 10 | Train Loss: 3.073 Vali Loss: 3.295 Vali Acc: 0.073 Test Loss: 3.295 Test Acc: 0.073
Validation loss decreased (-0.070555 --> -0.072908).  Saving model ...
Epoch: 10 cost time: 0.5460116863250732
Epoch: 10, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.293 Vali Acc: 0.079 Test Loss: 3.293 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078791).  Saving model ...
Epoch: 11 cost time: 0.540736198425293
Epoch: 11, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.290 Vali Acc: 0.085 Test Loss: 3.290 Test Acc: 0.085
Validation loss decreased (-0.078791 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 0.5355410575866699
Epoch: 12, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.290 Vali Acc: 0.089 Test Loss: 3.290 Test Acc: 0.089
Validation loss decreased (-0.084673 --> -0.089379).  Saving model ...
Epoch: 13 cost time: 0.5425233840942383
Epoch: 13, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.287 Vali Acc: 0.088 Test Loss: 3.287 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5554487705230713
Epoch: 14, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.288 Vali Acc: 0.086 Test Loss: 3.288 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5549478530883789
Epoch: 15, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.286 Vali Acc: 0.099 Test Loss: 3.286 Test Acc: 0.099
Validation loss decreased (-0.089379 --> -0.098791).  Saving model ...
Epoch: 16 cost time: 0.5814669132232666
Epoch: 16, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.288 Vali Acc: 0.101 Test Loss: 3.288 Test Acc: 0.101
Validation loss decreased (-0.098791 --> -0.101144).  Saving model ...
Epoch: 17 cost time: 0.5694735050201416
Epoch: 17, Steps: 10 | Train Loss: 2.515 Vali Loss: 3.289 Vali Acc: 0.105 Test Loss: 3.289 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104673).  Saving model ...
Epoch: 18 cost time: 0.5645570755004883
Epoch: 18, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.287 Vali Acc: 0.112 Test Loss: 3.287 Test Acc: 0.112
Validation loss decreased (-0.104673 --> -0.111732).  Saving model ...
Epoch: 19 cost time: 0.5353033542633057
Epoch: 19, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.283 Vali Acc: 0.114 Test Loss: 3.283 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 20 cost time: 0.569420337677002
Epoch: 20, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.277 Vali Acc: 0.118 Test Loss: 3.277 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117614).  Saving model ...
Epoch: 21 cost time: 0.5715775489807129
Epoch: 21, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.280 Vali Acc: 0.127 Test Loss: 3.280 Test Acc: 0.127
Validation loss decreased (-0.117614 --> -0.127026).  Saving model ...
Epoch: 22 cost time: 0.5318388938903809
Epoch: 22, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.280 Vali Acc: 0.125 Test Loss: 3.280 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5278835296630859
Epoch: 23, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.278 Vali Acc: 0.126 Test Loss: 3.278 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5499153137207031
Epoch: 24, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.280 Vali Acc: 0.133 Test Loss: 3.280 Test Acc: 0.133
Validation loss decreased (-0.127026 --> -0.132908).  Saving model ...
Epoch: 25 cost time: 0.5749640464782715
Epoch: 25, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.283 Vali Acc: 0.134 Test Loss: 3.283 Test Acc: 0.134
Validation loss decreased (-0.132908 --> -0.134085).  Saving model ...
Epoch: 26 cost time: 0.5147418975830078
Epoch: 26, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.287 Vali Acc: 0.139 Test Loss: 3.287 Test Acc: 0.139
Validation loss decreased (-0.134085 --> -0.138791).  Saving model ...
Epoch: 27 cost time: 0.5748345851898193
Epoch: 27, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.291 Vali Acc: 0.146 Test Loss: 3.291 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145849).  Saving model ...
Epoch: 28 cost time: 0.5781235694885254
Epoch: 28, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.293 Vali Acc: 0.151 Test Loss: 3.293 Test Acc: 0.151
Validation loss decreased (-0.145849 --> -0.150555).  Saving model ...
Epoch: 29 cost time: 0.5693438053131104
Epoch: 29, Steps: 10 | Train Loss: 1.705 Vali Loss: 3.301 Vali Acc: 0.158 Test Loss: 3.301 Test Acc: 0.158
Validation loss decreased (-0.150555 --> -0.157614).  Saving model ...
Epoch: 30 cost time: 0.5797345638275146
Epoch: 30, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.303 Vali Acc: 0.159 Test Loss: 3.303 Test Acc: 0.159
Validation loss decreased (-0.157614 --> -0.158791).  Saving model ...
Epoch: 31 cost time: 0.5624597072601318
Epoch: 31, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.314 Vali Acc: 0.164 Test Loss: 3.314 Test Acc: 0.164
Validation loss decreased (-0.158791 --> -0.163496).  Saving model ...
Epoch: 32 cost time: 0.5912325382232666
Epoch: 32, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.322 Vali Acc: 0.167 Test Loss: 3.322 Test Acc: 0.167
Validation loss decreased (-0.163496 --> -0.167026).  Saving model ...
Epoch: 33 cost time: 0.5277349948883057
Epoch: 33, Steps: 10 | Train Loss: 1.368 Vali Loss: 3.318 Vali Acc: 0.166 Test Loss: 3.318 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5411388874053955
Epoch: 34, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.330 Vali Acc: 0.178 Test Loss: 3.330 Test Acc: 0.178
Validation loss decreased (-0.167026 --> -0.177614).  Saving model ...
Epoch: 35 cost time: 0.5313076972961426
Epoch: 35, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.351 Vali Acc: 0.173 Test Loss: 3.351 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5631048679351807
Epoch: 36, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.352 Vali Acc: 0.182 Test Loss: 3.352 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182319).  Saving model ...
Epoch: 37 cost time: 0.549870491027832
Epoch: 37, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.360 Vali Acc: 0.187 Test Loss: 3.360 Test Acc: 0.187
Validation loss decreased (-0.182319 --> -0.187025).  Saving model ...
Epoch: 38 cost time: 0.5766158103942871
Epoch: 38, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.360 Vali Acc: 0.191 Test Loss: 3.360 Test Acc: 0.191
Validation loss decreased (-0.187025 --> -0.190555).  Saving model ...
Epoch: 39 cost time: 0.546051025390625
Epoch: 39, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.370 Vali Acc: 0.199 Test Loss: 3.370 Test Acc: 0.199
Validation loss decreased (-0.190555 --> -0.198790).  Saving model ...
Epoch: 40 cost time: 0.5847272872924805
Epoch: 40, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.395 Vali Acc: 0.200 Test Loss: 3.395 Test Acc: 0.200
Validation loss decreased (-0.198790 --> -0.199966).  Saving model ...
Epoch: 41 cost time: 0.6014828681945801
Epoch: 41, Steps: 10 | Train Loss: 0.887 Vali Loss: 3.403 Vali Acc: 0.205 Test Loss: 3.403 Test Acc: 0.205
Validation loss decreased (-0.199966 --> -0.204672).  Saving model ...
Epoch: 42 cost time: 0.5704166889190674
Epoch: 42, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.412 Vali Acc: 0.209 Test Loss: 3.412 Test Acc: 0.209
Validation loss decreased (-0.204672 --> -0.209378).  Saving model ...
Epoch: 43 cost time: 0.5742595195770264
Epoch: 43, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.429 Vali Acc: 0.213 Test Loss: 3.429 Test Acc: 0.213
Validation loss decreased (-0.209378 --> -0.212907).  Saving model ...
Epoch: 44 cost time: 0.604572057723999
Epoch: 44, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.469 Vali Acc: 0.211 Test Loss: 3.469 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5789015293121338
Epoch: 45, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.456 Vali Acc: 0.209 Test Loss: 3.456 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5980408191680908
Epoch: 46, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.444 Vali Acc: 0.216 Test Loss: 3.444 Test Acc: 0.216
Validation loss decreased (-0.212907 --> -0.216436).  Saving model ...
Epoch: 47 cost time: 0.6117334365844727
Epoch: 47, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.463 Vali Acc: 0.215 Test Loss: 3.463 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5718321800231934
Epoch: 48, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.489 Vali Acc: 0.212 Test Loss: 3.489 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.554779052734375
Epoch: 49, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.530 Vali Acc: 0.209 Test Loss: 3.530 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5321993827819824
Epoch: 50, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.527 Vali Acc: 0.218 Test Loss: 3.527 Test Acc: 0.218
Validation loss decreased (-0.216436 --> -0.217612).  Saving model ...
Epoch: 51 cost time: 0.5420732498168945
Epoch: 51, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.545 Vali Acc: 0.214 Test Loss: 3.545 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5557470321655273
Epoch: 52, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.560 Vali Acc: 0.213 Test Loss: 3.560 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5473241806030273
Epoch: 53, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.584 Vali Acc: 0.218 Test Loss: 3.584 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.531635046005249
Epoch: 54, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.587 Vali Acc: 0.218 Test Loss: 3.587 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6057300567626953
Epoch: 55, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.592 Vali Acc: 0.219 Test Loss: 3.592 Test Acc: 0.219
Validation loss decreased (-0.217612 --> -0.218788).  Saving model ...
Epoch: 56 cost time: 0.5721948146820068
Epoch: 56, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.623 Vali Acc: 0.218 Test Loss: 3.623 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5328810214996338
Epoch: 57, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.671 Vali Acc: 0.225 Test Loss: 3.671 Test Acc: 0.225
Validation loss decreased (-0.218788 --> -0.224669).  Saving model ...
Epoch: 58 cost time: 0.5658280849456787
Epoch: 58, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.665 Vali Acc: 0.225 Test Loss: 3.665 Test Acc: 0.225
Validation loss decreased (-0.224669 --> -0.224669).  Saving model ...
Epoch: 59 cost time: 0.5714588165283203
Epoch: 59, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.704 Vali Acc: 0.225 Test Loss: 3.704 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5939803123474121
Epoch: 60, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.708 Vali Acc: 0.224 Test Loss: 3.708 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5355753898620605
Epoch: 61, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.691 Vali Acc: 0.222 Test Loss: 3.691 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5605330467224121
Epoch: 62, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.680 Vali Acc: 0.225 Test Loss: 3.680 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5399739742279053
Epoch: 63, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.715 Vali Acc: 0.227 Test Loss: 3.715 Test Acc: 0.227
Validation loss decreased (-0.224669 --> -0.227022).  Saving model ...
Epoch: 64 cost time: 0.5567739009857178
Epoch: 64, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.715 Vali Acc: 0.225 Test Loss: 3.715 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5600430965423584
Epoch: 65, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.739 Vali Acc: 0.227 Test Loss: 3.739 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.547508716583252
Epoch: 66, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.772 Vali Acc: 0.226 Test Loss: 3.772 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.4642751216888428
Epoch: 67, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.779 Vali Acc: 0.227 Test Loss: 3.779 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5265049934387207
Epoch: 68, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.804 Vali Acc: 0.220 Test Loss: 3.804 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5434632301330566
Epoch: 69, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.811 Vali Acc: 0.224 Test Loss: 3.811 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.598442554473877
Epoch: 70, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.844 Vali Acc: 0.220 Test Loss: 3.844 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.4923989772796631
Epoch: 71, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.906 Vali Acc: 0.220 Test Loss: 3.906 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.4811394214630127
Epoch: 72, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.919 Vali Acc: 0.229 Test Loss: 3.919 Test Acc: 0.229
Validation loss decreased (-0.227022 --> -0.229373).  Saving model ...
Epoch: 73 cost time: 0.5419111251831055
Epoch: 73, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.903 Vali Acc: 0.226 Test Loss: 3.903 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.583972692489624
Epoch: 74, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.884 Vali Acc: 0.227 Test Loss: 3.884 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5561280250549316
Epoch: 75, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.923 Vali Acc: 0.225 Test Loss: 3.923 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.5836753845214844
Epoch: 76, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.928 Vali Acc: 0.226 Test Loss: 3.928 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.5804667472839355
Epoch: 77, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.926 Vali Acc: 0.226 Test Loss: 3.926 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5848789215087891
Epoch: 78, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.949 Vali Acc: 0.226 Test Loss: 3.949 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5396344661712646
Epoch: 79, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.989 Vali Acc: 0.224 Test Loss: 3.989 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5912911891937256
Epoch: 80, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.995 Vali Acc: 0.220 Test Loss: 3.995 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.48898768424987793
Epoch: 81, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.978 Vali Acc: 0.219 Test Loss: 3.978 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.5375957489013672
Epoch: 82, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.987 Vali Acc: 0.226 Test Loss: 3.987 Test Acc: 0.226
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 27962
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7026128768920898
Epoch: 1, Steps: 10 | Train Loss: 3.463 Vali Loss: 3.413 Vali Acc: 0.053 Test Loss: 3.413 Test Acc: 0.053
Validation loss decreased (inf --> -0.052907).  Saving model ...
Epoch: 2 cost time: 0.5642621517181396
Epoch: 2, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.401 Vali Acc: 0.054 Test Loss: 3.401 Test Acc: 0.054
Validation loss decreased (-0.052907 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.46141839027404785
Epoch: 3, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.390 Vali Acc: 0.053 Test Loss: 3.390 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5384690761566162
Epoch: 4, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.380 Vali Acc: 0.055 Test Loss: 3.380 Test Acc: 0.055
Validation loss decreased (-0.054084 --> -0.055260).  Saving model ...
Epoch: 5 cost time: 0.5470232963562012
Epoch: 5, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.367 Vali Acc: 0.061 Test Loss: 3.367 Test Acc: 0.061
Validation loss decreased (-0.055260 --> -0.061143).  Saving model ...
Epoch: 6 cost time: 0.535876989364624
Epoch: 6, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.357 Vali Acc: 0.066 Test Loss: 3.357 Test Acc: 0.066
Validation loss decreased (-0.061143 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.5522735118865967
Epoch: 7, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.349 Vali Acc: 0.065 Test Loss: 3.349 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5465481281280518
Epoch: 8, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.342 Vali Acc: 0.062 Test Loss: 3.342 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5636441707611084
Epoch: 9, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.335 Vali Acc: 0.062 Test Loss: 3.335 Test Acc: 0.062
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4809880256652832
Epoch: 10, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.330 Vali Acc: 0.065 Test Loss: 3.330 Test Acc: 0.065
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5450277328491211
Epoch: 11, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.327 Vali Acc: 0.073 Test Loss: 3.327 Test Acc: 0.073
Validation loss decreased (-0.065849 --> -0.072908).  Saving model ...
Epoch: 12 cost time: 0.5175955295562744
Epoch: 12, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.323 Vali Acc: 0.081 Test Loss: 3.323 Test Acc: 0.081
Validation loss decreased (-0.072908 --> -0.081143).  Saving model ...
Epoch: 13 cost time: 0.5401511192321777
Epoch: 13, Steps: 10 | Train Loss: 2.809 Vali Loss: 3.319 Vali Acc: 0.087 Test Loss: 3.319 Test Acc: 0.087
Validation loss decreased (-0.081143 --> -0.087026).  Saving model ...
Epoch: 14 cost time: 0.5622775554656982
Epoch: 14, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.315 Vali Acc: 0.088 Test Loss: 3.315 Test Acc: 0.088
Validation loss decreased (-0.087026 --> -0.088202).  Saving model ...
Epoch: 15 cost time: 0.5776150226593018
Epoch: 15, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.311 Vali Acc: 0.093 Test Loss: 3.311 Test Acc: 0.093
Validation loss decreased (-0.088202 --> -0.092908).  Saving model ...
Epoch: 16 cost time: 0.5588042736053467
Epoch: 16, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.308 Vali Acc: 0.099 Test Loss: 3.308 Test Acc: 0.099
Validation loss decreased (-0.092908 --> -0.098790).  Saving model ...
Epoch: 17 cost time: 0.5741114616394043
Epoch: 17, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.300 Vali Acc: 0.105 Test Loss: 3.300 Test Acc: 0.105
Validation loss decreased (-0.098790 --> -0.104673).  Saving model ...
Epoch: 18 cost time: 0.5734388828277588
Epoch: 18, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.293 Vali Acc: 0.106 Test Loss: 3.293 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105849).  Saving model ...
Epoch: 19 cost time: 0.5516314506530762
Epoch: 19, Steps: 10 | Train Loss: 2.428 Vali Loss: 3.293 Vali Acc: 0.109 Test Loss: 3.293 Test Acc: 0.109
Validation loss decreased (-0.105849 --> -0.109379).  Saving model ...
Epoch: 20 cost time: 0.5700771808624268
Epoch: 20, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.294 Vali Acc: 0.113 Test Loss: 3.294 Test Acc: 0.113
Validation loss decreased (-0.109379 --> -0.112908).  Saving model ...
Epoch: 21 cost time: 0.6003086566925049
Epoch: 21, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.289 Vali Acc: 0.115 Test Loss: 3.289 Test Acc: 0.115
Validation loss decreased (-0.112908 --> -0.115261).  Saving model ...
Epoch: 22 cost time: 0.647709846496582
Epoch: 22, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.289 Vali Acc: 0.118 Test Loss: 3.289 Test Acc: 0.118
Validation loss decreased (-0.115261 --> -0.117614).  Saving model ...
Epoch: 23 cost time: 0.5741586685180664
Epoch: 23, Steps: 10 | Train Loss: 2.136 Vali Loss: 3.288 Vali Acc: 0.120 Test Loss: 3.288 Test Acc: 0.120
Validation loss decreased (-0.117614 --> -0.119967).  Saving model ...
Epoch: 24 cost time: 0.5060408115386963
Epoch: 24, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.291 Vali Acc: 0.126 Test Loss: 3.291 Test Acc: 0.126
Validation loss decreased (-0.119967 --> -0.125849).  Saving model ...
Epoch: 25 cost time: 0.46042919158935547
Epoch: 25, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.293 Vali Acc: 0.127 Test Loss: 3.293 Test Acc: 0.127
Validation loss decreased (-0.125849 --> -0.127026).  Saving model ...
Epoch: 26 cost time: 0.5677566528320312
Epoch: 26, Steps: 10 | Train Loss: 1.862 Vali Loss: 3.293 Vali Acc: 0.126 Test Loss: 3.293 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5334961414337158
Epoch: 27, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.300 Vali Acc: 0.134 Test Loss: 3.300 Test Acc: 0.134
Validation loss decreased (-0.127026 --> -0.134085).  Saving model ...
Epoch: 28 cost time: 0.5933787822723389
Epoch: 28, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.303 Vali Acc: 0.148 Test Loss: 3.303 Test Acc: 0.148
Validation loss decreased (-0.134085 --> -0.148202).  Saving model ...
Epoch: 29 cost time: 0.5477256774902344
Epoch: 29, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.305 Vali Acc: 0.154 Test Loss: 3.305 Test Acc: 0.154
Validation loss decreased (-0.148202 --> -0.154085).  Saving model ...
Epoch: 30 cost time: 0.5737037658691406
Epoch: 30, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.307 Vali Acc: 0.161 Test Loss: 3.307 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161143).  Saving model ...
Epoch: 31 cost time: 0.5916032791137695
Epoch: 31, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.314 Vali Acc: 0.161 Test Loss: 3.314 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5835709571838379
Epoch: 32, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.316 Vali Acc: 0.162 Test Loss: 3.316 Test Acc: 0.162
Validation loss decreased (-0.161143 --> -0.162320).  Saving model ...
Epoch: 33 cost time: 0.5529870986938477
Epoch: 33, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.331 Vali Acc: 0.171 Test Loss: 3.331 Test Acc: 0.171
Validation loss decreased (-0.162320 --> -0.170555).  Saving model ...
Epoch: 34 cost time: 0.5793025493621826
Epoch: 34, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.345 Vali Acc: 0.173 Test Loss: 3.345 Test Acc: 0.173
Validation loss decreased (-0.170555 --> -0.172908).  Saving model ...
Epoch: 35 cost time: 0.576181173324585
Epoch: 35, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.348 Vali Acc: 0.174 Test Loss: 3.348 Test Acc: 0.174
Validation loss decreased (-0.172908 --> -0.174084).  Saving model ...
Epoch: 36 cost time: 0.5632433891296387
Epoch: 36, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.340 Vali Acc: 0.181 Test Loss: 3.340 Test Acc: 0.181
Validation loss decreased (-0.174084 --> -0.181143).  Saving model ...
Epoch: 37 cost time: 0.6088199615478516
Epoch: 37, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.346 Vali Acc: 0.184 Test Loss: 3.346 Test Acc: 0.184
Validation loss decreased (-0.181143 --> -0.183496).  Saving model ...
Epoch: 38 cost time: 0.606067419052124
Epoch: 38, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.363 Vali Acc: 0.188 Test Loss: 3.363 Test Acc: 0.188
Validation loss decreased (-0.183496 --> -0.188202).  Saving model ...
Epoch: 39 cost time: 0.5544967651367188
Epoch: 39, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.387 Vali Acc: 0.187 Test Loss: 3.387 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6661431789398193
Epoch: 40, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.408 Vali Acc: 0.184 Test Loss: 3.408 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5810143947601318
Epoch: 41, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.392 Vali Acc: 0.191 Test Loss: 3.392 Test Acc: 0.191
Validation loss decreased (-0.188202 --> -0.190554).  Saving model ...
Epoch: 42 cost time: 0.5294997692108154
Epoch: 42, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.403 Vali Acc: 0.199 Test Loss: 3.403 Test Acc: 0.199
Validation loss decreased (-0.190554 --> -0.198790).  Saving model ...
Epoch: 43 cost time: 0.5051405429840088
Epoch: 43, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.396 Vali Acc: 0.199 Test Loss: 3.396 Test Acc: 0.199
Validation loss decreased (-0.198790 --> -0.198790).  Saving model ...
Epoch: 44 cost time: 0.5410563945770264
Epoch: 44, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.408 Vali Acc: 0.204 Test Loss: 3.408 Test Acc: 0.204
Validation loss decreased (-0.198790 --> -0.203495).  Saving model ...
Epoch: 45 cost time: 0.5745422840118408
Epoch: 45, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.432 Vali Acc: 0.206 Test Loss: 3.432 Test Acc: 0.206
Validation loss decreased (-0.203495 --> -0.205848).  Saving model ...
Epoch: 46 cost time: 0.529761791229248
Epoch: 46, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.443 Vali Acc: 0.208 Test Loss: 3.443 Test Acc: 0.208
Validation loss decreased (-0.205848 --> -0.208201).  Saving model ...
Epoch: 47 cost time: 0.5693013668060303
Epoch: 47, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.451 Vali Acc: 0.215 Test Loss: 3.451 Test Acc: 0.215
Validation loss decreased (-0.208201 --> -0.215260).  Saving model ...
Epoch: 48 cost time: 0.5615472793579102
Epoch: 48, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.461 Vali Acc: 0.211 Test Loss: 3.461 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5564413070678711
Epoch: 49, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.468 Vali Acc: 0.216 Test Loss: 3.468 Test Acc: 0.216
Validation loss decreased (-0.215260 --> -0.216436).  Saving model ...
Epoch: 50 cost time: 0.5481376647949219
Epoch: 50, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.494 Vali Acc: 0.220 Test Loss: 3.494 Test Acc: 0.220
Validation loss decreased (-0.216436 --> -0.219965).  Saving model ...
Epoch: 51 cost time: 0.5381247997283936
Epoch: 51, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.508 Vali Acc: 0.219 Test Loss: 3.508 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5693840980529785
Epoch: 52, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.518 Vali Acc: 0.221 Test Loss: 3.518 Test Acc: 0.221
Validation loss decreased (-0.219965 --> -0.221141).  Saving model ...
Epoch: 53 cost time: 0.5514404773712158
Epoch: 53, Steps: 10 | Train Loss: 0.534 Vali Loss: 3.543 Vali Acc: 0.216 Test Loss: 3.543 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5879392623901367
Epoch: 54, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.569 Vali Acc: 0.214 Test Loss: 3.569 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6221475601196289
Epoch: 55, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.558 Vali Acc: 0.220 Test Loss: 3.558 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5312016010284424
Epoch: 56, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.571 Vali Acc: 0.219 Test Loss: 3.571 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5514512062072754
Epoch: 57, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.566 Vali Acc: 0.218 Test Loss: 3.566 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.598710298538208
Epoch: 58, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.587 Vali Acc: 0.222 Test Loss: 3.587 Test Acc: 0.222
Validation loss decreased (-0.221141 --> -0.222317).  Saving model ...
Epoch: 59 cost time: 0.5669019222259521
Epoch: 59, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.608 Vali Acc: 0.221 Test Loss: 3.608 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5566129684448242
Epoch: 60, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.602 Vali Acc: 0.222 Test Loss: 3.602 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5537104606628418
Epoch: 61, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.625 Vali Acc: 0.224 Test Loss: 3.625 Test Acc: 0.224
Validation loss decreased (-0.222317 --> -0.223493).  Saving model ...
Epoch: 62 cost time: 0.5665569305419922
Epoch: 62, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.620 Vali Acc: 0.219 Test Loss: 3.620 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5492470264434814
Epoch: 63, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.638 Vali Acc: 0.222 Test Loss: 3.638 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5456061363220215
Epoch: 64, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.644 Vali Acc: 0.222 Test Loss: 3.644 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6014351844787598
Epoch: 65, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.683 Vali Acc: 0.228 Test Loss: 3.683 Test Acc: 0.228
Validation loss decreased (-0.223493 --> -0.228198).  Saving model ...
Epoch: 66 cost time: 0.601923942565918
Epoch: 66, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.702 Vali Acc: 0.226 Test Loss: 3.702 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5341107845306396
Epoch: 67, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.717 Vali Acc: 0.228 Test Loss: 3.717 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5613877773284912
Epoch: 68, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.700 Vali Acc: 0.233 Test Loss: 3.700 Test Acc: 0.233
Validation loss decreased (-0.228198 --> -0.232904).  Saving model ...
Epoch: 69 cost time: 0.5870420932769775
Epoch: 69, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.699 Vali Acc: 0.228 Test Loss: 3.699 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5925469398498535
Epoch: 70, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.684 Vali Acc: 0.231 Test Loss: 3.684 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6174840927124023
Epoch: 71, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.716 Vali Acc: 0.232 Test Loss: 3.716 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5819854736328125
Epoch: 72, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.746 Vali Acc: 0.238 Test Loss: 3.746 Test Acc: 0.238
Validation loss decreased (-0.232904 --> -0.237610).  Saving model ...
Epoch: 73 cost time: 0.584057092666626
Epoch: 73, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.745 Vali Acc: 0.233 Test Loss: 3.745 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5510196685791016
Epoch: 74, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.761 Vali Acc: 0.236 Test Loss: 3.761 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5450043678283691
Epoch: 75, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.773 Vali Acc: 0.235 Test Loss: 3.773 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.6935403347015381
Epoch: 76, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.784 Vali Acc: 0.229 Test Loss: 3.784 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.5838141441345215
Epoch: 77, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.764 Vali Acc: 0.236 Test Loss: 3.764 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.563079833984375
Epoch: 78, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.795 Vali Acc: 0.238 Test Loss: 3.795 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.583967924118042
Epoch: 79, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.804 Vali Acc: 0.229 Test Loss: 3.804 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5906312465667725
Epoch: 80, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.790 Vali Acc: 0.242 Test Loss: 3.790 Test Acc: 0.242
Validation loss decreased (-0.237610 --> -0.242315).  Saving model ...
Epoch: 81 cost time: 0.577359676361084
Epoch: 81, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.835 Vali Acc: 0.236 Test Loss: 3.835 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.501945972442627
Epoch: 82, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.857 Vali Acc: 0.235 Test Loss: 3.857 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.5018117427825928
Epoch: 83, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.873 Vali Acc: 0.235 Test Loss: 3.873 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.5431740283966064
Epoch: 84, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.868 Vali Acc: 0.228 Test Loss: 3.868 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.562706708908081
Epoch: 85, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.857 Vali Acc: 0.233 Test Loss: 3.857 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.5335249900817871
Epoch: 86, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.855 Vali Acc: 0.235 Test Loss: 3.855 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.5670671463012695
Epoch: 87, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.874 Vali Acc: 0.236 Test Loss: 3.874 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.5358536243438721
Epoch: 88, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.880 Vali Acc: 0.242 Test Loss: 3.880 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.5608484745025635
Epoch: 89, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.916 Vali Acc: 0.242 Test Loss: 3.916 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.517765998840332
Epoch: 90, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.928 Vali Acc: 0.241 Test Loss: 3.928 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 26826
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5520315170288086
Epoch: 1, Steps: 10 | Train Loss: 3.463 Vali Loss: 3.354 Vali Acc: 0.045 Test Loss: 3.354 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.5765523910522461
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.325 Vali Acc: 0.044 Test Loss: 3.325 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.562293529510498
Epoch: 3, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.364 Vali Acc: 0.055 Test Loss: 3.364 Test Acc: 0.055
Validation loss decreased (-0.044672 --> -0.055260).  Saving model ...
Epoch: 4 cost time: 0.5847954750061035
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.358 Vali Acc: 0.082 Test Loss: 3.358 Test Acc: 0.082
Validation loss decreased (-0.055260 --> -0.082319).  Saving model ...
Epoch: 5 cost time: 0.5955090522766113
Epoch: 5, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.304 Vali Acc: 0.087 Test Loss: 3.304 Test Acc: 0.087
Validation loss decreased (-0.082319 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 0.5535821914672852
Epoch: 6, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.267 Vali Acc: 0.101 Test Loss: 3.267 Test Acc: 0.101
Validation loss decreased (-0.087026 --> -0.101144).  Saving model ...
Epoch: 7 cost time: 0.5778994560241699
Epoch: 7, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.254 Vali Acc: 0.119 Test Loss: 3.254 Test Acc: 0.119
Validation loss decreased (-0.101144 --> -0.118791).  Saving model ...
Epoch: 8 cost time: 0.5793392658233643
Epoch: 8, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.236 Vali Acc: 0.127 Test Loss: 3.236 Test Acc: 0.127
Validation loss decreased (-0.118791 --> -0.127026).  Saving model ...
Epoch: 9 cost time: 0.5825595855712891
Epoch: 9, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.246 Vali Acc: 0.146 Test Loss: 3.246 Test Acc: 0.146
Validation loss decreased (-0.127026 --> -0.145850).  Saving model ...
Epoch: 10 cost time: 0.5462753772735596
Epoch: 10, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.228 Vali Acc: 0.151 Test Loss: 3.228 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 11 cost time: 0.5997931957244873
Epoch: 11, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.261 Vali Acc: 0.165 Test Loss: 3.261 Test Acc: 0.165
Validation loss decreased (-0.150556 --> -0.164673).  Saving model ...
Epoch: 12 cost time: 0.6106724739074707
Epoch: 12, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.267 Vali Acc: 0.173 Test Loss: 3.267 Test Acc: 0.173
Validation loss decreased (-0.164673 --> -0.172909).  Saving model ...
Epoch: 13 cost time: 0.5677244663238525
Epoch: 13, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.302 Vali Acc: 0.181 Test Loss: 3.302 Test Acc: 0.181
Validation loss decreased (-0.172909 --> -0.181143).  Saving model ...
Epoch: 14 cost time: 0.6609606742858887
Epoch: 14, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.355 Vali Acc: 0.195 Test Loss: 3.355 Test Acc: 0.195
Validation loss decreased (-0.181143 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 0.6020259857177734
Epoch: 15, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.389 Vali Acc: 0.204 Test Loss: 3.389 Test Acc: 0.204
Validation loss decreased (-0.195261 --> -0.203496).  Saving model ...
Epoch: 16 cost time: 0.5891048908233643
Epoch: 16, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.440 Vali Acc: 0.206 Test Loss: 3.440 Test Acc: 0.206
Validation loss decreased (-0.203496 --> -0.205848).  Saving model ...
Epoch: 17 cost time: 0.5926501750946045
Epoch: 17, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.444 Vali Acc: 0.211 Test Loss: 3.444 Test Acc: 0.211
Validation loss decreased (-0.205848 --> -0.210554).  Saving model ...
Epoch: 18 cost time: 0.6517949104309082
Epoch: 18, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.559 Vali Acc: 0.220 Test Loss: 3.559 Test Acc: 0.220
Validation loss decreased (-0.210554 --> -0.219964).  Saving model ...
Epoch: 19 cost time: 0.573693037033081
Epoch: 19, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.641 Vali Acc: 0.226 Test Loss: 3.641 Test Acc: 0.226
Validation loss decreased (-0.219964 --> -0.225846).  Saving model ...
Epoch: 20 cost time: 0.6029698848724365
Epoch: 20, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.705 Vali Acc: 0.236 Test Loss: 3.705 Test Acc: 0.236
Validation loss decreased (-0.225846 --> -0.236434).  Saving model ...
Epoch: 21 cost time: 0.6017599105834961
Epoch: 21, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.824 Vali Acc: 0.241 Test Loss: 3.824 Test Acc: 0.241
Validation loss decreased (-0.236434 --> -0.241138).  Saving model ...
Epoch: 22 cost time: 0.5841159820556641
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.871 Vali Acc: 0.233 Test Loss: 3.871 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5929467678070068
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.933 Vali Acc: 0.229 Test Loss: 3.933 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5690689086914062
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.007 Vali Acc: 0.233 Test Loss: 4.007 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5979642868041992
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.031 Vali Acc: 0.240 Test Loss: 4.031 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5623059272766113
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.095 Vali Acc: 0.247 Test Loss: 4.095 Test Acc: 0.247
Validation loss decreased (-0.241138 --> -0.247018).  Saving model ...
Epoch: 27 cost time: 0.5895428657531738
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.115 Vali Acc: 0.254 Test Loss: 4.115 Test Acc: 0.254
Validation loss decreased (-0.247018 --> -0.254076).  Saving model ...
Epoch: 28 cost time: 0.5612452030181885
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.164 Vali Acc: 0.245 Test Loss: 4.164 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5717909336090088
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.188 Vali Acc: 0.247 Test Loss: 4.188 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5723402500152588
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.236 Vali Acc: 0.252 Test Loss: 4.236 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5496251583099365
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.251 Vali Acc: 0.251 Test Loss: 4.251 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5446579456329346
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.272 Vali Acc: 0.246 Test Loss: 4.272 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5836520195007324
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.276 Vali Acc: 0.251 Test Loss: 4.276 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5906383991241455
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.300 Vali Acc: 0.249 Test Loss: 4.300 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5537619590759277
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.324 Vali Acc: 0.253 Test Loss: 4.324 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5977640151977539
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.352 Vali Acc: 0.253 Test Loss: 4.352 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5791277885437012
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.378 Vali Acc: 0.254 Test Loss: 4.378 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 104810
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6316537857055664
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.354 Vali Acc: 0.041 Test Loss: 3.354 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.6736156940460205
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.313 Vali Acc: 0.036 Test Loss: 3.313 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5715329647064209
Epoch: 3, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.307 Vali Acc: 0.053 Test Loss: 3.307 Test Acc: 0.053
Validation loss decreased (-0.041143 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.5765204429626465
Epoch: 4, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.303 Vali Acc: 0.067 Test Loss: 3.303 Test Acc: 0.067
Validation loss decreased (-0.052908 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.5615625381469727
Epoch: 5, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.303 Vali Acc: 0.078 Test Loss: 3.303 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 0.5458066463470459
Epoch: 6, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.287 Vali Acc: 0.093 Test Loss: 3.287 Test Acc: 0.093
Validation loss decreased (-0.077614 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 0.5200505256652832
Epoch: 7, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.271 Vali Acc: 0.105 Test Loss: 3.271 Test Acc: 0.105
Validation loss decreased (-0.092908 --> -0.104673).  Saving model ...
Epoch: 8 cost time: 0.5716197490692139
Epoch: 8, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.249 Vali Acc: 0.114 Test Loss: 3.249 Test Acc: 0.114
Validation loss decreased (-0.104673 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.4958925247192383
Epoch: 9, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.246 Vali Acc: 0.112 Test Loss: 3.246 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5379698276519775
Epoch: 10, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.231 Vali Acc: 0.126 Test Loss: 3.231 Test Acc: 0.126
Validation loss decreased (-0.114085 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 0.5146887302398682
Epoch: 11, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.204 Vali Acc: 0.142 Test Loss: 3.204 Test Acc: 0.142
Validation loss decreased (-0.125850 --> -0.142321).  Saving model ...
Epoch: 12 cost time: 0.5290977954864502
Epoch: 12, Steps: 10 | Train Loss: 1.960 Vali Loss: 3.203 Vali Acc: 0.149 Test Loss: 3.203 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 13 cost time: 0.6080565452575684
Epoch: 13, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
Validation loss decreased (-0.149380 --> -0.158791).  Saving model ...
Epoch: 14 cost time: 0.5657680034637451
Epoch: 14, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.219 Vali Acc: 0.178 Test Loss: 3.219 Test Acc: 0.178
Validation loss decreased (-0.158791 --> -0.177615).  Saving model ...
Epoch: 15 cost time: 0.5160236358642578
Epoch: 15, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.225 Vali Acc: 0.193 Test Loss: 3.225 Test Acc: 0.193
Validation loss decreased (-0.177615 --> -0.192909).  Saving model ...
Epoch: 16 cost time: 0.4606170654296875
Epoch: 16, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.240 Vali Acc: 0.202 Test Loss: 3.240 Test Acc: 0.202
Validation loss decreased (-0.192909 --> -0.202321).  Saving model ...
Epoch: 17 cost time: 0.5553703308105469
Epoch: 17, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.255 Vali Acc: 0.202 Test Loss: 3.255 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5412900447845459
Epoch: 18, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.298 Vali Acc: 0.206 Test Loss: 3.298 Test Acc: 0.206
Validation loss decreased (-0.202321 --> -0.205849).  Saving model ...
Epoch: 19 cost time: 0.499692440032959
Epoch: 19, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.331 Vali Acc: 0.214 Test Loss: 3.331 Test Acc: 0.214
Validation loss decreased (-0.205849 --> -0.214084).  Saving model ...
Epoch: 20 cost time: 0.5562357902526855
Epoch: 20, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.359 Vali Acc: 0.222 Test Loss: 3.359 Test Acc: 0.222
Validation loss decreased (-0.214084 --> -0.222319).  Saving model ...
Epoch: 21 cost time: 0.5306541919708252
Epoch: 21, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.374 Vali Acc: 0.236 Test Loss: 3.374 Test Acc: 0.236
Validation loss decreased (-0.222319 --> -0.236437).  Saving model ...
Epoch: 22 cost time: 0.582148551940918
Epoch: 22, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.423 Vali Acc: 0.226 Test Loss: 3.423 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5869677066802979
Epoch: 23, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.447 Vali Acc: 0.229 Test Loss: 3.447 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5704629421234131
Epoch: 24, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.479 Vali Acc: 0.225 Test Loss: 3.479 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5341856479644775
Epoch: 25, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.514 Vali Acc: 0.229 Test Loss: 3.514 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5570333003997803
Epoch: 26, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.583 Vali Acc: 0.236 Test Loss: 3.583 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5312831401824951
Epoch: 27, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.630 Vali Acc: 0.240 Test Loss: 3.630 Test Acc: 0.240
Validation loss decreased (-0.236437 --> -0.239964).  Saving model ...
Epoch: 28 cost time: 0.5061929225921631
Epoch: 28, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.668 Vali Acc: 0.236 Test Loss: 3.668 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5798249244689941
Epoch: 29, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.706 Vali Acc: 0.247 Test Loss: 3.706 Test Acc: 0.247
Validation loss decreased (-0.239964 --> -0.247022).  Saving model ...
Epoch: 30 cost time: 0.5851948261260986
Epoch: 30, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.744 Vali Acc: 0.241 Test Loss: 3.744 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5587203502655029
Epoch: 31, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.800 Vali Acc: 0.241 Test Loss: 3.800 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5272338390350342
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.854 Vali Acc: 0.246 Test Loss: 3.854 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5377328395843506
Epoch: 33, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.887 Vali Acc: 0.246 Test Loss: 3.887 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5211319923400879
Epoch: 34, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.919 Vali Acc: 0.244 Test Loss: 3.919 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5499393939971924
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.976 Vali Acc: 0.242 Test Loss: 3.976 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5170693397521973
Epoch: 36, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.991 Vali Acc: 0.241 Test Loss: 3.991 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5375525951385498
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.002 Vali Acc: 0.245 Test Loss: 4.002 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.520592451095581
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.033 Vali Acc: 0.251 Test Loss: 4.033 Test Acc: 0.251
Validation loss decreased (-0.247022 --> -0.250548).  Saving model ...
Epoch: 39 cost time: 0.548743486404419
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.051 Vali Acc: 0.249 Test Loss: 4.051 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.49254512786865234
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.088 Vali Acc: 0.247 Test Loss: 4.088 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5603175163269043
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.122 Vali Acc: 0.244 Test Loss: 4.122 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5721983909606934
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.151 Vali Acc: 0.245 Test Loss: 4.151 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5106744766235352
Epoch: 43, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.161 Vali Acc: 0.245 Test Loss: 4.161 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5707502365112305
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.167 Vali Acc: 0.248 Test Loss: 4.167 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5337848663330078
Epoch: 45, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.189 Vali Acc: 0.252 Test Loss: 4.189 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251723).  Saving model ...
Epoch: 46 cost time: 0.5676698684692383
Epoch: 46, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.211 Vali Acc: 0.249 Test Loss: 4.211 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5208337306976318
Epoch: 47, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.234 Vali Acc: 0.252 Test Loss: 4.234 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5317611694335938
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.266 Vali Acc: 0.255 Test Loss: 4.266 Test Acc: 0.255
Validation loss decreased (-0.251723 --> -0.255251).  Saving model ...
Epoch: 49 cost time: 0.5624785423278809
Epoch: 49, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.272 Vali Acc: 0.258 Test Loss: 4.272 Test Acc: 0.258
Validation loss decreased (-0.255251 --> -0.257604).  Saving model ...
Epoch: 50 cost time: 0.5195646286010742
Epoch: 50, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.281 Vali Acc: 0.258 Test Loss: 4.281 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5254311561584473
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.293 Vali Acc: 0.254 Test Loss: 4.293 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5433657169342041
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.312 Vali Acc: 0.256 Test Loss: 4.312 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.6054370403289795
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.346 Vali Acc: 0.256 Test Loss: 4.346 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5588738918304443
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.375 Vali Acc: 0.255 Test Loss: 4.375 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6044261455535889
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.395 Vali Acc: 0.254 Test Loss: 4.395 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5209624767303467
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.419 Vali Acc: 0.258 Test Loss: 4.419 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5222330093383789
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.403 Vali Acc: 0.255 Test Loss: 4.403 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6183140277862549
Epoch: 58, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.412 Vali Acc: 0.258 Test Loss: 4.412 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6024949550628662
Epoch: 59, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.424 Vali Acc: 0.260 Test Loss: 4.424 Test Acc: 0.260
Validation loss decreased (-0.257604 --> -0.259956).  Saving model ...
Epoch: 60 cost time: 0.5392904281616211
Epoch: 60, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.452 Vali Acc: 0.256 Test Loss: 4.452 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5486531257629395
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.474 Vali Acc: 0.255 Test Loss: 4.474 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5373833179473877
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.476 Vali Acc: 0.255 Test Loss: 4.476 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5145184993743896
Epoch: 63, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.476 Vali Acc: 0.254 Test Loss: 4.476 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6300084590911865
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.499 Vali Acc: 0.258 Test Loss: 4.499 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.534334659576416
Epoch: 65, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.491 Vali Acc: 0.252 Test Loss: 4.491 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5765843391418457
Epoch: 66, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.510 Vali Acc: 0.254 Test Loss: 4.510 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5396475791931152
Epoch: 67, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.534 Vali Acc: 0.253 Test Loss: 4.534 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.5832180976867676
Epoch: 68, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.548 Vali Acc: 0.255 Test Loss: 4.548 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.5305969715118408
Epoch: 69, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.558 Vali Acc: 0.258 Test Loss: 4.558 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 57450
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.59716796875
Epoch: 1, Steps: 10 | Train Loss: 3.480 Vali Loss: 3.393 Vali Acc: 0.045 Test Loss: 3.393 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.4978933334350586
Epoch: 2, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.363 Vali Acc: 0.039 Test Loss: 3.363 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5341238975524902
Epoch: 3, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.346 Vali Acc: 0.036 Test Loss: 3.346 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.569183349609375
Epoch: 4, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.336 Vali Acc: 0.042 Test Loss: 3.336 Test Acc: 0.042
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5909044742584229
Epoch: 5, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.339 Vali Acc: 0.056 Test Loss: 3.339 Test Acc: 0.056
Validation loss decreased (-0.044672 --> -0.056437).  Saving model ...
Epoch: 6 cost time: 0.532081127166748
Epoch: 6, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.336 Vali Acc: 0.067 Test Loss: 3.336 Test Acc: 0.067
Validation loss decreased (-0.056437 --> -0.067025).  Saving model ...
Epoch: 7 cost time: 0.5563042163848877
Epoch: 7, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.333 Vali Acc: 0.069 Test Loss: 3.333 Test Acc: 0.069
Validation loss decreased (-0.067025 --> -0.069378).  Saving model ...
Epoch: 8 cost time: 0.5782468318939209
Epoch: 8, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.324 Vali Acc: 0.080 Test Loss: 3.324 Test Acc: 0.080
Validation loss decreased (-0.069378 --> -0.079967).  Saving model ...
Epoch: 9 cost time: 0.5142078399658203
Epoch: 9, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.319 Vali Acc: 0.081 Test Loss: 3.319 Test Acc: 0.081
Validation loss decreased (-0.079967 --> -0.081143).  Saving model ...
Epoch: 10 cost time: 0.5872421264648438
Epoch: 10, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.303 Vali Acc: 0.095 Test Loss: 3.303 Test Acc: 0.095
Validation loss decreased (-0.081143 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 0.5829620361328125
Epoch: 11, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.283 Vali Acc: 0.109 Test Loss: 3.283 Test Acc: 0.109
Validation loss decreased (-0.095261 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 0.5605278015136719
Epoch: 12, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.273 Vali Acc: 0.115 Test Loss: 3.273 Test Acc: 0.115
Validation loss decreased (-0.109379 --> -0.115261).  Saving model ...
Epoch: 13 cost time: 0.5730538368225098
Epoch: 13, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.273 Vali Acc: 0.126 Test Loss: 3.273 Test Acc: 0.126
Validation loss decreased (-0.115261 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.5586869716644287
Epoch: 14, Steps: 10 | Train Loss: 2.100 Vali Loss: 3.267 Vali Acc: 0.138 Test Loss: 3.267 Test Acc: 0.138
Validation loss decreased (-0.125850 --> -0.137614).  Saving model ...
Epoch: 15 cost time: 0.49623703956604004
Epoch: 15, Steps: 10 | Train Loss: 1.992 Vali Loss: 3.266 Vali Acc: 0.144 Test Loss: 3.266 Test Acc: 0.144
Validation loss decreased (-0.137614 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 0.6573712825775146
Epoch: 16, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.263 Vali Acc: 0.148 Test Loss: 3.263 Test Acc: 0.148
Validation loss decreased (-0.143497 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.5305976867675781
Epoch: 17, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.266 Vali Acc: 0.155 Test Loss: 3.266 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155261).  Saving model ...
Epoch: 18 cost time: 0.6089344024658203
Epoch: 18, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.268 Vali Acc: 0.164 Test Loss: 3.268 Test Acc: 0.164
Validation loss decreased (-0.155261 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 0.5657289028167725
Epoch: 19, Steps: 10 | Train Loss: 1.441 Vali Loss: 3.273 Vali Acc: 0.171 Test Loss: 3.273 Test Acc: 0.171
Validation loss decreased (-0.163497 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.6237044334411621
Epoch: 20, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.279 Vali Acc: 0.173 Test Loss: 3.279 Test Acc: 0.173
Validation loss decreased (-0.170556 --> -0.172908).  Saving model ...
Epoch: 21 cost time: 0.628288745880127
Epoch: 21, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.300 Vali Acc: 0.182 Test Loss: 3.300 Test Acc: 0.182
Validation loss decreased (-0.172908 --> -0.182320).  Saving model ...
Epoch: 22 cost time: 0.5745582580566406
Epoch: 22, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.324 Vali Acc: 0.191 Test Loss: 3.324 Test Acc: 0.191
Validation loss decreased (-0.182320 --> -0.190555).  Saving model ...
Epoch: 23 cost time: 0.4878389835357666
Epoch: 23, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.349 Vali Acc: 0.188 Test Loss: 3.349 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6549072265625
Epoch: 24, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.370 Vali Acc: 0.199 Test Loss: 3.370 Test Acc: 0.199
Validation loss decreased (-0.190555 --> -0.198790).  Saving model ...
Epoch: 25 cost time: 0.6002066135406494
Epoch: 25, Steps: 10 | Train Loss: 0.849 Vali Loss: 3.392 Vali Acc: 0.201 Test Loss: 3.392 Test Acc: 0.201
Validation loss decreased (-0.198790 --> -0.201143).  Saving model ...
Epoch: 26 cost time: 0.5760180950164795
Epoch: 26, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.406 Vali Acc: 0.209 Test Loss: 3.406 Test Acc: 0.209
Validation loss decreased (-0.201143 --> -0.209378).  Saving model ...
Epoch: 27 cost time: 0.574099063873291
Epoch: 27, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.425 Vali Acc: 0.219 Test Loss: 3.425 Test Acc: 0.219
Validation loss decreased (-0.209378 --> -0.218789).  Saving model ...
Epoch: 28 cost time: 0.6185550689697266
Epoch: 28, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.446 Vali Acc: 0.216 Test Loss: 3.446 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5670115947723389
Epoch: 29, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.477 Vali Acc: 0.224 Test Loss: 3.477 Test Acc: 0.224
Validation loss decreased (-0.218789 --> -0.223495).  Saving model ...
Epoch: 30 cost time: 0.6045498847961426
Epoch: 30, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.512 Vali Acc: 0.225 Test Loss: 3.512 Test Acc: 0.225
Validation loss decreased (-0.223495 --> -0.224671).  Saving model ...
Epoch: 31 cost time: 0.6234078407287598
Epoch: 31, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.547 Vali Acc: 0.224 Test Loss: 3.547 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5847115516662598
Epoch: 32, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.552 Vali Acc: 0.225 Test Loss: 3.552 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5412986278533936
Epoch: 33, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.597 Vali Acc: 0.222 Test Loss: 3.597 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5517570972442627
Epoch: 34, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.620 Vali Acc: 0.222 Test Loss: 3.620 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5960397720336914
Epoch: 35, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.661 Vali Acc: 0.222 Test Loss: 3.661 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5530734062194824
Epoch: 36, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.665 Vali Acc: 0.218 Test Loss: 3.665 Test Acc: 0.218
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5842795372009277
Epoch: 37, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.699 Vali Acc: 0.213 Test Loss: 3.699 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5464789867401123
Epoch: 38, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.737 Vali Acc: 0.214 Test Loss: 3.737 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.602501630783081
Epoch: 39, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.767 Vali Acc: 0.209 Test Loss: 3.767 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5286743640899658
Epoch: 40, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.802 Vali Acc: 0.214 Test Loss: 3.802 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22470588235294117
model parameter : 41290
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6089363098144531
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.382 Vali Acc: 0.036 Test Loss: 3.382 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5413572788238525
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.372 Vali Acc: 0.040 Test Loss: 3.372 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.5530626773834229
Epoch: 3, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.363 Vali Acc: 0.052 Test Loss: 3.363 Test Acc: 0.052
Validation loss decreased (-0.039966 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 0.5598568916320801
Epoch: 4, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.352 Vali Acc: 0.064 Test Loss: 3.352 Test Acc: 0.064
Validation loss decreased (-0.051731 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 0.5287525653839111
Epoch: 5, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.345 Vali Acc: 0.074 Test Loss: 3.345 Test Acc: 0.074
Validation loss decreased (-0.063496 --> -0.074084).  Saving model ...
Epoch: 6 cost time: 0.551978588104248
Epoch: 6, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.336 Vali Acc: 0.076 Test Loss: 3.336 Test Acc: 0.076
Validation loss decreased (-0.074084 --> -0.076437).  Saving model ...
Epoch: 7 cost time: 0.5451023578643799
Epoch: 7, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.334 Vali Acc: 0.084 Test Loss: 3.334 Test Acc: 0.084
Validation loss decreased (-0.076437 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 0.5549576282501221
Epoch: 8, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.320 Vali Acc: 0.091 Test Loss: 3.320 Test Acc: 0.091
Validation loss decreased (-0.083496 --> -0.090555).  Saving model ...
Epoch: 9 cost time: 0.508164644241333
Epoch: 9, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.310 Vali Acc: 0.095 Test Loss: 3.310 Test Acc: 0.095
Validation loss decreased (-0.090555 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.5695130825042725
Epoch: 10, Steps: 10 | Train Loss: 2.671 Vali Loss: 3.296 Vali Acc: 0.098 Test Loss: 3.296 Test Acc: 0.098
Validation loss decreased (-0.095261 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 0.5505743026733398
Epoch: 11, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.281 Vali Acc: 0.099 Test Loss: 3.281 Test Acc: 0.099
Validation loss decreased (-0.097614 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 0.5327231884002686
Epoch: 12, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.272 Vali Acc: 0.113 Test Loss: 3.272 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112908).  Saving model ...
Epoch: 13 cost time: 0.5366754531860352
Epoch: 13, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.268 Vali Acc: 0.127 Test Loss: 3.268 Test Acc: 0.127
Validation loss decreased (-0.112908 --> -0.127026).  Saving model ...
Epoch: 14 cost time: 0.532517671585083
Epoch: 14, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.266 Vali Acc: 0.134 Test Loss: 3.266 Test Acc: 0.134
Validation loss decreased (-0.127026 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.5951480865478516
Epoch: 15, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.257 Vali Acc: 0.136 Test Loss: 3.257 Test Acc: 0.136
Validation loss decreased (-0.134085 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.5536322593688965
Epoch: 16, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.251 Vali Acc: 0.138 Test Loss: 3.251 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137615).  Saving model ...
Epoch: 17 cost time: 0.5759193897247314
Epoch: 17, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.252 Vali Acc: 0.142 Test Loss: 3.252 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142320).  Saving model ...
Epoch: 18 cost time: 0.4779672622680664
Epoch: 18, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.250 Vali Acc: 0.153 Test Loss: 3.250 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152909).  Saving model ...
Epoch: 19 cost time: 0.5542242527008057
Epoch: 19, Steps: 10 | Train Loss: 1.662 Vali Loss: 3.251 Vali Acc: 0.153 Test Loss: 3.251 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.55653977394104
Epoch: 20, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.262 Vali Acc: 0.159 Test Loss: 3.262 Test Acc: 0.159
Validation loss decreased (-0.152909 --> -0.158791).  Saving model ...
Epoch: 21 cost time: 0.5940742492675781
Epoch: 21, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.274 Vali Acc: 0.164 Test Loss: 3.274 Test Acc: 0.164
Validation loss decreased (-0.158791 --> -0.163497).  Saving model ...
Epoch: 22 cost time: 0.5417563915252686
Epoch: 22, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.272 Vali Acc: 0.172 Test Loss: 3.272 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 23 cost time: 0.6128370761871338
Epoch: 23, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.276 Vali Acc: 0.187 Test Loss: 3.276 Test Acc: 0.187
Validation loss decreased (-0.171732 --> -0.187026).  Saving model ...
Epoch: 24 cost time: 0.5554931163787842
Epoch: 24, Steps: 10 | Train Loss: 1.249 Vali Loss: 3.300 Vali Acc: 0.188 Test Loss: 3.300 Test Acc: 0.188
Validation loss decreased (-0.187026 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.6111617088317871
Epoch: 25, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.333 Vali Acc: 0.194 Test Loss: 3.333 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 26 cost time: 0.5754051208496094
Epoch: 26, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.333 Vali Acc: 0.201 Test Loss: 3.333 Test Acc: 0.201
Validation loss decreased (-0.194084 --> -0.201143).  Saving model ...
Epoch: 27 cost time: 0.5828404426574707
Epoch: 27, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.336 Vali Acc: 0.213 Test Loss: 3.336 Test Acc: 0.213
Validation loss decreased (-0.201143 --> -0.212908).  Saving model ...
Epoch: 28 cost time: 0.5850496292114258
Epoch: 28, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.353 Vali Acc: 0.207 Test Loss: 3.353 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6122360229492188
Epoch: 29, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.384 Vali Acc: 0.221 Test Loss: 3.384 Test Acc: 0.221
Validation loss decreased (-0.212908 --> -0.221143).  Saving model ...
Epoch: 30 cost time: 0.6257798671722412
Epoch: 30, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.406 Vali Acc: 0.222 Test Loss: 3.406 Test Acc: 0.222
Validation loss decreased (-0.221143 --> -0.222319).  Saving model ...
Epoch: 31 cost time: 0.6409420967102051
Epoch: 31, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.426 Vali Acc: 0.227 Test Loss: 3.426 Test Acc: 0.227
Validation loss decreased (-0.222319 --> -0.227025).  Saving model ...
Epoch: 32 cost time: 0.6217315196990967
Epoch: 32, Steps: 10 | Train Loss: 0.697 Vali Loss: 3.455 Vali Acc: 0.239 Test Loss: 3.455 Test Acc: 0.239
Validation loss decreased (-0.227025 --> -0.238789).  Saving model ...
Epoch: 33 cost time: 0.49567604064941406
Epoch: 33, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.488 Vali Acc: 0.238 Test Loss: 3.488 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5688772201538086
Epoch: 34, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.530 Vali Acc: 0.226 Test Loss: 3.530 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5594305992126465
Epoch: 35, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.542 Vali Acc: 0.240 Test Loss: 3.542 Test Acc: 0.240
Validation loss decreased (-0.238789 --> -0.239965).  Saving model ...
Epoch: 36 cost time: 0.5594730377197266
Epoch: 36, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.553 Vali Acc: 0.239 Test Loss: 3.553 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5297996997833252
Epoch: 37, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.563 Vali Acc: 0.235 Test Loss: 3.563 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5401382446289062
Epoch: 38, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.598 Vali Acc: 0.236 Test Loss: 3.598 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.59175705909729
Epoch: 39, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.639 Vali Acc: 0.234 Test Loss: 3.639 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5736749172210693
Epoch: 40, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.671 Vali Acc: 0.236 Test Loss: 3.671 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5469241142272949
Epoch: 41, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.689 Vali Acc: 0.239 Test Loss: 3.689 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5248367786407471
Epoch: 42, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.705 Vali Acc: 0.241 Test Loss: 3.705 Test Acc: 0.241
Validation loss decreased (-0.239965 --> -0.241139).  Saving model ...
Epoch: 43 cost time: 0.521571159362793
Epoch: 43, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.741 Vali Acc: 0.238 Test Loss: 3.741 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5350151062011719
Epoch: 44, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.768 Vali Acc: 0.240 Test Loss: 3.768 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5213742256164551
Epoch: 45, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.773 Vali Acc: 0.240 Test Loss: 3.773 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5514435768127441
Epoch: 46, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.786 Vali Acc: 0.242 Test Loss: 3.786 Test Acc: 0.242
Validation loss decreased (-0.241139 --> -0.242315).  Saving model ...
Epoch: 47 cost time: 0.5537617206573486
Epoch: 47, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.806 Vali Acc: 0.242 Test Loss: 3.806 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5264651775360107
Epoch: 48, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.829 Vali Acc: 0.248 Test Loss: 3.829 Test Acc: 0.248
Validation loss decreased (-0.242315 --> -0.248197).  Saving model ...
Epoch: 49 cost time: 0.5656857490539551
Epoch: 49, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.848 Vali Acc: 0.253 Test Loss: 3.848 Test Acc: 0.253
Validation loss decreased (-0.248197 --> -0.252903).  Saving model ...
Epoch: 50 cost time: 0.5785024166107178
Epoch: 50, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.873 Vali Acc: 0.249 Test Loss: 3.873 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6104683876037598
Epoch: 51, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.887 Vali Acc: 0.255 Test Loss: 3.887 Test Acc: 0.255
Validation loss decreased (-0.252903 --> -0.255255).  Saving model ...
Epoch: 52 cost time: 0.5790746212005615
Epoch: 52, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.912 Vali Acc: 0.253 Test Loss: 3.912 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5471222400665283
Epoch: 53, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.917 Vali Acc: 0.251 Test Loss: 3.917 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5638618469238281
Epoch: 54, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.925 Vali Acc: 0.253 Test Loss: 3.925 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5830016136169434
Epoch: 55, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.947 Vali Acc: 0.251 Test Loss: 3.947 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.530980110168457
Epoch: 56, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.981 Vali Acc: 0.256 Test Loss: 3.981 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256431).  Saving model ...
Epoch: 57 cost time: 0.6461646556854248
Epoch: 57, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.003 Vali Acc: 0.254 Test Loss: 4.003 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5684719085693359
Epoch: 58, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.003 Vali Acc: 0.254 Test Loss: 4.003 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5482091903686523
Epoch: 59, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.017 Vali Acc: 0.255 Test Loss: 4.017 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5581684112548828
Epoch: 60, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.040 Vali Acc: 0.261 Test Loss: 4.040 Test Acc: 0.261
Validation loss decreased (-0.256431 --> -0.261136).  Saving model ...
Epoch: 61 cost time: 0.49880051612854004
Epoch: 61, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.063 Vali Acc: 0.261 Test Loss: 4.063 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5813429355621338
Epoch: 62, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.096 Vali Acc: 0.259 Test Loss: 4.096 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5342121124267578
Epoch: 63, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.120 Vali Acc: 0.254 Test Loss: 4.120 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.524869441986084
Epoch: 64, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.142 Vali Acc: 0.256 Test Loss: 4.142 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5949463844299316
Epoch: 65, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.142 Vali Acc: 0.254 Test Loss: 4.142 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6347451210021973
Epoch: 66, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.142 Vali Acc: 0.252 Test Loss: 4.142 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6369802951812744
Epoch: 67, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.144 Vali Acc: 0.252 Test Loss: 4.144 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.6065788269042969
Epoch: 68, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.156 Vali Acc: 0.253 Test Loss: 4.156 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.5991973876953125
Epoch: 69, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.160 Vali Acc: 0.252 Test Loss: 4.160 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6131381988525391
Epoch: 70, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.211 Vali Acc: 0.254 Test Loss: 4.211 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 33866
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3700757026672363
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.350 Vali Acc: 0.022 Test Loss: 3.350 Test Acc: 0.022
Validation loss decreased (inf --> -0.022319).  Saving model ...
Epoch: 2 cost time: 0.5042316913604736
Epoch: 2, Steps: 10 | Train Loss: 3.417 Vali Loss: 3.361 Vali Acc: 0.029 Test Loss: 3.361 Test Acc: 0.029
Validation loss decreased (-0.022319 --> -0.029378).  Saving model ...
Epoch: 3 cost time: 0.5781939029693604
Epoch: 3, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.364 Vali Acc: 0.032 Test Loss: 3.364 Test Acc: 0.032
Validation loss decreased (-0.029378 --> -0.031731).  Saving model ...
Epoch: 4 cost time: 0.5358881950378418
Epoch: 4, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.357 Vali Acc: 0.035 Test Loss: 3.357 Test Acc: 0.035
Validation loss decreased (-0.031731 --> -0.035261).  Saving model ...
Epoch: 5 cost time: 0.5509319305419922
Epoch: 5, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.350 Vali Acc: 0.036 Test Loss: 3.350 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036437).  Saving model ...
Epoch: 6 cost time: 0.6185457706451416
Epoch: 6, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.345 Vali Acc: 0.044 Test Loss: 3.345 Test Acc: 0.044
Validation loss decreased (-0.036437 --> -0.043496).  Saving model ...
Epoch: 7 cost time: 0.5609147548675537
Epoch: 7, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.341 Vali Acc: 0.051 Test Loss: 3.341 Test Acc: 0.051
Validation loss decreased (-0.043496 --> -0.050555).  Saving model ...
Epoch: 8 cost time: 0.5006334781646729
Epoch: 8, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.333 Vali Acc: 0.061 Test Loss: 3.333 Test Acc: 0.061
Validation loss decreased (-0.050555 --> -0.061143).  Saving model ...
Epoch: 9 cost time: 0.5713353157043457
Epoch: 9, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.323 Vali Acc: 0.066 Test Loss: 3.323 Test Acc: 0.066
Validation loss decreased (-0.061143 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 0.5380780696868896
Epoch: 10, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.317 Vali Acc: 0.071 Test Loss: 3.317 Test Acc: 0.071
Validation loss decreased (-0.065849 --> -0.070555).  Saving model ...
Epoch: 11 cost time: 0.5213017463684082
Epoch: 11, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.311 Vali Acc: 0.075 Test Loss: 3.311 Test Acc: 0.075
Validation loss decreased (-0.070555 --> -0.075261).  Saving model ...
Epoch: 12 cost time: 0.552851676940918
Epoch: 12, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.302 Vali Acc: 0.074 Test Loss: 3.302 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5891819000244141
Epoch: 13, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.300 Vali Acc: 0.081 Test Loss: 3.300 Test Acc: 0.081
Validation loss decreased (-0.075261 --> -0.081143).  Saving model ...
Epoch: 14 cost time: 0.6342253684997559
Epoch: 14, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.289 Vali Acc: 0.091 Test Loss: 3.289 Test Acc: 0.091
Validation loss decreased (-0.081143 --> -0.090555).  Saving model ...
Epoch: 15 cost time: 0.5571064949035645
Epoch: 15, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.280 Vali Acc: 0.089 Test Loss: 3.280 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5546021461486816
Epoch: 16, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.274 Vali Acc: 0.099 Test Loss: 3.274 Test Acc: 0.099
Validation loss decreased (-0.090555 --> -0.098791).  Saving model ...
Epoch: 17 cost time: 0.4974365234375
Epoch: 17, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.261 Vali Acc: 0.100 Test Loss: 3.261 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099967).  Saving model ...
Epoch: 18 cost time: 0.5902023315429688
Epoch: 18, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.252 Vali Acc: 0.105 Test Loss: 3.252 Test Acc: 0.105
Validation loss decreased (-0.099967 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 0.589440107345581
Epoch: 19, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.251 Vali Acc: 0.115 Test Loss: 3.251 Test Acc: 0.115
Validation loss decreased (-0.104673 --> -0.115262).  Saving model ...
Epoch: 20 cost time: 0.60945725440979
Epoch: 20, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.244 Vali Acc: 0.122 Test Loss: 3.244 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122320).  Saving model ...
Epoch: 21 cost time: 0.5269641876220703
Epoch: 21, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.244 Vali Acc: 0.128 Test Loss: 3.244 Test Acc: 0.128
Validation loss decreased (-0.122320 --> -0.128203).  Saving model ...
Epoch: 22 cost time: 0.6213550567626953
Epoch: 22, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.239 Vali Acc: 0.132 Test Loss: 3.239 Test Acc: 0.132
Validation loss decreased (-0.128203 --> -0.131732).  Saving model ...
Epoch: 23 cost time: 0.5630161762237549
Epoch: 23, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.231 Vali Acc: 0.136 Test Loss: 3.231 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 24 cost time: 0.5505127906799316
Epoch: 24, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.226 Vali Acc: 0.146 Test Loss: 3.226 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 25 cost time: 0.5999019145965576
Epoch: 25, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.221 Vali Acc: 0.154 Test Loss: 3.221 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 26 cost time: 0.4980449676513672
Epoch: 26, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.223 Vali Acc: 0.158 Test Loss: 3.223 Test Acc: 0.158
Validation loss decreased (-0.154085 --> -0.157615).  Saving model ...
Epoch: 27 cost time: 0.5248441696166992
Epoch: 27, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.233 Vali Acc: 0.162 Test Loss: 3.233 Test Acc: 0.162
Validation loss decreased (-0.157615 --> -0.162321).  Saving model ...
Epoch: 28 cost time: 0.5445151329040527
Epoch: 28, Steps: 10 | Train Loss: 1.476 Vali Loss: 3.242 Vali Acc: 0.168 Test Loss: 3.242 Test Acc: 0.168
Validation loss decreased (-0.162321 --> -0.168203).  Saving model ...
Epoch: 29 cost time: 0.47707605361938477
Epoch: 29, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.247 Vali Acc: 0.180 Test Loss: 3.247 Test Acc: 0.180
Validation loss decreased (-0.168203 --> -0.179968).  Saving model ...
Epoch: 30 cost time: 0.5726747512817383
Epoch: 30, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.253 Vali Acc: 0.181 Test Loss: 3.253 Test Acc: 0.181
Validation loss decreased (-0.179968 --> -0.181144).  Saving model ...
Epoch: 31 cost time: 0.5648126602172852
Epoch: 31, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.258 Vali Acc: 0.186 Test Loss: 3.258 Test Acc: 0.186
Validation loss decreased (-0.181144 --> -0.185850).  Saving model ...
Epoch: 32 cost time: 0.5756857395172119
Epoch: 32, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.267 Vali Acc: 0.185 Test Loss: 3.267 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6477842330932617
Epoch: 33, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.283 Vali Acc: 0.191 Test Loss: 3.283 Test Acc: 0.191
Validation loss decreased (-0.185850 --> -0.190555).  Saving model ...
Epoch: 34 cost time: 0.5397286415100098
Epoch: 34, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.291 Vali Acc: 0.195 Test Loss: 3.291 Test Acc: 0.195
Validation loss decreased (-0.190555 --> -0.195261).  Saving model ...
Epoch: 35 cost time: 0.5460968017578125
Epoch: 35, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.306 Vali Acc: 0.195 Test Loss: 3.306 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.538017749786377
Epoch: 36, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.310 Vali Acc: 0.195 Test Loss: 3.310 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5310776233673096
Epoch: 37, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.324 Vali Acc: 0.200 Test Loss: 3.324 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 38 cost time: 0.53269362449646
Epoch: 38, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.343 Vali Acc: 0.207 Test Loss: 3.343 Test Acc: 0.207
Validation loss decreased (-0.199967 --> -0.207025).  Saving model ...
Epoch: 39 cost time: 0.5339114665985107
Epoch: 39, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.363 Vali Acc: 0.212 Test Loss: 3.363 Test Acc: 0.212
Validation loss decreased (-0.207025 --> -0.211731).  Saving model ...
Epoch: 40 cost time: 0.5441939830780029
Epoch: 40, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.388 Vali Acc: 0.213 Test Loss: 3.388 Test Acc: 0.213
Validation loss decreased (-0.211731 --> -0.212907).  Saving model ...
Epoch: 41 cost time: 0.5495669841766357
Epoch: 41, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.392 Vali Acc: 0.221 Test Loss: 3.392 Test Acc: 0.221
Validation loss decreased (-0.212907 --> -0.221143).  Saving model ...
Epoch: 42 cost time: 0.5582530498504639
Epoch: 42, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.411 Vali Acc: 0.227 Test Loss: 3.411 Test Acc: 0.227
Validation loss decreased (-0.221143 --> -0.227025).  Saving model ...
Epoch: 43 cost time: 0.5719914436340332
Epoch: 43, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.433 Vali Acc: 0.235 Test Loss: 3.433 Test Acc: 0.235
Validation loss decreased (-0.227025 --> -0.235260).  Saving model ...
Epoch: 44 cost time: 0.5606002807617188
Epoch: 44, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.446 Vali Acc: 0.234 Test Loss: 3.446 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5889358520507812
Epoch: 45, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.445 Vali Acc: 0.226 Test Loss: 3.445 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5215268135070801
Epoch: 46, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.449 Vali Acc: 0.231 Test Loss: 3.449 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6425316333770752
Epoch: 47, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.464 Vali Acc: 0.233 Test Loss: 3.464 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5495569705963135
Epoch: 48, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.500 Vali Acc: 0.240 Test Loss: 3.500 Test Acc: 0.240
Validation loss decreased (-0.235260 --> -0.239965).  Saving model ...
Epoch: 49 cost time: 0.578726053237915
Epoch: 49, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.549 Vali Acc: 0.242 Test Loss: 3.549 Test Acc: 0.242
Validation loss decreased (-0.239965 --> -0.242317).  Saving model ...
Epoch: 50 cost time: 0.5742828845977783
Epoch: 50, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.557 Vali Acc: 0.239 Test Loss: 3.557 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5586907863616943
Epoch: 51, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.552 Vali Acc: 0.244 Test Loss: 3.552 Test Acc: 0.244
Validation loss decreased (-0.242317 --> -0.243494).  Saving model ...
Epoch: 52 cost time: 0.5646979808807373
Epoch: 52, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.547 Vali Acc: 0.235 Test Loss: 3.547 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5711171627044678
Epoch: 53, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.577 Vali Acc: 0.233 Test Loss: 3.577 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5157783031463623
Epoch: 54, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.608 Vali Acc: 0.235 Test Loss: 3.608 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.545128583908081
Epoch: 55, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.646 Vali Acc: 0.239 Test Loss: 3.646 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5485303401947021
Epoch: 56, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.632 Vali Acc: 0.233 Test Loss: 3.632 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.56022047996521
Epoch: 57, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.646 Vali Acc: 0.235 Test Loss: 3.646 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5789473056793213
Epoch: 58, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.667 Vali Acc: 0.233 Test Loss: 3.667 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5516300201416016
Epoch: 59, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.685 Vali Acc: 0.231 Test Loss: 3.685 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5042622089385986
Epoch: 60, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.672 Vali Acc: 0.238 Test Loss: 3.672 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5901737213134766
Epoch: 61, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.669 Vali Acc: 0.242 Test Loss: 3.669 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 25242
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4971799850463867
Epoch: 1, Steps: 10 | Train Loss: 3.457 Vali Loss: 3.389 Vali Acc: 0.039 Test Loss: 3.389 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.573624849319458
Epoch: 2, Steps: 10 | Train Loss: 3.459 Vali Loss: 3.387 Vali Acc: 0.045 Test Loss: 3.387 Test Acc: 0.045
Validation loss decreased (-0.038790 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.568037748336792
Epoch: 3, Steps: 10 | Train Loss: 3.450 Vali Loss: 3.383 Vali Acc: 0.044 Test Loss: 3.383 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5699634552001953
Epoch: 4, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.375 Vali Acc: 0.036 Test Loss: 3.375 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5057024955749512
Epoch: 5, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.366 Vali Acc: 0.042 Test Loss: 3.366 Test Acc: 0.042
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5640890598297119
Epoch: 6, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.356 Vali Acc: 0.041 Test Loss: 3.356 Test Acc: 0.041
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5271401405334473
Epoch: 7, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.348 Vali Acc: 0.046 Test Loss: 3.348 Test Acc: 0.046
Validation loss decreased (-0.044672 --> -0.045849).  Saving model ...
Epoch: 8 cost time: 0.5451157093048096
Epoch: 8, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.342 Vali Acc: 0.055 Test Loss: 3.342 Test Acc: 0.055
Validation loss decreased (-0.045849 --> -0.055261).  Saving model ...
Epoch: 9 cost time: 0.5227429866790771
Epoch: 9, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.336 Vali Acc: 0.062 Test Loss: 3.336 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 10 cost time: 0.555206298828125
Epoch: 10, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.331 Vali Acc: 0.064 Test Loss: 3.331 Test Acc: 0.064
Validation loss decreased (-0.062320 --> -0.063496).  Saving model ...
Epoch: 11 cost time: 0.5193667411804199
Epoch: 11, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.330 Vali Acc: 0.068 Test Loss: 3.330 Test Acc: 0.068
Validation loss decreased (-0.063496 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 0.4810047149658203
Epoch: 12, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.327 Vali Acc: 0.066 Test Loss: 3.327 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5906007289886475
Epoch: 13, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.326 Vali Acc: 0.072 Test Loss: 3.326 Test Acc: 0.072
Validation loss decreased (-0.068202 --> -0.071731).  Saving model ...
Epoch: 14 cost time: 0.5775260925292969
Epoch: 14, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.318 Vali Acc: 0.085 Test Loss: 3.318 Test Acc: 0.085
Validation loss decreased (-0.071731 --> -0.084673).  Saving model ...
Epoch: 15 cost time: 0.5172333717346191
Epoch: 15, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.314 Vali Acc: 0.092 Test Loss: 3.314 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 16 cost time: 0.5567417144775391
Epoch: 16, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.306 Vali Acc: 0.098 Test Loss: 3.306 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 17 cost time: 0.540635347366333
Epoch: 17, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.302 Vali Acc: 0.104 Test Loss: 3.302 Test Acc: 0.104
Validation loss decreased (-0.097614 --> -0.103496).  Saving model ...
Epoch: 18 cost time: 0.5387308597564697
Epoch: 18, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.301 Vali Acc: 0.105 Test Loss: 3.301 Test Acc: 0.105
Validation loss decreased (-0.103496 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 0.5102903842926025
Epoch: 19, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.299 Vali Acc: 0.106 Test Loss: 3.299 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105849).  Saving model ...
Epoch: 20 cost time: 0.5185840129852295
Epoch: 20, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.298 Vali Acc: 0.105 Test Loss: 3.298 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5554695129394531
Epoch: 21, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.294 Vali Acc: 0.114 Test Loss: 3.294 Test Acc: 0.114
Validation loss decreased (-0.105849 --> -0.114085).  Saving model ...
Epoch: 22 cost time: 0.5263729095458984
Epoch: 22, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.290 Vali Acc: 0.116 Test Loss: 3.290 Test Acc: 0.116
Validation loss decreased (-0.114085 --> -0.116438).  Saving model ...
Epoch: 23 cost time: 0.5291869640350342
Epoch: 23, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.287 Vali Acc: 0.118 Test Loss: 3.287 Test Acc: 0.118
Validation loss decreased (-0.116438 --> -0.117614).  Saving model ...
Epoch: 24 cost time: 0.524409294128418
Epoch: 24, Steps: 10 | Train Loss: 2.126 Vali Loss: 3.284 Vali Acc: 0.124 Test Loss: 3.284 Test Acc: 0.124
Validation loss decreased (-0.117614 --> -0.123497).  Saving model ...
Epoch: 25 cost time: 0.5476574897766113
Epoch: 25, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.283 Vali Acc: 0.131 Test Loss: 3.283 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130555).  Saving model ...
Epoch: 26 cost time: 0.6010584831237793
Epoch: 26, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.287 Vali Acc: 0.132 Test Loss: 3.287 Test Acc: 0.132
Validation loss decreased (-0.130555 --> -0.131732).  Saving model ...
Epoch: 27 cost time: 0.4771997928619385
Epoch: 27, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.291 Vali Acc: 0.135 Test Loss: 3.291 Test Acc: 0.135
Validation loss decreased (-0.131732 --> -0.135261).  Saving model ...
Epoch: 28 cost time: 0.519881010055542
Epoch: 28, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.296 Vali Acc: 0.135 Test Loss: 3.296 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5528721809387207
Epoch: 29, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.295 Vali Acc: 0.140 Test Loss: 3.295 Test Acc: 0.140
Validation loss decreased (-0.135261 --> -0.139967).  Saving model ...
Epoch: 30 cost time: 0.5635542869567871
Epoch: 30, Steps: 10 | Train Loss: 1.768 Vali Loss: 3.301 Vali Acc: 0.147 Test Loss: 3.301 Test Acc: 0.147
Validation loss decreased (-0.139967 --> -0.147026).  Saving model ...
Epoch: 31 cost time: 0.5736899375915527
Epoch: 31, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.315 Vali Acc: 0.153 Test Loss: 3.315 Test Acc: 0.153
Validation loss decreased (-0.147026 --> -0.152908).  Saving model ...
Epoch: 32 cost time: 0.5431184768676758
Epoch: 32, Steps: 10 | Train Loss: 1.600 Vali Loss: 3.322 Vali Acc: 0.161 Test Loss: 3.322 Test Acc: 0.161
Validation loss decreased (-0.152908 --> -0.161143).  Saving model ...
Epoch: 33 cost time: 0.5725991725921631
Epoch: 33, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.331 Vali Acc: 0.159 Test Loss: 3.331 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.539992094039917
Epoch: 34, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.341 Vali Acc: 0.167 Test Loss: 3.341 Test Acc: 0.167
Validation loss decreased (-0.161143 --> -0.167025).  Saving model ...
Epoch: 35 cost time: 0.5089237689971924
Epoch: 35, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.350 Vali Acc: 0.173 Test Loss: 3.350 Test Acc: 0.173
Validation loss decreased (-0.167025 --> -0.172908).  Saving model ...
Epoch: 36 cost time: 0.5158941745758057
Epoch: 36, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.355 Vali Acc: 0.172 Test Loss: 3.355 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5156936645507812
Epoch: 37, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.378 Vali Acc: 0.175 Test Loss: 3.378 Test Acc: 0.175
Validation loss decreased (-0.172908 --> -0.175260).  Saving model ...
Epoch: 38 cost time: 0.5504498481750488
Epoch: 38, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.392 Vali Acc: 0.173 Test Loss: 3.392 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5756113529205322
Epoch: 39, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.391 Vali Acc: 0.179 Test Loss: 3.391 Test Acc: 0.179
Validation loss decreased (-0.175260 --> -0.178790).  Saving model ...
Epoch: 40 cost time: 0.5664920806884766
Epoch: 40, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.402 Vali Acc: 0.181 Test Loss: 3.402 Test Acc: 0.181
Validation loss decreased (-0.178790 --> -0.181142).  Saving model ...
Epoch: 41 cost time: 0.5816946029663086
Epoch: 41, Steps: 10 | Train Loss: 1.093 Vali Loss: 3.408 Vali Acc: 0.175 Test Loss: 3.408 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5660555362701416
Epoch: 42, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.426 Vali Acc: 0.180 Test Loss: 3.426 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5366933345794678
Epoch: 43, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.434 Vali Acc: 0.182 Test Loss: 3.434 Test Acc: 0.182
Validation loss decreased (-0.181142 --> -0.182319).  Saving model ...
Epoch: 44 cost time: 0.5705747604370117
Epoch: 44, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.468 Vali Acc: 0.191 Test Loss: 3.468 Test Acc: 0.191
Validation loss decreased (-0.182319 --> -0.190554).  Saving model ...
Epoch: 45 cost time: 0.49541664123535156
Epoch: 45, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.480 Vali Acc: 0.188 Test Loss: 3.480 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5082488059997559
Epoch: 46, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.504 Vali Acc: 0.185 Test Loss: 3.504 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.537743330001831
Epoch: 47, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.515 Vali Acc: 0.186 Test Loss: 3.515 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5557658672332764
Epoch: 48, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.527 Vali Acc: 0.193 Test Loss: 3.527 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192906).  Saving model ...
Epoch: 49 cost time: 0.5744919776916504
Epoch: 49, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.542 Vali Acc: 0.195 Test Loss: 3.542 Test Acc: 0.195
Validation loss decreased (-0.192906 --> -0.195259).  Saving model ...
Epoch: 50 cost time: 0.5603759288787842
Epoch: 50, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.554 Vali Acc: 0.184 Test Loss: 3.554 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5775282382965088
Epoch: 51, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.577 Vali Acc: 0.191 Test Loss: 3.577 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5611560344696045
Epoch: 52, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.600 Vali Acc: 0.189 Test Loss: 3.600 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.550654411315918
Epoch: 53, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.607 Vali Acc: 0.193 Test Loss: 3.607 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.49300599098205566
Epoch: 54, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.634 Vali Acc: 0.193 Test Loss: 3.634 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.517728328704834
Epoch: 55, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.648 Vali Acc: 0.199 Test Loss: 3.648 Test Acc: 0.199
Validation loss decreased (-0.195259 --> -0.198787).  Saving model ...
Epoch: 56 cost time: 0.4612586498260498
Epoch: 56, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.668 Vali Acc: 0.199 Test Loss: 3.668 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4908871650695801
Epoch: 57, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.680 Vali Acc: 0.201 Test Loss: 3.680 Test Acc: 0.201
Validation loss decreased (-0.198787 --> -0.201140).  Saving model ...
Epoch: 58 cost time: 0.47078585624694824
Epoch: 58, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.697 Vali Acc: 0.194 Test Loss: 3.697 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.50152587890625
Epoch: 59, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.704 Vali Acc: 0.200 Test Loss: 3.704 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.567816972732544
Epoch: 60, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.721 Vali Acc: 0.204 Test Loss: 3.721 Test Acc: 0.204
Validation loss decreased (-0.201140 --> -0.203492).  Saving model ...
Epoch: 61 cost time: 0.5219531059265137
Epoch: 61, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.744 Vali Acc: 0.198 Test Loss: 3.744 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4899873733520508
Epoch: 62, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.766 Vali Acc: 0.201 Test Loss: 3.766 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.48259615898132324
Epoch: 63, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.775 Vali Acc: 0.205 Test Loss: 3.775 Test Acc: 0.205
Validation loss decreased (-0.203492 --> -0.204668).  Saving model ...
Epoch: 64 cost time: 0.5295462608337402
Epoch: 64, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.775 Vali Acc: 0.213 Test Loss: 3.775 Test Acc: 0.213
Validation loss decreased (-0.204668 --> -0.212903).  Saving model ...
Epoch: 65 cost time: 0.48540592193603516
Epoch: 65, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.798 Vali Acc: 0.208 Test Loss: 3.798 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5036196708679199
Epoch: 66, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.818 Vali Acc: 0.212 Test Loss: 3.818 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5109944343566895
Epoch: 67, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.828 Vali Acc: 0.209 Test Loss: 3.828 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.47054600715637207
Epoch: 68, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.848 Vali Acc: 0.221 Test Loss: 3.848 Test Acc: 0.221
Validation loss decreased (-0.212903 --> -0.221138).  Saving model ...
Epoch: 69 cost time: 0.5485899448394775
Epoch: 69, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.886 Vali Acc: 0.214 Test Loss: 3.886 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4922795295715332
Epoch: 70, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.891 Vali Acc: 0.219 Test Loss: 3.891 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.48357486724853516
Epoch: 71, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.888 Vali Acc: 0.209 Test Loss: 3.888 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.492565393447876
Epoch: 72, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.914 Vali Acc: 0.214 Test Loss: 3.914 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.515617847442627
Epoch: 73, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.928 Vali Acc: 0.215 Test Loss: 3.928 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5041038990020752
Epoch: 74, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.942 Vali Acc: 0.212 Test Loss: 3.942 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5216832160949707
Epoch: 75, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.967 Vali Acc: 0.213 Test Loss: 3.967 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5269556045532227
Epoch: 76, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.972 Vali Acc: 0.212 Test Loss: 3.972 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.5298047065734863
Epoch: 77, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.986 Vali Acc: 0.206 Test Loss: 3.986 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.46803832054138184
Epoch: 78, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.981 Vali Acc: 0.209 Test Loss: 3.981 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 21626
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6315536499023438
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.362 Vali Acc: 0.046 Test Loss: 3.362 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.5638835430145264
Epoch: 2, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.359 Vali Acc: 0.042 Test Loss: 3.359 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5754060745239258
Epoch: 3, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.354 Vali Acc: 0.045 Test Loss: 3.354 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5248923301696777
Epoch: 4, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.346 Vali Acc: 0.044 Test Loss: 3.346 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.579197883605957
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.333 Vali Acc: 0.044 Test Loss: 3.333 Test Acc: 0.044
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5458364486694336
Epoch: 6, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.323 Vali Acc: 0.046 Test Loss: 3.323 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045849).  Saving model ...
Epoch: 7 cost time: 0.5342257022857666
Epoch: 7, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.312 Vali Acc: 0.046 Test Loss: 3.312 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045849).  Saving model ...
Epoch: 8 cost time: 0.544823169708252
Epoch: 8, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.302 Vali Acc: 0.052 Test Loss: 3.302 Test Acc: 0.052
Validation loss decreased (-0.045849 --> -0.051732).  Saving model ...
Epoch: 9 cost time: 0.523383378982544
Epoch: 9, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.295 Vali Acc: 0.066 Test Loss: 3.295 Test Acc: 0.066
Validation loss decreased (-0.051732 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 0.6634314060211182
Epoch: 10, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.289 Vali Acc: 0.069 Test Loss: 3.289 Test Acc: 0.069
Validation loss decreased (-0.065849 --> -0.069379).  Saving model ...
Epoch: 11 cost time: 0.5661554336547852
Epoch: 11, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.283 Vali Acc: 0.079 Test Loss: 3.283 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078791).  Saving model ...
Epoch: 12 cost time: 0.5715672969818115
Epoch: 12, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.280 Vali Acc: 0.086 Test Loss: 3.280 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 13 cost time: 0.5278213024139404
Epoch: 13, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.278 Vali Acc: 0.091 Test Loss: 3.278 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090555).  Saving model ...
Epoch: 14 cost time: 0.5359632968902588
Epoch: 14, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.277 Vali Acc: 0.095 Test Loss: 3.277 Test Acc: 0.095
Validation loss decreased (-0.090555 --> -0.095261).  Saving model ...
Epoch: 15 cost time: 0.49240732192993164
Epoch: 15, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.278 Vali Acc: 0.099 Test Loss: 3.278 Test Acc: 0.099
Validation loss decreased (-0.095261 --> -0.098791).  Saving model ...
Epoch: 16 cost time: 0.5268535614013672
Epoch: 16, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.275 Vali Acc: 0.102 Test Loss: 3.275 Test Acc: 0.102
Validation loss decreased (-0.098791 --> -0.102320).  Saving model ...
Epoch: 17 cost time: 0.4775371551513672
Epoch: 17, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.271 Vali Acc: 0.102 Test Loss: 3.271 Test Acc: 0.102
Validation loss decreased (-0.102320 --> -0.102320).  Saving model ...
Epoch: 18 cost time: 0.5900728702545166
Epoch: 18, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.270 Vali Acc: 0.105 Test Loss: 3.270 Test Acc: 0.105
Validation loss decreased (-0.102320 --> -0.104673).  Saving model ...
Epoch: 19 cost time: 0.5271997451782227
Epoch: 19, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.269 Vali Acc: 0.108 Test Loss: 3.269 Test Acc: 0.108
Validation loss decreased (-0.104673 --> -0.108203).  Saving model ...
Epoch: 20 cost time: 0.5225231647491455
Epoch: 20, Steps: 10 | Train Loss: 2.424 Vali Loss: 3.270 Vali Acc: 0.114 Test Loss: 3.270 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114085).  Saving model ...
Epoch: 21 cost time: 0.48285865783691406
Epoch: 21, Steps: 10 | Train Loss: 2.395 Vali Loss: 3.266 Vali Acc: 0.121 Test Loss: 3.266 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 22 cost time: 0.5455794334411621
Epoch: 22, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.261 Vali Acc: 0.122 Test Loss: 3.261 Test Acc: 0.122
Validation loss decreased (-0.121144 --> -0.122320).  Saving model ...
Epoch: 23 cost time: 0.4840726852416992
Epoch: 23, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.259 Vali Acc: 0.126 Test Loss: 3.259 Test Acc: 0.126
Validation loss decreased (-0.122320 --> -0.125850).  Saving model ...
Epoch: 24 cost time: 0.4717116355895996
Epoch: 24, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.259 Vali Acc: 0.127 Test Loss: 3.259 Test Acc: 0.127
Validation loss decreased (-0.125850 --> -0.127026).  Saving model ...
Epoch: 25 cost time: 0.515146017074585
Epoch: 25, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.254 Vali Acc: 0.131 Test Loss: 3.254 Test Acc: 0.131
Validation loss decreased (-0.127026 --> -0.130556).  Saving model ...
Epoch: 26 cost time: 0.5111353397369385
Epoch: 26, Steps: 10 | Train Loss: 2.051 Vali Loss: 3.256 Vali Acc: 0.136 Test Loss: 3.256 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136438).  Saving model ...
Epoch: 27 cost time: 0.5338506698608398
Epoch: 27, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.258 Vali Acc: 0.138 Test Loss: 3.258 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137614).  Saving model ...
Epoch: 28 cost time: 0.5153324604034424
Epoch: 28, Steps: 10 | Train Loss: 1.943 Vali Loss: 3.261 Vali Acc: 0.142 Test Loss: 3.261 Test Acc: 0.142
Validation loss decreased (-0.137614 --> -0.142320).  Saving model ...
Epoch: 29 cost time: 0.5657014846801758
Epoch: 29, Steps: 10 | Train Loss: 1.874 Vali Loss: 3.270 Vali Acc: 0.146 Test Loss: 3.270 Test Acc: 0.146
Validation loss decreased (-0.142320 --> -0.145850).  Saving model ...
Epoch: 30 cost time: 0.511385440826416
Epoch: 30, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.274 Vali Acc: 0.148 Test Loss: 3.274 Test Acc: 0.148
Validation loss decreased (-0.145850 --> -0.148203).  Saving model ...
Epoch: 31 cost time: 0.5567009449005127
Epoch: 31, Steps: 10 | Train Loss: 1.729 Vali Loss: 3.278 Vali Acc: 0.151 Test Loss: 3.278 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150555).  Saving model ...
Epoch: 32 cost time: 0.5649356842041016
Epoch: 32, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.284 Vali Acc: 0.158 Test Loss: 3.284 Test Acc: 0.158
Validation loss decreased (-0.150555 --> -0.157614).  Saving model ...
Epoch: 33 cost time: 0.5195691585540771
Epoch: 33, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.283 Vali Acc: 0.165 Test Loss: 3.283 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164673).  Saving model ...
Epoch: 34 cost time: 0.504518985748291
Epoch: 34, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.285 Vali Acc: 0.171 Test Loss: 3.285 Test Acc: 0.171
Validation loss decreased (-0.164673 --> -0.170555).  Saving model ...
Epoch: 35 cost time: 0.5699639320373535
Epoch: 35, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.293 Vali Acc: 0.172 Test Loss: 3.293 Test Acc: 0.172
Validation loss decreased (-0.170555 --> -0.171732).  Saving model ...
Epoch: 36 cost time: 0.5862491130828857
Epoch: 36, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.303 Vali Acc: 0.174 Test Loss: 3.303 Test Acc: 0.174
Validation loss decreased (-0.171732 --> -0.174085).  Saving model ...
Epoch: 37 cost time: 0.5683774948120117
Epoch: 37, Steps: 10 | Train Loss: 1.349 Vali Loss: 3.314 Vali Acc: 0.180 Test Loss: 3.314 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 38 cost time: 0.5437939167022705
Epoch: 38, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.322 Vali Acc: 0.185 Test Loss: 3.322 Test Acc: 0.185
Validation loss decreased (-0.179967 --> -0.184673).  Saving model ...
Epoch: 39 cost time: 0.5555970668792725
Epoch: 39, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.331 Vali Acc: 0.188 Test Loss: 3.331 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188202).  Saving model ...
Epoch: 40 cost time: 0.4592583179473877
Epoch: 40, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.339 Vali Acc: 0.185 Test Loss: 3.339 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5286452770233154
Epoch: 41, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.356 Vali Acc: 0.192 Test Loss: 3.356 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 42 cost time: 0.5228958129882812
Epoch: 42, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.369 Vali Acc: 0.194 Test Loss: 3.369 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194084).  Saving model ...
Epoch: 43 cost time: 0.5700938701629639
Epoch: 43, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.368 Vali Acc: 0.194 Test Loss: 3.368 Test Acc: 0.194
Validation loss decreased (-0.194084 --> -0.194084).  Saving model ...
Epoch: 44 cost time: 0.5815794467926025
Epoch: 44, Steps: 10 | Train Loss: 0.971 Vali Loss: 3.368 Vali Acc: 0.198 Test Loss: 3.368 Test Acc: 0.198
Validation loss decreased (-0.194084 --> -0.197613).  Saving model ...
Epoch: 45 cost time: 0.5295541286468506
Epoch: 45, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.377 Vali Acc: 0.201 Test Loss: 3.377 Test Acc: 0.201
Validation loss decreased (-0.197613 --> -0.201143).  Saving model ...
Epoch: 46 cost time: 0.548147439956665
Epoch: 46, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.397 Vali Acc: 0.204 Test Loss: 3.397 Test Acc: 0.204
Validation loss decreased (-0.201143 --> -0.203495).  Saving model ...
Epoch: 47 cost time: 0.5656595230102539
Epoch: 47, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.420 Vali Acc: 0.199 Test Loss: 3.420 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5165512561798096
Epoch: 48, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.435 Vali Acc: 0.201 Test Loss: 3.435 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5735914707183838
Epoch: 49, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.445 Vali Acc: 0.202 Test Loss: 3.445 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5362911224365234
Epoch: 50, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.461 Vali Acc: 0.207 Test Loss: 3.461 Test Acc: 0.207
Validation loss decreased (-0.203495 --> -0.207024).  Saving model ...
Epoch: 51 cost time: 0.57281494140625
Epoch: 51, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.474 Vali Acc: 0.207 Test Loss: 3.474 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5073492527008057
Epoch: 52, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.480 Vali Acc: 0.215 Test Loss: 3.480 Test Acc: 0.215
Validation loss decreased (-0.207024 --> -0.215259).  Saving model ...
Epoch: 53 cost time: 0.5708293914794922
Epoch: 53, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.496 Vali Acc: 0.212 Test Loss: 3.496 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5319108963012695
Epoch: 54, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.509 Vali Acc: 0.220 Test Loss: 3.509 Test Acc: 0.220
Validation loss decreased (-0.215259 --> -0.219965).  Saving model ...
Epoch: 55 cost time: 0.5667078495025635
Epoch: 55, Steps: 10 | Train Loss: 0.559 Vali Loss: 3.517 Vali Acc: 0.218 Test Loss: 3.517 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6145117282867432
Epoch: 56, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.537 Vali Acc: 0.224 Test Loss: 3.537 Test Acc: 0.224
Validation loss decreased (-0.219965 --> -0.223494).  Saving model ...
Epoch: 57 cost time: 0.5633366107940674
Epoch: 57, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.537 Vali Acc: 0.225 Test Loss: 3.537 Test Acc: 0.225
Validation loss decreased (-0.223494 --> -0.224671).  Saving model ...
Epoch: 58 cost time: 0.5476837158203125
Epoch: 58, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.559 Vali Acc: 0.219 Test Loss: 3.559 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5756323337554932
Epoch: 59, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.586 Vali Acc: 0.216 Test Loss: 3.586 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5508191585540771
Epoch: 60, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.609 Vali Acc: 0.219 Test Loss: 3.609 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5128984451293945
Epoch: 61, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.614 Vali Acc: 0.224 Test Loss: 3.614 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5067653656005859
Epoch: 62, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.626 Vali Acc: 0.222 Test Loss: 3.626 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.556727409362793
Epoch: 63, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.622 Vali Acc: 0.224 Test Loss: 3.622 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5857036113739014
Epoch: 64, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.633 Vali Acc: 0.227 Test Loss: 3.633 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227022).  Saving model ...
Epoch: 65 cost time: 0.5415694713592529
Epoch: 65, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.637 Vali Acc: 0.227 Test Loss: 3.637 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5326597690582275
Epoch: 66, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.665 Vali Acc: 0.231 Test Loss: 3.665 Test Acc: 0.231
Validation loss decreased (-0.227022 --> -0.230552).  Saving model ...
Epoch: 67 cost time: 0.5528528690338135
Epoch: 67, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.677 Vali Acc: 0.228 Test Loss: 3.677 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.532508373260498
Epoch: 68, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.681 Vali Acc: 0.222 Test Loss: 3.681 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.552044153213501
Epoch: 69, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.696 Vali Acc: 0.224 Test Loss: 3.696 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5743367671966553
Epoch: 70, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.704 Vali Acc: 0.229 Test Loss: 3.704 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5464737415313721
Epoch: 71, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.731 Vali Acc: 0.232 Test Loss: 3.731 Test Acc: 0.232
Validation loss decreased (-0.230552 --> -0.231727).  Saving model ...
Epoch: 72 cost time: 0.5664293766021729
Epoch: 72, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.760 Vali Acc: 0.226 Test Loss: 3.760 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5736947059631348
Epoch: 73, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.782 Vali Acc: 0.228 Test Loss: 3.782 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5388038158416748
Epoch: 74, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.795 Vali Acc: 0.226 Test Loss: 3.795 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5096151828765869
Epoch: 75, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.783 Vali Acc: 0.228 Test Loss: 3.783 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.5596606731414795
Epoch: 76, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.786 Vali Acc: 0.226 Test Loss: 3.786 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.5529508590698242
Epoch: 77, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.806 Vali Acc: 0.224 Test Loss: 3.806 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5755105018615723
Epoch: 78, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.827 Vali Acc: 0.221 Test Loss: 3.827 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.48850536346435547
Epoch: 79, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.842 Vali Acc: 0.222 Test Loss: 3.842 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.5461106300354004
Epoch: 80, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.838 Vali Acc: 0.222 Test Loss: 3.838 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.5356113910675049
Epoch: 81, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.857 Vali Acc: 0.225 Test Loss: 3.857 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el3_dm16_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23176470588235293
model parameter : 20490
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7610764503479004
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.346 Vali Acc: 0.066 Test Loss: 3.346 Test Acc: 0.066
Validation loss decreased (inf --> -0.065849).  Saving model ...
Epoch: 2 cost time: 0.43581223487854004
Epoch: 2, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.309 Vali Acc: 0.120 Test Loss: 3.309 Test Acc: 0.120
Validation loss decreased (-0.065849 --> -0.119967).  Saving model ...
Epoch: 3 cost time: 0.5677165985107422
Epoch: 3, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.307 Vali Acc: 0.161 Test Loss: 3.307 Test Acc: 0.161
Validation loss decreased (-0.119967 --> -0.161143).  Saving model ...
Epoch: 4 cost time: 0.6496403217315674
Epoch: 4, Steps: 10 | Train Loss: 1.452 Vali Loss: 3.469 Vali Acc: 0.198 Test Loss: 3.469 Test Acc: 0.198
Validation loss decreased (-0.161143 --> -0.197612).  Saving model ...
Epoch: 5 cost time: 0.619659423828125
Epoch: 5, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.727 Vali Acc: 0.224 Test Loss: 3.727 Test Acc: 0.224
Validation loss decreased (-0.197612 --> -0.223492).  Saving model ...
Epoch: 6 cost time: 0.5514135360717773
Epoch: 6, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.852 Vali Acc: 0.218 Test Loss: 3.852 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5662870407104492
Epoch: 7, Steps: 10 | Train Loss: 0.288 Vali Loss: 4.309 Vali Acc: 0.228 Test Loss: 4.309 Test Acc: 0.228
Validation loss decreased (-0.223492 --> -0.228192).  Saving model ...
Epoch: 8 cost time: 0.4750502109527588
Epoch: 8, Steps: 10 | Train Loss: 0.149 Vali Loss: 4.475 Vali Acc: 0.216 Test Loss: 4.475 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5566961765289307
Epoch: 9, Steps: 10 | Train Loss: 0.168 Vali Loss: 4.961 Vali Acc: 0.227 Test Loss: 4.961 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5591075420379639
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.840 Vali Acc: 0.253 Test Loss: 4.840 Test Acc: 0.253
Validation loss decreased (-0.228192 --> -0.252893).  Saving model ...
Epoch: 11 cost time: 0.584362268447876
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.064 Vali Acc: 0.252 Test Loss: 5.064 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5392537117004395
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.420 Vali Acc: 0.247 Test Loss: 5.420 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5657236576080322
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.462 Vali Acc: 0.249 Test Loss: 5.462 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5659468173980713
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.504 Vali Acc: 0.252 Test Loss: 5.504 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5408928394317627
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.728 Vali Acc: 0.241 Test Loss: 5.728 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5982575416564941
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.715 Vali Acc: 0.252 Test Loss: 5.715 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5494349002838135
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.739 Vali Acc: 0.266 Test Loss: 5.739 Test Acc: 0.266
Validation loss decreased (-0.252893 --> -0.265825).  Saving model ...
Epoch: 18 cost time: 0.6172449588775635
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.763 Vali Acc: 0.271 Test Loss: 5.763 Test Acc: 0.271
Validation loss decreased (-0.265825 --> -0.270531).  Saving model ...
Epoch: 19 cost time: 0.5779836177825928
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.772 Vali Acc: 0.272 Test Loss: 5.772 Test Acc: 0.272
Validation loss decreased (-0.270531 --> -0.271707).  Saving model ...
Epoch: 20 cost time: 0.5830349922180176
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.784 Vali Acc: 0.272 Test Loss: 5.784 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5998692512512207
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.766 Vali Acc: 0.272 Test Loss: 5.766 Test Acc: 0.272
Validation loss decreased (-0.271707 --> -0.271707).  Saving model ...
Epoch: 22 cost time: 0.5740432739257812
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.783 Vali Acc: 0.273 Test Loss: 5.783 Test Acc: 0.273
Validation loss decreased (-0.271707 --> -0.272883).  Saving model ...
Epoch: 23 cost time: 0.568760871887207
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.801 Vali Acc: 0.275 Test Loss: 5.801 Test Acc: 0.275
Validation loss decreased (-0.272883 --> -0.275236).  Saving model ...
Epoch: 24 cost time: 0.5782060623168945
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.808 Vali Acc: 0.279 Test Loss: 5.808 Test Acc: 0.279
Validation loss decreased (-0.275236 --> -0.278765).  Saving model ...
Epoch: 25 cost time: 0.6055662631988525
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.825 Vali Acc: 0.275 Test Loss: 5.825 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5869684219360352
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.824 Vali Acc: 0.274 Test Loss: 5.824 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5387804508209229
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.826 Vali Acc: 0.275 Test Loss: 5.826 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.584357738494873
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.837 Vali Acc: 0.278 Test Loss: 5.837 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5850439071655273
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.848 Vali Acc: 0.278 Test Loss: 5.848 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5605602264404297
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.875 Vali Acc: 0.274 Test Loss: 5.875 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.47153687477111816
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.884 Vali Acc: 0.275 Test Loss: 5.884 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5551168918609619
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.281 Test Loss: 5.879 Test Acc: 0.281
Validation loss decreased (-0.278765 --> -0.281118).  Saving model ...
Epoch: 33 cost time: 0.5537753105163574
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.890 Vali Acc: 0.284 Test Loss: 5.890 Test Acc: 0.284
Validation loss decreased (-0.281118 --> -0.283471).  Saving model ...
Epoch: 34 cost time: 0.5704524517059326
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.896 Vali Acc: 0.285 Test Loss: 5.896 Test Acc: 0.285
Validation loss decreased (-0.283471 --> -0.284647).  Saving model ...
Epoch: 35 cost time: 0.6155362129211426
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.900 Vali Acc: 0.284 Test Loss: 5.900 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5516073703765869
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.912 Vali Acc: 0.285 Test Loss: 5.912 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5588734149932861
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.913 Vali Acc: 0.284 Test Loss: 5.913 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.534602165222168
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.284 Test Loss: 5.933 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5551748275756836
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.937 Vali Acc: 0.282 Test Loss: 5.937 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5621745586395264
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.947 Vali Acc: 0.285 Test Loss: 5.947 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5396194458007812
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.956 Vali Acc: 0.284 Test Loss: 5.956 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5665955543518066
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.963 Vali Acc: 0.286 Test Loss: 5.963 Test Acc: 0.286
Validation loss decreased (-0.284647 --> -0.285823).  Saving model ...
Epoch: 43 cost time: 0.5632078647613525
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.970 Vali Acc: 0.285 Test Loss: 5.970 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5609736442565918
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.984 Vali Acc: 0.284 Test Loss: 5.984 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.58139967918396
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.990 Vali Acc: 0.285 Test Loss: 5.990 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5594103336334229
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.008 Vali Acc: 0.282 Test Loss: 6.008 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5850925445556641
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.010 Vali Acc: 0.284 Test Loss: 6.010 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.568455696105957
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.013 Vali Acc: 0.285 Test Loss: 6.013 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5896711349487305
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.035 Vali Acc: 0.282 Test Loss: 6.035 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6136074066162109
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.039 Vali Acc: 0.284 Test Loss: 6.039 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5738155841827393
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.051 Vali Acc: 0.284 Test Loss: 6.051 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5644240379333496
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.058 Vali Acc: 0.286 Test Loss: 6.058 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 1024538
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7405571937561035
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.355 Vali Acc: 0.055 Test Loss: 3.355 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.49619293212890625
Epoch: 2, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.411 Vali Acc: 0.080 Test Loss: 3.411 Test Acc: 0.080
Validation loss decreased (-0.055261 --> -0.079966).  Saving model ...
Epoch: 3 cost time: 0.4679405689239502
Epoch: 3, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.297 Vali Acc: 0.128 Test Loss: 3.297 Test Acc: 0.128
Validation loss decreased (-0.079966 --> -0.128202).  Saving model ...
Epoch: 4 cost time: 0.470766544342041
Epoch: 4, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.295 Vali Acc: 0.149 Test Loss: 3.295 Test Acc: 0.149
Validation loss decreased (-0.128202 --> -0.149379).  Saving model ...
Epoch: 5 cost time: 0.47669076919555664
Epoch: 5, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.328 Vali Acc: 0.188 Test Loss: 3.328 Test Acc: 0.188
Validation loss decreased (-0.149379 --> -0.188202).  Saving model ...
Epoch: 6 cost time: 0.5012929439544678
Epoch: 6, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.496 Vali Acc: 0.214 Test Loss: 3.496 Test Acc: 0.214
Validation loss decreased (-0.188202 --> -0.214083).  Saving model ...
Epoch: 7 cost time: 0.47660231590270996
Epoch: 7, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.579 Vali Acc: 0.238 Test Loss: 3.579 Test Acc: 0.238
Validation loss decreased (-0.214083 --> -0.237611).  Saving model ...
Epoch: 8 cost time: 0.48844027519226074
Epoch: 8, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.828 Vali Acc: 0.211 Test Loss: 3.828 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5216381549835205
Epoch: 9, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.886 Vali Acc: 0.246 Test Loss: 3.886 Test Acc: 0.246
Validation loss decreased (-0.237611 --> -0.245843).  Saving model ...
Epoch: 10 cost time: 0.47847938537597656
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 4.104 Vali Acc: 0.248 Test Loss: 4.104 Test Acc: 0.248
Validation loss decreased (-0.245843 --> -0.248194).  Saving model ...
Epoch: 11 cost time: 0.4473421573638916
Epoch: 11, Steps: 10 | Train Loss: 0.112 Vali Loss: 4.272 Vali Acc: 0.268 Test Loss: 4.272 Test Acc: 0.268
Validation loss decreased (-0.248194 --> -0.268193).  Saving model ...
Epoch: 12 cost time: 0.45391273498535156
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.550 Vali Acc: 0.241 Test Loss: 4.550 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5014359951019287
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.543 Vali Acc: 0.253 Test Loss: 4.543 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49369263648986816
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.771 Vali Acc: 0.246 Test Loss: 4.771 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5062570571899414
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.925 Vali Acc: 0.248 Test Loss: 4.925 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5108270645141602
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.908 Vali Acc: 0.254 Test Loss: 4.908 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5174567699432373
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.926 Vali Acc: 0.258 Test Loss: 4.926 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.48711466789245605
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.963 Vali Acc: 0.262 Test Loss: 4.963 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5257065296173096
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.992 Vali Acc: 0.264 Test Loss: 4.992 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5209431648254395
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.036 Vali Acc: 0.262 Test Loss: 5.036 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5066046714782715
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.060 Vali Acc: 0.262 Test Loss: 5.060 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 645658
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6834568977355957
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.328 Vali Acc: 0.038 Test Loss: 3.328 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.5553836822509766
Epoch: 2, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.338 Vali Acc: 0.067 Test Loss: 3.338 Test Acc: 0.067
Validation loss decreased (-0.037614 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 0.4910421371459961
Epoch: 3, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.351 Vali Acc: 0.102 Test Loss: 3.351 Test Acc: 0.102
Validation loss decreased (-0.067025 --> -0.102319).  Saving model ...
Epoch: 4 cost time: 0.4811441898345947
Epoch: 4, Steps: 10 | Train Loss: 2.240 Vali Loss: 3.258 Vali Acc: 0.142 Test Loss: 3.258 Test Acc: 0.142
Validation loss decreased (-0.102319 --> -0.142320).  Saving model ...
Epoch: 5 cost time: 0.5271468162536621
Epoch: 5, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.276 Vali Acc: 0.171 Test Loss: 3.276 Test Acc: 0.171
Validation loss decreased (-0.142320 --> -0.170555).  Saving model ...
Epoch: 6 cost time: 0.4872305393218994
Epoch: 6, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.336 Vali Acc: 0.169 Test Loss: 3.336 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.3915107250213623
Epoch: 7, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.404 Vali Acc: 0.219 Test Loss: 3.404 Test Acc: 0.219
Validation loss decreased (-0.170555 --> -0.218789).  Saving model ...
Epoch: 8 cost time: 0.5471875667572021
Epoch: 8, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.450 Vali Acc: 0.227 Test Loss: 3.450 Test Acc: 0.227
Validation loss decreased (-0.218789 --> -0.227024).  Saving model ...
Epoch: 9 cost time: 0.48108553886413574
Epoch: 9, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.601 Vali Acc: 0.241 Test Loss: 3.601 Test Acc: 0.241
Validation loss decreased (-0.227024 --> -0.241140).  Saving model ...
Epoch: 10 cost time: 0.48514890670776367
Epoch: 10, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.763 Vali Acc: 0.227 Test Loss: 3.763 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5211515426635742
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.770 Vali Acc: 0.254 Test Loss: 3.770 Test Acc: 0.254
Validation loss decreased (-0.241140 --> -0.254080).  Saving model ...
Epoch: 12 cost time: 0.5011506080627441
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.936 Vali Acc: 0.242 Test Loss: 3.936 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.608905553817749
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.194 Vali Acc: 0.244 Test Loss: 4.194 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.459336519241333
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.194 Vali Acc: 0.249 Test Loss: 4.194 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5083012580871582
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.255 Vali Acc: 0.256 Test Loss: 4.255 Test Acc: 0.256
Validation loss decreased (-0.254080 --> -0.256428).  Saving model ...
Epoch: 16 cost time: 0.471968412399292
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.372 Vali Acc: 0.249 Test Loss: 4.372 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4924008846282959
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.457 Vali Acc: 0.252 Test Loss: 4.457 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4768853187561035
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.498 Vali Acc: 0.241 Test Loss: 4.498 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.48882031440734863
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.507 Vali Acc: 0.251 Test Loss: 4.507 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4808194637298584
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.526 Vali Acc: 0.259 Test Loss: 4.526 Test Acc: 0.259
Validation loss decreased (-0.256428 --> -0.258778).  Saving model ...
Epoch: 21 cost time: 0.5024902820587158
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.537 Vali Acc: 0.258 Test Loss: 4.537 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4929482936859131
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.578 Vali Acc: 0.264 Test Loss: 4.578 Test Acc: 0.264
Validation loss decreased (-0.258778 --> -0.263484).  Saving model ...
Epoch: 23 cost time: 0.48625874519348145
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.589 Vali Acc: 0.265 Test Loss: 4.589 Test Acc: 0.265
Validation loss decreased (-0.263484 --> -0.264660).  Saving model ...
Epoch: 24 cost time: 0.49266576766967773
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.603 Vali Acc: 0.260 Test Loss: 4.603 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46492886543273926
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.624 Vali Acc: 0.256 Test Loss: 4.624 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.48891592025756836
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.626 Vali Acc: 0.265 Test Loss: 4.626 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5312728881835938
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.653 Vali Acc: 0.259 Test Loss: 4.653 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.498492956161499
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.686 Vali Acc: 0.262 Test Loss: 4.686 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49413394927978516
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.720 Vali Acc: 0.259 Test Loss: 4.720 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.453033447265625
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.738 Vali Acc: 0.256 Test Loss: 4.738 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.513709306716919
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.746 Vali Acc: 0.260 Test Loss: 4.746 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.48428940773010254
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.758 Vali Acc: 0.261 Test Loss: 4.758 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5371851921081543
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.769 Vali Acc: 0.262 Test Loss: 4.769 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 516378
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7237417697906494
Epoch: 1, Steps: 10 | Train Loss: 3.395 Vali Loss: 3.322 Vali Acc: 0.061 Test Loss: 3.322 Test Acc: 0.061
Validation loss decreased (inf --> -0.061143).  Saving model ...
Epoch: 2 cost time: 0.5294692516326904
Epoch: 2, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.308 Vali Acc: 0.075 Test Loss: 3.308 Test Acc: 0.075
Validation loss decreased (-0.061143 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 0.5468370914459229
Epoch: 3, Steps: 10 | Train Loss: 2.908 Vali Loss: 3.351 Vali Acc: 0.102 Test Loss: 3.351 Test Acc: 0.102
Validation loss decreased (-0.075261 --> -0.102319).  Saving model ...
Epoch: 4 cost time: 0.6251523494720459
Epoch: 4, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.323 Vali Acc: 0.122 Test Loss: 3.323 Test Acc: 0.122
Validation loss decreased (-0.102319 --> -0.122320).  Saving model ...
Epoch: 5 cost time: 0.542137861251831
Epoch: 5, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.241 Vali Acc: 0.164 Test Loss: 3.241 Test Acc: 0.164
Validation loss decreased (-0.122320 --> -0.163497).  Saving model ...
Epoch: 6 cost time: 0.5403532981872559
Epoch: 6, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.232 Vali Acc: 0.184 Test Loss: 3.232 Test Acc: 0.184
Validation loss decreased (-0.163497 --> -0.183497).  Saving model ...
Epoch: 7 cost time: 0.5265278816223145
Epoch: 7, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.303 Vali Acc: 0.181 Test Loss: 3.303 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5092313289642334
Epoch: 8, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.378 Vali Acc: 0.198 Test Loss: 3.378 Test Acc: 0.198
Validation loss decreased (-0.183497 --> -0.197613).  Saving model ...
Epoch: 9 cost time: 0.5226037502288818
Epoch: 9, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.425 Vali Acc: 0.218 Test Loss: 3.425 Test Acc: 0.218
Validation loss decreased (-0.197613 --> -0.217613).  Saving model ...
Epoch: 10 cost time: 0.5244157314300537
Epoch: 10, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.556 Vali Acc: 0.220 Test Loss: 3.556 Test Acc: 0.220
Validation loss decreased (-0.217613 --> -0.219964).  Saving model ...
Epoch: 11 cost time: 0.535499095916748
Epoch: 11, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.612 Vali Acc: 0.233 Test Loss: 3.612 Test Acc: 0.233
Validation loss decreased (-0.219964 --> -0.232905).  Saving model ...
Epoch: 12 cost time: 0.48979616165161133
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.777 Vali Acc: 0.233 Test Loss: 3.777 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49631428718566895
Epoch: 13, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.901 Vali Acc: 0.232 Test Loss: 3.901 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44870495796203613
Epoch: 14, Steps: 10 | Train Loss: 0.138 Vali Loss: 4.002 Vali Acc: 0.254 Test Loss: 4.002 Test Acc: 0.254
Validation loss decreased (-0.232905 --> -0.254078).  Saving model ...
Epoch: 15 cost time: 0.5639944076538086
Epoch: 15, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.088 Vali Acc: 0.240 Test Loss: 4.088 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5176799297332764
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.206 Vali Acc: 0.240 Test Loss: 4.206 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5019903182983398
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.307 Vali Acc: 0.239 Test Loss: 4.307 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.535830020904541
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.345 Vali Acc: 0.246 Test Loss: 4.345 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5395276546478271
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.396 Vali Acc: 0.244 Test Loss: 4.396 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4527769088745117
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.442 Vali Acc: 0.255 Test Loss: 4.442 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255250).  Saving model ...
Epoch: 21 cost time: 0.5124077796936035
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.481 Vali Acc: 0.244 Test Loss: 4.481 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4865536689758301
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.512 Vali Acc: 0.246 Test Loss: 4.512 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5112876892089844
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.523 Vali Acc: 0.248 Test Loss: 4.523 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5313355922698975
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.536 Vali Acc: 0.247 Test Loss: 4.536 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.510202169418335
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.564 Vali Acc: 0.252 Test Loss: 4.564 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5367372035980225
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.608 Vali Acc: 0.256 Test Loss: 4.608 Test Acc: 0.256
Validation loss decreased (-0.255250 --> -0.256425).  Saving model ...
Epoch: 27 cost time: 0.5873770713806152
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.651 Vali Acc: 0.251 Test Loss: 4.651 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5902211666107178
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.660 Vali Acc: 0.253 Test Loss: 4.660 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5838563442230225
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.665 Vali Acc: 0.258 Test Loss: 4.665 Test Acc: 0.258
Validation loss decreased (-0.256425 --> -0.257600).  Saving model ...
Epoch: 30 cost time: 0.5894432067871094
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.692 Vali Acc: 0.258 Test Loss: 4.692 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.592012882232666
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.726 Vali Acc: 0.258 Test Loss: 4.726 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.49487829208374023
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.741 Vali Acc: 0.254 Test Loss: 4.741 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5789062976837158
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.745 Vali Acc: 0.253 Test Loss: 4.745 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5250740051269531
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.763 Vali Acc: 0.255 Test Loss: 4.763 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.552492618560791
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.785 Vali Acc: 0.254 Test Loss: 4.785 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4772491455078125
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.795 Vali Acc: 0.256 Test Loss: 4.795 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5567684173583984
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.821 Vali Acc: 0.255 Test Loss: 4.821 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5190060138702393
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.838 Vali Acc: 0.258 Test Loss: 4.838 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4500417709350586
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.839 Vali Acc: 0.255 Test Loss: 4.839 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 456986
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4923648834228516
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.314 Vali Acc: 0.046 Test Loss: 3.314 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.4761497974395752
Epoch: 2, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.281 Vali Acc: 0.079 Test Loss: 3.281 Test Acc: 0.079
Validation loss decreased (-0.045849 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.5013413429260254
Epoch: 3, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.279 Vali Acc: 0.093 Test Loss: 3.279 Test Acc: 0.093
Validation loss decreased (-0.078791 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 0.5405399799346924
Epoch: 4, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.283 Vali Acc: 0.098 Test Loss: 3.283 Test Acc: 0.098
Validation loss decreased (-0.092908 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 0.5226864814758301
Epoch: 5, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.256 Vali Acc: 0.112 Test Loss: 3.256 Test Acc: 0.112
Validation loss decreased (-0.097614 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 0.5829367637634277
Epoch: 6, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.234 Vali Acc: 0.133 Test Loss: 3.234 Test Acc: 0.133
Validation loss decreased (-0.111732 --> -0.132909).  Saving model ...
Epoch: 7 cost time: 0.5117130279541016
Epoch: 7, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.246 Vali Acc: 0.162 Test Loss: 3.246 Test Acc: 0.162
Validation loss decreased (-0.132909 --> -0.162320).  Saving model ...
Epoch: 8 cost time: 0.5219013690948486
Epoch: 8, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.244 Vali Acc: 0.178 Test Loss: 3.244 Test Acc: 0.178
Validation loss decreased (-0.162320 --> -0.177615).  Saving model ...
Epoch: 9 cost time: 0.5242486000061035
Epoch: 9, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.279 Vali Acc: 0.204 Test Loss: 3.279 Test Acc: 0.204
Validation loss decreased (-0.177615 --> -0.203497).  Saving model ...
Epoch: 10 cost time: 0.45449280738830566
Epoch: 10, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.324 Vali Acc: 0.218 Test Loss: 3.324 Test Acc: 0.218
Validation loss decreased (-0.203497 --> -0.217614).  Saving model ...
Epoch: 11 cost time: 0.529310941696167
Epoch: 11, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.382 Vali Acc: 0.244 Test Loss: 3.382 Test Acc: 0.244
Validation loss decreased (-0.217614 --> -0.243496).  Saving model ...
Epoch: 12 cost time: 0.5665504932403564
Epoch: 12, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.426 Vali Acc: 0.236 Test Loss: 3.426 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5751454830169678
Epoch: 13, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.510 Vali Acc: 0.249 Test Loss: 3.510 Test Acc: 0.249
Validation loss decreased (-0.243496 --> -0.249377).  Saving model ...
Epoch: 14 cost time: 0.5431289672851562
Epoch: 14, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.601 Vali Acc: 0.251 Test Loss: 3.601 Test Acc: 0.251
Validation loss decreased (-0.249377 --> -0.250552).  Saving model ...
Epoch: 15 cost time: 0.5831997394561768
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.687 Vali Acc: 0.251 Test Loss: 3.687 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4905107021331787
Epoch: 16, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.749 Vali Acc: 0.252 Test Loss: 3.749 Test Acc: 0.252
Validation loss decreased (-0.250552 --> -0.251727).  Saving model ...
Epoch: 17 cost time: 0.5023601055145264
Epoch: 17, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.825 Vali Acc: 0.265 Test Loss: 3.825 Test Acc: 0.265
Validation loss decreased (-0.251727 --> -0.264668).  Saving model ...
Epoch: 18 cost time: 0.4747798442840576
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.887 Vali Acc: 0.266 Test Loss: 3.887 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265843).  Saving model ...
Epoch: 19 cost time: 0.489168643951416
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.963 Vali Acc: 0.268 Test Loss: 3.963 Test Acc: 0.268
Validation loss decreased (-0.265843 --> -0.268196).  Saving model ...
Epoch: 20 cost time: 0.4791581630706787
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.015 Vali Acc: 0.268 Test Loss: 4.015 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47288990020751953
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.035 Vali Acc: 0.273 Test Loss: 4.035 Test Acc: 0.273
Validation loss decreased (-0.268196 --> -0.272901).  Saving model ...
Epoch: 22 cost time: 0.5061948299407959
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.072 Vali Acc: 0.275 Test Loss: 4.072 Test Acc: 0.275
Validation loss decreased (-0.272901 --> -0.275253).  Saving model ...
Epoch: 23 cost time: 0.5451376438140869
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.147 Vali Acc: 0.275 Test Loss: 4.147 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.516441822052002
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.125 Vali Acc: 0.275 Test Loss: 4.125 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.49986886978149414
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.119 Vali Acc: 0.282 Test Loss: 4.119 Test Acc: 0.282
Validation loss decreased (-0.275253 --> -0.282312).  Saving model ...
Epoch: 26 cost time: 0.49076032638549805
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.145 Vali Acc: 0.278 Test Loss: 4.145 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5738439559936523
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.176 Vali Acc: 0.275 Test Loss: 4.176 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.48556947708129883
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.203 Vali Acc: 0.280 Test Loss: 4.203 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5111291408538818
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.220 Vali Acc: 0.281 Test Loss: 4.220 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4497699737548828
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.241 Vali Acc: 0.284 Test Loss: 4.241 Test Acc: 0.284
Validation loss decreased (-0.282312 --> -0.283487).  Saving model ...
Epoch: 31 cost time: 0.5186424255371094
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.273 Vali Acc: 0.281 Test Loss: 4.273 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5044326782226562
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.286 Vali Acc: 0.281 Test Loss: 4.286 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4617440700531006
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.297 Vali Acc: 0.280 Test Loss: 4.297 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5022642612457275
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.315 Vali Acc: 0.284 Test Loss: 4.315 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.515510082244873
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.331 Vali Acc: 0.284 Test Loss: 4.331 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4954967498779297
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.329 Vali Acc: 0.286 Test Loss: 4.329 Test Acc: 0.286
Validation loss decreased (-0.283487 --> -0.285839).  Saving model ...
Epoch: 37 cost time: 0.47564029693603516
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.343 Vali Acc: 0.285 Test Loss: 4.343 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5500860214233398
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.355 Vali Acc: 0.284 Test Loss: 4.355 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4839184284210205
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.366 Vali Acc: 0.284 Test Loss: 4.366 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5026929378509521
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.377 Vali Acc: 0.284 Test Loss: 4.377 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5015671253204346
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.384 Vali Acc: 0.287 Test Loss: 4.384 Test Acc: 0.287
Validation loss decreased (-0.285839 --> -0.287015).  Saving model ...
Epoch: 42 cost time: 0.5269553661346436
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.388 Vali Acc: 0.287 Test Loss: 4.388 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5173404216766357
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.402 Vali Acc: 0.291 Test Loss: 4.402 Test Acc: 0.291
Validation loss decreased (-0.287015 --> -0.290544).  Saving model ...
Epoch: 44 cost time: 0.5486867427825928
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.412 Vali Acc: 0.288 Test Loss: 4.412 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.468233585357666
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.419 Vali Acc: 0.288 Test Loss: 4.419 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4793202877044678
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.440 Vali Acc: 0.288 Test Loss: 4.440 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4888632297515869
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.447 Vali Acc: 0.287 Test Loss: 4.447 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.48972082138061523
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.449 Vali Acc: 0.288 Test Loss: 4.449 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4871537685394287
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.465 Vali Acc: 0.289 Test Loss: 4.465 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.512596607208252
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.476 Vali Acc: 0.287 Test Loss: 4.476 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5106041431427002
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.493 Vali Acc: 0.287 Test Loss: 4.493 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5588147640228271
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.502 Vali Acc: 0.289 Test Loss: 4.502 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5013630390167236
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.507 Vali Acc: 0.288 Test Loss: 4.507 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 387994
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6376588344573975
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.304 Vali Acc: 0.054 Test Loss: 3.304 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.5583181381225586
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.278 Vali Acc: 0.062 Test Loss: 3.278 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.46050143241882324
Epoch: 3, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.270 Vali Acc: 0.073 Test Loss: 3.270 Test Acc: 0.073
Validation loss decreased (-0.062320 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.5146629810333252
Epoch: 4, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.259 Vali Acc: 0.088 Test Loss: 3.259 Test Acc: 0.088
Validation loss decreased (-0.072908 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.49537014961242676
Epoch: 5, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.258 Vali Acc: 0.104 Test Loss: 3.258 Test Acc: 0.104
Validation loss decreased (-0.088203 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.5312151908874512
Epoch: 6, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.250 Vali Acc: 0.113 Test Loss: 3.250 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.5187232494354248
Epoch: 7, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.248 Vali Acc: 0.140 Test Loss: 3.248 Test Acc: 0.140
Validation loss decreased (-0.112909 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.5367939472198486
Epoch: 8, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.246 Vali Acc: 0.158 Test Loss: 3.246 Test Acc: 0.158
Validation loss decreased (-0.139968 --> -0.157615).  Saving model ...
Epoch: 9 cost time: 0.5068631172180176
Epoch: 9, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.263 Vali Acc: 0.187 Test Loss: 3.263 Test Acc: 0.187
Validation loss decreased (-0.157615 --> -0.187026).  Saving model ...
Epoch: 10 cost time: 0.5213832855224609
Epoch: 10, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.298 Vali Acc: 0.186 Test Loss: 3.298 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5649964809417725
Epoch: 11, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.336 Vali Acc: 0.211 Test Loss: 3.336 Test Acc: 0.211
Validation loss decreased (-0.187026 --> -0.210555).  Saving model ...
Epoch: 12 cost time: 0.538027286529541
Epoch: 12, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.386 Vali Acc: 0.215 Test Loss: 3.386 Test Acc: 0.215
Validation loss decreased (-0.210555 --> -0.215260).  Saving model ...
Epoch: 13 cost time: 0.5326344966888428
Epoch: 13, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.440 Vali Acc: 0.227 Test Loss: 3.440 Test Acc: 0.227
Validation loss decreased (-0.215260 --> -0.227024).  Saving model ...
Epoch: 14 cost time: 0.49364447593688965
Epoch: 14, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.517 Vali Acc: 0.218 Test Loss: 3.517 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5192019939422607
Epoch: 15, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.592 Vali Acc: 0.218 Test Loss: 3.592 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47794437408447266
Epoch: 16, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.711 Vali Acc: 0.229 Test Loss: 3.711 Test Acc: 0.229
Validation loss decreased (-0.227024 --> -0.229375).  Saving model ...
Epoch: 17 cost time: 0.45682501792907715
Epoch: 17, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.800 Vali Acc: 0.242 Test Loss: 3.800 Test Acc: 0.242
Validation loss decreased (-0.229375 --> -0.242315).  Saving model ...
Epoch: 18 cost time: 0.4936530590057373
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.818 Vali Acc: 0.244 Test Loss: 3.818 Test Acc: 0.244
Validation loss decreased (-0.242315 --> -0.243491).  Saving model ...
Epoch: 19 cost time: 0.47158026695251465
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.904 Vali Acc: 0.244 Test Loss: 3.904 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4869537353515625
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.944 Vali Acc: 0.245 Test Loss: 3.944 Test Acc: 0.245
Validation loss decreased (-0.243491 --> -0.244666).  Saving model ...
Epoch: 21 cost time: 0.5125248432159424
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.977 Vali Acc: 0.252 Test Loss: 3.977 Test Acc: 0.252
Validation loss decreased (-0.244666 --> -0.251725).  Saving model ...
Epoch: 22 cost time: 0.4665796756744385
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.046 Vali Acc: 0.253 Test Loss: 4.046 Test Acc: 0.253
Validation loss decreased (-0.251725 --> -0.252901).  Saving model ...
Epoch: 23 cost time: 0.5367763042449951
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.078 Vali Acc: 0.260 Test Loss: 4.078 Test Acc: 0.260
Validation loss decreased (-0.252901 --> -0.259959).  Saving model ...
Epoch: 24 cost time: 0.5227231979370117
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.102 Vali Acc: 0.258 Test Loss: 4.102 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.48867201805114746
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.124 Vali Acc: 0.258 Test Loss: 4.124 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5321764945983887
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.150 Vali Acc: 0.260 Test Loss: 4.150 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5134389400482178
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.181 Vali Acc: 0.265 Test Loss: 4.181 Test Acc: 0.265
Validation loss decreased (-0.259959 --> -0.264664).  Saving model ...
Epoch: 28 cost time: 0.49738168716430664
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.198 Vali Acc: 0.262 Test Loss: 4.198 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5148124694824219
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.231 Vali Acc: 0.259 Test Loss: 4.231 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5338559150695801
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.269 Vali Acc: 0.259 Test Loss: 4.269 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5072782039642334
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.300 Vali Acc: 0.258 Test Loss: 4.300 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5026113986968994
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.309 Vali Acc: 0.262 Test Loss: 4.309 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6122536659240723
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.336 Vali Acc: 0.265 Test Loss: 4.336 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5198485851287842
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.364 Vali Acc: 0.265 Test Loss: 4.364 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6027185916900635
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.370 Vali Acc: 0.268 Test Loss: 4.370 Test Acc: 0.268
Validation loss decreased (-0.264664 --> -0.268192).  Saving model ...
Epoch: 36 cost time: 0.5170109272003174
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.382 Vali Acc: 0.269 Test Loss: 4.382 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 37 cost time: 0.5229215621948242
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.403 Vali Acc: 0.265 Test Loss: 4.403 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5103492736816406
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.406 Vali Acc: 0.261 Test Loss: 4.406 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5272910594940186
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.413 Vali Acc: 0.267 Test Loss: 4.413 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6102759838104248
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.426 Vali Acc: 0.267 Test Loss: 4.426 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5282502174377441
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.447 Vali Acc: 0.266 Test Loss: 4.447 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.51607346534729
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.455 Vali Acc: 0.264 Test Loss: 4.455 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.49947309494018555
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.469 Vali Acc: 0.265 Test Loss: 4.469 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4982297420501709
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.473 Vali Acc: 0.271 Test Loss: 4.473 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270544).  Saving model ...
Epoch: 45 cost time: 0.46979618072509766
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.488 Vali Acc: 0.271 Test Loss: 4.488 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4953587055206299
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.506 Vali Acc: 0.268 Test Loss: 4.506 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.47221875190734863
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.515 Vali Acc: 0.267 Test Loss: 4.515 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.525169849395752
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.533 Vali Acc: 0.267 Test Loss: 4.533 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4575202465057373
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.528 Vali Acc: 0.266 Test Loss: 4.528 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4863584041595459
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.528 Vali Acc: 0.266 Test Loss: 4.528 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.4939734935760498
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.541 Vali Acc: 0.266 Test Loss: 4.541 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.4868652820587158
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.550 Vali Acc: 0.264 Test Loss: 4.550 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5124998092651367
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.561 Vali Acc: 0.266 Test Loss: 4.561 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.47574496269226074
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.571 Vali Acc: 0.269 Test Loss: 4.571 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 359066
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.466834306716919
Epoch: 1, Steps: 10 | Train Loss: 3.524 Vali Loss: 3.365 Vali Acc: 0.019 Test Loss: 3.365 Test Acc: 0.019
Validation loss decreased (inf --> -0.018790).  Saving model ...
Epoch: 2 cost time: 0.47838425636291504
Epoch: 2, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.297 Vali Acc: 0.035 Test Loss: 3.297 Test Acc: 0.035
Validation loss decreased (-0.018790 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.6120336055755615
Epoch: 3, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.268 Vali Acc: 0.073 Test Loss: 3.268 Test Acc: 0.073
Validation loss decreased (-0.035261 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.4744446277618408
Epoch: 4, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.262 Vali Acc: 0.094 Test Loss: 3.262 Test Acc: 0.094
Validation loss decreased (-0.072908 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.4641122817993164
Epoch: 5, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.263 Vali Acc: 0.113 Test Loss: 3.263 Test Acc: 0.113
Validation loss decreased (-0.094085 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.4861421585083008
Epoch: 6, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.271 Vali Acc: 0.127 Test Loss: 3.271 Test Acc: 0.127
Validation loss decreased (-0.112909 --> -0.127026).  Saving model ...
Epoch: 7 cost time: 0.4741356372833252
Epoch: 7, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.255 Vali Acc: 0.136 Test Loss: 3.255 Test Acc: 0.136
Validation loss decreased (-0.127026 --> -0.136438).  Saving model ...
Epoch: 8 cost time: 0.44521450996398926
Epoch: 8, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.260 Vali Acc: 0.148 Test Loss: 3.260 Test Acc: 0.148
Validation loss decreased (-0.136438 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.5230684280395508
Epoch: 9, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.261 Vali Acc: 0.180 Test Loss: 3.261 Test Acc: 0.180
Validation loss decreased (-0.148203 --> -0.179967).  Saving model ...
Epoch: 10 cost time: 0.4711425304412842
Epoch: 10, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.303 Vali Acc: 0.189 Test Loss: 3.303 Test Acc: 0.189
Validation loss decreased (-0.179967 --> -0.189379).  Saving model ...
Epoch: 11 cost time: 0.4707672595977783
Epoch: 11, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.337 Vali Acc: 0.196 Test Loss: 3.337 Test Acc: 0.196
Validation loss decreased (-0.189379 --> -0.196437).  Saving model ...
Epoch: 12 cost time: 0.4820983409881592
Epoch: 12, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.387 Vali Acc: 0.224 Test Loss: 3.387 Test Acc: 0.224
Validation loss decreased (-0.196437 --> -0.223496).  Saving model ...
Epoch: 13 cost time: 0.4760706424713135
Epoch: 13, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.415 Vali Acc: 0.229 Test Loss: 3.415 Test Acc: 0.229
Validation loss decreased (-0.223496 --> -0.229378).  Saving model ...
Epoch: 14 cost time: 0.5258159637451172
Epoch: 14, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.460 Vali Acc: 0.238 Test Loss: 3.460 Test Acc: 0.238
Validation loss decreased (-0.229378 --> -0.237612).  Saving model ...
Epoch: 15 cost time: 0.5441241264343262
Epoch: 15, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.524 Vali Acc: 0.244 Test Loss: 3.524 Test Acc: 0.244
Validation loss decreased (-0.237612 --> -0.243494).  Saving model ...
Epoch: 16 cost time: 0.49170827865600586
Epoch: 16, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.582 Vali Acc: 0.252 Test Loss: 3.582 Test Acc: 0.252
Validation loss decreased (-0.243494 --> -0.251729).  Saving model ...
Epoch: 17 cost time: 0.478649377822876
Epoch: 17, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.659 Vali Acc: 0.241 Test Loss: 3.659 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5056357383728027
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.681 Vali Acc: 0.245 Test Loss: 3.681 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5518577098846436
Epoch: 19, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.714 Vali Acc: 0.251 Test Loss: 3.714 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5146629810333252
Epoch: 20, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.756 Vali Acc: 0.251 Test Loss: 3.756 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4782724380493164
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.821 Vali Acc: 0.259 Test Loss: 3.821 Test Acc: 0.259
Validation loss decreased (-0.251729 --> -0.258785).  Saving model ...
Epoch: 22 cost time: 0.504309892654419
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.875 Vali Acc: 0.256 Test Loss: 3.875 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47987794876098633
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.924 Vali Acc: 0.259 Test Loss: 3.924 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5278892517089844
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.951 Vali Acc: 0.255 Test Loss: 3.951 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5267496109008789
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.949 Vali Acc: 0.261 Test Loss: 3.949 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261137).  Saving model ...
Epoch: 26 cost time: 0.5194811820983887
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.957 Vali Acc: 0.264 Test Loss: 3.957 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263490).  Saving model ...
Epoch: 27 cost time: 0.4914216995239258
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.975 Vali Acc: 0.260 Test Loss: 3.975 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5025970935821533
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.017 Vali Acc: 0.261 Test Loss: 4.017 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.49465084075927734
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.057 Vali Acc: 0.259 Test Loss: 4.057 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5086688995361328
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.082 Vali Acc: 0.252 Test Loss: 4.082 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4794285297393799
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.102 Vali Acc: 0.253 Test Loss: 4.102 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5129046440124512
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.111 Vali Acc: 0.262 Test Loss: 4.111 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5619876384735107
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.123 Vali Acc: 0.265 Test Loss: 4.123 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264665).  Saving model ...
Epoch: 34 cost time: 0.4890413284301758
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.132 Vali Acc: 0.266 Test Loss: 4.132 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265841).  Saving model ...
Epoch: 35 cost time: 0.4994974136352539
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.155 Vali Acc: 0.265 Test Loss: 4.155 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47550392150878906
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.155 Vali Acc: 0.262 Test Loss: 4.155 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4951786994934082
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.189 Vali Acc: 0.258 Test Loss: 4.189 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4900672435760498
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.209 Vali Acc: 0.262 Test Loss: 4.209 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4822103977203369
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.212 Vali Acc: 0.271 Test Loss: 4.212 Test Acc: 0.271
Validation loss decreased (-0.265841 --> -0.270546).  Saving model ...
Epoch: 40 cost time: 0.5575847625732422
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.222 Vali Acc: 0.268 Test Loss: 4.222 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4987204074859619
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.220 Vali Acc: 0.262 Test Loss: 4.220 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4631667137145996
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.226 Vali Acc: 0.262 Test Loss: 4.226 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5572817325592041
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.248 Vali Acc: 0.265 Test Loss: 4.248 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4417243003845215
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.249 Vali Acc: 0.265 Test Loss: 4.249 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.40961551666259766
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.254 Vali Acc: 0.266 Test Loss: 4.254 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4843001365661621
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.259 Vali Acc: 0.264 Test Loss: 4.259 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.46962809562683105
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.271 Vali Acc: 0.265 Test Loss: 4.271 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.4700968265533447
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.283 Vali Acc: 0.264 Test Loss: 4.283 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5621809959411621
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.313 Vali Acc: 0.264 Test Loss: 4.313 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 349978
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.350466251373291
Epoch: 1, Steps: 10 | Train Loss: 3.454 Vali Loss: 3.385 Vali Acc: 0.060 Test Loss: 3.385 Test Acc: 0.060
Validation loss decreased (inf --> -0.059966).  Saving model ...
Epoch: 2 cost time: 0.4447457790374756
Epoch: 2, Steps: 10 | Train Loss: 2.976 Vali Loss: 3.372 Vali Acc: 0.100 Test Loss: 3.372 Test Acc: 0.100
Validation loss decreased (-0.059966 --> -0.099966).  Saving model ...
Epoch: 3 cost time: 0.4456195831298828
Epoch: 3, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.285 Vali Acc: 0.167 Test Loss: 3.285 Test Acc: 0.167
Validation loss decreased (-0.099966 --> -0.167026).  Saving model ...
Epoch: 4 cost time: 0.4324030876159668
Epoch: 4, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.487 Vali Acc: 0.173 Test Loss: 3.487 Test Acc: 0.173
Validation loss decreased (-0.167026 --> -0.172906).  Saving model ...
Epoch: 5 cost time: 0.47176694869995117
Epoch: 5, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.696 Vali Acc: 0.206 Test Loss: 3.696 Test Acc: 0.206
Validation loss decreased (-0.172906 --> -0.205845).  Saving model ...
Epoch: 6 cost time: 0.4613373279571533
Epoch: 6, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.888 Vali Acc: 0.213 Test Loss: 3.888 Test Acc: 0.213
Validation loss decreased (-0.205845 --> -0.212902).  Saving model ...
Epoch: 7 cost time: 0.4991731643676758
Epoch: 7, Steps: 10 | Train Loss: 0.322 Vali Loss: 4.333 Vali Acc: 0.225 Test Loss: 4.333 Test Acc: 0.225
Validation loss decreased (-0.212902 --> -0.224663).  Saving model ...
Epoch: 8 cost time: 0.4436938762664795
Epoch: 8, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.520 Vali Acc: 0.220 Test Loss: 4.520 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4998786449432373
Epoch: 9, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.811 Vali Acc: 0.231 Test Loss: 4.811 Test Acc: 0.231
Validation loss decreased (-0.224663 --> -0.230540).  Saving model ...
Epoch: 10 cost time: 0.47861742973327637
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.786 Vali Acc: 0.260 Test Loss: 4.786 Test Acc: 0.260
Validation loss decreased (-0.230540 --> -0.259952).  Saving model ...
Epoch: 11 cost time: 0.48697543144226074
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.138 Vali Acc: 0.242 Test Loss: 5.138 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5243022441864014
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.525 Vali Acc: 0.238 Test Loss: 5.525 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5385615825653076
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.456 Vali Acc: 0.246 Test Loss: 5.456 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5408804416656494
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.430 Vali Acc: 0.253 Test Loss: 5.430 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5450241565704346
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.657 Vali Acc: 0.246 Test Loss: 5.657 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5274868011474609
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.697 Vali Acc: 0.260 Test Loss: 5.697 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.542891263961792
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.713 Vali Acc: 0.260 Test Loss: 5.713 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5467896461486816
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.691 Vali Acc: 0.261 Test Loss: 5.691 Test Acc: 0.261
Validation loss decreased (-0.259952 --> -0.261120).  Saving model ...
Epoch: 19 cost time: 0.6504621505737305
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.718 Vali Acc: 0.265 Test Loss: 5.718 Test Acc: 0.265
Validation loss decreased (-0.261120 --> -0.264649).  Saving model ...
Epoch: 20 cost time: 0.5507853031158447
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.728 Vali Acc: 0.266 Test Loss: 5.728 Test Acc: 0.266
Validation loss decreased (-0.264649 --> -0.265825).  Saving model ...
Epoch: 21 cost time: 0.5357093811035156
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.742 Vali Acc: 0.266 Test Loss: 5.742 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6112065315246582
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.757 Vali Acc: 0.269 Test Loss: 5.757 Test Acc: 0.269
Validation loss decreased (-0.265825 --> -0.269354).  Saving model ...
Epoch: 23 cost time: 0.6111798286437988
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.772 Vali Acc: 0.271 Test Loss: 5.772 Test Acc: 0.271
Validation loss decreased (-0.269354 --> -0.270531).  Saving model ...
Epoch: 24 cost time: 0.5509335994720459
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.793 Vali Acc: 0.271 Test Loss: 5.793 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5955276489257812
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.804 Vali Acc: 0.274 Test Loss: 5.804 Test Acc: 0.274
Validation loss decreased (-0.270531 --> -0.274060).  Saving model ...
Epoch: 26 cost time: 0.525827169418335
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.812 Vali Acc: 0.274 Test Loss: 5.812 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.539386510848999
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.814 Vali Acc: 0.273 Test Loss: 5.814 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5381069183349609
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.836 Vali Acc: 0.273 Test Loss: 5.836 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5474164485931396
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.857 Vali Acc: 0.272 Test Loss: 5.857 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.43744826316833496
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.860 Vali Acc: 0.273 Test Loss: 5.860 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.56062912940979
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.876 Vali Acc: 0.269 Test Loss: 5.876 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5697367191314697
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.891 Vali Acc: 0.273 Test Loss: 5.891 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5503859519958496
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.906 Vali Acc: 0.273 Test Loss: 5.906 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5321846008300781
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.916 Vali Acc: 0.271 Test Loss: 5.916 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5462071895599365
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.925 Vali Acc: 0.274 Test Loss: 5.925 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 958746
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5524742603302002
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.267 Vali Acc: 0.065 Test Loss: 3.267 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 0.45206236839294434
Epoch: 2, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.363 Vali Acc: 0.091 Test Loss: 3.363 Test Acc: 0.091
Validation loss decreased (-0.064673 --> -0.090555).  Saving model ...
Epoch: 3 cost time: 0.5018446445465088
Epoch: 3, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.313 Vali Acc: 0.140 Test Loss: 3.313 Test Acc: 0.140
Validation loss decreased (-0.090555 --> -0.139967).  Saving model ...
Epoch: 4 cost time: 0.4637753963470459
Epoch: 4, Steps: 10 | Train Loss: 1.975 Vali Loss: 3.250 Vali Acc: 0.166 Test Loss: 3.250 Test Acc: 0.166
Validation loss decreased (-0.139967 --> -0.165850).  Saving model ...
Epoch: 5 cost time: 0.4944007396697998
Epoch: 5, Steps: 10 | Train Loss: 1.509 Vali Loss: 3.422 Vali Acc: 0.174 Test Loss: 3.422 Test Acc: 0.174
Validation loss decreased (-0.165850 --> -0.174083).  Saving model ...
Epoch: 6 cost time: 0.4834175109863281
Epoch: 6, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.419 Vali Acc: 0.214 Test Loss: 3.419 Test Acc: 0.214
Validation loss decreased (-0.174083 --> -0.214083).  Saving model ...
Epoch: 7 cost time: 0.47470760345458984
Epoch: 7, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.580 Vali Acc: 0.215 Test Loss: 3.580 Test Acc: 0.215
Validation loss decreased (-0.214083 --> -0.215258).  Saving model ...
Epoch: 8 cost time: 0.4694952964782715
Epoch: 8, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.703 Vali Acc: 0.240 Test Loss: 3.703 Test Acc: 0.240
Validation loss decreased (-0.215258 --> -0.239963).  Saving model ...
Epoch: 9 cost time: 0.4003126621246338
Epoch: 9, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.949 Vali Acc: 0.225 Test Loss: 3.949 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4685952663421631
Epoch: 10, Steps: 10 | Train Loss: 0.214 Vali Loss: 4.060 Vali Acc: 0.245 Test Loss: 4.060 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244665).  Saving model ...
Epoch: 11 cost time: 0.4522695541381836
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.230 Vali Acc: 0.254 Test Loss: 4.230 Test Acc: 0.254
Validation loss decreased (-0.244665 --> -0.254075).  Saving model ...
Epoch: 12 cost time: 0.45663905143737793
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.501 Vali Acc: 0.236 Test Loss: 4.501 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4513552188873291
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.596 Vali Acc: 0.258 Test Loss: 4.596 Test Acc: 0.258
Validation loss decreased (-0.254075 --> -0.257601).  Saving model ...
Epoch: 14 cost time: 0.4671766757965088
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.709 Vali Acc: 0.238 Test Loss: 4.709 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.39996886253356934
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.775 Vali Acc: 0.241 Test Loss: 4.775 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4729888439178467
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.822 Vali Acc: 0.244 Test Loss: 4.822 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.44689178466796875
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.921 Vali Acc: 0.245 Test Loss: 4.921 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4728853702545166
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.945 Vali Acc: 0.247 Test Loss: 4.945 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5170977115631104
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.935 Vali Acc: 0.255 Test Loss: 4.935 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.48430752754211426
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.968 Vali Acc: 0.258 Test Loss: 4.968 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4712185859680176
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.018 Vali Acc: 0.253 Test Loss: 5.018 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.47524309158325195
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.070 Vali Acc: 0.253 Test Loss: 5.070 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.45247578620910645
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.113 Vali Acc: 0.253 Test Loss: 5.113 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 579866
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4230458736419678
Epoch: 1, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.327 Vali Acc: 0.052 Test Loss: 3.327 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.45433831214904785
Epoch: 2, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.347 Vali Acc: 0.073 Test Loss: 3.347 Test Acc: 0.073
Validation loss decreased (-0.051731 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.4524044990539551
Epoch: 3, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.357 Vali Acc: 0.088 Test Loss: 3.357 Test Acc: 0.088
Validation loss decreased (-0.072908 --> -0.088202).  Saving model ...
Epoch: 4 cost time: 0.46552538871765137
Epoch: 4, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.296 Vali Acc: 0.138 Test Loss: 3.296 Test Acc: 0.138
Validation loss decreased (-0.088202 --> -0.137614).  Saving model ...
Epoch: 5 cost time: 0.4649944305419922
Epoch: 5, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.271 Vali Acc: 0.160 Test Loss: 3.271 Test Acc: 0.160
Validation loss decreased (-0.137614 --> -0.159967).  Saving model ...
Epoch: 6 cost time: 0.4830045700073242
Epoch: 6, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.289 Vali Acc: 0.186 Test Loss: 3.289 Test Acc: 0.186
Validation loss decreased (-0.159967 --> -0.185849).  Saving model ...
Epoch: 7 cost time: 0.4683189392089844
Epoch: 7, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.373 Vali Acc: 0.196 Test Loss: 3.373 Test Acc: 0.196
Validation loss decreased (-0.185849 --> -0.196437).  Saving model ...
Epoch: 8 cost time: 0.49354028701782227
Epoch: 8, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.451 Vali Acc: 0.212 Test Loss: 3.451 Test Acc: 0.212
Validation loss decreased (-0.196437 --> -0.211730).  Saving model ...
Epoch: 9 cost time: 0.4604661464691162
Epoch: 9, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.595 Vali Acc: 0.227 Test Loss: 3.595 Test Acc: 0.227
Validation loss decreased (-0.211730 --> -0.227023).  Saving model ...
Epoch: 10 cost time: 0.4942920207977295
Epoch: 10, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.684 Vali Acc: 0.229 Test Loss: 3.684 Test Acc: 0.229
Validation loss decreased (-0.227023 --> -0.229375).  Saving model ...
Epoch: 11 cost time: 0.5001842975616455
Epoch: 11, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.926 Vali Acc: 0.227 Test Loss: 3.926 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.461289644241333
Epoch: 12, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.959 Vali Acc: 0.249 Test Loss: 3.959 Test Acc: 0.249
Validation loss decreased (-0.229375 --> -0.249372).  Saving model ...
Epoch: 13 cost time: 0.48479199409484863
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.085 Vali Acc: 0.248 Test Loss: 4.085 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.49111080169677734
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.248 Vali Acc: 0.239 Test Loss: 4.248 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4771411418914795
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.346 Vali Acc: 0.246 Test Loss: 4.346 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.47821903228759766
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.362 Vali Acc: 0.247 Test Loss: 4.362 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.46846747398376465
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.410 Vali Acc: 0.247 Test Loss: 4.410 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.38015055656433105
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.542 Vali Acc: 0.246 Test Loss: 4.542 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.45702099800109863
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.566 Vali Acc: 0.247 Test Loss: 4.566 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.46658873558044434
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.590 Vali Acc: 0.246 Test Loss: 4.590 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5024244785308838
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.614 Vali Acc: 0.254 Test Loss: 4.614 Test Acc: 0.254
Validation loss decreased (-0.249372 --> -0.254072).  Saving model ...
Epoch: 22 cost time: 0.46888160705566406
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.623 Vali Acc: 0.260 Test Loss: 4.623 Test Acc: 0.260
Validation loss decreased (-0.254072 --> -0.259954).  Saving model ...
Epoch: 23 cost time: 0.483184814453125
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.259 Test Loss: 4.630 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.47728896141052246
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.671 Vali Acc: 0.261 Test Loss: 4.671 Test Acc: 0.261
Validation loss decreased (-0.259954 --> -0.261130).  Saving model ...
Epoch: 25 cost time: 0.47582077980041504
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.684 Vali Acc: 0.258 Test Loss: 4.684 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4767446517944336
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.717 Vali Acc: 0.254 Test Loss: 4.717 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4736661911010742
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.760 Vali Acc: 0.253 Test Loss: 4.760 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4933931827545166
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.803 Vali Acc: 0.253 Test Loss: 4.803 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.48894500732421875
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.823 Vali Acc: 0.253 Test Loss: 4.823 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5248680114746094
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.821 Vali Acc: 0.256 Test Loss: 4.821 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4790961742401123
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.832 Vali Acc: 0.259 Test Loss: 4.832 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.45784878730773926
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.855 Vali Acc: 0.261 Test Loss: 4.855 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4962468147277832
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.872 Vali Acc: 0.264 Test Loss: 4.872 Test Acc: 0.264
Validation loss decreased (-0.261130 --> -0.263481).  Saving model ...
Epoch: 34 cost time: 0.46638989448547363
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.901 Vali Acc: 0.260 Test Loss: 4.901 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.48758435249328613
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.898 Vali Acc: 0.261 Test Loss: 4.898 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.45398664474487305
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.913 Vali Acc: 0.264 Test Loss: 4.913 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4720296859741211
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.924 Vali Acc: 0.267 Test Loss: 4.924 Test Acc: 0.267
Validation loss decreased (-0.263481 --> -0.267010).  Saving model ...
Epoch: 38 cost time: 0.38919591903686523
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.927 Vali Acc: 0.267 Test Loss: 4.927 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5076439380645752
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.952 Vali Acc: 0.269 Test Loss: 4.952 Test Acc: 0.269
Validation loss decreased (-0.267010 --> -0.269362).  Saving model ...
Epoch: 40 cost time: 0.5081706047058105
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.983 Vali Acc: 0.264 Test Loss: 4.983 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.43330955505371094
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.999 Vali Acc: 0.262 Test Loss: 4.999 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.47706007957458496
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.011 Vali Acc: 0.260 Test Loss: 5.011 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4559824466705322
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.014 Vali Acc: 0.260 Test Loss: 5.014 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4747786521911621
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.023 Vali Acc: 0.261 Test Loss: 5.023 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4550747871398926
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.036 Vali Acc: 0.265 Test Loss: 5.036 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.44928622245788574
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.055 Vali Acc: 0.266 Test Loss: 5.055 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5111727714538574
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.069 Vali Acc: 0.265 Test Loss: 5.069 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5058062076568604
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.087 Vali Acc: 0.266 Test Loss: 5.087 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5176448822021484
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.091 Vali Acc: 0.265 Test Loss: 5.091 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 450586
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.357837438583374
Epoch: 1, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.347 Vali Acc: 0.035 Test Loss: 3.347 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.4691309928894043
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.343 Vali Acc: 0.052 Test Loss: 3.343 Test Acc: 0.052
Validation loss decreased (-0.035261 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.441638708114624
Epoch: 3, Steps: 10 | Train Loss: 2.868 Vali Loss: 3.379 Vali Acc: 0.076 Test Loss: 3.379 Test Acc: 0.076
Validation loss decreased (-0.051731 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.4273874759674072
Epoch: 4, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.325 Vali Acc: 0.114 Test Loss: 3.325 Test Acc: 0.114
Validation loss decreased (-0.076437 --> -0.114084).  Saving model ...
Epoch: 5 cost time: 0.4521756172180176
Epoch: 5, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.261 Vali Acc: 0.138 Test Loss: 3.261 Test Acc: 0.138
Validation loss decreased (-0.114084 --> -0.137614).  Saving model ...
Epoch: 6 cost time: 0.4374978542327881
Epoch: 6, Steps: 10 | Train Loss: 1.711 Vali Loss: 3.267 Vali Acc: 0.154 Test Loss: 3.267 Test Acc: 0.154
Validation loss decreased (-0.137614 --> -0.154085).  Saving model ...
Epoch: 7 cost time: 0.4476621150970459
Epoch: 7, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.325 Vali Acc: 0.180 Test Loss: 3.325 Test Acc: 0.180
Validation loss decreased (-0.154085 --> -0.179967).  Saving model ...
Epoch: 8 cost time: 0.44382262229919434
Epoch: 8, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.338 Vali Acc: 0.194 Test Loss: 3.338 Test Acc: 0.194
Validation loss decreased (-0.179967 --> -0.194084).  Saving model ...
Epoch: 9 cost time: 0.4955317974090576
Epoch: 9, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.431 Vali Acc: 0.216 Test Loss: 3.431 Test Acc: 0.216
Validation loss decreased (-0.194084 --> -0.216436).  Saving model ...
Epoch: 10 cost time: 0.43807244300842285
Epoch: 10, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.485 Vali Acc: 0.241 Test Loss: 3.485 Test Acc: 0.241
Validation loss decreased (-0.216436 --> -0.241142).  Saving model ...
Epoch: 11 cost time: 0.4735133647918701
Epoch: 11, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.608 Vali Acc: 0.234 Test Loss: 3.608 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47951245307922363
Epoch: 12, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.689 Vali Acc: 0.236 Test Loss: 3.689 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.445035457611084
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.839 Vali Acc: 0.232 Test Loss: 3.839 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4595944881439209
Epoch: 14, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.951 Vali Acc: 0.252 Test Loss: 3.951 Test Acc: 0.252
Validation loss decreased (-0.241142 --> -0.251725).  Saving model ...
Epoch: 15 cost time: 0.4238736629486084
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.119 Vali Acc: 0.244 Test Loss: 4.119 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.41893553733825684
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.194 Vali Acc: 0.251 Test Loss: 4.194 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.45551252365112305
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.271 Vali Acc: 0.236 Test Loss: 4.271 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.46349048614501953
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.320 Vali Acc: 0.241 Test Loss: 4.320 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.49132251739501953
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.398 Vali Acc: 0.239 Test Loss: 4.398 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4679563045501709
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.416 Vali Acc: 0.245 Test Loss: 4.416 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4253275394439697
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.483 Vali Acc: 0.246 Test Loss: 4.483 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4673779010772705
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.534 Vali Acc: 0.241 Test Loss: 4.534 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.44643235206604004
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.549 Vali Acc: 0.241 Test Loss: 4.549 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.47095704078674316
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.576 Vali Acc: 0.240 Test Loss: 4.576 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 391194
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6323909759521484
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.321 Vali Acc: 0.041 Test Loss: 3.321 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.45297718048095703
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.293 Vali Acc: 0.065 Test Loss: 3.293 Test Acc: 0.065
Validation loss decreased (-0.041143 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.46766185760498047
Epoch: 3, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.289 Vali Acc: 0.084 Test Loss: 3.289 Test Acc: 0.084
Validation loss decreased (-0.064673 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 0.45129823684692383
Epoch: 4, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.273 Vali Acc: 0.107 Test Loss: 3.273 Test Acc: 0.107
Validation loss decreased (-0.083497 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.44369029998779297
Epoch: 5, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.237 Vali Acc: 0.135 Test Loss: 3.237 Test Acc: 0.135
Validation loss decreased (-0.107026 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.4492952823638916
Epoch: 6, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.234 Vali Acc: 0.161 Test Loss: 3.234 Test Acc: 0.161
Validation loss decreased (-0.135262 --> -0.161144).  Saving model ...
Epoch: 7 cost time: 0.492081880569458
Epoch: 7, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.225 Vali Acc: 0.185 Test Loss: 3.225 Test Acc: 0.185
Validation loss decreased (-0.161144 --> -0.184674).  Saving model ...
Epoch: 8 cost time: 0.48346853256225586
Epoch: 8, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.232 Vali Acc: 0.201 Test Loss: 3.232 Test Acc: 0.201
Validation loss decreased (-0.184674 --> -0.201144).  Saving model ...
Epoch: 9 cost time: 0.461658239364624
Epoch: 9, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.260 Vali Acc: 0.221 Test Loss: 3.260 Test Acc: 0.221
Validation loss decreased (-0.201144 --> -0.221144).  Saving model ...
Epoch: 10 cost time: 0.5074450969696045
Epoch: 10, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.333 Vali Acc: 0.216 Test Loss: 3.333 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45821523666381836
Epoch: 11, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.386 Vali Acc: 0.229 Test Loss: 3.386 Test Acc: 0.229
Validation loss decreased (-0.221144 --> -0.229378).  Saving model ...
Epoch: 12 cost time: 0.4613313674926758
Epoch: 12, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.454 Vali Acc: 0.228 Test Loss: 3.454 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4690124988555908
Epoch: 13, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.558 Vali Acc: 0.225 Test Loss: 3.558 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.46633338928222656
Epoch: 14, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.633 Vali Acc: 0.234 Test Loss: 3.633 Test Acc: 0.234
Validation loss decreased (-0.229378 --> -0.234081).  Saving model ...
Epoch: 15 cost time: 0.4407811164855957
Epoch: 15, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.717 Vali Acc: 0.249 Test Loss: 3.717 Test Acc: 0.249
Validation loss decreased (-0.234081 --> -0.249375).  Saving model ...
Epoch: 16 cost time: 0.43583130836486816
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.768 Vali Acc: 0.255 Test Loss: 3.768 Test Acc: 0.255
Validation loss decreased (-0.249375 --> -0.255256).  Saving model ...
Epoch: 17 cost time: 0.44134068489074707
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.845 Vali Acc: 0.258 Test Loss: 3.845 Test Acc: 0.258
Validation loss decreased (-0.255256 --> -0.257609).  Saving model ...
Epoch: 18 cost time: 0.41620683670043945
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.941 Vali Acc: 0.249 Test Loss: 3.941 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4377119541168213
Epoch: 19, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.017 Vali Acc: 0.253 Test Loss: 4.017 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.45690369606018066
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.091 Vali Acc: 0.253 Test Loss: 4.091 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.42684125900268555
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.129 Vali Acc: 0.266 Test Loss: 4.129 Test Acc: 0.266
Validation loss decreased (-0.257609 --> -0.265841).  Saving model ...
Epoch: 22 cost time: 0.4345695972442627
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.142 Vali Acc: 0.266 Test Loss: 4.142 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.41439104080200195
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.195 Vali Acc: 0.266 Test Loss: 4.195 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4510824680328369
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.226 Vali Acc: 0.269 Test Loss: 4.226 Test Acc: 0.269
Validation loss decreased (-0.265841 --> -0.269370).  Saving model ...
Epoch: 25 cost time: 0.43921566009521484
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.236 Vali Acc: 0.271 Test Loss: 4.236 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270546).  Saving model ...
Epoch: 26 cost time: 0.4440746307373047
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.261 Vali Acc: 0.271 Test Loss: 4.261 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.44035983085632324
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.260 Vali Acc: 0.269 Test Loss: 4.260 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4704475402832031
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.269 Vali Acc: 0.274 Test Loss: 4.269 Test Acc: 0.274
Validation loss decreased (-0.270546 --> -0.274075).  Saving model ...
Epoch: 29 cost time: 0.45554375648498535
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.299 Vali Acc: 0.275 Test Loss: 4.299 Test Acc: 0.275
Validation loss decreased (-0.274075 --> -0.275251).  Saving model ...
Epoch: 30 cost time: 0.5597677230834961
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.322 Vali Acc: 0.275 Test Loss: 4.322 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4446554183959961
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.346 Vali Acc: 0.269 Test Loss: 4.346 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4620652198791504
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.369 Vali Acc: 0.273 Test Loss: 4.369 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.43381619453430176
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.400 Vali Acc: 0.275 Test Loss: 4.400 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.45971059799194336
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.415 Vali Acc: 0.272 Test Loss: 4.415 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4578871726989746
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.410 Vali Acc: 0.273 Test Loss: 4.410 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5093297958374023
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.416 Vali Acc: 0.275 Test Loss: 4.416 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.46216535568237305
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.428 Vali Acc: 0.273 Test Loss: 4.428 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4559330940246582
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.441 Vali Acc: 0.273 Test Loss: 4.441 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4801907539367676
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.447 Vali Acc: 0.273 Test Loss: 4.447 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 322202
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3972749710083008
Epoch: 1, Steps: 10 | Train Loss: 3.443 Vali Loss: 3.360 Vali Acc: 0.046 Test Loss: 3.360 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.41120481491088867
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.320 Vali Acc: 0.060 Test Loss: 3.320 Test Acc: 0.060
Validation loss decreased (-0.045849 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.4460880756378174
Epoch: 3, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.304 Vali Acc: 0.074 Test Loss: 3.304 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.41908979415893555
Epoch: 4, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.298 Vali Acc: 0.091 Test Loss: 3.298 Test Acc: 0.091
Validation loss decreased (-0.074085 --> -0.090555).  Saving model ...
Epoch: 5 cost time: 0.44806766510009766
Epoch: 5, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.292 Vali Acc: 0.112 Test Loss: 3.292 Test Acc: 0.112
Validation loss decreased (-0.090555 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 0.467881441116333
Epoch: 6, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.291 Vali Acc: 0.128 Test Loss: 3.291 Test Acc: 0.128
Validation loss decreased (-0.111732 --> -0.128202).  Saving model ...
Epoch: 7 cost time: 0.499600887298584
Epoch: 7, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.266 Vali Acc: 0.139 Test Loss: 3.266 Test Acc: 0.139
Validation loss decreased (-0.128202 --> -0.138791).  Saving model ...
Epoch: 8 cost time: 0.44272375106811523
Epoch: 8, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.280 Vali Acc: 0.164 Test Loss: 3.280 Test Acc: 0.164
Validation loss decreased (-0.138791 --> -0.163497).  Saving model ...
Epoch: 9 cost time: 0.4436798095703125
Epoch: 9, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.300 Vali Acc: 0.171 Test Loss: 3.300 Test Acc: 0.171
Validation loss decreased (-0.163497 --> -0.170555).  Saving model ...
Epoch: 10 cost time: 0.45076727867126465
Epoch: 10, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.329 Vali Acc: 0.186 Test Loss: 3.329 Test Acc: 0.186
Validation loss decreased (-0.170555 --> -0.185849).  Saving model ...
Epoch: 11 cost time: 0.45276808738708496
Epoch: 11, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.391 Vali Acc: 0.179 Test Loss: 3.391 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.469806432723999
Epoch: 12, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.466 Vali Acc: 0.198 Test Loss: 3.466 Test Acc: 0.198
Validation loss decreased (-0.185849 --> -0.197612).  Saving model ...
Epoch: 13 cost time: 0.46602582931518555
Epoch: 13, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.510 Vali Acc: 0.207 Test Loss: 3.510 Test Acc: 0.207
Validation loss decreased (-0.197612 --> -0.207024).  Saving model ...
Epoch: 14 cost time: 0.4315664768218994
Epoch: 14, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.572 Vali Acc: 0.221 Test Loss: 3.572 Test Acc: 0.221
Validation loss decreased (-0.207024 --> -0.221141).  Saving model ...
Epoch: 15 cost time: 0.46967267990112305
Epoch: 15, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.647 Vali Acc: 0.234 Test Loss: 3.647 Test Acc: 0.234
Validation loss decreased (-0.221141 --> -0.234081).  Saving model ...
Epoch: 16 cost time: 0.4856295585632324
Epoch: 16, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.768 Vali Acc: 0.228 Test Loss: 3.768 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4465353488922119
Epoch: 17, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.788 Vali Acc: 0.236 Test Loss: 3.788 Test Acc: 0.236
Validation loss decreased (-0.234081 --> -0.236433).  Saving model ...
Epoch: 18 cost time: 0.42534422874450684
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.863 Vali Acc: 0.251 Test Loss: 3.863 Test Acc: 0.251
Validation loss decreased (-0.236433 --> -0.250550).  Saving model ...
Epoch: 19 cost time: 0.4335970878601074
Epoch: 19, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.959 Vali Acc: 0.241 Test Loss: 3.959 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43332600593566895
Epoch: 20, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.004 Vali Acc: 0.239 Test Loss: 4.004 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4691917896270752
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.076 Vali Acc: 0.251 Test Loss: 4.076 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4118220806121826
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.101 Vali Acc: 0.246 Test Loss: 4.101 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43990039825439453
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.111 Vali Acc: 0.255 Test Loss: 4.111 Test Acc: 0.255
Validation loss decreased (-0.250550 --> -0.255253).  Saving model ...
Epoch: 24 cost time: 0.4658794403076172
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.148 Vali Acc: 0.252 Test Loss: 4.148 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.434037446975708
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.204 Vali Acc: 0.256 Test Loss: 4.204 Test Acc: 0.256
Validation loss decreased (-0.255253 --> -0.256429).  Saving model ...
Epoch: 26 cost time: 0.4177696704864502
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.247 Vali Acc: 0.246 Test Loss: 4.247 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3974132537841797
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.272 Vali Acc: 0.253 Test Loss: 4.272 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.46036362648010254
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.305 Vali Acc: 0.254 Test Loss: 4.305 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4138369560241699
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.314 Vali Acc: 0.255 Test Loss: 4.314 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4568054676055908
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.366 Vali Acc: 0.260 Test Loss: 4.366 Test Acc: 0.260
Validation loss decreased (-0.256429 --> -0.259956).  Saving model ...
Epoch: 31 cost time: 0.43871593475341797
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.389 Vali Acc: 0.258 Test Loss: 4.389 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3947727680206299
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.387 Vali Acc: 0.255 Test Loss: 4.387 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.43442201614379883
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.408 Vali Acc: 0.258 Test Loss: 4.408 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.455352783203125
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.419 Vali Acc: 0.261 Test Loss: 4.419 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 35 cost time: 0.44291210174560547
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.435 Vali Acc: 0.262 Test Loss: 4.435 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262309).  Saving model ...
Epoch: 36 cost time: 0.473524808883667
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.452 Vali Acc: 0.260 Test Loss: 4.452 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4482431411743164
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.463 Vali Acc: 0.256 Test Loss: 4.463 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.46120452880859375
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.505 Vali Acc: 0.256 Test Loss: 4.505 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.42197346687316895
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.519 Vali Acc: 0.262 Test Loss: 4.519 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.42424511909484863
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.551 Vali Acc: 0.254 Test Loss: 4.551 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4689357280731201
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.569 Vali Acc: 0.254 Test Loss: 4.569 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4643077850341797
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.572 Vali Acc: 0.260 Test Loss: 4.572 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4925072193145752
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.576 Vali Acc: 0.261 Test Loss: 4.576 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4387674331665039
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.590 Vali Acc: 0.264 Test Loss: 4.590 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263484).  Saving model ...
Epoch: 45 cost time: 0.4290797710418701
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.588 Vali Acc: 0.265 Test Loss: 4.588 Test Acc: 0.265
Validation loss decreased (-0.263484 --> -0.264660).  Saving model ...
Epoch: 46 cost time: 0.3911263942718506
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.602 Vali Acc: 0.262 Test Loss: 4.602 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4508931636810303
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.621 Vali Acc: 0.262 Test Loss: 4.621 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4066965579986572
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.636 Vali Acc: 0.259 Test Loss: 4.636 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4487576484680176
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.652 Vali Acc: 0.260 Test Loss: 4.652 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.45674848556518555
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.669 Vali Acc: 0.262 Test Loss: 4.669 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.45435643196105957
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.669 Vali Acc: 0.262 Test Loss: 4.669 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.44633936882019043
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.691 Vali Acc: 0.262 Test Loss: 4.691 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.411792516708374
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.705 Vali Acc: 0.262 Test Loss: 4.705 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.47040390968322754
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.731 Vali Acc: 0.256 Test Loss: 4.731 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.42886924743652344
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.751 Vali Acc: 0.259 Test Loss: 4.751 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 293274
model size : 3.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.485281229019165
Epoch: 1, Steps: 10 | Train Loss: 3.477 Vali Loss: 3.337 Vali Acc: 0.049 Test Loss: 3.337 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.45061206817626953
Epoch: 2, Steps: 10 | Train Loss: 3.402 Vali Loss: 3.301 Vali Acc: 0.065 Test Loss: 3.301 Test Acc: 0.065
Validation loss decreased (-0.049378 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.49581384658813477
Epoch: 3, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.279 Vali Acc: 0.074 Test Loss: 3.279 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.4802272319793701
Epoch: 4, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.268 Vali Acc: 0.093 Test Loss: 3.268 Test Acc: 0.093
Validation loss decreased (-0.074085 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 0.44756317138671875
Epoch: 5, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.255 Vali Acc: 0.118 Test Loss: 3.255 Test Acc: 0.118
Validation loss decreased (-0.092908 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.49226832389831543
Epoch: 6, Steps: 10 | Train Loss: 2.369 Vali Loss: 3.248 Vali Acc: 0.140 Test Loss: 3.248 Test Acc: 0.140
Validation loss decreased (-0.117615 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 0.6016194820404053
Epoch: 7, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.251 Vali Acc: 0.149 Test Loss: 3.251 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 8 cost time: 0.45421314239501953
Epoch: 8, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.274 Vali Acc: 0.156 Test Loss: 3.274 Test Acc: 0.156
Validation loss decreased (-0.149379 --> -0.156438).  Saving model ...
Epoch: 9 cost time: 0.41664814949035645
Epoch: 9, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.273 Vali Acc: 0.168 Test Loss: 3.273 Test Acc: 0.168
Validation loss decreased (-0.156438 --> -0.168203).  Saving model ...
Epoch: 10 cost time: 0.4183785915374756
Epoch: 10, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.303 Vali Acc: 0.176 Test Loss: 3.303 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 11 cost time: 0.4646480083465576
Epoch: 11, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.344 Vali Acc: 0.189 Test Loss: 3.344 Test Acc: 0.189
Validation loss decreased (-0.176438 --> -0.189378).  Saving model ...
Epoch: 12 cost time: 0.46607232093811035
Epoch: 12, Steps: 10 | Train Loss: 1.073 Vali Loss: 3.378 Vali Acc: 0.195 Test Loss: 3.378 Test Acc: 0.195
Validation loss decreased (-0.189378 --> -0.195260).  Saving model ...
Epoch: 13 cost time: 0.4588890075683594
Epoch: 13, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.422 Vali Acc: 0.207 Test Loss: 3.422 Test Acc: 0.207
Validation loss decreased (-0.195260 --> -0.207025).  Saving model ...
Epoch: 14 cost time: 0.42508745193481445
Epoch: 14, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.470 Vali Acc: 0.199 Test Loss: 3.470 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4373147487640381
Epoch: 15, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.569 Vali Acc: 0.208 Test Loss: 3.569 Test Acc: 0.208
Validation loss decreased (-0.207025 --> -0.208200).  Saving model ...
Epoch: 16 cost time: 0.45360493659973145
Epoch: 16, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.629 Vali Acc: 0.218 Test Loss: 3.629 Test Acc: 0.218
Validation loss decreased (-0.208200 --> -0.217611).  Saving model ...
Epoch: 17 cost time: 0.4711592197418213
Epoch: 17, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.632 Vali Acc: 0.241 Test Loss: 3.632 Test Acc: 0.241
Validation loss decreased (-0.217611 --> -0.241140).  Saving model ...
Epoch: 18 cost time: 0.4523296356201172
Epoch: 18, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.696 Vali Acc: 0.248 Test Loss: 3.696 Test Acc: 0.248
Validation loss decreased (-0.241140 --> -0.248198).  Saving model ...
Epoch: 19 cost time: 0.4510061740875244
Epoch: 19, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.804 Vali Acc: 0.235 Test Loss: 3.804 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.42980194091796875
Epoch: 20, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.851 Vali Acc: 0.238 Test Loss: 3.851 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4543120861053467
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.873 Vali Acc: 0.235 Test Loss: 3.873 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.44231128692626953
Epoch: 22, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.887 Vali Acc: 0.247 Test Loss: 3.887 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43169260025024414
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.879 Vali Acc: 0.252 Test Loss: 3.879 Test Acc: 0.252
Validation loss decreased (-0.248198 --> -0.251726).  Saving model ...
Epoch: 24 cost time: 0.44170260429382324
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.907 Vali Acc: 0.254 Test Loss: 3.907 Test Acc: 0.254
Validation loss decreased (-0.251726 --> -0.254079).  Saving model ...
Epoch: 25 cost time: 0.44948458671569824
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.937 Vali Acc: 0.264 Test Loss: 3.937 Test Acc: 0.264
Validation loss decreased (-0.254079 --> -0.263490).  Saving model ...
Epoch: 26 cost time: 0.44518423080444336
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.980 Vali Acc: 0.261 Test Loss: 3.980 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4466369152069092
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.001 Vali Acc: 0.264 Test Loss: 4.001 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4842643737792969
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.019 Vali Acc: 0.272 Test Loss: 4.019 Test Acc: 0.272
Validation loss decreased (-0.263490 --> -0.271725).  Saving model ...
Epoch: 29 cost time: 0.480104923248291
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.054 Vali Acc: 0.267 Test Loss: 4.054 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.47298526763916016
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.060 Vali Acc: 0.267 Test Loss: 4.060 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.44533753395080566
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.079 Vali Acc: 0.273 Test Loss: 4.079 Test Acc: 0.273
Validation loss decreased (-0.271725 --> -0.272900).  Saving model ...
Epoch: 32 cost time: 0.4409956932067871
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.100 Vali Acc: 0.273 Test Loss: 4.100 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.43685388565063477
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.129 Vali Acc: 0.273 Test Loss: 4.129 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4408302307128906
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.154 Vali Acc: 0.271 Test Loss: 4.154 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4464223384857178
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.174 Vali Acc: 0.267 Test Loss: 4.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.47986268997192383
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.188 Vali Acc: 0.268 Test Loss: 4.188 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4742431640625
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.209 Vali Acc: 0.267 Test Loss: 4.209 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4543921947479248
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.225 Vali Acc: 0.264 Test Loss: 4.225 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.543903112411499
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.249 Vali Acc: 0.265 Test Loss: 4.249 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4838228225708008
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.250 Vali Acc: 0.271 Test Loss: 4.250 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.46016407012939453
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.255 Vali Acc: 0.272 Test Loss: 4.255 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 284186
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5539402961730957
Epoch: 1, Steps: 10 | Train Loss: 3.439 Vali Loss: 3.370 Vali Acc: 0.073 Test Loss: 3.370 Test Acc: 0.073
Validation loss decreased (inf --> -0.072907).  Saving model ...
Epoch: 2 cost time: 0.534308671951294
Epoch: 2, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.352 Vali Acc: 0.118 Test Loss: 3.352 Test Acc: 0.118
Validation loss decreased (-0.072907 --> -0.117614).  Saving model ...
Epoch: 3 cost time: 0.5114948749542236
Epoch: 3, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.244 Vali Acc: 0.178 Test Loss: 3.244 Test Acc: 0.178
Validation loss decreased (-0.117614 --> -0.177615).  Saving model ...
Epoch: 4 cost time: 0.5399456024169922
Epoch: 4, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.376 Vali Acc: 0.189 Test Loss: 3.376 Test Acc: 0.189
Validation loss decreased (-0.177615 --> -0.189378).  Saving model ...
Epoch: 5 cost time: 0.5312192440032959
Epoch: 5, Steps: 10 | Train Loss: 0.969 Vali Loss: 3.702 Vali Acc: 0.184 Test Loss: 3.702 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4216325283050537
Epoch: 6, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.776 Vali Acc: 0.236 Test Loss: 3.776 Test Acc: 0.236
Validation loss decreased (-0.189378 --> -0.236433).  Saving model ...
Epoch: 7 cost time: 0.5408411026000977
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 4.154 Vali Acc: 0.221 Test Loss: 4.154 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.48661231994628906
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 4.456 Vali Acc: 0.232 Test Loss: 4.456 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5556869506835938
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 4.970 Vali Acc: 0.234 Test Loss: 4.970 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4712338447570801
Epoch: 10, Steps: 10 | Train Loss: 0.203 Vali Loss: 4.871 Vali Acc: 0.240 Test Loss: 4.871 Test Acc: 0.240
Validation loss decreased (-0.236433 --> -0.239951).  Saving model ...
Epoch: 11 cost time: 0.49820923805236816
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 5.007 Vali Acc: 0.249 Test Loss: 5.007 Test Acc: 0.249
Validation loss decreased (-0.239951 --> -0.249362).  Saving model ...
Epoch: 12 cost time: 0.47264742851257324
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.290 Vali Acc: 0.245 Test Loss: 5.290 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5384984016418457
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.498 Vali Acc: 0.246 Test Loss: 5.498 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5150198936462402
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.493 Vali Acc: 0.260 Test Loss: 5.493 Test Acc: 0.260
Validation loss decreased (-0.249362 --> -0.259945).  Saving model ...
Epoch: 15 cost time: 0.5161292552947998
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.815 Vali Acc: 0.239 Test Loss: 5.815 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5005011558532715
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.814 Vali Acc: 0.253 Test Loss: 5.814 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5063509941101074
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.963 Vali Acc: 0.261 Test Loss: 5.963 Test Acc: 0.261
Validation loss decreased (-0.259945 --> -0.261117).  Saving model ...
Epoch: 18 cost time: 0.5276880264282227
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.107 Vali Acc: 0.256 Test Loss: 6.107 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5131759643554688
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.150 Vali Acc: 0.256 Test Loss: 6.150 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5240352153778076
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.130 Vali Acc: 0.259 Test Loss: 6.130 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5148534774780273
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.102 Vali Acc: 0.261 Test Loss: 6.102 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5211892127990723
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.085 Vali Acc: 0.265 Test Loss: 6.085 Test Acc: 0.265
Validation loss decreased (-0.261117 --> -0.264645).  Saving model ...
Epoch: 23 cost time: 0.5395078659057617
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.073 Vali Acc: 0.264 Test Loss: 6.073 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5055420398712158
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.269 Test Loss: 6.062 Test Acc: 0.269
Validation loss decreased (-0.264645 --> -0.269351).  Saving model ...
Epoch: 25 cost time: 0.5049059391021729
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.059 Vali Acc: 0.264 Test Loss: 6.059 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.524965763092041
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.053 Vali Acc: 0.267 Test Loss: 6.053 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.49868011474609375
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.050 Vali Acc: 0.267 Test Loss: 6.050 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5285384654998779
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.061 Vali Acc: 0.268 Test Loss: 6.061 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5469202995300293
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.065 Vali Acc: 0.272 Test Loss: 6.065 Test Acc: 0.272
Validation loss decreased (-0.269351 --> -0.271704).  Saving model ...
Epoch: 30 cost time: 0.5180573463439941
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.063 Vali Acc: 0.272 Test Loss: 6.063 Test Acc: 0.272
Validation loss decreased (-0.271704 --> -0.271704).  Saving model ...
Epoch: 31 cost time: 0.5089826583862305
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.071 Vali Acc: 0.272 Test Loss: 6.071 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4802682399749756
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.083 Vali Acc: 0.272 Test Loss: 6.083 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.47766590118408203
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.101 Vali Acc: 0.269 Test Loss: 6.101 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4912576675415039
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.097 Vali Acc: 0.269 Test Loss: 6.097 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.49751782417297363
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.092 Vali Acc: 0.269 Test Loss: 6.092 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.532902717590332
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.094 Vali Acc: 0.271 Test Loss: 6.094 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4871828556060791
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.115 Vali Acc: 0.275 Test Loss: 6.115 Test Acc: 0.275
Validation loss decreased (-0.271704 --> -0.275233).  Saving model ...
Epoch: 38 cost time: 0.5069010257720947
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.126 Vali Acc: 0.276 Test Loss: 6.126 Test Acc: 0.276
Validation loss decreased (-0.275233 --> -0.276409).  Saving model ...
Epoch: 39 cost time: 0.5455348491668701
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.129 Vali Acc: 0.276 Test Loss: 6.129 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.47519969940185547
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.139 Vali Acc: 0.275 Test Loss: 6.139 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5232501029968262
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.147 Vali Acc: 0.274 Test Loss: 6.147 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5332841873168945
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.139 Vali Acc: 0.273 Test Loss: 6.139 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5273566246032715
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.150 Vali Acc: 0.271 Test Loss: 6.150 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5104658603668213
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.154 Vali Acc: 0.272 Test Loss: 6.154 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5538015365600586
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.162 Vali Acc: 0.271 Test Loss: 6.162 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.49188661575317383
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.165 Vali Acc: 0.273 Test Loss: 6.165 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5052738189697266
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.179 Vali Acc: 0.273 Test Loss: 6.179 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5239737033843994
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.176 Vali Acc: 0.269 Test Loss: 6.176 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 925850
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5978078842163086
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.339 Vali Acc: 0.064 Test Loss: 3.339 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 0.47887349128723145
Epoch: 2, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.382 Vali Acc: 0.088 Test Loss: 3.382 Test Acc: 0.088
Validation loss decreased (-0.063496 --> -0.088201).  Saving model ...
Epoch: 3 cost time: 0.4587535858154297
Epoch: 3, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.291 Vali Acc: 0.126 Test Loss: 3.291 Test Acc: 0.126
Validation loss decreased (-0.088201 --> -0.125849).  Saving model ...
Epoch: 4 cost time: 0.4779391288757324
Epoch: 4, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.295 Vali Acc: 0.162 Test Loss: 3.295 Test Acc: 0.162
Validation loss decreased (-0.125849 --> -0.162320).  Saving model ...
Epoch: 5 cost time: 0.489788293838501
Epoch: 5, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.400 Vali Acc: 0.167 Test Loss: 3.400 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167025).  Saving model ...
Epoch: 6 cost time: 0.472886323928833
Epoch: 6, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.397 Vali Acc: 0.219 Test Loss: 3.397 Test Acc: 0.219
Validation loss decreased (-0.167025 --> -0.218790).  Saving model ...
Epoch: 7 cost time: 0.4649474620819092
Epoch: 7, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.654 Vali Acc: 0.207 Test Loss: 3.654 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.48827433586120605
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.685 Vali Acc: 0.222 Test Loss: 3.685 Test Acc: 0.222
Validation loss decreased (-0.218790 --> -0.222316).  Saving model ...
Epoch: 9 cost time: 0.47353696823120117
Epoch: 9, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.902 Vali Acc: 0.227 Test Loss: 3.902 Test Acc: 0.227
Validation loss decreased (-0.222316 --> -0.227020).  Saving model ...
Epoch: 10 cost time: 0.4288055896759033
Epoch: 10, Steps: 10 | Train Loss: 0.224 Vali Loss: 4.029 Vali Acc: 0.247 Test Loss: 4.029 Test Acc: 0.247
Validation loss decreased (-0.227020 --> -0.247019).  Saving model ...
Epoch: 11 cost time: 0.4878354072570801
Epoch: 11, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.229 Vali Acc: 0.234 Test Loss: 4.229 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5007891654968262
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.446 Vali Acc: 0.239 Test Loss: 4.446 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4819455146789551
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.569 Vali Acc: 0.234 Test Loss: 4.569 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5184226036071777
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.693 Vali Acc: 0.241 Test Loss: 4.693 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4683995246887207
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.741 Vali Acc: 0.246 Test Loss: 4.741 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4734466075897217
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.756 Vali Acc: 0.254 Test Loss: 4.756 Test Acc: 0.254
Validation loss decreased (-0.247019 --> -0.254070).  Saving model ...
Epoch: 17 cost time: 0.5208818912506104
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.826 Vali Acc: 0.256 Test Loss: 4.826 Test Acc: 0.256
Validation loss decreased (-0.254070 --> -0.256422).  Saving model ...
Epoch: 18 cost time: 0.5074868202209473
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.901 Vali Acc: 0.261 Test Loss: 4.901 Test Acc: 0.261
Validation loss decreased (-0.256422 --> -0.261127).  Saving model ...
Epoch: 19 cost time: 0.485856294631958
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.934 Vali Acc: 0.265 Test Loss: 4.934 Test Acc: 0.265
Validation loss decreased (-0.261127 --> -0.264657).  Saving model ...
Epoch: 20 cost time: 0.5353143215179443
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.956 Vali Acc: 0.255 Test Loss: 4.956 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4802074432373047
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.006 Vali Acc: 0.255 Test Loss: 5.006 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49419713020324707
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.031 Vali Acc: 0.256 Test Loss: 5.031 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5074295997619629
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.042 Vali Acc: 0.256 Test Loss: 5.042 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4617922306060791
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.061 Vali Acc: 0.259 Test Loss: 5.061 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.49327874183654785
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.092 Vali Acc: 0.258 Test Loss: 5.092 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4970057010650635
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.118 Vali Acc: 0.254 Test Loss: 5.118 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.49269986152648926
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.135 Vali Acc: 0.258 Test Loss: 5.135 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.47826457023620605
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.154 Vali Acc: 0.262 Test Loss: 5.154 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4573366641998291
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.228 Vali Acc: 0.258 Test Loss: 5.228 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 546970
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6152615547180176
Epoch: 1, Steps: 10 | Train Loss: 3.504 Vali Loss: 3.302 Vali Acc: 0.053 Test Loss: 3.302 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.4468650817871094
Epoch: 2, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.324 Vali Acc: 0.080 Test Loss: 3.324 Test Acc: 0.080
Validation loss decreased (-0.052908 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 0.49280786514282227
Epoch: 3, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
Validation loss decreased (-0.079967 --> -0.104673).  Saving model ...
Epoch: 4 cost time: 0.46983957290649414
Epoch: 4, Steps: 10 | Train Loss: 2.353 Vali Loss: 3.263 Vali Acc: 0.140 Test Loss: 3.263 Test Acc: 0.140
Validation loss decreased (-0.104673 --> -0.139967).  Saving model ...
Epoch: 5 cost time: 0.49370622634887695
Epoch: 5, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.225 Vali Acc: 0.156 Test Loss: 3.225 Test Acc: 0.156
Validation loss decreased (-0.139967 --> -0.156438).  Saving model ...
Epoch: 6 cost time: 0.39715147018432617
Epoch: 6, Steps: 10 | Train Loss: 1.470 Vali Loss: 3.266 Vali Acc: 0.184 Test Loss: 3.266 Test Acc: 0.184
Validation loss decreased (-0.156438 --> -0.183497).  Saving model ...
Epoch: 7 cost time: 0.48575568199157715
Epoch: 7, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.344 Vali Acc: 0.208 Test Loss: 3.344 Test Acc: 0.208
Validation loss decreased (-0.183497 --> -0.208202).  Saving model ...
Epoch: 8 cost time: 0.4726142883300781
Epoch: 8, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.460 Vali Acc: 0.211 Test Loss: 3.460 Test Acc: 0.211
Validation loss decreased (-0.208202 --> -0.210554).  Saving model ...
Epoch: 9 cost time: 0.47760820388793945
Epoch: 9, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.550 Vali Acc: 0.228 Test Loss: 3.550 Test Acc: 0.228
Validation loss decreased (-0.210554 --> -0.228200).  Saving model ...
Epoch: 10 cost time: 0.46790075302124023
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.637 Vali Acc: 0.239 Test Loss: 3.637 Test Acc: 0.239
Validation loss decreased (-0.228200 --> -0.238787).  Saving model ...
Epoch: 11 cost time: 0.5010585784912109
Epoch: 11, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.812 Vali Acc: 0.233 Test Loss: 3.812 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4750230312347412
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.894 Vali Acc: 0.236 Test Loss: 3.894 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.48288846015930176
Epoch: 13, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.994 Vali Acc: 0.251 Test Loss: 3.994 Test Acc: 0.251
Validation loss decreased (-0.238787 --> -0.250548).  Saving model ...
Epoch: 14 cost time: 0.48766112327575684
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.170 Vali Acc: 0.238 Test Loss: 4.170 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.447859525680542
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.295 Vali Acc: 0.246 Test Loss: 4.295 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.46077704429626465
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.296 Vali Acc: 0.260 Test Loss: 4.296 Test Acc: 0.260
Validation loss decreased (-0.250548 --> -0.259957).  Saving model ...
Epoch: 17 cost time: 0.46773552894592285
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.441 Vali Acc: 0.253 Test Loss: 4.441 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46373653411865234
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.520 Vali Acc: 0.262 Test Loss: 4.520 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262308).  Saving model ...
Epoch: 19 cost time: 0.4730875492095947
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.610 Vali Acc: 0.256 Test Loss: 4.610 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4437596797943115
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.590 Vali Acc: 0.266 Test Loss: 4.590 Test Acc: 0.266
Validation loss decreased (-0.262308 --> -0.265836).  Saving model ...
Epoch: 21 cost time: 0.47432827949523926
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.619 Vali Acc: 0.265 Test Loss: 4.619 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.48509883880615234
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.687 Vali Acc: 0.261 Test Loss: 4.687 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45105957984924316
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.681 Vali Acc: 0.260 Test Loss: 4.681 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4817357063293457
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.683 Vali Acc: 0.261 Test Loss: 4.683 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.47554779052734375
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.709 Vali Acc: 0.264 Test Loss: 4.709 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.55124831199646
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.731 Vali Acc: 0.264 Test Loss: 4.731 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4499986171722412
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.755 Vali Acc: 0.266 Test Loss: 4.755 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.48789358139038086
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.773 Vali Acc: 0.260 Test Loss: 4.773 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5069575309753418
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.802 Vali Acc: 0.259 Test Loss: 4.802 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5056769847869873
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.833 Vali Acc: 0.259 Test Loss: 4.833 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 417690
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5716452598571777
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.327 Vali Acc: 0.034 Test Loss: 3.327 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4622969627380371
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (-0.034084 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.45504307746887207
Epoch: 3, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.294 Vali Acc: 0.093 Test Loss: 3.294 Test Acc: 0.093
Validation loss decreased (-0.044673 --> -0.092908).  Saving model ...
Epoch: 4 cost time: 0.43062281608581543
Epoch: 4, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.291 Vali Acc: 0.096 Test Loss: 3.291 Test Acc: 0.096
Validation loss decreased (-0.092908 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.4617002010345459
Epoch: 5, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.230 Vali Acc: 0.124 Test Loss: 3.230 Test Acc: 0.124
Validation loss decreased (-0.096438 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.4860858917236328
Epoch: 6, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.201 Vali Acc: 0.162 Test Loss: 3.201 Test Acc: 0.162
Validation loss decreased (-0.123497 --> -0.162321).  Saving model ...
Epoch: 7 cost time: 0.4632408618927002
Epoch: 7, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.264 Vali Acc: 0.185 Test Loss: 3.264 Test Acc: 0.185
Validation loss decreased (-0.162321 --> -0.184673).  Saving model ...
Epoch: 8 cost time: 0.4703843593597412
Epoch: 8, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.331 Vali Acc: 0.209 Test Loss: 3.331 Test Acc: 0.209
Validation loss decreased (-0.184673 --> -0.209378).  Saving model ...
Epoch: 9 cost time: 0.44086527824401855
Epoch: 9, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.417 Vali Acc: 0.212 Test Loss: 3.417 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211731).  Saving model ...
Epoch: 10 cost time: 0.5846290588378906
Epoch: 10, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.482 Vali Acc: 0.227 Test Loss: 3.482 Test Acc: 0.227
Validation loss decreased (-0.211731 --> -0.227024).  Saving model ...
Epoch: 11 cost time: 0.4821755886077881
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.565 Vali Acc: 0.231 Test Loss: 3.565 Test Acc: 0.231
Validation loss decreased (-0.227024 --> -0.230553).  Saving model ...
Epoch: 12 cost time: 0.49512434005737305
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.696 Vali Acc: 0.228 Test Loss: 3.696 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47747254371643066
Epoch: 13, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.836 Vali Acc: 0.239 Test Loss: 3.836 Test Acc: 0.239
Validation loss decreased (-0.230553 --> -0.238785).  Saving model ...
Epoch: 14 cost time: 0.48114776611328125
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.949 Vali Acc: 0.232 Test Loss: 3.949 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5071883201599121
Epoch: 15, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.078 Vali Acc: 0.238 Test Loss: 4.078 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4744729995727539
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.196 Vali Acc: 0.236 Test Loss: 4.196 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4830820560455322
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.271 Vali Acc: 0.241 Test Loss: 4.271 Test Acc: 0.241
Validation loss decreased (-0.238785 --> -0.241134).  Saving model ...
Epoch: 18 cost time: 0.4572160243988037
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.310 Vali Acc: 0.244 Test Loss: 4.310 Test Acc: 0.244
Validation loss decreased (-0.241134 --> -0.243486).  Saving model ...
Epoch: 19 cost time: 0.4783177375793457
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.379 Vali Acc: 0.245 Test Loss: 4.379 Test Acc: 0.245
Validation loss decreased (-0.243486 --> -0.244662).  Saving model ...
Epoch: 20 cost time: 0.523881196975708
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.415 Vali Acc: 0.246 Test Loss: 4.415 Test Acc: 0.246
Validation loss decreased (-0.244662 --> -0.245838).  Saving model ...
Epoch: 21 cost time: 0.5513935089111328
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.455 Vali Acc: 0.246 Test Loss: 4.455 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46300363540649414
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.532 Vali Acc: 0.235 Test Loss: 4.532 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4478590488433838
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.567 Vali Acc: 0.242 Test Loss: 4.567 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4770195484161377
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.582 Vali Acc: 0.249 Test Loss: 4.582 Test Acc: 0.249
Validation loss decreased (-0.245838 --> -0.249366).  Saving model ...
Epoch: 25 cost time: 0.4865384101867676
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.623 Vali Acc: 0.245 Test Loss: 4.623 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.45855045318603516
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.657 Vali Acc: 0.241 Test Loss: 4.657 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.47451233863830566
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.688 Vali Acc: 0.244 Test Loss: 4.688 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.46012449264526367
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.718 Vali Acc: 0.245 Test Loss: 4.718 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4325683116912842
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.735 Vali Acc: 0.249 Test Loss: 4.735 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.46640706062316895
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.751 Vali Acc: 0.246 Test Loss: 4.751 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.46032238006591797
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.754 Vali Acc: 0.247 Test Loss: 4.754 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.41111207008361816
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.766 Vali Acc: 0.248 Test Loss: 4.766 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.48569345474243164
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.790 Vali Acc: 0.242 Test Loss: 4.790 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4631814956665039
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.826 Vali Acc: 0.246 Test Loss: 4.826 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 358298
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.680652141571045
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.329 Vali Acc: 0.047 Test Loss: 3.329 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.4680521488189697
Epoch: 2, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.296 Vali Acc: 0.062 Test Loss: 3.296 Test Acc: 0.062
Validation loss decreased (-0.047026 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.47345781326293945
Epoch: 3, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.292 Vali Acc: 0.092 Test Loss: 3.292 Test Acc: 0.092
Validation loss decreased (-0.062320 --> -0.091732).  Saving model ...
Epoch: 4 cost time: 0.4840092658996582
Epoch: 4, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.283 Vali Acc: 0.114 Test Loss: 3.283 Test Acc: 0.114
Validation loss decreased (-0.091732 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.439558744430542
Epoch: 5, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.269 Vali Acc: 0.132 Test Loss: 3.269 Test Acc: 0.132
Validation loss decreased (-0.114085 --> -0.131732).  Saving model ...
Epoch: 6 cost time: 0.42653918266296387
Epoch: 6, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.250 Vali Acc: 0.148 Test Loss: 3.250 Test Acc: 0.148
Validation loss decreased (-0.131732 --> -0.148203).  Saving model ...
Epoch: 7 cost time: 0.46515417098999023
Epoch: 7, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.251 Vali Acc: 0.159 Test Loss: 3.251 Test Acc: 0.159
Validation loss decreased (-0.148203 --> -0.158791).  Saving model ...
Epoch: 8 cost time: 0.4451146125793457
Epoch: 8, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.264 Vali Acc: 0.171 Test Loss: 3.264 Test Acc: 0.171
Validation loss decreased (-0.158791 --> -0.170556).  Saving model ...
Epoch: 9 cost time: 0.476456880569458
Epoch: 9, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.294 Vali Acc: 0.193 Test Loss: 3.294 Test Acc: 0.193
Validation loss decreased (-0.170556 --> -0.192908).  Saving model ...
Epoch: 10 cost time: 0.46499109268188477
Epoch: 10, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.367 Vali Acc: 0.202 Test Loss: 3.367 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202319).  Saving model ...
Epoch: 11 cost time: 0.48784780502319336
Epoch: 11, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.424 Vali Acc: 0.219 Test Loss: 3.424 Test Acc: 0.219
Validation loss decreased (-0.202319 --> -0.218789).  Saving model ...
Epoch: 12 cost time: 0.485628604888916
Epoch: 12, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.506 Vali Acc: 0.221 Test Loss: 3.506 Test Acc: 0.221
Validation loss decreased (-0.218789 --> -0.221141).  Saving model ...
Epoch: 13 cost time: 0.4579615592956543
Epoch: 13, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.602 Vali Acc: 0.225 Test Loss: 3.602 Test Acc: 0.225
Validation loss decreased (-0.221141 --> -0.224670).  Saving model ...
Epoch: 14 cost time: 0.49301576614379883
Epoch: 14, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.649 Vali Acc: 0.219 Test Loss: 3.649 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.44333767890930176
Epoch: 15, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.732 Vali Acc: 0.233 Test Loss: 3.732 Test Acc: 0.233
Validation loss decreased (-0.224670 --> -0.232904).  Saving model ...
Epoch: 16 cost time: 0.4697122573852539
Epoch: 16, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.821 Vali Acc: 0.235 Test Loss: 3.821 Test Acc: 0.235
Validation loss decreased (-0.232904 --> -0.235256).  Saving model ...
Epoch: 17 cost time: 0.45224428176879883
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.878 Vali Acc: 0.248 Test Loss: 3.878 Test Acc: 0.248
Validation loss decreased (-0.235256 --> -0.248197).  Saving model ...
Epoch: 18 cost time: 0.4143815040588379
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.993 Vali Acc: 0.240 Test Loss: 3.993 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46503400802612305
Epoch: 19, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.046 Vali Acc: 0.244 Test Loss: 4.046 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5085673332214355
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.091 Vali Acc: 0.246 Test Loss: 4.091 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4853219985961914
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.160 Vali Acc: 0.251 Test Loss: 4.160 Test Acc: 0.251
Validation loss decreased (-0.248197 --> -0.250547).  Saving model ...
Epoch: 22 cost time: 0.4344489574432373
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.231 Vali Acc: 0.249 Test Loss: 4.231 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.45111846923828125
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.212 Vali Acc: 0.262 Test Loss: 4.212 Test Acc: 0.262
Validation loss decreased (-0.250547 --> -0.262311).  Saving model ...
Epoch: 24 cost time: 0.48543691635131836
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.207 Vali Acc: 0.266 Test Loss: 4.207 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265840).  Saving model ...
Epoch: 25 cost time: 0.4705801010131836
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.239 Vali Acc: 0.267 Test Loss: 4.239 Test Acc: 0.267
Validation loss decreased (-0.265840 --> -0.267016).  Saving model ...
Epoch: 26 cost time: 0.4590013027191162
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.277 Vali Acc: 0.266 Test Loss: 4.277 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4782431125640869
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.305 Vali Acc: 0.262 Test Loss: 4.305 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.47043919563293457
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.325 Vali Acc: 0.264 Test Loss: 4.325 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4659848213195801
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.349 Vali Acc: 0.264 Test Loss: 4.349 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5182640552520752
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.376 Vali Acc: 0.266 Test Loss: 4.376 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.43059873580932617
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.405 Vali Acc: 0.267 Test Loss: 4.405 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.45770788192749023
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.410 Vali Acc: 0.267 Test Loss: 4.410 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4172632694244385
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.423 Vali Acc: 0.274 Test Loss: 4.423 Test Acc: 0.274
Validation loss decreased (-0.267016 --> -0.274073).  Saving model ...
Epoch: 34 cost time: 0.471651554107666
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.464 Vali Acc: 0.272 Test Loss: 4.464 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4998326301574707
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.483 Vali Acc: 0.278 Test Loss: 4.483 Test Acc: 0.278
Validation loss decreased (-0.274073 --> -0.277602).  Saving model ...
Epoch: 36 cost time: 0.44211435317993164
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.499 Vali Acc: 0.281 Test Loss: 4.499 Test Acc: 0.281
Validation loss decreased (-0.277602 --> -0.281131).  Saving model ...
Epoch: 37 cost time: 0.4298837184906006
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.507 Vali Acc: 0.281 Test Loss: 4.507 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.46300697326660156
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.519 Vali Acc: 0.278 Test Loss: 4.519 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.49458956718444824
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.534 Vali Acc: 0.272 Test Loss: 4.534 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4513511657714844
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.545 Vali Acc: 0.271 Test Loss: 4.545 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.44641566276550293
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.555 Vali Acc: 0.275 Test Loss: 4.555 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.42038822174072266
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.554 Vali Acc: 0.275 Test Loss: 4.554 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.47644662857055664
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.563 Vali Acc: 0.275 Test Loss: 4.563 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.49012231826782227
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.564 Vali Acc: 0.279 Test Loss: 4.564 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4392385482788086
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.582 Vali Acc: 0.279 Test Loss: 4.582 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4453134536743164
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.642 Vali Acc: 0.266 Test Loss: 4.642 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 289306
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3272712230682373
Epoch: 1, Steps: 10 | Train Loss: 3.458 Vali Loss: 3.328 Vali Acc: 0.055 Test Loss: 3.328 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.4430577754974365
Epoch: 2, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.278 Vali Acc: 0.061 Test Loss: 3.278 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.4181194305419922
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.256 Vali Acc: 0.069 Test Loss: 3.256 Test Acc: 0.069
Validation loss decreased (-0.061144 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 0.44672322273254395
Epoch: 4, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.262 Vali Acc: 0.076 Test Loss: 3.262 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.4355809688568115
Epoch: 5, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.259 Vali Acc: 0.100 Test Loss: 3.259 Test Acc: 0.100
Validation loss decreased (-0.076438 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.5005683898925781
Epoch: 6, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.242 Vali Acc: 0.132 Test Loss: 3.242 Test Acc: 0.132
Validation loss decreased (-0.099967 --> -0.131732).  Saving model ...
Epoch: 7 cost time: 0.4597809314727783
Epoch: 7, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.240 Vali Acc: 0.140 Test Loss: 3.240 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.488461971282959
Epoch: 8, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.239 Vali Acc: 0.156 Test Loss: 3.239 Test Acc: 0.156
Validation loss decreased (-0.139968 --> -0.156438).  Saving model ...
Epoch: 9 cost time: 0.4742012023925781
Epoch: 9, Steps: 10 | Train Loss: 1.520 Vali Loss: 3.250 Vali Acc: 0.178 Test Loss: 3.250 Test Acc: 0.178
Validation loss decreased (-0.156438 --> -0.177615).  Saving model ...
Epoch: 10 cost time: 0.4369828701019287
Epoch: 10, Steps: 10 | Train Loss: 1.315 Vali Loss: 3.299 Vali Acc: 0.180 Test Loss: 3.299 Test Acc: 0.180
Validation loss decreased (-0.177615 --> -0.179967).  Saving model ...
Epoch: 11 cost time: 0.444598913192749
Epoch: 11, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.356 Vali Acc: 0.189 Test Loss: 3.356 Test Acc: 0.189
Validation loss decreased (-0.179967 --> -0.189378).  Saving model ...
Epoch: 12 cost time: 0.4141275882720947
Epoch: 12, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.401 Vali Acc: 0.208 Test Loss: 3.401 Test Acc: 0.208
Validation loss decreased (-0.189378 --> -0.208201).  Saving model ...
Epoch: 13 cost time: 0.45107603073120117
Epoch: 13, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.472 Vali Acc: 0.211 Test Loss: 3.472 Test Acc: 0.211
Validation loss decreased (-0.208201 --> -0.210554).  Saving model ...
Epoch: 14 cost time: 0.42979001998901367
Epoch: 14, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.537 Vali Acc: 0.222 Test Loss: 3.537 Test Acc: 0.222
Validation loss decreased (-0.210554 --> -0.222318).  Saving model ...
Epoch: 15 cost time: 0.4471924304962158
Epoch: 15, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.616 Vali Acc: 0.228 Test Loss: 3.616 Test Acc: 0.228
Validation loss decreased (-0.222318 --> -0.228199).  Saving model ...
Epoch: 16 cost time: 0.46079587936401367
Epoch: 16, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.678 Vali Acc: 0.244 Test Loss: 3.678 Test Acc: 0.244
Validation loss decreased (-0.228199 --> -0.243493).  Saving model ...
Epoch: 17 cost time: 0.4424326419830322
Epoch: 17, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.784 Vali Acc: 0.241 Test Loss: 3.784 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46990489959716797
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.860 Vali Acc: 0.233 Test Loss: 3.860 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.46560239791870117
Epoch: 19, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.944 Vali Acc: 0.238 Test Loss: 3.944 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4961111545562744
Epoch: 20, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.982 Vali Acc: 0.238 Test Loss: 3.982 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.46309947967529297
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.033 Vali Acc: 0.251 Test Loss: 4.033 Test Acc: 0.251
Validation loss decreased (-0.243493 --> -0.250548).  Saving model ...
Epoch: 22 cost time: 0.45844531059265137
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.076 Vali Acc: 0.248 Test Loss: 4.076 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.46002745628356934
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.148 Vali Acc: 0.248 Test Loss: 4.148 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4953315258026123
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.176 Vali Acc: 0.252 Test Loss: 4.176 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251723).  Saving model ...
Epoch: 25 cost time: 0.44104814529418945
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.184 Vali Acc: 0.255 Test Loss: 4.184 Test Acc: 0.255
Validation loss decreased (-0.251723 --> -0.255252).  Saving model ...
Epoch: 26 cost time: 0.43570756912231445
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.209 Vali Acc: 0.254 Test Loss: 4.209 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.46466064453125
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.247 Vali Acc: 0.256 Test Loss: 4.247 Test Acc: 0.256
Validation loss decreased (-0.255252 --> -0.256428).  Saving model ...
Epoch: 28 cost time: 0.3949143886566162
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.258 Vali Acc: 0.262 Test Loss: 4.258 Test Acc: 0.262
Validation loss decreased (-0.256428 --> -0.262310).  Saving model ...
Epoch: 29 cost time: 0.41961097717285156
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.281 Vali Acc: 0.264 Test Loss: 4.281 Test Acc: 0.264
Validation loss decreased (-0.262310 --> -0.263487).  Saving model ...
Epoch: 30 cost time: 0.4674990177154541
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.321 Vali Acc: 0.256 Test Loss: 4.321 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.474376916885376
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.349 Vali Acc: 0.256 Test Loss: 4.349 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.46751904487609863
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.366 Vali Acc: 0.256 Test Loss: 4.366 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.46836256980895996
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.385 Vali Acc: 0.254 Test Loss: 4.385 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.45166587829589844
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.410 Vali Acc: 0.253 Test Loss: 4.410 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.47149658203125
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.423 Vali Acc: 0.258 Test Loss: 4.423 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.46862053871154785
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.433 Vali Acc: 0.264 Test Loss: 4.433 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.43768787384033203
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.449 Vali Acc: 0.260 Test Loss: 4.449 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.49549388885498047
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.483 Vali Acc: 0.256 Test Loss: 4.483 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.48003363609313965
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.495 Vali Acc: 0.262 Test Loss: 4.495 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 260378
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.622802734375
Epoch: 1, Steps: 10 | Train Loss: 3.472 Vali Loss: 3.349 Vali Acc: 0.036 Test Loss: 3.349 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.41628289222717285
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.323 Vali Acc: 0.053 Test Loss: 3.323 Test Acc: 0.053
Validation loss decreased (-0.036437 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.5012531280517578
Epoch: 3, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.306 Vali Acc: 0.074 Test Loss: 3.306 Test Acc: 0.074
Validation loss decreased (-0.052908 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.4651176929473877
Epoch: 4, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.307 Vali Acc: 0.098 Test Loss: 3.307 Test Acc: 0.098
Validation loss decreased (-0.074085 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 0.48497605323791504
Epoch: 5, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.309 Vali Acc: 0.109 Test Loss: 3.309 Test Acc: 0.109
Validation loss decreased (-0.097614 --> -0.109379).  Saving model ...
Epoch: 6 cost time: 0.4563424587249756
Epoch: 6, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.310 Vali Acc: 0.119 Test Loss: 3.310 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118790).  Saving model ...
Epoch: 7 cost time: 0.4737269878387451
Epoch: 7, Steps: 10 | Train Loss: 2.072 Vali Loss: 3.291 Vali Acc: 0.140 Test Loss: 3.291 Test Acc: 0.140
Validation loss decreased (-0.118790 --> -0.139967).  Saving model ...
Epoch: 8 cost time: 0.443037748336792
Epoch: 8, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.295 Vali Acc: 0.165 Test Loss: 3.295 Test Acc: 0.165
Validation loss decreased (-0.139967 --> -0.164673).  Saving model ...
Epoch: 9 cost time: 0.48415446281433105
Epoch: 9, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.306 Vali Acc: 0.166 Test Loss: 3.306 Test Acc: 0.166
Validation loss decreased (-0.164673 --> -0.165849).  Saving model ...
Epoch: 10 cost time: 0.4492220878601074
Epoch: 10, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.326 Vali Acc: 0.178 Test Loss: 3.326 Test Acc: 0.178
Validation loss decreased (-0.165849 --> -0.177614).  Saving model ...
Epoch: 11 cost time: 0.44750356674194336
Epoch: 11, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.365 Vali Acc: 0.188 Test Loss: 3.365 Test Acc: 0.188
Validation loss decreased (-0.177614 --> -0.188202).  Saving model ...
Epoch: 12 cost time: 0.508084774017334
Epoch: 12, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.400 Vali Acc: 0.194 Test Loss: 3.400 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 13 cost time: 0.4730517864227295
Epoch: 13, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.434 Vali Acc: 0.201 Test Loss: 3.434 Test Acc: 0.201
Validation loss decreased (-0.194084 --> -0.201142).  Saving model ...
Epoch: 14 cost time: 0.4657459259033203
Epoch: 14, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.469 Vali Acc: 0.218 Test Loss: 3.469 Test Acc: 0.218
Validation loss decreased (-0.201142 --> -0.217612).  Saving model ...
Epoch: 15 cost time: 0.48990583419799805
Epoch: 15, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.520 Vali Acc: 0.229 Test Loss: 3.520 Test Acc: 0.229
Validation loss decreased (-0.217612 --> -0.229377).  Saving model ...
Epoch: 16 cost time: 0.5225791931152344
Epoch: 16, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.566 Vali Acc: 0.238 Test Loss: 3.566 Test Acc: 0.238
Validation loss decreased (-0.229377 --> -0.237611).  Saving model ...
Epoch: 17 cost time: 0.49477291107177734
Epoch: 17, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.638 Vali Acc: 0.233 Test Loss: 3.638 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5101051330566406
Epoch: 18, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.686 Vali Acc: 0.241 Test Loss: 3.686 Test Acc: 0.241
Validation loss decreased (-0.237611 --> -0.241140).  Saving model ...
Epoch: 19 cost time: 0.4754784107208252
Epoch: 19, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.739 Vali Acc: 0.241 Test Loss: 3.739 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4660072326660156
Epoch: 20, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.832 Vali Acc: 0.249 Test Loss: 3.832 Test Acc: 0.249
Validation loss decreased (-0.241140 --> -0.249373).  Saving model ...
Epoch: 21 cost time: 0.48871302604675293
Epoch: 21, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.881 Vali Acc: 0.258 Test Loss: 3.881 Test Acc: 0.258
Validation loss decreased (-0.249373 --> -0.257608).  Saving model ...
Epoch: 22 cost time: 0.5078890323638916
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.917 Vali Acc: 0.251 Test Loss: 3.917 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.504936695098877
Epoch: 23, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.945 Vali Acc: 0.249 Test Loss: 3.945 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.49088454246520996
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.972 Vali Acc: 0.253 Test Loss: 3.972 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4443807601928711
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.005 Vali Acc: 0.258 Test Loss: 4.005 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.45795464515686035
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.061 Vali Acc: 0.253 Test Loss: 4.061 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.48044419288635254
Epoch: 27, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.067 Vali Acc: 0.259 Test Loss: 4.067 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258783).  Saving model ...
Epoch: 28 cost time: 0.4822976589202881
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.096 Vali Acc: 0.261 Test Loss: 4.096 Test Acc: 0.261
Validation loss decreased (-0.258783 --> -0.261136).  Saving model ...
Epoch: 29 cost time: 0.47481870651245117
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.125 Vali Acc: 0.261 Test Loss: 4.125 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.44211435317993164
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.133 Vali Acc: 0.259 Test Loss: 4.133 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4871511459350586
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.148 Vali Acc: 0.262 Test Loss: 4.148 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262311).  Saving model ...
Epoch: 32 cost time: 0.4844474792480469
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.184 Vali Acc: 0.265 Test Loss: 4.184 Test Acc: 0.265
Validation loss decreased (-0.262311 --> -0.264664).  Saving model ...
Epoch: 33 cost time: 0.4559473991394043
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.196 Vali Acc: 0.271 Test Loss: 4.196 Test Acc: 0.271
Validation loss decreased (-0.264664 --> -0.270546).  Saving model ...
Epoch: 34 cost time: 0.45526671409606934
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.195 Vali Acc: 0.274 Test Loss: 4.195 Test Acc: 0.274
Validation loss decreased (-0.270546 --> -0.274076).  Saving model ...
Epoch: 35 cost time: 0.47391700744628906
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.226 Vali Acc: 0.266 Test Loss: 4.226 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47503161430358887
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.262 Vali Acc: 0.260 Test Loss: 4.262 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.49477577209472656
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.285 Vali Acc: 0.261 Test Loss: 4.285 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.470625638961792
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.314 Vali Acc: 0.261 Test Loss: 4.314 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.49587464332580566
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.334 Vali Acc: 0.262 Test Loss: 4.334 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.48776698112487793
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.347 Vali Acc: 0.261 Test Loss: 4.347 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4957730770111084
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.352 Vali Acc: 0.267 Test Loss: 4.352 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4713571071624756
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.370 Vali Acc: 0.266 Test Loss: 4.370 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4884474277496338
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.366 Vali Acc: 0.266 Test Loss: 4.366 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.49625134468078613
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.384 Vali Acc: 0.267 Test Loss: 4.384 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm128_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 251290
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4797453880310059
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.352 Vali Acc: 0.035 Test Loss: 3.352 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5120518207550049
Epoch: 2, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.425 Vali Acc: 0.065 Test Loss: 3.425 Test Acc: 0.065
Validation loss decreased (-0.035261 --> -0.064672).  Saving model ...
Epoch: 3 cost time: 0.5369555950164795
Epoch: 3, Steps: 10 | Train Loss: 2.643 Vali Loss: 3.332 Vali Acc: 0.112 Test Loss: 3.332 Test Acc: 0.112
Validation loss decreased (-0.064672 --> -0.111731).  Saving model ...
Epoch: 4 cost time: 0.5434832572937012
Epoch: 4, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.236 Vali Acc: 0.146 Test Loss: 3.236 Test Acc: 0.146
Validation loss decreased (-0.111731 --> -0.145850).  Saving model ...
Epoch: 5 cost time: 0.5023865699768066
Epoch: 5, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.329 Vali Acc: 0.164 Test Loss: 3.329 Test Acc: 0.164
Validation loss decreased (-0.145850 --> -0.163496).  Saving model ...
Epoch: 6 cost time: 0.520949125289917
Epoch: 6, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.421 Vali Acc: 0.192 Test Loss: 3.421 Test Acc: 0.192
Validation loss decreased (-0.163496 --> -0.191730).  Saving model ...
Epoch: 7 cost time: 0.5327699184417725
Epoch: 7, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.575 Vali Acc: 0.216 Test Loss: 3.575 Test Acc: 0.216
Validation loss decreased (-0.191730 --> -0.216435).  Saving model ...
Epoch: 8 cost time: 0.516270637512207
Epoch: 8, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.703 Vali Acc: 0.211 Test Loss: 3.703 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5352985858917236
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.901 Vali Acc: 0.227 Test Loss: 3.901 Test Acc: 0.227
Validation loss decreased (-0.216435 --> -0.227020).  Saving model ...
Epoch: 10 cost time: 0.5240490436553955
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.037 Vali Acc: 0.240 Test Loss: 4.037 Test Acc: 0.240
Validation loss decreased (-0.227020 --> -0.239960).  Saving model ...
Epoch: 11 cost time: 0.5366673469543457
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.171 Vali Acc: 0.246 Test Loss: 4.171 Test Acc: 0.246
Validation loss decreased (-0.239960 --> -0.245841).  Saving model ...
Epoch: 12 cost time: 0.5418927669525146
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.435 Vali Acc: 0.247 Test Loss: 4.435 Test Acc: 0.247
Validation loss decreased (-0.245841 --> -0.247014).  Saving model ...
Epoch: 13 cost time: 0.5561835765838623
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.526 Vali Acc: 0.260 Test Loss: 4.526 Test Acc: 0.260
Validation loss decreased (-0.247014 --> -0.259955).  Saving model ...
Epoch: 14 cost time: 0.5522031784057617
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.614 Vali Acc: 0.262 Test Loss: 4.614 Test Acc: 0.262
Validation loss decreased (-0.259955 --> -0.262307).  Saving model ...
Epoch: 15 cost time: 0.5356249809265137
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.659 Vali Acc: 0.267 Test Loss: 4.659 Test Acc: 0.267
Validation loss decreased (-0.262307 --> -0.267012).  Saving model ...
Epoch: 16 cost time: 0.5104930400848389
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.699 Vali Acc: 0.272 Test Loss: 4.699 Test Acc: 0.272
Validation loss decreased (-0.267012 --> -0.271718).  Saving model ...
Epoch: 17 cost time: 0.5182681083679199
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.721 Vali Acc: 0.271 Test Loss: 4.721 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5855951309204102
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.766 Vali Acc: 0.269 Test Loss: 4.766 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5349681377410889
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.806 Vali Acc: 0.271 Test Loss: 4.806 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5390751361846924
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.843 Vali Acc: 0.273 Test Loss: 4.843 Test Acc: 0.273
Validation loss decreased (-0.271718 --> -0.272893).  Saving model ...
Epoch: 21 cost time: 0.5155360698699951
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.849 Vali Acc: 0.272 Test Loss: 4.849 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5134518146514893
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.864 Vali Acc: 0.269 Test Loss: 4.864 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5326881408691406
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.877 Vali Acc: 0.268 Test Loss: 4.877 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5086181163787842
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.910 Vali Acc: 0.273 Test Loss: 4.910 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5295858383178711
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.940 Vali Acc: 0.271 Test Loss: 4.940 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5850515365600586
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.968 Vali Acc: 0.267 Test Loss: 4.968 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5133280754089355
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.988 Vali Acc: 0.266 Test Loss: 4.988 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4931676387786865
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.264 Test Loss: 5.012 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5202467441558838
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.268 Test Loss: 5.012 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5383360385894775
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.041 Vali Acc: 0.271 Test Loss: 5.041 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 479770
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.520449161529541
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.354 Vali Acc: 0.055 Test Loss: 3.354 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.48758745193481445
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.371 Vali Acc: 0.069 Test Loss: 3.371 Test Acc: 0.069
Validation loss decreased (-0.055261 --> -0.069378).  Saving model ...
Epoch: 3 cost time: 0.4987971782684326
Epoch: 3, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.369 Vali Acc: 0.087 Test Loss: 3.369 Test Acc: 0.087
Validation loss decreased (-0.069378 --> -0.087025).  Saving model ...
Epoch: 4 cost time: 0.47310304641723633
Epoch: 4, Steps: 10 | Train Loss: 2.534 Vali Loss: 3.305 Vali Acc: 0.126 Test Loss: 3.305 Test Acc: 0.126
Validation loss decreased (-0.087025 --> -0.125849).  Saving model ...
Epoch: 5 cost time: 0.4226701259613037
Epoch: 5, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.285 Vali Acc: 0.140 Test Loss: 3.285 Test Acc: 0.140
Validation loss decreased (-0.125849 --> -0.139967).  Saving model ...
Epoch: 6 cost time: 0.4687047004699707
Epoch: 6, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.261 Vali Acc: 0.172 Test Loss: 3.261 Test Acc: 0.172
Validation loss decreased (-0.139967 --> -0.171732).  Saving model ...
Epoch: 7 cost time: 0.5065560340881348
Epoch: 7, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.319 Vali Acc: 0.164 Test Loss: 3.319 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4570786952972412
Epoch: 8, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.364 Vali Acc: 0.208 Test Loss: 3.364 Test Acc: 0.208
Validation loss decreased (-0.171732 --> -0.208202).  Saving model ...
Epoch: 9 cost time: 0.4917488098144531
Epoch: 9, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.436 Vali Acc: 0.219 Test Loss: 3.436 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218789).  Saving model ...
Epoch: 10 cost time: 0.4151453971862793
Epoch: 10, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.509 Vali Acc: 0.227 Test Loss: 3.509 Test Acc: 0.227
Validation loss decreased (-0.218789 --> -0.227024).  Saving model ...
Epoch: 11 cost time: 0.4795267581939697
Epoch: 11, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.586 Vali Acc: 0.239 Test Loss: 3.586 Test Acc: 0.239
Validation loss decreased (-0.227024 --> -0.238788).  Saving model ...
Epoch: 12 cost time: 0.4582960605621338
Epoch: 12, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.723 Vali Acc: 0.235 Test Loss: 3.723 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.44614458084106445
Epoch: 13, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.808 Vali Acc: 0.244 Test Loss: 3.808 Test Acc: 0.244
Validation loss decreased (-0.238788 --> -0.243491).  Saving model ...
Epoch: 14 cost time: 0.45542287826538086
Epoch: 14, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.947 Vali Acc: 0.236 Test Loss: 3.947 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4645240306854248
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.023 Vali Acc: 0.251 Test Loss: 4.023 Test Acc: 0.251
Validation loss decreased (-0.243491 --> -0.250548).  Saving model ...
Epoch: 16 cost time: 0.46480607986450195
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.136 Vali Acc: 0.240 Test Loss: 4.136 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5004031658172607
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.124 Vali Acc: 0.265 Test Loss: 4.124 Test Acc: 0.265
Validation loss decreased (-0.250548 --> -0.264665).  Saving model ...
Epoch: 18 cost time: 0.4826517105102539
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.223 Vali Acc: 0.258 Test Loss: 4.223 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4529440402984619
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.306 Vali Acc: 0.254 Test Loss: 4.306 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4343740940093994
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.318 Vali Acc: 0.251 Test Loss: 4.318 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.44830894470214844
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.327 Vali Acc: 0.248 Test Loss: 4.327 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.44225430488586426
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.358 Vali Acc: 0.253 Test Loss: 4.358 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.490680456161499
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.397 Vali Acc: 0.252 Test Loss: 4.397 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5093860626220703
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.436 Vali Acc: 0.253 Test Loss: 4.436 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4519534111022949
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.455 Vali Acc: 0.256 Test Loss: 4.455 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4763765335083008
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.488 Vali Acc: 0.256 Test Loss: 4.488 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4580070972442627
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.521 Vali Acc: 0.259 Test Loss: 4.521 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 290330
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4996042251586914
Epoch: 1, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.386 Vali Acc: 0.024 Test Loss: 3.386 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.5170884132385254
Epoch: 2, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.375 Vali Acc: 0.035 Test Loss: 3.375 Test Acc: 0.035
Validation loss decreased (-0.023496 --> -0.035260).  Saving model ...
Epoch: 3 cost time: 0.4810826778411865
Epoch: 3, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.397 Vali Acc: 0.062 Test Loss: 3.397 Test Acc: 0.062
Validation loss decreased (-0.035260 --> -0.062319).  Saving model ...
Epoch: 4 cost time: 0.45481443405151367
Epoch: 4, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.398 Vali Acc: 0.086 Test Loss: 3.398 Test Acc: 0.086
Validation loss decreased (-0.062319 --> -0.085848).  Saving model ...
Epoch: 5 cost time: 0.42256617546081543
Epoch: 5, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.329 Vali Acc: 0.106 Test Loss: 3.329 Test Acc: 0.106
Validation loss decreased (-0.085848 --> -0.105849).  Saving model ...
Epoch: 6 cost time: 0.448561429977417
Epoch: 6, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.293 Vali Acc: 0.122 Test Loss: 3.293 Test Acc: 0.122
Validation loss decreased (-0.105849 --> -0.122320).  Saving model ...
Epoch: 7 cost time: 0.44238924980163574
Epoch: 7, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.290 Vali Acc: 0.147 Test Loss: 3.290 Test Acc: 0.147
Validation loss decreased (-0.122320 --> -0.147026).  Saving model ...
Epoch: 8 cost time: 0.475780725479126
Epoch: 8, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.308 Vali Acc: 0.168 Test Loss: 3.308 Test Acc: 0.168
Validation loss decreased (-0.147026 --> -0.168202).  Saving model ...
Epoch: 9 cost time: 0.42890477180480957
Epoch: 9, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.344 Vali Acc: 0.178 Test Loss: 3.344 Test Acc: 0.178
Validation loss decreased (-0.168202 --> -0.177614).  Saving model ...
Epoch: 10 cost time: 0.4460587501525879
Epoch: 10, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.382 Vali Acc: 0.200 Test Loss: 3.382 Test Acc: 0.200
Validation loss decreased (-0.177614 --> -0.199966).  Saving model ...
Epoch: 11 cost time: 0.48238658905029297
Epoch: 11, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.432 Vali Acc: 0.205 Test Loss: 3.432 Test Acc: 0.205
Validation loss decreased (-0.199966 --> -0.204672).  Saving model ...
Epoch: 12 cost time: 0.4653794765472412
Epoch: 12, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.515 Vali Acc: 0.213 Test Loss: 3.515 Test Acc: 0.213
Validation loss decreased (-0.204672 --> -0.212906).  Saving model ...
Epoch: 13 cost time: 0.44238948822021484
Epoch: 13, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.614 Vali Acc: 0.229 Test Loss: 3.614 Test Acc: 0.229
Validation loss decreased (-0.212906 --> -0.229376).  Saving model ...
Epoch: 14 cost time: 0.40261363983154297
Epoch: 14, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.677 Vali Acc: 0.225 Test Loss: 3.677 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5128154754638672
Epoch: 15, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.738 Vali Acc: 0.232 Test Loss: 3.738 Test Acc: 0.232
Validation loss decreased (-0.229376 --> -0.231727).  Saving model ...
Epoch: 16 cost time: 0.4929978847503662
Epoch: 16, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.801 Vali Acc: 0.244 Test Loss: 3.801 Test Acc: 0.244
Validation loss decreased (-0.231727 --> -0.243491).  Saving model ...
Epoch: 17 cost time: 0.5619099140167236
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.881 Vali Acc: 0.231 Test Loss: 3.881 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4773409366607666
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.054 Vali Acc: 0.225 Test Loss: 4.054 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.49665164947509766
Epoch: 19, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.129 Vali Acc: 0.238 Test Loss: 4.129 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.49370837211608887
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.158 Vali Acc: 0.236 Test Loss: 4.158 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5332911014556885
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.224 Vali Acc: 0.240 Test Loss: 4.224 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5028932094573975
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.269 Vali Acc: 0.239 Test Loss: 4.269 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4842381477355957
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.326 Vali Acc: 0.240 Test Loss: 4.326 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.47887134552001953
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.349 Vali Acc: 0.236 Test Loss: 4.349 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.45110344886779785
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.394 Vali Acc: 0.238 Test Loss: 4.394 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4229121208190918
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.438 Vali Acc: 0.244 Test Loss: 4.438 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 225690
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4910671710968018
Epoch: 1, Steps: 10 | Train Loss: 3.488 Vali Loss: 3.354 Vali Acc: 0.044 Test Loss: 3.354 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.5059518814086914
Epoch: 2, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.329 Vali Acc: 0.064 Test Loss: 3.329 Test Acc: 0.064
Validation loss decreased (-0.043496 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.4769575595855713
Epoch: 3, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.342 Vali Acc: 0.075 Test Loss: 3.342 Test Acc: 0.075
Validation loss decreased (-0.063496 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.4477202892303467
Epoch: 4, Steps: 10 | Train Loss: 2.834 Vali Loss: 3.348 Vali Acc: 0.081 Test Loss: 3.348 Test Acc: 0.081
Validation loss decreased (-0.075261 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.4548916816711426
Epoch: 5, Steps: 10 | Train Loss: 2.644 Vali Loss: 3.325 Vali Acc: 0.106 Test Loss: 3.325 Test Acc: 0.106
Validation loss decreased (-0.081143 --> -0.105849).  Saving model ...
Epoch: 6 cost time: 0.4489631652832031
Epoch: 6, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.281 Vali Acc: 0.133 Test Loss: 3.281 Test Acc: 0.133
Validation loss decreased (-0.105849 --> -0.132908).  Saving model ...
Epoch: 7 cost time: 0.5027806758880615
Epoch: 7, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.255 Vali Acc: 0.124 Test Loss: 3.255 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46550965309143066
Epoch: 8, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.244 Vali Acc: 0.148 Test Loss: 3.244 Test Acc: 0.148
Validation loss decreased (-0.132908 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.5170855522155762
Epoch: 9, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.260 Vali Acc: 0.168 Test Loss: 3.260 Test Acc: 0.168
Validation loss decreased (-0.148203 --> -0.168203).  Saving model ...
Epoch: 10 cost time: 0.5066494941711426
Epoch: 10, Steps: 10 | Train Loss: 1.364 Vali Loss: 3.294 Vali Acc: 0.180 Test Loss: 3.294 Test Acc: 0.180
Validation loss decreased (-0.168203 --> -0.179967).  Saving model ...
Epoch: 11 cost time: 0.5233728885650635
Epoch: 11, Steps: 10 | Train Loss: 1.211 Vali Loss: 3.315 Vali Acc: 0.206 Test Loss: 3.315 Test Acc: 0.206
Validation loss decreased (-0.179967 --> -0.205849).  Saving model ...
Epoch: 12 cost time: 0.49419617652893066
Epoch: 12, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.340 Vali Acc: 0.214 Test Loss: 3.340 Test Acc: 0.214
Validation loss decreased (-0.205849 --> -0.214084).  Saving model ...
Epoch: 13 cost time: 0.4701552391052246
Epoch: 13, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.397 Vali Acc: 0.226 Test Loss: 3.397 Test Acc: 0.226
Validation loss decreased (-0.214084 --> -0.225848).  Saving model ...
Epoch: 14 cost time: 0.4891986846923828
Epoch: 14, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.483 Vali Acc: 0.221 Test Loss: 3.483 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4930408000946045
Epoch: 15, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.504 Vali Acc: 0.236 Test Loss: 3.504 Test Acc: 0.236
Validation loss decreased (-0.225848 --> -0.236436).  Saving model ...
Epoch: 16 cost time: 0.4854884147644043
Epoch: 16, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.585 Vali Acc: 0.246 Test Loss: 3.585 Test Acc: 0.246
Validation loss decreased (-0.236436 --> -0.245846).  Saving model ...
Epoch: 17 cost time: 0.4589364528656006
Epoch: 17, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.640 Vali Acc: 0.244 Test Loss: 3.640 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.45978426933288574
Epoch: 18, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.701 Vali Acc: 0.249 Test Loss: 3.701 Test Acc: 0.249
Validation loss decreased (-0.245846 --> -0.249375).  Saving model ...
Epoch: 19 cost time: 0.45746564865112305
Epoch: 19, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.813 Vali Acc: 0.246 Test Loss: 3.813 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.47633886337280273
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.894 Vali Acc: 0.248 Test Loss: 3.894 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4868807792663574
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.954 Vali Acc: 0.258 Test Loss: 3.954 Test Acc: 0.258
Validation loss decreased (-0.249375 --> -0.257608).  Saving model ...
Epoch: 22 cost time: 0.47866106033325195
Epoch: 22, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.971 Vali Acc: 0.255 Test Loss: 3.971 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4905259609222412
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.000 Vali Acc: 0.255 Test Loss: 4.000 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.44594335556030273
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.083 Vali Acc: 0.253 Test Loss: 4.083 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.47367382049560547
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.133 Vali Acc: 0.254 Test Loss: 4.133 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4512605667114258
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.133 Vali Acc: 0.255 Test Loss: 4.133 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5004842281341553
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.162 Vali Acc: 0.255 Test Loss: 4.162 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.48337364196777344
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.202 Vali Acc: 0.256 Test Loss: 4.202 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.48080921173095703
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.263 Vali Acc: 0.255 Test Loss: 4.263 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4439735412597656
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.275 Vali Acc: 0.255 Test Loss: 4.275 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.45835256576538086
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.281 Vali Acc: 0.258 Test Loss: 4.281 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 195994
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.701545238494873
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.383 Vali Acc: 0.045 Test Loss: 3.383 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.5150525569915771
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.351 Vali Acc: 0.049 Test Loss: 3.351 Test Acc: 0.049
Validation loss decreased (-0.044672 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.456650972366333
Epoch: 3, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.333 Vali Acc: 0.069 Test Loss: 3.333 Test Acc: 0.069
Validation loss decreased (-0.049378 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 0.4156670570373535
Epoch: 4, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.327 Vali Acc: 0.081 Test Loss: 3.327 Test Acc: 0.081
Validation loss decreased (-0.069378 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.4350409507751465
Epoch: 5, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.325 Vali Acc: 0.085 Test Loss: 3.325 Test Acc: 0.085
Validation loss decreased (-0.081143 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.4876108169555664
Epoch: 6, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.318 Vali Acc: 0.100 Test Loss: 3.318 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 0.48122334480285645
Epoch: 7, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.304 Vali Acc: 0.106 Test Loss: 3.304 Test Acc: 0.106
Validation loss decreased (-0.099967 --> -0.105849).  Saving model ...
Epoch: 8 cost time: 0.48603320121765137
Epoch: 8, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.284 Vali Acc: 0.121 Test Loss: 3.284 Test Acc: 0.121
Validation loss decreased (-0.105849 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 0.43563127517700195
Epoch: 9, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.271 Vali Acc: 0.135 Test Loss: 3.271 Test Acc: 0.135
Validation loss decreased (-0.121144 --> -0.135261).  Saving model ...
Epoch: 10 cost time: 0.44066953659057617
Epoch: 10, Steps: 10 | Train Loss: 1.779 Vali Loss: 3.264 Vali Acc: 0.155 Test Loss: 3.264 Test Acc: 0.155
Validation loss decreased (-0.135261 --> -0.155261).  Saving model ...
Epoch: 11 cost time: 0.480236291885376
Epoch: 11, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.280 Vali Acc: 0.167 Test Loss: 3.280 Test Acc: 0.167
Validation loss decreased (-0.155261 --> -0.167026).  Saving model ...
Epoch: 12 cost time: 0.4747757911682129
Epoch: 12, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.297 Vali Acc: 0.188 Test Loss: 3.297 Test Acc: 0.188
Validation loss decreased (-0.167026 --> -0.188202).  Saving model ...
Epoch: 13 cost time: 0.4523627758026123
Epoch: 13, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.321 Vali Acc: 0.192 Test Loss: 3.321 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 14 cost time: 0.46584463119506836
Epoch: 14, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.354 Vali Acc: 0.200 Test Loss: 3.354 Test Acc: 0.200
Validation loss decreased (-0.191731 --> -0.199966).  Saving model ...
Epoch: 15 cost time: 0.517099142074585
Epoch: 15, Steps: 10 | Train Loss: 0.981 Vali Loss: 3.372 Vali Acc: 0.207 Test Loss: 3.372 Test Acc: 0.207
Validation loss decreased (-0.199966 --> -0.207025).  Saving model ...
Epoch: 16 cost time: 0.47260355949401855
Epoch: 16, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.404 Vali Acc: 0.216 Test Loss: 3.404 Test Acc: 0.216
Validation loss decreased (-0.207025 --> -0.216437).  Saving model ...
Epoch: 17 cost time: 0.5271446704864502
Epoch: 17, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.438 Vali Acc: 0.225 Test Loss: 3.438 Test Acc: 0.225
Validation loss decreased (-0.216437 --> -0.224672).  Saving model ...
Epoch: 18 cost time: 0.44774293899536133
Epoch: 18, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.498 Vali Acc: 0.220 Test Loss: 3.498 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5499663352966309
Epoch: 19, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.543 Vali Acc: 0.218 Test Loss: 3.543 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4960353374481201
Epoch: 20, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.597 Vali Acc: 0.224 Test Loss: 3.597 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.45664095878601074
Epoch: 21, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.694 Vali Acc: 0.231 Test Loss: 3.694 Test Acc: 0.231
Validation loss decreased (-0.224672 --> -0.230551).  Saving model ...
Epoch: 22 cost time: 0.4893636703491211
Epoch: 22, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.730 Vali Acc: 0.229 Test Loss: 3.730 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.49239611625671387
Epoch: 23, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.741 Vali Acc: 0.240 Test Loss: 3.741 Test Acc: 0.240
Validation loss decreased (-0.230551 --> -0.239963).  Saving model ...
Epoch: 24 cost time: 0.5162270069122314
Epoch: 24, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.768 Vali Acc: 0.246 Test Loss: 3.768 Test Acc: 0.246
Validation loss decreased (-0.239963 --> -0.245845).  Saving model ...
Epoch: 25 cost time: 0.5059595108032227
Epoch: 25, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.807 Vali Acc: 0.241 Test Loss: 3.807 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4609043598175049
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.863 Vali Acc: 0.245 Test Loss: 3.863 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.46034789085388184
Epoch: 27, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.912 Vali Acc: 0.247 Test Loss: 3.912 Test Acc: 0.247
Validation loss decreased (-0.245845 --> -0.247020).  Saving model ...
Epoch: 28 cost time: 0.45955634117126465
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.958 Vali Acc: 0.248 Test Loss: 3.958 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248196).  Saving model ...
Epoch: 29 cost time: 0.49227094650268555
Epoch: 29, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.997 Vali Acc: 0.246 Test Loss: 3.997 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4503636360168457
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.016 Vali Acc: 0.246 Test Loss: 4.016 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4995689392089844
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.044 Vali Acc: 0.252 Test Loss: 4.044 Test Acc: 0.252
Validation loss decreased (-0.248196 --> -0.251724).  Saving model ...
Epoch: 32 cost time: 0.48647642135620117
Epoch: 32, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.082 Vali Acc: 0.254 Test Loss: 4.082 Test Acc: 0.254
Validation loss decreased (-0.251724 --> -0.254077).  Saving model ...
Epoch: 33 cost time: 0.48235559463500977
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.102 Vali Acc: 0.248 Test Loss: 4.102 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4944264888763428
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.116 Vali Acc: 0.253 Test Loss: 4.116 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4745767116546631
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.125 Vali Acc: 0.252 Test Loss: 4.125 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4924924373626709
Epoch: 36, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.119 Vali Acc: 0.252 Test Loss: 4.119 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4547100067138672
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.140 Vali Acc: 0.249 Test Loss: 4.140 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4776191711425781
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.172 Vali Acc: 0.261 Test Loss: 4.172 Test Acc: 0.261
Validation loss decreased (-0.254077 --> -0.261135).  Saving model ...
Epoch: 39 cost time: 0.4907538890838623
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.195 Vali Acc: 0.258 Test Loss: 4.195 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.49725770950317383
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.202 Vali Acc: 0.261 Test Loss: 4.202 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5182051658630371
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.226 Vali Acc: 0.256 Test Loss: 4.226 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4708888530731201
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.246 Vali Acc: 0.259 Test Loss: 4.246 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.45913195610046387
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.258 Vali Acc: 0.255 Test Loss: 4.258 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4709289073944092
Epoch: 44, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.265 Vali Acc: 0.259 Test Loss: 4.265 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5273895263671875
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.270 Vali Acc: 0.258 Test Loss: 4.270 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5076541900634766
Epoch: 46, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.287 Vali Acc: 0.258 Test Loss: 4.287 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5053479671478271
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.305 Vali Acc: 0.256 Test Loss: 4.305 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5154361724853516
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.330 Vali Acc: 0.255 Test Loss: 4.330 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 161498
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3780548572540283
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.341 Vali Acc: 0.032 Test Loss: 3.341 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.5242815017700195
Epoch: 2, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.329 Vali Acc: 0.051 Test Loss: 3.329 Test Acc: 0.051
Validation loss decreased (-0.031731 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.45775747299194336
Epoch: 3, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.319 Vali Acc: 0.074 Test Loss: 3.319 Test Acc: 0.074
Validation loss decreased (-0.050555 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 0.5223124027252197
Epoch: 4, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.309 Vali Acc: 0.086 Test Loss: 3.309 Test Acc: 0.086
Validation loss decreased (-0.074084 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 0.4930751323699951
Epoch: 5, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.305 Vali Acc: 0.100 Test Loss: 3.305 Test Acc: 0.100
Validation loss decreased (-0.085849 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.5391037464141846
Epoch: 6, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.302 Vali Acc: 0.108 Test Loss: 3.302 Test Acc: 0.108
Validation loss decreased (-0.099967 --> -0.108202).  Saving model ...
Epoch: 7 cost time: 0.4794278144836426
Epoch: 7, Steps: 10 | Train Loss: 2.477 Vali Loss: 3.289 Vali Acc: 0.126 Test Loss: 3.289 Test Acc: 0.126
Validation loss decreased (-0.108202 --> -0.125849).  Saving model ...
Epoch: 8 cost time: 0.429872989654541
Epoch: 8, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.277 Vali Acc: 0.145 Test Loss: 3.277 Test Acc: 0.145
Validation loss decreased (-0.125849 --> -0.144673).  Saving model ...
Epoch: 9 cost time: 0.4528214931488037
Epoch: 9, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.271 Vali Acc: 0.148 Test Loss: 3.271 Test Acc: 0.148
Validation loss decreased (-0.144673 --> -0.148203).  Saving model ...
Epoch: 10 cost time: 0.44948458671569824
Epoch: 10, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.253 Vali Acc: 0.155 Test Loss: 3.253 Test Acc: 0.155
Validation loss decreased (-0.148203 --> -0.155262).  Saving model ...
Epoch: 11 cost time: 0.483872652053833
Epoch: 11, Steps: 10 | Train Loss: 1.763 Vali Loss: 3.251 Vali Acc: 0.173 Test Loss: 3.251 Test Acc: 0.173
Validation loss decreased (-0.155262 --> -0.172909).  Saving model ...
Epoch: 12 cost time: 0.5198261737823486
Epoch: 12, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.261 Vali Acc: 0.181 Test Loss: 3.261 Test Acc: 0.181
Validation loss decreased (-0.172909 --> -0.181144).  Saving model ...
Epoch: 13 cost time: 0.5214023590087891
Epoch: 13, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.275 Vali Acc: 0.184 Test Loss: 3.275 Test Acc: 0.184
Validation loss decreased (-0.181144 --> -0.183497).  Saving model ...
Epoch: 14 cost time: 0.5213034152984619
Epoch: 14, Steps: 10 | Train Loss: 1.308 Vali Loss: 3.295 Vali Acc: 0.194 Test Loss: 3.295 Test Acc: 0.194
Validation loss decreased (-0.183497 --> -0.194085).  Saving model ...
Epoch: 15 cost time: 0.4653663635253906
Epoch: 15, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.317 Vali Acc: 0.198 Test Loss: 3.317 Test Acc: 0.198
Validation loss decreased (-0.194085 --> -0.197614).  Saving model ...
Epoch: 16 cost time: 0.47186732292175293
Epoch: 16, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.339 Vali Acc: 0.202 Test Loss: 3.339 Test Acc: 0.202
Validation loss decreased (-0.197614 --> -0.202320).  Saving model ...
Epoch: 17 cost time: 0.5172321796417236
Epoch: 17, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.366 Vali Acc: 0.211 Test Loss: 3.366 Test Acc: 0.211
Validation loss decreased (-0.202320 --> -0.210555).  Saving model ...
Epoch: 18 cost time: 0.5166299343109131
Epoch: 18, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.392 Vali Acc: 0.213 Test Loss: 3.392 Test Acc: 0.213
Validation loss decreased (-0.210555 --> -0.212907).  Saving model ...
Epoch: 19 cost time: 0.5156359672546387
Epoch: 19, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.438 Vali Acc: 0.216 Test Loss: 3.438 Test Acc: 0.216
Validation loss decreased (-0.212907 --> -0.216436).  Saving model ...
Epoch: 20 cost time: 0.48998236656188965
Epoch: 20, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.473 Vali Acc: 0.228 Test Loss: 3.473 Test Acc: 0.228
Validation loss decreased (-0.216436 --> -0.228201).  Saving model ...
Epoch: 21 cost time: 0.47282934188842773
Epoch: 21, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.504 Vali Acc: 0.234 Test Loss: 3.504 Test Acc: 0.234
Validation loss decreased (-0.228201 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 0.4290022850036621
Epoch: 22, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.547 Vali Acc: 0.235 Test Loss: 3.547 Test Acc: 0.235
Validation loss decreased (-0.234083 --> -0.235259).  Saving model ...
Epoch: 23 cost time: 0.48111867904663086
Epoch: 23, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.619 Vali Acc: 0.233 Test Loss: 3.619 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.44185876846313477
Epoch: 24, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.661 Vali Acc: 0.233 Test Loss: 3.661 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4699242115020752
Epoch: 25, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.724 Vali Acc: 0.235 Test Loss: 3.724 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4362311363220215
Epoch: 26, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.742 Vali Acc: 0.232 Test Loss: 3.742 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4920194149017334
Epoch: 27, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.780 Vali Acc: 0.240 Test Loss: 3.780 Test Acc: 0.240
Validation loss decreased (-0.235259 --> -0.239962).  Saving model ...
Epoch: 28 cost time: 0.47931408882141113
Epoch: 28, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.832 Vali Acc: 0.238 Test Loss: 3.832 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4668722152709961
Epoch: 29, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.855 Vali Acc: 0.242 Test Loss: 3.855 Test Acc: 0.242
Validation loss decreased (-0.239962 --> -0.242314).  Saving model ...
Epoch: 30 cost time: 0.45964837074279785
Epoch: 30, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.856 Vali Acc: 0.242 Test Loss: 3.856 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.49343299865722656
Epoch: 31, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.892 Vali Acc: 0.245 Test Loss: 3.892 Test Acc: 0.245
Validation loss decreased (-0.242314 --> -0.244667).  Saving model ...
Epoch: 32 cost time: 0.48690080642700195
Epoch: 32, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.955 Vali Acc: 0.240 Test Loss: 3.955 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5520093441009521
Epoch: 33, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.005 Vali Acc: 0.240 Test Loss: 4.005 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5469303131103516
Epoch: 34, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.023 Vali Acc: 0.246 Test Loss: 4.023 Test Acc: 0.246
Validation loss decreased (-0.244667 --> -0.245842).  Saving model ...
Epoch: 35 cost time: 0.5312225818634033
Epoch: 35, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.016 Vali Acc: 0.245 Test Loss: 4.016 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5210843086242676
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.045 Vali Acc: 0.241 Test Loss: 4.045 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5020914077758789
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.056 Vali Acc: 0.244 Test Loss: 4.056 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5244338512420654
Epoch: 38, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.084 Vali Acc: 0.245 Test Loss: 4.084 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5138692855834961
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.104 Vali Acc: 0.244 Test Loss: 4.104 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.541236162185669
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.137 Vali Acc: 0.246 Test Loss: 4.137 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5489816665649414
Epoch: 41, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.150 Vali Acc: 0.242 Test Loss: 4.150 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.49141693115234375
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.172 Vali Acc: 0.241 Test Loss: 4.172 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4558219909667969
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.173 Vali Acc: 0.248 Test Loss: 4.173 Test Acc: 0.248
Validation loss decreased (-0.245842 --> -0.248194).  Saving model ...
Epoch: 44 cost time: 0.509443998336792
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.190 Vali Acc: 0.253 Test Loss: 4.190 Test Acc: 0.253
Validation loss decreased (-0.248194 --> -0.252899).  Saving model ...
Epoch: 45 cost time: 0.510181188583374
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.190 Vali Acc: 0.252 Test Loss: 4.190 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5548398494720459
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.215 Vali Acc: 0.254 Test Loss: 4.215 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254075).  Saving model ...
Epoch: 47 cost time: 0.492203950881958
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.238 Vali Acc: 0.255 Test Loss: 4.238 Test Acc: 0.255
Validation loss decreased (-0.254075 --> -0.255252).  Saving model ...
Epoch: 48 cost time: 0.461367130279541
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.243 Vali Acc: 0.251 Test Loss: 4.243 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.47655391693115234
Epoch: 49, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.266 Vali Acc: 0.253 Test Loss: 4.266 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5607357025146484
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.284 Vali Acc: 0.245 Test Loss: 4.284 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.503058671951294
Epoch: 51, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.288 Vali Acc: 0.251 Test Loss: 4.288 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.48645591735839844
Epoch: 52, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.294 Vali Acc: 0.252 Test Loss: 4.294 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4474525451660156
Epoch: 53, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.307 Vali Acc: 0.254 Test Loss: 4.307 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.5256226062774658
Epoch: 54, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.316 Vali Acc: 0.261 Test Loss: 4.316 Test Acc: 0.261
Validation loss decreased (-0.255252 --> -0.261133).  Saving model ...
Epoch: 55 cost time: 0.48037171363830566
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.322 Vali Acc: 0.261 Test Loss: 4.322 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5468564033508301
Epoch: 56, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.352 Vali Acc: 0.258 Test Loss: 4.352 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.49369335174560547
Epoch: 57, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.364 Vali Acc: 0.254 Test Loss: 4.364 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5373382568359375
Epoch: 58, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.391 Vali Acc: 0.255 Test Loss: 4.391 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.48995471000671387
Epoch: 59, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.409 Vali Acc: 0.251 Test Loss: 4.409 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.5745415687561035
Epoch: 60, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.425 Vali Acc: 0.252 Test Loss: 4.425 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.4863758087158203
Epoch: 61, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.426 Vali Acc: 0.253 Test Loss: 4.426 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.5151565074920654
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.432 Vali Acc: 0.249 Test Loss: 4.432 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5697450637817383
Epoch: 63, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.446 Vali Acc: 0.247 Test Loss: 4.446 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.517815113067627
Epoch: 64, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.442 Vali Acc: 0.248 Test Loss: 4.442 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 147034
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5629312992095947
Epoch: 1, Steps: 10 | Train Loss: 3.558 Vali Loss: 3.355 Vali Acc: 0.053 Test Loss: 3.355 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.49587249755859375
Epoch: 2, Steps: 10 | Train Loss: 3.490 Vali Loss: 3.325 Vali Acc: 0.051 Test Loss: 3.325 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5120351314544678
Epoch: 3, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.296 Vali Acc: 0.059 Test Loss: 3.296 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.4439845085144043
Epoch: 4, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.277 Vali Acc: 0.060 Test Loss: 3.277 Test Acc: 0.060
Validation loss decreased (-0.058791 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.46839261054992676
Epoch: 5, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.269 Vali Acc: 0.071 Test Loss: 3.269 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070556).  Saving model ...
Epoch: 6 cost time: 0.42023730278015137
Epoch: 6, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.261 Vali Acc: 0.086 Test Loss: 3.261 Test Acc: 0.086
Validation loss decreased (-0.070556 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.45502328872680664
Epoch: 7, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.259 Vali Acc: 0.101 Test Loss: 3.259 Test Acc: 0.101
Validation loss decreased (-0.085850 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.4504365921020508
Epoch: 8, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.256 Vali Acc: 0.118 Test Loss: 3.256 Test Acc: 0.118
Validation loss decreased (-0.101144 --> -0.117614).  Saving model ...
Epoch: 9 cost time: 0.5107588768005371
Epoch: 9, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.248 Vali Acc: 0.140 Test Loss: 3.248 Test Acc: 0.140
Validation loss decreased (-0.117614 --> -0.139968).  Saving model ...
Epoch: 10 cost time: 0.45969629287719727
Epoch: 10, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.240 Vali Acc: 0.141 Test Loss: 3.240 Test Acc: 0.141
Validation loss decreased (-0.139968 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 0.46194958686828613
Epoch: 11, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.238 Vali Acc: 0.151 Test Loss: 3.238 Test Acc: 0.151
Validation loss decreased (-0.141144 --> -0.150556).  Saving model ...
Epoch: 12 cost time: 0.46119046211242676
Epoch: 12, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.248 Vali Acc: 0.159 Test Loss: 3.248 Test Acc: 0.159
Validation loss decreased (-0.150556 --> -0.158791).  Saving model ...
Epoch: 13 cost time: 0.38735175132751465
Epoch: 13, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.257 Vali Acc: 0.168 Test Loss: 3.257 Test Acc: 0.168
Validation loss decreased (-0.158791 --> -0.168203).  Saving model ...
Epoch: 14 cost time: 0.47976016998291016
Epoch: 14, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.275 Vali Acc: 0.176 Test Loss: 3.275 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 15 cost time: 0.47574853897094727
Epoch: 15, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.296 Vali Acc: 0.188 Test Loss: 3.296 Test Acc: 0.188
Validation loss decreased (-0.176438 --> -0.188202).  Saving model ...
Epoch: 16 cost time: 0.51242995262146
Epoch: 16, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.317 Vali Acc: 0.204 Test Loss: 3.317 Test Acc: 0.204
Validation loss decreased (-0.188202 --> -0.203496).  Saving model ...
Epoch: 17 cost time: 0.47348594665527344
Epoch: 17, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.342 Vali Acc: 0.204 Test Loss: 3.342 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4546363353729248
Epoch: 18, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.378 Vali Acc: 0.206 Test Loss: 3.378 Test Acc: 0.206
Validation loss decreased (-0.203496 --> -0.205849).  Saving model ...
Epoch: 19 cost time: 0.4175410270690918
Epoch: 19, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.415 Vali Acc: 0.201 Test Loss: 3.415 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48166632652282715
Epoch: 20, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.457 Vali Acc: 0.207 Test Loss: 3.457 Test Acc: 0.207
Validation loss decreased (-0.205849 --> -0.207024).  Saving model ...
Epoch: 21 cost time: 0.40495991706848145
Epoch: 21, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.499 Vali Acc: 0.212 Test Loss: 3.499 Test Acc: 0.212
Validation loss decreased (-0.207024 --> -0.211730).  Saving model ...
Epoch: 22 cost time: 0.45909857749938965
Epoch: 22, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.528 Vali Acc: 0.213 Test Loss: 3.528 Test Acc: 0.213
Validation loss decreased (-0.211730 --> -0.212906).  Saving model ...
Epoch: 23 cost time: 0.4406442642211914
Epoch: 23, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.553 Vali Acc: 0.218 Test Loss: 3.553 Test Acc: 0.218
Validation loss decreased (-0.212906 --> -0.217612).  Saving model ...
Epoch: 24 cost time: 0.3760807514190674
Epoch: 24, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.579 Vali Acc: 0.213 Test Loss: 3.579 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.37232542037963867
Epoch: 25, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.626 Vali Acc: 0.211 Test Loss: 3.626 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.39872288703918457
Epoch: 26, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.672 Vali Acc: 0.219 Test Loss: 3.672 Test Acc: 0.219
Validation loss decreased (-0.217612 --> -0.218787).  Saving model ...
Epoch: 27 cost time: 0.3976473808288574
Epoch: 27, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.710 Vali Acc: 0.228 Test Loss: 3.710 Test Acc: 0.228
Validation loss decreased (-0.218787 --> -0.228198).  Saving model ...
Epoch: 28 cost time: 0.5016944408416748
Epoch: 28, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.743 Vali Acc: 0.233 Test Loss: 3.743 Test Acc: 0.233
Validation loss decreased (-0.228198 --> -0.232904).  Saving model ...
Epoch: 29 cost time: 0.4709482192993164
Epoch: 29, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.774 Vali Acc: 0.227 Test Loss: 3.774 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5004348754882812
Epoch: 30, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.801 Vali Acc: 0.226 Test Loss: 3.801 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.49916672706604004
Epoch: 31, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.807 Vali Acc: 0.236 Test Loss: 3.807 Test Acc: 0.236
Validation loss decreased (-0.232904 --> -0.236433).  Saving model ...
Epoch: 32 cost time: 0.4725470542907715
Epoch: 32, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.840 Vali Acc: 0.242 Test Loss: 3.840 Test Acc: 0.242
Validation loss decreased (-0.236433 --> -0.242315).  Saving model ...
Epoch: 33 cost time: 0.4439849853515625
Epoch: 33, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.857 Vali Acc: 0.234 Test Loss: 3.857 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.491072416305542
Epoch: 34, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.887 Vali Acc: 0.232 Test Loss: 3.887 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4437291622161865
Epoch: 35, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.908 Vali Acc: 0.236 Test Loss: 3.908 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.415996789932251
Epoch: 36, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.931 Vali Acc: 0.233 Test Loss: 3.931 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4474210739135742
Epoch: 37, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.930 Vali Acc: 0.235 Test Loss: 3.930 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4494445323944092
Epoch: 38, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.971 Vali Acc: 0.238 Test Loss: 3.971 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.44646191596984863
Epoch: 39, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.987 Vali Acc: 0.244 Test Loss: 3.987 Test Acc: 0.244
Validation loss decreased (-0.242315 --> -0.243490).  Saving model ...
Epoch: 40 cost time: 0.4627499580383301
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.997 Vali Acc: 0.240 Test Loss: 3.997 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4289827346801758
Epoch: 41, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.002 Vali Acc: 0.244 Test Loss: 4.002 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.42534589767456055
Epoch: 42, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.053 Vali Acc: 0.249 Test Loss: 4.053 Test Acc: 0.249
Validation loss decreased (-0.243490 --> -0.249371).  Saving model ...
Epoch: 43 cost time: 0.4699556827545166
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.050 Vali Acc: 0.246 Test Loss: 4.050 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4434082508087158
Epoch: 44, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.057 Vali Acc: 0.249 Test Loss: 4.057 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.48807811737060547
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.076 Vali Acc: 0.248 Test Loss: 4.076 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.48728013038635254
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.066 Vali Acc: 0.247 Test Loss: 4.066 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.47148609161376953
Epoch: 47, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.075 Vali Acc: 0.244 Test Loss: 4.075 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.44437432289123535
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.081 Vali Acc: 0.253 Test Loss: 4.081 Test Acc: 0.253
Validation loss decreased (-0.249371 --> -0.252900).  Saving model ...
Epoch: 49 cost time: 0.47028183937072754
Epoch: 49, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.101 Vali Acc: 0.252 Test Loss: 4.101 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.49968814849853516
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.130 Vali Acc: 0.256 Test Loss: 4.130 Test Acc: 0.256
Validation loss decreased (-0.252900 --> -0.256429).  Saving model ...
Epoch: 51 cost time: 0.46328067779541016
Epoch: 51, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.142 Vali Acc: 0.255 Test Loss: 4.142 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4885830879211426
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.175 Vali Acc: 0.252 Test Loss: 4.175 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6064741611480713
Epoch: 53, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.177 Vali Acc: 0.249 Test Loss: 4.177 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.4558591842651367
Epoch: 54, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.180 Vali Acc: 0.254 Test Loss: 4.180 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5320355892181396
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.197 Vali Acc: 0.252 Test Loss: 4.197 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.500460147857666
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.203 Vali Acc: 0.247 Test Loss: 4.203 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.46344947814941406
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.215 Vali Acc: 0.244 Test Loss: 4.215 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4688124656677246
Epoch: 58, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.218 Vali Acc: 0.244 Test Loss: 4.218 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.4548220634460449
Epoch: 59, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.228 Vali Acc: 0.247 Test Loss: 4.228 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.4827384948730469
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.241 Vali Acc: 0.249 Test Loss: 4.241 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 142490
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.612121343612671
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.345 Vali Acc: 0.048 Test Loss: 3.345 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.4610726833343506
Epoch: 2, Steps: 10 | Train Loss: 3.109 Vali Loss: 3.375 Vali Acc: 0.067 Test Loss: 3.375 Test Acc: 0.067
Validation loss decreased (-0.048202 --> -0.067025).  Saving model ...
Epoch: 3 cost time: 0.4758274555206299
Epoch: 3, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.269 Vali Acc: 0.120 Test Loss: 3.269 Test Acc: 0.120
Validation loss decreased (-0.067025 --> -0.119967).  Saving model ...
Epoch: 4 cost time: 0.4766659736633301
Epoch: 4, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.264 Vali Acc: 0.148 Test Loss: 3.264 Test Acc: 0.148
Validation loss decreased (-0.119967 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 0.46344566345214844
Epoch: 5, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.346 Vali Acc: 0.176 Test Loss: 3.346 Test Acc: 0.176
Validation loss decreased (-0.148203 --> -0.176437).  Saving model ...
Epoch: 6 cost time: 0.48235368728637695
Epoch: 6, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.386 Vali Acc: 0.193 Test Loss: 3.386 Test Acc: 0.193
Validation loss decreased (-0.176437 --> -0.192907).  Saving model ...
Epoch: 7 cost time: 0.4779343605041504
Epoch: 7, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.546 Vali Acc: 0.216 Test Loss: 3.546 Test Acc: 0.216
Validation loss decreased (-0.192907 --> -0.216435).  Saving model ...
Epoch: 8 cost time: 0.4498629570007324
Epoch: 8, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.647 Vali Acc: 0.214 Test Loss: 3.647 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4581942558288574
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.806 Vali Acc: 0.239 Test Loss: 3.806 Test Acc: 0.239
Validation loss decreased (-0.216435 --> -0.238785).  Saving model ...
Epoch: 10 cost time: 0.49881815910339355
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.994 Vali Acc: 0.240 Test Loss: 3.994 Test Acc: 0.240
Validation loss decreased (-0.238785 --> -0.239960).  Saving model ...
Epoch: 11 cost time: 0.4495871067047119
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.177 Vali Acc: 0.231 Test Loss: 4.177 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47255873680114746
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.304 Vali Acc: 0.235 Test Loss: 4.304 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4248924255371094
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.558 Vali Acc: 0.247 Test Loss: 4.558 Test Acc: 0.247
Validation loss decreased (-0.239960 --> -0.247013).  Saving model ...
Epoch: 14 cost time: 0.47358226776123047
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.524 Vali Acc: 0.271 Test Loss: 4.524 Test Acc: 0.271
Validation loss decreased (-0.247013 --> -0.270543).  Saving model ...
Epoch: 15 cost time: 0.4100978374481201
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.607 Vali Acc: 0.272 Test Loss: 4.607 Test Acc: 0.272
Validation loss decreased (-0.270543 --> -0.271719).  Saving model ...
Epoch: 16 cost time: 0.45317769050598145
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.680 Vali Acc: 0.271 Test Loss: 4.680 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4618673324584961
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.730 Vali Acc: 0.264 Test Loss: 4.730 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.46625304222106934
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.761 Vali Acc: 0.268 Test Loss: 4.761 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4596216678619385
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.812 Vali Acc: 0.261 Test Loss: 4.812 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5263636112213135
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.847 Vali Acc: 0.259 Test Loss: 4.847 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4662299156188965
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.889 Vali Acc: 0.265 Test Loss: 4.889 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.45543646812438965
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.892 Vali Acc: 0.265 Test Loss: 4.892 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4620797634124756
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.881 Vali Acc: 0.269 Test Loss: 4.881 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.47893571853637695
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.915 Vali Acc: 0.269 Test Loss: 4.915 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4588479995727539
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.918 Vali Acc: 0.274 Test Loss: 4.918 Test Acc: 0.274
Validation loss decreased (-0.271719 --> -0.274068).  Saving model ...
Epoch: 26 cost time: 0.45365357398986816
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.939 Vali Acc: 0.272 Test Loss: 4.939 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43218541145324707
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.956 Vali Acc: 0.268 Test Loss: 4.956 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4948844909667969
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.981 Vali Acc: 0.265 Test Loss: 4.981 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.476485013961792
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.006 Vali Acc: 0.267 Test Loss: 5.006 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4486093521118164
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.020 Vali Acc: 0.268 Test Loss: 5.020 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.48186326026916504
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.272 Test Loss: 5.027 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4864063262939453
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.045 Vali Acc: 0.271 Test Loss: 5.045 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6144604682922363
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.062 Vali Acc: 0.272 Test Loss: 5.062 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.491626501083374
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.072 Vali Acc: 0.274 Test Loss: 5.072 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5244910717010498
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.088 Vali Acc: 0.275 Test Loss: 5.088 Test Acc: 0.275
Validation loss decreased (-0.274068 --> -0.275243).  Saving model ...
Epoch: 36 cost time: 0.5296502113342285
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.124 Vali Acc: 0.272 Test Loss: 5.124 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.505753755569458
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.123 Vali Acc: 0.273 Test Loss: 5.123 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5051624774932861
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.141 Vali Acc: 0.269 Test Loss: 5.141 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4813826084136963
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.164 Vali Acc: 0.269 Test Loss: 5.164 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.43317389488220215
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.181 Vali Acc: 0.273 Test Loss: 5.181 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4953122138977051
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.184 Vali Acc: 0.274 Test Loss: 5.184 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4856588840484619
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.206 Vali Acc: 0.273 Test Loss: 5.206 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.460050106048584
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.210 Vali Acc: 0.273 Test Loss: 5.210 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4890880584716797
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.212 Vali Acc: 0.273 Test Loss: 5.212 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.47286224365234375
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.239 Vali Acc: 0.272 Test Loss: 5.239 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 446746
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5257163047790527
Epoch: 1, Steps: 10 | Train Loss: 3.457 Vali Loss: 3.320 Vali Acc: 0.047 Test Loss: 3.320 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.4382660388946533
Epoch: 2, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.325 Vali Acc: 0.064 Test Loss: 3.325 Test Acc: 0.064
Validation loss decreased (-0.047026 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.4193241596221924
Epoch: 3, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.372 Vali Acc: 0.096 Test Loss: 3.372 Test Acc: 0.096
Validation loss decreased (-0.063496 --> -0.096437).  Saving model ...
Epoch: 4 cost time: 0.4193274974822998
Epoch: 4, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.278 Vali Acc: 0.127 Test Loss: 3.278 Test Acc: 0.127
Validation loss decreased (-0.096437 --> -0.127026).  Saving model ...
Epoch: 5 cost time: 0.43026113510131836
Epoch: 5, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.261 Vali Acc: 0.133 Test Loss: 3.261 Test Acc: 0.133
Validation loss decreased (-0.127026 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 0.4586482048034668
Epoch: 6, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.244 Vali Acc: 0.161 Test Loss: 3.244 Test Acc: 0.161
Validation loss decreased (-0.132909 --> -0.161144).  Saving model ...
Epoch: 7 cost time: 0.4381229877471924
Epoch: 7, Steps: 10 | Train Loss: 1.531 Vali Loss: 3.275 Vali Acc: 0.187 Test Loss: 3.275 Test Acc: 0.187
Validation loss decreased (-0.161144 --> -0.187026).  Saving model ...
Epoch: 8 cost time: 0.4452090263366699
Epoch: 8, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.342 Vali Acc: 0.202 Test Loss: 3.342 Test Acc: 0.202
Validation loss decreased (-0.187026 --> -0.202320).  Saving model ...
Epoch: 9 cost time: 0.47238898277282715
Epoch: 9, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.409 Vali Acc: 0.219 Test Loss: 3.409 Test Acc: 0.219
Validation loss decreased (-0.202320 --> -0.218789).  Saving model ...
Epoch: 10 cost time: 0.48377394676208496
Epoch: 10, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.480 Vali Acc: 0.229 Test Loss: 3.480 Test Acc: 0.229
Validation loss decreased (-0.218789 --> -0.229377).  Saving model ...
Epoch: 11 cost time: 0.5049524307250977
Epoch: 11, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.566 Vali Acc: 0.228 Test Loss: 3.566 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5142414569854736
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.622 Vali Acc: 0.265 Test Loss: 3.622 Test Acc: 0.265
Validation loss decreased (-0.229377 --> -0.264670).  Saving model ...
Epoch: 13 cost time: 0.46991610527038574
Epoch: 13, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.780 Vali Acc: 0.255 Test Loss: 3.780 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.42745232582092285
Epoch: 14, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.919 Vali Acc: 0.244 Test Loss: 3.919 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4457108974456787
Epoch: 15, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.987 Vali Acc: 0.266 Test Loss: 3.987 Test Acc: 0.266
Validation loss decreased (-0.264670 --> -0.265842).  Saving model ...
Epoch: 16 cost time: 0.46575331687927246
Epoch: 16, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.099 Vali Acc: 0.260 Test Loss: 4.099 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.46647167205810547
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.205 Vali Acc: 0.259 Test Loss: 4.205 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5533246994018555
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.253 Vali Acc: 0.269 Test Loss: 4.253 Test Acc: 0.269
Validation loss decreased (-0.265842 --> -0.269369).  Saving model ...
Epoch: 19 cost time: 0.40648889541625977
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.282 Vali Acc: 0.272 Test Loss: 4.282 Test Acc: 0.272
Validation loss decreased (-0.269369 --> -0.271722).  Saving model ...
Epoch: 20 cost time: 0.4694523811340332
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.339 Vali Acc: 0.274 Test Loss: 4.339 Test Acc: 0.274
Validation loss decreased (-0.271722 --> -0.274074).  Saving model ...
Epoch: 21 cost time: 0.4857771396636963
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.431 Vali Acc: 0.274 Test Loss: 4.431 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4705798625946045
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.460 Vali Acc: 0.271 Test Loss: 4.460 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5498573780059814
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.457 Vali Acc: 0.274 Test Loss: 4.457 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.46279263496398926
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.479 Vali Acc: 0.275 Test Loss: 4.479 Test Acc: 0.275
Validation loss decreased (-0.274074 --> -0.275249).  Saving model ...
Epoch: 25 cost time: 0.4638030529022217
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.518 Vali Acc: 0.280 Test Loss: 4.518 Test Acc: 0.280
Validation loss decreased (-0.275249 --> -0.279955).  Saving model ...
Epoch: 26 cost time: 0.45827603340148926
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.556 Vali Acc: 0.275 Test Loss: 4.556 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4351389408111572
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.590 Vali Acc: 0.276 Test Loss: 4.590 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.45578956604003906
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.610 Vali Acc: 0.279 Test Loss: 4.610 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4550442695617676
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.644 Vali Acc: 0.280 Test Loss: 4.644 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4616057872772217
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.663 Vali Acc: 0.279 Test Loss: 4.663 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4287412166595459
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.682 Vali Acc: 0.280 Test Loss: 4.682 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4608464241027832
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.706 Vali Acc: 0.280 Test Loss: 4.706 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.44205236434936523
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.722 Vali Acc: 0.278 Test Loss: 4.722 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4516749382019043
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.731 Vali Acc: 0.279 Test Loss: 4.731 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4439582824707031
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.750 Vali Acc: 0.281 Test Loss: 4.750 Test Acc: 0.281
Validation loss decreased (-0.279955 --> -0.281129).  Saving model ...
Epoch: 36 cost time: 0.5039947032928467
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.759 Vali Acc: 0.279 Test Loss: 4.759 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48084568977355957
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.780 Vali Acc: 0.280 Test Loss: 4.780 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.44556236267089844
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.809 Vali Acc: 0.278 Test Loss: 4.809 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4661259651184082
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.824 Vali Acc: 0.282 Test Loss: 4.824 Test Acc: 0.282
Validation loss decreased (-0.281129 --> -0.282305).  Saving model ...
Epoch: 40 cost time: 0.46324920654296875
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.834 Vali Acc: 0.280 Test Loss: 4.834 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4973621368408203
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.845 Vali Acc: 0.276 Test Loss: 4.845 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4469172954559326
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.846 Vali Acc: 0.280 Test Loss: 4.846 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4431471824645996
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.863 Vali Acc: 0.280 Test Loss: 4.863 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4440019130706787
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.879 Vali Acc: 0.274 Test Loss: 4.879 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4216005802154541
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.889 Vali Acc: 0.275 Test Loss: 4.889 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.47530198097229004
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.900 Vali Acc: 0.273 Test Loss: 4.900 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.43321967124938965
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.914 Vali Acc: 0.274 Test Loss: 4.914 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.45728230476379395
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.939 Vali Acc: 0.276 Test Loss: 4.939 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.47644639015197754
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.945 Vali Acc: 0.272 Test Loss: 4.945 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 257306
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.39524507522583
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.414 Vali Acc: 0.036 Test Loss: 3.414 Test Acc: 0.036
Validation loss decreased (inf --> -0.036436).  Saving model ...
Epoch: 2 cost time: 0.44956302642822266
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.391 Vali Acc: 0.044 Test Loss: 3.391 Test Acc: 0.044
Validation loss decreased (-0.036436 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.42971277236938477
Epoch: 3, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.393 Vali Acc: 0.072 Test Loss: 3.393 Test Acc: 0.072
Validation loss decreased (-0.043496 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.4184551239013672
Epoch: 4, Steps: 10 | Train Loss: 2.751 Vali Loss: 3.377 Vali Acc: 0.089 Test Loss: 3.377 Test Acc: 0.089
Validation loss decreased (-0.071731 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 0.4658691883087158
Epoch: 5, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.314 Vali Acc: 0.128 Test Loss: 3.314 Test Acc: 0.128
Validation loss decreased (-0.089378 --> -0.128202).  Saving model ...
Epoch: 6 cost time: 0.42539525032043457
Epoch: 6, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.281 Vali Acc: 0.139 Test Loss: 3.281 Test Acc: 0.139
Validation loss decreased (-0.128202 --> -0.138791).  Saving model ...
Epoch: 7 cost time: 0.3957092761993408
Epoch: 7, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.274 Vali Acc: 0.151 Test Loss: 3.274 Test Acc: 0.151
Validation loss decreased (-0.138791 --> -0.150555).  Saving model ...
Epoch: 8 cost time: 0.3990640640258789
Epoch: 8, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.268 Vali Acc: 0.181 Test Loss: 3.268 Test Acc: 0.181
Validation loss decreased (-0.150555 --> -0.181144).  Saving model ...
Epoch: 9 cost time: 0.454085111618042
Epoch: 9, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.312 Vali Acc: 0.191 Test Loss: 3.312 Test Acc: 0.191
Validation loss decreased (-0.181144 --> -0.190555).  Saving model ...
Epoch: 10 cost time: 0.4434337615966797
Epoch: 10, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.348 Vali Acc: 0.191 Test Loss: 3.348 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46178483963012695
Epoch: 11, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.388 Vali Acc: 0.201 Test Loss: 3.388 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201143).  Saving model ...
Epoch: 12 cost time: 0.462116003036499
Epoch: 12, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.389 Vali Acc: 0.212 Test Loss: 3.389 Test Acc: 0.212
Validation loss decreased (-0.201143 --> -0.211731).  Saving model ...
Epoch: 13 cost time: 0.4532887935638428
Epoch: 13, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.489 Vali Acc: 0.232 Test Loss: 3.489 Test Acc: 0.232
Validation loss decreased (-0.211731 --> -0.231730).  Saving model ...
Epoch: 14 cost time: 0.39653706550598145
Epoch: 14, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.569 Vali Acc: 0.231 Test Loss: 3.569 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4115614891052246
Epoch: 15, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.633 Vali Acc: 0.238 Test Loss: 3.633 Test Acc: 0.238
Validation loss decreased (-0.231730 --> -0.237611).  Saving model ...
Epoch: 16 cost time: 0.46434521675109863
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.751 Vali Acc: 0.236 Test Loss: 3.751 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.44545435905456543
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.822 Vali Acc: 0.244 Test Loss: 3.822 Test Acc: 0.244
Validation loss decreased (-0.237611 --> -0.243491).  Saving model ...
Epoch: 18 cost time: 0.46347761154174805
Epoch: 18, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.916 Vali Acc: 0.251 Test Loss: 3.916 Test Acc: 0.251
Validation loss decreased (-0.243491 --> -0.250549).  Saving model ...
Epoch: 19 cost time: 0.4846012592315674
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.958 Vali Acc: 0.246 Test Loss: 3.958 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.414522647857666
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.003 Vali Acc: 0.241 Test Loss: 4.003 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4543426036834717
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.131 Vali Acc: 0.245 Test Loss: 4.131 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4772171974182129
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.189 Vali Acc: 0.245 Test Loss: 4.189 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5138416290283203
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.268 Vali Acc: 0.246 Test Loss: 4.268 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5503973960876465
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.311 Vali Acc: 0.252 Test Loss: 4.311 Test Acc: 0.252
Validation loss decreased (-0.250549 --> -0.251722).  Saving model ...
Epoch: 25 cost time: 0.45081162452697754
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.325 Vali Acc: 0.251 Test Loss: 4.325 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.503082275390625
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.354 Vali Acc: 0.248 Test Loss: 4.354 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4593179225921631
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.376 Vali Acc: 0.256 Test Loss: 4.376 Test Acc: 0.256
Validation loss decreased (-0.251722 --> -0.256427).  Saving model ...
Epoch: 28 cost time: 0.47812461853027344
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.437 Vali Acc: 0.248 Test Loss: 4.437 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5104861259460449
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.445 Vali Acc: 0.251 Test Loss: 4.445 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.48679089546203613
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.452 Vali Acc: 0.258 Test Loss: 4.452 Test Acc: 0.258
Validation loss decreased (-0.256427 --> -0.257603).  Saving model ...
Epoch: 31 cost time: 0.5222156047821045
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.480 Vali Acc: 0.254 Test Loss: 4.480 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4754667282104492
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.495 Vali Acc: 0.254 Test Loss: 4.495 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4676976203918457
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.519 Vali Acc: 0.260 Test Loss: 4.519 Test Acc: 0.260
Validation loss decreased (-0.257603 --> -0.259955).  Saving model ...
Epoch: 34 cost time: 0.4506034851074219
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.546 Vali Acc: 0.259 Test Loss: 4.546 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5057263374328613
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.560 Vali Acc: 0.258 Test Loss: 4.560 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4889674186706543
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.577 Vali Acc: 0.254 Test Loss: 4.577 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.41133785247802734
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.588 Vali Acc: 0.256 Test Loss: 4.588 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4620051383972168
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.596 Vali Acc: 0.264 Test Loss: 4.596 Test Acc: 0.264
Validation loss decreased (-0.259955 --> -0.263483).  Saving model ...
Epoch: 39 cost time: 0.4181327819824219
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.618 Vali Acc: 0.265 Test Loss: 4.618 Test Acc: 0.265
Validation loss decreased (-0.263483 --> -0.264660).  Saving model ...
Epoch: 40 cost time: 0.4726290702819824
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.264 Test Loss: 4.630 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.46980953216552734
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.655 Vali Acc: 0.261 Test Loss: 4.655 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4553256034851074
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.673 Vali Acc: 0.259 Test Loss: 4.673 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4707603454589844
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.681 Vali Acc: 0.260 Test Loss: 4.681 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5515210628509521
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.697 Vali Acc: 0.261 Test Loss: 4.697 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4669313430786133
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.707 Vali Acc: 0.264 Test Loss: 4.707 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.49480438232421875
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.708 Vali Acc: 0.268 Test Loss: 4.708 Test Acc: 0.268
Validation loss decreased (-0.264660 --> -0.268188).  Saving model ...
Epoch: 47 cost time: 0.44933462142944336
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.718 Vali Acc: 0.268 Test Loss: 4.718 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4552133083343506
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.737 Vali Acc: 0.271 Test Loss: 4.737 Test Acc: 0.271
Validation loss decreased (-0.268188 --> -0.270541).  Saving model ...
Epoch: 49 cost time: 0.49790024757385254
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.764 Vali Acc: 0.269 Test Loss: 4.764 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4744877815246582
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.771 Vali Acc: 0.267 Test Loss: 4.771 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5109968185424805
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.785 Vali Acc: 0.272 Test Loss: 4.785 Test Acc: 0.272
Validation loss decreased (-0.270541 --> -0.271717).  Saving model ...
Epoch: 52 cost time: 0.5069429874420166
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.793 Vali Acc: 0.268 Test Loss: 4.793 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.49348926544189453
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.813 Vali Acc: 0.269 Test Loss: 4.813 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5164780616760254
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.818 Vali Acc: 0.268 Test Loss: 4.818 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.43811798095703125
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.828 Vali Acc: 0.264 Test Loss: 4.828 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.47835850715637207
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.841 Vali Acc: 0.264 Test Loss: 4.841 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.45262718200683594
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.859 Vali Acc: 0.267 Test Loss: 4.859 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5081450939178467
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.875 Vali Acc: 0.266 Test Loss: 4.875 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.511584997177124
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.875 Vali Acc: 0.268 Test Loss: 4.875 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.4575810432434082
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.886 Vali Acc: 0.266 Test Loss: 4.886 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.4521002769470215
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.891 Vali Acc: 0.271 Test Loss: 4.891 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 192666
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4518945217132568
Epoch: 1, Steps: 10 | Train Loss: 3.465 Vali Loss: 3.340 Vali Acc: 0.051 Test Loss: 3.340 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.44647955894470215
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.313 Vali Acc: 0.053 Test Loss: 3.313 Test Acc: 0.053
Validation loss decreased (-0.050555 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.4363105297088623
Epoch: 3, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.319 Vali Acc: 0.064 Test Loss: 3.319 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.48287367820739746
Epoch: 4, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.321 Vali Acc: 0.084 Test Loss: 3.321 Test Acc: 0.084
Validation loss decreased (-0.063496 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.4414794445037842
Epoch: 5, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.296 Vali Acc: 0.104 Test Loss: 3.296 Test Acc: 0.104
Validation loss decreased (-0.083496 --> -0.103496).  Saving model ...
Epoch: 6 cost time: 0.4557509422302246
Epoch: 6, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.266 Vali Acc: 0.119 Test Loss: 3.266 Test Acc: 0.119
Validation loss decreased (-0.103496 --> -0.118791).  Saving model ...
Epoch: 7 cost time: 0.44774460792541504
Epoch: 7, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.264 Vali Acc: 0.141 Test Loss: 3.264 Test Acc: 0.141
Validation loss decreased (-0.118791 --> -0.141144).  Saving model ...
Epoch: 8 cost time: 0.48791050910949707
Epoch: 8, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.242 Vali Acc: 0.162 Test Loss: 3.242 Test Acc: 0.162
Validation loss decreased (-0.141144 --> -0.162321).  Saving model ...
Epoch: 9 cost time: 0.4834277629852295
Epoch: 9, Steps: 10 | Train Loss: 1.668 Vali Loss: 3.249 Vali Acc: 0.174 Test Loss: 3.249 Test Acc: 0.174
Validation loss decreased (-0.162321 --> -0.174085).  Saving model ...
Epoch: 10 cost time: 0.4609203338623047
Epoch: 10, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.271 Vali Acc: 0.188 Test Loss: 3.271 Test Acc: 0.188
Validation loss decreased (-0.174085 --> -0.188203).  Saving model ...
Epoch: 11 cost time: 0.4717891216278076
Epoch: 11, Steps: 10 | Train Loss: 1.259 Vali Loss: 3.299 Vali Acc: 0.202 Test Loss: 3.299 Test Acc: 0.202
Validation loss decreased (-0.188203 --> -0.202320).  Saving model ...
Epoch: 12 cost time: 0.4759538173675537
Epoch: 12, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.338 Vali Acc: 0.221 Test Loss: 3.338 Test Acc: 0.221
Validation loss decreased (-0.202320 --> -0.221143).  Saving model ...
Epoch: 13 cost time: 0.4673807621002197
Epoch: 13, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.378 Vali Acc: 0.227 Test Loss: 3.378 Test Acc: 0.227
Validation loss decreased (-0.221143 --> -0.227025).  Saving model ...
Epoch: 14 cost time: 0.5319724082946777
Epoch: 14, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.412 Vali Acc: 0.233 Test Loss: 3.412 Test Acc: 0.233
Validation loss decreased (-0.227025 --> -0.232907).  Saving model ...
Epoch: 15 cost time: 0.5450358390808105
Epoch: 15, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.489 Vali Acc: 0.241 Test Loss: 3.489 Test Acc: 0.241
Validation loss decreased (-0.232907 --> -0.241142).  Saving model ...
Epoch: 16 cost time: 0.447676420211792
Epoch: 16, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.531 Vali Acc: 0.231 Test Loss: 3.531 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.434051513671875
Epoch: 17, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.603 Vali Acc: 0.245 Test Loss: 3.603 Test Acc: 0.245
Validation loss decreased (-0.241142 --> -0.244670).  Saving model ...
Epoch: 18 cost time: 0.4478578567504883
Epoch: 18, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.670 Vali Acc: 0.251 Test Loss: 3.670 Test Acc: 0.251
Validation loss decreased (-0.244670 --> -0.250552).  Saving model ...
Epoch: 19 cost time: 0.4776325225830078
Epoch: 19, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.763 Vali Acc: 0.239 Test Loss: 3.763 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4284219741821289
Epoch: 20, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.855 Vali Acc: 0.240 Test Loss: 3.855 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4963257312774658
Epoch: 21, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.928 Vali Acc: 0.241 Test Loss: 3.928 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5002765655517578
Epoch: 22, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.969 Vali Acc: 0.248 Test Loss: 3.969 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.44493699073791504
Epoch: 23, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.006 Vali Acc: 0.255 Test Loss: 4.006 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255254).  Saving model ...
Epoch: 24 cost time: 0.4714818000793457
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.077 Vali Acc: 0.245 Test Loss: 4.077 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.48528409004211426
Epoch: 25, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.094 Vali Acc: 0.247 Test Loss: 4.094 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.47847509384155273
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.136 Vali Acc: 0.252 Test Loss: 4.136 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.45851588249206543
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.187 Vali Acc: 0.244 Test Loss: 4.187 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4392366409301758
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.218 Vali Acc: 0.246 Test Loss: 4.218 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5131747722625732
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.228 Vali Acc: 0.241 Test Loss: 4.228 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4776136875152588
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.275 Vali Acc: 0.245 Test Loss: 4.275 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.46367812156677246
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.302 Vali Acc: 0.249 Test Loss: 4.302 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4814274311065674
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.336 Vali Acc: 0.255 Test Loss: 4.336 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5036914348602295
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.380 Vali Acc: 0.251 Test Loss: 4.380 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 162970
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.651780366897583
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.350 Vali Acc: 0.040 Test Loss: 3.350 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.45946383476257324
Epoch: 2, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.335 Vali Acc: 0.044 Test Loss: 3.335 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.4405174255371094
Epoch: 3, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.319 Vali Acc: 0.069 Test Loss: 3.319 Test Acc: 0.069
Validation loss decreased (-0.043496 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 0.44440364837646484
Epoch: 4, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.309 Vali Acc: 0.076 Test Loss: 3.309 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.439955472946167
Epoch: 5, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.303 Vali Acc: 0.087 Test Loss: 3.303 Test Acc: 0.087
Validation loss decreased (-0.076437 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 0.46900510787963867
Epoch: 6, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.294 Vali Acc: 0.105 Test Loss: 3.294 Test Acc: 0.105
Validation loss decreased (-0.087026 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.41839599609375
Epoch: 7, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.294 Vali Acc: 0.112 Test Loss: 3.294 Test Acc: 0.112
Validation loss decreased (-0.104673 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.5044934749603271
Epoch: 8, Steps: 10 | Train Loss: 2.163 Vali Loss: 3.278 Vali Acc: 0.122 Test Loss: 3.278 Test Acc: 0.122
Validation loss decreased (-0.111732 --> -0.122320).  Saving model ...
Epoch: 9 cost time: 0.47182774543762207
Epoch: 9, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.251 Vali Acc: 0.140 Test Loss: 3.251 Test Acc: 0.140
Validation loss decreased (-0.122320 --> -0.139967).  Saving model ...
Epoch: 10 cost time: 0.48782992362976074
Epoch: 10, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.253 Vali Acc: 0.145 Test Loss: 3.253 Test Acc: 0.145
Validation loss decreased (-0.139967 --> -0.144673).  Saving model ...
Epoch: 11 cost time: 0.44683837890625
Epoch: 11, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.258 Vali Acc: 0.155 Test Loss: 3.258 Test Acc: 0.155
Validation loss decreased (-0.144673 --> -0.155262).  Saving model ...
Epoch: 12 cost time: 0.4882636070251465
Epoch: 12, Steps: 10 | Train Loss: 1.445 Vali Loss: 3.288 Vali Acc: 0.164 Test Loss: 3.288 Test Acc: 0.164
Validation loss decreased (-0.155262 --> -0.163497).  Saving model ...
Epoch: 13 cost time: 0.48142457008361816
Epoch: 13, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.315 Vali Acc: 0.172 Test Loss: 3.315 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 14 cost time: 0.4547266960144043
Epoch: 14, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.356 Vali Acc: 0.180 Test Loss: 3.356 Test Acc: 0.180
Validation loss decreased (-0.171732 --> -0.179966).  Saving model ...
Epoch: 15 cost time: 0.47686171531677246
Epoch: 15, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.375 Vali Acc: 0.182 Test Loss: 3.375 Test Acc: 0.182
Validation loss decreased (-0.179966 --> -0.182319).  Saving model ...
Epoch: 16 cost time: 0.46860837936401367
Epoch: 16, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.412 Vali Acc: 0.195 Test Loss: 3.412 Test Acc: 0.195
Validation loss decreased (-0.182319 --> -0.195260).  Saving model ...
Epoch: 17 cost time: 0.4603910446166992
Epoch: 17, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.453 Vali Acc: 0.204 Test Loss: 3.453 Test Acc: 0.204
Validation loss decreased (-0.195260 --> -0.203495).  Saving model ...
Epoch: 18 cost time: 0.5399458408355713
Epoch: 18, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.523 Vali Acc: 0.212 Test Loss: 3.523 Test Acc: 0.212
Validation loss decreased (-0.203495 --> -0.211729).  Saving model ...
Epoch: 19 cost time: 0.4912600517272949
Epoch: 19, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.581 Vali Acc: 0.219 Test Loss: 3.581 Test Acc: 0.219
Validation loss decreased (-0.211729 --> -0.218788).  Saving model ...
Epoch: 20 cost time: 0.47547006607055664
Epoch: 20, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.613 Vali Acc: 0.218 Test Loss: 3.613 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47084927558898926
Epoch: 21, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.665 Vali Acc: 0.222 Test Loss: 3.665 Test Acc: 0.222
Validation loss decreased (-0.218788 --> -0.222316).  Saving model ...
Epoch: 22 cost time: 0.43993520736694336
Epoch: 22, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.738 Vali Acc: 0.226 Test Loss: 3.738 Test Acc: 0.226
Validation loss decreased (-0.222316 --> -0.225845).  Saving model ...
Epoch: 23 cost time: 0.4781181812286377
Epoch: 23, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.796 Vali Acc: 0.225 Test Loss: 3.796 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5036914348602295
Epoch: 24, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.836 Vali Acc: 0.226 Test Loss: 3.836 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.44997143745422363
Epoch: 25, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.889 Vali Acc: 0.228 Test Loss: 3.889 Test Acc: 0.228
Validation loss decreased (-0.225845 --> -0.228196).  Saving model ...
Epoch: 26 cost time: 0.4516134262084961
Epoch: 26, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.924 Vali Acc: 0.235 Test Loss: 3.924 Test Acc: 0.235
Validation loss decreased (-0.228196 --> -0.235255).  Saving model ...
Epoch: 27 cost time: 0.42889952659606934
Epoch: 27, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.963 Vali Acc: 0.238 Test Loss: 3.963 Test Acc: 0.238
Validation loss decreased (-0.235255 --> -0.237607).  Saving model ...
Epoch: 28 cost time: 0.46393871307373047
Epoch: 28, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.025 Vali Acc: 0.236 Test Loss: 4.025 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4634842872619629
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.027 Vali Acc: 0.239 Test Loss: 4.027 Test Acc: 0.239
Validation loss decreased (-0.237607 --> -0.238783).  Saving model ...
Epoch: 30 cost time: 0.4145169258117676
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.031 Vali Acc: 0.244 Test Loss: 4.031 Test Acc: 0.244
Validation loss decreased (-0.238783 --> -0.243489).  Saving model ...
Epoch: 31 cost time: 0.45462775230407715
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.064 Vali Acc: 0.241 Test Loss: 4.064 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4455125331878662
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.094 Vali Acc: 0.242 Test Loss: 4.094 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4301338195800781
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.124 Vali Acc: 0.238 Test Loss: 4.124 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4672996997833252
Epoch: 34, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.147 Vali Acc: 0.240 Test Loss: 4.147 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4445617198944092
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.154 Vali Acc: 0.245 Test Loss: 4.154 Test Acc: 0.245
Validation loss decreased (-0.243489 --> -0.244664).  Saving model ...
Epoch: 36 cost time: 0.454193115234375
Epoch: 36, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.168 Vali Acc: 0.247 Test Loss: 4.168 Test Acc: 0.247
Validation loss decreased (-0.244664 --> -0.247017).  Saving model ...
Epoch: 37 cost time: 0.48670125007629395
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.189 Vali Acc: 0.248 Test Loss: 4.189 Test Acc: 0.248
Validation loss decreased (-0.247017 --> -0.248193).  Saving model ...
Epoch: 38 cost time: 0.4285285472869873
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.219 Vali Acc: 0.254 Test Loss: 4.219 Test Acc: 0.254
Validation loss decreased (-0.248193 --> -0.254075).  Saving model ...
Epoch: 39 cost time: 0.48366880416870117
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.237 Vali Acc: 0.252 Test Loss: 4.237 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5009310245513916
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.255 Vali Acc: 0.251 Test Loss: 4.255 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.47574663162231445
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.275 Vali Acc: 0.252 Test Loss: 4.275 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4848010540008545
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.298 Vali Acc: 0.248 Test Loss: 4.298 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.48996591567993164
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.307 Vali Acc: 0.251 Test Loss: 4.307 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4795069694519043
Epoch: 44, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.310 Vali Acc: 0.253 Test Loss: 4.310 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4874088764190674
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.329 Vali Acc: 0.254 Test Loss: 4.329 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5133185386657715
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.334 Vali Acc: 0.258 Test Loss: 4.334 Test Acc: 0.258
Validation loss decreased (-0.254075 --> -0.257604).  Saving model ...
Epoch: 47 cost time: 0.4510629177093506
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.348 Vali Acc: 0.264 Test Loss: 4.348 Test Acc: 0.264
Validation loss decreased (-0.257604 --> -0.263486).  Saving model ...
Epoch: 48 cost time: 0.4506723880767822
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.359 Vali Acc: 0.264 Test Loss: 4.359 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.43501830101013184
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.374 Vali Acc: 0.262 Test Loss: 4.374 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.44562697410583496
Epoch: 50, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.377 Vali Acc: 0.260 Test Loss: 4.377 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4711918830871582
Epoch: 51, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.390 Vali Acc: 0.258 Test Loss: 4.390 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.4711785316467285
Epoch: 52, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.411 Vali Acc: 0.256 Test Loss: 4.411 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4512052536010742
Epoch: 53, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.415 Vali Acc: 0.260 Test Loss: 4.415 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.4553685188293457
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.428 Vali Acc: 0.259 Test Loss: 4.428 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.4388267993927002
Epoch: 55, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.436 Vali Acc: 0.259 Test Loss: 4.436 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.47202372550964355
Epoch: 56, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.437 Vali Acc: 0.259 Test Loss: 4.437 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.4565918445587158
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.450 Vali Acc: 0.261 Test Loss: 4.450 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 128474
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7025260925292969
Epoch: 1, Steps: 10 | Train Loss: 3.383 Vali Loss: 3.333 Vali Acc: 0.040 Test Loss: 3.333 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.4368324279785156
Epoch: 2, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.316 Vali Acc: 0.049 Test Loss: 3.316 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.4048500061035156
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.305 Vali Acc: 0.058 Test Loss: 3.305 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.3904387950897217
Epoch: 4, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.298 Vali Acc: 0.065 Test Loss: 3.298 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.44089412689208984
Epoch: 5, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.291 Vali Acc: 0.075 Test Loss: 3.291 Test Acc: 0.075
Validation loss decreased (-0.064673 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.4937126636505127
Epoch: 6, Steps: 10 | Train Loss: 2.761 Vali Loss: 3.285 Vali Acc: 0.088 Test Loss: 3.285 Test Acc: 0.088
Validation loss decreased (-0.075261 --> -0.088202).  Saving model ...
Epoch: 7 cost time: 0.4735605716705322
Epoch: 7, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.277 Vali Acc: 0.100 Test Loss: 3.277 Test Acc: 0.100
Validation loss decreased (-0.088202 --> -0.099967).  Saving model ...
Epoch: 8 cost time: 0.45601558685302734
Epoch: 8, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.263 Vali Acc: 0.125 Test Loss: 3.263 Test Acc: 0.125
Validation loss decreased (-0.099967 --> -0.124673).  Saving model ...
Epoch: 9 cost time: 0.4884665012359619
Epoch: 9, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.250 Vali Acc: 0.132 Test Loss: 3.250 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 0.5165722370147705
Epoch: 10, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.240 Vali Acc: 0.141 Test Loss: 3.240 Test Acc: 0.141
Validation loss decreased (-0.131732 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 0.4614906311035156
Epoch: 11, Steps: 10 | Train Loss: 1.920 Vali Loss: 3.247 Vali Acc: 0.156 Test Loss: 3.247 Test Acc: 0.156
Validation loss decreased (-0.141144 --> -0.156438).  Saving model ...
Epoch: 12 cost time: 0.42610716819763184
Epoch: 12, Steps: 10 | Train Loss: 1.796 Vali Loss: 3.257 Vali Acc: 0.160 Test Loss: 3.257 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 13 cost time: 0.43294572830200195
Epoch: 13, Steps: 10 | Train Loss: 1.592 Vali Loss: 3.272 Vali Acc: 0.162 Test Loss: 3.272 Test Acc: 0.162
Validation loss decreased (-0.159967 --> -0.162320).  Saving model ...
Epoch: 14 cost time: 0.47072482109069824
Epoch: 14, Steps: 10 | Train Loss: 1.476 Vali Loss: 3.288 Vali Acc: 0.167 Test Loss: 3.288 Test Acc: 0.167
Validation loss decreased (-0.162320 --> -0.167026).  Saving model ...
Epoch: 15 cost time: 0.451749324798584
Epoch: 15, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.306 Vali Acc: 0.173 Test Loss: 3.306 Test Acc: 0.173
Validation loss decreased (-0.167026 --> -0.172908).  Saving model ...
Epoch: 16 cost time: 0.4632890224456787
Epoch: 16, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.341 Vali Acc: 0.182 Test Loss: 3.341 Test Acc: 0.182
Validation loss decreased (-0.172908 --> -0.182320).  Saving model ...
Epoch: 17 cost time: 0.4803321361541748
Epoch: 17, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.374 Vali Acc: 0.189 Test Loss: 3.374 Test Acc: 0.189
Validation loss decreased (-0.182320 --> -0.189378).  Saving model ...
Epoch: 18 cost time: 0.45372796058654785
Epoch: 18, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.403 Vali Acc: 0.187 Test Loss: 3.403 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.433762788772583
Epoch: 19, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.441 Vali Acc: 0.192 Test Loss: 3.441 Test Acc: 0.192
Validation loss decreased (-0.189378 --> -0.191730).  Saving model ...
Epoch: 20 cost time: 0.45186519622802734
Epoch: 20, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.459 Vali Acc: 0.200 Test Loss: 3.459 Test Acc: 0.200
Validation loss decreased (-0.191730 --> -0.199965).  Saving model ...
Epoch: 21 cost time: 0.47438502311706543
Epoch: 21, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.512 Vali Acc: 0.207 Test Loss: 3.512 Test Acc: 0.207
Validation loss decreased (-0.199965 --> -0.207024).  Saving model ...
Epoch: 22 cost time: 0.47078680992126465
Epoch: 22, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.574 Vali Acc: 0.207 Test Loss: 3.574 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.489837646484375
Epoch: 23, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.655 Vali Acc: 0.208 Test Loss: 3.655 Test Acc: 0.208
Validation loss decreased (-0.207024 --> -0.208199).  Saving model ...
Epoch: 24 cost time: 0.4385108947753906
Epoch: 24, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.686 Vali Acc: 0.215 Test Loss: 3.686 Test Acc: 0.215
Validation loss decreased (-0.208199 --> -0.215257).  Saving model ...
Epoch: 25 cost time: 0.4839286804199219
Epoch: 25, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.772 Vali Acc: 0.213 Test Loss: 3.772 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5209498405456543
Epoch: 26, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.804 Vali Acc: 0.214 Test Loss: 3.804 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4803040027618408
Epoch: 27, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.827 Vali Acc: 0.220 Test Loss: 3.827 Test Acc: 0.220
Validation loss decreased (-0.215257 --> -0.219962).  Saving model ...
Epoch: 28 cost time: 0.521324872970581
Epoch: 28, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.891 Vali Acc: 0.215 Test Loss: 3.891 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4618546962738037
Epoch: 29, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.928 Vali Acc: 0.225 Test Loss: 3.928 Test Acc: 0.225
Validation loss decreased (-0.219962 --> -0.224667).  Saving model ...
Epoch: 30 cost time: 0.5060594081878662
Epoch: 30, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.955 Vali Acc: 0.226 Test Loss: 3.955 Test Acc: 0.226
Validation loss decreased (-0.224667 --> -0.225843).  Saving model ...
Epoch: 31 cost time: 0.5018706321716309
Epoch: 31, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.994 Vali Acc: 0.238 Test Loss: 3.994 Test Acc: 0.238
Validation loss decreased (-0.225843 --> -0.237607).  Saving model ...
Epoch: 32 cost time: 0.5166869163513184
Epoch: 32, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.025 Vali Acc: 0.235 Test Loss: 4.025 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.528550386428833
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.049 Vali Acc: 0.233 Test Loss: 4.049 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4724292755126953
Epoch: 34, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.075 Vali Acc: 0.231 Test Loss: 4.075 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4980895519256592
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.098 Vali Acc: 0.228 Test Loss: 4.098 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4282693862915039
Epoch: 36, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.113 Vali Acc: 0.235 Test Loss: 4.113 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4607667922973633
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.146 Vali Acc: 0.228 Test Loss: 4.146 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.42542529106140137
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.168 Vali Acc: 0.225 Test Loss: 4.168 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4626491069793701
Epoch: 39, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.171 Vali Acc: 0.228 Test Loss: 4.171 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4681525230407715
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.216 Vali Acc: 0.228 Test Loss: 4.216 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.42493224143981934
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.230 Vali Acc: 0.229 Test Loss: 4.230 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2376470588235294
model parameter : 114010
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6740727424621582
Epoch: 1, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.405 Vali Acc: 0.034 Test Loss: 3.405 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.5040183067321777
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.366 Vali Acc: 0.041 Test Loss: 3.366 Test Acc: 0.041
Validation loss decreased (-0.034084 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.4806993007659912
Epoch: 3, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.340 Vali Acc: 0.045 Test Loss: 3.340 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044672).  Saving model ...
Epoch: 4 cost time: 0.5266144275665283
Epoch: 4, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.319 Vali Acc: 0.062 Test Loss: 3.319 Test Acc: 0.062
Validation loss decreased (-0.044672 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.41125965118408203
Epoch: 5, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.302 Vali Acc: 0.081 Test Loss: 3.302 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 0.45812487602233887
Epoch: 6, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.289 Vali Acc: 0.085 Test Loss: 3.289 Test Acc: 0.085
Validation loss decreased (-0.081143 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.448559045791626
Epoch: 7, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.282 Vali Acc: 0.095 Test Loss: 3.282 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095261).  Saving model ...
Epoch: 8 cost time: 0.4732954502105713
Epoch: 8, Steps: 10 | Train Loss: 2.481 Vali Loss: 3.275 Vali Acc: 0.105 Test Loss: 3.275 Test Acc: 0.105
Validation loss decreased (-0.095261 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.5136289596557617
Epoch: 9, Steps: 10 | Train Loss: 2.330 Vali Loss: 3.270 Vali Acc: 0.111 Test Loss: 3.270 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 0.40235066413879395
Epoch: 10, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.264 Vali Acc: 0.119 Test Loss: 3.264 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 0.49857664108276367
Epoch: 11, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.263 Vali Acc: 0.138 Test Loss: 3.263 Test Acc: 0.138
Validation loss decreased (-0.118791 --> -0.137614).  Saving model ...
Epoch: 12 cost time: 0.450486421585083
Epoch: 12, Steps: 10 | Train Loss: 1.847 Vali Loss: 3.265 Vali Acc: 0.146 Test Loss: 3.265 Test Acc: 0.146
Validation loss decreased (-0.137614 --> -0.145850).  Saving model ...
Epoch: 13 cost time: 0.37598109245300293
Epoch: 13, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.275 Vali Acc: 0.152 Test Loss: 3.275 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 14 cost time: 0.4557163715362549
Epoch: 14, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.278 Vali Acc: 0.168 Test Loss: 3.278 Test Acc: 0.168
Validation loss decreased (-0.151732 --> -0.168203).  Saving model ...
Epoch: 15 cost time: 0.43227696418762207
Epoch: 15, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.301 Vali Acc: 0.167 Test Loss: 3.301 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4573862552642822
Epoch: 16, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.326 Vali Acc: 0.176 Test Loss: 3.326 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176437).  Saving model ...
Epoch: 17 cost time: 0.4293041229248047
Epoch: 17, Steps: 10 | Train Loss: 1.201 Vali Loss: 3.347 Vali Acc: 0.189 Test Loss: 3.347 Test Acc: 0.189
Validation loss decreased (-0.176437 --> -0.189378).  Saving model ...
Epoch: 18 cost time: 0.4578683376312256
Epoch: 18, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.359 Vali Acc: 0.189 Test Loss: 3.359 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.44724440574645996
Epoch: 19, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.380 Vali Acc: 0.198 Test Loss: 3.380 Test Acc: 0.198
Validation loss decreased (-0.189378 --> -0.197613).  Saving model ...
Epoch: 20 cost time: 0.4375193119049072
Epoch: 20, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.402 Vali Acc: 0.199 Test Loss: 3.402 Test Acc: 0.199
Validation loss decreased (-0.197613 --> -0.198790).  Saving model ...
Epoch: 21 cost time: 0.43213987350463867
Epoch: 21, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.445 Vali Acc: 0.206 Test Loss: 3.445 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205848).  Saving model ...
Epoch: 22 cost time: 0.43180179595947266
Epoch: 22, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.480 Vali Acc: 0.212 Test Loss: 3.480 Test Acc: 0.212
Validation loss decreased (-0.205848 --> -0.211730).  Saving model ...
Epoch: 23 cost time: 0.4608747959136963
Epoch: 23, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.510 Vali Acc: 0.215 Test Loss: 3.510 Test Acc: 0.215
Validation loss decreased (-0.211730 --> -0.215259).  Saving model ...
Epoch: 24 cost time: 0.4323892593383789
Epoch: 24, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.548 Vali Acc: 0.216 Test Loss: 3.548 Test Acc: 0.216
Validation loss decreased (-0.215259 --> -0.216435).  Saving model ...
Epoch: 25 cost time: 0.47676730155944824
Epoch: 25, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.574 Vali Acc: 0.219 Test Loss: 3.574 Test Acc: 0.219
Validation loss decreased (-0.216435 --> -0.218788).  Saving model ...
Epoch: 26 cost time: 0.48905491828918457
Epoch: 26, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.618 Vali Acc: 0.220 Test Loss: 3.618 Test Acc: 0.220
Validation loss decreased (-0.218788 --> -0.219964).  Saving model ...
Epoch: 27 cost time: 0.48147058486938477
Epoch: 27, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.687 Vali Acc: 0.222 Test Loss: 3.687 Test Acc: 0.222
Validation loss decreased (-0.219964 --> -0.222316).  Saving model ...
Epoch: 28 cost time: 0.4689946174621582
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.697 Vali Acc: 0.226 Test Loss: 3.697 Test Acc: 0.226
Validation loss decreased (-0.222316 --> -0.225845).  Saving model ...
Epoch: 29 cost time: 0.38869190216064453
Epoch: 29, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.705 Vali Acc: 0.242 Test Loss: 3.705 Test Acc: 0.242
Validation loss decreased (-0.225845 --> -0.242316).  Saving model ...
Epoch: 30 cost time: 0.45519089698791504
Epoch: 30, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.723 Vali Acc: 0.239 Test Loss: 3.723 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.46389150619506836
Epoch: 31, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.770 Vali Acc: 0.238 Test Loss: 3.770 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.48471856117248535
Epoch: 32, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.799 Vali Acc: 0.235 Test Loss: 3.799 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.48034214973449707
Epoch: 33, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.815 Vali Acc: 0.236 Test Loss: 3.815 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4787890911102295
Epoch: 34, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.845 Vali Acc: 0.241 Test Loss: 3.845 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.423419713973999
Epoch: 35, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.875 Vali Acc: 0.240 Test Loss: 3.875 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.45593833923339844
Epoch: 36, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.887 Vali Acc: 0.239 Test Loss: 3.887 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4650852680206299
Epoch: 37, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.895 Vali Acc: 0.240 Test Loss: 3.895 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4855196475982666
Epoch: 38, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.903 Vali Acc: 0.249 Test Loss: 3.903 Test Acc: 0.249
Validation loss decreased (-0.242316 --> -0.249373).  Saving model ...
Epoch: 39 cost time: 0.44245171546936035
Epoch: 39, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.913 Vali Acc: 0.247 Test Loss: 3.913 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4740898609161377
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.951 Vali Acc: 0.252 Test Loss: 3.951 Test Acc: 0.252
Validation loss decreased (-0.249373 --> -0.251725).  Saving model ...
Epoch: 41 cost time: 0.45197296142578125
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.970 Vali Acc: 0.254 Test Loss: 3.970 Test Acc: 0.254
Validation loss decreased (-0.251725 --> -0.254078).  Saving model ...
Epoch: 42 cost time: 0.48882627487182617
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.996 Vali Acc: 0.255 Test Loss: 3.996 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255254).  Saving model ...
Epoch: 43 cost time: 0.46152567863464355
Epoch: 43, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.009 Vali Acc: 0.254 Test Loss: 4.009 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.43918871879577637
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.015 Vali Acc: 0.251 Test Loss: 4.015 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4345681667327881
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.004 Vali Acc: 0.248 Test Loss: 4.004 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4144573211669922
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.023 Vali Acc: 0.249 Test Loss: 4.023 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4672815799713135
Epoch: 47, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.036 Vali Acc: 0.251 Test Loss: 4.036 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.43528127670288086
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.043 Vali Acc: 0.255 Test Loss: 4.043 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5259222984313965
Epoch: 49, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.056 Vali Acc: 0.254 Test Loss: 4.056 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.49079370498657227
Epoch: 50, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.071 Vali Acc: 0.252 Test Loss: 4.071 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.48179125785827637
Epoch: 51, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.094 Vali Acc: 0.253 Test Loss: 4.094 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.4487569332122803
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.098 Vali Acc: 0.256 Test Loss: 4.098 Test Acc: 0.256
Validation loss decreased (-0.255254 --> -0.256430).  Saving model ...
Epoch: 53 cost time: 0.4313466548919678
Epoch: 53, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.120 Vali Acc: 0.256 Test Loss: 4.120 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.464524507522583
Epoch: 54, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.138 Vali Acc: 0.261 Test Loss: 4.138 Test Acc: 0.261
Validation loss decreased (-0.256430 --> -0.261135).  Saving model ...
Epoch: 55 cost time: 0.471390962600708
Epoch: 55, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.139 Vali Acc: 0.256 Test Loss: 4.139 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.47681403160095215
Epoch: 56, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.139 Vali Acc: 0.253 Test Loss: 4.139 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.47331881523132324
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.146 Vali Acc: 0.259 Test Loss: 4.146 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.47322821617126465
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.152 Vali Acc: 0.258 Test Loss: 4.152 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.4381411075592041
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.169 Vali Acc: 0.258 Test Loss: 4.169 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.4859330654144287
Epoch: 60, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.179 Vali Acc: 0.258 Test Loss: 4.179 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.4635658264160156
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.189 Vali Acc: 0.259 Test Loss: 4.189 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.43299221992492676
Epoch: 62, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.201 Vali Acc: 0.255 Test Loss: 4.201 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.41976118087768555
Epoch: 63, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.222 Vali Acc: 0.256 Test Loss: 4.222 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5098061561584473
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.225 Vali Acc: 0.256 Test Loss: 4.225 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 109466
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5947821140289307
Epoch: 1, Steps: 10 | Train Loss: 3.512 Vali Loss: 3.360 Vali Acc: 0.040 Test Loss: 3.360 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4051778316497803
Epoch: 2, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.415 Vali Acc: 0.061 Test Loss: 3.415 Test Acc: 0.061
Validation loss decreased (-0.039966 --> -0.061142).  Saving model ...
Epoch: 3 cost time: 0.4637739658355713
Epoch: 3, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.289 Vali Acc: 0.133 Test Loss: 3.289 Test Acc: 0.133
Validation loss decreased (-0.061142 --> -0.132908).  Saving model ...
Epoch: 4 cost time: 0.5315649509429932
Epoch: 4, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.221 Vali Acc: 0.148 Test Loss: 3.221 Test Acc: 0.148
Validation loss decreased (-0.132908 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 0.47780871391296387
Epoch: 5, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.365 Vali Acc: 0.175 Test Loss: 3.365 Test Acc: 0.175
Validation loss decreased (-0.148203 --> -0.175260).  Saving model ...
Epoch: 6 cost time: 0.4580569267272949
Epoch: 6, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.388 Vali Acc: 0.202 Test Loss: 3.388 Test Acc: 0.202
Validation loss decreased (-0.175260 --> -0.202319).  Saving model ...
Epoch: 7 cost time: 0.5084302425384521
Epoch: 7, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.576 Vali Acc: 0.206 Test Loss: 3.576 Test Acc: 0.206
Validation loss decreased (-0.202319 --> -0.205847).  Saving model ...
Epoch: 8 cost time: 0.5209016799926758
Epoch: 8, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.677 Vali Acc: 0.224 Test Loss: 3.677 Test Acc: 0.224
Validation loss decreased (-0.205847 --> -0.223493).  Saving model ...
Epoch: 9 cost time: 0.5192410945892334
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.788 Vali Acc: 0.236 Test Loss: 3.788 Test Acc: 0.236
Validation loss decreased (-0.223493 --> -0.236433).  Saving model ...
Epoch: 10 cost time: 0.48560166358947754
Epoch: 10, Steps: 10 | Train Loss: 0.235 Vali Loss: 4.031 Vali Acc: 0.227 Test Loss: 4.031 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5163285732269287
Epoch: 11, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.110 Vali Acc: 0.245 Test Loss: 4.110 Test Acc: 0.245
Validation loss decreased (-0.236433 --> -0.244665).  Saving model ...
Epoch: 12 cost time: 0.49133944511413574
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.411 Vali Acc: 0.245 Test Loss: 4.411 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43033885955810547
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.496 Vali Acc: 0.244 Test Loss: 4.496 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4565293788909912
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.515 Vali Acc: 0.253 Test Loss: 4.515 Test Acc: 0.253
Validation loss decreased (-0.244665 --> -0.252896).  Saving model ...
Epoch: 15 cost time: 0.5181493759155273
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.595 Vali Acc: 0.256 Test Loss: 4.595 Test Acc: 0.256
Validation loss decreased (-0.252896 --> -0.256425).  Saving model ...
Epoch: 16 cost time: 0.4673314094543457
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.790 Vali Acc: 0.247 Test Loss: 4.790 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5124385356903076
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.887 Vali Acc: 0.247 Test Loss: 4.887 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5000669956207275
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.833 Vali Acc: 0.260 Test Loss: 4.833 Test Acc: 0.260
Validation loss decreased (-0.256425 --> -0.259952).  Saving model ...
Epoch: 19 cost time: 0.515925407409668
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.815 Vali Acc: 0.259 Test Loss: 4.815 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5156941413879395
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.867 Vali Acc: 0.258 Test Loss: 4.867 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49652767181396484
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.956 Vali Acc: 0.261 Test Loss: 4.956 Test Acc: 0.261
Validation loss decreased (-0.259952 --> -0.261127).  Saving model ...
Epoch: 22 cost time: 0.49918127059936523
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.989 Vali Acc: 0.261 Test Loss: 4.989 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.46932268142700195
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.994 Vali Acc: 0.260 Test Loss: 4.994 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.48915743827819824
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.989 Vali Acc: 0.260 Test Loss: 4.989 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5027027130126953
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.007 Vali Acc: 0.262 Test Loss: 5.007 Test Acc: 0.262
Validation loss decreased (-0.261127 --> -0.262303).  Saving model ...
Epoch: 26 cost time: 0.5024082660675049
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.027 Vali Acc: 0.265 Test Loss: 5.027 Test Acc: 0.265
Validation loss decreased (-0.262303 --> -0.264656).  Saving model ...
Epoch: 27 cost time: 0.44853758811950684
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.052 Vali Acc: 0.262 Test Loss: 5.052 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.47194743156433105
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.065 Vali Acc: 0.264 Test Loss: 5.065 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4781622886657715
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.078 Vali Acc: 0.266 Test Loss: 5.078 Test Acc: 0.266
Validation loss decreased (-0.264656 --> -0.265832).  Saving model ...
Epoch: 30 cost time: 0.45836305618286133
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.086 Vali Acc: 0.265 Test Loss: 5.086 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.49454641342163086
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.117 Vali Acc: 0.266 Test Loss: 5.117 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.46465206146240234
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.143 Vali Acc: 0.267 Test Loss: 5.143 Test Acc: 0.267
Validation loss decreased (-0.265832 --> -0.267007).  Saving model ...
Epoch: 33 cost time: 0.4980340003967285
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.162 Vali Acc: 0.269 Test Loss: 5.162 Test Acc: 0.269
Validation loss decreased (-0.267007 --> -0.269360).  Saving model ...
Epoch: 34 cost time: 0.47024106979370117
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.166 Vali Acc: 0.269 Test Loss: 5.166 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5050232410430908
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.175 Vali Acc: 0.269 Test Loss: 5.175 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.49120163917541504
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.191 Vali Acc: 0.268 Test Loss: 5.191 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.44966697692871094
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.208 Vali Acc: 0.271 Test Loss: 5.208 Test Acc: 0.271
Validation loss decreased (-0.269360 --> -0.270536).  Saving model ...
Epoch: 38 cost time: 0.4569847583770752
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.233 Vali Acc: 0.268 Test Loss: 5.233 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.46897196769714355
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.252 Vali Acc: 0.271 Test Loss: 5.252 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.47875332832336426
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.261 Vali Acc: 0.271 Test Loss: 5.261 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.46218395233154297
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.281 Vali Acc: 0.273 Test Loss: 5.281 Test Acc: 0.273
Validation loss decreased (-0.270536 --> -0.272888).  Saving model ...
Epoch: 42 cost time: 0.483814001083374
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.294 Vali Acc: 0.272 Test Loss: 5.294 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.46024584770202637
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.323 Vali Acc: 0.272 Test Loss: 5.323 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.48273181915283203
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.331 Vali Acc: 0.269 Test Loss: 5.331 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5052268505096436
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.351 Vali Acc: 0.266 Test Loss: 5.351 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5043835639953613
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.268 Test Loss: 5.349 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5083849430084229
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.356 Vali Acc: 0.266 Test Loss: 5.356 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.4626169204711914
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.396 Vali Acc: 0.267 Test Loss: 5.396 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.44663119316101074
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.266 Test Loss: 5.413 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.4691481590270996
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.267 Test Loss: 5.413 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.44782161712646484
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.413 Vali Acc: 0.268 Test Loss: 5.413 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 430234
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5214817523956299
Epoch: 1, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.385 Vali Acc: 0.024 Test Loss: 3.385 Test Acc: 0.024
Validation loss decreased (inf --> -0.023496).  Saving model ...
Epoch: 2 cost time: 0.4442117214202881
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.388 Vali Acc: 0.049 Test Loss: 3.388 Test Acc: 0.049
Validation loss decreased (-0.023496 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.4311678409576416
Epoch: 3, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.362 Vali Acc: 0.099 Test Loss: 3.362 Test Acc: 0.099
Validation loss decreased (-0.049378 --> -0.098790).  Saving model ...
Epoch: 4 cost time: 0.40284180641174316
Epoch: 4, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.312 Vali Acc: 0.131 Test Loss: 3.312 Test Acc: 0.131
Validation loss decreased (-0.098790 --> -0.130555).  Saving model ...
Epoch: 5 cost time: 0.41486573219299316
Epoch: 5, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.273 Vali Acc: 0.146 Test Loss: 3.273 Test Acc: 0.146
Validation loss decreased (-0.130555 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 0.4248230457305908
Epoch: 6, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.265 Vali Acc: 0.173 Test Loss: 3.265 Test Acc: 0.173
Validation loss decreased (-0.145850 --> -0.172909).  Saving model ...
Epoch: 7 cost time: 0.5070760250091553
Epoch: 7, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.328 Vali Acc: 0.176 Test Loss: 3.328 Test Acc: 0.176
Validation loss decreased (-0.172909 --> -0.176437).  Saving model ...
Epoch: 8 cost time: 0.4557681083679199
Epoch: 8, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.372 Vali Acc: 0.181 Test Loss: 3.372 Test Acc: 0.181
Validation loss decreased (-0.176437 --> -0.181143).  Saving model ...
Epoch: 9 cost time: 0.4342803955078125
Epoch: 9, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.405 Vali Acc: 0.212 Test Loss: 3.405 Test Acc: 0.212
Validation loss decreased (-0.181143 --> -0.211731).  Saving model ...
Epoch: 10 cost time: 0.42527198791503906
Epoch: 10, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.459 Vali Acc: 0.222 Test Loss: 3.459 Test Acc: 0.222
Validation loss decreased (-0.211731 --> -0.222318).  Saving model ...
Epoch: 11 cost time: 0.41995716094970703
Epoch: 11, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.601 Vali Acc: 0.222 Test Loss: 3.601 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.441972017288208
Epoch: 12, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.681 Vali Acc: 0.239 Test Loss: 3.681 Test Acc: 0.239
Validation loss decreased (-0.222318 --> -0.238787).  Saving model ...
Epoch: 13 cost time: 0.4481203556060791
Epoch: 13, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.797 Vali Acc: 0.236 Test Loss: 3.797 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.42098259925842285
Epoch: 14, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.908 Vali Acc: 0.254 Test Loss: 3.908 Test Acc: 0.254
Validation loss decreased (-0.238787 --> -0.254079).  Saving model ...
Epoch: 15 cost time: 0.426408052444458
Epoch: 15, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.994 Vali Acc: 0.252 Test Loss: 3.994 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5048646926879883
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.065 Vali Acc: 0.247 Test Loss: 4.065 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.38806939125061035
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.195 Vali Acc: 0.246 Test Loss: 4.195 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4491584300994873
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.270 Vali Acc: 0.249 Test Loss: 4.270 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.44492483139038086
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.297 Vali Acc: 0.259 Test Loss: 4.297 Test Acc: 0.259
Validation loss decreased (-0.254079 --> -0.258781).  Saving model ...
Epoch: 20 cost time: 0.4077341556549072
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.360 Vali Acc: 0.262 Test Loss: 4.360 Test Acc: 0.262
Validation loss decreased (-0.258781 --> -0.262309).  Saving model ...
Epoch: 21 cost time: 0.4329972267150879
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.383 Vali Acc: 0.262 Test Loss: 4.383 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.422715425491333
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.395 Vali Acc: 0.264 Test Loss: 4.395 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263485).  Saving model ...
Epoch: 23 cost time: 0.43445682525634766
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.440 Vali Acc: 0.258 Test Loss: 4.440 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4155302047729492
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.472 Vali Acc: 0.258 Test Loss: 4.472 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4865083694458008
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.497 Vali Acc: 0.261 Test Loss: 4.497 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.44751548767089844
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.511 Vali Acc: 0.262 Test Loss: 4.511 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.48549795150756836
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.571 Vali Acc: 0.260 Test Loss: 4.571 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4156172275543213
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.580 Vali Acc: 0.262 Test Loss: 4.580 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4741709232330322
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.607 Vali Acc: 0.266 Test Loss: 4.607 Test Acc: 0.266
Validation loss decreased (-0.263485 --> -0.265836).  Saving model ...
Epoch: 30 cost time: 0.42630934715270996
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.619 Vali Acc: 0.264 Test Loss: 4.619 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4691171646118164
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.635 Vali Acc: 0.262 Test Loss: 4.635 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4184849262237549
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.688 Vali Acc: 0.256 Test Loss: 4.688 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.38715410232543945
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.710 Vali Acc: 0.262 Test Loss: 4.710 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.3952062129974365
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.716 Vali Acc: 0.261 Test Loss: 4.716 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4294149875640869
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.727 Vali Acc: 0.259 Test Loss: 4.727 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4287834167480469
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.746 Vali Acc: 0.262 Test Loss: 4.746 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.44316768646240234
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.761 Vali Acc: 0.262 Test Loss: 4.761 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.42731785774230957
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.771 Vali Acc: 0.267 Test Loss: 4.771 Test Acc: 0.267
Validation loss decreased (-0.265836 --> -0.267011).  Saving model ...
Epoch: 39 cost time: 0.42835307121276855
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.798 Vali Acc: 0.264 Test Loss: 4.798 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4463837146759033
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.805 Vali Acc: 0.265 Test Loss: 4.805 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.43415307998657227
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.818 Vali Acc: 0.261 Test Loss: 4.818 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4216485023498535
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.837 Vali Acc: 0.261 Test Loss: 4.837 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.43213868141174316
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.864 Vali Acc: 0.264 Test Loss: 4.864 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4799182415008545
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.873 Vali Acc: 0.262 Test Loss: 4.873 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.41171765327453613
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.884 Vali Acc: 0.262 Test Loss: 4.884 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.46779870986938477
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.890 Vali Acc: 0.262 Test Loss: 4.890 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.43096375465393066
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.919 Vali Acc: 0.266 Test Loss: 4.919 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4114108085632324
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.916 Vali Acc: 0.266 Test Loss: 4.916 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 240794
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3850412368774414
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.337 Vali Acc: 0.034 Test Loss: 3.337 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.48940157890319824
Epoch: 2, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.316 Vali Acc: 0.051 Test Loss: 3.316 Test Acc: 0.051
Validation loss decreased (-0.034084 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.4796736240386963
Epoch: 3, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.334 Vali Acc: 0.068 Test Loss: 3.334 Test Acc: 0.068
Validation loss decreased (-0.050555 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.446763277053833
Epoch: 4, Steps: 10 | Train Loss: 2.733 Vali Loss: 3.329 Vali Acc: 0.093 Test Loss: 3.329 Test Acc: 0.093
Validation loss decreased (-0.068202 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 0.4742734432220459
Epoch: 5, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.311 Vali Acc: 0.105 Test Loss: 3.311 Test Acc: 0.105
Validation loss decreased (-0.092908 --> -0.104673).  Saving model ...
Epoch: 6 cost time: 0.45447826385498047
Epoch: 6, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.263 Vali Acc: 0.129 Test Loss: 3.263 Test Acc: 0.129
Validation loss decreased (-0.104673 --> -0.129379).  Saving model ...
Epoch: 7 cost time: 0.4191269874572754
Epoch: 7, Steps: 10 | Train Loss: 1.883 Vali Loss: 3.245 Vali Acc: 0.156 Test Loss: 3.245 Test Acc: 0.156
Validation loss decreased (-0.129379 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 0.4401435852050781
Epoch: 8, Steps: 10 | Train Loss: 1.648 Vali Loss: 3.282 Vali Acc: 0.162 Test Loss: 3.282 Test Acc: 0.162
Validation loss decreased (-0.156438 --> -0.162320).  Saving model ...
Epoch: 9 cost time: 0.4506046772003174
Epoch: 9, Steps: 10 | Train Loss: 1.355 Vali Loss: 3.316 Vali Acc: 0.186 Test Loss: 3.316 Test Acc: 0.186
Validation loss decreased (-0.162320 --> -0.185849).  Saving model ...
Epoch: 10 cost time: 0.45708179473876953
Epoch: 10, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.349 Vali Acc: 0.185 Test Loss: 3.349 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4685969352722168
Epoch: 11, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.384 Vali Acc: 0.214 Test Loss: 3.384 Test Acc: 0.214
Validation loss decreased (-0.185849 --> -0.214084).  Saving model ...
Epoch: 12 cost time: 0.5096023082733154
Epoch: 12, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.423 Vali Acc: 0.221 Test Loss: 3.423 Test Acc: 0.221
Validation loss decreased (-0.214084 --> -0.221142).  Saving model ...
Epoch: 13 cost time: 0.4422304630279541
Epoch: 13, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.468 Vali Acc: 0.232 Test Loss: 3.468 Test Acc: 0.232
Validation loss decreased (-0.221142 --> -0.231730).  Saving model ...
Epoch: 14 cost time: 0.47281670570373535
Epoch: 14, Steps: 10 | Train Loss: 0.544 Vali Loss: 3.576 Vali Acc: 0.236 Test Loss: 3.576 Test Acc: 0.236
Validation loss decreased (-0.231730 --> -0.236435).  Saving model ...
Epoch: 15 cost time: 0.4939424991607666
Epoch: 15, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.657 Vali Acc: 0.236 Test Loss: 3.657 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48802924156188965
Epoch: 16, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.711 Vali Acc: 0.247 Test Loss: 3.711 Test Acc: 0.247
Validation loss decreased (-0.236435 --> -0.247022).  Saving model ...
Epoch: 17 cost time: 0.47014737129211426
Epoch: 17, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.791 Vali Acc: 0.246 Test Loss: 3.791 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4256021976470947
Epoch: 18, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.910 Vali Acc: 0.242 Test Loss: 3.910 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5276095867156982
Epoch: 19, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.975 Vali Acc: 0.247 Test Loss: 3.975 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.46548008918762207
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.036 Vali Acc: 0.252 Test Loss: 4.036 Test Acc: 0.252
Validation loss decreased (-0.247022 --> -0.251724).  Saving model ...
Epoch: 21 cost time: 0.4645650386810303
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.126 Vali Acc: 0.253 Test Loss: 4.126 Test Acc: 0.253
Validation loss decreased (-0.251724 --> -0.252900).  Saving model ...
Epoch: 22 cost time: 0.472337007522583
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.192 Vali Acc: 0.256 Test Loss: 4.192 Test Acc: 0.256
Validation loss decreased (-0.252900 --> -0.256429).  Saving model ...
Epoch: 23 cost time: 0.4860360622406006
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.208 Vali Acc: 0.269 Test Loss: 4.208 Test Acc: 0.269
Validation loss decreased (-0.256429 --> -0.269370).  Saving model ...
Epoch: 24 cost time: 0.4544663429260254
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.232 Vali Acc: 0.262 Test Loss: 4.232 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5050029754638672
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.272 Vali Acc: 0.266 Test Loss: 4.272 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5199782848358154
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.310 Vali Acc: 0.261 Test Loss: 4.310 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4544064998626709
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.335 Vali Acc: 0.259 Test Loss: 4.335 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.48424291610717773
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.347 Vali Acc: 0.255 Test Loss: 4.347 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4935314655303955
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.377 Vali Acc: 0.255 Test Loss: 4.377 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5154728889465332
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.398 Vali Acc: 0.255 Test Loss: 4.398 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4679708480834961
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.431 Vali Acc: 0.254 Test Loss: 4.431 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.48580217361450195
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.452 Vali Acc: 0.261 Test Loss: 4.452 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4866907596588135
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.462 Vali Acc: 0.264 Test Loss: 4.462 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 176154
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.421879529953003
Epoch: 1, Steps: 10 | Train Loss: 3.458 Vali Loss: 3.353 Vali Acc: 0.052 Test Loss: 3.353 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.4712345600128174
Epoch: 2, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.333 Vali Acc: 0.049 Test Loss: 3.333 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4595341682434082
Epoch: 3, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.345 Vali Acc: 0.066 Test Loss: 3.345 Test Acc: 0.066
Validation loss decreased (-0.051731 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.46326112747192383
Epoch: 4, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.360 Vali Acc: 0.087 Test Loss: 3.360 Test Acc: 0.087
Validation loss decreased (-0.065849 --> -0.087025).  Saving model ...
Epoch: 5 cost time: 0.48427414894104004
Epoch: 5, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.331 Vali Acc: 0.094 Test Loss: 3.331 Test Acc: 0.094
Validation loss decreased (-0.087025 --> -0.094084).  Saving model ...
Epoch: 6 cost time: 0.4343092441558838
Epoch: 6, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.307 Vali Acc: 0.112 Test Loss: 3.307 Test Acc: 0.112
Validation loss decreased (-0.094084 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 0.46420788764953613
Epoch: 7, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.296 Vali Acc: 0.126 Test Loss: 3.296 Test Acc: 0.126
Validation loss decreased (-0.111732 --> -0.125849).  Saving model ...
Epoch: 8 cost time: 0.4289402961730957
Epoch: 8, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.288 Vali Acc: 0.144 Test Loss: 3.288 Test Acc: 0.144
Validation loss decreased (-0.125849 --> -0.143497).  Saving model ...
Epoch: 9 cost time: 0.46575212478637695
Epoch: 9, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.280 Vali Acc: 0.166 Test Loss: 3.280 Test Acc: 0.166
Validation loss decreased (-0.143497 --> -0.165850).  Saving model ...
Epoch: 10 cost time: 0.4671647548675537
Epoch: 10, Steps: 10 | Train Loss: 1.520 Vali Loss: 3.308 Vali Acc: 0.179 Test Loss: 3.308 Test Acc: 0.179
Validation loss decreased (-0.165850 --> -0.178790).  Saving model ...
Epoch: 11 cost time: 0.45345020294189453
Epoch: 11, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.320 Vali Acc: 0.193 Test Loss: 3.320 Test Acc: 0.193
Validation loss decreased (-0.178790 --> -0.192908).  Saving model ...
Epoch: 12 cost time: 0.432558536529541
Epoch: 12, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.344 Vali Acc: 0.209 Test Loss: 3.344 Test Acc: 0.209
Validation loss decreased (-0.192908 --> -0.209378).  Saving model ...
Epoch: 13 cost time: 0.47765278816223145
Epoch: 13, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.390 Vali Acc: 0.225 Test Loss: 3.390 Test Acc: 0.225
Validation loss decreased (-0.209378 --> -0.224672).  Saving model ...
Epoch: 14 cost time: 0.501802921295166
Epoch: 14, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.462 Vali Acc: 0.216 Test Loss: 3.462 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.45455050468444824
Epoch: 15, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.514 Vali Acc: 0.232 Test Loss: 3.514 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231730).  Saving model ...
Epoch: 16 cost time: 0.4998459815979004
Epoch: 16, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.599 Vali Acc: 0.235 Test Loss: 3.599 Test Acc: 0.235
Validation loss decreased (-0.231730 --> -0.235258).  Saving model ...
Epoch: 17 cost time: 0.43414807319641113
Epoch: 17, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.652 Vali Acc: 0.239 Test Loss: 3.652 Test Acc: 0.239
Validation loss decreased (-0.235258 --> -0.238787).  Saving model ...
Epoch: 18 cost time: 0.5139124393463135
Epoch: 18, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.684 Vali Acc: 0.247 Test Loss: 3.684 Test Acc: 0.247
Validation loss decreased (-0.238787 --> -0.247022).  Saving model ...
Epoch: 19 cost time: 0.452038049697876
Epoch: 19, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.776 Vali Acc: 0.251 Test Loss: 3.776 Test Acc: 0.251
Validation loss decreased (-0.247022 --> -0.250550).  Saving model ...
Epoch: 20 cost time: 0.45621681213378906
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.879 Vali Acc: 0.248 Test Loss: 3.879 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.43282628059387207
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.956 Vali Acc: 0.241 Test Loss: 3.956 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.47063422203063965
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.966 Vali Acc: 0.245 Test Loss: 3.966 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4693605899810791
Epoch: 23, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.009 Vali Acc: 0.251 Test Loss: 4.009 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4840717315673828
Epoch: 24, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.080 Vali Acc: 0.252 Test Loss: 4.080 Test Acc: 0.252
Validation loss decreased (-0.250550 --> -0.251724).  Saving model ...
Epoch: 25 cost time: 0.48116636276245117
Epoch: 25, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.129 Vali Acc: 0.248 Test Loss: 4.129 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4684925079345703
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.158 Vali Acc: 0.249 Test Loss: 4.158 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.45320701599121094
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.201 Vali Acc: 0.244 Test Loss: 4.201 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.494504451751709
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.255 Vali Acc: 0.249 Test Loss: 4.255 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4801309108734131
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.276 Vali Acc: 0.252 Test Loss: 4.276 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4658467769622803
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.294 Vali Acc: 0.254 Test Loss: 4.294 Test Acc: 0.254
Validation loss decreased (-0.251724 --> -0.254075).  Saving model ...
Epoch: 31 cost time: 0.48556947708129883
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.315 Vali Acc: 0.253 Test Loss: 4.315 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4370889663696289
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.330 Vali Acc: 0.253 Test Loss: 4.330 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4657328128814697
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.353 Vali Acc: 0.255 Test Loss: 4.353 Test Acc: 0.255
Validation loss decreased (-0.254075 --> -0.255251).  Saving model ...
Epoch: 34 cost time: 0.5016145706176758
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.394 Vali Acc: 0.248 Test Loss: 4.394 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.475980281829834
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.413 Vali Acc: 0.252 Test Loss: 4.413 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4836876392364502
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.424 Vali Acc: 0.253 Test Loss: 4.424 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.44889092445373535
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.446 Vali Acc: 0.252 Test Loss: 4.446 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5269932746887207
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.465 Vali Acc: 0.246 Test Loss: 4.465 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4877176284790039
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.473 Vali Acc: 0.247 Test Loss: 4.473 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.46216845512390137
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.499 Vali Acc: 0.246 Test Loss: 4.499 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.48625779151916504
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.517 Vali Acc: 0.248 Test Loss: 4.517 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5248470306396484
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.541 Vali Acc: 0.251 Test Loss: 4.541 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4473299980163574
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.545 Vali Acc: 0.256 Test Loss: 4.545 Test Acc: 0.256
Validation loss decreased (-0.255251 --> -0.256425).  Saving model ...
Epoch: 44 cost time: 0.5275633335113525
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.576 Vali Acc: 0.256 Test Loss: 4.576 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.47114014625549316
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.602 Vali Acc: 0.255 Test Loss: 4.602 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.473527193069458
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.612 Vali Acc: 0.254 Test Loss: 4.612 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4676077365875244
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.256 Test Loss: 4.630 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4876072406768799
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.641 Vali Acc: 0.256 Test Loss: 4.641 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.49462175369262695
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.639 Vali Acc: 0.261 Test Loss: 4.639 Test Acc: 0.261
Validation loss decreased (-0.256425 --> -0.261130).  Saving model ...
Epoch: 50 cost time: 0.47080087661743164
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.644 Vali Acc: 0.262 Test Loss: 4.644 Test Acc: 0.262
Validation loss decreased (-0.261130 --> -0.262307).  Saving model ...
Epoch: 51 cost time: 0.5204966068267822
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.647 Vali Acc: 0.265 Test Loss: 4.647 Test Acc: 0.265
Validation loss decreased (-0.262307 --> -0.264659).  Saving model ...
Epoch: 52 cost time: 0.44110631942749023
Epoch: 52, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.653 Vali Acc: 0.261 Test Loss: 4.653 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4704301357269287
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.670 Vali Acc: 0.262 Test Loss: 4.670 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.49054908752441406
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.694 Vali Acc: 0.261 Test Loss: 4.694 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5008633136749268
Epoch: 55, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.717 Vali Acc: 0.258 Test Loss: 4.717 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4791128635406494
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.716 Vali Acc: 0.254 Test Loss: 4.716 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.47316908836364746
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.730 Vali Acc: 0.255 Test Loss: 4.730 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.4890482425689697
Epoch: 58, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.743 Vali Acc: 0.258 Test Loss: 4.743 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.4748528003692627
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.751 Vali Acc: 0.260 Test Loss: 4.751 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.48519158363342285
Epoch: 60, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.763 Vali Acc: 0.264 Test Loss: 4.763 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5116927623748779
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.773 Vali Acc: 0.265 Test Loss: 4.773 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 146458
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6642024517059326
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.379 Vali Acc: 0.053 Test Loss: 3.379 Test Acc: 0.053
Validation loss decreased (inf --> -0.052907).  Saving model ...
Epoch: 2 cost time: 0.42115163803100586
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.351 Vali Acc: 0.051 Test Loss: 3.351 Test Acc: 0.051
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42340946197509766
Epoch: 3, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.329 Vali Acc: 0.064 Test Loss: 3.329 Test Acc: 0.064
Validation loss decreased (-0.052907 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.4437131881713867
Epoch: 4, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.320 Vali Acc: 0.074 Test Loss: 3.320 Test Acc: 0.074
Validation loss decreased (-0.063496 --> -0.074084).  Saving model ...
Epoch: 5 cost time: 0.41394662857055664
Epoch: 5, Steps: 10 | Train Loss: 2.830 Vali Loss: 3.316 Vali Acc: 0.087 Test Loss: 3.316 Test Acc: 0.087
Validation loss decreased (-0.074084 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 0.45299243927001953
Epoch: 6, Steps: 10 | Train Loss: 2.657 Vali Loss: 3.306 Vali Acc: 0.101 Test Loss: 3.306 Test Acc: 0.101
Validation loss decreased (-0.087026 --> -0.101143).  Saving model ...
Epoch: 7 cost time: 0.4518401622772217
Epoch: 7, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.291 Vali Acc: 0.112 Test Loss: 3.291 Test Acc: 0.112
Validation loss decreased (-0.101143 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.4387660026550293
Epoch: 8, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.276 Vali Acc: 0.127 Test Loss: 3.276 Test Acc: 0.127
Validation loss decreased (-0.111732 --> -0.127026).  Saving model ...
Epoch: 9 cost time: 0.4284651279449463
Epoch: 9, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.273 Vali Acc: 0.132 Test Loss: 3.273 Test Acc: 0.132
Validation loss decreased (-0.127026 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 0.45193052291870117
Epoch: 10, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.260 Vali Acc: 0.147 Test Loss: 3.260 Test Acc: 0.147
Validation loss decreased (-0.131732 --> -0.147026).  Saving model ...
Epoch: 11 cost time: 0.44057631492614746
Epoch: 11, Steps: 10 | Train Loss: 1.654 Vali Loss: 3.262 Vali Acc: 0.158 Test Loss: 3.262 Test Acc: 0.158
Validation loss decreased (-0.147026 --> -0.157614).  Saving model ...
Epoch: 12 cost time: 0.4096047878265381
Epoch: 12, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.276 Vali Acc: 0.161 Test Loss: 3.276 Test Acc: 0.161
Validation loss decreased (-0.157614 --> -0.161144).  Saving model ...
Epoch: 13 cost time: 0.4584219455718994
Epoch: 13, Steps: 10 | Train Loss: 1.351 Vali Loss: 3.307 Vali Acc: 0.179 Test Loss: 3.307 Test Acc: 0.179
Validation loss decreased (-0.161144 --> -0.178790).  Saving model ...
Epoch: 14 cost time: 0.4972867965698242
Epoch: 14, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.343 Vali Acc: 0.192 Test Loss: 3.343 Test Acc: 0.192
Validation loss decreased (-0.178790 --> -0.191731).  Saving model ...
Epoch: 15 cost time: 0.45344996452331543
Epoch: 15, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.360 Vali Acc: 0.199 Test Loss: 3.360 Test Acc: 0.199
Validation loss decreased (-0.191731 --> -0.198790).  Saving model ...
Epoch: 16 cost time: 0.48236823081970215
Epoch: 16, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.409 Vali Acc: 0.200 Test Loss: 3.409 Test Acc: 0.200
Validation loss decreased (-0.198790 --> -0.199966).  Saving model ...
Epoch: 17 cost time: 0.4650883674621582
Epoch: 17, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.442 Vali Acc: 0.204 Test Loss: 3.442 Test Acc: 0.204
Validation loss decreased (-0.199966 --> -0.203495).  Saving model ...
Epoch: 18 cost time: 0.5017006397247314
Epoch: 18, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.489 Vali Acc: 0.205 Test Loss: 3.489 Test Acc: 0.205
Validation loss decreased (-0.203495 --> -0.204671).  Saving model ...
Epoch: 19 cost time: 0.48925089836120605
Epoch: 19, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.527 Vali Acc: 0.218 Test Loss: 3.527 Test Acc: 0.218
Validation loss decreased (-0.204671 --> -0.217612).  Saving model ...
Epoch: 20 cost time: 0.41796088218688965
Epoch: 20, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.598 Vali Acc: 0.221 Test Loss: 3.598 Test Acc: 0.221
Validation loss decreased (-0.217612 --> -0.221140).  Saving model ...
Epoch: 21 cost time: 0.487149715423584
Epoch: 21, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.653 Vali Acc: 0.222 Test Loss: 3.653 Test Acc: 0.222
Validation loss decreased (-0.221140 --> -0.222316).  Saving model ...
Epoch: 22 cost time: 0.41595935821533203
Epoch: 22, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.714 Vali Acc: 0.214 Test Loss: 3.714 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.40564417839050293
Epoch: 23, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.762 Vali Acc: 0.219 Test Loss: 3.762 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4430675506591797
Epoch: 24, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.806 Vali Acc: 0.222 Test Loss: 3.806 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4568800926208496
Epoch: 25, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.876 Vali Acc: 0.227 Test Loss: 3.876 Test Acc: 0.227
Validation loss decreased (-0.222316 --> -0.227020).  Saving model ...
Epoch: 26 cost time: 0.5035462379455566
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.918 Vali Acc: 0.232 Test Loss: 3.918 Test Acc: 0.232
Validation loss decreased (-0.227020 --> -0.231726).  Saving model ...
Epoch: 27 cost time: 0.5044581890106201
Epoch: 27, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.964 Vali Acc: 0.235 Test Loss: 3.964 Test Acc: 0.235
Validation loss decreased (-0.231726 --> -0.235254).  Saving model ...
Epoch: 28 cost time: 0.4605410099029541
Epoch: 28, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.003 Vali Acc: 0.238 Test Loss: 4.003 Test Acc: 0.238
Validation loss decreased (-0.235254 --> -0.237607).  Saving model ...
Epoch: 29 cost time: 0.4510505199432373
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.033 Vali Acc: 0.240 Test Loss: 4.033 Test Acc: 0.240
Validation loss decreased (-0.237607 --> -0.239960).  Saving model ...
Epoch: 30 cost time: 0.4400746822357178
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.067 Vali Acc: 0.242 Test Loss: 4.067 Test Acc: 0.242
Validation loss decreased (-0.239960 --> -0.242312).  Saving model ...
Epoch: 31 cost time: 0.45619702339172363
Epoch: 31, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.089 Vali Acc: 0.241 Test Loss: 4.089 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.45855164527893066
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.098 Vali Acc: 0.245 Test Loss: 4.098 Test Acc: 0.245
Validation loss decreased (-0.242312 --> -0.244665).  Saving model ...
Epoch: 33 cost time: 0.45488452911376953
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.120 Vali Acc: 0.249 Test Loss: 4.120 Test Acc: 0.249
Validation loss decreased (-0.244665 --> -0.249371).  Saving model ...
Epoch: 34 cost time: 0.47137904167175293
Epoch: 34, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.131 Vali Acc: 0.247 Test Loss: 4.131 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.498396635055542
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.161 Vali Acc: 0.247 Test Loss: 4.161 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.45204591751098633
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.180 Vali Acc: 0.246 Test Loss: 4.180 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.49451708793640137
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.210 Vali Acc: 0.247 Test Loss: 4.210 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4932851791381836
Epoch: 38, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.224 Vali Acc: 0.247 Test Loss: 4.224 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4639737606048584
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.219 Vali Acc: 0.254 Test Loss: 4.219 Test Acc: 0.254
Validation loss decreased (-0.249371 --> -0.254075).  Saving model ...
Epoch: 40 cost time: 0.49155092239379883
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.243 Vali Acc: 0.254 Test Loss: 4.243 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.42086029052734375
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.288 Vali Acc: 0.249 Test Loss: 4.288 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.48398399353027344
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.294 Vali Acc: 0.253 Test Loss: 4.294 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4813709259033203
Epoch: 43, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.304 Vali Acc: 0.253 Test Loss: 4.304 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4856734275817871
Epoch: 44, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.325 Vali Acc: 0.256 Test Loss: 4.325 Test Acc: 0.256
Validation loss decreased (-0.254075 --> -0.256427).  Saving model ...
Epoch: 45 cost time: 0.47658443450927734
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.333 Vali Acc: 0.259 Test Loss: 4.333 Test Acc: 0.259
Validation loss decreased (-0.256427 --> -0.258780).  Saving model ...
Epoch: 46 cost time: 0.4381401538848877
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.347 Vali Acc: 0.253 Test Loss: 4.347 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4818124771118164
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.361 Vali Acc: 0.256 Test Loss: 4.361 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.46448373794555664
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.368 Vali Acc: 0.258 Test Loss: 4.368 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.48177099227905273
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.388 Vali Acc: 0.261 Test Loss: 4.388 Test Acc: 0.261
Validation loss decreased (-0.258780 --> -0.261133).  Saving model ...
Epoch: 50 cost time: 0.4303879737854004
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.392 Vali Acc: 0.255 Test Loss: 4.392 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.450209379196167
Epoch: 51, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.395 Vali Acc: 0.255 Test Loss: 4.395 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.41838550567626953
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.410 Vali Acc: 0.256 Test Loss: 4.410 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5049560070037842
Epoch: 53, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.423 Vali Acc: 0.252 Test Loss: 4.423 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.45458126068115234
Epoch: 54, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.437 Vali Acc: 0.252 Test Loss: 4.437 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.4233286380767822
Epoch: 55, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.448 Vali Acc: 0.255 Test Loss: 4.448 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.4579935073852539
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.461 Vali Acc: 0.253 Test Loss: 4.461 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.46393561363220215
Epoch: 57, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.477 Vali Acc: 0.251 Test Loss: 4.477 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.4622678756713867
Epoch: 58, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.490 Vali Acc: 0.251 Test Loss: 4.490 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.576960563659668
Epoch: 59, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.486 Vali Acc: 0.262 Test Loss: 4.486 Test Acc: 0.262
Validation loss decreased (-0.261133 --> -0.262308).  Saving model ...
Epoch: 60 cost time: 0.5150065422058105
Epoch: 60, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.488 Vali Acc: 0.265 Test Loss: 4.488 Test Acc: 0.265
Validation loss decreased (-0.262308 --> -0.264661).  Saving model ...
Epoch: 61 cost time: 0.46263980865478516
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.493 Vali Acc: 0.264 Test Loss: 4.493 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4684441089630127
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.513 Vali Acc: 0.259 Test Loss: 4.513 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.4796414375305176
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.520 Vali Acc: 0.260 Test Loss: 4.520 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5364081859588623
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.528 Vali Acc: 0.259 Test Loss: 4.528 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.4718055725097656
Epoch: 65, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.555 Vali Acc: 0.258 Test Loss: 4.555 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.47757887840270996
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.557 Vali Acc: 0.258 Test Loss: 4.557 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.5279650688171387
Epoch: 67, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.568 Vali Acc: 0.258 Test Loss: 4.568 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.4996833801269531
Epoch: 68, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.576 Vali Acc: 0.264 Test Loss: 4.576 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.4606621265411377
Epoch: 69, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.577 Vali Acc: 0.261 Test Loss: 4.577 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.5315463542938232
Epoch: 70, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.584 Vali Acc: 0.260 Test Loss: 4.584 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 111962
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4267995357513428
Epoch: 1, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.356 Vali Acc: 0.049 Test Loss: 3.356 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.4422168731689453
Epoch: 2, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.341 Vali Acc: 0.055 Test Loss: 3.341 Test Acc: 0.055
Validation loss decreased (-0.049378 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.49851107597351074
Epoch: 3, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.320 Vali Acc: 0.062 Test Loss: 3.320 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.44452857971191406
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.305 Vali Acc: 0.067 Test Loss: 3.305 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.5411560535430908
Epoch: 5, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.297 Vali Acc: 0.080 Test Loss: 3.297 Test Acc: 0.080
Validation loss decreased (-0.067026 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.48552489280700684
Epoch: 6, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.297 Vali Acc: 0.082 Test Loss: 3.297 Test Acc: 0.082
Validation loss decreased (-0.079967 --> -0.082320).  Saving model ...
Epoch: 7 cost time: 0.5234572887420654
Epoch: 7, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.289 Vali Acc: 0.086 Test Loss: 3.289 Test Acc: 0.086
Validation loss decreased (-0.082320 --> -0.085849).  Saving model ...
Epoch: 8 cost time: 0.47312188148498535
Epoch: 8, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.280 Vali Acc: 0.098 Test Loss: 3.280 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.097614).  Saving model ...
Epoch: 9 cost time: 0.528679609298706
Epoch: 9, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.271 Vali Acc: 0.106 Test Loss: 3.271 Test Acc: 0.106
Validation loss decreased (-0.097614 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.4983706474304199
Epoch: 10, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.261 Vali Acc: 0.118 Test Loss: 3.261 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117614).  Saving model ...
Epoch: 11 cost time: 0.45221519470214844
Epoch: 11, Steps: 10 | Train Loss: 1.945 Vali Loss: 3.263 Vali Acc: 0.128 Test Loss: 3.263 Test Acc: 0.128
Validation loss decreased (-0.117614 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.5384645462036133
Epoch: 12, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.274 Vali Acc: 0.142 Test Loss: 3.274 Test Acc: 0.142
Validation loss decreased (-0.128203 --> -0.142320).  Saving model ...
Epoch: 13 cost time: 0.4730048179626465
Epoch: 13, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.280 Vali Acc: 0.151 Test Loss: 3.280 Test Acc: 0.151
Validation loss decreased (-0.142320 --> -0.150555).  Saving model ...
Epoch: 14 cost time: 0.4780592918395996
Epoch: 14, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.295 Vali Acc: 0.159 Test Loss: 3.295 Test Acc: 0.159
Validation loss decreased (-0.150555 --> -0.158791).  Saving model ...
Epoch: 15 cost time: 0.4843888282775879
Epoch: 15, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.322 Vali Acc: 0.165 Test Loss: 3.322 Test Acc: 0.165
Validation loss decreased (-0.158791 --> -0.164673).  Saving model ...
Epoch: 16 cost time: 0.475726842880249
Epoch: 16, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.336 Vali Acc: 0.182 Test Loss: 3.336 Test Acc: 0.182
Validation loss decreased (-0.164673 --> -0.182320).  Saving model ...
Epoch: 17 cost time: 0.5010330677032471
Epoch: 17, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.361 Vali Acc: 0.186 Test Loss: 3.361 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185849).  Saving model ...
Epoch: 18 cost time: 0.4734933376312256
Epoch: 18, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.396 Vali Acc: 0.187 Test Loss: 3.396 Test Acc: 0.187
Validation loss decreased (-0.185849 --> -0.187025).  Saving model ...
Epoch: 19 cost time: 0.44785046577453613
Epoch: 19, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.444 Vali Acc: 0.189 Test Loss: 3.444 Test Acc: 0.189
Validation loss decreased (-0.187025 --> -0.189377).  Saving model ...
Epoch: 20 cost time: 0.470292329788208
Epoch: 20, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.486 Vali Acc: 0.196 Test Loss: 3.486 Test Acc: 0.196
Validation loss decreased (-0.189377 --> -0.196436).  Saving model ...
Epoch: 21 cost time: 0.5369358062744141
Epoch: 21, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.523 Vali Acc: 0.194 Test Loss: 3.523 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4620482921600342
Epoch: 22, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.568 Vali Acc: 0.199 Test Loss: 3.568 Test Acc: 0.199
Validation loss decreased (-0.196436 --> -0.198788).  Saving model ...
Epoch: 23 cost time: 0.48802852630615234
Epoch: 23, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.609 Vali Acc: 0.212 Test Loss: 3.609 Test Acc: 0.212
Validation loss decreased (-0.198788 --> -0.211729).  Saving model ...
Epoch: 24 cost time: 0.4715578556060791
Epoch: 24, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.657 Vali Acc: 0.213 Test Loss: 3.657 Test Acc: 0.213
Validation loss decreased (-0.211729 --> -0.212905).  Saving model ...
Epoch: 25 cost time: 0.5160045623779297
Epoch: 25, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.691 Vali Acc: 0.218 Test Loss: 3.691 Test Acc: 0.218
Validation loss decreased (-0.212905 --> -0.217610).  Saving model ...
Epoch: 26 cost time: 0.5548975467681885
Epoch: 26, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.775 Vali Acc: 0.213 Test Loss: 3.775 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.46811556816101074
Epoch: 27, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.862 Vali Acc: 0.200 Test Loss: 3.862 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.46313023567199707
Epoch: 28, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.904 Vali Acc: 0.208 Test Loss: 3.904 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4861292839050293
Epoch: 29, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.924 Vali Acc: 0.213 Test Loss: 3.924 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4828062057495117
Epoch: 30, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.965 Vali Acc: 0.212 Test Loss: 3.965 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6052327156066895
Epoch: 31, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.009 Vali Acc: 0.212 Test Loss: 4.009 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.47515416145324707
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.030 Vali Acc: 0.212 Test Loss: 4.030 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.46314239501953125
Epoch: 33, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.052 Vali Acc: 0.216 Test Loss: 4.052 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4902503490447998
Epoch: 34, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.103 Vali Acc: 0.218 Test Loss: 4.103 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4965705871582031
Epoch: 35, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.137 Vali Acc: 0.221 Test Loss: 4.137 Test Acc: 0.221
Validation loss decreased (-0.217610 --> -0.221135).  Saving model ...
Epoch: 36 cost time: 0.4570958614349365
Epoch: 36, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.178 Vali Acc: 0.222 Test Loss: 4.178 Test Acc: 0.222
Validation loss decreased (-0.221135 --> -0.222311).  Saving model ...
Epoch: 37 cost time: 0.5335681438446045
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.218 Vali Acc: 0.221 Test Loss: 4.218 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4749460220336914
Epoch: 38, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.234 Vali Acc: 0.224 Test Loss: 4.234 Test Acc: 0.224
Validation loss decreased (-0.222311 --> -0.223487).  Saving model ...
Epoch: 39 cost time: 0.45728611946105957
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.249 Vali Acc: 0.225 Test Loss: 4.249 Test Acc: 0.225
Validation loss decreased (-0.223487 --> -0.224663).  Saving model ...
Epoch: 40 cost time: 0.46787476539611816
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.279 Vali Acc: 0.221 Test Loss: 4.279 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4182775020599365
Epoch: 41, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.280 Vali Acc: 0.222 Test Loss: 4.280 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4428715705871582
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.313 Vali Acc: 0.221 Test Loss: 4.313 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4993891716003418
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.325 Vali Acc: 0.224 Test Loss: 4.325 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4311404228210449
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.362 Vali Acc: 0.221 Test Loss: 4.362 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.483989953994751
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.380 Vali Acc: 0.224 Test Loss: 4.380 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4465339183807373
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.384 Vali Acc: 0.221 Test Loss: 4.384 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4827256202697754
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.400 Vali Acc: 0.222 Test Loss: 4.400 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.4939391613006592
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.427 Vali Acc: 0.222 Test Loss: 4.427 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.47307610511779785
Epoch: 49, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.453 Vali Acc: 0.222 Test Loss: 4.453 Test Acc: 0.222
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22470588235294117
model parameter : 97498
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3836426734924316
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.313 Vali Acc: 0.053 Test Loss: 3.313 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.40406179428100586
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.282 Vali Acc: 0.055 Test Loss: 3.282 Test Acc: 0.055
Validation loss decreased (-0.052908 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.42185473442077637
Epoch: 3, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.263 Vali Acc: 0.071 Test Loss: 3.263 Test Acc: 0.071
Validation loss decreased (-0.055261 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 0.5051825046539307
Epoch: 4, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.251 Vali Acc: 0.076 Test Loss: 3.251 Test Acc: 0.076
Validation loss decreased (-0.070556 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.45474696159362793
Epoch: 5, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.242 Vali Acc: 0.085 Test Loss: 3.242 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.43253040313720703
Epoch: 6, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.241 Vali Acc: 0.092 Test Loss: 3.241 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.447084903717041
Epoch: 7, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.234 Vali Acc: 0.114 Test Loss: 3.234 Test Acc: 0.114
Validation loss decreased (-0.091732 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.4373593330383301
Epoch: 8, Steps: 10 | Train Loss: 2.546 Vali Loss: 3.226 Vali Acc: 0.124 Test Loss: 3.226 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123497).  Saving model ...
Epoch: 9 cost time: 0.41826605796813965
Epoch: 9, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.221 Vali Acc: 0.126 Test Loss: 3.221 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 0.4318714141845703
Epoch: 10, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.219 Vali Acc: 0.138 Test Loss: 3.219 Test Acc: 0.138
Validation loss decreased (-0.125850 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 0.44098973274230957
Epoch: 11, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.218 Vali Acc: 0.142 Test Loss: 3.218 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142321).  Saving model ...
Epoch: 12 cost time: 0.4573972225189209
Epoch: 12, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.223 Vali Acc: 0.148 Test Loss: 3.223 Test Acc: 0.148
Validation loss decreased (-0.142321 --> -0.148203).  Saving model ...
Epoch: 13 cost time: 0.4276094436645508
Epoch: 13, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.226 Vali Acc: 0.165 Test Loss: 3.226 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164674).  Saving model ...
Epoch: 14 cost time: 0.43642258644104004
Epoch: 14, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.236 Vali Acc: 0.182 Test Loss: 3.236 Test Acc: 0.182
Validation loss decreased (-0.164674 --> -0.182321).  Saving model ...
Epoch: 15 cost time: 0.4585597515106201
Epoch: 15, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.249 Vali Acc: 0.195 Test Loss: 3.249 Test Acc: 0.195
Validation loss decreased (-0.182321 --> -0.195262).  Saving model ...
Epoch: 16 cost time: 0.4567534923553467
Epoch: 16, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.271 Vali Acc: 0.198 Test Loss: 3.271 Test Acc: 0.198
Validation loss decreased (-0.195262 --> -0.197614).  Saving model ...
Epoch: 17 cost time: 0.4540727138519287
Epoch: 17, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.286 Vali Acc: 0.205 Test Loss: 3.286 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204673).  Saving model ...
Epoch: 18 cost time: 0.46721410751342773
Epoch: 18, Steps: 10 | Train Loss: 1.108 Vali Loss: 3.309 Vali Acc: 0.215 Test Loss: 3.309 Test Acc: 0.215
Validation loss decreased (-0.204673 --> -0.215261).  Saving model ...
Epoch: 19 cost time: 0.45717954635620117
Epoch: 19, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.339 Vali Acc: 0.218 Test Loss: 3.339 Test Acc: 0.218
Validation loss decreased (-0.215261 --> -0.217614).  Saving model ...
Epoch: 20 cost time: 0.48796939849853516
Epoch: 20, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.390 Vali Acc: 0.216 Test Loss: 3.390 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.42830848693847656
Epoch: 21, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.412 Vali Acc: 0.226 Test Loss: 3.412 Test Acc: 0.226
Validation loss decreased (-0.217614 --> -0.225848).  Saving model ...
Epoch: 22 cost time: 0.46622776985168457
Epoch: 22, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.441 Vali Acc: 0.234 Test Loss: 3.441 Test Acc: 0.234
Validation loss decreased (-0.225848 --> -0.234083).  Saving model ...
Epoch: 23 cost time: 0.47150349617004395
Epoch: 23, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.474 Vali Acc: 0.236 Test Loss: 3.474 Test Acc: 0.236
Validation loss decreased (-0.234083 --> -0.236436).  Saving model ...
Epoch: 24 cost time: 0.4754023551940918
Epoch: 24, Steps: 10 | Train Loss: 0.546 Vali Loss: 3.501 Vali Acc: 0.236 Test Loss: 3.501 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4296724796295166
Epoch: 25, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.530 Vali Acc: 0.240 Test Loss: 3.530 Test Acc: 0.240
Validation loss decreased (-0.236436 --> -0.239965).  Saving model ...
Epoch: 26 cost time: 0.42844295501708984
Epoch: 26, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.575 Vali Acc: 0.239 Test Loss: 3.575 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.430941104888916
Epoch: 27, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.615 Vali Acc: 0.245 Test Loss: 3.615 Test Acc: 0.245
Validation loss decreased (-0.239965 --> -0.244670).  Saving model ...
Epoch: 28 cost time: 0.45067739486694336
Epoch: 28, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.661 Vali Acc: 0.238 Test Loss: 3.661 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4581332206726074
Epoch: 29, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.688 Vali Acc: 0.240 Test Loss: 3.688 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4237504005432129
Epoch: 30, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.704 Vali Acc: 0.253 Test Loss: 3.704 Test Acc: 0.253
Validation loss decreased (-0.244670 --> -0.252904).  Saving model ...
Epoch: 31 cost time: 0.452392578125
Epoch: 31, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.720 Vali Acc: 0.253 Test Loss: 3.720 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.42664551734924316
Epoch: 32, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.744 Vali Acc: 0.255 Test Loss: 3.744 Test Acc: 0.255
Validation loss decreased (-0.252904 --> -0.255257).  Saving model ...
Epoch: 33 cost time: 0.46825242042541504
Epoch: 33, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.787 Vali Acc: 0.254 Test Loss: 3.787 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4186980724334717
Epoch: 34, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.810 Vali Acc: 0.255 Test Loss: 3.810 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4443950653076172
Epoch: 35, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.803 Vali Acc: 0.258 Test Loss: 3.803 Test Acc: 0.258
Validation loss decreased (-0.255257 --> -0.257609).  Saving model ...
Epoch: 36 cost time: 0.4381568431854248
Epoch: 36, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.806 Vali Acc: 0.264 Test Loss: 3.806 Test Acc: 0.264
Validation loss decreased (-0.257609 --> -0.263491).  Saving model ...
Epoch: 37 cost time: 0.4182093143463135
Epoch: 37, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.833 Vali Acc: 0.261 Test Loss: 3.833 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4268534183502197
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.845 Vali Acc: 0.265 Test Loss: 3.845 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 39 cost time: 0.46924924850463867
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.859 Vali Acc: 0.273 Test Loss: 3.859 Test Acc: 0.273
Validation loss decreased (-0.264667 --> -0.272903).  Saving model ...
Epoch: 40 cost time: 0.46825265884399414
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.868 Vali Acc: 0.271 Test Loss: 3.868 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4569895267486572
Epoch: 41, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.891 Vali Acc: 0.266 Test Loss: 3.891 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4786496162414551
Epoch: 42, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.923 Vali Acc: 0.265 Test Loss: 3.923 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.47509288787841797
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.942 Vali Acc: 0.258 Test Loss: 3.942 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5055975914001465
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.938 Vali Acc: 0.264 Test Loss: 3.938 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.48238277435302734
Epoch: 45, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.944 Vali Acc: 0.274 Test Loss: 3.944 Test Acc: 0.274
Validation loss decreased (-0.272903 --> -0.274078).  Saving model ...
Epoch: 46 cost time: 0.45596933364868164
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.954 Vali Acc: 0.278 Test Loss: 3.954 Test Acc: 0.278
Validation loss decreased (-0.274078 --> -0.277608).  Saving model ...
Epoch: 47 cost time: 0.4649488925933838
Epoch: 47, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.973 Vali Acc: 0.278 Test Loss: 3.973 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.44737911224365234
Epoch: 48, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.980 Vali Acc: 0.278 Test Loss: 3.980 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.46816349029541016
Epoch: 49, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.998 Vali Acc: 0.273 Test Loss: 3.998 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5137228965759277
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.015 Vali Acc: 0.273 Test Loss: 4.015 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5147325992584229
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.036 Vali Acc: 0.275 Test Loss: 4.036 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.4481954574584961
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.045 Vali Acc: 0.276 Test Loss: 4.045 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.45260119438171387
Epoch: 53, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.052 Vali Acc: 0.276 Test Loss: 4.052 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6061398983001709
Epoch: 54, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.061 Vali Acc: 0.272 Test Loss: 4.061 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5232663154602051
Epoch: 55, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.070 Vali Acc: 0.272 Test Loss: 4.070 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.43436574935913086
Epoch: 56, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.072 Vali Acc: 0.275 Test Loss: 4.072 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm64_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 92954
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6903741359710693
Epoch: 1, Steps: 10 | Train Loss: 3.499 Vali Loss: 3.356 Vali Acc: 0.041 Test Loss: 3.356 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.49883246421813965
Epoch: 2, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.400 Vali Acc: 0.048 Test Loss: 3.400 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048201).  Saving model ...
Epoch: 3 cost time: 0.4156649112701416
Epoch: 3, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.373 Vali Acc: 0.080 Test Loss: 3.373 Test Acc: 0.080
Validation loss decreased (-0.048201 --> -0.079966).  Saving model ...
Epoch: 4 cost time: 0.4920461177825928
Epoch: 4, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.289 Vali Acc: 0.102 Test Loss: 3.289 Test Acc: 0.102
Validation loss decreased (-0.079966 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.44036340713500977
Epoch: 5, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.245 Vali Acc: 0.144 Test Loss: 3.245 Test Acc: 0.144
Validation loss decreased (-0.102320 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 0.48114705085754395
Epoch: 6, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.221 Vali Acc: 0.174 Test Loss: 3.221 Test Acc: 0.174
Validation loss decreased (-0.143497 --> -0.174085).  Saving model ...
Epoch: 7 cost time: 0.4839816093444824
Epoch: 7, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.274 Vali Acc: 0.184 Test Loss: 3.274 Test Acc: 0.184
Validation loss decreased (-0.174085 --> -0.183497).  Saving model ...
Epoch: 8 cost time: 0.4343721866607666
Epoch: 8, Steps: 10 | Train Loss: 1.277 Vali Loss: 3.317 Vali Acc: 0.211 Test Loss: 3.317 Test Acc: 0.211
Validation loss decreased (-0.183497 --> -0.210555).  Saving model ...
Epoch: 9 cost time: 0.4260892868041992
Epoch: 9, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.330 Vali Acc: 0.218 Test Loss: 3.330 Test Acc: 0.218
Validation loss decreased (-0.210555 --> -0.217614).  Saving model ...
Epoch: 10 cost time: 0.4293346405029297
Epoch: 10, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.393 Vali Acc: 0.231 Test Loss: 3.393 Test Acc: 0.231
Validation loss decreased (-0.217614 --> -0.230554).  Saving model ...
Epoch: 11 cost time: 0.4500572681427002
Epoch: 11, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.513 Vali Acc: 0.239 Test Loss: 3.513 Test Acc: 0.239
Validation loss decreased (-0.230554 --> -0.238788).  Saving model ...
Epoch: 12 cost time: 0.4199371337890625
Epoch: 12, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.557 Vali Acc: 0.258 Test Loss: 3.557 Test Acc: 0.258
Validation loss decreased (-0.238788 --> -0.257611).  Saving model ...
Epoch: 13 cost time: 0.4401829242706299
Epoch: 13, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.715 Vali Acc: 0.248 Test Loss: 3.715 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.42034077644348145
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.780 Vali Acc: 0.256 Test Loss: 3.780 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4129638671875
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.923 Vali Acc: 0.255 Test Loss: 3.923 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.42914295196533203
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.058 Vali Acc: 0.258 Test Loss: 4.058 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4683370590209961
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.073 Vali Acc: 0.271 Test Loss: 4.073 Test Acc: 0.271
Validation loss decreased (-0.257611 --> -0.270548).  Saving model ...
Epoch: 18 cost time: 0.4492332935333252
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.119 Vali Acc: 0.268 Test Loss: 4.119 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4555518627166748
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.177 Vali Acc: 0.271 Test Loss: 4.177 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4633462429046631
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.238 Vali Acc: 0.267 Test Loss: 4.238 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.47318267822265625
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.267 Vali Acc: 0.267 Test Loss: 4.267 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5251243114471436
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.308 Vali Acc: 0.273 Test Loss: 4.308 Test Acc: 0.273
Validation loss decreased (-0.270548 --> -0.272898).  Saving model ...
Epoch: 23 cost time: 0.45707154273986816
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.351 Vali Acc: 0.272 Test Loss: 4.351 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4509284496307373
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.403 Vali Acc: 0.275 Test Loss: 4.403 Test Acc: 0.275
Validation loss decreased (-0.272898 --> -0.275250).  Saving model ...
Epoch: 25 cost time: 0.4061093330383301
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.432 Vali Acc: 0.275 Test Loss: 4.432 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.47971558570861816
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.445 Vali Acc: 0.273 Test Loss: 4.445 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4898049831390381
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.457 Vali Acc: 0.272 Test Loss: 4.457 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4831259250640869
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.468 Vali Acc: 0.275 Test Loss: 4.468 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4480586051940918
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.506 Vali Acc: 0.275 Test Loss: 4.506 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.47028017044067383
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.518 Vali Acc: 0.271 Test Loss: 4.518 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4568324089050293
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.539 Vali Acc: 0.273 Test Loss: 4.539 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.44525694847106934
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.546 Vali Acc: 0.272 Test Loss: 4.546 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.44409751892089844
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.563 Vali Acc: 0.273 Test Loss: 4.563 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4643392562866211
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.579 Vali Acc: 0.274 Test Loss: 4.579 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 231962
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6604790687561035
Epoch: 1, Steps: 10 | Train Loss: 3.457 Vali Loss: 3.341 Vali Acc: 0.041 Test Loss: 3.341 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.459735631942749
Epoch: 2, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.314 Vali Acc: 0.053 Test Loss: 3.314 Test Acc: 0.053
Validation loss decreased (-0.041143 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.5170707702636719
Epoch: 3, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.321 Vali Acc: 0.064 Test Loss: 3.321 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.5002710819244385
Epoch: 4, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.302 Vali Acc: 0.088 Test Loss: 3.302 Test Acc: 0.088
Validation loss decreased (-0.063496 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 0.46982622146606445
Epoch: 5, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.292 Vali Acc: 0.109 Test Loss: 3.292 Test Acc: 0.109
Validation loss decreased (-0.088202 --> -0.109379).  Saving model ...
Epoch: 6 cost time: 0.49178075790405273
Epoch: 6, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.254 Vali Acc: 0.124 Test Loss: 3.254 Test Acc: 0.124
Validation loss decreased (-0.109379 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.557171106338501
Epoch: 7, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.242 Vali Acc: 0.139 Test Loss: 3.242 Test Acc: 0.139
Validation loss decreased (-0.123497 --> -0.138791).  Saving model ...
Epoch: 8 cost time: 0.5261449813842773
Epoch: 8, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.244 Vali Acc: 0.153 Test Loss: 3.244 Test Acc: 0.153
Validation loss decreased (-0.138791 --> -0.152909).  Saving model ...
Epoch: 9 cost time: 0.5160226821899414
Epoch: 9, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.250 Vali Acc: 0.169 Test Loss: 3.250 Test Acc: 0.169
Validation loss decreased (-0.152909 --> -0.169379).  Saving model ...
Epoch: 10 cost time: 0.4728825092315674
Epoch: 10, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.274 Vali Acc: 0.176 Test Loss: 3.274 Test Acc: 0.176
Validation loss decreased (-0.169379 --> -0.176438).  Saving model ...
Epoch: 11 cost time: 0.47289037704467773
Epoch: 11, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.301 Vali Acc: 0.200 Test Loss: 3.301 Test Acc: 0.200
Validation loss decreased (-0.176438 --> -0.199967).  Saving model ...
Epoch: 12 cost time: 0.508404016494751
Epoch: 12, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.342 Vali Acc: 0.209 Test Loss: 3.342 Test Acc: 0.209
Validation loss decreased (-0.199967 --> -0.209378).  Saving model ...
Epoch: 13 cost time: 0.47033238410949707
Epoch: 13, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.387 Vali Acc: 0.224 Test Loss: 3.387 Test Acc: 0.224
Validation loss decreased (-0.209378 --> -0.223496).  Saving model ...
Epoch: 14 cost time: 0.4592621326446533
Epoch: 14, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.423 Vali Acc: 0.225 Test Loss: 3.423 Test Acc: 0.225
Validation loss decreased (-0.223496 --> -0.224672).  Saving model ...
Epoch: 15 cost time: 0.4744846820831299
Epoch: 15, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.486 Vali Acc: 0.229 Test Loss: 3.486 Test Acc: 0.229
Validation loss decreased (-0.224672 --> -0.229377).  Saving model ...
Epoch: 16 cost time: 0.5177011489868164
Epoch: 16, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.539 Vali Acc: 0.236 Test Loss: 3.539 Test Acc: 0.236
Validation loss decreased (-0.229377 --> -0.236435).  Saving model ...
Epoch: 17 cost time: 0.49851346015930176
Epoch: 17, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.619 Vali Acc: 0.251 Test Loss: 3.619 Test Acc: 0.251
Validation loss decreased (-0.236435 --> -0.250552).  Saving model ...
Epoch: 18 cost time: 0.546227216720581
Epoch: 18, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.652 Vali Acc: 0.242 Test Loss: 3.652 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42208194732666016
Epoch: 19, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.715 Vali Acc: 0.255 Test Loss: 3.715 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255257).  Saving model ...
Epoch: 20 cost time: 0.4548945426940918
Epoch: 20, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.785 Vali Acc: 0.254 Test Loss: 3.785 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5512170791625977
Epoch: 21, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.842 Vali Acc: 0.256 Test Loss: 3.842 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256432).  Saving model ...
Epoch: 22 cost time: 0.4919114112854004
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.917 Vali Acc: 0.266 Test Loss: 3.917 Test Acc: 0.266
Validation loss decreased (-0.256432 --> -0.265843).  Saving model ...
Epoch: 23 cost time: 0.4644923210144043
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.933 Vali Acc: 0.264 Test Loss: 3.933 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.48595237731933594
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.988 Vali Acc: 0.253 Test Loss: 3.988 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5019545555114746
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.037 Vali Acc: 0.264 Test Loss: 4.037 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4865264892578125
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.038 Vali Acc: 0.260 Test Loss: 4.038 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46704673767089844
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.085 Vali Acc: 0.271 Test Loss: 4.085 Test Acc: 0.271
Validation loss decreased (-0.265843 --> -0.270547).  Saving model ...
Epoch: 28 cost time: 0.4879910945892334
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.156 Vali Acc: 0.265 Test Loss: 4.156 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5473270416259766
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.157 Vali Acc: 0.264 Test Loss: 4.157 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5863854885101318
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.152 Vali Acc: 0.271 Test Loss: 4.152 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.48755669593811035
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.179 Vali Acc: 0.271 Test Loss: 4.179 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5336565971374512
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.194 Vali Acc: 0.272 Test Loss: 4.194 Test Acc: 0.272
Validation loss decreased (-0.270547 --> -0.271723).  Saving model ...
Epoch: 33 cost time: 0.4847104549407959
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.207 Vali Acc: 0.272 Test Loss: 4.207 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.42391204833984375
Epoch: 34, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.241 Vali Acc: 0.273 Test Loss: 4.241 Test Acc: 0.273
Validation loss decreased (-0.271723 --> -0.272899).  Saving model ...
Epoch: 35 cost time: 0.4609255790710449
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.260 Vali Acc: 0.272 Test Loss: 4.260 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4884345531463623
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.271 Vali Acc: 0.273 Test Loss: 4.271 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.44831371307373047
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.290 Vali Acc: 0.272 Test Loss: 4.290 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.45667147636413574
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.307 Vali Acc: 0.272 Test Loss: 4.307 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.47107863426208496
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.310 Vali Acc: 0.269 Test Loss: 4.310 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.49998974800109863
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.326 Vali Acc: 0.272 Test Loss: 4.326 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.44022059440612793
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.338 Vali Acc: 0.268 Test Loss: 4.338 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.486508846282959
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.365 Vali Acc: 0.276 Test Loss: 4.365 Test Acc: 0.276
Validation loss decreased (-0.272899 --> -0.276427).  Saving model ...
Epoch: 43 cost time: 0.5145947933197021
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.388 Vali Acc: 0.272 Test Loss: 4.388 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4603769779205322
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.401 Vali Acc: 0.271 Test Loss: 4.401 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5143356323242188
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.412 Vali Acc: 0.269 Test Loss: 4.412 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.441601037979126
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.414 Vali Acc: 0.267 Test Loss: 4.414 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.43884849548339844
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.419 Vali Acc: 0.272 Test Loss: 4.419 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4377450942993164
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.449 Vali Acc: 0.274 Test Loss: 4.449 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.498105525970459
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.463 Vali Acc: 0.272 Test Loss: 4.463 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5251598358154297
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.469 Vali Acc: 0.275 Test Loss: 4.469 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5005111694335938
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.481 Vali Acc: 0.275 Test Loss: 4.481 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.4920797348022461
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.487 Vali Acc: 0.278 Test Loss: 4.487 Test Acc: 0.278
Validation loss decreased (-0.276427 --> -0.277602).  Saving model ...
Epoch: 53 cost time: 0.5156652927398682
Epoch: 53, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.510 Vali Acc: 0.275 Test Loss: 4.510 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5360162258148193
Epoch: 54, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.512 Vali Acc: 0.275 Test Loss: 4.512 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.49714064598083496
Epoch: 55, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.526 Vali Acc: 0.273 Test Loss: 4.526 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.44405174255371094
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.542 Vali Acc: 0.273 Test Loss: 4.542 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.4576559066772461
Epoch: 57, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.553 Vali Acc: 0.274 Test Loss: 4.553 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5194752216339111
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.580 Vali Acc: 0.274 Test Loss: 4.580 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.48433852195739746
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.587 Vali Acc: 0.275 Test Loss: 4.587 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.42723608016967773
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.588 Vali Acc: 0.275 Test Loss: 4.588 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.4749891757965088
Epoch: 61, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.605 Vali Acc: 0.273 Test Loss: 4.605 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.5285353660583496
Epoch: 62, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.604 Vali Acc: 0.274 Test Loss: 4.604 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 137242
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3444650173187256
Epoch: 1, Steps: 10 | Train Loss: 3.522 Vali Loss: 3.358 Vali Acc: 0.029 Test Loss: 3.358 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.427152156829834
Epoch: 2, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.330 Vali Acc: 0.040 Test Loss: 3.330 Test Acc: 0.040
Validation loss decreased (-0.029378 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.4269294738769531
Epoch: 3, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.320 Vali Acc: 0.051 Test Loss: 3.320 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.47130441665649414
Epoch: 4, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.323 Vali Acc: 0.059 Test Loss: 3.323 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.46561360359191895
Epoch: 5, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.318 Vali Acc: 0.080 Test Loss: 3.318 Test Acc: 0.080
Validation loss decreased (-0.058790 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.4501063823699951
Epoch: 6, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.295 Vali Acc: 0.100 Test Loss: 3.295 Test Acc: 0.100
Validation loss decreased (-0.079967 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 0.49486708641052246
Epoch: 7, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.271 Vali Acc: 0.114 Test Loss: 3.271 Test Acc: 0.114
Validation loss decreased (-0.099967 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.45497703552246094
Epoch: 8, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.242 Vali Acc: 0.120 Test Loss: 3.242 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119968).  Saving model ...
Epoch: 9 cost time: 0.47908687591552734
Epoch: 9, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.232 Vali Acc: 0.139 Test Loss: 3.232 Test Acc: 0.139
Validation loss decreased (-0.119968 --> -0.138791).  Saving model ...
Epoch: 10 cost time: 0.43678784370422363
Epoch: 10, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.225 Vali Acc: 0.148 Test Loss: 3.225 Test Acc: 0.148
Validation loss decreased (-0.138791 --> -0.148203).  Saving model ...
Epoch: 11 cost time: 0.45198607444763184
Epoch: 11, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.220 Vali Acc: 0.159 Test Loss: 3.220 Test Acc: 0.159
Validation loss decreased (-0.148203 --> -0.158791).  Saving model ...
Epoch: 12 cost time: 0.43633294105529785
Epoch: 12, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.232 Vali Acc: 0.174 Test Loss: 3.232 Test Acc: 0.174
Validation loss decreased (-0.158791 --> -0.174085).  Saving model ...
Epoch: 13 cost time: 0.4842221736907959
Epoch: 13, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.240 Vali Acc: 0.180 Test Loss: 3.240 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 0.45358824729919434
Epoch: 14, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.264 Vali Acc: 0.194 Test Loss: 3.264 Test Acc: 0.194
Validation loss decreased (-0.179968 --> -0.194085).  Saving model ...
Epoch: 15 cost time: 0.46583032608032227
Epoch: 15, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.274 Vali Acc: 0.201 Test Loss: 3.274 Test Acc: 0.201
Validation loss decreased (-0.194085 --> -0.201144).  Saving model ...
Epoch: 16 cost time: 0.47975993156433105
Epoch: 16, Steps: 10 | Train Loss: 0.943 Vali Loss: 3.317 Vali Acc: 0.201 Test Loss: 3.317 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45343804359436035
Epoch: 17, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.367 Vali Acc: 0.214 Test Loss: 3.367 Test Acc: 0.214
Validation loss decreased (-0.201144 --> -0.214084).  Saving model ...
Epoch: 18 cost time: 0.44840312004089355
Epoch: 18, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.386 Vali Acc: 0.216 Test Loss: 3.386 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216437).  Saving model ...
Epoch: 19 cost time: 0.4832611083984375
Epoch: 19, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.433 Vali Acc: 0.229 Test Loss: 3.433 Test Acc: 0.229
Validation loss decreased (-0.216437 --> -0.229377).  Saving model ...
Epoch: 20 cost time: 0.4268064498901367
Epoch: 20, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.501 Vali Acc: 0.221 Test Loss: 3.501 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4602961540222168
Epoch: 21, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.540 Vali Acc: 0.226 Test Loss: 3.540 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.44941210746765137
Epoch: 22, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.615 Vali Acc: 0.225 Test Loss: 3.615 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4763164520263672
Epoch: 23, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.667 Vali Acc: 0.238 Test Loss: 3.667 Test Acc: 0.238
Validation loss decreased (-0.229377 --> -0.237610).  Saving model ...
Epoch: 24 cost time: 0.4619863033294678
Epoch: 24, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.763 Vali Acc: 0.234 Test Loss: 3.763 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46515774726867676
Epoch: 25, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.806 Vali Acc: 0.235 Test Loss: 3.806 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4366569519042969
Epoch: 26, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.842 Vali Acc: 0.235 Test Loss: 3.842 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4434514045715332
Epoch: 27, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.898 Vali Acc: 0.242 Test Loss: 3.898 Test Acc: 0.242
Validation loss decreased (-0.237610 --> -0.242314).  Saving model ...
Epoch: 28 cost time: 0.4492530822753906
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.933 Vali Acc: 0.238 Test Loss: 3.933 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47466158866882324
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.954 Vali Acc: 0.234 Test Loss: 3.954 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.43787145614624023
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.996 Vali Acc: 0.233 Test Loss: 3.996 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.44507336616516113
Epoch: 31, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.019 Vali Acc: 0.231 Test Loss: 4.019 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.45969271659851074
Epoch: 32, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.030 Vali Acc: 0.233 Test Loss: 4.030 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5254478454589844
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.061 Vali Acc: 0.235 Test Loss: 4.061 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.42665886878967285
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.089 Vali Acc: 0.235 Test Loss: 4.089 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.49201464653015137
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.135 Vali Acc: 0.235 Test Loss: 4.135 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4526505470275879
Epoch: 36, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.164 Vali Acc: 0.235 Test Loss: 4.164 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4911942481994629
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.198 Vali Acc: 0.238 Test Loss: 4.198 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 104922
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.711545467376709
Epoch: 1, Steps: 10 | Train Loss: 3.431 Vali Loss: 3.346 Vali Acc: 0.052 Test Loss: 3.346 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.416989803314209
Epoch: 2, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.318 Vali Acc: 0.055 Test Loss: 3.318 Test Acc: 0.055
Validation loss decreased (-0.051731 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.4458446502685547
Epoch: 3, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.304 Vali Acc: 0.062 Test Loss: 3.304 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.4737284183502197
Epoch: 4, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.307 Vali Acc: 0.073 Test Loss: 3.307 Test Acc: 0.073
Validation loss decreased (-0.062320 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 0.4840819835662842
Epoch: 5, Steps: 10 | Train Loss: 2.897 Vali Loss: 3.307 Vali Acc: 0.085 Test Loss: 3.307 Test Acc: 0.085
Validation loss decreased (-0.072908 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.5150244235992432
Epoch: 6, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.296 Vali Acc: 0.093 Test Loss: 3.296 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 0.4740457534790039
Epoch: 7, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.285 Vali Acc: 0.104 Test Loss: 3.285 Test Acc: 0.104
Validation loss decreased (-0.092908 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.4664003849029541
Epoch: 8, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.273 Vali Acc: 0.114 Test Loss: 3.273 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.4871339797973633
Epoch: 9, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.260 Vali Acc: 0.125 Test Loss: 3.260 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124673).  Saving model ...
Epoch: 10 cost time: 0.4667201042175293
Epoch: 10, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.251 Vali Acc: 0.134 Test Loss: 3.251 Test Acc: 0.134
Validation loss decreased (-0.124673 --> -0.134085).  Saving model ...
Epoch: 11 cost time: 0.4591197967529297
Epoch: 11, Steps: 10 | Train Loss: 2.034 Vali Loss: 3.242 Vali Acc: 0.138 Test Loss: 3.242 Test Acc: 0.138
Validation loss decreased (-0.134085 --> -0.137615).  Saving model ...
Epoch: 12 cost time: 0.4723629951477051
Epoch: 12, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.250 Vali Acc: 0.148 Test Loss: 3.250 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 13 cost time: 0.46701812744140625
Epoch: 13, Steps: 10 | Train Loss: 1.645 Vali Loss: 3.253 Vali Acc: 0.154 Test Loss: 3.253 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.46453309059143066
Epoch: 14, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.271 Vali Acc: 0.173 Test Loss: 3.271 Test Acc: 0.173
Validation loss decreased (-0.154085 --> -0.172908).  Saving model ...
Epoch: 15 cost time: 0.5588517189025879
Epoch: 15, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.275 Vali Acc: 0.184 Test Loss: 3.275 Test Acc: 0.184
Validation loss decreased (-0.172908 --> -0.183497).  Saving model ...
Epoch: 16 cost time: 0.5026028156280518
Epoch: 16, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.305 Vali Acc: 0.198 Test Loss: 3.305 Test Acc: 0.198
Validation loss decreased (-0.183497 --> -0.197614).  Saving model ...
Epoch: 17 cost time: 0.4482719898223877
Epoch: 17, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.316 Vali Acc: 0.211 Test Loss: 3.316 Test Acc: 0.211
Validation loss decreased (-0.197614 --> -0.210555).  Saving model ...
Epoch: 18 cost time: 0.5208253860473633
Epoch: 18, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.341 Vali Acc: 0.232 Test Loss: 3.341 Test Acc: 0.232
Validation loss decreased (-0.210555 --> -0.231731).  Saving model ...
Epoch: 19 cost time: 0.6150093078613281
Epoch: 19, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.378 Vali Acc: 0.225 Test Loss: 3.378 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.499192476272583
Epoch: 20, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.404 Vali Acc: 0.233 Test Loss: 3.404 Test Acc: 0.233
Validation loss decreased (-0.231731 --> -0.232907).  Saving model ...
Epoch: 21 cost time: 0.48628711700439453
Epoch: 21, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.426 Vali Acc: 0.245 Test Loss: 3.426 Test Acc: 0.245
Validation loss decreased (-0.232907 --> -0.244672).  Saving model ...
Epoch: 22 cost time: 0.5108301639556885
Epoch: 22, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.478 Vali Acc: 0.247 Test Loss: 3.478 Test Acc: 0.247
Validation loss decreased (-0.244672 --> -0.247024).  Saving model ...
Epoch: 23 cost time: 0.5213804244995117
Epoch: 23, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.504 Vali Acc: 0.252 Test Loss: 3.504 Test Acc: 0.252
Validation loss decreased (-0.247024 --> -0.251730).  Saving model ...
Epoch: 24 cost time: 0.5069339275360107
Epoch: 24, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.537 Vali Acc: 0.253 Test Loss: 3.537 Test Acc: 0.253
Validation loss decreased (-0.251730 --> -0.252906).  Saving model ...
Epoch: 25 cost time: 0.5088443756103516
Epoch: 25, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.575 Vali Acc: 0.260 Test Loss: 3.575 Test Acc: 0.260
Validation loss decreased (-0.252906 --> -0.259964).  Saving model ...
Epoch: 26 cost time: 0.5318429470062256
Epoch: 26, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.618 Vali Acc: 0.254 Test Loss: 3.618 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.49370431900024414
Epoch: 27, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.653 Vali Acc: 0.256 Test Loss: 3.653 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.49433183670043945
Epoch: 28, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.693 Vali Acc: 0.251 Test Loss: 3.693 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4688997268676758
Epoch: 29, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.744 Vali Acc: 0.259 Test Loss: 3.744 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4731941223144531
Epoch: 30, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.778 Vali Acc: 0.262 Test Loss: 3.778 Test Acc: 0.262
Validation loss decreased (-0.259964 --> -0.262315).  Saving model ...
Epoch: 31 cost time: 0.4844176769256592
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.761 Vali Acc: 0.264 Test Loss: 3.761 Test Acc: 0.264
Validation loss decreased (-0.262315 --> -0.263492).  Saving model ...
Epoch: 32 cost time: 0.44738006591796875
Epoch: 32, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.786 Vali Acc: 0.266 Test Loss: 3.786 Test Acc: 0.266
Validation loss decreased (-0.263492 --> -0.265844).  Saving model ...
Epoch: 33 cost time: 0.5090744495391846
Epoch: 33, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.834 Vali Acc: 0.269 Test Loss: 3.834 Test Acc: 0.269
Validation loss decreased (-0.265844 --> -0.269373).  Saving model ...
Epoch: 34 cost time: 0.45696282386779785
Epoch: 34, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.878 Vali Acc: 0.265 Test Loss: 3.878 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4675712585449219
Epoch: 35, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.907 Vali Acc: 0.273 Test Loss: 3.907 Test Acc: 0.273
Validation loss decreased (-0.269373 --> -0.272902).  Saving model ...
Epoch: 36 cost time: 0.4692375659942627
Epoch: 36, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.923 Vali Acc: 0.275 Test Loss: 3.923 Test Acc: 0.275
Validation loss decreased (-0.272902 --> -0.275255).  Saving model ...
Epoch: 37 cost time: 0.44739365577697754
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.940 Vali Acc: 0.275 Test Loss: 3.940 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5020346641540527
Epoch: 38, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.951 Vali Acc: 0.273 Test Loss: 3.951 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4919595718383789
Epoch: 39, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.969 Vali Acc: 0.273 Test Loss: 3.969 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5562229156494141
Epoch: 40, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.980 Vali Acc: 0.276 Test Loss: 3.980 Test Acc: 0.276
Validation loss decreased (-0.275255 --> -0.276431).  Saving model ...
Epoch: 41 cost time: 0.54233717918396
Epoch: 41, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.991 Vali Acc: 0.278 Test Loss: 3.991 Test Acc: 0.278
Validation loss decreased (-0.276431 --> -0.277607).  Saving model ...
Epoch: 42 cost time: 0.49152255058288574
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.030 Vali Acc: 0.273 Test Loss: 4.030 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5044229030609131
Epoch: 43, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.048 Vali Acc: 0.271 Test Loss: 4.048 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.45975565910339355
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.060 Vali Acc: 0.271 Test Loss: 4.060 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.4976370334625244
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.051 Vali Acc: 0.271 Test Loss: 4.051 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.48601818084716797
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.064 Vali Acc: 0.272 Test Loss: 4.064 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5407676696777344
Epoch: 47, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.099 Vali Acc: 0.271 Test Loss: 4.099 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5638396739959717
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.127 Vali Acc: 0.273 Test Loss: 4.127 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.46542811393737793
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.153 Vali Acc: 0.273 Test Loss: 4.153 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.47188591957092285
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.162 Vali Acc: 0.274 Test Loss: 4.162 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.4683868885040283
Epoch: 51, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.184 Vali Acc: 0.273 Test Loss: 4.184 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 90074
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3666157722473145
Epoch: 1, Steps: 10 | Train Loss: 3.389 Vali Loss: 3.339 Vali Acc: 0.049 Test Loss: 3.339 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.4648914337158203
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.321 Vali Acc: 0.056 Test Loss: 3.321 Test Acc: 0.056
Validation loss decreased (-0.049378 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.44605016708374023
Epoch: 3, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.309 Vali Acc: 0.054 Test Loss: 3.309 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.46808886528015137
Epoch: 4, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.295 Vali Acc: 0.058 Test Loss: 3.295 Test Acc: 0.058
Validation loss decreased (-0.056437 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.4988846778869629
Epoch: 5, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.290 Vali Acc: 0.068 Test Loss: 3.290 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 0.49514317512512207
Epoch: 6, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.281 Vali Acc: 0.076 Test Loss: 3.281 Test Acc: 0.076
Validation loss decreased (-0.068202 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.47844433784484863
Epoch: 7, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
Validation loss decreased (-0.076438 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.5481500625610352
Epoch: 8, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.266 Vali Acc: 0.093 Test Loss: 3.266 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.44983696937561035
Epoch: 9, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.256 Vali Acc: 0.100 Test Loss: 3.256 Test Acc: 0.100
Validation loss decreased (-0.092909 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 0.5087416172027588
Epoch: 10, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.246 Vali Acc: 0.100 Test Loss: 3.246 Test Acc: 0.100
Validation loss decreased (-0.099967 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.4871060848236084
Epoch: 11, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.237 Vali Acc: 0.109 Test Loss: 3.237 Test Acc: 0.109
Validation loss decreased (-0.099968 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 0.4731905460357666
Epoch: 12, Steps: 10 | Train Loss: 2.185 Vali Loss: 3.234 Vali Acc: 0.121 Test Loss: 3.234 Test Acc: 0.121
Validation loss decreased (-0.109379 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 0.4719243049621582
Epoch: 13, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.234 Vali Acc: 0.128 Test Loss: 3.234 Test Acc: 0.128
Validation loss decreased (-0.121144 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.5075654983520508
Epoch: 14, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.236 Vali Acc: 0.134 Test Loss: 3.236 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.5505466461181641
Epoch: 15, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.242 Vali Acc: 0.145 Test Loss: 3.242 Test Acc: 0.145
Validation loss decreased (-0.134085 --> -0.144673).  Saving model ...
Epoch: 16 cost time: 0.4565122127532959
Epoch: 16, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.239 Vali Acc: 0.147 Test Loss: 3.239 Test Acc: 0.147
Validation loss decreased (-0.144673 --> -0.147026).  Saving model ...
Epoch: 17 cost time: 0.48326730728149414
Epoch: 17, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.252 Vali Acc: 0.162 Test Loss: 3.252 Test Acc: 0.162
Validation loss decreased (-0.147026 --> -0.162320).  Saving model ...
Epoch: 18 cost time: 0.4437599182128906
Epoch: 18, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.268 Vali Acc: 0.171 Test Loss: 3.268 Test Acc: 0.171
Validation loss decreased (-0.162320 --> -0.170556).  Saving model ...
Epoch: 19 cost time: 0.45253682136535645
Epoch: 19, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.294 Vali Acc: 0.174 Test Loss: 3.294 Test Acc: 0.174
Validation loss decreased (-0.170556 --> -0.174085).  Saving model ...
Epoch: 20 cost time: 0.45856142044067383
Epoch: 20, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.309 Vali Acc: 0.189 Test Loss: 3.309 Test Acc: 0.189
Validation loss decreased (-0.174085 --> -0.189379).  Saving model ...
Epoch: 21 cost time: 0.43338894844055176
Epoch: 21, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.325 Vali Acc: 0.201 Test Loss: 3.325 Test Acc: 0.201
Validation loss decreased (-0.189379 --> -0.201143).  Saving model ...
Epoch: 22 cost time: 0.4915761947631836
Epoch: 22, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.325 Vali Acc: 0.209 Test Loss: 3.325 Test Acc: 0.209
Validation loss decreased (-0.201143 --> -0.209379).  Saving model ...
Epoch: 23 cost time: 0.4201376438140869
Epoch: 23, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.347 Vali Acc: 0.208 Test Loss: 3.347 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4266648292541504
Epoch: 24, Steps: 10 | Train Loss: 0.861 Vali Loss: 3.373 Vali Acc: 0.209 Test Loss: 3.373 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4651353359222412
Epoch: 25, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.396 Vali Acc: 0.213 Test Loss: 3.396 Test Acc: 0.213
Validation loss decreased (-0.209379 --> -0.212907).  Saving model ...
Epoch: 26 cost time: 0.5852186679840088
Epoch: 26, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.425 Vali Acc: 0.222 Test Loss: 3.425 Test Acc: 0.222
Validation loss decreased (-0.212907 --> -0.222319).  Saving model ...
Epoch: 27 cost time: 0.4880099296569824
Epoch: 27, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.450 Vali Acc: 0.226 Test Loss: 3.450 Test Acc: 0.226
Validation loss decreased (-0.222319 --> -0.225848).  Saving model ...
Epoch: 28 cost time: 0.49632954597473145
Epoch: 28, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.475 Vali Acc: 0.241 Test Loss: 3.475 Test Acc: 0.241
Validation loss decreased (-0.225848 --> -0.241142).  Saving model ...
Epoch: 29 cost time: 0.4795544147491455
Epoch: 29, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.507 Vali Acc: 0.240 Test Loss: 3.507 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5204448699951172
Epoch: 30, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.520 Vali Acc: 0.249 Test Loss: 3.520 Test Acc: 0.249
Validation loss decreased (-0.241142 --> -0.249377).  Saving model ...
Epoch: 31 cost time: 0.4866769313812256
Epoch: 31, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.543 Vali Acc: 0.252 Test Loss: 3.543 Test Acc: 0.252
Validation loss decreased (-0.249377 --> -0.251729).  Saving model ...
Epoch: 32 cost time: 0.4805316925048828
Epoch: 32, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.575 Vali Acc: 0.252 Test Loss: 3.575 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.45477986335754395
Epoch: 33, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.603 Vali Acc: 0.253 Test Loss: 3.603 Test Acc: 0.253
Validation loss decreased (-0.251729 --> -0.252905).  Saving model ...
Epoch: 34 cost time: 0.48163866996765137
Epoch: 34, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.623 Vali Acc: 0.251 Test Loss: 3.623 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4267311096191406
Epoch: 35, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.641 Vali Acc: 0.259 Test Loss: 3.641 Test Acc: 0.259
Validation loss decreased (-0.252905 --> -0.258787).  Saving model ...
Epoch: 36 cost time: 0.45572686195373535
Epoch: 36, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.663 Vali Acc: 0.259 Test Loss: 3.663 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4727339744567871
Epoch: 37, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.703 Vali Acc: 0.258 Test Loss: 3.703 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4944949150085449
Epoch: 38, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.731 Vali Acc: 0.255 Test Loss: 3.731 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.48723316192626953
Epoch: 39, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.740 Vali Acc: 0.253 Test Loss: 3.740 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4827914237976074
Epoch: 40, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.750 Vali Acc: 0.253 Test Loss: 3.750 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.45052242279052734
Epoch: 41, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.774 Vali Acc: 0.254 Test Loss: 3.774 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4959423542022705
Epoch: 42, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.790 Vali Acc: 0.254 Test Loss: 3.790 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4859769344329834
Epoch: 43, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.802 Vali Acc: 0.259 Test Loss: 3.802 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.47126007080078125
Epoch: 44, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.821 Vali Acc: 0.260 Test Loss: 3.821 Test Acc: 0.260
Validation loss decreased (-0.258787 --> -0.259962).  Saving model ...
Epoch: 45 cost time: 0.4591505527496338
Epoch: 45, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.828 Vali Acc: 0.259 Test Loss: 3.828 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4409153461456299
Epoch: 46, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.832 Vali Acc: 0.264 Test Loss: 3.832 Test Acc: 0.264
Validation loss decreased (-0.259962 --> -0.263491).  Saving model ...
Epoch: 47 cost time: 0.46006226539611816
Epoch: 47, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.862 Vali Acc: 0.261 Test Loss: 3.862 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.48408031463623047
Epoch: 48, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.883 Vali Acc: 0.259 Test Loss: 3.883 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4387032985687256
Epoch: 49, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.907 Vali Acc: 0.264 Test Loss: 3.907 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.45499396324157715
Epoch: 50, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.922 Vali Acc: 0.260 Test Loss: 3.922 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5062460899353027
Epoch: 51, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.948 Vali Acc: 0.256 Test Loss: 3.948 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.4636838436126709
Epoch: 52, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.954 Vali Acc: 0.255 Test Loss: 3.954 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.45100998878479004
Epoch: 53, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.967 Vali Acc: 0.253 Test Loss: 3.967 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.48905515670776367
Epoch: 54, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.975 Vali Acc: 0.258 Test Loss: 3.975 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.4862382411956787
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.992 Vali Acc: 0.261 Test Loss: 3.992 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.48650264739990234
Epoch: 56, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.004 Vali Acc: 0.261 Test Loss: 4.004 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 72826
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3921799659729004
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.375 Vali Acc: 0.040 Test Loss: 3.375 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4785747528076172
Epoch: 2, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.355 Vali Acc: 0.041 Test Loss: 3.355 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.45247507095336914
Epoch: 3, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.340 Vali Acc: 0.047 Test Loss: 3.340 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047025).  Saving model ...
Epoch: 4 cost time: 0.4576387405395508
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.325 Vali Acc: 0.048 Test Loss: 3.325 Test Acc: 0.048
Validation loss decreased (-0.047025 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.4656851291656494
Epoch: 5, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.312 Vali Acc: 0.049 Test Loss: 3.312 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.5073990821838379
Epoch: 6, Steps: 10 | Train Loss: 3.036 Vali Loss: 3.298 Vali Acc: 0.051 Test Loss: 3.298 Test Acc: 0.051
Validation loss decreased (-0.049379 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 0.48816347122192383
Epoch: 7, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.292 Vali Acc: 0.059 Test Loss: 3.292 Test Acc: 0.059
Validation loss decreased (-0.050555 --> -0.058791).  Saving model ...
Epoch: 8 cost time: 0.44206762313842773
Epoch: 8, Steps: 10 | Train Loss: 2.737 Vali Loss: 3.281 Vali Acc: 0.073 Test Loss: 3.281 Test Acc: 0.073
Validation loss decreased (-0.058791 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.4995906352996826
Epoch: 9, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.278 Vali Acc: 0.084 Test Loss: 3.278 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.46901750564575195
Epoch: 10, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.271 Vali Acc: 0.100 Test Loss: 3.271 Test Acc: 0.100
Validation loss decreased (-0.083497 --> -0.099967).  Saving model ...
Epoch: 11 cost time: 0.5344505310058594
Epoch: 11, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.265 Vali Acc: 0.107 Test Loss: 3.265 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107026).  Saving model ...
Epoch: 12 cost time: 0.46661853790283203
Epoch: 12, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.261 Vali Acc: 0.116 Test Loss: 3.261 Test Acc: 0.116
Validation loss decreased (-0.107026 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 0.4563891887664795
Epoch: 13, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.253 Vali Acc: 0.122 Test Loss: 3.253 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122320).  Saving model ...
Epoch: 14 cost time: 0.5575473308563232
Epoch: 14, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.250 Vali Acc: 0.128 Test Loss: 3.250 Test Acc: 0.128
Validation loss decreased (-0.122320 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 0.5048575401306152
Epoch: 15, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.254 Vali Acc: 0.140 Test Loss: 3.254 Test Acc: 0.140
Validation loss decreased (-0.128203 --> -0.139967).  Saving model ...
Epoch: 16 cost time: 0.4890151023864746
Epoch: 16, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.257 Vali Acc: 0.135 Test Loss: 3.257 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.511939287185669
Epoch: 17, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.249 Vali Acc: 0.155 Test Loss: 3.249 Test Acc: 0.155
Validation loss decreased (-0.139967 --> -0.155262).  Saving model ...
Epoch: 18 cost time: 0.43437957763671875
Epoch: 18, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.249 Vali Acc: 0.159 Test Loss: 3.249 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 0.5235452651977539
Epoch: 19, Steps: 10 | Train Loss: 1.574 Vali Loss: 3.253 Vali Acc: 0.169 Test Loss: 3.253 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 0.47957658767700195
Epoch: 20, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.265 Vali Acc: 0.171 Test Loss: 3.265 Test Acc: 0.171
Validation loss decreased (-0.169379 --> -0.170556).  Saving model ...
Epoch: 21 cost time: 0.5046277046203613
Epoch: 21, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.277 Vali Acc: 0.175 Test Loss: 3.277 Test Acc: 0.175
Validation loss decreased (-0.170556 --> -0.175261).  Saving model ...
Epoch: 22 cost time: 0.4466423988342285
Epoch: 22, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.296 Vali Acc: 0.175 Test Loss: 3.296 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4413301944732666
Epoch: 23, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.288 Vali Acc: 0.189 Test Loss: 3.288 Test Acc: 0.189
Validation loss decreased (-0.175261 --> -0.189379).  Saving model ...
Epoch: 24 cost time: 0.4333982467651367
Epoch: 24, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.290 Vali Acc: 0.192 Test Loss: 3.290 Test Acc: 0.192
Validation loss decreased (-0.189379 --> -0.191732).  Saving model ...
Epoch: 25 cost time: 0.4533860683441162
Epoch: 25, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.308 Vali Acc: 0.201 Test Loss: 3.308 Test Acc: 0.201
Validation loss decreased (-0.191732 --> -0.201143).  Saving model ...
Epoch: 26 cost time: 0.4750180244445801
Epoch: 26, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.334 Vali Acc: 0.208 Test Loss: 3.334 Test Acc: 0.208
Validation loss decreased (-0.201143 --> -0.208202).  Saving model ...
Epoch: 27 cost time: 0.45978355407714844
Epoch: 27, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.357 Vali Acc: 0.208 Test Loss: 3.357 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4402620792388916
Epoch: 28, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.373 Vali Acc: 0.209 Test Loss: 3.373 Test Acc: 0.209
Validation loss decreased (-0.208202 --> -0.209378).  Saving model ...
Epoch: 29 cost time: 0.4779977798461914
Epoch: 29, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.389 Vali Acc: 0.216 Test Loss: 3.389 Test Acc: 0.216
Validation loss decreased (-0.209378 --> -0.216437).  Saving model ...
Epoch: 30 cost time: 0.4888420104980469
Epoch: 30, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.410 Vali Acc: 0.212 Test Loss: 3.410 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.46667981147766113
Epoch: 31, Steps: 10 | Train Loss: 0.579 Vali Loss: 3.450 Vali Acc: 0.215 Test Loss: 3.450 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4696636199951172
Epoch: 32, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.443 Vali Acc: 0.219 Test Loss: 3.443 Test Acc: 0.219
Validation loss decreased (-0.216437 --> -0.218789).  Saving model ...
Epoch: 33 cost time: 0.46665334701538086
Epoch: 33, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.454 Vali Acc: 0.220 Test Loss: 3.454 Test Acc: 0.220
Validation loss decreased (-0.218789 --> -0.219965).  Saving model ...
Epoch: 34 cost time: 0.4878199100494385
Epoch: 34, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.481 Vali Acc: 0.218 Test Loss: 3.481 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4591238498687744
Epoch: 35, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.518 Vali Acc: 0.225 Test Loss: 3.518 Test Acc: 0.225
Validation loss decreased (-0.219965 --> -0.224671).  Saving model ...
Epoch: 36 cost time: 0.45197057723999023
Epoch: 36, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.556 Vali Acc: 0.229 Test Loss: 3.556 Test Acc: 0.229
Validation loss decreased (-0.224671 --> -0.229376).  Saving model ...
Epoch: 37 cost time: 0.5136606693267822
Epoch: 37, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.589 Vali Acc: 0.226 Test Loss: 3.589 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5175268650054932
Epoch: 38, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.588 Vali Acc: 0.231 Test Loss: 3.588 Test Acc: 0.231
Validation loss decreased (-0.229376 --> -0.230552).  Saving model ...
Epoch: 39 cost time: 0.5254600048065186
Epoch: 39, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.614 Vali Acc: 0.229 Test Loss: 3.614 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5000848770141602
Epoch: 40, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.639 Vali Acc: 0.235 Test Loss: 3.639 Test Acc: 0.235
Validation loss decreased (-0.230552 --> -0.235258).  Saving model ...
Epoch: 41 cost time: 0.4131922721862793
Epoch: 41, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.662 Vali Acc: 0.232 Test Loss: 3.662 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.48631882667541504
Epoch: 42, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.660 Vali Acc: 0.231 Test Loss: 3.660 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.49839067459106445
Epoch: 43, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.674 Vali Acc: 0.236 Test Loss: 3.674 Test Acc: 0.236
Validation loss decreased (-0.235258 --> -0.236434).  Saving model ...
Epoch: 44 cost time: 0.5093305110931396
Epoch: 44, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.688 Vali Acc: 0.240 Test Loss: 3.688 Test Acc: 0.240
Validation loss decreased (-0.236434 --> -0.239963).  Saving model ...
Epoch: 45 cost time: 0.47457289695739746
Epoch: 45, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.700 Vali Acc: 0.240 Test Loss: 3.700 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4872100353240967
Epoch: 46, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.732 Vali Acc: 0.241 Test Loss: 3.732 Test Acc: 0.241
Validation loss decreased (-0.239963 --> -0.241139).  Saving model ...
Epoch: 47 cost time: 0.47917819023132324
Epoch: 47, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.734 Vali Acc: 0.238 Test Loss: 3.734 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.47417306900024414
Epoch: 48, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.737 Vali Acc: 0.245 Test Loss: 3.737 Test Acc: 0.245
Validation loss decreased (-0.241139 --> -0.244669).  Saving model ...
Epoch: 49 cost time: 0.5021934509277344
Epoch: 49, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.763 Vali Acc: 0.241 Test Loss: 3.763 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5040078163146973
Epoch: 50, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.813 Vali Acc: 0.241 Test Loss: 3.813 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.47130656242370605
Epoch: 51, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.839 Vali Acc: 0.234 Test Loss: 3.839 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.49915480613708496
Epoch: 52, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.859 Vali Acc: 0.238 Test Loss: 3.859 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.4777188301086426
Epoch: 53, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.822 Vali Acc: 0.245 Test Loss: 3.822 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.4530911445617676
Epoch: 54, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.840 Vali Acc: 0.244 Test Loss: 3.840 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.47708630561828613
Epoch: 55, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.897 Vali Acc: 0.241 Test Loss: 3.897 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.49263978004455566
Epoch: 56, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.892 Vali Acc: 0.244 Test Loss: 3.892 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.46456074714660645
Epoch: 57, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.919 Vali Acc: 0.241 Test Loss: 3.919 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.5187170505523682
Epoch: 58, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.926 Vali Acc: 0.249 Test Loss: 3.926 Test Acc: 0.249
Validation loss decreased (-0.244669 --> -0.249373).  Saving model ...
Epoch: 59 cost time: 0.460268497467041
Epoch: 59, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.919 Vali Acc: 0.249 Test Loss: 3.919 Test Acc: 0.249
Validation loss decreased (-0.249373 --> -0.249373).  Saving model ...
Epoch: 60 cost time: 0.4779176712036133
Epoch: 60, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.943 Vali Acc: 0.251 Test Loss: 3.943 Test Acc: 0.251
Validation loss decreased (-0.249373 --> -0.250549).  Saving model ...
Epoch: 61 cost time: 0.4930698871612549
Epoch: 61, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.957 Vali Acc: 0.249 Test Loss: 3.957 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.49781155586242676
Epoch: 62, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.988 Vali Acc: 0.248 Test Loss: 3.988 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5131685733795166
Epoch: 63, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.003 Vali Acc: 0.247 Test Loss: 4.003 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.4962942600250244
Epoch: 64, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.014 Vali Acc: 0.249 Test Loss: 4.014 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.4890151023864746
Epoch: 65, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.007 Vali Acc: 0.248 Test Loss: 4.007 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5014452934265137
Epoch: 66, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.009 Vali Acc: 0.256 Test Loss: 4.009 Test Acc: 0.256
Validation loss decreased (-0.250549 --> -0.256430).  Saving model ...
Epoch: 67 cost time: 0.4935297966003418
Epoch: 67, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.021 Vali Acc: 0.252 Test Loss: 4.021 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.4855015277862549
Epoch: 68, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.027 Vali Acc: 0.256 Test Loss: 4.027 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.4709501266479492
Epoch: 69, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.052 Vali Acc: 0.255 Test Loss: 4.052 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.46509337425231934
Epoch: 70, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.052 Vali Acc: 0.254 Test Loss: 4.052 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.44095659255981445
Epoch: 71, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.057 Vali Acc: 0.251 Test Loss: 4.057 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.4987165927886963
Epoch: 72, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.080 Vali Acc: 0.258 Test Loss: 4.080 Test Acc: 0.258
Validation loss decreased (-0.256430 --> -0.257606).  Saving model ...
Epoch: 73 cost time: 0.4506034851074219
Epoch: 73, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.109 Vali Acc: 0.253 Test Loss: 4.109 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.4603085517883301
Epoch: 74, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.090 Vali Acc: 0.260 Test Loss: 4.090 Test Acc: 0.260
Validation loss decreased (-0.257606 --> -0.259959).  Saving model ...
Epoch: 75 cost time: 0.4723653793334961
Epoch: 75, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.104 Vali Acc: 0.256 Test Loss: 4.104 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.4444413185119629
Epoch: 76, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.113 Vali Acc: 0.256 Test Loss: 4.113 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.44889092445373535
Epoch: 77, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.118 Vali Acc: 0.261 Test Loss: 4.118 Test Acc: 0.261
Validation loss decreased (-0.259959 --> -0.261135).  Saving model ...
Epoch: 78 cost time: 0.5008096694946289
Epoch: 78, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.132 Vali Acc: 0.256 Test Loss: 4.132 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5065088272094727
Epoch: 79, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.141 Vali Acc: 0.255 Test Loss: 4.141 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.534177303314209
Epoch: 80, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.144 Vali Acc: 0.258 Test Loss: 4.144 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.5601367950439453
Epoch: 81, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.164 Vali Acc: 0.254 Test Loss: 4.164 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.500422477722168
Epoch: 82, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.188 Vali Acc: 0.252 Test Loss: 4.188 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5090465545654297
Epoch: 83, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.180 Vali Acc: 0.253 Test Loss: 4.180 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.4793822765350342
Epoch: 84, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.180 Vali Acc: 0.252 Test Loss: 4.180 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.43528294563293457
Epoch: 85, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.204 Vali Acc: 0.252 Test Loss: 4.204 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.4681260585784912
Epoch: 86, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.214 Vali Acc: 0.252 Test Loss: 4.214 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.4788491725921631
Epoch: 87, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.218 Vali Acc: 0.256 Test Loss: 4.218 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 65594
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.327172040939331
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.448 Vali Acc: 0.044 Test Loss: 3.448 Test Acc: 0.044
Validation loss decreased (inf --> -0.043495).  Saving model ...
Epoch: 2 cost time: 0.43089866638183594
Epoch: 2, Steps: 10 | Train Loss: 3.445 Vali Loss: 3.429 Vali Acc: 0.038 Test Loss: 3.429 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49490952491760254
Epoch: 3, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.417 Vali Acc: 0.041 Test Loss: 3.417 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4307737350463867
Epoch: 4, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.398 Vali Acc: 0.042 Test Loss: 3.398 Test Acc: 0.042
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4439232349395752
Epoch: 5, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.376 Vali Acc: 0.047 Test Loss: 3.376 Test Acc: 0.047
Validation loss decreased (-0.043495 --> -0.047025).  Saving model ...
Epoch: 6 cost time: 0.43086838722229004
Epoch: 6, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.360 Vali Acc: 0.056 Test Loss: 3.360 Test Acc: 0.056
Validation loss decreased (-0.047025 --> -0.056437).  Saving model ...
Epoch: 7 cost time: 0.4453444480895996
Epoch: 7, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.344 Vali Acc: 0.066 Test Loss: 3.344 Test Acc: 0.066
Validation loss decreased (-0.056437 --> -0.065849).  Saving model ...
Epoch: 8 cost time: 0.44599246978759766
Epoch: 8, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.329 Vali Acc: 0.072 Test Loss: 3.329 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 9 cost time: 0.44330382347106934
Epoch: 9, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.318 Vali Acc: 0.082 Test Loss: 3.318 Test Acc: 0.082
Validation loss decreased (-0.071731 --> -0.082320).  Saving model ...
Epoch: 10 cost time: 0.4691336154937744
Epoch: 10, Steps: 10 | Train Loss: 2.631 Vali Loss: 3.310 Vali Acc: 0.093 Test Loss: 3.310 Test Acc: 0.093
Validation loss decreased (-0.082320 --> -0.092908).  Saving model ...
Epoch: 11 cost time: 0.38650989532470703
Epoch: 11, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.303 Vali Acc: 0.102 Test Loss: 3.303 Test Acc: 0.102
Validation loss decreased (-0.092908 --> -0.102320).  Saving model ...
Epoch: 12 cost time: 0.4653012752532959
Epoch: 12, Steps: 10 | Train Loss: 2.457 Vali Loss: 3.292 Vali Acc: 0.119 Test Loss: 3.292 Test Acc: 0.119
Validation loss decreased (-0.102320 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.4706580638885498
Epoch: 13, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.281 Vali Acc: 0.135 Test Loss: 3.281 Test Acc: 0.135
Validation loss decreased (-0.118791 --> -0.135261).  Saving model ...
Epoch: 14 cost time: 0.4693751335144043
Epoch: 14, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.274 Vali Acc: 0.145 Test Loss: 3.274 Test Acc: 0.145
Validation loss decreased (-0.135261 --> -0.144673).  Saving model ...
Epoch: 15 cost time: 0.4546363353729248
Epoch: 15, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.274 Vali Acc: 0.146 Test Loss: 3.274 Test Acc: 0.146
Validation loss decreased (-0.144673 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 0.5021967887878418
Epoch: 16, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.273 Vali Acc: 0.149 Test Loss: 3.273 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 17 cost time: 0.4755709171295166
Epoch: 17, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.268 Vali Acc: 0.154 Test Loss: 3.268 Test Acc: 0.154
Validation loss decreased (-0.149379 --> -0.154085).  Saving model ...
Epoch: 18 cost time: 0.5016112327575684
Epoch: 18, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.268 Vali Acc: 0.165 Test Loss: 3.268 Test Acc: 0.165
Validation loss decreased (-0.154085 --> -0.164673).  Saving model ...
Epoch: 19 cost time: 0.45317935943603516
Epoch: 19, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.283 Vali Acc: 0.165 Test Loss: 3.283 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48554253578186035
Epoch: 20, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.288 Vali Acc: 0.167 Test Loss: 3.288 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167026).  Saving model ...
Epoch: 21 cost time: 0.4495830535888672
Epoch: 21, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.284 Vali Acc: 0.168 Test Loss: 3.284 Test Acc: 0.168
Validation loss decreased (-0.167026 --> -0.168202).  Saving model ...
Epoch: 22 cost time: 0.45233654975891113
Epoch: 22, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.288 Vali Acc: 0.179 Test Loss: 3.288 Test Acc: 0.179
Validation loss decreased (-0.168202 --> -0.178791).  Saving model ...
Epoch: 23 cost time: 0.46013975143432617
Epoch: 23, Steps: 10 | Train Loss: 1.385 Vali Loss: 3.302 Vali Acc: 0.189 Test Loss: 3.302 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189379).  Saving model ...
Epoch: 24 cost time: 0.45205211639404297
Epoch: 24, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.306 Vali Acc: 0.193 Test Loss: 3.306 Test Acc: 0.193
Validation loss decreased (-0.189379 --> -0.192908).  Saving model ...
Epoch: 25 cost time: 0.4205749034881592
Epoch: 25, Steps: 10 | Train Loss: 1.199 Vali Loss: 3.310 Vali Acc: 0.196 Test Loss: 3.310 Test Acc: 0.196
Validation loss decreased (-0.192908 --> -0.196437).  Saving model ...
Epoch: 26 cost time: 0.41874074935913086
Epoch: 26, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.315 Vali Acc: 0.199 Test Loss: 3.315 Test Acc: 0.199
Validation loss decreased (-0.196437 --> -0.198790).  Saving model ...
Epoch: 27 cost time: 0.44307518005371094
Epoch: 27, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.332 Vali Acc: 0.196 Test Loss: 3.332 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3994770050048828
Epoch: 28, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.352 Vali Acc: 0.204 Test Loss: 3.352 Test Acc: 0.204
Validation loss decreased (-0.198790 --> -0.203496).  Saving model ...
Epoch: 29 cost time: 0.4490659236907959
Epoch: 29, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.352 Vali Acc: 0.215 Test Loss: 3.352 Test Acc: 0.215
Validation loss decreased (-0.203496 --> -0.215261).  Saving model ...
Epoch: 30 cost time: 0.4322974681854248
Epoch: 30, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.376 Vali Acc: 0.215 Test Loss: 3.376 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.449199914932251
Epoch: 31, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.401 Vali Acc: 0.211 Test Loss: 3.401 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.43546223640441895
Epoch: 32, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.412 Vali Acc: 0.218 Test Loss: 3.412 Test Acc: 0.218
Validation loss decreased (-0.215261 --> -0.217613).  Saving model ...
Epoch: 33 cost time: 0.47636914253234863
Epoch: 33, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.429 Vali Acc: 0.222 Test Loss: 3.429 Test Acc: 0.222
Validation loss decreased (-0.217613 --> -0.222319).  Saving model ...
Epoch: 34 cost time: 0.4284052848815918
Epoch: 34, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.435 Vali Acc: 0.231 Test Loss: 3.435 Test Acc: 0.231
Validation loss decreased (-0.222319 --> -0.230554).  Saving model ...
Epoch: 35 cost time: 0.49985456466674805
Epoch: 35, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.452 Vali Acc: 0.227 Test Loss: 3.452 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47123241424560547
Epoch: 36, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.473 Vali Acc: 0.232 Test Loss: 3.473 Test Acc: 0.232
Validation loss decreased (-0.230554 --> -0.231730).  Saving model ...
Epoch: 37 cost time: 0.44026875495910645
Epoch: 37, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.495 Vali Acc: 0.238 Test Loss: 3.495 Test Acc: 0.238
Validation loss decreased (-0.231730 --> -0.237612).  Saving model ...
Epoch: 38 cost time: 0.49413275718688965
Epoch: 38, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.506 Vali Acc: 0.240 Test Loss: 3.506 Test Acc: 0.240
Validation loss decreased (-0.237612 --> -0.239965).  Saving model ...
Epoch: 39 cost time: 0.5038182735443115
Epoch: 39, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.508 Vali Acc: 0.247 Test Loss: 3.508 Test Acc: 0.247
Validation loss decreased (-0.239965 --> -0.247024).  Saving model ...
Epoch: 40 cost time: 0.5011293888092041
Epoch: 40, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.524 Vali Acc: 0.242 Test Loss: 3.524 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.47108912467956543
Epoch: 41, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.545 Vali Acc: 0.248 Test Loss: 3.545 Test Acc: 0.248
Validation loss decreased (-0.247024 --> -0.248200).  Saving model ...
Epoch: 42 cost time: 0.41959643363952637
Epoch: 42, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.553 Vali Acc: 0.244 Test Loss: 3.553 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5271098613739014
Epoch: 43, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.561 Vali Acc: 0.249 Test Loss: 3.561 Test Acc: 0.249
Validation loss decreased (-0.248200 --> -0.249376).  Saving model ...
Epoch: 44 cost time: 0.4881875514984131
Epoch: 44, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.586 Vali Acc: 0.249 Test Loss: 3.586 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4553813934326172
Epoch: 45, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.619 Vali Acc: 0.253 Test Loss: 3.619 Test Acc: 0.253
Validation loss decreased (-0.249376 --> -0.252905).  Saving model ...
Epoch: 46 cost time: 0.45754289627075195
Epoch: 46, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.653 Vali Acc: 0.256 Test Loss: 3.653 Test Acc: 0.256
Validation loss decreased (-0.252905 --> -0.256434).  Saving model ...
Epoch: 47 cost time: 0.437089204788208
Epoch: 47, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.660 Vali Acc: 0.254 Test Loss: 3.660 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4479868412017822
Epoch: 48, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.654 Vali Acc: 0.254 Test Loss: 3.654 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4838697910308838
Epoch: 49, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.642 Vali Acc: 0.255 Test Loss: 3.642 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.480518102645874
Epoch: 50, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.657 Vali Acc: 0.256 Test Loss: 3.657 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.41510558128356934
Epoch: 51, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.704 Vali Acc: 0.262 Test Loss: 3.704 Test Acc: 0.262
Validation loss decreased (-0.256434 --> -0.262316).  Saving model ...
Epoch: 52 cost time: 0.46802616119384766
Epoch: 52, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.716 Vali Acc: 0.260 Test Loss: 3.716 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4887871742248535
Epoch: 53, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.714 Vali Acc: 0.262 Test Loss: 3.714 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.4509584903717041
Epoch: 54, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.724 Vali Acc: 0.265 Test Loss: 3.724 Test Acc: 0.265
Validation loss decreased (-0.262316 --> -0.264669).  Saving model ...
Epoch: 55 cost time: 0.5357706546783447
Epoch: 55, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.734 Vali Acc: 0.262 Test Loss: 3.734 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.4976623058319092
Epoch: 56, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.743 Vali Acc: 0.264 Test Loss: 3.743 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4950907230377197
Epoch: 57, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.759 Vali Acc: 0.261 Test Loss: 3.759 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.47051358222961426
Epoch: 58, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.765 Vali Acc: 0.256 Test Loss: 3.765 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.44106554985046387
Epoch: 59, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.780 Vali Acc: 0.262 Test Loss: 3.780 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.4707810878753662
Epoch: 60, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.796 Vali Acc: 0.262 Test Loss: 3.796 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.4060657024383545
Epoch: 61, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.800 Vali Acc: 0.266 Test Loss: 3.800 Test Acc: 0.266
Validation loss decreased (-0.264669 --> -0.265844).  Saving model ...
Epoch: 62 cost time: 0.5472922325134277
Epoch: 62, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.833 Vali Acc: 0.266 Test Loss: 3.833 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5005831718444824
Epoch: 63, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.863 Vali Acc: 0.264 Test Loss: 3.863 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.49033141136169434
Epoch: 64, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.893 Vali Acc: 0.266 Test Loss: 3.893 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.4752621650695801
Epoch: 65, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.867 Vali Acc: 0.273 Test Loss: 3.867 Test Acc: 0.273
Validation loss decreased (-0.265844 --> -0.272903).  Saving model ...
Epoch: 66 cost time: 0.451033353805542
Epoch: 66, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.887 Vali Acc: 0.276 Test Loss: 3.887 Test Acc: 0.276
Validation loss decreased (-0.272903 --> -0.276432).  Saving model ...
Epoch: 67 cost time: 0.45521974563598633
Epoch: 67, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.906 Vali Acc: 0.267 Test Loss: 3.906 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.4493095874786377
Epoch: 68, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.913 Vali Acc: 0.268 Test Loss: 3.913 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.4736440181732178
Epoch: 69, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.900 Vali Acc: 0.271 Test Loss: 3.900 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.47092485427856445
Epoch: 70, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.913 Vali Acc: 0.271 Test Loss: 3.913 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.4543328285217285
Epoch: 71, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.934 Vali Acc: 0.272 Test Loss: 3.934 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.4836897850036621
Epoch: 72, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.948 Vali Acc: 0.273 Test Loss: 3.948 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.475055456161499
Epoch: 73, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.974 Vali Acc: 0.274 Test Loss: 3.974 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.43306732177734375
Epoch: 74, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.987 Vali Acc: 0.274 Test Loss: 3.987 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.4572770595550537
Epoch: 75, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.958 Vali Acc: 0.278 Test Loss: 3.958 Test Acc: 0.278
Validation loss decreased (-0.276432 --> -0.277607).  Saving model ...
Epoch: 76 cost time: 0.49185967445373535
Epoch: 76, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.959 Vali Acc: 0.275 Test Loss: 3.959 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.4287991523742676
Epoch: 77, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.981 Vali Acc: 0.276 Test Loss: 3.981 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.5032548904418945
Epoch: 78, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.974 Vali Acc: 0.273 Test Loss: 3.974 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.5004489421844482
Epoch: 79, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.972 Vali Acc: 0.278 Test Loss: 3.972 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.480288028717041
Epoch: 80, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.997 Vali Acc: 0.273 Test Loss: 3.997 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.4761962890625
Epoch: 81, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.982 Vali Acc: 0.271 Test Loss: 3.982 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.475452184677124
Epoch: 82, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.993 Vali Acc: 0.269 Test Loss: 3.993 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.5146863460540771
Epoch: 83, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.000 Vali Acc: 0.274 Test Loss: 4.000 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.4594588279724121
Epoch: 84, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.000 Vali Acc: 0.273 Test Loss: 4.000 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.43253374099731445
Epoch: 85, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.017 Vali Acc: 0.272 Test Loss: 4.017 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 63322
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.487886667251587
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.322 Vali Acc: 0.045 Test Loss: 3.322 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.44298744201660156
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.392 Vali Acc: 0.056 Test Loss: 3.392 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.484417200088501
Epoch: 3, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.364 Vali Acc: 0.075 Test Loss: 3.364 Test Acc: 0.075
Validation loss decreased (-0.056437 --> -0.075260).  Saving model ...
Epoch: 4 cost time: 0.45345044136047363
Epoch: 4, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.285 Vali Acc: 0.107 Test Loss: 3.285 Test Acc: 0.107
Validation loss decreased (-0.075260 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.4797039031982422
Epoch: 5, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.280 Vali Acc: 0.128 Test Loss: 3.280 Test Acc: 0.128
Validation loss decreased (-0.107026 --> -0.128202).  Saving model ...
Epoch: 6 cost time: 0.4869861602783203
Epoch: 6, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.252 Vali Acc: 0.142 Test Loss: 3.252 Test Acc: 0.142
Validation loss decreased (-0.128202 --> -0.142320).  Saving model ...
Epoch: 7 cost time: 0.4447040557861328
Epoch: 7, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.266 Vali Acc: 0.158 Test Loss: 3.266 Test Acc: 0.158
Validation loss decreased (-0.142320 --> -0.157614).  Saving model ...
Epoch: 8 cost time: 0.45624327659606934
Epoch: 8, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.314 Vali Acc: 0.182 Test Loss: 3.314 Test Acc: 0.182
Validation loss decreased (-0.157614 --> -0.182320).  Saving model ...
Epoch: 9 cost time: 0.4771404266357422
Epoch: 9, Steps: 10 | Train Loss: 1.094 Vali Loss: 3.347 Vali Acc: 0.209 Test Loss: 3.347 Test Acc: 0.209
Validation loss decreased (-0.182320 --> -0.209378).  Saving model ...
Epoch: 10 cost time: 0.4883897304534912
Epoch: 10, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.422 Vali Acc: 0.219 Test Loss: 3.422 Test Acc: 0.219
Validation loss decreased (-0.209378 --> -0.218789).  Saving model ...
Epoch: 11 cost time: 0.469296932220459
Epoch: 11, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.521 Vali Acc: 0.218 Test Loss: 3.521 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4613511562347412
Epoch: 12, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.558 Vali Acc: 0.245 Test Loss: 3.558 Test Acc: 0.245
Validation loss decreased (-0.218789 --> -0.244670).  Saving model ...
Epoch: 13 cost time: 0.4756014347076416
Epoch: 13, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.757 Vali Acc: 0.240 Test Loss: 3.757 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45462965965270996
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.790 Vali Acc: 0.246 Test Loss: 3.790 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245844).  Saving model ...
Epoch: 15 cost time: 0.4787936210632324
Epoch: 15, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.878 Vali Acc: 0.267 Test Loss: 3.878 Test Acc: 0.267
Validation loss decreased (-0.245844 --> -0.267020).  Saving model ...
Epoch: 16 cost time: 0.4585075378417969
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.119 Vali Acc: 0.246 Test Loss: 4.119 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5351603031158447
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.087 Vali Acc: 0.253 Test Loss: 4.087 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.435988187789917
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.179 Vali Acc: 0.254 Test Loss: 4.179 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.46531057357788086
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.259 Vali Acc: 0.265 Test Loss: 4.259 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4481537342071533
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.312 Vali Acc: 0.273 Test Loss: 4.312 Test Acc: 0.273
Validation loss decreased (-0.267020 --> -0.272898).  Saving model ...
Epoch: 21 cost time: 0.48790502548217773
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.340 Vali Acc: 0.265 Test Loss: 4.340 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.477036714553833
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.375 Vali Acc: 0.273 Test Loss: 4.375 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4578845500946045
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.430 Vali Acc: 0.272 Test Loss: 4.430 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45716261863708496
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.468 Vali Acc: 0.269 Test Loss: 4.468 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.46011900901794434
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.508 Vali Acc: 0.271 Test Loss: 4.508 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.42844629287719727
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.538 Vali Acc: 0.266 Test Loss: 4.538 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4197084903717041
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.541 Vali Acc: 0.265 Test Loss: 4.541 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.45468640327453613
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.557 Vali Acc: 0.262 Test Loss: 4.557 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4369349479675293
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.571 Vali Acc: 0.264 Test Loss: 4.571 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.45531368255615234
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.603 Vali Acc: 0.265 Test Loss: 4.603 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 215322
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6289072036743164
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.371 Vali Acc: 0.044 Test Loss: 3.371 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4706854820251465
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.319 Vali Acc: 0.051 Test Loss: 3.319 Test Acc: 0.051
Validation loss decreased (-0.043496 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.4668154716491699
Epoch: 3, Steps: 10 | Train Loss: 3.117 Vali Loss: 3.314 Vali Acc: 0.056 Test Loss: 3.314 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.443469762802124
Epoch: 4, Steps: 10 | Train Loss: 2.868 Vali Loss: 3.326 Vali Acc: 0.081 Test Loss: 3.326 Test Acc: 0.081
Validation loss decreased (-0.056437 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.3952629566192627
Epoch: 5, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.282 Vali Acc: 0.106 Test Loss: 3.282 Test Acc: 0.106
Validation loss decreased (-0.081143 --> -0.105850).  Saving model ...
Epoch: 6 cost time: 0.47145891189575195
Epoch: 6, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.237 Vali Acc: 0.129 Test Loss: 3.237 Test Acc: 0.129
Validation loss decreased (-0.105850 --> -0.129379).  Saving model ...
Epoch: 7 cost time: 0.4335975646972656
Epoch: 7, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.219 Vali Acc: 0.151 Test Loss: 3.219 Test Acc: 0.151
Validation loss decreased (-0.129379 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.5320391654968262
Epoch: 8, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.231 Vali Acc: 0.162 Test Loss: 3.231 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162321).  Saving model ...
Epoch: 9 cost time: 0.4627699851989746
Epoch: 9, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.223 Vali Acc: 0.180 Test Loss: 3.223 Test Acc: 0.180
Validation loss decreased (-0.162321 --> -0.179968).  Saving model ...
Epoch: 10 cost time: 0.48593783378601074
Epoch: 10, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.266 Vali Acc: 0.178 Test Loss: 3.266 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.432786226272583
Epoch: 11, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.271 Vali Acc: 0.199 Test Loss: 3.271 Test Acc: 0.199
Validation loss decreased (-0.179968 --> -0.198791).  Saving model ...
Epoch: 12 cost time: 0.47038888931274414
Epoch: 12, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.315 Vali Acc: 0.211 Test Loss: 3.315 Test Acc: 0.211
Validation loss decreased (-0.198791 --> -0.210555).  Saving model ...
Epoch: 13 cost time: 0.4086740016937256
Epoch: 13, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.368 Vali Acc: 0.208 Test Loss: 3.368 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4384341239929199
Epoch: 14, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.405 Vali Acc: 0.225 Test Loss: 3.405 Test Acc: 0.225
Validation loss decreased (-0.210555 --> -0.224672).  Saving model ...
Epoch: 15 cost time: 0.4486541748046875
Epoch: 15, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.453 Vali Acc: 0.245 Test Loss: 3.453 Test Acc: 0.245
Validation loss decreased (-0.224672 --> -0.244671).  Saving model ...
Epoch: 16 cost time: 0.4226703643798828
Epoch: 16, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.514 Vali Acc: 0.242 Test Loss: 3.514 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43834948539733887
Epoch: 17, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.589 Vali Acc: 0.247 Test Loss: 3.589 Test Acc: 0.247
Validation loss decreased (-0.244671 --> -0.247023).  Saving model ...
Epoch: 18 cost time: 0.43430399894714355
Epoch: 18, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.649 Vali Acc: 0.256 Test Loss: 3.649 Test Acc: 0.256
Validation loss decreased (-0.247023 --> -0.256434).  Saving model ...
Epoch: 19 cost time: 0.42650628089904785
Epoch: 19, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.699 Vali Acc: 0.260 Test Loss: 3.699 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259963).  Saving model ...
Epoch: 20 cost time: 0.4205906391143799
Epoch: 20, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.809 Vali Acc: 0.249 Test Loss: 3.809 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5077559947967529
Epoch: 21, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.880 Vali Acc: 0.255 Test Loss: 3.880 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5473933219909668
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.898 Vali Acc: 0.264 Test Loss: 3.898 Test Acc: 0.264
Validation loss decreased (-0.259963 --> -0.263490).  Saving model ...
Epoch: 23 cost time: 0.43533825874328613
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.944 Vali Acc: 0.264 Test Loss: 3.944 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.46793103218078613
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.975 Vali Acc: 0.259 Test Loss: 3.975 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4729020595550537
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.010 Vali Acc: 0.256 Test Loss: 4.010 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.46373963356018066
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.034 Vali Acc: 0.262 Test Loss: 4.034 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.40190696716308594
Epoch: 27, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.060 Vali Acc: 0.265 Test Loss: 4.060 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264665).  Saving model ...
Epoch: 28 cost time: 0.4576442241668701
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.134 Vali Acc: 0.266 Test Loss: 4.134 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265841).  Saving model ...
Epoch: 29 cost time: 0.45578503608703613
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.180 Vali Acc: 0.266 Test Loss: 4.180 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.49677395820617676
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.193 Vali Acc: 0.268 Test Loss: 4.193 Test Acc: 0.268
Validation loss decreased (-0.265841 --> -0.268193).  Saving model ...
Epoch: 31 cost time: 0.46481895446777344
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.218 Vali Acc: 0.274 Test Loss: 4.218 Test Acc: 0.274
Validation loss decreased (-0.268193 --> -0.274075).  Saving model ...
Epoch: 32 cost time: 0.45951271057128906
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.248 Vali Acc: 0.271 Test Loss: 4.248 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4246387481689453
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.242 Vali Acc: 0.273 Test Loss: 4.242 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4067647457122803
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.263 Vali Acc: 0.275 Test Loss: 4.263 Test Acc: 0.275
Validation loss decreased (-0.274075 --> -0.275251).  Saving model ...
Epoch: 35 cost time: 0.4751157760620117
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.289 Vali Acc: 0.272 Test Loss: 4.289 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47220778465270996
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.313 Vali Acc: 0.273 Test Loss: 4.313 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.45430684089660645
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.329 Vali Acc: 0.269 Test Loss: 4.329 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4693610668182373
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.330 Vali Acc: 0.272 Test Loss: 4.330 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4472494125366211
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.367 Vali Acc: 0.267 Test Loss: 4.367 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.44872045516967773
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.382 Vali Acc: 0.267 Test Loss: 4.382 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.48287057876586914
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.399 Vali Acc: 0.271 Test Loss: 4.399 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4132354259490967
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.434 Vali Acc: 0.266 Test Loss: 4.434 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4356975555419922
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.412 Vali Acc: 0.268 Test Loss: 4.412 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4783961772918701
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.429 Vali Acc: 0.269 Test Loss: 4.429 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 120602
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8413021564483643
Epoch: 1, Steps: 10 | Train Loss: 3.451 Vali Loss: 3.351 Vali Acc: 0.035 Test Loss: 3.351 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.399463415145874
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.326 Vali Acc: 0.046 Test Loss: 3.326 Test Acc: 0.046
Validation loss decreased (-0.035261 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.4915771484375
Epoch: 3, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.318 Vali Acc: 0.054 Test Loss: 3.318 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054084).  Saving model ...
Epoch: 4 cost time: 0.4848933219909668
Epoch: 4, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.315 Vali Acc: 0.067 Test Loss: 3.315 Test Acc: 0.067
Validation loss decreased (-0.054084 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.4515655040740967
Epoch: 5, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.306 Vali Acc: 0.078 Test Loss: 3.306 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 6 cost time: 0.49793314933776855
Epoch: 6, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.288 Vali Acc: 0.102 Test Loss: 3.288 Test Acc: 0.102
Validation loss decreased (-0.077614 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.3886079788208008
Epoch: 7, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.254 Vali Acc: 0.124 Test Loss: 3.254 Test Acc: 0.124
Validation loss decreased (-0.102320 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.45501184463500977
Epoch: 8, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.222 Vali Acc: 0.136 Test Loss: 3.222 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136438).  Saving model ...
Epoch: 9 cost time: 0.4304685592651367
Epoch: 9, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.202 Vali Acc: 0.155 Test Loss: 3.202 Test Acc: 0.155
Validation loss decreased (-0.136438 --> -0.155262).  Saving model ...
Epoch: 10 cost time: 0.43560147285461426
Epoch: 10, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.200 Vali Acc: 0.162 Test Loss: 3.200 Test Acc: 0.162
Validation loss decreased (-0.155262 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 0.44904470443725586
Epoch: 11, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.202 Vali Acc: 0.173 Test Loss: 3.202 Test Acc: 0.173
Validation loss decreased (-0.162321 --> -0.172909).  Saving model ...
Epoch: 12 cost time: 0.466935396194458
Epoch: 12, Steps: 10 | Train Loss: 1.579 Vali Loss: 3.214 Vali Acc: 0.175 Test Loss: 3.214 Test Acc: 0.175
Validation loss decreased (-0.172909 --> -0.175262).  Saving model ...
Epoch: 13 cost time: 0.45288920402526855
Epoch: 13, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.206 Vali Acc: 0.192 Test Loss: 3.206 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191733).  Saving model ...
Epoch: 14 cost time: 0.4002559185028076
Epoch: 14, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.231 Vali Acc: 0.200 Test Loss: 3.231 Test Acc: 0.200
Validation loss decreased (-0.191733 --> -0.199968).  Saving model ...
Epoch: 15 cost time: 0.43720340728759766
Epoch: 15, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.243 Vali Acc: 0.216 Test Loss: 3.243 Test Acc: 0.216
Validation loss decreased (-0.199968 --> -0.216438).  Saving model ...
Epoch: 16 cost time: 0.4924311637878418
Epoch: 16, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.278 Vali Acc: 0.229 Test Loss: 3.278 Test Acc: 0.229
Validation loss decreased (-0.216438 --> -0.229379).  Saving model ...
Epoch: 17 cost time: 0.4110898971557617
Epoch: 17, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.328 Vali Acc: 0.232 Test Loss: 3.328 Test Acc: 0.232
Validation loss decreased (-0.229379 --> -0.231731).  Saving model ...
Epoch: 18 cost time: 0.4685225486755371
Epoch: 18, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.359 Vali Acc: 0.240 Test Loss: 3.359 Test Acc: 0.240
Validation loss decreased (-0.231731 --> -0.239966).  Saving model ...
Epoch: 19 cost time: 0.462691068649292
Epoch: 19, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.391 Vali Acc: 0.245 Test Loss: 3.391 Test Acc: 0.245
Validation loss decreased (-0.239966 --> -0.244672).  Saving model ...
Epoch: 20 cost time: 0.44553256034851074
Epoch: 20, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.440 Vali Acc: 0.242 Test Loss: 3.440 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4574089050292969
Epoch: 21, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.489 Vali Acc: 0.245 Test Loss: 3.489 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4734668731689453
Epoch: 22, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.555 Vali Acc: 0.244 Test Loss: 3.555 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4702463150024414
Epoch: 23, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.620 Vali Acc: 0.234 Test Loss: 3.620 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.46298718452453613
Epoch: 24, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.667 Vali Acc: 0.246 Test Loss: 3.667 Test Acc: 0.246
Validation loss decreased (-0.244672 --> -0.245846).  Saving model ...
Epoch: 25 cost time: 0.4337503910064697
Epoch: 25, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.694 Vali Acc: 0.248 Test Loss: 3.694 Test Acc: 0.248
Validation loss decreased (-0.245846 --> -0.248198).  Saving model ...
Epoch: 26 cost time: 0.5108473300933838
Epoch: 26, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.722 Vali Acc: 0.246 Test Loss: 3.722 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.431793212890625
Epoch: 27, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.749 Vali Acc: 0.251 Test Loss: 3.749 Test Acc: 0.251
Validation loss decreased (-0.248198 --> -0.250551).  Saving model ...
Epoch: 28 cost time: 0.4409968852996826
Epoch: 28, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.802 Vali Acc: 0.251 Test Loss: 3.802 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4854087829589844
Epoch: 29, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.852 Vali Acc: 0.252 Test Loss: 3.852 Test Acc: 0.252
Validation loss decreased (-0.250551 --> -0.251726).  Saving model ...
Epoch: 30 cost time: 0.46797847747802734
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.854 Vali Acc: 0.256 Test Loss: 3.854 Test Acc: 0.256
Validation loss decreased (-0.251726 --> -0.256432).  Saving model ...
Epoch: 31 cost time: 0.4724266529083252
Epoch: 31, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.889 Vali Acc: 0.247 Test Loss: 3.889 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4908885955810547
Epoch: 32, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.935 Vali Acc: 0.238 Test Loss: 3.935 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.44353628158569336
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.946 Vali Acc: 0.241 Test Loss: 3.946 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4458796977996826
Epoch: 34, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.951 Vali Acc: 0.248 Test Loss: 3.951 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4687223434448242
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.964 Vali Acc: 0.254 Test Loss: 3.964 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4844632148742676
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.990 Vali Acc: 0.261 Test Loss: 3.990 Test Acc: 0.261
Validation loss decreased (-0.256432 --> -0.261137).  Saving model ...
Epoch: 37 cost time: 0.5118794441223145
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.027 Vali Acc: 0.262 Test Loss: 4.027 Test Acc: 0.262
Validation loss decreased (-0.261137 --> -0.262313).  Saving model ...
Epoch: 38 cost time: 0.446979284286499
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.061 Vali Acc: 0.261 Test Loss: 4.061 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5223314762115479
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.087 Vali Acc: 0.264 Test Loss: 4.087 Test Acc: 0.264
Validation loss decreased (-0.262313 --> -0.263489).  Saving model ...
Epoch: 40 cost time: 0.45746541023254395
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.080 Vali Acc: 0.265 Test Loss: 4.080 Test Acc: 0.265
Validation loss decreased (-0.263489 --> -0.264665).  Saving model ...
Epoch: 41 cost time: 0.4289531707763672
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.098 Vali Acc: 0.265 Test Loss: 4.098 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5000383853912354
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.125 Vali Acc: 0.262 Test Loss: 4.125 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.44179224967956543
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.149 Vali Acc: 0.262 Test Loss: 4.149 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.4338700771331787
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.164 Vali Acc: 0.262 Test Loss: 4.164 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.4081714153289795
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.209 Vali Acc: 0.261 Test Loss: 4.209 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.40900206565856934
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.226 Vali Acc: 0.264 Test Loss: 4.226 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5277190208435059
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.225 Vali Acc: 0.265 Test Loss: 4.225 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.519827127456665
Epoch: 48, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.230 Vali Acc: 0.264 Test Loss: 4.230 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5073659420013428
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.239 Vali Acc: 0.267 Test Loss: 4.239 Test Acc: 0.267
Validation loss decreased (-0.264665 --> -0.267016).  Saving model ...
Epoch: 50 cost time: 0.5207839012145996
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.265 Vali Acc: 0.268 Test Loss: 4.265 Test Acc: 0.268
Validation loss decreased (-0.267016 --> -0.268193).  Saving model ...
Epoch: 51 cost time: 0.5220084190368652
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.281 Vali Acc: 0.265 Test Loss: 4.281 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5976278781890869
Epoch: 52, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.285 Vali Acc: 0.265 Test Loss: 4.285 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5248172283172607
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.307 Vali Acc: 0.264 Test Loss: 4.307 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5485608577728271
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.315 Vali Acc: 0.262 Test Loss: 4.315 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5448064804077148
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.316 Vali Acc: 0.265 Test Loss: 4.316 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.4987921714782715
Epoch: 56, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.323 Vali Acc: 0.273 Test Loss: 4.323 Test Acc: 0.273
Validation loss decreased (-0.268193 --> -0.272898).  Saving model ...
Epoch: 57 cost time: 0.5316548347473145
Epoch: 57, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.341 Vali Acc: 0.271 Test Loss: 4.341 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5253086090087891
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.347 Vali Acc: 0.268 Test Loss: 4.347 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5924036502838135
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.364 Vali Acc: 0.268 Test Loss: 4.364 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5473299026489258
Epoch: 60, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.374 Vali Acc: 0.267 Test Loss: 4.374 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5324945449829102
Epoch: 61, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.377 Vali Acc: 0.274 Test Loss: 4.377 Test Acc: 0.274
Validation loss decreased (-0.272898 --> -0.274074).  Saving model ...
Epoch: 62 cost time: 0.5592985153198242
Epoch: 62, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.393 Vali Acc: 0.273 Test Loss: 4.393 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5370006561279297
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.387 Vali Acc: 0.276 Test Loss: 4.387 Test Acc: 0.276
Validation loss decreased (-0.274074 --> -0.276427).  Saving model ...
Epoch: 64 cost time: 0.5171158313751221
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.398 Vali Acc: 0.272 Test Loss: 4.398 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5356733798980713
Epoch: 65, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.409 Vali Acc: 0.272 Test Loss: 4.409 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5538194179534912
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.421 Vali Acc: 0.273 Test Loss: 4.421 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5388641357421875
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.427 Vali Acc: 0.273 Test Loss: 4.427 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5655117034912109
Epoch: 68, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.453 Vali Acc: 0.272 Test Loss: 4.453 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5597026348114014
Epoch: 69, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.464 Vali Acc: 0.273 Test Loss: 4.464 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.6067023277282715
Epoch: 70, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.471 Vali Acc: 0.275 Test Loss: 4.471 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.6624565124511719
Epoch: 71, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.479 Vali Acc: 0.276 Test Loss: 4.479 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5362739562988281
Epoch: 72, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.482 Vali Acc: 0.276 Test Loss: 4.482 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.5513010025024414
Epoch: 73, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.486 Vali Acc: 0.275 Test Loss: 4.486 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 88282
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6802616119384766
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.337 Vali Acc: 0.035 Test Loss: 3.337 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5259301662445068
Epoch: 2, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.324 Vali Acc: 0.041 Test Loss: 3.324 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.4956212043762207
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.311 Vali Acc: 0.048 Test Loss: 3.311 Test Acc: 0.048
Validation loss decreased (-0.041143 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.5427641868591309
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.305 Vali Acc: 0.072 Test Loss: 3.305 Test Acc: 0.072
Validation loss decreased (-0.048202 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.5220887660980225
Epoch: 5, Steps: 10 | Train Loss: 2.977 Vali Loss: 3.309 Vali Acc: 0.085 Test Loss: 3.309 Test Acc: 0.085
Validation loss decreased (-0.071732 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.5323965549468994
Epoch: 6, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.292 Vali Acc: 0.102 Test Loss: 3.292 Test Acc: 0.102
Validation loss decreased (-0.084673 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.5384559631347656
Epoch: 7, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.271 Vali Acc: 0.108 Test Loss: 3.271 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.5333893299102783
Epoch: 8, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.252 Vali Acc: 0.121 Test Loss: 3.252 Test Acc: 0.121
Validation loss decreased (-0.108203 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 0.5144281387329102
Epoch: 9, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.240 Vali Acc: 0.138 Test Loss: 3.240 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.5615923404693604
Epoch: 10, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.231 Vali Acc: 0.144 Test Loss: 3.231 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.5303013324737549
Epoch: 11, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.226 Vali Acc: 0.145 Test Loss: 3.226 Test Acc: 0.145
Validation loss decreased (-0.143497 --> -0.144674).  Saving model ...
Epoch: 12 cost time: 0.5539042949676514
Epoch: 12, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.234 Vali Acc: 0.167 Test Loss: 3.234 Test Acc: 0.167
Validation loss decreased (-0.144674 --> -0.167026).  Saving model ...
Epoch: 13 cost time: 0.5319409370422363
Epoch: 13, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.242 Vali Acc: 0.168 Test Loss: 3.242 Test Acc: 0.168
Validation loss decreased (-0.167026 --> -0.168203).  Saving model ...
Epoch: 14 cost time: 0.5607190132141113
Epoch: 14, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.255 Vali Acc: 0.178 Test Loss: 3.255 Test Acc: 0.178
Validation loss decreased (-0.168203 --> -0.177615).  Saving model ...
Epoch: 15 cost time: 0.5317339897155762
Epoch: 15, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.259 Vali Acc: 0.186 Test Loss: 3.259 Test Acc: 0.186
Validation loss decreased (-0.177615 --> -0.185850).  Saving model ...
Epoch: 16 cost time: 0.5121514797210693
Epoch: 16, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.280 Vali Acc: 0.185 Test Loss: 3.280 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5080122947692871
Epoch: 17, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.302 Vali Acc: 0.195 Test Loss: 3.302 Test Acc: 0.195
Validation loss decreased (-0.185850 --> -0.195261).  Saving model ...
Epoch: 18 cost time: 0.5524005889892578
Epoch: 18, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.340 Vali Acc: 0.201 Test Loss: 3.340 Test Acc: 0.201
Validation loss decreased (-0.195261 --> -0.201143).  Saving model ...
Epoch: 19 cost time: 0.5414390563964844
Epoch: 19, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.369 Vali Acc: 0.212 Test Loss: 3.369 Test Acc: 0.212
Validation loss decreased (-0.201143 --> -0.211731).  Saving model ...
Epoch: 20 cost time: 0.5102806091308594
Epoch: 20, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.391 Vali Acc: 0.220 Test Loss: 3.391 Test Acc: 0.220
Validation loss decreased (-0.211731 --> -0.219966).  Saving model ...
Epoch: 21 cost time: 0.5334293842315674
Epoch: 21, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.416 Vali Acc: 0.222 Test Loss: 3.416 Test Acc: 0.222
Validation loss decreased (-0.219966 --> -0.222319).  Saving model ...
Epoch: 22 cost time: 0.5479693412780762
Epoch: 22, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.466 Vali Acc: 0.229 Test Loss: 3.466 Test Acc: 0.229
Validation loss decreased (-0.222319 --> -0.229377).  Saving model ...
Epoch: 23 cost time: 0.5498523712158203
Epoch: 23, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.525 Vali Acc: 0.227 Test Loss: 3.525 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5097959041595459
Epoch: 24, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.550 Vali Acc: 0.233 Test Loss: 3.550 Test Acc: 0.233
Validation loss decreased (-0.229377 --> -0.232906).  Saving model ...
Epoch: 25 cost time: 0.5103394985198975
Epoch: 25, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.589 Vali Acc: 0.241 Test Loss: 3.589 Test Acc: 0.241
Validation loss decreased (-0.232906 --> -0.241141).  Saving model ...
Epoch: 26 cost time: 0.526106595993042
Epoch: 26, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.624 Vali Acc: 0.248 Test Loss: 3.624 Test Acc: 0.248
Validation loss decreased (-0.241141 --> -0.248199).  Saving model ...
Epoch: 27 cost time: 0.560417652130127
Epoch: 27, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.687 Vali Acc: 0.249 Test Loss: 3.687 Test Acc: 0.249
Validation loss decreased (-0.248199 --> -0.249375).  Saving model ...
Epoch: 28 cost time: 0.5440571308135986
Epoch: 28, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.725 Vali Acc: 0.248 Test Loss: 3.725 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5314300060272217
Epoch: 29, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.748 Vali Acc: 0.253 Test Loss: 3.748 Test Acc: 0.253
Validation loss decreased (-0.249375 --> -0.252904).  Saving model ...
Epoch: 30 cost time: 0.5027585029602051
Epoch: 30, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.799 Vali Acc: 0.252 Test Loss: 3.799 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5219442844390869
Epoch: 31, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.842 Vali Acc: 0.246 Test Loss: 3.842 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5452382564544678
Epoch: 32, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.858 Vali Acc: 0.246 Test Loss: 3.858 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5172271728515625
Epoch: 33, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.896 Vali Acc: 0.249 Test Loss: 3.896 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5629782676696777
Epoch: 34, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.946 Vali Acc: 0.253 Test Loss: 3.946 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5577552318572998
Epoch: 35, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.981 Vali Acc: 0.253 Test Loss: 3.981 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5351943969726562
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.038 Vali Acc: 0.254 Test Loss: 4.038 Test Acc: 0.254
Validation loss decreased (-0.252904 --> -0.254077).  Saving model ...
Epoch: 37 cost time: 0.5482361316680908
Epoch: 37, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.053 Vali Acc: 0.251 Test Loss: 4.053 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5383315086364746
Epoch: 38, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.040 Vali Acc: 0.255 Test Loss: 4.040 Test Acc: 0.255
Validation loss decreased (-0.254077 --> -0.255254).  Saving model ...
Epoch: 39 cost time: 0.5097112655639648
Epoch: 39, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.060 Vali Acc: 0.256 Test Loss: 4.060 Test Acc: 0.256
Validation loss decreased (-0.255254 --> -0.256430).  Saving model ...
Epoch: 40 cost time: 0.54543137550354
Epoch: 40, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.118 Vali Acc: 0.259 Test Loss: 4.118 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258782).  Saving model ...
Epoch: 41 cost time: 0.5411484241485596
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.143 Vali Acc: 0.259 Test Loss: 4.143 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5376930236816406
Epoch: 42, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.158 Vali Acc: 0.259 Test Loss: 4.158 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5073361396789551
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.188 Vali Acc: 0.264 Test Loss: 4.188 Test Acc: 0.264
Validation loss decreased (-0.258782 --> -0.263488).  Saving model ...
Epoch: 44 cost time: 0.5636630058288574
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.196 Vali Acc: 0.260 Test Loss: 4.196 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5508911609649658
Epoch: 45, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.218 Vali Acc: 0.261 Test Loss: 4.218 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5700433254241943
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.267 Vali Acc: 0.255 Test Loss: 4.267 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5210001468658447
Epoch: 47, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.281 Vali Acc: 0.260 Test Loss: 4.281 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5315892696380615
Epoch: 48, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.271 Vali Acc: 0.262 Test Loss: 4.271 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5381312370300293
Epoch: 49, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.287 Vali Acc: 0.265 Test Loss: 4.287 Test Acc: 0.265
Validation loss decreased (-0.263488 --> -0.264663).  Saving model ...
Epoch: 50 cost time: 0.5183312892913818
Epoch: 50, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.324 Vali Acc: 0.264 Test Loss: 4.324 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5790982246398926
Epoch: 51, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.341 Vali Acc: 0.264 Test Loss: 4.341 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5361924171447754
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.378 Vali Acc: 0.261 Test Loss: 4.378 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5447878837585449
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.360 Vali Acc: 0.264 Test Loss: 4.360 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5416610240936279
Epoch: 54, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.354 Vali Acc: 0.260 Test Loss: 4.354 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5453972816467285
Epoch: 55, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.380 Vali Acc: 0.262 Test Loss: 4.380 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.4946434497833252
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.405 Vali Acc: 0.262 Test Loss: 4.405 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5246562957763672
Epoch: 57, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.437 Vali Acc: 0.258 Test Loss: 4.437 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.5653610229492188
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.431 Vali Acc: 0.261 Test Loss: 4.431 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5534636974334717
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.434 Vali Acc: 0.264 Test Loss: 4.434 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 73434
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4993674755096436
Epoch: 1, Steps: 10 | Train Loss: 3.455 Vali Loss: 3.372 Vali Acc: 0.044 Test Loss: 3.372 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.5592737197875977
Epoch: 2, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.373 Vali Acc: 0.046 Test Loss: 3.373 Test Acc: 0.046
Validation loss decreased (-0.043496 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5378589630126953
Epoch: 3, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.364 Vali Acc: 0.046 Test Loss: 3.364 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 0.5446438789367676
Epoch: 4, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.349 Vali Acc: 0.042 Test Loss: 3.349 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5241010189056396
Epoch: 5, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.335 Vali Acc: 0.052 Test Loss: 3.335 Test Acc: 0.052
Validation loss decreased (-0.045849 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 0.5448694229125977
Epoch: 6, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.322 Vali Acc: 0.061 Test Loss: 3.322 Test Acc: 0.061
Validation loss decreased (-0.051731 --> -0.061143).  Saving model ...
Epoch: 7 cost time: 0.5577743053436279
Epoch: 7, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.316 Vali Acc: 0.067 Test Loss: 3.316 Test Acc: 0.067
Validation loss decreased (-0.061143 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 0.526148796081543
Epoch: 8, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.309 Vali Acc: 0.081 Test Loss: 3.309 Test Acc: 0.081
Validation loss decreased (-0.067026 --> -0.081143).  Saving model ...
Epoch: 9 cost time: 0.5686287879943848
Epoch: 9, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.295 Vali Acc: 0.093 Test Loss: 3.295 Test Acc: 0.093
Validation loss decreased (-0.081143 --> -0.092908).  Saving model ...
Epoch: 10 cost time: 0.5323851108551025
Epoch: 10, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.289 Vali Acc: 0.106 Test Loss: 3.289 Test Acc: 0.106
Validation loss decreased (-0.092908 --> -0.105849).  Saving model ...
Epoch: 11 cost time: 0.5543766021728516
Epoch: 11, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.279 Vali Acc: 0.115 Test Loss: 3.279 Test Acc: 0.115
Validation loss decreased (-0.105849 --> -0.115261).  Saving model ...
Epoch: 12 cost time: 0.5702641010284424
Epoch: 12, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.270 Vali Acc: 0.121 Test Loss: 3.270 Test Acc: 0.121
Validation loss decreased (-0.115261 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 0.5622389316558838
Epoch: 13, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.272 Vali Acc: 0.134 Test Loss: 3.272 Test Acc: 0.134
Validation loss decreased (-0.121144 --> -0.134085).  Saving model ...
Epoch: 14 cost time: 0.5364735126495361
Epoch: 14, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.265 Vali Acc: 0.136 Test Loss: 3.265 Test Acc: 0.136
Validation loss decreased (-0.134085 --> -0.136438).  Saving model ...
Epoch: 15 cost time: 0.5549559593200684
Epoch: 15, Steps: 10 | Train Loss: 1.839 Vali Loss: 3.264 Vali Acc: 0.151 Test Loss: 3.264 Test Acc: 0.151
Validation loss decreased (-0.136438 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 0.5417287349700928
Epoch: 16, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.269 Vali Acc: 0.161 Test Loss: 3.269 Test Acc: 0.161
Validation loss decreased (-0.150556 --> -0.161144).  Saving model ...
Epoch: 17 cost time: 0.5453605651855469
Epoch: 17, Steps: 10 | Train Loss: 1.582 Vali Loss: 3.290 Vali Acc: 0.164 Test Loss: 3.290 Test Acc: 0.164
Validation loss decreased (-0.161144 --> -0.163497).  Saving model ...
Epoch: 18 cost time: 0.5919022560119629
Epoch: 18, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.292 Vali Acc: 0.176 Test Loss: 3.292 Test Acc: 0.176
Validation loss decreased (-0.163497 --> -0.176438).  Saving model ...
Epoch: 19 cost time: 0.5557215213775635
Epoch: 19, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.301 Vali Acc: 0.186 Test Loss: 3.301 Test Acc: 0.186
Validation loss decreased (-0.176438 --> -0.185849).  Saving model ...
Epoch: 20 cost time: 0.5443668365478516
Epoch: 20, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.317 Vali Acc: 0.189 Test Loss: 3.317 Test Acc: 0.189
Validation loss decreased (-0.185849 --> -0.189379).  Saving model ...
Epoch: 21 cost time: 0.574167013168335
Epoch: 21, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.333 Vali Acc: 0.189 Test Loss: 3.333 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5661783218383789
Epoch: 22, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.353 Vali Acc: 0.195 Test Loss: 3.353 Test Acc: 0.195
Validation loss decreased (-0.189379 --> -0.195261).  Saving model ...
Epoch: 23 cost time: 0.5700931549072266
Epoch: 23, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.373 Vali Acc: 0.196 Test Loss: 3.373 Test Acc: 0.196
Validation loss decreased (-0.195261 --> -0.196437).  Saving model ...
Epoch: 24 cost time: 0.5640685558319092
Epoch: 24, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.393 Vali Acc: 0.207 Test Loss: 3.393 Test Acc: 0.207
Validation loss decreased (-0.196437 --> -0.207025).  Saving model ...
Epoch: 25 cost time: 0.5503251552581787
Epoch: 25, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.409 Vali Acc: 0.213 Test Loss: 3.409 Test Acc: 0.213
Validation loss decreased (-0.207025 --> -0.212907).  Saving model ...
Epoch: 26 cost time: 0.5276215076446533
Epoch: 26, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.439 Vali Acc: 0.220 Test Loss: 3.439 Test Acc: 0.220
Validation loss decreased (-0.212907 --> -0.219966).  Saving model ...
Epoch: 27 cost time: 0.5739805698394775
Epoch: 27, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.465 Vali Acc: 0.225 Test Loss: 3.465 Test Acc: 0.225
Validation loss decreased (-0.219966 --> -0.224671).  Saving model ...
Epoch: 28 cost time: 0.5353078842163086
Epoch: 28, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.480 Vali Acc: 0.224 Test Loss: 3.480 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6525864601135254
Epoch: 29, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.520 Vali Acc: 0.221 Test Loss: 3.520 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6348855495452881
Epoch: 30, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.536 Vali Acc: 0.231 Test Loss: 3.536 Test Acc: 0.231
Validation loss decreased (-0.224671 --> -0.230553).  Saving model ...
Epoch: 31 cost time: 0.5506072044372559
Epoch: 31, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.561 Vali Acc: 0.235 Test Loss: 3.561 Test Acc: 0.235
Validation loss decreased (-0.230553 --> -0.235259).  Saving model ...
Epoch: 32 cost time: 0.5823154449462891
Epoch: 32, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.597 Vali Acc: 0.242 Test Loss: 3.597 Test Acc: 0.242
Validation loss decreased (-0.235259 --> -0.242317).  Saving model ...
Epoch: 33 cost time: 0.5249731540679932
Epoch: 33, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.644 Vali Acc: 0.244 Test Loss: 3.644 Test Acc: 0.244
Validation loss decreased (-0.242317 --> -0.243493).  Saving model ...
Epoch: 34 cost time: 0.5916736125946045
Epoch: 34, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.675 Vali Acc: 0.241 Test Loss: 3.675 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.557600736618042
Epoch: 35, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.696 Vali Acc: 0.242 Test Loss: 3.696 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5532252788543701
Epoch: 36, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.712 Vali Acc: 0.242 Test Loss: 3.712 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5425913333892822
Epoch: 37, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.732 Vali Acc: 0.247 Test Loss: 3.732 Test Acc: 0.247
Validation loss decreased (-0.243493 --> -0.247021).  Saving model ...
Epoch: 38 cost time: 0.5432794094085693
Epoch: 38, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.755 Vali Acc: 0.248 Test Loss: 3.755 Test Acc: 0.248
Validation loss decreased (-0.247021 --> -0.248198).  Saving model ...
Epoch: 39 cost time: 0.5750176906585693
Epoch: 39, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.774 Vali Acc: 0.251 Test Loss: 3.774 Test Acc: 0.251
Validation loss decreased (-0.248198 --> -0.250550).  Saving model ...
Epoch: 40 cost time: 0.5603716373443604
Epoch: 40, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.794 Vali Acc: 0.249 Test Loss: 3.794 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5559861660003662
Epoch: 41, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.820 Vali Acc: 0.253 Test Loss: 3.820 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252903).  Saving model ...
Epoch: 42 cost time: 0.5695617198944092
Epoch: 42, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.838 Vali Acc: 0.249 Test Loss: 3.838 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.548999547958374
Epoch: 43, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.873 Vali Acc: 0.249 Test Loss: 3.873 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5546152591705322
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.891 Vali Acc: 0.247 Test Loss: 3.891 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5869317054748535
Epoch: 45, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.906 Vali Acc: 0.251 Test Loss: 3.906 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5405502319335938
Epoch: 46, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.917 Vali Acc: 0.251 Test Loss: 3.917 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5592701435089111
Epoch: 47, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.931 Vali Acc: 0.251 Test Loss: 3.931 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5981056690216064
Epoch: 48, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.944 Vali Acc: 0.253 Test Loss: 3.944 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5548200607299805
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.965 Vali Acc: 0.254 Test Loss: 3.965 Test Acc: 0.254
Validation loss decreased (-0.252903 --> -0.254078).  Saving model ...
Epoch: 50 cost time: 0.5804979801177979
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.984 Vali Acc: 0.251 Test Loss: 3.984 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.607818603515625
Epoch: 51, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.006 Vali Acc: 0.252 Test Loss: 4.006 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.552459716796875
Epoch: 52, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.021 Vali Acc: 0.251 Test Loss: 4.021 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5566868782043457
Epoch: 53, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.015 Vali Acc: 0.253 Test Loss: 4.015 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5366055965423584
Epoch: 54, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.027 Vali Acc: 0.253 Test Loss: 4.027 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5975053310394287
Epoch: 55, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.040 Vali Acc: 0.252 Test Loss: 4.040 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5715107917785645
Epoch: 56, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.077 Vali Acc: 0.254 Test Loss: 4.077 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5591697692871094
Epoch: 57, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.096 Vali Acc: 0.255 Test Loss: 4.096 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255253).  Saving model ...
Epoch: 58 cost time: 0.5623037815093994
Epoch: 58, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.112 Vali Acc: 0.253 Test Loss: 4.112 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.557560920715332
Epoch: 59, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.124 Vali Acc: 0.255 Test Loss: 4.124 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5534632205963135
Epoch: 60, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.128 Vali Acc: 0.256 Test Loss: 4.128 Test Acc: 0.256
Validation loss decreased (-0.255253 --> -0.256429).  Saving model ...
Epoch: 61 cost time: 0.5315303802490234
Epoch: 61, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.117 Vali Acc: 0.258 Test Loss: 4.117 Test Acc: 0.258
Validation loss decreased (-0.256429 --> -0.257606).  Saving model ...
Epoch: 62 cost time: 0.5834472179412842
Epoch: 62, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.151 Vali Acc: 0.255 Test Loss: 4.151 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.530691385269165
Epoch: 63, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.168 Vali Acc: 0.255 Test Loss: 4.168 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5385706424713135
Epoch: 64, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.180 Vali Acc: 0.253 Test Loss: 4.180 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.546471357345581
Epoch: 65, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.196 Vali Acc: 0.253 Test Loss: 4.196 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5243334770202637
Epoch: 66, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.208 Vali Acc: 0.251 Test Loss: 4.208 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.570502758026123
Epoch: 67, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.219 Vali Acc: 0.255 Test Loss: 4.219 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.5482232570648193
Epoch: 68, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.231 Vali Acc: 0.256 Test Loss: 4.231 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.5959811210632324
Epoch: 69, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.237 Vali Acc: 0.255 Test Loss: 4.237 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.5899951457977295
Epoch: 70, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.241 Vali Acc: 0.259 Test Loss: 4.241 Test Acc: 0.259
Validation loss decreased (-0.257606 --> -0.258781).  Saving model ...
Epoch: 71 cost time: 0.5965473651885986
Epoch: 71, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.260 Vali Acc: 0.254 Test Loss: 4.260 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5762808322906494
Epoch: 72, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.275 Vali Acc: 0.255 Test Loss: 4.275 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5317177772521973
Epoch: 73, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.291 Vali Acc: 0.256 Test Loss: 4.291 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5477592945098877
Epoch: 74, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.275 Vali Acc: 0.260 Test Loss: 4.275 Test Acc: 0.260
Validation loss decreased (-0.258781 --> -0.259957).  Saving model ...
Epoch: 75 cost time: 0.5671515464782715
Epoch: 75, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.283 Vali Acc: 0.260 Test Loss: 4.283 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5535130500793457
Epoch: 76, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.295 Vali Acc: 0.259 Test Loss: 4.295 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.5206515789031982
Epoch: 77, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.318 Vali Acc: 0.255 Test Loss: 4.318 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.5362136363983154
Epoch: 78, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.322 Vali Acc: 0.254 Test Loss: 4.322 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.5316236019134521
Epoch: 79, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.334 Vali Acc: 0.255 Test Loss: 4.334 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.5521566867828369
Epoch: 80, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.326 Vali Acc: 0.255 Test Loss: 4.326 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.559650182723999
Epoch: 81, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.345 Vali Acc: 0.254 Test Loss: 4.345 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.5663001537322998
Epoch: 82, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.347 Vali Acc: 0.256 Test Loss: 4.347 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.543022632598877
Epoch: 83, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.371 Vali Acc: 0.258 Test Loss: 4.371 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.5729525089263916
Epoch: 84, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.375 Vali Acc: 0.258 Test Loss: 4.375 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 56186
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4820070266723633
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.370 Vali Acc: 0.047 Test Loss: 3.370 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.5424578189849854
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.350 Vali Acc: 0.054 Test Loss: 3.350 Test Acc: 0.054
Validation loss decreased (-0.047025 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.5017297267913818
Epoch: 3, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.338 Vali Acc: 0.062 Test Loss: 3.338 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.5289087295532227
Epoch: 4, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.326 Vali Acc: 0.067 Test Loss: 3.326 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.5123744010925293
Epoch: 5, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.316 Vali Acc: 0.075 Test Loss: 3.316 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.5190322399139404
Epoch: 6, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.305 Vali Acc: 0.076 Test Loss: 3.305 Test Acc: 0.076
Validation loss decreased (-0.075261 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.5541160106658936
Epoch: 7, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.298 Vali Acc: 0.079 Test Loss: 3.298 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 8 cost time: 0.5552692413330078
Epoch: 8, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.290 Vali Acc: 0.093 Test Loss: 3.290 Test Acc: 0.093
Validation loss decreased (-0.078791 --> -0.092908).  Saving model ...
Epoch: 9 cost time: 0.5391950607299805
Epoch: 9, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.283 Vali Acc: 0.101 Test Loss: 3.283 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.5116150379180908
Epoch: 10, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.275 Vali Acc: 0.114 Test Loss: 3.275 Test Acc: 0.114
Validation loss decreased (-0.101144 --> -0.114085).  Saving model ...
Epoch: 11 cost time: 0.49889159202575684
Epoch: 11, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.270 Vali Acc: 0.122 Test Loss: 3.270 Test Acc: 0.122
Validation loss decreased (-0.114085 --> -0.122320).  Saving model ...
Epoch: 12 cost time: 0.5364704132080078
Epoch: 12, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.268 Vali Acc: 0.122 Test Loss: 3.268 Test Acc: 0.122
Validation loss decreased (-0.122320 --> -0.122320).  Saving model ...
Epoch: 13 cost time: 0.5595598220825195
Epoch: 13, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.259 Vali Acc: 0.129 Test Loss: 3.259 Test Acc: 0.129
Validation loss decreased (-0.122320 --> -0.129379).  Saving model ...
Epoch: 14 cost time: 0.5473921298980713
Epoch: 14, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.260 Vali Acc: 0.138 Test Loss: 3.260 Test Acc: 0.138
Validation loss decreased (-0.129379 --> -0.137614).  Saving model ...
Epoch: 15 cost time: 0.5291497707366943
Epoch: 15, Steps: 10 | Train Loss: 2.074 Vali Loss: 3.259 Vali Acc: 0.142 Test Loss: 3.259 Test Acc: 0.142
Validation loss decreased (-0.137614 --> -0.142320).  Saving model ...
Epoch: 16 cost time: 0.5124568939208984
Epoch: 16, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.259 Vali Acc: 0.148 Test Loss: 3.259 Test Acc: 0.148
Validation loss decreased (-0.142320 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.5448641777038574
Epoch: 17, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.268 Vali Acc: 0.151 Test Loss: 3.268 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.5234382152557373
Epoch: 18, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.277 Vali Acc: 0.153 Test Loss: 3.277 Test Acc: 0.153
Validation loss decreased (-0.150556 --> -0.152908).  Saving model ...
Epoch: 19 cost time: 0.5402557849884033
Epoch: 19, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.280 Vali Acc: 0.155 Test Loss: 3.280 Test Acc: 0.155
Validation loss decreased (-0.152908 --> -0.155261).  Saving model ...
Epoch: 20 cost time: 0.5240716934204102
Epoch: 20, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.293 Vali Acc: 0.161 Test Loss: 3.293 Test Acc: 0.161
Validation loss decreased (-0.155261 --> -0.161144).  Saving model ...
Epoch: 21 cost time: 0.5152041912078857
Epoch: 21, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.304 Vali Acc: 0.174 Test Loss: 3.304 Test Acc: 0.174
Validation loss decreased (-0.161144 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.557084321975708
Epoch: 22, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.321 Vali Acc: 0.178 Test Loss: 3.321 Test Acc: 0.178
Validation loss decreased (-0.174085 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.5259170532226562
Epoch: 23, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.333 Vali Acc: 0.182 Test Loss: 3.333 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182320).  Saving model ...
Epoch: 24 cost time: 0.5265598297119141
Epoch: 24, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.354 Vali Acc: 0.188 Test Loss: 3.354 Test Acc: 0.188
Validation loss decreased (-0.182320 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.5319499969482422
Epoch: 25, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.372 Vali Acc: 0.188 Test Loss: 3.372 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.520216703414917
Epoch: 26, Steps: 10 | Train Loss: 1.085 Vali Loss: 3.389 Vali Acc: 0.194 Test Loss: 3.389 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 27 cost time: 0.5475831031799316
Epoch: 27, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.412 Vali Acc: 0.198 Test Loss: 3.412 Test Acc: 0.198
Validation loss decreased (-0.194084 --> -0.197613).  Saving model ...
Epoch: 28 cost time: 0.536780834197998
Epoch: 28, Steps: 10 | Train Loss: 0.904 Vali Loss: 3.430 Vali Acc: 0.199 Test Loss: 3.430 Test Acc: 0.199
Validation loss decreased (-0.197613 --> -0.198789).  Saving model ...
Epoch: 29 cost time: 0.557197093963623
Epoch: 29, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.447 Vali Acc: 0.198 Test Loss: 3.447 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5589778423309326
Epoch: 30, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.466 Vali Acc: 0.202 Test Loss: 3.466 Test Acc: 0.202
Validation loss decreased (-0.198789 --> -0.202318).  Saving model ...
Epoch: 31 cost time: 0.5303981304168701
Epoch: 31, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.496 Vali Acc: 0.201 Test Loss: 3.496 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5400612354278564
Epoch: 32, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.541 Vali Acc: 0.212 Test Loss: 3.541 Test Acc: 0.212
Validation loss decreased (-0.202318 --> -0.211729).  Saving model ...
Epoch: 33 cost time: 0.5478305816650391
Epoch: 33, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.569 Vali Acc: 0.214 Test Loss: 3.569 Test Acc: 0.214
Validation loss decreased (-0.211729 --> -0.214082).  Saving model ...
Epoch: 34 cost time: 0.5261893272399902
Epoch: 34, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.589 Vali Acc: 0.215 Test Loss: 3.589 Test Acc: 0.215
Validation loss decreased (-0.214082 --> -0.215258).  Saving model ...
Epoch: 35 cost time: 0.5690650939941406
Epoch: 35, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.602 Vali Acc: 0.219 Test Loss: 3.602 Test Acc: 0.219
Validation loss decreased (-0.215258 --> -0.218788).  Saving model ...
Epoch: 36 cost time: 0.5326824188232422
Epoch: 36, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.625 Vali Acc: 0.216 Test Loss: 3.625 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5319516658782959
Epoch: 37, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.663 Vali Acc: 0.218 Test Loss: 3.663 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5629336833953857
Epoch: 38, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.700 Vali Acc: 0.218 Test Loss: 3.700 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5323615074157715
Epoch: 39, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.724 Vali Acc: 0.226 Test Loss: 3.724 Test Acc: 0.226
Validation loss decreased (-0.218788 --> -0.225845).  Saving model ...
Epoch: 40 cost time: 0.5427601337432861
Epoch: 40, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.736 Vali Acc: 0.228 Test Loss: 3.736 Test Acc: 0.228
Validation loss decreased (-0.225845 --> -0.228198).  Saving model ...
Epoch: 41 cost time: 0.5496816635131836
Epoch: 41, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.774 Vali Acc: 0.229 Test Loss: 3.774 Test Acc: 0.229
Validation loss decreased (-0.228198 --> -0.229374).  Saving model ...
Epoch: 42 cost time: 0.5532066822052002
Epoch: 42, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.801 Vali Acc: 0.231 Test Loss: 3.801 Test Acc: 0.231
Validation loss decreased (-0.229374 --> -0.230550).  Saving model ...
Epoch: 43 cost time: 0.5536665916442871
Epoch: 43, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.835 Vali Acc: 0.228 Test Loss: 3.835 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5359232425689697
Epoch: 44, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.858 Vali Acc: 0.226 Test Loss: 3.858 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5280611515045166
Epoch: 45, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.882 Vali Acc: 0.229 Test Loss: 3.882 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5263514518737793
Epoch: 46, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.900 Vali Acc: 0.231 Test Loss: 3.900 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5211381912231445
Epoch: 47, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.904 Vali Acc: 0.228 Test Loss: 3.904 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5310590267181396
Epoch: 48, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.928 Vali Acc: 0.236 Test Loss: 3.928 Test Acc: 0.236
Validation loss decreased (-0.230550 --> -0.236431).  Saving model ...
Epoch: 49 cost time: 0.5465526580810547
Epoch: 49, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.932 Vali Acc: 0.235 Test Loss: 3.932 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.55063796043396
Epoch: 50, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.966 Vali Acc: 0.239 Test Loss: 3.966 Test Acc: 0.239
Validation loss decreased (-0.236431 --> -0.238784).  Saving model ...
Epoch: 51 cost time: 0.5247912406921387
Epoch: 51, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.964 Vali Acc: 0.236 Test Loss: 3.964 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5560452938079834
Epoch: 52, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.985 Vali Acc: 0.236 Test Loss: 3.985 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5106940269470215
Epoch: 53, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.018 Vali Acc: 0.242 Test Loss: 4.018 Test Acc: 0.242
Validation loss decreased (-0.238784 --> -0.242313).  Saving model ...
Epoch: 54 cost time: 0.5329203605651855
Epoch: 54, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.035 Vali Acc: 0.240 Test Loss: 4.035 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5824825763702393
Epoch: 55, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.048 Vali Acc: 0.235 Test Loss: 4.048 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5232172012329102
Epoch: 56, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.063 Vali Acc: 0.234 Test Loss: 4.063 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5245785713195801
Epoch: 57, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.074 Vali Acc: 0.246 Test Loss: 4.074 Test Acc: 0.246
Validation loss decreased (-0.242313 --> -0.245842).  Saving model ...
Epoch: 58 cost time: 0.5656557083129883
Epoch: 58, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.106 Vali Acc: 0.240 Test Loss: 4.106 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5553841590881348
Epoch: 59, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.154 Vali Acc: 0.234 Test Loss: 4.154 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6207065582275391
Epoch: 60, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.159 Vali Acc: 0.238 Test Loss: 4.159 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.583331823348999
Epoch: 61, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.169 Vali Acc: 0.238 Test Loss: 4.169 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5407953262329102
Epoch: 62, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.160 Vali Acc: 0.236 Test Loss: 4.160 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5776188373565674
Epoch: 63, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.164 Vali Acc: 0.235 Test Loss: 4.164 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.569049596786499
Epoch: 64, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.187 Vali Acc: 0.234 Test Loss: 4.187 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5437729358673096
Epoch: 65, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.208 Vali Acc: 0.241 Test Loss: 4.208 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5404369831085205
Epoch: 66, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.242 Vali Acc: 0.242 Test Loss: 4.242 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.5477616786956787
Epoch: 67, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.260 Vali Acc: 0.238 Test Loss: 4.260 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 48954
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4972782135009766
Epoch: 1, Steps: 10 | Train Loss: 3.528 Vali Loss: 3.410 Vali Acc: 0.026 Test Loss: 3.410 Test Acc: 0.026
Validation loss decreased (inf --> -0.025848).  Saving model ...
Epoch: 2 cost time: 0.5340936183929443
Epoch: 2, Steps: 10 | Train Loss: 3.460 Vali Loss: 3.399 Vali Acc: 0.029 Test Loss: 3.399 Test Acc: 0.029
Validation loss decreased (-0.025848 --> -0.029378).  Saving model ...
Epoch: 3 cost time: 0.5200567245483398
Epoch: 3, Steps: 10 | Train Loss: 3.455 Vali Loss: 3.386 Vali Acc: 0.034 Test Loss: 3.386 Test Acc: 0.034
Validation loss decreased (-0.029378 --> -0.034084).  Saving model ...
Epoch: 4 cost time: 0.5475411415100098
Epoch: 4, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.371 Vali Acc: 0.042 Test Loss: 3.371 Test Acc: 0.042
Validation loss decreased (-0.034084 --> -0.042319).  Saving model ...
Epoch: 5 cost time: 0.5621824264526367
Epoch: 5, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.358 Vali Acc: 0.048 Test Loss: 3.358 Test Acc: 0.048
Validation loss decreased (-0.042319 --> -0.048202).  Saving model ...
Epoch: 6 cost time: 0.5153906345367432
Epoch: 6, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.345 Vali Acc: 0.055 Test Loss: 3.345 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 7 cost time: 0.5410442352294922
Epoch: 7, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.332 Vali Acc: 0.061 Test Loss: 3.332 Test Acc: 0.061
Validation loss decreased (-0.055261 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 0.5574038028717041
Epoch: 8, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.327 Vali Acc: 0.065 Test Loss: 3.327 Test Acc: 0.065
Validation loss decreased (-0.061143 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 0.574725866317749
Epoch: 9, Steps: 10 | Train Loss: 2.892 Vali Loss: 3.319 Vali Acc: 0.067 Test Loss: 3.319 Test Acc: 0.067
Validation loss decreased (-0.064673 --> -0.067026).  Saving model ...
Epoch: 10 cost time: 0.5753743648529053
Epoch: 10, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.310 Vali Acc: 0.079 Test Loss: 3.310 Test Acc: 0.079
Validation loss decreased (-0.067026 --> -0.078790).  Saving model ...
Epoch: 11 cost time: 0.5112462043762207
Epoch: 11, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.302 Vali Acc: 0.088 Test Loss: 3.302 Test Acc: 0.088
Validation loss decreased (-0.078790 --> -0.088202).  Saving model ...
Epoch: 12 cost time: 0.5184981822967529
Epoch: 12, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.291 Vali Acc: 0.099 Test Loss: 3.291 Test Acc: 0.099
Validation loss decreased (-0.088202 --> -0.098791).  Saving model ...
Epoch: 13 cost time: 0.5021865367889404
Epoch: 13, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.280 Vali Acc: 0.109 Test Loss: 3.280 Test Acc: 0.109
Validation loss decreased (-0.098791 --> -0.109379).  Saving model ...
Epoch: 14 cost time: 0.5662856101989746
Epoch: 14, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.272 Vali Acc: 0.116 Test Loss: 3.272 Test Acc: 0.116
Validation loss decreased (-0.109379 --> -0.116438).  Saving model ...
Epoch: 15 cost time: 0.5299515724182129
Epoch: 15, Steps: 10 | Train Loss: 2.317 Vali Loss: 3.267 Vali Acc: 0.122 Test Loss: 3.267 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122320).  Saving model ...
Epoch: 16 cost time: 0.47887229919433594
Epoch: 16, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.269 Vali Acc: 0.125 Test Loss: 3.269 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 17 cost time: 0.5077519416809082
Epoch: 17, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.264 Vali Acc: 0.134 Test Loss: 3.264 Test Acc: 0.134
Validation loss decreased (-0.124673 --> -0.134085).  Saving model ...
Epoch: 18 cost time: 0.4790306091308594
Epoch: 18, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.264 Vali Acc: 0.151 Test Loss: 3.264 Test Acc: 0.151
Validation loss decreased (-0.134085 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 0.5208494663238525
Epoch: 19, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.273 Vali Acc: 0.156 Test Loss: 3.273 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156438).  Saving model ...
Epoch: 20 cost time: 0.5436131954193115
Epoch: 20, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.277 Vali Acc: 0.160 Test Loss: 3.277 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 21 cost time: 0.5261642932891846
Epoch: 21, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.278 Vali Acc: 0.169 Test Loss: 3.278 Test Acc: 0.169
Validation loss decreased (-0.159967 --> -0.169379).  Saving model ...
Epoch: 22 cost time: 0.5380525588989258
Epoch: 22, Steps: 10 | Train Loss: 1.526 Vali Loss: 3.286 Vali Acc: 0.169 Test Loss: 3.286 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5363774299621582
Epoch: 23, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.298 Vali Acc: 0.175 Test Loss: 3.298 Test Acc: 0.175
Validation loss decreased (-0.169379 --> -0.175261).  Saving model ...
Epoch: 24 cost time: 0.55497145652771
Epoch: 24, Steps: 10 | Train Loss: 1.470 Vali Loss: 3.309 Vali Acc: 0.182 Test Loss: 3.309 Test Acc: 0.182
Validation loss decreased (-0.175261 --> -0.182320).  Saving model ...
Epoch: 25 cost time: 0.5457465648651123
Epoch: 25, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.323 Vali Acc: 0.185 Test Loss: 3.323 Test Acc: 0.185
Validation loss decreased (-0.182320 --> -0.184673).  Saving model ...
Epoch: 26 cost time: 0.531022310256958
Epoch: 26, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.335 Vali Acc: 0.189 Test Loss: 3.335 Test Acc: 0.189
Validation loss decreased (-0.184673 --> -0.189378).  Saving model ...
Epoch: 27 cost time: 0.572756290435791
Epoch: 27, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.342 Vali Acc: 0.191 Test Loss: 3.342 Test Acc: 0.191
Validation loss decreased (-0.189378 --> -0.190555).  Saving model ...
Epoch: 28 cost time: 0.5351574420928955
Epoch: 28, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.353 Vali Acc: 0.204 Test Loss: 3.353 Test Acc: 0.204
Validation loss decreased (-0.190555 --> -0.203496).  Saving model ...
Epoch: 29 cost time: 0.49239587783813477
Epoch: 29, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.382 Vali Acc: 0.205 Test Loss: 3.382 Test Acc: 0.205
Validation loss decreased (-0.203496 --> -0.204672).  Saving model ...
Epoch: 30 cost time: 0.5404407978057861
Epoch: 30, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.396 Vali Acc: 0.208 Test Loss: 3.396 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208201).  Saving model ...
Epoch: 31 cost time: 0.525421142578125
Epoch: 31, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.411 Vali Acc: 0.212 Test Loss: 3.411 Test Acc: 0.212
Validation loss decreased (-0.208201 --> -0.211731).  Saving model ...
Epoch: 32 cost time: 0.5164673328399658
Epoch: 32, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.433 Vali Acc: 0.212 Test Loss: 3.433 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5427756309509277
Epoch: 33, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.432 Vali Acc: 0.218 Test Loss: 3.432 Test Acc: 0.218
Validation loss decreased (-0.211731 --> -0.217613).  Saving model ...
Epoch: 34 cost time: 0.5105431079864502
Epoch: 34, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.467 Vali Acc: 0.213 Test Loss: 3.467 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.49742794036865234
Epoch: 35, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.505 Vali Acc: 0.224 Test Loss: 3.505 Test Acc: 0.224
Validation loss decreased (-0.217613 --> -0.223494).  Saving model ...
Epoch: 36 cost time: 0.5007510185241699
Epoch: 36, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.510 Vali Acc: 0.222 Test Loss: 3.510 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5400490760803223
Epoch: 37, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.524 Vali Acc: 0.224 Test Loss: 3.524 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5371694564819336
Epoch: 38, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.560 Vali Acc: 0.228 Test Loss: 3.560 Test Acc: 0.228
Validation loss decreased (-0.223494 --> -0.228200).  Saving model ...
Epoch: 39 cost time: 0.518836259841919
Epoch: 39, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.570 Vali Acc: 0.234 Test Loss: 3.570 Test Acc: 0.234
Validation loss decreased (-0.228200 --> -0.234082).  Saving model ...
Epoch: 40 cost time: 0.41895508766174316
Epoch: 40, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.605 Vali Acc: 0.235 Test Loss: 3.605 Test Acc: 0.235
Validation loss decreased (-0.234082 --> -0.235258).  Saving model ...
Epoch: 41 cost time: 0.5305063724517822
Epoch: 41, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.605 Vali Acc: 0.236 Test Loss: 3.605 Test Acc: 0.236
Validation loss decreased (-0.235258 --> -0.236435).  Saving model ...
Epoch: 42 cost time: 0.6210005283355713
Epoch: 42, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.655 Vali Acc: 0.234 Test Loss: 3.655 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5183424949645996
Epoch: 43, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.700 Vali Acc: 0.233 Test Loss: 3.700 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5391092300415039
Epoch: 44, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.678 Vali Acc: 0.241 Test Loss: 3.678 Test Acc: 0.241
Validation loss decreased (-0.236435 --> -0.241140).  Saving model ...
Epoch: 45 cost time: 0.5237500667572021
Epoch: 45, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.672 Vali Acc: 0.248 Test Loss: 3.672 Test Acc: 0.248
Validation loss decreased (-0.241140 --> -0.248199).  Saving model ...
Epoch: 46 cost time: 0.5458624362945557
Epoch: 46, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.696 Vali Acc: 0.252 Test Loss: 3.696 Test Acc: 0.252
Validation loss decreased (-0.248199 --> -0.251728).  Saving model ...
Epoch: 47 cost time: 0.5211977958679199
Epoch: 47, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.732 Vali Acc: 0.252 Test Loss: 3.732 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5366256237030029
Epoch: 48, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.765 Vali Acc: 0.242 Test Loss: 3.765 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5297181606292725
Epoch: 49, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.776 Vali Acc: 0.246 Test Loss: 3.776 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5374021530151367
Epoch: 50, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.801 Vali Acc: 0.241 Test Loss: 3.801 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5155868530273438
Epoch: 51, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.796 Vali Acc: 0.244 Test Loss: 3.796 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5394690036773682
Epoch: 52, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.804 Vali Acc: 0.251 Test Loss: 3.804 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5212955474853516
Epoch: 53, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.824 Vali Acc: 0.253 Test Loss: 3.824 Test Acc: 0.253
Validation loss decreased (-0.251728 --> -0.252903).  Saving model ...
Epoch: 54 cost time: 0.5605034828186035
Epoch: 54, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.838 Vali Acc: 0.249 Test Loss: 3.838 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5249559879302979
Epoch: 55, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.879 Vali Acc: 0.246 Test Loss: 3.879 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5996267795562744
Epoch: 56, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.897 Vali Acc: 0.251 Test Loss: 3.897 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6087067127227783
Epoch: 57, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.911 Vali Acc: 0.251 Test Loss: 3.911 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6082868576049805
Epoch: 58, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.916 Vali Acc: 0.247 Test Loss: 3.916 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5241823196411133
Epoch: 59, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.948 Vali Acc: 0.242 Test Loss: 3.948 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.536726713180542
Epoch: 60, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.976 Vali Acc: 0.245 Test Loss: 3.976 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5738239288330078
Epoch: 61, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.974 Vali Acc: 0.251 Test Loss: 3.974 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5899069309234619
Epoch: 62, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.959 Vali Acc: 0.254 Test Loss: 3.959 Test Acc: 0.254
Validation loss decreased (-0.252903 --> -0.254078).  Saving model ...
Epoch: 63 cost time: 0.5874507427215576
Epoch: 63, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.976 Vali Acc: 0.255 Test Loss: 3.976 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255254).  Saving model ...
Epoch: 64 cost time: 0.5513744354248047
Epoch: 64, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.976 Vali Acc: 0.256 Test Loss: 3.976 Test Acc: 0.256
Validation loss decreased (-0.255254 --> -0.256431).  Saving model ...
Epoch: 65 cost time: 0.5353262424468994
Epoch: 65, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.989 Vali Acc: 0.258 Test Loss: 3.989 Test Acc: 0.258
Validation loss decreased (-0.256431 --> -0.257607).  Saving model ...
Epoch: 66 cost time: 0.5546286106109619
Epoch: 66, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.011 Vali Acc: 0.254 Test Loss: 4.011 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5253863334655762
Epoch: 67, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.067 Vali Acc: 0.246 Test Loss: 4.067 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5231661796569824
Epoch: 68, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.055 Vali Acc: 0.252 Test Loss: 4.055 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6278643608093262
Epoch: 69, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.060 Vali Acc: 0.255 Test Loss: 4.060 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.555753231048584
Epoch: 70, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.068 Vali Acc: 0.254 Test Loss: 4.068 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.49826836585998535
Epoch: 71, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.072 Vali Acc: 0.256 Test Loss: 4.072 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5260422229766846
Epoch: 72, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.072 Vali Acc: 0.256 Test Loss: 4.072 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5526683330535889
Epoch: 73, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.080 Vali Acc: 0.261 Test Loss: 4.080 Test Acc: 0.261
Validation loss decreased (-0.257607 --> -0.261136).  Saving model ...
Epoch: 74 cost time: 0.5168039798736572
Epoch: 74, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.093 Vali Acc: 0.260 Test Loss: 4.093 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.542008638381958
Epoch: 75, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.138 Vali Acc: 0.262 Test Loss: 4.138 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262312).  Saving model ...
Epoch: 76 cost time: 0.5804553031921387
Epoch: 76, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.113 Vali Acc: 0.259 Test Loss: 4.113 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.5649034976959229
Epoch: 77, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.116 Vali Acc: 0.260 Test Loss: 4.116 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.5481095314025879
Epoch: 78, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.108 Vali Acc: 0.259 Test Loss: 4.108 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.536391019821167
Epoch: 79, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.127 Vali Acc: 0.262 Test Loss: 4.127 Test Acc: 0.262
Validation loss decreased (-0.262312 --> -0.262312).  Saving model ...
Epoch: 80 cost time: 0.5112874507904053
Epoch: 80, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.150 Vali Acc: 0.261 Test Loss: 4.150 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5497629642486572
Epoch: 81, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.147 Vali Acc: 0.265 Test Loss: 4.147 Test Acc: 0.265
Validation loss decreased (-0.262312 --> -0.264664).  Saving model ...
Epoch: 82 cost time: 0.5480630397796631
Epoch: 82, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.151 Vali Acc: 0.267 Test Loss: 4.151 Test Acc: 0.267
Validation loss decreased (-0.264664 --> -0.267017).  Saving model ...
Epoch: 83 cost time: 0.551743745803833
Epoch: 83, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.169 Vali Acc: 0.264 Test Loss: 4.169 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.5045530796051025
Epoch: 84, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.178 Vali Acc: 0.264 Test Loss: 4.178 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.578202486038208
Epoch: 85, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.190 Vali Acc: 0.261 Test Loss: 4.190 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5694611072540283
Epoch: 86, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.172 Vali Acc: 0.265 Test Loss: 4.172 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.5360565185546875
Epoch: 87, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.182 Vali Acc: 0.267 Test Loss: 4.182 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.5744781494140625
Epoch: 88, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.198 Vali Acc: 0.267 Test Loss: 4.198 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.5072855949401855
Epoch: 89, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.175 Vali Acc: 0.269 Test Loss: 4.175 Test Acc: 0.269
Validation loss decreased (-0.267017 --> -0.269370).  Saving model ...
Epoch: 90 cost time: 0.5428924560546875
Epoch: 90, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.199 Vali Acc: 0.271 Test Loss: 4.199 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270546).  Saving model ...
Epoch: 91 cost time: 0.5811495780944824
Epoch: 91, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.210 Vali Acc: 0.267 Test Loss: 4.210 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.5815005302429199
Epoch: 92, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.230 Vali Acc: 0.271 Test Loss: 4.230 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.5118389129638672
Epoch: 93, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.226 Vali Acc: 0.267 Test Loss: 4.226 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.5535843372344971
Epoch: 94, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.232 Vali Acc: 0.269 Test Loss: 4.232 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.5714840888977051
Epoch: 95, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.234 Vali Acc: 0.272 Test Loss: 4.234 Test Acc: 0.272
Validation loss decreased (-0.270546 --> -0.271722).  Saving model ...
Epoch: 96 cost time: 0.538128137588501
Epoch: 96, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.252 Vali Acc: 0.273 Test Loss: 4.252 Test Acc: 0.273
Validation loss decreased (-0.271722 --> -0.272899).  Saving model ...
Epoch: 97 cost time: 0.5422453880310059
Epoch: 97, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.254 Vali Acc: 0.272 Test Loss: 4.254 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.5383017063140869
Epoch: 98, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.299 Vali Acc: 0.266 Test Loss: 4.299 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.5579538345336914
Epoch: 99, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.308 Vali Acc: 0.271 Test Loss: 4.308 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.5486230850219727
Epoch: 100, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.298 Vali Acc: 0.267 Test Loss: 4.298 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 46682
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.629594326019287
Epoch: 1, Steps: 10 | Train Loss: 3.490 Vali Loss: 3.344 Vali Acc: 0.044 Test Loss: 3.344 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.5289254188537598
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.356 Vali Acc: 0.056 Test Loss: 3.356 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.5491008758544922
Epoch: 3, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.370 Vali Acc: 0.076 Test Loss: 3.370 Test Acc: 0.076
Validation loss decreased (-0.056437 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.5183837413787842
Epoch: 4, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.274 Vali Acc: 0.116 Test Loss: 3.274 Test Acc: 0.116
Validation loss decreased (-0.076437 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.5739171504974365
Epoch: 5, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.225 Vali Acc: 0.139 Test Loss: 3.225 Test Acc: 0.139
Validation loss decreased (-0.116438 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.5614223480224609
Epoch: 6, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.270 Vali Acc: 0.134 Test Loss: 3.270 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5394477844238281
Epoch: 7, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.221 Vali Acc: 0.172 Test Loss: 3.221 Test Acc: 0.172
Validation loss decreased (-0.138791 --> -0.171732).  Saving model ...
Epoch: 8 cost time: 0.510298490524292
Epoch: 8, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.284 Vali Acc: 0.194 Test Loss: 3.284 Test Acc: 0.194
Validation loss decreased (-0.171732 --> -0.194085).  Saving model ...
Epoch: 9 cost time: 0.563828706741333
Epoch: 9, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.360 Vali Acc: 0.205 Test Loss: 3.360 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204672).  Saving model ...
Epoch: 10 cost time: 0.6141703128814697
Epoch: 10, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.389 Vali Acc: 0.209 Test Loss: 3.389 Test Acc: 0.209
Validation loss decreased (-0.204672 --> -0.209378).  Saving model ...
Epoch: 11 cost time: 0.5131962299346924
Epoch: 11, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.437 Vali Acc: 0.238 Test Loss: 3.437 Test Acc: 0.238
Validation loss decreased (-0.209378 --> -0.237613).  Saving model ...
Epoch: 12 cost time: 0.5445680618286133
Epoch: 12, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.579 Vali Acc: 0.220 Test Loss: 3.579 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5440981388092041
Epoch: 13, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.674 Vali Acc: 0.248 Test Loss: 3.674 Test Acc: 0.248
Validation loss decreased (-0.237613 --> -0.248199).  Saving model ...
Epoch: 14 cost time: 0.5500028133392334
Epoch: 14, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.783 Vali Acc: 0.238 Test Loss: 3.783 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5622279644012451
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.882 Vali Acc: 0.258 Test Loss: 3.882 Test Acc: 0.258
Validation loss decreased (-0.248199 --> -0.257608).  Saving model ...
Epoch: 16 cost time: 0.544165849685669
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.019 Vali Acc: 0.251 Test Loss: 4.019 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5366740226745605
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.045 Vali Acc: 0.264 Test Loss: 4.045 Test Acc: 0.264
Validation loss decreased (-0.257608 --> -0.263489).  Saving model ...
Epoch: 18 cost time: 0.526010274887085
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.131 Vali Acc: 0.262 Test Loss: 4.131 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5346522331237793
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.240 Vali Acc: 0.261 Test Loss: 4.240 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5348906517028809
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.298 Vali Acc: 0.269 Test Loss: 4.298 Test Acc: 0.269
Validation loss decreased (-0.263489 --> -0.269369).  Saving model ...
Epoch: 21 cost time: 0.5316426753997803
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.325 Vali Acc: 0.265 Test Loss: 4.325 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5456793308258057
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.359 Vali Acc: 0.265 Test Loss: 4.359 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5618882179260254
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.362 Vali Acc: 0.269 Test Loss: 4.362 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5308642387390137
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.401 Vali Acc: 0.268 Test Loss: 4.401 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5410420894622803
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.434 Vali Acc: 0.268 Test Loss: 4.434 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5089139938354492
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.458 Vali Acc: 0.274 Test Loss: 4.458 Test Acc: 0.274
Validation loss decreased (-0.269369 --> -0.274073).  Saving model ...
Epoch: 27 cost time: 0.5465881824493408
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.457 Vali Acc: 0.276 Test Loss: 4.457 Test Acc: 0.276
Validation loss decreased (-0.274073 --> -0.276426).  Saving model ...
Epoch: 28 cost time: 0.5410404205322266
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.488 Vali Acc: 0.274 Test Loss: 4.488 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5118381977081299
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.527 Vali Acc: 0.280 Test Loss: 4.527 Test Acc: 0.280
Validation loss decreased (-0.276426 --> -0.279955).  Saving model ...
Epoch: 30 cost time: 0.5143876075744629
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.546 Vali Acc: 0.274 Test Loss: 4.546 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5201137065887451
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.573 Vali Acc: 0.275 Test Loss: 4.573 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5698487758636475
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.602 Vali Acc: 0.278 Test Loss: 4.602 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5502243041992188
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.618 Vali Acc: 0.272 Test Loss: 4.618 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5604255199432373
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.622 Vali Acc: 0.273 Test Loss: 4.622 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5547044277191162
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.638 Vali Acc: 0.275 Test Loss: 4.638 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5376896858215332
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.672 Vali Acc: 0.278 Test Loss: 4.672 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5111243724822998
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.681 Vali Acc: 0.279 Test Loss: 4.681 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.552485466003418
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.700 Vali Acc: 0.279 Test Loss: 4.700 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5434176921844482
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.712 Vali Acc: 0.276 Test Loss: 4.712 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 207002
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5121691226959229
Epoch: 1, Steps: 10 | Train Loss: 3.481 Vali Loss: 3.366 Vali Acc: 0.028 Test Loss: 3.366 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.5318009853363037
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.353 Vali Acc: 0.039 Test Loss: 3.353 Test Acc: 0.039
Validation loss decreased (-0.028202 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.507702112197876
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.377 Vali Acc: 0.056 Test Loss: 3.377 Test Acc: 0.056
Validation loss decreased (-0.038790 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.5601718425750732
Epoch: 4, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.352 Vali Acc: 0.079 Test Loss: 3.352 Test Acc: 0.079
Validation loss decreased (-0.056437 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 0.5242476463317871
Epoch: 5, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.300 Vali Acc: 0.094 Test Loss: 3.300 Test Acc: 0.094
Validation loss decreased (-0.078790 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.5468690395355225
Epoch: 6, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.257 Vali Acc: 0.112 Test Loss: 3.257 Test Acc: 0.112
Validation loss decreased (-0.094085 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 0.5621991157531738
Epoch: 7, Steps: 10 | Train Loss: 2.296 Vali Loss: 3.259 Vali Acc: 0.115 Test Loss: 3.259 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 8 cost time: 0.5800554752349854
Epoch: 8, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.258 Vali Acc: 0.146 Test Loss: 3.258 Test Acc: 0.146
Validation loss decreased (-0.115262 --> -0.145850).  Saving model ...
Epoch: 9 cost time: 0.4949347972869873
Epoch: 9, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.274 Vali Acc: 0.135 Test Loss: 3.274 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5137426853179932
Epoch: 10, Steps: 10 | Train Loss: 1.632 Vali Loss: 3.296 Vali Acc: 0.160 Test Loss: 3.296 Test Acc: 0.160
Validation loss decreased (-0.145850 --> -0.159967).  Saving model ...
Epoch: 11 cost time: 0.5325758457183838
Epoch: 11, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.312 Vali Acc: 0.178 Test Loss: 3.312 Test Acc: 0.178
Validation loss decreased (-0.159967 --> -0.177614).  Saving model ...
Epoch: 12 cost time: 0.515251636505127
Epoch: 12, Steps: 10 | Train Loss: 1.248 Vali Loss: 3.330 Vali Acc: 0.196 Test Loss: 3.330 Test Acc: 0.196
Validation loss decreased (-0.177614 --> -0.196437).  Saving model ...
Epoch: 13 cost time: 0.5542500019073486
Epoch: 13, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.387 Vali Acc: 0.199 Test Loss: 3.387 Test Acc: 0.199
Validation loss decreased (-0.196437 --> -0.198790).  Saving model ...
Epoch: 14 cost time: 0.5457673072814941
Epoch: 14, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.463 Vali Acc: 0.192 Test Loss: 3.463 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5344271659851074
Epoch: 15, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.472 Vali Acc: 0.205 Test Loss: 3.472 Test Acc: 0.205
Validation loss decreased (-0.198790 --> -0.204671).  Saving model ...
Epoch: 16 cost time: 0.540045976638794
Epoch: 16, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.530 Vali Acc: 0.221 Test Loss: 3.530 Test Acc: 0.221
Validation loss decreased (-0.204671 --> -0.221141).  Saving model ...
Epoch: 17 cost time: 0.5374972820281982
Epoch: 17, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.618 Vali Acc: 0.228 Test Loss: 3.618 Test Acc: 0.228
Validation loss decreased (-0.221141 --> -0.228199).  Saving model ...
Epoch: 18 cost time: 0.5518991947174072
Epoch: 18, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.668 Vali Acc: 0.238 Test Loss: 3.668 Test Acc: 0.238
Validation loss decreased (-0.228199 --> -0.237610).  Saving model ...
Epoch: 19 cost time: 0.5126063823699951
Epoch: 19, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.717 Vali Acc: 0.240 Test Loss: 3.717 Test Acc: 0.240
Validation loss decreased (-0.237610 --> -0.239963).  Saving model ...
Epoch: 20 cost time: 0.5511918067932129
Epoch: 20, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.842 Vali Acc: 0.232 Test Loss: 3.842 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5557107925415039
Epoch: 21, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.918 Vali Acc: 0.236 Test Loss: 3.918 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5467493534088135
Epoch: 22, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.973 Vali Acc: 0.245 Test Loss: 3.973 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244666).  Saving model ...
Epoch: 23 cost time: 0.5231759548187256
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.992 Vali Acc: 0.249 Test Loss: 3.992 Test Acc: 0.249
Validation loss decreased (-0.244666 --> -0.249372).  Saving model ...
Epoch: 24 cost time: 0.5231130123138428
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.077 Vali Acc: 0.245 Test Loss: 4.077 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5499098300933838
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.061 Vali Acc: 0.251 Test Loss: 4.061 Test Acc: 0.251
Validation loss decreased (-0.249372 --> -0.250548).  Saving model ...
Epoch: 26 cost time: 0.5224814414978027
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.083 Vali Acc: 0.258 Test Loss: 4.083 Test Acc: 0.258
Validation loss decreased (-0.250548 --> -0.257606).  Saving model ...
Epoch: 27 cost time: 0.5077769756317139
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.140 Vali Acc: 0.253 Test Loss: 4.140 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5388936996459961
Epoch: 28, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.204 Vali Acc: 0.247 Test Loss: 4.204 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5318284034729004
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.225 Vali Acc: 0.252 Test Loss: 4.225 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5110421180725098
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.257 Vali Acc: 0.255 Test Loss: 4.257 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5285906791687012
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.279 Vali Acc: 0.262 Test Loss: 4.279 Test Acc: 0.262
Validation loss decreased (-0.257606 --> -0.262310).  Saving model ...
Epoch: 32 cost time: 0.5291798114776611
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.297 Vali Acc: 0.261 Test Loss: 4.297 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5230348110198975
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.311 Vali Acc: 0.264 Test Loss: 4.311 Test Acc: 0.264
Validation loss decreased (-0.262310 --> -0.263486).  Saving model ...
Epoch: 34 cost time: 0.5610342025756836
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.337 Vali Acc: 0.262 Test Loss: 4.337 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.570138692855835
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.355 Vali Acc: 0.260 Test Loss: 4.355 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.564007043838501
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.385 Vali Acc: 0.260 Test Loss: 4.385 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5829510688781738
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.418 Vali Acc: 0.259 Test Loss: 4.418 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5504388809204102
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.421 Vali Acc: 0.260 Test Loss: 4.421 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5508110523223877
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.444 Vali Acc: 0.261 Test Loss: 4.444 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5608453750610352
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.451 Vali Acc: 0.267 Test Loss: 4.451 Test Acc: 0.267
Validation loss decreased (-0.263486 --> -0.267014).  Saving model ...
Epoch: 41 cost time: 0.5386378765106201
Epoch: 41, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.478 Vali Acc: 0.267 Test Loss: 4.478 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5563545227050781
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.498 Vali Acc: 0.271 Test Loss: 4.498 Test Acc: 0.271
Validation loss decreased (-0.267014 --> -0.270543).  Saving model ...
Epoch: 43 cost time: 0.5380146503448486
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.505 Vali Acc: 0.272 Test Loss: 4.505 Test Acc: 0.272
Validation loss decreased (-0.270543 --> -0.271720).  Saving model ...
Epoch: 44 cost time: 0.5505592823028564
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.525 Vali Acc: 0.267 Test Loss: 4.525 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5638124942779541
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.529 Vali Acc: 0.274 Test Loss: 4.529 Test Acc: 0.274
Validation loss decreased (-0.271720 --> -0.274072).  Saving model ...
Epoch: 46 cost time: 0.5515182018280029
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.530 Vali Acc: 0.274 Test Loss: 4.530 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5605945587158203
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.547 Vali Acc: 0.269 Test Loss: 4.547 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5471010208129883
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.572 Vali Acc: 0.272 Test Loss: 4.572 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5275356769561768
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.587 Vali Acc: 0.272 Test Loss: 4.587 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.548445463180542
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.606 Vali Acc: 0.275 Test Loss: 4.606 Test Acc: 0.275
Validation loss decreased (-0.274072 --> -0.275248).  Saving model ...
Epoch: 51 cost time: 0.539337158203125
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.613 Vali Acc: 0.280 Test Loss: 4.613 Test Acc: 0.280
Validation loss decreased (-0.275248 --> -0.279954).  Saving model ...
Epoch: 52 cost time: 0.5348765850067139
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.629 Vali Acc: 0.272 Test Loss: 4.629 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5455970764160156
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.645 Vali Acc: 0.269 Test Loss: 4.645 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5588183403015137
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.665 Vali Acc: 0.272 Test Loss: 4.665 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5634214878082275
Epoch: 55, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.678 Vali Acc: 0.275 Test Loss: 4.678 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.556102991104126
Epoch: 56, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.689 Vali Acc: 0.276 Test Loss: 4.689 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5801064968109131
Epoch: 57, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.684 Vali Acc: 0.278 Test Loss: 4.684 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.533315896987915
Epoch: 58, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.699 Vali Acc: 0.274 Test Loss: 4.699 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5343489646911621
Epoch: 59, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.722 Vali Acc: 0.272 Test Loss: 4.722 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5132091045379639
Epoch: 60, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.730 Vali Acc: 0.272 Test Loss: 4.730 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5313529968261719
Epoch: 61, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.740 Vali Acc: 0.274 Test Loss: 4.740 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 112282
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6251001358032227
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.348 Vali Acc: 0.048 Test Loss: 3.348 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.5333662033081055
Epoch: 2, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.332 Vali Acc: 0.060 Test Loss: 3.332 Test Acc: 0.060
Validation loss decreased (-0.048202 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.5606198310852051
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.326 Vali Acc: 0.073 Test Loss: 3.326 Test Acc: 0.073
Validation loss decreased (-0.059967 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.5415709018707275
Epoch: 4, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.317 Vali Acc: 0.079 Test Loss: 3.317 Test Acc: 0.079
Validation loss decreased (-0.072908 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 0.4946408271789551
Epoch: 5, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.311 Vali Acc: 0.080 Test Loss: 3.311 Test Acc: 0.080
Validation loss decreased (-0.078790 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.5407102108001709
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.300 Vali Acc: 0.098 Test Loss: 3.300 Test Acc: 0.098
Validation loss decreased (-0.079967 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.5340189933776855
Epoch: 7, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.280 Vali Acc: 0.112 Test Loss: 3.280 Test Acc: 0.112
Validation loss decreased (-0.097614 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.5088074207305908
Epoch: 8, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.267 Vali Acc: 0.129 Test Loss: 3.267 Test Acc: 0.129
Validation loss decreased (-0.111732 --> -0.129379).  Saving model ...
Epoch: 9 cost time: 0.39585089683532715
Epoch: 9, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.239 Vali Acc: 0.129 Test Loss: 3.239 Test Acc: 0.129
Validation loss decreased (-0.129379 --> -0.129379).  Saving model ...
Epoch: 10 cost time: 0.5601606369018555
Epoch: 10, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.229 Vali Acc: 0.144 Test Loss: 3.229 Test Acc: 0.144
Validation loss decreased (-0.129379 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.5781722068786621
Epoch: 11, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.230 Vali Acc: 0.149 Test Loss: 3.230 Test Acc: 0.149
Validation loss decreased (-0.143497 --> -0.149379).  Saving model ...
Epoch: 12 cost time: 0.5129804611206055
Epoch: 12, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.240 Vali Acc: 0.159 Test Loss: 3.240 Test Acc: 0.159
Validation loss decreased (-0.149379 --> -0.158791).  Saving model ...
Epoch: 13 cost time: 0.510263204574585
Epoch: 13, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.255 Vali Acc: 0.181 Test Loss: 3.255 Test Acc: 0.181
Validation loss decreased (-0.158791 --> -0.181144).  Saving model ...
Epoch: 14 cost time: 0.4955880641937256
Epoch: 14, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.269 Vali Acc: 0.184 Test Loss: 3.269 Test Acc: 0.184
Validation loss decreased (-0.181144 --> -0.183497).  Saving model ...
Epoch: 15 cost time: 0.5243988037109375
Epoch: 15, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.285 Vali Acc: 0.191 Test Loss: 3.285 Test Acc: 0.191
Validation loss decreased (-0.183497 --> -0.190555).  Saving model ...
Epoch: 16 cost time: 0.5882446765899658
Epoch: 16, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.323 Vali Acc: 0.201 Test Loss: 3.323 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201143).  Saving model ...
Epoch: 17 cost time: 0.5126492977142334
Epoch: 17, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.372 Vali Acc: 0.214 Test Loss: 3.372 Test Acc: 0.214
Validation loss decreased (-0.201143 --> -0.214084).  Saving model ...
Epoch: 18 cost time: 0.5013041496276855
Epoch: 18, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.405 Vali Acc: 0.215 Test Loss: 3.405 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215260).  Saving model ...
Epoch: 19 cost time: 0.5170822143554688
Epoch: 19, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.444 Vali Acc: 0.224 Test Loss: 3.444 Test Acc: 0.224
Validation loss decreased (-0.215260 --> -0.223495).  Saving model ...
Epoch: 20 cost time: 0.5210330486297607
Epoch: 20, Steps: 10 | Train Loss: 0.546 Vali Loss: 3.491 Vali Acc: 0.225 Test Loss: 3.491 Test Acc: 0.225
Validation loss decreased (-0.223495 --> -0.224671).  Saving model ...
Epoch: 21 cost time: 0.47674036026000977
Epoch: 21, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.548 Vali Acc: 0.232 Test Loss: 3.548 Test Acc: 0.232
Validation loss decreased (-0.224671 --> -0.231729).  Saving model ...
Epoch: 22 cost time: 0.5130784511566162
Epoch: 22, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.588 Vali Acc: 0.228 Test Loss: 3.588 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.48024988174438477
Epoch: 23, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.663 Vali Acc: 0.228 Test Loss: 3.663 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5301098823547363
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.727 Vali Acc: 0.227 Test Loss: 3.727 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.49356627464294434
Epoch: 25, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.734 Vali Acc: 0.236 Test Loss: 3.734 Test Acc: 0.236
Validation loss decreased (-0.231729 --> -0.236433).  Saving model ...
Epoch: 26 cost time: 0.490344762802124
Epoch: 26, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.779 Vali Acc: 0.235 Test Loss: 3.779 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5187628269195557
Epoch: 27, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.856 Vali Acc: 0.239 Test Loss: 3.856 Test Acc: 0.239
Validation loss decreased (-0.236433 --> -0.238785).  Saving model ...
Epoch: 28 cost time: 0.5283420085906982
Epoch: 28, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.912 Vali Acc: 0.234 Test Loss: 3.912 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5044705867767334
Epoch: 29, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.948 Vali Acc: 0.235 Test Loss: 3.948 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5309574604034424
Epoch: 30, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.977 Vali Acc: 0.238 Test Loss: 3.977 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5499496459960938
Epoch: 31, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.995 Vali Acc: 0.249 Test Loss: 3.995 Test Acc: 0.249
Validation loss decreased (-0.238785 --> -0.249372).  Saving model ...
Epoch: 32 cost time: 0.4734489917755127
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.049 Vali Acc: 0.246 Test Loss: 4.049 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5124893188476562
Epoch: 33, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.105 Vali Acc: 0.242 Test Loss: 4.105 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5120649337768555
Epoch: 34, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.145 Vali Acc: 0.228 Test Loss: 4.145 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5055534839630127
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.185 Vali Acc: 0.231 Test Loss: 4.185 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5691659450531006
Epoch: 36, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.184 Vali Acc: 0.234 Test Loss: 4.184 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5522212982177734
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.197 Vali Acc: 0.241 Test Loss: 4.197 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.518467903137207
Epoch: 38, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.211 Vali Acc: 0.239 Test Loss: 4.211 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5299420356750488
Epoch: 39, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.214 Vali Acc: 0.244 Test Loss: 4.214 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5458850860595703
Epoch: 40, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.235 Vali Acc: 0.244 Test Loss: 4.235 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5060505867004395
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.267 Vali Acc: 0.242 Test Loss: 4.267 Test Acc: 0.242
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 79962
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.530277967453003
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.358 Vali Acc: 0.034 Test Loss: 3.358 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.5753920078277588
Epoch: 2, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.332 Vali Acc: 0.046 Test Loss: 3.332 Test Acc: 0.046
Validation loss decreased (-0.034084 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.547783613204956
Epoch: 3, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.314 Vali Acc: 0.047 Test Loss: 3.314 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.552764892578125
Epoch: 4, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.309 Vali Acc: 0.061 Test Loss: 3.309 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.5273933410644531
Epoch: 5, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.300 Vali Acc: 0.073 Test Loss: 3.300 Test Acc: 0.073
Validation loss decreased (-0.061143 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 0.5375170707702637
Epoch: 6, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.288 Vali Acc: 0.087 Test Loss: 3.288 Test Acc: 0.087
Validation loss decreased (-0.072908 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 0.5402295589447021
Epoch: 7, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.272 Vali Acc: 0.104 Test Loss: 3.272 Test Acc: 0.104
Validation loss decreased (-0.087026 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.5074057579040527
Epoch: 8, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.267 Vali Acc: 0.115 Test Loss: 3.267 Test Acc: 0.115
Validation loss decreased (-0.103497 --> -0.115261).  Saving model ...
Epoch: 9 cost time: 0.6357219219207764
Epoch: 9, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.259 Vali Acc: 0.116 Test Loss: 3.259 Test Acc: 0.116
Validation loss decreased (-0.115261 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 0.5619325637817383
Epoch: 10, Steps: 10 | Train Loss: 2.175 Vali Loss: 3.240 Vali Acc: 0.127 Test Loss: 3.240 Test Acc: 0.127
Validation loss decreased (-0.116438 --> -0.127026).  Saving model ...
Epoch: 11 cost time: 0.539238691329956
Epoch: 11, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.236 Vali Acc: 0.133 Test Loss: 3.236 Test Acc: 0.133
Validation loss decreased (-0.127026 --> -0.132909).  Saving model ...
Epoch: 12 cost time: 0.5260369777679443
Epoch: 12, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.237 Vali Acc: 0.139 Test Loss: 3.237 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138791).  Saving model ...
Epoch: 13 cost time: 0.5585708618164062
Epoch: 13, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.246 Vali Acc: 0.148 Test Loss: 3.246 Test Acc: 0.148
Validation loss decreased (-0.138791 --> -0.148203).  Saving model ...
Epoch: 14 cost time: 0.5237131118774414
Epoch: 14, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.261 Vali Acc: 0.165 Test Loss: 3.261 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164673).  Saving model ...
Epoch: 15 cost time: 0.6028032302856445
Epoch: 15, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.272 Vali Acc: 0.172 Test Loss: 3.272 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171732).  Saving model ...
Epoch: 16 cost time: 0.5411791801452637
Epoch: 16, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.290 Vali Acc: 0.176 Test Loss: 3.290 Test Acc: 0.176
Validation loss decreased (-0.171732 --> -0.176438).  Saving model ...
Epoch: 17 cost time: 0.5221583843231201
Epoch: 17, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.304 Vali Acc: 0.184 Test Loss: 3.304 Test Acc: 0.184
Validation loss decreased (-0.176438 --> -0.183496).  Saving model ...
Epoch: 18 cost time: 0.5310490131378174
Epoch: 18, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.333 Vali Acc: 0.191 Test Loss: 3.333 Test Acc: 0.191
Validation loss decreased (-0.183496 --> -0.190555).  Saving model ...
Epoch: 19 cost time: 0.5141274929046631
Epoch: 19, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.359 Vali Acc: 0.191 Test Loss: 3.359 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5346629619598389
Epoch: 20, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.396 Vali Acc: 0.207 Test Loss: 3.396 Test Acc: 0.207
Validation loss decreased (-0.190555 --> -0.207025).  Saving model ...
Epoch: 21 cost time: 0.5156512260437012
Epoch: 21, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.443 Vali Acc: 0.216 Test Loss: 3.443 Test Acc: 0.216
Validation loss decreased (-0.207025 --> -0.216436).  Saving model ...
Epoch: 22 cost time: 0.567274808883667
Epoch: 22, Steps: 10 | Train Loss: 0.656 Vali Loss: 3.483 Vali Acc: 0.220 Test Loss: 3.483 Test Acc: 0.220
Validation loss decreased (-0.216436 --> -0.219965).  Saving model ...
Epoch: 23 cost time: 0.5428948402404785
Epoch: 23, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.498 Vali Acc: 0.231 Test Loss: 3.498 Test Acc: 0.231
Validation loss decreased (-0.219965 --> -0.230553).  Saving model ...
Epoch: 24 cost time: 0.5205662250518799
Epoch: 24, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.523 Vali Acc: 0.238 Test Loss: 3.523 Test Acc: 0.238
Validation loss decreased (-0.230553 --> -0.237612).  Saving model ...
Epoch: 25 cost time: 0.5527105331420898
Epoch: 25, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.588 Vali Acc: 0.229 Test Loss: 3.588 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5657389163970947
Epoch: 26, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.632 Vali Acc: 0.232 Test Loss: 3.632 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5034258365631104
Epoch: 27, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.684 Vali Acc: 0.235 Test Loss: 3.684 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5591917037963867
Epoch: 28, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.712 Vali Acc: 0.244 Test Loss: 3.712 Test Acc: 0.244
Validation loss decreased (-0.237612 --> -0.243492).  Saving model ...
Epoch: 29 cost time: 0.5365653038024902
Epoch: 29, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.749 Vali Acc: 0.238 Test Loss: 3.749 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5161411762237549
Epoch: 30, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.779 Vali Acc: 0.240 Test Loss: 3.779 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5316708087921143
Epoch: 31, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.828 Vali Acc: 0.251 Test Loss: 3.828 Test Acc: 0.251
Validation loss decreased (-0.243492 --> -0.250550).  Saving model ...
Epoch: 32 cost time: 0.5628583431243896
Epoch: 32, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.859 Vali Acc: 0.252 Test Loss: 3.859 Test Acc: 0.252
Validation loss decreased (-0.250550 --> -0.251726).  Saving model ...
Epoch: 33 cost time: 0.526681661605835
Epoch: 33, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.890 Vali Acc: 0.247 Test Loss: 3.890 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5165660381317139
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.918 Vali Acc: 0.247 Test Loss: 3.918 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5284535884857178
Epoch: 35, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.951 Vali Acc: 0.251 Test Loss: 3.951 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5307090282440186
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.980 Vali Acc: 0.240 Test Loss: 3.980 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5852148532867432
Epoch: 37, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.025 Vali Acc: 0.238 Test Loss: 4.025 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5322442054748535
Epoch: 38, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.030 Vali Acc: 0.245 Test Loss: 4.030 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.567924976348877
Epoch: 39, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.046 Vali Acc: 0.251 Test Loss: 4.046 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5854692459106445
Epoch: 40, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.063 Vali Acc: 0.254 Test Loss: 4.063 Test Acc: 0.254
Validation loss decreased (-0.251726 --> -0.254077).  Saving model ...
Epoch: 41 cost time: 0.5636069774627686
Epoch: 41, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.074 Vali Acc: 0.260 Test Loss: 4.074 Test Acc: 0.260
Validation loss decreased (-0.254077 --> -0.259959).  Saving model ...
Epoch: 42 cost time: 0.5819549560546875
Epoch: 42, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.126 Vali Acc: 0.247 Test Loss: 4.126 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5486209392547607
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.157 Vali Acc: 0.244 Test Loss: 4.157 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5282318592071533
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.179 Vali Acc: 0.245 Test Loss: 4.179 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5467751026153564
Epoch: 45, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.178 Vali Acc: 0.249 Test Loss: 4.178 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5614233016967773
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.192 Vali Acc: 0.248 Test Loss: 4.192 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.436565637588501
Epoch: 47, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.210 Vali Acc: 0.251 Test Loss: 4.210 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5452160835266113
Epoch: 48, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.235 Vali Acc: 0.247 Test Loss: 4.235 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5627419948577881
Epoch: 49, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.258 Vali Acc: 0.248 Test Loss: 4.258 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.5257120132446289
Epoch: 50, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.291 Vali Acc: 0.251 Test Loss: 4.291 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.5620746612548828
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.301 Vali Acc: 0.252 Test Loss: 4.301 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 65114
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4994699954986572
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.363 Vali Acc: 0.035 Test Loss: 3.363 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 0.5120820999145508
Epoch: 2, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.349 Vali Acc: 0.035 Test Loss: 3.349 Test Acc: 0.035
Validation loss decreased (-0.035260 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.4648001194000244
Epoch: 3, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.331 Vali Acc: 0.028 Test Loss: 3.331 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5299506187438965
Epoch: 4, Steps: 10 | Train Loss: 3.242 Vali Loss: 3.317 Vali Acc: 0.027 Test Loss: 3.317 Test Acc: 0.027
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5044281482696533
Epoch: 5, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.303 Vali Acc: 0.035 Test Loss: 3.303 Test Acc: 0.035
Validation loss decreased (-0.035261 --> -0.035261).  Saving model ...
Epoch: 6 cost time: 0.5206606388092041
Epoch: 6, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.291 Vali Acc: 0.051 Test Loss: 3.291 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 0.5220086574554443
Epoch: 7, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.288 Vali Acc: 0.056 Test Loss: 3.288 Test Acc: 0.056
Validation loss decreased (-0.050555 --> -0.056438).  Saving model ...
Epoch: 8 cost time: 0.5609610080718994
Epoch: 8, Steps: 10 | Train Loss: 2.716 Vali Loss: 3.276 Vali Acc: 0.068 Test Loss: 3.276 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068203).  Saving model ...
Epoch: 9 cost time: 0.417186975479126
Epoch: 9, Steps: 10 | Train Loss: 2.605 Vali Loss: 3.273 Vali Acc: 0.079 Test Loss: 3.273 Test Acc: 0.079
Validation loss decreased (-0.068203 --> -0.078791).  Saving model ...
Epoch: 10 cost time: 0.4951643943786621
Epoch: 10, Steps: 10 | Train Loss: 2.525 Vali Loss: 3.267 Vali Acc: 0.086 Test Loss: 3.267 Test Acc: 0.086
Validation loss decreased (-0.078791 --> -0.085850).  Saving model ...
Epoch: 11 cost time: 0.5131916999816895
Epoch: 11, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.256 Vali Acc: 0.096 Test Loss: 3.256 Test Acc: 0.096
Validation loss decreased (-0.085850 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.508948564529419
Epoch: 12, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.251 Vali Acc: 0.111 Test Loss: 3.251 Test Acc: 0.111
Validation loss decreased (-0.096438 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 0.4974493980407715
Epoch: 13, Steps: 10 | Train Loss: 2.110 Vali Loss: 3.245 Vali Acc: 0.119 Test Loss: 3.245 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 0.5007009506225586
Epoch: 14, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.243 Vali Acc: 0.131 Test Loss: 3.243 Test Acc: 0.131
Validation loss decreased (-0.118791 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.5070643424987793
Epoch: 15, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.249 Vali Acc: 0.138 Test Loss: 3.249 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 16 cost time: 0.5111639499664307
Epoch: 16, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.246 Vali Acc: 0.142 Test Loss: 3.246 Test Acc: 0.142
Validation loss decreased (-0.137615 --> -0.142320).  Saving model ...
Epoch: 17 cost time: 0.5735654830932617
Epoch: 17, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.254 Vali Acc: 0.151 Test Loss: 3.254 Test Acc: 0.151
Validation loss decreased (-0.142320 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.49765443801879883
Epoch: 18, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.262 Vali Acc: 0.159 Test Loss: 3.262 Test Acc: 0.159
Validation loss decreased (-0.150556 --> -0.158791).  Saving model ...
Epoch: 19 cost time: 0.511378288269043
Epoch: 19, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.262 Vali Acc: 0.176 Test Loss: 3.262 Test Acc: 0.176
Validation loss decreased (-0.158791 --> -0.176438).  Saving model ...
Epoch: 20 cost time: 0.5036916732788086
Epoch: 20, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.290 Vali Acc: 0.186 Test Loss: 3.290 Test Acc: 0.186
Validation loss decreased (-0.176438 --> -0.185849).  Saving model ...
Epoch: 21 cost time: 0.5134060382843018
Epoch: 21, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.321 Vali Acc: 0.185 Test Loss: 3.321 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5177314281463623
Epoch: 22, Steps: 10 | Train Loss: 1.079 Vali Loss: 3.324 Vali Acc: 0.191 Test Loss: 3.324 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190555).  Saving model ...
Epoch: 23 cost time: 0.5136377811431885
Epoch: 23, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.340 Vali Acc: 0.198 Test Loss: 3.340 Test Acc: 0.198
Validation loss decreased (-0.190555 --> -0.197614).  Saving model ...
Epoch: 24 cost time: 0.5301132202148438
Epoch: 24, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.369 Vali Acc: 0.198 Test Loss: 3.369 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5155229568481445
Epoch: 25, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.391 Vali Acc: 0.206 Test Loss: 3.391 Test Acc: 0.206
Validation loss decreased (-0.197614 --> -0.205848).  Saving model ...
Epoch: 26 cost time: 0.5351600646972656
Epoch: 26, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.408 Vali Acc: 0.214 Test Loss: 3.408 Test Acc: 0.214
Validation loss decreased (-0.205848 --> -0.214084).  Saving model ...
Epoch: 27 cost time: 0.520409345626831
Epoch: 27, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.440 Vali Acc: 0.220 Test Loss: 3.440 Test Acc: 0.220
Validation loss decreased (-0.214084 --> -0.219966).  Saving model ...
Epoch: 28 cost time: 0.5149040222167969
Epoch: 28, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.467 Vali Acc: 0.227 Test Loss: 3.467 Test Acc: 0.227
Validation loss decreased (-0.219966 --> -0.227024).  Saving model ...
Epoch: 29 cost time: 0.5292794704437256
Epoch: 29, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.516 Vali Acc: 0.227 Test Loss: 3.516 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5213725566864014
Epoch: 30, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.544 Vali Acc: 0.238 Test Loss: 3.544 Test Acc: 0.238
Validation loss decreased (-0.227024 --> -0.237612).  Saving model ...
Epoch: 31 cost time: 0.5305466651916504
Epoch: 31, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.565 Vali Acc: 0.241 Test Loss: 3.565 Test Acc: 0.241
Validation loss decreased (-0.237612 --> -0.241141).  Saving model ...
Epoch: 32 cost time: 0.526155948638916
Epoch: 32, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.596 Vali Acc: 0.247 Test Loss: 3.596 Test Acc: 0.247
Validation loss decreased (-0.241141 --> -0.247023).  Saving model ...
Epoch: 33 cost time: 0.5349276065826416
Epoch: 33, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.629 Vali Acc: 0.245 Test Loss: 3.629 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.481905460357666
Epoch: 34, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.653 Vali Acc: 0.249 Test Loss: 3.653 Test Acc: 0.249
Validation loss decreased (-0.247023 --> -0.249375).  Saving model ...
Epoch: 35 cost time: 0.49224114418029785
Epoch: 35, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.686 Vali Acc: 0.245 Test Loss: 3.686 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5189993381500244
Epoch: 36, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.707 Vali Acc: 0.246 Test Loss: 3.707 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5002131462097168
Epoch: 37, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.729 Vali Acc: 0.246 Test Loss: 3.729 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5450539588928223
Epoch: 38, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.774 Vali Acc: 0.246 Test Loss: 3.774 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5379621982574463
Epoch: 39, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.796 Vali Acc: 0.240 Test Loss: 3.796 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5152995586395264
Epoch: 40, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.828 Vali Acc: 0.249 Test Loss: 3.828 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5258195400238037
Epoch: 41, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.859 Vali Acc: 0.252 Test Loss: 3.859 Test Acc: 0.252
Validation loss decreased (-0.249375 --> -0.251726).  Saving model ...
Epoch: 42 cost time: 0.5348687171936035
Epoch: 42, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.889 Vali Acc: 0.246 Test Loss: 3.889 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5268409252166748
Epoch: 43, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.902 Vali Acc: 0.246 Test Loss: 3.902 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5368990898132324
Epoch: 44, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.917 Vali Acc: 0.247 Test Loss: 3.917 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.565288782119751
Epoch: 45, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.914 Vali Acc: 0.242 Test Loss: 3.914 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5229759216308594
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.930 Vali Acc: 0.246 Test Loss: 3.930 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5183191299438477
Epoch: 47, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.950 Vali Acc: 0.254 Test Loss: 3.950 Test Acc: 0.254
Validation loss decreased (-0.251726 --> -0.254078).  Saving model ...
Epoch: 48 cost time: 0.48769569396972656
Epoch: 48, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.974 Vali Acc: 0.252 Test Loss: 3.974 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5329387187957764
Epoch: 49, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.994 Vali Acc: 0.252 Test Loss: 3.994 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5246789455413818
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.002 Vali Acc: 0.252 Test Loss: 4.002 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5097479820251465
Epoch: 51, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.012 Vali Acc: 0.249 Test Loss: 4.012 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.544837236404419
Epoch: 52, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.020 Vali Acc: 0.252 Test Loss: 4.020 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5333652496337891
Epoch: 53, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.038 Vali Acc: 0.251 Test Loss: 4.038 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.5758695602416992
Epoch: 54, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.067 Vali Acc: 0.253 Test Loss: 4.067 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5203731060028076
Epoch: 55, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.086 Vali Acc: 0.252 Test Loss: 4.086 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.4958019256591797
Epoch: 56, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.099 Vali Acc: 0.251 Test Loss: 4.099 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.5434722900390625
Epoch: 57, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.111 Vali Acc: 0.253 Test Loss: 4.111 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 47866
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5834834575653076
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.361 Vali Acc: 0.040 Test Loss: 3.361 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.49583983421325684
Epoch: 2, Steps: 10 | Train Loss: 3.407 Vali Loss: 3.359 Vali Acc: 0.036 Test Loss: 3.359 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5386977195739746
Epoch: 3, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.352 Vali Acc: 0.041 Test Loss: 3.352 Test Acc: 0.041
Validation loss decreased (-0.039966 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.4918801784515381
Epoch: 4, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.339 Vali Acc: 0.045 Test Loss: 3.339 Test Acc: 0.045
Validation loss decreased (-0.041143 --> -0.044672).  Saving model ...
Epoch: 5 cost time: 0.5126817226409912
Epoch: 5, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.328 Vali Acc: 0.059 Test Loss: 3.328 Test Acc: 0.059
Validation loss decreased (-0.044672 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 0.5490667819976807
Epoch: 6, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.317 Vali Acc: 0.064 Test Loss: 3.317 Test Acc: 0.064
Validation loss decreased (-0.058790 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 0.5482885837554932
Epoch: 7, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.309 Vali Acc: 0.078 Test Loss: 3.309 Test Acc: 0.078
Validation loss decreased (-0.063496 --> -0.077614).  Saving model ...
Epoch: 8 cost time: 0.5423824787139893
Epoch: 8, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.304 Vali Acc: 0.089 Test Loss: 3.304 Test Acc: 0.089
Validation loss decreased (-0.077614 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 0.5063626766204834
Epoch: 9, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.300 Vali Acc: 0.100 Test Loss: 3.300 Test Acc: 0.100
Validation loss decreased (-0.089379 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 0.5153055191040039
Epoch: 10, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.294 Vali Acc: 0.104 Test Loss: 3.294 Test Acc: 0.104
Validation loss decreased (-0.099967 --> -0.103496).  Saving model ...
Epoch: 11 cost time: 0.5390429496765137
Epoch: 11, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.293 Vali Acc: 0.109 Test Loss: 3.293 Test Acc: 0.109
Validation loss decreased (-0.103496 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 0.5248427391052246
Epoch: 12, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.291 Vali Acc: 0.115 Test Loss: 3.291 Test Acc: 0.115
Validation loss decreased (-0.109379 --> -0.115261).  Saving model ...
Epoch: 13 cost time: 0.5235626697540283
Epoch: 13, Steps: 10 | Train Loss: 2.329 Vali Loss: 3.285 Vali Acc: 0.118 Test Loss: 3.285 Test Acc: 0.118
Validation loss decreased (-0.115261 --> -0.117614).  Saving model ...
Epoch: 14 cost time: 0.4775247573852539
Epoch: 14, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.284 Vali Acc: 0.118 Test Loss: 3.284 Test Acc: 0.118
Validation loss decreased (-0.117614 --> -0.117614).  Saving model ...
Epoch: 15 cost time: 0.512087345123291
Epoch: 15, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.285 Vali Acc: 0.124 Test Loss: 3.285 Test Acc: 0.124
Validation loss decreased (-0.117614 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 0.5026106834411621
Epoch: 16, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.286 Vali Acc: 0.129 Test Loss: 3.286 Test Acc: 0.129
Validation loss decreased (-0.123497 --> -0.129379).  Saving model ...
Epoch: 17 cost time: 0.5272841453552246
Epoch: 17, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.288 Vali Acc: 0.145 Test Loss: 3.288 Test Acc: 0.145
Validation loss decreased (-0.129379 --> -0.144673).  Saving model ...
Epoch: 18 cost time: 0.5356824398040771
Epoch: 18, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.296 Vali Acc: 0.152 Test Loss: 3.296 Test Acc: 0.152
Validation loss decreased (-0.144673 --> -0.151732).  Saving model ...
Epoch: 19 cost time: 0.528778076171875
Epoch: 19, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.310 Vali Acc: 0.156 Test Loss: 3.310 Test Acc: 0.156
Validation loss decreased (-0.151732 --> -0.156437).  Saving model ...
Epoch: 20 cost time: 0.5193500518798828
Epoch: 20, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.315 Vali Acc: 0.162 Test Loss: 3.315 Test Acc: 0.162
Validation loss decreased (-0.156437 --> -0.162320).  Saving model ...
Epoch: 21 cost time: 0.5050599575042725
Epoch: 21, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.318 Vali Acc: 0.164 Test Loss: 3.318 Test Acc: 0.164
Validation loss decreased (-0.162320 --> -0.163496).  Saving model ...
Epoch: 22 cost time: 0.5140666961669922
Epoch: 22, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.326 Vali Acc: 0.175 Test Loss: 3.326 Test Acc: 0.175
Validation loss decreased (-0.163496 --> -0.175261).  Saving model ...
Epoch: 23 cost time: 0.5386769771575928
Epoch: 23, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.334 Vali Acc: 0.182 Test Loss: 3.334 Test Acc: 0.182
Validation loss decreased (-0.175261 --> -0.182320).  Saving model ...
Epoch: 24 cost time: 0.5155420303344727
Epoch: 24, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.356 Vali Acc: 0.180 Test Loss: 3.356 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.47767210006713867
Epoch: 25, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.375 Vali Acc: 0.182 Test Loss: 3.375 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.544856071472168
Epoch: 26, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.389 Vali Acc: 0.193 Test Loss: 3.389 Test Acc: 0.193
Validation loss decreased (-0.182320 --> -0.192907).  Saving model ...
Epoch: 27 cost time: 0.5351316928863525
Epoch: 27, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.408 Vali Acc: 0.199 Test Loss: 3.408 Test Acc: 0.199
Validation loss decreased (-0.192907 --> -0.198789).  Saving model ...
Epoch: 28 cost time: 0.5222153663635254
Epoch: 28, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.419 Vali Acc: 0.205 Test Loss: 3.419 Test Acc: 0.205
Validation loss decreased (-0.198789 --> -0.204672).  Saving model ...
Epoch: 29 cost time: 0.5267882347106934
Epoch: 29, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.436 Vali Acc: 0.205 Test Loss: 3.436 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5262539386749268
Epoch: 30, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.468 Vali Acc: 0.202 Test Loss: 3.468 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5183031558990479
Epoch: 31, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.492 Vali Acc: 0.205 Test Loss: 3.492 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5049605369567871
Epoch: 32, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.509 Vali Acc: 0.208 Test Loss: 3.509 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208200).  Saving model ...
Epoch: 33 cost time: 0.5317316055297852
Epoch: 33, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.544 Vali Acc: 0.212 Test Loss: 3.544 Test Acc: 0.212
Validation loss decreased (-0.208200 --> -0.211729).  Saving model ...
Epoch: 34 cost time: 0.4994986057281494
Epoch: 34, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.577 Vali Acc: 0.218 Test Loss: 3.577 Test Acc: 0.218
Validation loss decreased (-0.211729 --> -0.217611).  Saving model ...
Epoch: 35 cost time: 0.5217363834381104
Epoch: 35, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.607 Vali Acc: 0.216 Test Loss: 3.607 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5193994045257568
Epoch: 36, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.640 Vali Acc: 0.220 Test Loss: 3.640 Test Acc: 0.220
Validation loss decreased (-0.217611 --> -0.219964).  Saving model ...
Epoch: 37 cost time: 0.5072276592254639
Epoch: 37, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.669 Vali Acc: 0.226 Test Loss: 3.669 Test Acc: 0.226
Validation loss decreased (-0.219964 --> -0.225846).  Saving model ...
Epoch: 38 cost time: 0.5330207347869873
Epoch: 38, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.688 Vali Acc: 0.228 Test Loss: 3.688 Test Acc: 0.228
Validation loss decreased (-0.225846 --> -0.228198).  Saving model ...
Epoch: 39 cost time: 0.5342442989349365
Epoch: 39, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.714 Vali Acc: 0.229 Test Loss: 3.714 Test Acc: 0.229
Validation loss decreased (-0.228198 --> -0.229375).  Saving model ...
Epoch: 40 cost time: 0.5301434993743896
Epoch: 40, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.722 Vali Acc: 0.229 Test Loss: 3.722 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5238475799560547
Epoch: 41, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.752 Vali Acc: 0.231 Test Loss: 3.752 Test Acc: 0.231
Validation loss decreased (-0.229375 --> -0.230551).  Saving model ...
Epoch: 42 cost time: 0.5042300224304199
Epoch: 42, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.779 Vali Acc: 0.227 Test Loss: 3.779 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5255205631256104
Epoch: 43, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.817 Vali Acc: 0.231 Test Loss: 3.817 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5318539142608643
Epoch: 44, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.845 Vali Acc: 0.231 Test Loss: 3.845 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5217084884643555
Epoch: 45, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.858 Vali Acc: 0.236 Test Loss: 3.858 Test Acc: 0.236
Validation loss decreased (-0.230551 --> -0.236432).  Saving model ...
Epoch: 46 cost time: 0.5123603343963623
Epoch: 46, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.878 Vali Acc: 0.238 Test Loss: 3.878 Test Acc: 0.238
Validation loss decreased (-0.236432 --> -0.237608).  Saving model ...
Epoch: 47 cost time: 0.5462794303894043
Epoch: 47, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.893 Vali Acc: 0.229 Test Loss: 3.893 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5592484474182129
Epoch: 48, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.912 Vali Acc: 0.235 Test Loss: 3.912 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5464904308319092
Epoch: 49, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.949 Vali Acc: 0.236 Test Loss: 3.949 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5046396255493164
Epoch: 50, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.974 Vali Acc: 0.233 Test Loss: 3.974 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5569181442260742
Epoch: 51, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.978 Vali Acc: 0.231 Test Loss: 3.978 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5548543930053711
Epoch: 52, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.000 Vali Acc: 0.234 Test Loss: 4.000 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.4997849464416504
Epoch: 53, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.040 Vali Acc: 0.229 Test Loss: 4.040 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5235416889190674
Epoch: 54, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.045 Vali Acc: 0.235 Test Loss: 4.045 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5219516754150391
Epoch: 55, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.052 Vali Acc: 0.238 Test Loss: 4.052 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5502722263336182
Epoch: 56, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.074 Vali Acc: 0.239 Test Loss: 4.074 Test Acc: 0.239
Validation loss decreased (-0.237608 --> -0.238783).  Saving model ...
Epoch: 57 cost time: 0.5015819072723389
Epoch: 57, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.085 Vali Acc: 0.241 Test Loss: 4.085 Test Acc: 0.241
Validation loss decreased (-0.238783 --> -0.241136).  Saving model ...
Epoch: 58 cost time: 0.5170745849609375
Epoch: 58, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.102 Vali Acc: 0.244 Test Loss: 4.102 Test Acc: 0.244
Validation loss decreased (-0.241136 --> -0.243488).  Saving model ...
Epoch: 59 cost time: 0.5325067043304443
Epoch: 59, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.111 Vali Acc: 0.248 Test Loss: 4.111 Test Acc: 0.248
Validation loss decreased (-0.243488 --> -0.248194).  Saving model ...
Epoch: 60 cost time: 0.561978816986084
Epoch: 60, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.122 Vali Acc: 0.240 Test Loss: 4.122 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5159437656402588
Epoch: 61, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.157 Vali Acc: 0.246 Test Loss: 4.157 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5390887260437012
Epoch: 62, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.160 Vali Acc: 0.247 Test Loss: 4.160 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5440902709960938
Epoch: 63, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.164 Vali Acc: 0.244 Test Loss: 4.164 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5265326499938965
Epoch: 64, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.167 Vali Acc: 0.248 Test Loss: 4.167 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5172827243804932
Epoch: 65, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.191 Vali Acc: 0.247 Test Loss: 4.191 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5111615657806396
Epoch: 66, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.209 Vali Acc: 0.247 Test Loss: 4.209 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5362300872802734
Epoch: 67, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.238 Vali Acc: 0.253 Test Loss: 4.238 Test Acc: 0.253
Validation loss decreased (-0.248194 --> -0.252899).  Saving model ...
Epoch: 68 cost time: 0.5439887046813965
Epoch: 68, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.254 Vali Acc: 0.249 Test Loss: 4.254 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5013637542724609
Epoch: 69, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.249 Vali Acc: 0.251 Test Loss: 4.249 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5878250598907471
Epoch: 70, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.266 Vali Acc: 0.247 Test Loss: 4.266 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5304665565490723
Epoch: 71, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.284 Vali Acc: 0.252 Test Loss: 4.284 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5025036334991455
Epoch: 72, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.296 Vali Acc: 0.248 Test Loss: 4.296 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5388290882110596
Epoch: 73, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.289 Vali Acc: 0.253 Test Loss: 4.289 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.506098747253418
Epoch: 74, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.297 Vali Acc: 0.254 Test Loss: 4.297 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254075).  Saving model ...
Epoch: 75 cost time: 0.5115180015563965
Epoch: 75, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.301 Vali Acc: 0.255 Test Loss: 4.301 Test Acc: 0.255
Validation loss decreased (-0.254075 --> -0.255251).  Saving model ...
Epoch: 76 cost time: 0.5318334102630615
Epoch: 76, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.310 Vali Acc: 0.256 Test Loss: 4.310 Test Acc: 0.256
Validation loss decreased (-0.255251 --> -0.256427).  Saving model ...
Epoch: 77 cost time: 0.5318200588226318
Epoch: 77, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.319 Vali Acc: 0.256 Test Loss: 4.319 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.517296314239502
Epoch: 78, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.340 Vali Acc: 0.254 Test Loss: 4.340 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.4975414276123047
Epoch: 79, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.353 Vali Acc: 0.256 Test Loss: 4.353 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.5408241748809814
Epoch: 80, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.376 Vali Acc: 0.258 Test Loss: 4.376 Test Acc: 0.258
Validation loss decreased (-0.256427 --> -0.257603).  Saving model ...
Epoch: 81 cost time: 0.5378279685974121
Epoch: 81, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.387 Vali Acc: 0.261 Test Loss: 4.387 Test Acc: 0.261
Validation loss decreased (-0.257603 --> -0.261133).  Saving model ...
Epoch: 82 cost time: 0.49002552032470703
Epoch: 82, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.400 Vali Acc: 0.259 Test Loss: 4.400 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5183942317962646
Epoch: 83, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.413 Vali Acc: 0.258 Test Loss: 4.413 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.525200366973877
Epoch: 84, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.421 Vali Acc: 0.256 Test Loss: 4.421 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.5379772186279297
Epoch: 85, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.420 Vali Acc: 0.260 Test Loss: 4.420 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.5455303192138672
Epoch: 86, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.422 Vali Acc: 0.261 Test Loss: 4.422 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.5182569026947021
Epoch: 87, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.428 Vali Acc: 0.262 Test Loss: 4.428 Test Acc: 0.262
Validation loss decreased (-0.261133 --> -0.262309).  Saving model ...
Epoch: 88 cost time: 0.5115375518798828
Epoch: 88, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.433 Vali Acc: 0.256 Test Loss: 4.433 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.501807689666748
Epoch: 89, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.454 Vali Acc: 0.255 Test Loss: 4.454 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.48896121978759766
Epoch: 90, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.461 Vali Acc: 0.259 Test Loss: 4.461 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.49900221824645996
Epoch: 91, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.491 Vali Acc: 0.264 Test Loss: 4.491 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263485).  Saving model ...
Epoch: 92 cost time: 0.5175566673278809
Epoch: 92, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.498 Vali Acc: 0.265 Test Loss: 4.498 Test Acc: 0.265
Validation loss decreased (-0.263485 --> -0.264661).  Saving model ...
Epoch: 93 cost time: 0.5193235874176025
Epoch: 93, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.459 Vali Acc: 0.265 Test Loss: 4.459 Test Acc: 0.265
Validation loss decreased (-0.264661 --> -0.264661).  Saving model ...
Epoch: 94 cost time: 0.5161023139953613
Epoch: 94, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.476 Vali Acc: 0.262 Test Loss: 4.476 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5174961090087891
Epoch: 95, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.497 Vali Acc: 0.260 Test Loss: 4.497 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5506117343902588
Epoch: 96, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.508 Vali Acc: 0.259 Test Loss: 4.508 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.41158533096313477
Epoch: 97, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.506 Vali Acc: 0.261 Test Loss: 4.506 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.5237264633178711
Epoch: 98, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.510 Vali Acc: 0.260 Test Loss: 4.510 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.533867359161377
Epoch: 99, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.523 Vali Acc: 0.256 Test Loss: 4.523 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.6052701473236084
Epoch: 100, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.532 Vali Acc: 0.260 Test Loss: 4.532 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 40634
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6724982261657715
Epoch: 1, Steps: 10 | Train Loss: 3.519 Vali Loss: 3.382 Vali Acc: 0.042 Test Loss: 3.382 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.5202481746673584
Epoch: 2, Steps: 10 | Train Loss: 3.471 Vali Loss: 3.378 Vali Acc: 0.046 Test Loss: 3.378 Test Acc: 0.046
Validation loss decreased (-0.042319 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5400974750518799
Epoch: 3, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.368 Vali Acc: 0.048 Test Loss: 3.368 Test Acc: 0.048
Validation loss decreased (-0.045849 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.529496431350708
Epoch: 4, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.352 Vali Acc: 0.056 Test Loss: 3.352 Test Acc: 0.056
Validation loss decreased (-0.048202 --> -0.056437).  Saving model ...
Epoch: 5 cost time: 0.5355677604675293
Epoch: 5, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.337 Vali Acc: 0.054 Test Loss: 3.337 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5213437080383301
Epoch: 6, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.324 Vali Acc: 0.066 Test Loss: 3.324 Test Acc: 0.066
Validation loss decreased (-0.056437 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.5142059326171875
Epoch: 7, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.313 Vali Acc: 0.079 Test Loss: 3.313 Test Acc: 0.079
Validation loss decreased (-0.065849 --> -0.078790).  Saving model ...
Epoch: 8 cost time: 0.6000924110412598
Epoch: 8, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.306 Vali Acc: 0.084 Test Loss: 3.306 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083496).  Saving model ...
Epoch: 9 cost time: 0.5448486804962158
Epoch: 9, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.299 Vali Acc: 0.092 Test Loss: 3.299 Test Acc: 0.092
Validation loss decreased (-0.083496 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 0.48407459259033203
Epoch: 10, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.291 Vali Acc: 0.098 Test Loss: 3.291 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 11 cost time: 0.5473930835723877
Epoch: 11, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.280 Vali Acc: 0.111 Test Loss: 3.280 Test Acc: 0.111
Validation loss decreased (-0.097614 --> -0.110555).  Saving model ...
Epoch: 12 cost time: 0.5173461437225342
Epoch: 12, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.278 Vali Acc: 0.113 Test Loss: 3.278 Test Acc: 0.113
Validation loss decreased (-0.110555 --> -0.112908).  Saving model ...
Epoch: 13 cost time: 0.5127146244049072
Epoch: 13, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.274 Vali Acc: 0.118 Test Loss: 3.274 Test Acc: 0.118
Validation loss decreased (-0.112908 --> -0.117614).  Saving model ...
Epoch: 14 cost time: 0.5220143795013428
Epoch: 14, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.272 Vali Acc: 0.122 Test Loss: 3.272 Test Acc: 0.122
Validation loss decreased (-0.117614 --> -0.122320).  Saving model ...
Epoch: 15 cost time: 0.5099296569824219
Epoch: 15, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.269 Vali Acc: 0.125 Test Loss: 3.269 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 16 cost time: 0.5866086483001709
Epoch: 16, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.265 Vali Acc: 0.132 Test Loss: 3.265 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 17 cost time: 0.5240921974182129
Epoch: 17, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.264 Vali Acc: 0.140 Test Loss: 3.264 Test Acc: 0.140
Validation loss decreased (-0.131732 --> -0.139967).  Saving model ...
Epoch: 18 cost time: 0.5440576076507568
Epoch: 18, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.264 Vali Acc: 0.147 Test Loss: 3.264 Test Acc: 0.147
Validation loss decreased (-0.139967 --> -0.147026).  Saving model ...
Epoch: 19 cost time: 0.532235860824585
Epoch: 19, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.266 Vali Acc: 0.160 Test Loss: 3.266 Test Acc: 0.160
Validation loss decreased (-0.147026 --> -0.159967).  Saving model ...
Epoch: 20 cost time: 0.5267884731292725
Epoch: 20, Steps: 10 | Train Loss: 1.780 Vali Loss: 3.268 Vali Acc: 0.167 Test Loss: 3.268 Test Acc: 0.167
Validation loss decreased (-0.159967 --> -0.167026).  Saving model ...
Epoch: 21 cost time: 0.5120117664337158
Epoch: 21, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.278 Vali Acc: 0.169 Test Loss: 3.278 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 22 cost time: 0.5618431568145752
Epoch: 22, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.281 Vali Acc: 0.167 Test Loss: 3.281 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5366919040679932
Epoch: 23, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.286 Vali Acc: 0.173 Test Loss: 3.286 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 24 cost time: 0.5043139457702637
Epoch: 24, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.291 Vali Acc: 0.179 Test Loss: 3.291 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178791).  Saving model ...
Epoch: 25 cost time: 0.6021504402160645
Epoch: 25, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.299 Vali Acc: 0.182 Test Loss: 3.299 Test Acc: 0.182
Validation loss decreased (-0.178791 --> -0.182320).  Saving model ...
Epoch: 26 cost time: 0.5216586589813232
Epoch: 26, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.312 Vali Acc: 0.195 Test Loss: 3.312 Test Acc: 0.195
Validation loss decreased (-0.182320 --> -0.195261).  Saving model ...
Epoch: 27 cost time: 0.5415256023406982
Epoch: 27, Steps: 10 | Train Loss: 1.123 Vali Loss: 3.320 Vali Acc: 0.196 Test Loss: 3.320 Test Acc: 0.196
Validation loss decreased (-0.195261 --> -0.196437).  Saving model ...
Epoch: 28 cost time: 0.5424931049346924
Epoch: 28, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.332 Vali Acc: 0.196 Test Loss: 3.332 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5610747337341309
Epoch: 29, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.357 Vali Acc: 0.202 Test Loss: 3.357 Test Acc: 0.202
Validation loss decreased (-0.196437 --> -0.202319).  Saving model ...
Epoch: 30 cost time: 0.5509629249572754
Epoch: 30, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.368 Vali Acc: 0.204 Test Loss: 3.368 Test Acc: 0.204
Validation loss decreased (-0.202319 --> -0.203496).  Saving model ...
Epoch: 31 cost time: 0.549586296081543
Epoch: 31, Steps: 10 | Train Loss: 0.842 Vali Loss: 3.381 Vali Acc: 0.213 Test Loss: 3.381 Test Acc: 0.213
Validation loss decreased (-0.203496 --> -0.212907).  Saving model ...
Epoch: 32 cost time: 0.5632431507110596
Epoch: 32, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.405 Vali Acc: 0.213 Test Loss: 3.405 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5349290370941162
Epoch: 33, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.423 Vali Acc: 0.222 Test Loss: 3.423 Test Acc: 0.222
Validation loss decreased (-0.212907 --> -0.222319).  Saving model ...
Epoch: 34 cost time: 0.5353765487670898
Epoch: 34, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.442 Vali Acc: 0.231 Test Loss: 3.442 Test Acc: 0.231
Validation loss decreased (-0.222319 --> -0.230554).  Saving model ...
Epoch: 35 cost time: 0.5444469451904297
Epoch: 35, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.461 Vali Acc: 0.238 Test Loss: 3.461 Test Acc: 0.238
Validation loss decreased (-0.230554 --> -0.237612).  Saving model ...
Epoch: 36 cost time: 0.5435287952423096
Epoch: 36, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.487 Vali Acc: 0.238 Test Loss: 3.487 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5606968402862549
Epoch: 37, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.517 Vali Acc: 0.238 Test Loss: 3.517 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5292353630065918
Epoch: 38, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.553 Vali Acc: 0.238 Test Loss: 3.553 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5609869956970215
Epoch: 39, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.576 Vali Acc: 0.244 Test Loss: 3.576 Test Acc: 0.244
Validation loss decreased (-0.237612 --> -0.243494).  Saving model ...
Epoch: 40 cost time: 0.5417048931121826
Epoch: 40, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.588 Vali Acc: 0.248 Test Loss: 3.588 Test Acc: 0.248
Validation loss decreased (-0.243494 --> -0.248199).  Saving model ...
Epoch: 41 cost time: 0.5559442043304443
Epoch: 41, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.599 Vali Acc: 0.249 Test Loss: 3.599 Test Acc: 0.249
Validation loss decreased (-0.248199 --> -0.249376).  Saving model ...
Epoch: 42 cost time: 0.5554406642913818
Epoch: 42, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.603 Vali Acc: 0.253 Test Loss: 3.603 Test Acc: 0.253
Validation loss decreased (-0.249376 --> -0.252905).  Saving model ...
Epoch: 43 cost time: 0.5401957035064697
Epoch: 43, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.628 Vali Acc: 0.252 Test Loss: 3.628 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5912363529205322
Epoch: 44, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.654 Vali Acc: 0.252 Test Loss: 3.654 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5467376708984375
Epoch: 45, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.681 Vali Acc: 0.258 Test Loss: 3.681 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257610).  Saving model ...
Epoch: 46 cost time: 0.5138645172119141
Epoch: 46, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.697 Vali Acc: 0.260 Test Loss: 3.697 Test Acc: 0.260
Validation loss decreased (-0.257610 --> -0.259963).  Saving model ...
Epoch: 47 cost time: 0.5280311107635498
Epoch: 47, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.722 Vali Acc: 0.260 Test Loss: 3.722 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5394687652587891
Epoch: 48, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.738 Vali Acc: 0.260 Test Loss: 3.738 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5361981391906738
Epoch: 49, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.758 Vali Acc: 0.262 Test Loss: 3.758 Test Acc: 0.262
Validation loss decreased (-0.259963 --> -0.262315).  Saving model ...
Epoch: 50 cost time: 0.554100513458252
Epoch: 50, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.763 Vali Acc: 0.254 Test Loss: 3.763 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5547642707824707
Epoch: 51, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.762 Vali Acc: 0.261 Test Loss: 3.762 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5356626510620117
Epoch: 52, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.767 Vali Acc: 0.268 Test Loss: 3.767 Test Acc: 0.268
Validation loss decreased (-0.262315 --> -0.268198).  Saving model ...
Epoch: 53 cost time: 0.5417394638061523
Epoch: 53, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.780 Vali Acc: 0.269 Test Loss: 3.780 Test Acc: 0.269
Validation loss decreased (-0.268198 --> -0.269374).  Saving model ...
Epoch: 54 cost time: 0.5282437801361084
Epoch: 54, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.808 Vali Acc: 0.265 Test Loss: 3.808 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5402226448059082
Epoch: 55, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.858 Vali Acc: 0.268 Test Loss: 3.858 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5371437072753906
Epoch: 56, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.874 Vali Acc: 0.269 Test Loss: 3.874 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.45510101318359375
Epoch: 57, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.880 Vali Acc: 0.267 Test Loss: 3.880 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.5450356006622314
Epoch: 58, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.871 Vali Acc: 0.265 Test Loss: 3.871 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5463287830352783
Epoch: 59, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.878 Vali Acc: 0.264 Test Loss: 3.878 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5208399295806885
Epoch: 60, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.889 Vali Acc: 0.269 Test Loss: 3.889 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5235166549682617
Epoch: 61, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.914 Vali Acc: 0.266 Test Loss: 3.914 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.5366959571838379
Epoch: 62, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.928 Vali Acc: 0.271 Test Loss: 3.928 Test Acc: 0.271
Validation loss decreased (-0.269374 --> -0.270549).  Saving model ...
Epoch: 63 cost time: 0.5552103519439697
Epoch: 63, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.935 Vali Acc: 0.271 Test Loss: 3.935 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5346403121948242
Epoch: 64, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.951 Vali Acc: 0.273 Test Loss: 3.951 Test Acc: 0.273
Validation loss decreased (-0.270549 --> -0.272902).  Saving model ...
Epoch: 65 cost time: 0.5371942520141602
Epoch: 65, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.962 Vali Acc: 0.276 Test Loss: 3.962 Test Acc: 0.276
Validation loss decreased (-0.272902 --> -0.276431).  Saving model ...
Epoch: 66 cost time: 0.5224409103393555
Epoch: 66, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.980 Vali Acc: 0.278 Test Loss: 3.980 Test Acc: 0.278
Validation loss decreased (-0.276431 --> -0.277607).  Saving model ...
Epoch: 67 cost time: 0.5403671264648438
Epoch: 67, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.991 Vali Acc: 0.278 Test Loss: 3.991 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.500739574432373
Epoch: 68, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.992 Vali Acc: 0.272 Test Loss: 3.992 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5153250694274902
Epoch: 69, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.002 Vali Acc: 0.276 Test Loss: 4.002 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5531954765319824
Epoch: 70, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.018 Vali Acc: 0.282 Test Loss: 4.018 Test Acc: 0.282
Validation loss decreased (-0.277607 --> -0.282313).  Saving model ...
Epoch: 71 cost time: 0.5487370491027832
Epoch: 71, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.018 Vali Acc: 0.285 Test Loss: 4.018 Test Acc: 0.285
Validation loss decreased (-0.282313 --> -0.284666).  Saving model ...
Epoch: 72 cost time: 0.5605654716491699
Epoch: 72, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.028 Vali Acc: 0.280 Test Loss: 4.028 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.516669511795044
Epoch: 73, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.043 Vali Acc: 0.275 Test Loss: 4.043 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5283432006835938
Epoch: 74, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.053 Vali Acc: 0.278 Test Loss: 4.053 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5680596828460693
Epoch: 75, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.052 Vali Acc: 0.284 Test Loss: 4.052 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.545569658279419
Epoch: 76, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.054 Vali Acc: 0.280 Test Loss: 4.054 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.5120382308959961
Epoch: 77, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.055 Vali Acc: 0.282 Test Loss: 4.055 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5151143074035645
Epoch: 78, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.066 Vali Acc: 0.286 Test Loss: 4.066 Test Acc: 0.286
Validation loss decreased (-0.284666 --> -0.285842).  Saving model ...
Epoch: 79 cost time: 0.530092716217041
Epoch: 79, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.088 Vali Acc: 0.281 Test Loss: 4.088 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5487210750579834
Epoch: 80, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.103 Vali Acc: 0.284 Test Loss: 4.103 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.531625509262085
Epoch: 81, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.101 Vali Acc: 0.282 Test Loss: 4.101 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.5019848346710205
Epoch: 82, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.116 Vali Acc: 0.284 Test Loss: 4.116 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.5750987529754639
Epoch: 83, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.132 Vali Acc: 0.282 Test Loss: 4.132 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.5318036079406738
Epoch: 84, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.135 Vali Acc: 0.280 Test Loss: 4.135 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.49797987937927246
Epoch: 85, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.152 Vali Acc: 0.279 Test Loss: 4.152 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.5456321239471436
Epoch: 86, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.161 Vali Acc: 0.285 Test Loss: 4.161 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.5732147693634033
Epoch: 87, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.156 Vali Acc: 0.282 Test Loss: 4.156 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.5574133396148682
Epoch: 88, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.158 Vali Acc: 0.280 Test Loss: 4.158 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm32_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 38362
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6377065181732178
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.417 Vali Acc: 0.046 Test Loss: 3.417 Test Acc: 0.046
Validation loss decreased (inf --> -0.045848).  Saving model ...
Epoch: 2 cost time: 0.5309896469116211
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.336 Vali Acc: 0.045 Test Loss: 3.336 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5331737995147705
Epoch: 3, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.342 Vali Acc: 0.072 Test Loss: 3.342 Test Acc: 0.072
Validation loss decreased (-0.045848 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.5652344226837158
Epoch: 4, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.340 Vali Acc: 0.088 Test Loss: 3.340 Test Acc: 0.088
Validation loss decreased (-0.071731 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 0.553661584854126
Epoch: 5, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.286 Vali Acc: 0.104 Test Loss: 3.286 Test Acc: 0.104
Validation loss decreased (-0.088202 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.5173146724700928
Epoch: 6, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.252 Vali Acc: 0.107 Test Loss: 3.252 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 7 cost time: 0.6150431632995605
Epoch: 7, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.218 Vali Acc: 0.132 Test Loss: 3.218 Test Acc: 0.132
Validation loss decreased (-0.107026 --> -0.131733).  Saving model ...
Epoch: 8 cost time: 0.5272252559661865
Epoch: 8, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.224 Vali Acc: 0.152 Test Loss: 3.224 Test Acc: 0.152
Validation loss decreased (-0.131733 --> -0.151732).  Saving model ...
Epoch: 9 cost time: 0.5466132164001465
Epoch: 9, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.207 Vali Acc: 0.160 Test Loss: 3.207 Test Acc: 0.160
Validation loss decreased (-0.151732 --> -0.159968).  Saving model ...
Epoch: 10 cost time: 0.5677433013916016
Epoch: 10, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.214 Vali Acc: 0.167 Test Loss: 3.214 Test Acc: 0.167
Validation loss decreased (-0.159968 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.5558092594146729
Epoch: 11, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.241 Vali Acc: 0.194 Test Loss: 3.241 Test Acc: 0.194
Validation loss decreased (-0.167027 --> -0.194085).  Saving model ...
Epoch: 12 cost time: 0.5420615673065186
Epoch: 12, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.276 Vali Acc: 0.205 Test Loss: 3.276 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204673).  Saving model ...
Epoch: 13 cost time: 0.5409882068634033
Epoch: 13, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.280 Vali Acc: 0.211 Test Loss: 3.280 Test Acc: 0.211
Validation loss decreased (-0.204673 --> -0.210555).  Saving model ...
Epoch: 14 cost time: 0.5379965305328369
Epoch: 14, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.344 Vali Acc: 0.214 Test Loss: 3.344 Test Acc: 0.214
Validation loss decreased (-0.210555 --> -0.214084).  Saving model ...
Epoch: 15 cost time: 0.5233581066131592
Epoch: 15, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.424 Vali Acc: 0.225 Test Loss: 3.424 Test Acc: 0.225
Validation loss decreased (-0.214084 --> -0.224672).  Saving model ...
Epoch: 16 cost time: 0.5510179996490479
Epoch: 16, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.440 Vali Acc: 0.239 Test Loss: 3.440 Test Acc: 0.239
Validation loss decreased (-0.224672 --> -0.238789).  Saving model ...
Epoch: 17 cost time: 0.5712711811065674
Epoch: 17, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.539 Vali Acc: 0.247 Test Loss: 3.539 Test Acc: 0.247
Validation loss decreased (-0.238789 --> -0.247023).  Saving model ...
Epoch: 18 cost time: 0.5220773220062256
Epoch: 18, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.565 Vali Acc: 0.247 Test Loss: 3.565 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5847551822662354
Epoch: 19, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.635 Vali Acc: 0.235 Test Loss: 3.635 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5311470031738281
Epoch: 20, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.766 Vali Acc: 0.246 Test Loss: 3.766 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.546438455581665
Epoch: 21, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.788 Vali Acc: 0.252 Test Loss: 3.788 Test Acc: 0.252
Validation loss decreased (-0.247023 --> -0.251727).  Saving model ...
Epoch: 22 cost time: 0.5216994285583496
Epoch: 22, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.816 Vali Acc: 0.259 Test Loss: 3.816 Test Acc: 0.259
Validation loss decreased (-0.251727 --> -0.258785).  Saving model ...
Epoch: 23 cost time: 0.5390079021453857
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.866 Vali Acc: 0.262 Test Loss: 3.866 Test Acc: 0.262
Validation loss decreased (-0.258785 --> -0.262314).  Saving model ...
Epoch: 24 cost time: 0.5755634307861328
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.916 Vali Acc: 0.262 Test Loss: 3.916 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5415549278259277
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.976 Vali Acc: 0.265 Test Loss: 3.976 Test Acc: 0.265
Validation loss decreased (-0.262314 --> -0.264666).  Saving model ...
Epoch: 26 cost time: 0.55600905418396
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.018 Vali Acc: 0.264 Test Loss: 4.018 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5251429080963135
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.043 Vali Acc: 0.252 Test Loss: 4.043 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.560905933380127
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.084 Vali Acc: 0.259 Test Loss: 4.084 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5574374198913574
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.103 Vali Acc: 0.260 Test Loss: 4.103 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5707552433013916
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.109 Vali Acc: 0.256 Test Loss: 4.109 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5200068950653076
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.120 Vali Acc: 0.262 Test Loss: 4.120 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5651664733886719
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.142 Vali Acc: 0.262 Test Loss: 4.142 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5173156261444092
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.157 Vali Acc: 0.266 Test Loss: 4.157 Test Acc: 0.266
Validation loss decreased (-0.264666 --> -0.265841).  Saving model ...
Epoch: 34 cost time: 0.5459940433502197
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.195 Vali Acc: 0.268 Test Loss: 4.195 Test Acc: 0.268
Validation loss decreased (-0.265841 --> -0.268193).  Saving model ...
Epoch: 35 cost time: 0.5557243824005127
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.202 Vali Acc: 0.269 Test Loss: 4.202 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269370).  Saving model ...
Epoch: 36 cost time: 0.5486910343170166
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.224 Vali Acc: 0.271 Test Loss: 4.224 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270546).  Saving model ...
Epoch: 37 cost time: 0.5612952709197998
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.243 Vali Acc: 0.273 Test Loss: 4.243 Test Acc: 0.273
Validation loss decreased (-0.270546 --> -0.272899).  Saving model ...
Epoch: 38 cost time: 0.5681655406951904
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.263 Vali Acc: 0.269 Test Loss: 4.263 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5706596374511719
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.281 Vali Acc: 0.273 Test Loss: 4.281 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.505389928817749
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.283 Vali Acc: 0.273 Test Loss: 4.283 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5104856491088867
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.298 Vali Acc: 0.271 Test Loss: 4.298 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5757460594177246
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.325 Vali Acc: 0.269 Test Loss: 4.325 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5728459358215332
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.347 Vali Acc: 0.268 Test Loss: 4.347 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5808906555175781
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.361 Vali Acc: 0.267 Test Loss: 4.361 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5599887371063232
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.372 Vali Acc: 0.267 Test Loss: 4.372 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5677118301391602
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.374 Vali Acc: 0.271 Test Loss: 4.374 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.540212869644165
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.393 Vali Acc: 0.269 Test Loss: 4.393 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 114202
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6693971157073975
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.391 Vali Acc: 0.039 Test Loss: 3.391 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.507655143737793
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.354 Vali Acc: 0.048 Test Loss: 3.354 Test Acc: 0.048
Validation loss decreased (-0.038790 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.5348043441772461
Epoch: 3, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.346 Vali Acc: 0.066 Test Loss: 3.346 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065849).  Saving model ...
Epoch: 4 cost time: 0.538231611251831
Epoch: 4, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.345 Vali Acc: 0.079 Test Loss: 3.345 Test Acc: 0.079
Validation loss decreased (-0.065849 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 0.5245754718780518
Epoch: 5, Steps: 10 | Train Loss: 2.946 Vali Loss: 3.334 Vali Acc: 0.084 Test Loss: 3.334 Test Acc: 0.084
Validation loss decreased (-0.078790 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 0.525306224822998
Epoch: 6, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.326 Vali Acc: 0.094 Test Loss: 3.326 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094084).  Saving model ...
Epoch: 7 cost time: 0.5585980415344238
Epoch: 7, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.297 Vali Acc: 0.107 Test Loss: 3.297 Test Acc: 0.107
Validation loss decreased (-0.094084 --> -0.107026).  Saving model ...
Epoch: 8 cost time: 0.5123100280761719
Epoch: 8, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.285 Vali Acc: 0.115 Test Loss: 3.285 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115261).  Saving model ...
Epoch: 9 cost time: 0.5534393787384033
Epoch: 9, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.276 Vali Acc: 0.132 Test Loss: 3.276 Test Acc: 0.132
Validation loss decreased (-0.115261 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 0.5646946430206299
Epoch: 10, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.268 Vali Acc: 0.148 Test Loss: 3.268 Test Acc: 0.148
Validation loss decreased (-0.131732 --> -0.148203).  Saving model ...
Epoch: 11 cost time: 0.5591473579406738
Epoch: 11, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.243 Vali Acc: 0.154 Test Loss: 3.243 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154085).  Saving model ...
Epoch: 12 cost time: 0.5312628746032715
Epoch: 12, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.233 Vali Acc: 0.160 Test Loss: 3.233 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159968).  Saving model ...
Epoch: 13 cost time: 0.5408391952514648
Epoch: 13, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.244 Vali Acc: 0.191 Test Loss: 3.244 Test Acc: 0.191
Validation loss decreased (-0.159968 --> -0.190556).  Saving model ...
Epoch: 14 cost time: 0.5733339786529541
Epoch: 14, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.256 Vali Acc: 0.193 Test Loss: 3.256 Test Acc: 0.193
Validation loss decreased (-0.190556 --> -0.192909).  Saving model ...
Epoch: 15 cost time: 0.5387966632843018
Epoch: 15, Steps: 10 | Train Loss: 1.498 Vali Loss: 3.275 Vali Acc: 0.201 Test Loss: 3.275 Test Acc: 0.201
Validation loss decreased (-0.192909 --> -0.201144).  Saving model ...
Epoch: 16 cost time: 0.45780158042907715
Epoch: 16, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.276 Vali Acc: 0.204 Test Loss: 3.276 Test Acc: 0.204
Validation loss decreased (-0.201144 --> -0.203497).  Saving model ...
Epoch: 17 cost time: 0.5511271953582764
Epoch: 17, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.305 Vali Acc: 0.207 Test Loss: 3.305 Test Acc: 0.207
Validation loss decreased (-0.203497 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 0.5778405666351318
Epoch: 18, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.340 Vali Acc: 0.214 Test Loss: 3.340 Test Acc: 0.214
Validation loss decreased (-0.207026 --> -0.214084).  Saving model ...
Epoch: 19 cost time: 0.5172655582427979
Epoch: 19, Steps: 10 | Train Loss: 0.940 Vali Loss: 3.372 Vali Acc: 0.215 Test Loss: 3.372 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215260).  Saving model ...
Epoch: 20 cost time: 0.506446361541748
Epoch: 20, Steps: 10 | Train Loss: 0.779 Vali Loss: 3.397 Vali Acc: 0.218 Test Loss: 3.397 Test Acc: 0.218
Validation loss decreased (-0.215260 --> -0.217613).  Saving model ...
Epoch: 21 cost time: 0.5229926109313965
Epoch: 21, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.446 Vali Acc: 0.228 Test Loss: 3.446 Test Acc: 0.228
Validation loss decreased (-0.217613 --> -0.228201).  Saving model ...
Epoch: 22 cost time: 0.5652177333831787
Epoch: 22, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.474 Vali Acc: 0.231 Test Loss: 3.474 Test Acc: 0.231
Validation loss decreased (-0.228201 --> -0.230553).  Saving model ...
Epoch: 23 cost time: 0.5550973415374756
Epoch: 23, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.527 Vali Acc: 0.241 Test Loss: 3.527 Test Acc: 0.241
Validation loss decreased (-0.230553 --> -0.241141).  Saving model ...
Epoch: 24 cost time: 0.5737214088439941
Epoch: 24, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.579 Vali Acc: 0.240 Test Loss: 3.579 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5496244430541992
Epoch: 25, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.592 Vali Acc: 0.239 Test Loss: 3.592 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5399563312530518
Epoch: 26, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.628 Vali Acc: 0.247 Test Loss: 3.628 Test Acc: 0.247
Validation loss decreased (-0.241141 --> -0.247023).  Saving model ...
Epoch: 27 cost time: 0.5299906730651855
Epoch: 27, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.713 Vali Acc: 0.246 Test Loss: 3.713 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5394454002380371
Epoch: 28, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.782 Vali Acc: 0.240 Test Loss: 3.782 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5511643886566162
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.793 Vali Acc: 0.249 Test Loss: 3.793 Test Acc: 0.249
Validation loss decreased (-0.247023 --> -0.249374).  Saving model ...
Epoch: 30 cost time: 0.560662031173706
Epoch: 30, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.791 Vali Acc: 0.251 Test Loss: 3.791 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250550).  Saving model ...
Epoch: 31 cost time: 0.5508239269256592
Epoch: 31, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.825 Vali Acc: 0.252 Test Loss: 3.825 Test Acc: 0.252
Validation loss decreased (-0.250550 --> -0.251726).  Saving model ...
Epoch: 32 cost time: 0.5538668632507324
Epoch: 32, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.891 Vali Acc: 0.248 Test Loss: 3.891 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5444600582122803
Epoch: 33, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.936 Vali Acc: 0.249 Test Loss: 3.936 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5152692794799805
Epoch: 34, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.969 Vali Acc: 0.249 Test Loss: 3.969 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5572013854980469
Epoch: 35, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.979 Vali Acc: 0.249 Test Loss: 3.979 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5613408088684082
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.005 Vali Acc: 0.251 Test Loss: 4.005 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5272927284240723
Epoch: 37, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.032 Vali Acc: 0.248 Test Loss: 4.032 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5499768257141113
Epoch: 38, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.040 Vali Acc: 0.253 Test Loss: 4.040 Test Acc: 0.253
Validation loss decreased (-0.251726 --> -0.252901).  Saving model ...
Epoch: 39 cost time: 0.5475001335144043
Epoch: 39, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.090 Vali Acc: 0.249 Test Loss: 4.090 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.542302131652832
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.091 Vali Acc: 0.253 Test Loss: 4.091 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5419440269470215
Epoch: 41, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.116 Vali Acc: 0.252 Test Loss: 4.116 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5486888885498047
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.148 Vali Acc: 0.256 Test Loss: 4.148 Test Acc: 0.256
Validation loss decreased (-0.252901 --> -0.256429).  Saving model ...
Epoch: 43 cost time: 0.5343623161315918
Epoch: 43, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.180 Vali Acc: 0.252 Test Loss: 4.180 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5230717658996582
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.183 Vali Acc: 0.255 Test Loss: 4.183 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5131051540374756
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.195 Vali Acc: 0.251 Test Loss: 4.195 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5539803504943848
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.232 Vali Acc: 0.253 Test Loss: 4.232 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5754690170288086
Epoch: 47, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.257 Vali Acc: 0.254 Test Loss: 4.257 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5415315628051758
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.263 Vali Acc: 0.258 Test Loss: 4.263 Test Acc: 0.258
Validation loss decreased (-0.256429 --> -0.257604).  Saving model ...
Epoch: 49 cost time: 0.5485260486602783
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.296 Vali Acc: 0.255 Test Loss: 4.296 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5520927906036377
Epoch: 50, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.309 Vali Acc: 0.254 Test Loss: 4.309 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5657503604888916
Epoch: 51, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.333 Vali Acc: 0.252 Test Loss: 4.333 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.546849250793457
Epoch: 52, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.354 Vali Acc: 0.251 Test Loss: 4.354 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5529630184173584
Epoch: 53, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.374 Vali Acc: 0.255 Test Loss: 4.374 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5448310375213623
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.398 Vali Acc: 0.260 Test Loss: 4.398 Test Acc: 0.260
Validation loss decreased (-0.257604 --> -0.259956).  Saving model ...
Epoch: 55 cost time: 0.5805020332336426
Epoch: 55, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.407 Vali Acc: 0.261 Test Loss: 4.407 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 56 cost time: 0.5103678703308105
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.424 Vali Acc: 0.262 Test Loss: 4.424 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262309).  Saving model ...
Epoch: 57 cost time: 0.5846266746520996
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.422 Vali Acc: 0.259 Test Loss: 4.422 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5580849647521973
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.444 Vali Acc: 0.260 Test Loss: 4.444 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.562856912612915
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.471 Vali Acc: 0.261 Test Loss: 4.471 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5081961154937744
Epoch: 60, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.481 Vali Acc: 0.256 Test Loss: 4.481 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.543097734451294
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.493 Vali Acc: 0.260 Test Loss: 4.493 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5886528491973877
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.480 Vali Acc: 0.261 Test Loss: 4.480 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5643699169158936
Epoch: 63, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.495 Vali Acc: 0.266 Test Loss: 4.495 Test Acc: 0.266
Validation loss decreased (-0.262309 --> -0.265837).  Saving model ...
Epoch: 64 cost time: 0.5317180156707764
Epoch: 64, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.515 Vali Acc: 0.262 Test Loss: 4.515 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5639429092407227
Epoch: 65, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.533 Vali Acc: 0.260 Test Loss: 4.533 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.5363388061523438
Epoch: 66, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.547 Vali Acc: 0.262 Test Loss: 4.547 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5381083488464355
Epoch: 67, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.528 Vali Acc: 0.265 Test Loss: 4.528 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5504240989685059
Epoch: 68, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.532 Vali Acc: 0.265 Test Loss: 4.532 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.5343201160430908
Epoch: 69, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.570 Vali Acc: 0.264 Test Loss: 4.570 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5513112545013428
Epoch: 70, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.606 Vali Acc: 0.258 Test Loss: 4.606 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.5498764514923096
Epoch: 71, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.623 Vali Acc: 0.258 Test Loss: 4.623 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.5134990215301514
Epoch: 72, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.614 Vali Acc: 0.258 Test Loss: 4.614 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.5402369499206543
Epoch: 73, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.599 Vali Acc: 0.265 Test Loss: 4.599 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 66842
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4500527381896973
Epoch: 1, Steps: 10 | Train Loss: 3.395 Vali Loss: 3.380 Vali Acc: 0.046 Test Loss: 3.380 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.5280444622039795
Epoch: 2, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.353 Vali Acc: 0.056 Test Loss: 3.353 Test Acc: 0.056
Validation loss decreased (-0.045849 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.5321354866027832
Epoch: 3, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.336 Vali Acc: 0.058 Test Loss: 3.336 Test Acc: 0.058
Validation loss decreased (-0.056437 --> -0.057614).  Saving model ...
Epoch: 4 cost time: 0.5035979747772217
Epoch: 4, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.330 Vali Acc: 0.059 Test Loss: 3.330 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.5126702785491943
Epoch: 5, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.324 Vali Acc: 0.059 Test Loss: 3.324 Test Acc: 0.059
Validation loss decreased (-0.058790 --> -0.058790).  Saving model ...
Epoch: 6 cost time: 0.522799015045166
Epoch: 6, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.320 Vali Acc: 0.067 Test Loss: 3.320 Test Acc: 0.067
Validation loss decreased (-0.058790 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.48774194717407227
Epoch: 7, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.312 Vali Acc: 0.072 Test Loss: 3.312 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 8 cost time: 0.5351221561431885
Epoch: 8, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.305 Vali Acc: 0.085 Test Loss: 3.305 Test Acc: 0.085
Validation loss decreased (-0.071732 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 0.5344576835632324
Epoch: 9, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.287 Vali Acc: 0.099 Test Loss: 3.287 Test Acc: 0.099
Validation loss decreased (-0.084673 --> -0.098791).  Saving model ...
Epoch: 10 cost time: 0.5491011142730713
Epoch: 10, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.276 Vali Acc: 0.108 Test Loss: 3.276 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.5562281608581543
Epoch: 11, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.262 Vali Acc: 0.106 Test Loss: 3.262 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5072627067565918
Epoch: 12, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.250 Vali Acc: 0.122 Test Loss: 3.250 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122320).  Saving model ...
Epoch: 13 cost time: 0.6002533435821533
Epoch: 13, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.247 Vali Acc: 0.131 Test Loss: 3.247 Test Acc: 0.131
Validation loss decreased (-0.122320 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 0.6044127941131592
Epoch: 14, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.239 Vali Acc: 0.129 Test Loss: 3.239 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.506441593170166
Epoch: 15, Steps: 10 | Train Loss: 1.835 Vali Loss: 3.238 Vali Acc: 0.145 Test Loss: 3.238 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144673).  Saving model ...
Epoch: 16 cost time: 0.5492160320281982
Epoch: 16, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.245 Vali Acc: 0.153 Test Loss: 3.245 Test Acc: 0.153
Validation loss decreased (-0.144673 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.5519962310791016
Epoch: 17, Steps: 10 | Train Loss: 1.628 Vali Loss: 3.241 Vali Acc: 0.171 Test Loss: 3.241 Test Acc: 0.171
Validation loss decreased (-0.152909 --> -0.170556).  Saving model ...
Epoch: 18 cost time: 0.5288829803466797
Epoch: 18, Steps: 10 | Train Loss: 1.520 Vali Loss: 3.253 Vali Acc: 0.174 Test Loss: 3.253 Test Acc: 0.174
Validation loss decreased (-0.170556 --> -0.174085).  Saving model ...
Epoch: 19 cost time: 0.5456950664520264
Epoch: 19, Steps: 10 | Train Loss: 1.384 Vali Loss: 3.274 Vali Acc: 0.186 Test Loss: 3.274 Test Acc: 0.186
Validation loss decreased (-0.174085 --> -0.185850).  Saving model ...
Epoch: 20 cost time: 0.58302903175354
Epoch: 20, Steps: 10 | Train Loss: 1.279 Vali Loss: 3.265 Vali Acc: 0.198 Test Loss: 3.265 Test Acc: 0.198
Validation loss decreased (-0.185850 --> -0.197614).  Saving model ...
Epoch: 21 cost time: 0.5756003856658936
Epoch: 21, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.283 Vali Acc: 0.208 Test Loss: 3.283 Test Acc: 0.208
Validation loss decreased (-0.197614 --> -0.208202).  Saving model ...
Epoch: 22 cost time: 0.5320329666137695
Epoch: 22, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.295 Vali Acc: 0.216 Test Loss: 3.295 Test Acc: 0.216
Validation loss decreased (-0.208202 --> -0.216438).  Saving model ...
Epoch: 23 cost time: 0.5125951766967773
Epoch: 23, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.328 Vali Acc: 0.218 Test Loss: 3.328 Test Acc: 0.218
Validation loss decreased (-0.216438 --> -0.217614).  Saving model ...
Epoch: 24 cost time: 0.5407652854919434
Epoch: 24, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.344 Vali Acc: 0.221 Test Loss: 3.344 Test Acc: 0.221
Validation loss decreased (-0.217614 --> -0.221143).  Saving model ...
Epoch: 25 cost time: 0.5501255989074707
Epoch: 25, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.360 Vali Acc: 0.222 Test Loss: 3.360 Test Acc: 0.222
Validation loss decreased (-0.221143 --> -0.222319).  Saving model ...
Epoch: 26 cost time: 0.5556364059448242
Epoch: 26, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.394 Vali Acc: 0.221 Test Loss: 3.394 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5652463436126709
Epoch: 27, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.406 Vali Acc: 0.222 Test Loss: 3.406 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5813078880310059
Epoch: 28, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.452 Vali Acc: 0.226 Test Loss: 3.452 Test Acc: 0.226
Validation loss decreased (-0.222319 --> -0.225848).  Saving model ...
Epoch: 29 cost time: 0.5204267501831055
Epoch: 29, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.479 Vali Acc: 0.226 Test Loss: 3.479 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5605874061584473
Epoch: 30, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.489 Vali Acc: 0.235 Test Loss: 3.489 Test Acc: 0.235
Validation loss decreased (-0.225848 --> -0.235259).  Saving model ...
Epoch: 31 cost time: 0.6053445339202881
Epoch: 31, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.504 Vali Acc: 0.235 Test Loss: 3.504 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5783481597900391
Epoch: 32, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.589 Vali Acc: 0.232 Test Loss: 3.589 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.543104887008667
Epoch: 33, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.619 Vali Acc: 0.236 Test Loss: 3.619 Test Acc: 0.236
Validation loss decreased (-0.235259 --> -0.236434).  Saving model ...
Epoch: 34 cost time: 0.5340156555175781
Epoch: 34, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.647 Vali Acc: 0.247 Test Loss: 3.647 Test Acc: 0.247
Validation loss decreased (-0.236434 --> -0.247022).  Saving model ...
Epoch: 35 cost time: 0.5784893035888672
Epoch: 35, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.643 Vali Acc: 0.248 Test Loss: 3.643 Test Acc: 0.248
Validation loss decreased (-0.247022 --> -0.248199).  Saving model ...
Epoch: 36 cost time: 0.5615954399108887
Epoch: 36, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.651 Vali Acc: 0.244 Test Loss: 3.651 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5555682182312012
Epoch: 37, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.684 Vali Acc: 0.240 Test Loss: 3.684 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5481712818145752
Epoch: 38, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.724 Vali Acc: 0.236 Test Loss: 3.724 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5784587860107422
Epoch: 39, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.775 Vali Acc: 0.239 Test Loss: 3.775 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5287632942199707
Epoch: 40, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.752 Vali Acc: 0.241 Test Loss: 3.752 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5346040725708008
Epoch: 41, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.776 Vali Acc: 0.246 Test Loss: 3.776 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5632603168487549
Epoch: 42, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.794 Vali Acc: 0.241 Test Loss: 3.794 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5977127552032471
Epoch: 43, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.808 Vali Acc: 0.242 Test Loss: 3.808 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5782256126403809
Epoch: 44, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.856 Vali Acc: 0.247 Test Loss: 3.856 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5925450325012207
Epoch: 45, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.862 Vali Acc: 0.245 Test Loss: 3.862 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 50682
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6075515747070312
Epoch: 1, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.285 Vali Acc: 0.053 Test Loss: 3.285 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.5334146022796631
Epoch: 2, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.289 Vali Acc: 0.056 Test Loss: 3.289 Test Acc: 0.056
Validation loss decreased (-0.052908 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.5127112865447998
Epoch: 3, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.287 Vali Acc: 0.055 Test Loss: 3.287 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5323781967163086
Epoch: 4, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.284 Vali Acc: 0.056 Test Loss: 3.284 Test Acc: 0.056
Validation loss decreased (-0.056438 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.48905205726623535
Epoch: 5, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.283 Vali Acc: 0.067 Test Loss: 3.283 Test Acc: 0.067
Validation loss decreased (-0.056438 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.5357873439788818
Epoch: 6, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.281 Vali Acc: 0.066 Test Loss: 3.281 Test Acc: 0.066
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.47471046447753906
Epoch: 7, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.276 Vali Acc: 0.068 Test Loss: 3.276 Test Acc: 0.068
Validation loss decreased (-0.067026 --> -0.068203).  Saving model ...
Epoch: 8 cost time: 0.5341804027557373
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.269 Vali Acc: 0.080 Test Loss: 3.269 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079967).  Saving model ...
Epoch: 9 cost time: 0.5526165962219238
Epoch: 9, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 0.5164034366607666
Epoch: 10, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.248 Vali Acc: 0.096 Test Loss: 3.248 Test Acc: 0.096
Validation loss decreased (-0.090556 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.5092160701751709
Epoch: 11, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.239 Vali Acc: 0.099 Test Loss: 3.239 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 0.5390520095825195
Epoch: 12, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.236 Vali Acc: 0.107 Test Loss: 3.236 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.5378527641296387
Epoch: 13, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.230 Vali Acc: 0.113 Test Loss: 3.230 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 0.5145664215087891
Epoch: 14, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.223 Vali Acc: 0.121 Test Loss: 3.223 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121144).  Saving model ...
Epoch: 15 cost time: 0.515455961227417
Epoch: 15, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.206 Vali Acc: 0.139 Test Loss: 3.206 Test Acc: 0.139
Validation loss decreased (-0.121144 --> -0.138791).  Saving model ...
Epoch: 16 cost time: 0.515587329864502
Epoch: 16, Steps: 10 | Train Loss: 2.102 Vali Loss: 3.204 Vali Acc: 0.146 Test Loss: 3.204 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145850).  Saving model ...
Epoch: 17 cost time: 0.5710196495056152
Epoch: 17, Steps: 10 | Train Loss: 1.901 Vali Loss: 3.211 Vali Acc: 0.148 Test Loss: 3.211 Test Acc: 0.148
Validation loss decreased (-0.145850 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.5180070400238037
Epoch: 18, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.219 Vali Acc: 0.149 Test Loss: 3.219 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149380).  Saving model ...
Epoch: 19 cost time: 0.5232725143432617
Epoch: 19, Steps: 10 | Train Loss: 1.698 Vali Loss: 3.219 Vali Acc: 0.161 Test Loss: 3.219 Test Acc: 0.161
Validation loss decreased (-0.149380 --> -0.161144).  Saving model ...
Epoch: 20 cost time: 0.510514497756958
Epoch: 20, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.228 Vali Acc: 0.168 Test Loss: 3.228 Test Acc: 0.168
Validation loss decreased (-0.161144 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 0.5641031265258789
Epoch: 21, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.234 Vali Acc: 0.176 Test Loss: 3.234 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 22 cost time: 0.4930412769317627
Epoch: 22, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.246 Vali Acc: 0.182 Test Loss: 3.246 Test Acc: 0.182
Validation loss decreased (-0.176438 --> -0.182320).  Saving model ...
Epoch: 23 cost time: 0.5463159084320068
Epoch: 23, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.262 Vali Acc: 0.192 Test Loss: 3.262 Test Acc: 0.192
Validation loss decreased (-0.182320 --> -0.191732).  Saving model ...
Epoch: 24 cost time: 0.5758469104766846
Epoch: 24, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.268 Vali Acc: 0.202 Test Loss: 3.268 Test Acc: 0.202
Validation loss decreased (-0.191732 --> -0.202320).  Saving model ...
Epoch: 25 cost time: 0.5240073204040527
Epoch: 25, Steps: 10 | Train Loss: 1.110 Vali Loss: 3.282 Vali Acc: 0.206 Test Loss: 3.282 Test Acc: 0.206
Validation loss decreased (-0.202320 --> -0.205850).  Saving model ...
Epoch: 26 cost time: 0.5096254348754883
Epoch: 26, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.291 Vali Acc: 0.206 Test Loss: 3.291 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5199999809265137
Epoch: 27, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.305 Vali Acc: 0.215 Test Loss: 3.305 Test Acc: 0.215
Validation loss decreased (-0.205850 --> -0.215261).  Saving model ...
Epoch: 28 cost time: 0.5627350807189941
Epoch: 28, Steps: 10 | Train Loss: 0.886 Vali Loss: 3.334 Vali Acc: 0.228 Test Loss: 3.334 Test Acc: 0.228
Validation loss decreased (-0.215261 --> -0.228202).  Saving model ...
Epoch: 29 cost time: 0.4860105514526367
Epoch: 29, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.368 Vali Acc: 0.229 Test Loss: 3.368 Test Acc: 0.229
Validation loss decreased (-0.228202 --> -0.229378).  Saving model ...
Epoch: 30 cost time: 0.5180344581604004
Epoch: 30, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.384 Vali Acc: 0.231 Test Loss: 3.384 Test Acc: 0.231
Validation loss decreased (-0.229378 --> -0.230554).  Saving model ...
Epoch: 31 cost time: 0.4862220287322998
Epoch: 31, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.390 Vali Acc: 0.240 Test Loss: 3.390 Test Acc: 0.240
Validation loss decreased (-0.230554 --> -0.239966).  Saving model ...
Epoch: 32 cost time: 0.4896571636199951
Epoch: 32, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.413 Vali Acc: 0.242 Test Loss: 3.413 Test Acc: 0.242
Validation loss decreased (-0.239966 --> -0.242319).  Saving model ...
Epoch: 33 cost time: 0.5174727439880371
Epoch: 33, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.438 Vali Acc: 0.239 Test Loss: 3.438 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.489107608795166
Epoch: 34, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.448 Vali Acc: 0.248 Test Loss: 3.448 Test Acc: 0.248
Validation loss decreased (-0.242319 --> -0.248201).  Saving model ...
Epoch: 35 cost time: 0.532116174697876
Epoch: 35, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.484 Vali Acc: 0.247 Test Loss: 3.484 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49735331535339355
Epoch: 36, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.516 Vali Acc: 0.252 Test Loss: 3.516 Test Acc: 0.252
Validation loss decreased (-0.248201 --> -0.251730).  Saving model ...
Epoch: 37 cost time: 0.4917325973510742
Epoch: 37, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.548 Vali Acc: 0.249 Test Loss: 3.548 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5287678241729736
Epoch: 38, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.552 Vali Acc: 0.256 Test Loss: 3.552 Test Acc: 0.256
Validation loss decreased (-0.251730 --> -0.256435).  Saving model ...
Epoch: 39 cost time: 0.4951021671295166
Epoch: 39, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.566 Vali Acc: 0.261 Test Loss: 3.566 Test Acc: 0.261
Validation loss decreased (-0.256435 --> -0.261141).  Saving model ...
Epoch: 40 cost time: 0.5540025234222412
Epoch: 40, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.585 Vali Acc: 0.261 Test Loss: 3.585 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5140969753265381
Epoch: 41, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.631 Vali Acc: 0.262 Test Loss: 3.631 Test Acc: 0.262
Validation loss decreased (-0.261141 --> -0.262317).  Saving model ...
Epoch: 42 cost time: 0.5026423931121826
Epoch: 42, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.664 Vali Acc: 0.262 Test Loss: 3.664 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.48086977005004883
Epoch: 43, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.662 Vali Acc: 0.259 Test Loss: 3.662 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5117318630218506
Epoch: 44, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.676 Vali Acc: 0.266 Test Loss: 3.676 Test Acc: 0.266
Validation loss decreased (-0.262317 --> -0.265846).  Saving model ...
Epoch: 45 cost time: 0.5639734268188477
Epoch: 45, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.698 Vali Acc: 0.255 Test Loss: 3.698 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.515620231628418
Epoch: 46, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.720 Vali Acc: 0.266 Test Loss: 3.720 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5082647800445557
Epoch: 47, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.751 Vali Acc: 0.269 Test Loss: 3.751 Test Acc: 0.269
Validation loss decreased (-0.265846 --> -0.269374).  Saving model ...
Epoch: 48 cost time: 0.5910756587982178
Epoch: 48, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.770 Vali Acc: 0.273 Test Loss: 3.770 Test Acc: 0.273
Validation loss decreased (-0.269374 --> -0.272903).  Saving model ...
Epoch: 49 cost time: 0.5972795486450195
Epoch: 49, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.779 Vali Acc: 0.272 Test Loss: 3.779 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5557668209075928
Epoch: 50, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.794 Vali Acc: 0.274 Test Loss: 3.794 Test Acc: 0.274
Validation loss decreased (-0.272903 --> -0.274080).  Saving model ...
Epoch: 51 cost time: 0.5506913661956787
Epoch: 51, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.803 Vali Acc: 0.273 Test Loss: 3.803 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5648138523101807
Epoch: 52, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.838 Vali Acc: 0.276 Test Loss: 3.838 Test Acc: 0.276
Validation loss decreased (-0.274080 --> -0.276432).  Saving model ...
Epoch: 53 cost time: 0.5264720916748047
Epoch: 53, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.841 Vali Acc: 0.276 Test Loss: 3.841 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5912284851074219
Epoch: 54, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.841 Vali Acc: 0.272 Test Loss: 3.841 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5265436172485352
Epoch: 55, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.846 Vali Acc: 0.279 Test Loss: 3.846 Test Acc: 0.279
Validation loss decreased (-0.276432 --> -0.278785).  Saving model ...
Epoch: 56 cost time: 0.41938209533691406
Epoch: 56, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.877 Vali Acc: 0.271 Test Loss: 3.877 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.535686731338501
Epoch: 57, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.875 Vali Acc: 0.268 Test Loss: 3.875 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5198612213134766
Epoch: 58, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.894 Vali Acc: 0.273 Test Loss: 3.894 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5177028179168701
Epoch: 59, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.914 Vali Acc: 0.273 Test Loss: 3.914 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5399048328399658
Epoch: 60, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.925 Vali Acc: 0.274 Test Loss: 3.925 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5175588130950928
Epoch: 61, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.960 Vali Acc: 0.274 Test Loss: 3.960 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6034681797027588
Epoch: 62, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.963 Vali Acc: 0.279 Test Loss: 3.963 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5216307640075684
Epoch: 63, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.976 Vali Acc: 0.275 Test Loss: 3.976 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5538997650146484
Epoch: 64, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.984 Vali Acc: 0.274 Test Loss: 3.984 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5170493125915527
Epoch: 65, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.004 Vali Acc: 0.274 Test Loss: 4.004 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 43258
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.605656623840332
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.341 Vali Acc: 0.040 Test Loss: 3.341 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.5311870574951172
Epoch: 2, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.346 Vali Acc: 0.033 Test Loss: 3.346 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5692157745361328
Epoch: 3, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.346 Vali Acc: 0.029 Test Loss: 3.346 Test Acc: 0.029
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49318861961364746
Epoch: 4, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.340 Vali Acc: 0.042 Test Loss: 3.340 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 0.49286746978759766
Epoch: 5, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.334 Vali Acc: 0.052 Test Loss: 3.334 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 0.510399341583252
Epoch: 6, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.329 Vali Acc: 0.058 Test Loss: 3.329 Test Acc: 0.058
Validation loss decreased (-0.051731 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 0.5384416580200195
Epoch: 7, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.324 Vali Acc: 0.052 Test Loss: 3.324 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5211093425750732
Epoch: 8, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.320 Vali Acc: 0.058 Test Loss: 3.320 Test Acc: 0.058
Validation loss decreased (-0.057614 --> -0.057614).  Saving model ...
Epoch: 9 cost time: 0.5286598205566406
Epoch: 9, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.321 Vali Acc: 0.059 Test Loss: 3.321 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 10 cost time: 0.4999816417694092
Epoch: 10, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.318 Vali Acc: 0.062 Test Loss: 3.318 Test Acc: 0.062
Validation loss decreased (-0.058790 --> -0.062320).  Saving model ...
Epoch: 11 cost time: 0.5118796825408936
Epoch: 11, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.312 Vali Acc: 0.068 Test Loss: 3.312 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 12 cost time: 0.5410346984863281
Epoch: 12, Steps: 10 | Train Loss: 2.716 Vali Loss: 3.303 Vali Acc: 0.073 Test Loss: 3.303 Test Acc: 0.073
Validation loss decreased (-0.068202 --> -0.072908).  Saving model ...
Epoch: 13 cost time: 0.5207674503326416
Epoch: 13, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.297 Vali Acc: 0.080 Test Loss: 3.297 Test Acc: 0.080
Validation loss decreased (-0.072908 --> -0.079967).  Saving model ...
Epoch: 14 cost time: 0.5054275989532471
Epoch: 14, Steps: 10 | Train Loss: 2.603 Vali Loss: 3.287 Vali Acc: 0.089 Test Loss: 3.287 Test Acc: 0.089
Validation loss decreased (-0.079967 --> -0.089379).  Saving model ...
Epoch: 15 cost time: 0.5659492015838623
Epoch: 15, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.277 Vali Acc: 0.096 Test Loss: 3.277 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 16 cost time: 0.5278570652008057
Epoch: 16, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104673).  Saving model ...
Epoch: 17 cost time: 0.5070600509643555
Epoch: 17, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.266 Vali Acc: 0.104 Test Loss: 3.266 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5426526069641113
Epoch: 18, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.262 Vali Acc: 0.112 Test Loss: 3.262 Test Acc: 0.112
Validation loss decreased (-0.104673 --> -0.111732).  Saving model ...
Epoch: 19 cost time: 0.5599887371063232
Epoch: 19, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.252 Vali Acc: 0.121 Test Loss: 3.252 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 20 cost time: 0.5238697528839111
Epoch: 20, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.252 Vali Acc: 0.126 Test Loss: 3.252 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 21 cost time: 0.5526175498962402
Epoch: 21, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.249 Vali Acc: 0.125 Test Loss: 3.249 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5563066005706787
Epoch: 22, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.248 Vali Acc: 0.136 Test Loss: 3.248 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 23 cost time: 0.5284347534179688
Epoch: 23, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.253 Vali Acc: 0.140 Test Loss: 3.253 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139967).  Saving model ...
Epoch: 24 cost time: 0.5826292037963867
Epoch: 24, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.254 Vali Acc: 0.142 Test Loss: 3.254 Test Acc: 0.142
Validation loss decreased (-0.139967 --> -0.142320).  Saving model ...
Epoch: 25 cost time: 0.5472292900085449
Epoch: 25, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.266 Vali Acc: 0.142 Test Loss: 3.266 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5599029064178467
Epoch: 26, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.268 Vali Acc: 0.149 Test Loss: 3.268 Test Acc: 0.149
Validation loss decreased (-0.142320 --> -0.149379).  Saving model ...
Epoch: 27 cost time: 0.5367732048034668
Epoch: 27, Steps: 10 | Train Loss: 1.489 Vali Loss: 3.272 Vali Acc: 0.153 Test Loss: 3.272 Test Acc: 0.153
Validation loss decreased (-0.149379 --> -0.152908).  Saving model ...
Epoch: 28 cost time: 0.5210204124450684
Epoch: 28, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.278 Vali Acc: 0.162 Test Loss: 3.278 Test Acc: 0.162
Validation loss decreased (-0.152908 --> -0.162320).  Saving model ...
Epoch: 29 cost time: 0.5388317108154297
Epoch: 29, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.296 Vali Acc: 0.162 Test Loss: 3.296 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5392894744873047
Epoch: 30, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.312 Vali Acc: 0.164 Test Loss: 3.312 Test Acc: 0.164
Validation loss decreased (-0.162320 --> -0.163496).  Saving model ...
Epoch: 31 cost time: 0.5143251419067383
Epoch: 31, Steps: 10 | Train Loss: 1.139 Vali Loss: 3.325 Vali Acc: 0.167 Test Loss: 3.325 Test Acc: 0.167
Validation loss decreased (-0.163496 --> -0.167026).  Saving model ...
Epoch: 32 cost time: 0.5891940593719482
Epoch: 32, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.336 Vali Acc: 0.166 Test Loss: 3.336 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5624620914459229
Epoch: 33, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.335 Vali Acc: 0.172 Test Loss: 3.335 Test Acc: 0.172
Validation loss decreased (-0.167026 --> -0.171731).  Saving model ...
Epoch: 34 cost time: 0.5262799263000488
Epoch: 34, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.353 Vali Acc: 0.175 Test Loss: 3.353 Test Acc: 0.175
Validation loss decreased (-0.171731 --> -0.175261).  Saving model ...
Epoch: 35 cost time: 0.5622081756591797
Epoch: 35, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.372 Vali Acc: 0.182 Test Loss: 3.372 Test Acc: 0.182
Validation loss decreased (-0.175261 --> -0.182319).  Saving model ...
Epoch: 36 cost time: 0.5323119163513184
Epoch: 36, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.386 Vali Acc: 0.189 Test Loss: 3.386 Test Acc: 0.189
Validation loss decreased (-0.182319 --> -0.189378).  Saving model ...
Epoch: 37 cost time: 0.5375206470489502
Epoch: 37, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.416 Vali Acc: 0.184 Test Loss: 3.416 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.55562424659729
Epoch: 38, Steps: 10 | Train Loss: 0.814 Vali Loss: 3.440 Vali Acc: 0.195 Test Loss: 3.440 Test Acc: 0.195
Validation loss decreased (-0.189378 --> -0.195260).  Saving model ...
Epoch: 39 cost time: 0.5318472385406494
Epoch: 39, Steps: 10 | Train Loss: 0.696 Vali Loss: 3.469 Vali Acc: 0.202 Test Loss: 3.469 Test Acc: 0.202
Validation loss decreased (-0.195260 --> -0.202318).  Saving model ...
Epoch: 40 cost time: 0.5344011783599854
Epoch: 40, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.484 Vali Acc: 0.198 Test Loss: 3.484 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.524846076965332
Epoch: 41, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.493 Vali Acc: 0.194 Test Loss: 3.493 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5900940895080566
Epoch: 42, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.510 Vali Acc: 0.196 Test Loss: 3.510 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5431065559387207
Epoch: 43, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.524 Vali Acc: 0.205 Test Loss: 3.524 Test Acc: 0.205
Validation loss decreased (-0.202318 --> -0.204671).  Saving model ...
Epoch: 44 cost time: 0.5520095825195312
Epoch: 44, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.543 Vali Acc: 0.207 Test Loss: 3.543 Test Acc: 0.207
Validation loss decreased (-0.204671 --> -0.207023).  Saving model ...
Epoch: 45 cost time: 0.5201559066772461
Epoch: 45, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.559 Vali Acc: 0.208 Test Loss: 3.559 Test Acc: 0.208
Validation loss decreased (-0.207023 --> -0.208200).  Saving model ...
Epoch: 46 cost time: 0.5735814571380615
Epoch: 46, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.573 Vali Acc: 0.214 Test Loss: 3.573 Test Acc: 0.214
Validation loss decreased (-0.208200 --> -0.214082).  Saving model ...
Epoch: 47 cost time: 0.5250866413116455
Epoch: 47, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.595 Vali Acc: 0.213 Test Loss: 3.595 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5068566799163818
Epoch: 48, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.615 Vali Acc: 0.215 Test Loss: 3.615 Test Acc: 0.215
Validation loss decreased (-0.214082 --> -0.215258).  Saving model ...
Epoch: 49 cost time: 0.5488519668579102
Epoch: 49, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.647 Vali Acc: 0.216 Test Loss: 3.647 Test Acc: 0.216
Validation loss decreased (-0.215258 --> -0.216434).  Saving model ...
Epoch: 50 cost time: 0.5486035346984863
Epoch: 50, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.652 Vali Acc: 0.221 Test Loss: 3.652 Test Acc: 0.221
Validation loss decreased (-0.216434 --> -0.221140).  Saving model ...
Epoch: 51 cost time: 0.5163102149963379
Epoch: 51, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.663 Vali Acc: 0.224 Test Loss: 3.663 Test Acc: 0.224
Validation loss decreased (-0.221140 --> -0.223493).  Saving model ...
Epoch: 52 cost time: 0.5691723823547363
Epoch: 52, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.678 Vali Acc: 0.220 Test Loss: 3.678 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5414483547210693
Epoch: 53, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.714 Vali Acc: 0.218 Test Loss: 3.714 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5713043212890625
Epoch: 54, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.725 Vali Acc: 0.212 Test Loss: 3.725 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5602302551269531
Epoch: 55, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.728 Vali Acc: 0.214 Test Loss: 3.728 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5476062297821045
Epoch: 56, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.750 Vali Acc: 0.220 Test Loss: 3.750 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5355725288391113
Epoch: 57, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.776 Vali Acc: 0.214 Test Loss: 3.776 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5468714237213135
Epoch: 58, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.803 Vali Acc: 0.215 Test Loss: 3.803 Test Acc: 0.215
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5651822090148926
Epoch: 59, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.806 Vali Acc: 0.222 Test Loss: 3.806 Test Acc: 0.222
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5358657836914062
Epoch: 60, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.819 Vali Acc: 0.227 Test Loss: 3.819 Test Acc: 0.227
Validation loss decreased (-0.223493 --> -0.227021).  Saving model ...
Epoch: 61 cost time: 0.5320327281951904
Epoch: 61, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.837 Vali Acc: 0.224 Test Loss: 3.837 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5549221038818359
Epoch: 62, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.844 Vali Acc: 0.226 Test Loss: 3.844 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.581493616104126
Epoch: 63, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.843 Vali Acc: 0.225 Test Loss: 3.843 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5808639526367188
Epoch: 64, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.851 Vali Acc: 0.226 Test Loss: 3.851 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5738060474395752
Epoch: 65, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.873 Vali Acc: 0.236 Test Loss: 3.873 Test Acc: 0.236
Validation loss decreased (-0.227021 --> -0.236432).  Saving model ...
Epoch: 66 cost time: 0.5456674098968506
Epoch: 66, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.898 Vali Acc: 0.235 Test Loss: 3.898 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5690937042236328
Epoch: 67, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.898 Vali Acc: 0.235 Test Loss: 3.898 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5323367118835449
Epoch: 68, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.929 Vali Acc: 0.235 Test Loss: 3.929 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5551302433013916
Epoch: 69, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.960 Vali Acc: 0.229 Test Loss: 3.960 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5377404689788818
Epoch: 70, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.959 Vali Acc: 0.235 Test Loss: 3.959 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.563753604888916
Epoch: 71, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.975 Vali Acc: 0.229 Test Loss: 3.975 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5296993255615234
Epoch: 72, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.972 Vali Acc: 0.240 Test Loss: 3.972 Test Acc: 0.240
Validation loss decreased (-0.236432 --> -0.239960).  Saving model ...
Epoch: 73 cost time: 0.5485773086547852
Epoch: 73, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.983 Vali Acc: 0.234 Test Loss: 3.983 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5478849411010742
Epoch: 74, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.004 Vali Acc: 0.238 Test Loss: 4.004 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5452587604522705
Epoch: 75, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.013 Vali Acc: 0.235 Test Loss: 4.013 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.5509331226348877
Epoch: 76, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.021 Vali Acc: 0.231 Test Loss: 4.021 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.5669116973876953
Epoch: 77, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.053 Vali Acc: 0.233 Test Loss: 4.053 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5337347984313965
Epoch: 78, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.043 Vali Acc: 0.233 Test Loss: 4.043 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5632336139678955
Epoch: 79, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.043 Vali Acc: 0.238 Test Loss: 4.043 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5216126441955566
Epoch: 80, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.048 Vali Acc: 0.239 Test Loss: 4.048 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.5615956783294678
Epoch: 81, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.073 Vali Acc: 0.241 Test Loss: 4.073 Test Acc: 0.241
Validation loss decreased (-0.239960 --> -0.241136).  Saving model ...
Epoch: 82 cost time: 0.5298407077789307
Epoch: 82, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.091 Vali Acc: 0.240 Test Loss: 4.091 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5617694854736328
Epoch: 83, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.118 Vali Acc: 0.240 Test Loss: 4.118 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.5724942684173584
Epoch: 84, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.117 Vali Acc: 0.240 Test Loss: 4.117 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.4339780807495117
Epoch: 85, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.113 Vali Acc: 0.239 Test Loss: 4.113 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.5452475547790527
Epoch: 86, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.137 Vali Acc: 0.233 Test Loss: 4.137 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.5068912506103516
Epoch: 87, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.154 Vali Acc: 0.233 Test Loss: 4.154 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.5358543395996094
Epoch: 88, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.178 Vali Acc: 0.232 Test Loss: 4.178 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.5293288230895996
Epoch: 89, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.188 Vali Acc: 0.234 Test Loss: 4.188 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.5147225856781006
Epoch: 90, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.208 Vali Acc: 0.227 Test Loss: 4.208 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.5428526401519775
Epoch: 91, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.199 Vali Acc: 0.235 Test Loss: 4.199 Test Acc: 0.235
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 34634
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.489311695098877
Epoch: 1, Steps: 10 | Train Loss: 3.462 Vali Loss: 3.399 Vali Acc: 0.036 Test Loss: 3.399 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.5260586738586426
Epoch: 2, Steps: 10 | Train Loss: 3.456 Vali Loss: 3.393 Vali Acc: 0.040 Test Loss: 3.393 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.5180549621582031
Epoch: 3, Steps: 10 | Train Loss: 3.422 Vali Loss: 3.383 Vali Acc: 0.044 Test Loss: 3.383 Test Acc: 0.044
Validation loss decreased (-0.039966 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 0.48334240913391113
Epoch: 4, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.367 Vali Acc: 0.048 Test Loss: 3.367 Test Acc: 0.048
Validation loss decreased (-0.043496 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.5155417919158936
Epoch: 5, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.352 Vali Acc: 0.052 Test Loss: 3.352 Test Acc: 0.052
Validation loss decreased (-0.048202 --> -0.051731).  Saving model ...
Epoch: 6 cost time: 0.5210361480712891
Epoch: 6, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.339 Vali Acc: 0.048 Test Loss: 3.339 Test Acc: 0.048
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5201840400695801
Epoch: 7, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.330 Vali Acc: 0.060 Test Loss: 3.330 Test Acc: 0.060
Validation loss decreased (-0.051731 --> -0.059967).  Saving model ...
Epoch: 8 cost time: 0.5343897342681885
Epoch: 8, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.324 Vali Acc: 0.065 Test Loss: 3.324 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 9 cost time: 0.5330064296722412
Epoch: 9, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.318 Vali Acc: 0.069 Test Loss: 3.318 Test Acc: 0.069
Validation loss decreased (-0.064673 --> -0.069379).  Saving model ...
Epoch: 10 cost time: 0.5830893516540527
Epoch: 10, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.310 Vali Acc: 0.081 Test Loss: 3.310 Test Acc: 0.081
Validation loss decreased (-0.069379 --> -0.081143).  Saving model ...
Epoch: 11 cost time: 0.5499622821807861
Epoch: 11, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.302 Vali Acc: 0.086 Test Loss: 3.302 Test Acc: 0.086
Validation loss decreased (-0.081143 --> -0.085849).  Saving model ...
Epoch: 12 cost time: 0.5011110305786133
Epoch: 12, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.295 Vali Acc: 0.092 Test Loss: 3.295 Test Acc: 0.092
Validation loss decreased (-0.085849 --> -0.091732).  Saving model ...
Epoch: 13 cost time: 0.5505175590515137
Epoch: 13, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.293 Vali Acc: 0.082 Test Loss: 3.293 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5358116626739502
Epoch: 14, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.291 Vali Acc: 0.086 Test Loss: 3.291 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5113716125488281
Epoch: 15, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.284 Vali Acc: 0.098 Test Loss: 3.284 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 16 cost time: 0.5122907161712646
Epoch: 16, Steps: 10 | Train Loss: 2.525 Vali Loss: 3.282 Vali Acc: 0.098 Test Loss: 3.282 Test Acc: 0.098
Validation loss decreased (-0.097614 --> -0.097614).  Saving model ...
Epoch: 17 cost time: 0.5571086406707764
Epoch: 17, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.282 Vali Acc: 0.102 Test Loss: 3.282 Test Acc: 0.102
Validation loss decreased (-0.097614 --> -0.102320).  Saving model ...
Epoch: 18 cost time: 0.5316917896270752
Epoch: 18, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.273 Vali Acc: 0.108 Test Loss: 3.273 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 19 cost time: 0.5585207939147949
Epoch: 19, Steps: 10 | Train Loss: 2.369 Vali Loss: 3.272 Vali Acc: 0.109 Test Loss: 3.272 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 20 cost time: 0.4821934700012207
Epoch: 20, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.275 Vali Acc: 0.112 Test Loss: 3.275 Test Acc: 0.112
Validation loss decreased (-0.109379 --> -0.111732).  Saving model ...
Epoch: 21 cost time: 0.5390362739562988
Epoch: 21, Steps: 10 | Train Loss: 2.215 Vali Loss: 3.276 Vali Acc: 0.114 Test Loss: 3.276 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 22 cost time: 0.5189507007598877
Epoch: 22, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.279 Vali Acc: 0.120 Test Loss: 3.279 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119967).  Saving model ...
Epoch: 23 cost time: 0.5481245517730713
Epoch: 23, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.289 Vali Acc: 0.127 Test Loss: 3.289 Test Acc: 0.127
Validation loss decreased (-0.119967 --> -0.127026).  Saving model ...
Epoch: 24 cost time: 0.5310330390930176
Epoch: 24, Steps: 10 | Train Loss: 1.966 Vali Loss: 3.283 Vali Acc: 0.127 Test Loss: 3.283 Test Acc: 0.127
Validation loss decreased (-0.127026 --> -0.127026).  Saving model ...
Epoch: 25 cost time: 0.5212674140930176
Epoch: 25, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.283 Vali Acc: 0.132 Test Loss: 3.283 Test Acc: 0.132
Validation loss decreased (-0.127026 --> -0.131732).  Saving model ...
Epoch: 26 cost time: 0.5356206893920898
Epoch: 26, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.282 Vali Acc: 0.132 Test Loss: 3.282 Test Acc: 0.132
Validation loss decreased (-0.131732 --> -0.131732).  Saving model ...
Epoch: 27 cost time: 0.521068811416626
Epoch: 27, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.290 Vali Acc: 0.145 Test Loss: 3.290 Test Acc: 0.145
Validation loss decreased (-0.131732 --> -0.144673).  Saving model ...
Epoch: 28 cost time: 0.5307004451751709
Epoch: 28, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.297 Vali Acc: 0.142 Test Loss: 3.297 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5284254550933838
Epoch: 29, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.305 Vali Acc: 0.159 Test Loss: 3.305 Test Acc: 0.159
Validation loss decreased (-0.144673 --> -0.158790).  Saving model ...
Epoch: 30 cost time: 0.5240364074707031
Epoch: 30, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.312 Vali Acc: 0.156 Test Loss: 3.312 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6271023750305176
Epoch: 31, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.313 Vali Acc: 0.155 Test Loss: 3.313 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5246326923370361
Epoch: 32, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.311 Vali Acc: 0.160 Test Loss: 3.311 Test Acc: 0.160
Validation loss decreased (-0.158790 --> -0.159967).  Saving model ...
Epoch: 33 cost time: 0.517890214920044
Epoch: 33, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.314 Vali Acc: 0.160 Test Loss: 3.314 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5393877029418945
Epoch: 34, Steps: 10 | Train Loss: 1.237 Vali Loss: 3.319 Vali Acc: 0.162 Test Loss: 3.319 Test Acc: 0.162
Validation loss decreased (-0.159967 --> -0.162320).  Saving model ...
Epoch: 35 cost time: 0.5121932029724121
Epoch: 35, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.327 Vali Acc: 0.166 Test Loss: 3.327 Test Acc: 0.166
Validation loss decreased (-0.162320 --> -0.165849).  Saving model ...
Epoch: 36 cost time: 0.5548207759857178
Epoch: 36, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.332 Vali Acc: 0.172 Test Loss: 3.332 Test Acc: 0.172
Validation loss decreased (-0.165849 --> -0.171731).  Saving model ...
Epoch: 37 cost time: 0.6083824634552002
Epoch: 37, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.338 Vali Acc: 0.178 Test Loss: 3.338 Test Acc: 0.178
Validation loss decreased (-0.171731 --> -0.177614).  Saving model ...
Epoch: 38 cost time: 0.520559549331665
Epoch: 38, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.352 Vali Acc: 0.176 Test Loss: 3.352 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5552403926849365
Epoch: 39, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.366 Vali Acc: 0.172 Test Loss: 3.366 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5644664764404297
Epoch: 40, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.388 Vali Acc: 0.178 Test Loss: 3.388 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5324034690856934
Epoch: 41, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.410 Vali Acc: 0.187 Test Loss: 3.410 Test Acc: 0.187
Validation loss decreased (-0.177614 --> -0.187025).  Saving model ...
Epoch: 42 cost time: 0.5120916366577148
Epoch: 42, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.419 Vali Acc: 0.189 Test Loss: 3.419 Test Acc: 0.189
Validation loss decreased (-0.187025 --> -0.189378).  Saving model ...
Epoch: 43 cost time: 0.54660964012146
Epoch: 43, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.414 Vali Acc: 0.192 Test Loss: 3.414 Test Acc: 0.192
Validation loss decreased (-0.189378 --> -0.191731).  Saving model ...
Epoch: 44 cost time: 0.5200836658477783
Epoch: 44, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.424 Vali Acc: 0.195 Test Loss: 3.424 Test Acc: 0.195
Validation loss decreased (-0.191731 --> -0.195260).  Saving model ...
Epoch: 45 cost time: 0.5337908267974854
Epoch: 45, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.428 Vali Acc: 0.193 Test Loss: 3.428 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5280942916870117
Epoch: 46, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.448 Vali Acc: 0.194 Test Loss: 3.448 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.535132884979248
Epoch: 47, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.484 Vali Acc: 0.199 Test Loss: 3.484 Test Acc: 0.199
Validation loss decreased (-0.195260 --> -0.198789).  Saving model ...
Epoch: 48 cost time: 0.513796329498291
Epoch: 48, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.501 Vali Acc: 0.198 Test Loss: 3.501 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5359957218170166
Epoch: 49, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.530 Vali Acc: 0.201 Test Loss: 3.530 Test Acc: 0.201
Validation loss decreased (-0.198789 --> -0.201141).  Saving model ...
Epoch: 50 cost time: 0.5409369468688965
Epoch: 50, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.542 Vali Acc: 0.202 Test Loss: 3.542 Test Acc: 0.202
Validation loss decreased (-0.201141 --> -0.202318).  Saving model ...
Epoch: 51 cost time: 0.5665857791900635
Epoch: 51, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.557 Vali Acc: 0.200 Test Loss: 3.557 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5511081218719482
Epoch: 52, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.566 Vali Acc: 0.195 Test Loss: 3.566 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5573346614837646
Epoch: 53, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.570 Vali Acc: 0.195 Test Loss: 3.570 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5668742656707764
Epoch: 54, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.583 Vali Acc: 0.206 Test Loss: 3.583 Test Acc: 0.206
Validation loss decreased (-0.202318 --> -0.205847).  Saving model ...
Epoch: 55 cost time: 0.5768942832946777
Epoch: 55, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.625 Vali Acc: 0.213 Test Loss: 3.625 Test Acc: 0.213
Validation loss decreased (-0.205847 --> -0.212905).  Saving model ...
Epoch: 56 cost time: 0.5338671207427979
Epoch: 56, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.638 Vali Acc: 0.220 Test Loss: 3.638 Test Acc: 0.220
Validation loss decreased (-0.212905 --> -0.219964).  Saving model ...
Epoch: 57 cost time: 0.5214779376983643
Epoch: 57, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.635 Vali Acc: 0.216 Test Loss: 3.635 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.538062334060669
Epoch: 58, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.639 Vali Acc: 0.216 Test Loss: 3.639 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.517406702041626
Epoch: 59, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.651 Vali Acc: 0.215 Test Loss: 3.651 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5078394412994385
Epoch: 60, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.674 Vali Acc: 0.213 Test Loss: 3.674 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.516294002532959
Epoch: 61, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.718 Vali Acc: 0.209 Test Loss: 3.718 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5089843273162842
Epoch: 62, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.737 Vali Acc: 0.212 Test Loss: 3.737 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5225498676300049
Epoch: 63, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.743 Vali Acc: 0.224 Test Loss: 3.743 Test Acc: 0.224
Validation loss decreased (-0.219964 --> -0.223492).  Saving model ...
Epoch: 64 cost time: 0.5465283393859863
Epoch: 64, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.738 Vali Acc: 0.225 Test Loss: 3.738 Test Acc: 0.225
Validation loss decreased (-0.223492 --> -0.224669).  Saving model ...
Epoch: 65 cost time: 0.518563985824585
Epoch: 65, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.762 Vali Acc: 0.225 Test Loss: 3.762 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5827775001525879
Epoch: 66, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.796 Vali Acc: 0.218 Test Loss: 3.796 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5371992588043213
Epoch: 67, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.807 Vali Acc: 0.222 Test Loss: 3.807 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5489513874053955
Epoch: 68, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.813 Vali Acc: 0.218 Test Loss: 3.813 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.5530679225921631
Epoch: 69, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.820 Vali Acc: 0.222 Test Loss: 3.820 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.5474462509155273
Epoch: 70, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.830 Vali Acc: 0.213 Test Loss: 3.830 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5265657901763916
Epoch: 71, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.851 Vali Acc: 0.226 Test Loss: 3.851 Test Acc: 0.226
Validation loss decreased (-0.224669 --> -0.225844).  Saving model ...
Epoch: 72 cost time: 0.5390834808349609
Epoch: 72, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.873 Vali Acc: 0.219 Test Loss: 3.873 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.4737527370452881
Epoch: 73, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.913 Vali Acc: 0.220 Test Loss: 3.913 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5068047046661377
Epoch: 74, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.904 Vali Acc: 0.220 Test Loss: 3.904 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.47414708137512207
Epoch: 75, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.923 Vali Acc: 0.224 Test Loss: 3.923 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.5437467098236084
Epoch: 76, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.936 Vali Acc: 0.215 Test Loss: 3.936 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.5434801578521729
Epoch: 77, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.950 Vali Acc: 0.220 Test Loss: 3.950 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5258827209472656
Epoch: 78, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.953 Vali Acc: 0.233 Test Loss: 3.953 Test Acc: 0.233
Validation loss decreased (-0.225844 --> -0.232902).  Saving model ...
Epoch: 79 cost time: 0.5444455146789551
Epoch: 79, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.953 Vali Acc: 0.225 Test Loss: 3.953 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5392463207244873
Epoch: 80, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.978 Vali Acc: 0.221 Test Loss: 3.978 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.5717236995697021
Epoch: 81, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.010 Vali Acc: 0.225 Test Loss: 4.010 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.5564577579498291
Epoch: 82, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.031 Vali Acc: 0.228 Test Loss: 4.031 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.5745184421539307
Epoch: 83, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.053 Vali Acc: 0.224 Test Loss: 4.053 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.5340285301208496
Epoch: 84, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.060 Vali Acc: 0.219 Test Loss: 4.060 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.641460657119751
Epoch: 85, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.037 Vali Acc: 0.224 Test Loss: 4.037 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.6030440330505371
Epoch: 86, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.028 Vali Acc: 0.225 Test Loss: 4.028 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.5103123188018799
Epoch: 87, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.066 Vali Acc: 0.231 Test Loss: 4.066 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.5704748630523682
Epoch: 88, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.074 Vali Acc: 0.231 Test Loss: 4.074 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23294117647058823
model parameter : 31018
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5300652980804443
Epoch: 1, Steps: 10 | Train Loss: 3.417 Vali Loss: 3.375 Vali Acc: 0.041 Test Loss: 3.375 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.4721665382385254
Epoch: 2, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.364 Vali Acc: 0.046 Test Loss: 3.364 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5053069591522217
Epoch: 3, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.359 Vali Acc: 0.048 Test Loss: 3.359 Test Acc: 0.048
Validation loss decreased (-0.045849 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.4804396629333496
Epoch: 4, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.353 Vali Acc: 0.049 Test Loss: 3.353 Test Acc: 0.049
Validation loss decreased (-0.048202 --> -0.049378).  Saving model ...
Epoch: 5 cost time: 0.5013132095336914
Epoch: 5, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.344 Vali Acc: 0.054 Test Loss: 3.344 Test Acc: 0.054
Validation loss decreased (-0.049378 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 0.5259249210357666
Epoch: 6, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.334 Vali Acc: 0.058 Test Loss: 3.334 Test Acc: 0.058
Validation loss decreased (-0.054084 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 0.5502068996429443
Epoch: 7, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.324 Vali Acc: 0.064 Test Loss: 3.324 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063496).  Saving model ...
Epoch: 8 cost time: 0.5113983154296875
Epoch: 8, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.315 Vali Acc: 0.061 Test Loss: 3.315 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44571828842163086
Epoch: 9, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.308 Vali Acc: 0.069 Test Loss: 3.308 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069379).  Saving model ...
Epoch: 10 cost time: 0.49959707260131836
Epoch: 10, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.306 Vali Acc: 0.074 Test Loss: 3.306 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074085).  Saving model ...
Epoch: 11 cost time: 0.5855960845947266
Epoch: 11, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.304 Vali Acc: 0.075 Test Loss: 3.304 Test Acc: 0.075
Validation loss decreased (-0.074085 --> -0.075261).  Saving model ...
Epoch: 12 cost time: 0.62890625
Epoch: 12, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.298 Vali Acc: 0.076 Test Loss: 3.298 Test Acc: 0.076
Validation loss decreased (-0.075261 --> -0.076438).  Saving model ...
Epoch: 13 cost time: 0.49915266036987305
Epoch: 13, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.292 Vali Acc: 0.079 Test Loss: 3.292 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 14 cost time: 0.5721676349639893
Epoch: 14, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.289 Vali Acc: 0.084 Test Loss: 3.289 Test Acc: 0.084
Validation loss decreased (-0.078791 --> -0.083497).  Saving model ...
Epoch: 15 cost time: 0.5393383502960205
Epoch: 15, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.281 Vali Acc: 0.088 Test Loss: 3.281 Test Acc: 0.088
Validation loss decreased (-0.083497 --> -0.088202).  Saving model ...
Epoch: 16 cost time: 0.5429420471191406
Epoch: 16, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.280 Vali Acc: 0.093 Test Loss: 3.280 Test Acc: 0.093
Validation loss decreased (-0.088202 --> -0.092908).  Saving model ...
Epoch: 17 cost time: 0.5133175849914551
Epoch: 17, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.274 Vali Acc: 0.095 Test Loss: 3.274 Test Acc: 0.095
Validation loss decreased (-0.092908 --> -0.095261).  Saving model ...
Epoch: 18 cost time: 0.5360360145568848
Epoch: 18, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.272 Vali Acc: 0.100 Test Loss: 3.272 Test Acc: 0.100
Validation loss decreased (-0.095261 --> -0.099967).  Saving model ...
Epoch: 19 cost time: 0.5290460586547852
Epoch: 19, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.267 Vali Acc: 0.104 Test Loss: 3.267 Test Acc: 0.104
Validation loss decreased (-0.099967 --> -0.103497).  Saving model ...
Epoch: 20 cost time: 0.5135464668273926
Epoch: 20, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.263 Vali Acc: 0.107 Test Loss: 3.263 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 21 cost time: 0.5512566566467285
Epoch: 21, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.262 Vali Acc: 0.108 Test Loss: 3.262 Test Acc: 0.108
Validation loss decreased (-0.107026 --> -0.108203).  Saving model ...
Epoch: 22 cost time: 0.5296852588653564
Epoch: 22, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.262 Vali Acc: 0.114 Test Loss: 3.262 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114085).  Saving model ...
Epoch: 23 cost time: 0.5234556198120117
Epoch: 23, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.259 Vali Acc: 0.119 Test Loss: 3.259 Test Acc: 0.119
Validation loss decreased (-0.114085 --> -0.118791).  Saving model ...
Epoch: 24 cost time: 0.5296595096588135
Epoch: 24, Steps: 10 | Train Loss: 2.036 Vali Loss: 3.262 Vali Acc: 0.126 Test Loss: 3.262 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 25 cost time: 0.5497372150421143
Epoch: 25, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.262 Vali Acc: 0.125 Test Loss: 3.262 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.604863166809082
Epoch: 26, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.265 Vali Acc: 0.136 Test Loss: 3.265 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 27 cost time: 0.5897731781005859
Epoch: 27, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.270 Vali Acc: 0.140 Test Loss: 3.270 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139967).  Saving model ...
Epoch: 28 cost time: 0.5476469993591309
Epoch: 28, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.270 Vali Acc: 0.145 Test Loss: 3.270 Test Acc: 0.145
Validation loss decreased (-0.139967 --> -0.144673).  Saving model ...
Epoch: 29 cost time: 0.5812666416168213
Epoch: 29, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.275 Vali Acc: 0.148 Test Loss: 3.275 Test Acc: 0.148
Validation loss decreased (-0.144673 --> -0.148203).  Saving model ...
Epoch: 30 cost time: 0.5871274471282959
Epoch: 30, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.279 Vali Acc: 0.148 Test Loss: 3.279 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5521249771118164
Epoch: 31, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.286 Vali Acc: 0.158 Test Loss: 3.286 Test Acc: 0.158
Validation loss decreased (-0.148203 --> -0.157614).  Saving model ...
Epoch: 32 cost time: 0.5478363037109375
Epoch: 32, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.296 Vali Acc: 0.161 Test Loss: 3.296 Test Acc: 0.161
Validation loss decreased (-0.157614 --> -0.161144).  Saving model ...
Epoch: 33 cost time: 0.551884651184082
Epoch: 33, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.296 Vali Acc: 0.166 Test Loss: 3.296 Test Acc: 0.166
Validation loss decreased (-0.161144 --> -0.165849).  Saving model ...
Epoch: 34 cost time: 0.53415846824646
Epoch: 34, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.292 Vali Acc: 0.172 Test Loss: 3.292 Test Acc: 0.172
Validation loss decreased (-0.165849 --> -0.171732).  Saving model ...
Epoch: 35 cost time: 0.5608837604522705
Epoch: 35, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.289 Vali Acc: 0.180 Test Loss: 3.289 Test Acc: 0.180
Validation loss decreased (-0.171732 --> -0.179967).  Saving model ...
Epoch: 36 cost time: 0.5605833530426025
Epoch: 36, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.297 Vali Acc: 0.184 Test Loss: 3.297 Test Acc: 0.184
Validation loss decreased (-0.179967 --> -0.183496).  Saving model ...
Epoch: 37 cost time: 0.5705809593200684
Epoch: 37, Steps: 10 | Train Loss: 1.313 Vali Loss: 3.303 Vali Acc: 0.199 Test Loss: 3.303 Test Acc: 0.199
Validation loss decreased (-0.183496 --> -0.198791).  Saving model ...
Epoch: 38 cost time: 0.5207829475402832
Epoch: 38, Steps: 10 | Train Loss: 1.195 Vali Loss: 3.305 Vali Acc: 0.195 Test Loss: 3.305 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5425150394439697
Epoch: 39, Steps: 10 | Train Loss: 1.188 Vali Loss: 3.308 Vali Acc: 0.198 Test Loss: 3.308 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6075212955474854
Epoch: 40, Steps: 10 | Train Loss: 1.113 Vali Loss: 3.317 Vali Acc: 0.200 Test Loss: 3.317 Test Acc: 0.200
Validation loss decreased (-0.198791 --> -0.199967).  Saving model ...
Epoch: 41 cost time: 0.5769200325012207
Epoch: 41, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.331 Vali Acc: 0.204 Test Loss: 3.331 Test Acc: 0.204
Validation loss decreased (-0.199967 --> -0.203496).  Saving model ...
Epoch: 42 cost time: 0.5536627769470215
Epoch: 42, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.326 Vali Acc: 0.214 Test Loss: 3.326 Test Acc: 0.214
Validation loss decreased (-0.203496 --> -0.214084).  Saving model ...
Epoch: 43 cost time: 0.508713960647583
Epoch: 43, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.332 Vali Acc: 0.209 Test Loss: 3.332 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5208351612091064
Epoch: 44, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.343 Vali Acc: 0.215 Test Loss: 3.343 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215261).  Saving model ...
Epoch: 45 cost time: 0.501828670501709
Epoch: 45, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.364 Vali Acc: 0.222 Test Loss: 3.364 Test Acc: 0.222
Validation loss decreased (-0.215261 --> -0.222319).  Saving model ...
Epoch: 46 cost time: 0.5054106712341309
Epoch: 46, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.367 Vali Acc: 0.215 Test Loss: 3.367 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5519442558288574
Epoch: 47, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.374 Vali Acc: 0.222 Test Loss: 3.374 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5343241691589355
Epoch: 48, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.388 Vali Acc: 0.220 Test Loss: 3.388 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5478501319885254
Epoch: 49, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.396 Vali Acc: 0.220 Test Loss: 3.396 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5324587821960449
Epoch: 50, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.422 Vali Acc: 0.221 Test Loss: 3.422 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.4798729419708252
Epoch: 51, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.440 Vali Acc: 0.222 Test Loss: 3.440 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5286970138549805
Epoch: 52, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.449 Vali Acc: 0.222 Test Loss: 3.449 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.503063440322876
Epoch: 53, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.444 Vali Acc: 0.225 Test Loss: 3.444 Test Acc: 0.225
Validation loss decreased (-0.222319 --> -0.224671).  Saving model ...
Epoch: 54 cost time: 0.5566284656524658
Epoch: 54, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.448 Vali Acc: 0.228 Test Loss: 3.448 Test Acc: 0.228
Validation loss decreased (-0.224671 --> -0.228201).  Saving model ...
Epoch: 55 cost time: 0.4851348400115967
Epoch: 55, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.435 Vali Acc: 0.231 Test Loss: 3.435 Test Acc: 0.231
Validation loss decreased (-0.228201 --> -0.230554).  Saving model ...
Epoch: 56 cost time: 0.5702328681945801
Epoch: 56, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.463 Vali Acc: 0.232 Test Loss: 3.463 Test Acc: 0.232
Validation loss decreased (-0.230554 --> -0.231730).  Saving model ...
Epoch: 57 cost time: 0.552910327911377
Epoch: 57, Steps: 10 | Train Loss: 0.435 Vali Loss: 3.489 Vali Acc: 0.229 Test Loss: 3.489 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5200674533843994
Epoch: 58, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.504 Vali Acc: 0.234 Test Loss: 3.504 Test Acc: 0.234
Validation loss decreased (-0.231730 --> -0.234083).  Saving model ...
Epoch: 59 cost time: 0.5284194946289062
Epoch: 59, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.515 Vali Acc: 0.233 Test Loss: 3.515 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5088691711425781
Epoch: 60, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.522 Vali Acc: 0.234 Test Loss: 3.522 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5323317050933838
Epoch: 61, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.529 Vali Acc: 0.232 Test Loss: 3.529 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5572011470794678
Epoch: 62, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.551 Vali Acc: 0.232 Test Loss: 3.551 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5527427196502686
Epoch: 63, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.550 Vali Acc: 0.229 Test Loss: 3.550 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5732235908508301
Epoch: 64, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.542 Vali Acc: 0.238 Test Loss: 3.542 Test Acc: 0.238
Validation loss decreased (-0.234083 --> -0.237612).  Saving model ...
Epoch: 65 cost time: 0.532250165939331
Epoch: 65, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.563 Vali Acc: 0.240 Test Loss: 3.563 Test Acc: 0.240
Validation loss decreased (-0.237612 --> -0.239964).  Saving model ...
Epoch: 66 cost time: 0.5771441459655762
Epoch: 66, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.614 Vali Acc: 0.240 Test Loss: 3.614 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5064840316772461
Epoch: 67, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.632 Vali Acc: 0.239 Test Loss: 3.632 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5667328834533691
Epoch: 68, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.635 Vali Acc: 0.244 Test Loss: 3.635 Test Acc: 0.244
Validation loss decreased (-0.239964 --> -0.243493).  Saving model ...
Epoch: 69 cost time: 0.5419840812683105
Epoch: 69, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.650 Vali Acc: 0.241 Test Loss: 3.650 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5449373722076416
Epoch: 70, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.651 Vali Acc: 0.240 Test Loss: 3.651 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5745663642883301
Epoch: 71, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.663 Vali Acc: 0.242 Test Loss: 3.663 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5397777557373047
Epoch: 72, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.668 Vali Acc: 0.239 Test Loss: 3.668 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.5539882183074951
Epoch: 73, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.676 Vali Acc: 0.241 Test Loss: 3.676 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5300078392028809
Epoch: 74, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.701 Vali Acc: 0.241 Test Loss: 3.701 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.544954776763916
Epoch: 75, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.719 Vali Acc: 0.241 Test Loss: 3.719 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.616424560546875
Epoch: 76, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.725 Vali Acc: 0.242 Test Loss: 3.725 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.5274288654327393
Epoch: 77, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.750 Vali Acc: 0.240 Test Loss: 3.750 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.5615489482879639
Epoch: 78, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.739 Vali Acc: 0.239 Test Loss: 3.739 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 29882
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6010849475860596
Epoch: 1, Steps: 10 | Train Loss: 3.417 Vali Loss: 3.400 Vali Acc: 0.027 Test Loss: 3.400 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.4920177459716797
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.373 Vali Acc: 0.026 Test Loss: 3.373 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.494793176651001
Epoch: 3, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.415 Vali Acc: 0.060 Test Loss: 3.415 Test Acc: 0.060
Validation loss decreased (-0.027025 --> -0.059966).  Saving model ...
Epoch: 4 cost time: 0.4996004104614258
Epoch: 4, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.416 Vali Acc: 0.071 Test Loss: 3.416 Test Acc: 0.071
Validation loss decreased (-0.059966 --> -0.070554).  Saving model ...
Epoch: 5 cost time: 0.5093910694122314
Epoch: 5, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.355 Vali Acc: 0.076 Test Loss: 3.355 Test Acc: 0.076
Validation loss decreased (-0.070554 --> -0.076437).  Saving model ...
Epoch: 6 cost time: 0.5350124835968018
Epoch: 6, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.308 Vali Acc: 0.106 Test Loss: 3.308 Test Acc: 0.106
Validation loss decreased (-0.076437 --> -0.105849).  Saving model ...
Epoch: 7 cost time: 0.5145044326782227
Epoch: 7, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.298 Vali Acc: 0.101 Test Loss: 3.298 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.489534854888916
Epoch: 8, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.282 Vali Acc: 0.126 Test Loss: 3.282 Test Acc: 0.126
Validation loss decreased (-0.105849 --> -0.125850).  Saving model ...
Epoch: 9 cost time: 0.46022725105285645
Epoch: 9, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.276 Vali Acc: 0.131 Test Loss: 3.276 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130555).  Saving model ...
Epoch: 10 cost time: 0.47232627868652344
Epoch: 10, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.297 Vali Acc: 0.149 Test Loss: 3.297 Test Acc: 0.149
Validation loss decreased (-0.130555 --> -0.149379).  Saving model ...
Epoch: 11 cost time: 0.4656360149383545
Epoch: 11, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.290 Vali Acc: 0.162 Test Loss: 3.290 Test Acc: 0.162
Validation loss decreased (-0.149379 --> -0.162320).  Saving model ...
Epoch: 12 cost time: 0.4910616874694824
Epoch: 12, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.303 Vali Acc: 0.180 Test Loss: 3.303 Test Acc: 0.180
Validation loss decreased (-0.162320 --> -0.179967).  Saving model ...
Epoch: 13 cost time: 0.4818906784057617
Epoch: 13, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.374 Vali Acc: 0.181 Test Loss: 3.374 Test Acc: 0.181
Validation loss decreased (-0.179967 --> -0.181143).  Saving model ...
Epoch: 14 cost time: 0.46997570991516113
Epoch: 14, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.384 Vali Acc: 0.202 Test Loss: 3.384 Test Acc: 0.202
Validation loss decreased (-0.181143 --> -0.202319).  Saving model ...
Epoch: 15 cost time: 0.4943835735321045
Epoch: 15, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.417 Vali Acc: 0.207 Test Loss: 3.417 Test Acc: 0.207
Validation loss decreased (-0.202319 --> -0.207025).  Saving model ...
Epoch: 16 cost time: 0.518094539642334
Epoch: 16, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.480 Vali Acc: 0.214 Test Loss: 3.480 Test Acc: 0.214
Validation loss decreased (-0.207025 --> -0.214083).  Saving model ...
Epoch: 17 cost time: 0.6090304851531982
Epoch: 17, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.585 Vali Acc: 0.216 Test Loss: 3.585 Test Acc: 0.216
Validation loss decreased (-0.214083 --> -0.216435).  Saving model ...
Epoch: 18 cost time: 0.5146288871765137
Epoch: 18, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.606 Vali Acc: 0.225 Test Loss: 3.606 Test Acc: 0.225
Validation loss decreased (-0.216435 --> -0.224670).  Saving model ...
Epoch: 19 cost time: 0.4962732791900635
Epoch: 19, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.709 Vali Acc: 0.216 Test Loss: 3.709 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5286839008331299
Epoch: 20, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.777 Vali Acc: 0.224 Test Loss: 3.777 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.548753023147583
Epoch: 21, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.841 Vali Acc: 0.232 Test Loss: 3.841 Test Acc: 0.232
Validation loss decreased (-0.224670 --> -0.231726).  Saving model ...
Epoch: 22 cost time: 0.5490872859954834
Epoch: 22, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.915 Vali Acc: 0.233 Test Loss: 3.915 Test Acc: 0.233
Validation loss decreased (-0.231726 --> -0.232902).  Saving model ...
Epoch: 23 cost time: 0.5602364540100098
Epoch: 23, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.970 Vali Acc: 0.232 Test Loss: 3.970 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5720701217651367
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.016 Vali Acc: 0.236 Test Loss: 4.016 Test Acc: 0.236
Validation loss decreased (-0.232902 --> -0.236430).  Saving model ...
Epoch: 25 cost time: 0.5079150199890137
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.077 Vali Acc: 0.249 Test Loss: 4.077 Test Acc: 0.249
Validation loss decreased (-0.236430 --> -0.249371).  Saving model ...
Epoch: 26 cost time: 0.505751371383667
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.134 Vali Acc: 0.246 Test Loss: 4.134 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5446798801422119
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.155 Vali Acc: 0.244 Test Loss: 4.155 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.49990272521972656
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.198 Vali Acc: 0.246 Test Loss: 4.198 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.531935453414917
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.223 Vali Acc: 0.247 Test Loss: 4.223 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.539853572845459
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.269 Vali Acc: 0.248 Test Loss: 4.269 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5360000133514404
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.285 Vali Acc: 0.246 Test Loss: 4.285 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5265233516693115
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.309 Vali Acc: 0.247 Test Loss: 4.309 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5466110706329346
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.334 Vali Acc: 0.252 Test Loss: 4.334 Test Acc: 0.252
Validation loss decreased (-0.249371 --> -0.251721).  Saving model ...
Epoch: 34 cost time: 0.6562550067901611
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.359 Vali Acc: 0.251 Test Loss: 4.359 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5581808090209961
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.381 Vali Acc: 0.245 Test Loss: 4.381 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5311200618743896
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.418 Vali Acc: 0.247 Test Loss: 4.418 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5257258415222168
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.457 Vali Acc: 0.247 Test Loss: 4.457 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5274286270141602
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.492 Vali Acc: 0.247 Test Loss: 4.492 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5583176612854004
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.508 Vali Acc: 0.252 Test Loss: 4.508 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5095658302307129
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.510 Vali Acc: 0.249 Test Loss: 4.510 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.525763988494873
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.538 Vali Acc: 0.251 Test Loss: 4.538 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5527830123901367
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.550 Vali Acc: 0.252 Test Loss: 4.550 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5174951553344727
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.556 Vali Acc: 0.252 Test Loss: 4.556 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 105754
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6416492462158203
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.364 Vali Acc: 0.036 Test Loss: 3.364 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.4996044635772705
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.333 Vali Acc: 0.035 Test Loss: 3.333 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5213351249694824
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.323 Vali Acc: 0.049 Test Loss: 3.323 Test Acc: 0.049
Validation loss decreased (-0.036437 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.5039708614349365
Epoch: 4, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.326 Vali Acc: 0.068 Test Loss: 3.326 Test Acc: 0.068
Validation loss decreased (-0.049379 --> -0.068202).  Saving model ...
Epoch: 5 cost time: 0.5088355541229248
Epoch: 5, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.331 Vali Acc: 0.071 Test Loss: 3.331 Test Acc: 0.071
Validation loss decreased (-0.068202 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.5483171939849854
Epoch: 6, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.310 Vali Acc: 0.094 Test Loss: 3.310 Test Acc: 0.094
Validation loss decreased (-0.070555 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 0.5116896629333496
Epoch: 7, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.287 Vali Acc: 0.104 Test Loss: 3.287 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.46282958984375
Epoch: 8, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.264 Vali Acc: 0.116 Test Loss: 3.264 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 9 cost time: 0.5370466709136963
Epoch: 9, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.252 Vali Acc: 0.116 Test Loss: 3.252 Test Acc: 0.116
Validation loss decreased (-0.116438 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 0.4867360591888428
Epoch: 10, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.242 Vali Acc: 0.124 Test Loss: 3.242 Test Acc: 0.124
Validation loss decreased (-0.116438 --> -0.123497).  Saving model ...
Epoch: 11 cost time: 0.5229899883270264
Epoch: 11, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.252 Vali Acc: 0.126 Test Loss: 3.252 Test Acc: 0.126
Validation loss decreased (-0.123497 --> -0.125850).  Saving model ...
Epoch: 12 cost time: 0.5439939498901367
Epoch: 12, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.254 Vali Acc: 0.142 Test Loss: 3.254 Test Acc: 0.142
Validation loss decreased (-0.125850 --> -0.142320).  Saving model ...
Epoch: 13 cost time: 0.46466827392578125
Epoch: 13, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.257 Vali Acc: 0.159 Test Loss: 3.257 Test Acc: 0.159
Validation loss decreased (-0.142320 --> -0.158791).  Saving model ...
Epoch: 14 cost time: 0.5265018939971924
Epoch: 14, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.250 Vali Acc: 0.169 Test Loss: 3.250 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169379).  Saving model ...
Epoch: 15 cost time: 0.5057919025421143
Epoch: 15, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.274 Vali Acc: 0.175 Test Loss: 3.274 Test Acc: 0.175
Validation loss decreased (-0.169379 --> -0.175261).  Saving model ...
Epoch: 16 cost time: 0.4497220516204834
Epoch: 16, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.292 Vali Acc: 0.187 Test Loss: 3.292 Test Acc: 0.187
Validation loss decreased (-0.175261 --> -0.187026).  Saving model ...
Epoch: 17 cost time: 0.5049896240234375
Epoch: 17, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.316 Vali Acc: 0.196 Test Loss: 3.316 Test Acc: 0.196
Validation loss decreased (-0.187026 --> -0.196437).  Saving model ...
Epoch: 18 cost time: 0.5032496452331543
Epoch: 18, Steps: 10 | Train Loss: 1.096 Vali Loss: 3.341 Vali Acc: 0.199 Test Loss: 3.341 Test Acc: 0.199
Validation loss decreased (-0.196437 --> -0.198790).  Saving model ...
Epoch: 19 cost time: 0.4760158061981201
Epoch: 19, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.372 Vali Acc: 0.212 Test Loss: 3.372 Test Acc: 0.212
Validation loss decreased (-0.198790 --> -0.211731).  Saving model ...
Epoch: 20 cost time: 0.5465478897094727
Epoch: 20, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.406 Vali Acc: 0.218 Test Loss: 3.406 Test Acc: 0.218
Validation loss decreased (-0.211731 --> -0.217613).  Saving model ...
Epoch: 21 cost time: 0.5124804973602295
Epoch: 21, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.457 Vali Acc: 0.225 Test Loss: 3.457 Test Acc: 0.225
Validation loss decreased (-0.217613 --> -0.224671).  Saving model ...
Epoch: 22 cost time: 0.5345473289489746
Epoch: 22, Steps: 10 | Train Loss: 0.630 Vali Loss: 3.463 Vali Acc: 0.234 Test Loss: 3.463 Test Acc: 0.234
Validation loss decreased (-0.224671 --> -0.234083).  Saving model ...
Epoch: 23 cost time: 0.5109033584594727
Epoch: 23, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.511 Vali Acc: 0.240 Test Loss: 3.511 Test Acc: 0.240
Validation loss decreased (-0.234083 --> -0.239965).  Saving model ...
Epoch: 24 cost time: 0.5629291534423828
Epoch: 24, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.556 Vali Acc: 0.236 Test Loss: 3.556 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5379257202148438
Epoch: 25, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.623 Vali Acc: 0.239 Test Loss: 3.623 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5538508892059326
Epoch: 26, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.666 Vali Acc: 0.240 Test Loss: 3.666 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5341522693634033
Epoch: 27, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.678 Vali Acc: 0.246 Test Loss: 3.678 Test Acc: 0.246
Validation loss decreased (-0.239965 --> -0.245846).  Saving model ...
Epoch: 28 cost time: 0.5385689735412598
Epoch: 28, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.744 Vali Acc: 0.249 Test Loss: 3.744 Test Acc: 0.249
Validation loss decreased (-0.245846 --> -0.249374).  Saving model ...
Epoch: 29 cost time: 0.5391621589660645
Epoch: 29, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.809 Vali Acc: 0.242 Test Loss: 3.809 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5546741485595703
Epoch: 30, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.847 Vali Acc: 0.247 Test Loss: 3.847 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5600478649139404
Epoch: 31, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.880 Vali Acc: 0.249 Test Loss: 3.880 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.531674861907959
Epoch: 32, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.903 Vali Acc: 0.249 Test Loss: 3.903 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.514552116394043
Epoch: 33, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.932 Vali Acc: 0.246 Test Loss: 3.932 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5456655025482178
Epoch: 34, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.965 Vali Acc: 0.251 Test Loss: 3.965 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250549).  Saving model ...
Epoch: 35 cost time: 0.5332705974578857
Epoch: 35, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.004 Vali Acc: 0.248 Test Loss: 4.004 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4994010925292969
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.044 Vali Acc: 0.259 Test Loss: 4.044 Test Acc: 0.259
Validation loss decreased (-0.250549 --> -0.258783).  Saving model ...
Epoch: 37 cost time: 0.5126900672912598
Epoch: 37, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.056 Vali Acc: 0.258 Test Loss: 4.056 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.537921667098999
Epoch: 38, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.065 Vali Acc: 0.256 Test Loss: 4.065 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5008974075317383
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.102 Vali Acc: 0.256 Test Loss: 4.102 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5327577590942383
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.136 Vali Acc: 0.256 Test Loss: 4.136 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5167872905731201
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.146 Vali Acc: 0.259 Test Loss: 4.146 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5280716419219971
Epoch: 42, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.162 Vali Acc: 0.253 Test Loss: 4.162 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5324594974517822
Epoch: 43, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.186 Vali Acc: 0.255 Test Loss: 4.186 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5334048271179199
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.202 Vali Acc: 0.256 Test Loss: 4.202 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5824704170227051
Epoch: 45, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.221 Vali Acc: 0.260 Test Loss: 4.221 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259958).  Saving model ...
Epoch: 46 cost time: 0.5322275161743164
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.246 Vali Acc: 0.262 Test Loss: 4.246 Test Acc: 0.262
Validation loss decreased (-0.259958 --> -0.262310).  Saving model ...
Epoch: 47 cost time: 0.5362741947174072
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.273 Vali Acc: 0.256 Test Loss: 4.273 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5666804313659668
Epoch: 48, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.287 Vali Acc: 0.261 Test Loss: 4.287 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5161747932434082
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.320 Vali Acc: 0.262 Test Loss: 4.320 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5318617820739746
Epoch: 50, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.336 Vali Acc: 0.260 Test Loss: 4.336 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.526991605758667
Epoch: 51, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.338 Vali Acc: 0.266 Test Loss: 4.338 Test Acc: 0.266
Validation loss decreased (-0.262310 --> -0.265839).  Saving model ...
Epoch: 52 cost time: 0.5549790859222412
Epoch: 52, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.353 Vali Acc: 0.261 Test Loss: 4.353 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5153181552886963
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.376 Vali Acc: 0.259 Test Loss: 4.376 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.519686222076416
Epoch: 54, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.408 Vali Acc: 0.254 Test Loss: 4.408 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6284387111663818
Epoch: 55, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.435 Vali Acc: 0.254 Test Loss: 4.435 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.48408961296081543
Epoch: 56, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.428 Vali Acc: 0.258 Test Loss: 4.428 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.51485276222229
Epoch: 57, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.446 Vali Acc: 0.254 Test Loss: 4.446 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.506415605545044
Epoch: 58, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.464 Vali Acc: 0.254 Test Loss: 4.464 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.5512475967407227
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.468 Vali Acc: 0.255 Test Loss: 4.468 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5141043663024902
Epoch: 60, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.487 Vali Acc: 0.259 Test Loss: 4.487 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5253143310546875
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.506 Vali Acc: 0.249 Test Loss: 4.506 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 58394
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8060777187347412
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.390 Vali Acc: 0.035 Test Loss: 3.390 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 0.5721302032470703
Epoch: 2, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.366 Vali Acc: 0.042 Test Loss: 3.366 Test Acc: 0.042
Validation loss decreased (-0.035260 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.5305099487304688
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.353 Vali Acc: 0.056 Test Loss: 3.353 Test Acc: 0.056
Validation loss decreased (-0.042319 --> -0.056437).  Saving model ...
Epoch: 4 cost time: 0.5824394226074219
Epoch: 4, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.343 Vali Acc: 0.064 Test Loss: 3.343 Test Acc: 0.064
Validation loss decreased (-0.056437 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 0.5190014839172363
Epoch: 5, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.339 Vali Acc: 0.081 Test Loss: 3.339 Test Acc: 0.081
Validation loss decreased (-0.063496 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 0.5801560878753662
Epoch: 6, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.332 Vali Acc: 0.087 Test Loss: 3.332 Test Acc: 0.087
Validation loss decreased (-0.081143 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 0.5449223518371582
Epoch: 7, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.329 Vali Acc: 0.092 Test Loss: 3.329 Test Acc: 0.092
Validation loss decreased (-0.087026 --> -0.091731).  Saving model ...
Epoch: 8 cost time: 0.5690982341766357
Epoch: 8, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.322 Vali Acc: 0.096 Test Loss: 3.322 Test Acc: 0.096
Validation loss decreased (-0.091731 --> -0.096437).  Saving model ...
Epoch: 9 cost time: 0.5728082656860352
Epoch: 9, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.310 Vali Acc: 0.104 Test Loss: 3.310 Test Acc: 0.104
Validation loss decreased (-0.096437 --> -0.103496).  Saving model ...
Epoch: 10 cost time: 0.5653274059295654
Epoch: 10, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.293 Vali Acc: 0.108 Test Loss: 3.293 Test Acc: 0.108
Validation loss decreased (-0.103496 --> -0.108202).  Saving model ...
Epoch: 11 cost time: 0.5496437549591064
Epoch: 11, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.272 Vali Acc: 0.113 Test Loss: 3.272 Test Acc: 0.113
Validation loss decreased (-0.108202 --> -0.112908).  Saving model ...
Epoch: 12 cost time: 0.5488247871398926
Epoch: 12, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.265 Vali Acc: 0.116 Test Loss: 3.265 Test Acc: 0.116
Validation loss decreased (-0.112908 --> -0.116438).  Saving model ...
Epoch: 13 cost time: 0.5592532157897949
Epoch: 13, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.258 Vali Acc: 0.129 Test Loss: 3.258 Test Acc: 0.129
Validation loss decreased (-0.116438 --> -0.129379).  Saving model ...
Epoch: 14 cost time: 0.5157015323638916
Epoch: 14, Steps: 10 | Train Loss: 1.962 Vali Loss: 3.241 Vali Acc: 0.133 Test Loss: 3.241 Test Acc: 0.133
Validation loss decreased (-0.129379 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.521507978439331
Epoch: 15, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.227 Vali Acc: 0.144 Test Loss: 3.227 Test Acc: 0.144
Validation loss decreased (-0.132909 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 0.5465648174285889
Epoch: 16, Steps: 10 | Train Loss: 1.757 Vali Loss: 3.222 Vali Acc: 0.151 Test Loss: 3.222 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 17 cost time: 0.5575113296508789
Epoch: 17, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.229 Vali Acc: 0.152 Test Loss: 3.229 Test Acc: 0.152
Validation loss decreased (-0.150556 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.547940731048584
Epoch: 18, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.241 Vali Acc: 0.161 Test Loss: 3.241 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 19 cost time: 0.5805809497833252
Epoch: 19, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.249 Vali Acc: 0.164 Test Loss: 3.249 Test Acc: 0.164
Validation loss decreased (-0.161144 --> -0.163497).  Saving model ...
Epoch: 20 cost time: 0.5352072715759277
Epoch: 20, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.251 Vali Acc: 0.185 Test Loss: 3.251 Test Acc: 0.185
Validation loss decreased (-0.163497 --> -0.184673).  Saving model ...
Epoch: 21 cost time: 0.521763801574707
Epoch: 21, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.259 Vali Acc: 0.185 Test Loss: 3.259 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5820190906524658
Epoch: 22, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.286 Vali Acc: 0.185 Test Loss: 3.286 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5130817890167236
Epoch: 23, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.311 Vali Acc: 0.193 Test Loss: 3.311 Test Acc: 0.193
Validation loss decreased (-0.184673 --> -0.192908).  Saving model ...
Epoch: 24 cost time: 0.538703441619873
Epoch: 24, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.311 Vali Acc: 0.201 Test Loss: 3.311 Test Acc: 0.201
Validation loss decreased (-0.192908 --> -0.201143).  Saving model ...
Epoch: 25 cost time: 0.5156240463256836
Epoch: 25, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.334 Vali Acc: 0.201 Test Loss: 3.334 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5193355083465576
Epoch: 26, Steps: 10 | Train Loss: 0.709 Vali Loss: 3.359 Vali Acc: 0.207 Test Loss: 3.359 Test Acc: 0.207
Validation loss decreased (-0.201143 --> -0.207025).  Saving model ...
Epoch: 27 cost time: 0.5343642234802246
Epoch: 27, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.378 Vali Acc: 0.218 Test Loss: 3.378 Test Acc: 0.218
Validation loss decreased (-0.207025 --> -0.217613).  Saving model ...
Epoch: 28 cost time: 0.5718929767608643
Epoch: 28, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.412 Vali Acc: 0.214 Test Loss: 3.412 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5312206745147705
Epoch: 29, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.444 Vali Acc: 0.215 Test Loss: 3.444 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.529118537902832
Epoch: 30, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.469 Vali Acc: 0.222 Test Loss: 3.469 Test Acc: 0.222
Validation loss decreased (-0.217613 --> -0.222318).  Saving model ...
Epoch: 31 cost time: 0.5528323650360107
Epoch: 31, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.488 Vali Acc: 0.225 Test Loss: 3.488 Test Acc: 0.225
Validation loss decreased (-0.222318 --> -0.224671).  Saving model ...
Epoch: 32 cost time: 0.5095787048339844
Epoch: 32, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.525 Vali Acc: 0.227 Test Loss: 3.525 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227024).  Saving model ...
Epoch: 33 cost time: 0.5030510425567627
Epoch: 33, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.567 Vali Acc: 0.225 Test Loss: 3.567 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5018496513366699
Epoch: 34, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.573 Vali Acc: 0.232 Test Loss: 3.573 Test Acc: 0.232
Validation loss decreased (-0.227024 --> -0.231729).  Saving model ...
Epoch: 35 cost time: 0.5477509498596191
Epoch: 35, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.616 Vali Acc: 0.227 Test Loss: 3.616 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5003211498260498
Epoch: 36, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.643 Vali Acc: 0.229 Test Loss: 3.643 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4960808753967285
Epoch: 37, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.682 Vali Acc: 0.232 Test Loss: 3.682 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5983045101165771
Epoch: 38, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.704 Vali Acc: 0.229 Test Loss: 3.704 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5356495380401611
Epoch: 39, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.724 Vali Acc: 0.236 Test Loss: 3.724 Test Acc: 0.236
Validation loss decreased (-0.231729 --> -0.236433).  Saving model ...
Epoch: 40 cost time: 0.5244777202606201
Epoch: 40, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.723 Vali Acc: 0.241 Test Loss: 3.723 Test Acc: 0.241
Validation loss decreased (-0.236433 --> -0.241139).  Saving model ...
Epoch: 41 cost time: 0.6206583976745605
Epoch: 41, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.732 Vali Acc: 0.241 Test Loss: 3.732 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5636739730834961
Epoch: 42, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.748 Vali Acc: 0.244 Test Loss: 3.748 Test Acc: 0.244
Validation loss decreased (-0.241139 --> -0.243492).  Saving model ...
Epoch: 43 cost time: 0.4950582981109619
Epoch: 43, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.773 Vali Acc: 0.249 Test Loss: 3.773 Test Acc: 0.249
Validation loss decreased (-0.243492 --> -0.249374).  Saving model ...
Epoch: 44 cost time: 0.5382552146911621
Epoch: 44, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.779 Vali Acc: 0.251 Test Loss: 3.779 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250550).  Saving model ...
Epoch: 45 cost time: 0.5080063343048096
Epoch: 45, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.822 Vali Acc: 0.242 Test Loss: 3.822 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5208120346069336
Epoch: 46, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.869 Vali Acc: 0.241 Test Loss: 3.869 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5201668739318848
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.891 Vali Acc: 0.239 Test Loss: 3.891 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5405228137969971
Epoch: 48, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.904 Vali Acc: 0.241 Test Loss: 3.904 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5847892761230469
Epoch: 49, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.917 Vali Acc: 0.242 Test Loss: 3.917 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5446968078613281
Epoch: 50, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.939 Vali Acc: 0.240 Test Loss: 3.939 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5248193740844727
Epoch: 51, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.953 Vali Acc: 0.241 Test Loss: 3.953 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5516841411590576
Epoch: 52, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.982 Vali Acc: 0.240 Test Loss: 3.982 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.5716416835784912
Epoch: 53, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.974 Vali Acc: 0.239 Test Loss: 3.974 Test Acc: 0.239
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5218138694763184
Epoch: 54, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.971 Vali Acc: 0.244 Test Loss: 3.971 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 42234
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4778084754943848
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.331 Vali Acc: 0.039 Test Loss: 3.331 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5109424591064453
Epoch: 2, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.327 Vali Acc: 0.048 Test Loss: 3.327 Test Acc: 0.048
Validation loss decreased (-0.038790 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.5123696327209473
Epoch: 3, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.322 Vali Acc: 0.059 Test Loss: 3.322 Test Acc: 0.059
Validation loss decreased (-0.048202 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.5486161708831787
Epoch: 4, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.314 Vali Acc: 0.073 Test Loss: 3.314 Test Acc: 0.073
Validation loss decreased (-0.058790 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 0.5795726776123047
Epoch: 5, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.308 Vali Acc: 0.076 Test Loss: 3.308 Test Acc: 0.076
Validation loss decreased (-0.072908 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.5655665397644043
Epoch: 6, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.306 Vali Acc: 0.080 Test Loss: 3.306 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 0.4907379150390625
Epoch: 7, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.305 Vali Acc: 0.084 Test Loss: 3.305 Test Acc: 0.084
Validation loss decreased (-0.079967 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 0.5472760200500488
Epoch: 8, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.298 Vali Acc: 0.088 Test Loss: 3.298 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 9 cost time: 0.5368528366088867
Epoch: 9, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.297 Vali Acc: 0.095 Test Loss: 3.297 Test Acc: 0.095
Validation loss decreased (-0.088202 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.5290794372558594
Epoch: 10, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.281 Vali Acc: 0.106 Test Loss: 3.281 Test Acc: 0.106
Validation loss decreased (-0.095261 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.4935581684112549
Epoch: 11, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.266 Vali Acc: 0.115 Test Loss: 3.266 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115261).  Saving model ...
Epoch: 12 cost time: 0.5541326999664307
Epoch: 12, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.255 Vali Acc: 0.121 Test Loss: 3.255 Test Acc: 0.121
Validation loss decreased (-0.115261 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 0.5255558490753174
Epoch: 13, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.249 Vali Acc: 0.127 Test Loss: 3.249 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127026).  Saving model ...
Epoch: 14 cost time: 0.526226282119751
Epoch: 14, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.239 Vali Acc: 0.136 Test Loss: 3.239 Test Acc: 0.136
Validation loss decreased (-0.127026 --> -0.136438).  Saving model ...
Epoch: 15 cost time: 0.5743842124938965
Epoch: 15, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.235 Vali Acc: 0.151 Test Loss: 3.235 Test Acc: 0.151
Validation loss decreased (-0.136438 --> -0.150556).  Saving model ...
Epoch: 16 cost time: 0.5671782493591309
Epoch: 16, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.238 Vali Acc: 0.147 Test Loss: 3.238 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5110039710998535
Epoch: 17, Steps: 10 | Train Loss: 1.917 Vali Loss: 3.238 Vali Acc: 0.158 Test Loss: 3.238 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157615).  Saving model ...
Epoch: 18 cost time: 0.5007939338684082
Epoch: 18, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.245 Vali Acc: 0.161 Test Loss: 3.245 Test Acc: 0.161
Validation loss decreased (-0.157615 --> -0.161144).  Saving model ...
Epoch: 19 cost time: 0.5232338905334473
Epoch: 19, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.248 Vali Acc: 0.172 Test Loss: 3.248 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171732).  Saving model ...
Epoch: 20 cost time: 0.5343022346496582
Epoch: 20, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.246 Vali Acc: 0.171 Test Loss: 3.246 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5201752185821533
Epoch: 21, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.244 Vali Acc: 0.185 Test Loss: 3.244 Test Acc: 0.185
Validation loss decreased (-0.171732 --> -0.184673).  Saving model ...
Epoch: 22 cost time: 0.4966726303100586
Epoch: 22, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.255 Vali Acc: 0.194 Test Loss: 3.255 Test Acc: 0.194
Validation loss decreased (-0.184673 --> -0.194085).  Saving model ...
Epoch: 23 cost time: 0.5026950836181641
Epoch: 23, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.270 Vali Acc: 0.205 Test Loss: 3.270 Test Acc: 0.205
Validation loss decreased (-0.194085 --> -0.204673).  Saving model ...
Epoch: 24 cost time: 0.5167644023895264
Epoch: 24, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.281 Vali Acc: 0.207 Test Loss: 3.281 Test Acc: 0.207
Validation loss decreased (-0.204673 --> -0.207026).  Saving model ...
Epoch: 25 cost time: 0.5140917301177979
Epoch: 25, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.291 Vali Acc: 0.212 Test Loss: 3.291 Test Acc: 0.212
Validation loss decreased (-0.207026 --> -0.211732).  Saving model ...
Epoch: 26 cost time: 0.4855196475982666
Epoch: 26, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.299 Vali Acc: 0.222 Test Loss: 3.299 Test Acc: 0.222
Validation loss decreased (-0.211732 --> -0.222320).  Saving model ...
Epoch: 27 cost time: 0.49126553535461426
Epoch: 27, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.322 Vali Acc: 0.228 Test Loss: 3.322 Test Acc: 0.228
Validation loss decreased (-0.222320 --> -0.228202).  Saving model ...
Epoch: 28 cost time: 0.5164365768432617
Epoch: 28, Steps: 10 | Train Loss: 0.929 Vali Loss: 3.343 Vali Acc: 0.225 Test Loss: 3.343 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5355391502380371
Epoch: 29, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.363 Vali Acc: 0.233 Test Loss: 3.363 Test Acc: 0.233
Validation loss decreased (-0.228202 --> -0.232908).  Saving model ...
Epoch: 30 cost time: 0.5569684505462646
Epoch: 30, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.396 Vali Acc: 0.235 Test Loss: 3.396 Test Acc: 0.235
Validation loss decreased (-0.232908 --> -0.235260).  Saving model ...
Epoch: 31 cost time: 0.4774630069732666
Epoch: 31, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.418 Vali Acc: 0.240 Test Loss: 3.418 Test Acc: 0.240
Validation loss decreased (-0.235260 --> -0.239966).  Saving model ...
Epoch: 32 cost time: 0.5237514972686768
Epoch: 32, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.433 Vali Acc: 0.236 Test Loss: 3.433 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5803096294403076
Epoch: 33, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.438 Vali Acc: 0.238 Test Loss: 3.438 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5111455917358398
Epoch: 34, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.481 Vali Acc: 0.241 Test Loss: 3.481 Test Acc: 0.241
Validation loss decreased (-0.239966 --> -0.241142).  Saving model ...
Epoch: 35 cost time: 0.4143080711364746
Epoch: 35, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.517 Vali Acc: 0.241 Test Loss: 3.517 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5039031505584717
Epoch: 36, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.536 Vali Acc: 0.238 Test Loss: 3.536 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5842676162719727
Epoch: 37, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.558 Vali Acc: 0.244 Test Loss: 3.558 Test Acc: 0.244
Validation loss decreased (-0.241142 --> -0.243494).  Saving model ...
Epoch: 38 cost time: 0.4993722438812256
Epoch: 38, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.577 Vali Acc: 0.247 Test Loss: 3.577 Test Acc: 0.247
Validation loss decreased (-0.243494 --> -0.247023).  Saving model ...
Epoch: 39 cost time: 0.5798561573028564
Epoch: 39, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.610 Vali Acc: 0.256 Test Loss: 3.610 Test Acc: 0.256
Validation loss decreased (-0.247023 --> -0.256434).  Saving model ...
Epoch: 40 cost time: 0.6257748603820801
Epoch: 40, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.643 Vali Acc: 0.249 Test Loss: 3.643 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5084311962127686
Epoch: 41, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.661 Vali Acc: 0.260 Test Loss: 3.661 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259963).  Saving model ...
Epoch: 42 cost time: 0.5582447052001953
Epoch: 42, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.687 Vali Acc: 0.259 Test Loss: 3.687 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5318377017974854
Epoch: 43, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.688 Vali Acc: 0.262 Test Loss: 3.688 Test Acc: 0.262
Validation loss decreased (-0.259963 --> -0.262316).  Saving model ...
Epoch: 44 cost time: 0.5791900157928467
Epoch: 44, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.700 Vali Acc: 0.268 Test Loss: 3.700 Test Acc: 0.268
Validation loss decreased (-0.262316 --> -0.268198).  Saving model ...
Epoch: 45 cost time: 0.5442595481872559
Epoch: 45, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.736 Vali Acc: 0.267 Test Loss: 3.736 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.569087028503418
Epoch: 46, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.777 Vali Acc: 0.266 Test Loss: 3.777 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5427699089050293
Epoch: 47, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.809 Vali Acc: 0.264 Test Loss: 3.809 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5748786926269531
Epoch: 48, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.813 Vali Acc: 0.265 Test Loss: 3.813 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5669286251068115
Epoch: 49, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.837 Vali Acc: 0.268 Test Loss: 3.837 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5339338779449463
Epoch: 50, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.851 Vali Acc: 0.271 Test Loss: 3.851 Test Acc: 0.271
Validation loss decreased (-0.268198 --> -0.270550).  Saving model ...
Epoch: 51 cost time: 0.5315594673156738
Epoch: 51, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.867 Vali Acc: 0.268 Test Loss: 3.867 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5025129318237305
Epoch: 52, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.878 Vali Acc: 0.266 Test Loss: 3.878 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5600285530090332
Epoch: 53, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.888 Vali Acc: 0.269 Test Loss: 3.888 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.5503408908843994
Epoch: 54, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.914 Vali Acc: 0.268 Test Loss: 3.914 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5681538581848145
Epoch: 55, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.949 Vali Acc: 0.262 Test Loss: 3.949 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5908453464508057
Epoch: 56, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.984 Vali Acc: 0.266 Test Loss: 3.984 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5846314430236816
Epoch: 57, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.994 Vali Acc: 0.264 Test Loss: 3.994 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.589876651763916
Epoch: 58, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.997 Vali Acc: 0.265 Test Loss: 3.997 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.5255126953125
Epoch: 59, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.006 Vali Acc: 0.266 Test Loss: 4.006 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5522744655609131
Epoch: 60, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.025 Vali Acc: 0.262 Test Loss: 4.025 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 34810
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5729291439056396
Epoch: 1, Steps: 10 | Train Loss: 3.501 Vali Loss: 3.396 Vali Acc: 0.022 Test Loss: 3.396 Test Acc: 0.022
Validation loss decreased (inf --> -0.022319).  Saving model ...
Epoch: 2 cost time: 0.5171704292297363
Epoch: 2, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.376 Vali Acc: 0.029 Test Loss: 3.376 Test Acc: 0.029
Validation loss decreased (-0.022319 --> -0.029378).  Saving model ...
Epoch: 3 cost time: 0.47562646865844727
Epoch: 3, Steps: 10 | Train Loss: 3.445 Vali Loss: 3.367 Vali Acc: 0.033 Test Loss: 3.367 Test Acc: 0.033
Validation loss decreased (-0.029378 --> -0.032908).  Saving model ...
Epoch: 4 cost time: 0.502802848815918
Epoch: 4, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.358 Vali Acc: 0.035 Test Loss: 3.358 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 5 cost time: 0.5363636016845703
Epoch: 5, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.346 Vali Acc: 0.036 Test Loss: 3.346 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036437).  Saving model ...
Epoch: 6 cost time: 0.5237216949462891
Epoch: 6, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.338 Vali Acc: 0.036 Test Loss: 3.338 Test Acc: 0.036
Validation loss decreased (-0.036437 --> -0.036437).  Saving model ...
Epoch: 7 cost time: 0.49254560470581055
Epoch: 7, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.328 Vali Acc: 0.044 Test Loss: 3.328 Test Acc: 0.044
Validation loss decreased (-0.036437 --> -0.043496).  Saving model ...
Epoch: 8 cost time: 0.5687339305877686
Epoch: 8, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.322 Vali Acc: 0.052 Test Loss: 3.322 Test Acc: 0.052
Validation loss decreased (-0.043496 --> -0.051731).  Saving model ...
Epoch: 9 cost time: 0.5120363235473633
Epoch: 9, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.318 Vali Acc: 0.052 Test Loss: 3.318 Test Acc: 0.052
Validation loss decreased (-0.051731 --> -0.051732).  Saving model ...
Epoch: 10 cost time: 0.5216221809387207
Epoch: 10, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.315 Vali Acc: 0.058 Test Loss: 3.315 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 11 cost time: 0.5567405223846436
Epoch: 11, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.313 Vali Acc: 0.059 Test Loss: 3.313 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058790).  Saving model ...
Epoch: 12 cost time: 0.5337796211242676
Epoch: 12, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.304 Vali Acc: 0.071 Test Loss: 3.304 Test Acc: 0.071
Validation loss decreased (-0.058790 --> -0.070555).  Saving model ...
Epoch: 13 cost time: 0.5349874496459961
Epoch: 13, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.292 Vali Acc: 0.082 Test Loss: 3.292 Test Acc: 0.082
Validation loss decreased (-0.070555 --> -0.082320).  Saving model ...
Epoch: 14 cost time: 0.5013830661773682
Epoch: 14, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.283 Vali Acc: 0.076 Test Loss: 3.283 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5006752014160156
Epoch: 15, Steps: 10 | Train Loss: 2.585 Vali Loss: 3.280 Vali Acc: 0.089 Test Loss: 3.280 Test Acc: 0.089
Validation loss decreased (-0.082320 --> -0.089379).  Saving model ...
Epoch: 16 cost time: 0.5274176597595215
Epoch: 16, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.272 Vali Acc: 0.094 Test Loss: 3.272 Test Acc: 0.094
Validation loss decreased (-0.089379 --> -0.094085).  Saving model ...
Epoch: 17 cost time: 0.5935549736022949
Epoch: 17, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.266 Vali Acc: 0.099 Test Loss: 3.266 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 0.5390884876251221
Epoch: 18, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.262 Vali Acc: 0.107 Test Loss: 3.262 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107026).  Saving model ...
Epoch: 19 cost time: 0.576392412185669
Epoch: 19, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.254 Vali Acc: 0.107 Test Loss: 3.254 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 20 cost time: 0.572561502456665
Epoch: 20, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.245 Vali Acc: 0.107 Test Loss: 3.245 Test Acc: 0.107
Validation loss decreased (-0.107026 --> -0.107026).  Saving model ...
Epoch: 21 cost time: 0.5701303482055664
Epoch: 21, Steps: 10 | Train Loss: 2.064 Vali Loss: 3.244 Vali Acc: 0.114 Test Loss: 3.244 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 22 cost time: 0.5571496486663818
Epoch: 22, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.249 Vali Acc: 0.125 Test Loss: 3.249 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124673).  Saving model ...
Epoch: 23 cost time: 0.534888744354248
Epoch: 23, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.254 Vali Acc: 0.133 Test Loss: 3.254 Test Acc: 0.133
Validation loss decreased (-0.124673 --> -0.132909).  Saving model ...
Epoch: 24 cost time: 0.5381338596343994
Epoch: 24, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.254 Vali Acc: 0.140 Test Loss: 3.254 Test Acc: 0.140
Validation loss decreased (-0.132909 --> -0.139967).  Saving model ...
Epoch: 25 cost time: 0.5467724800109863
Epoch: 25, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.259 Vali Acc: 0.153 Test Loss: 3.259 Test Acc: 0.153
Validation loss decreased (-0.139967 --> -0.152909).  Saving model ...
Epoch: 26 cost time: 0.530980110168457
Epoch: 26, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.272 Vali Acc: 0.155 Test Loss: 3.272 Test Acc: 0.155
Validation loss decreased (-0.152909 --> -0.155261).  Saving model ...
Epoch: 27 cost time: 0.5110337734222412
Epoch: 27, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.272 Vali Acc: 0.158 Test Loss: 3.272 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 28 cost time: 0.560964822769165
Epoch: 28, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.270 Vali Acc: 0.165 Test Loss: 3.270 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164673).  Saving model ...
Epoch: 29 cost time: 0.5893242359161377
Epoch: 29, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.268 Vali Acc: 0.167 Test Loss: 3.268 Test Acc: 0.167
Validation loss decreased (-0.164673 --> -0.167026).  Saving model ...
Epoch: 30 cost time: 0.6396174430847168
Epoch: 30, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.283 Vali Acc: 0.171 Test Loss: 3.283 Test Acc: 0.171
Validation loss decreased (-0.167026 --> -0.170555).  Saving model ...
Epoch: 31 cost time: 0.5186002254486084
Epoch: 31, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.303 Vali Acc: 0.175 Test Loss: 3.303 Test Acc: 0.175
Validation loss decreased (-0.170555 --> -0.175261).  Saving model ...
Epoch: 32 cost time: 0.5208029747009277
Epoch: 32, Steps: 10 | Train Loss: 1.196 Vali Loss: 3.307 Vali Acc: 0.180 Test Loss: 3.307 Test Acc: 0.180
Validation loss decreased (-0.175261 --> -0.179967).  Saving model ...
Epoch: 33 cost time: 0.6253983974456787
Epoch: 33, Steps: 10 | Train Loss: 1.079 Vali Loss: 3.321 Vali Acc: 0.181 Test Loss: 3.321 Test Acc: 0.181
Validation loss decreased (-0.179967 --> -0.181143).  Saving model ...
Epoch: 34 cost time: 0.6091675758361816
Epoch: 34, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.350 Vali Acc: 0.184 Test Loss: 3.350 Test Acc: 0.184
Validation loss decreased (-0.181143 --> -0.183496).  Saving model ...
Epoch: 35 cost time: 0.508704423904419
Epoch: 35, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.358 Vali Acc: 0.191 Test Loss: 3.358 Test Acc: 0.191
Validation loss decreased (-0.183496 --> -0.190555).  Saving model ...
Epoch: 36 cost time: 0.5397357940673828
Epoch: 36, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.361 Vali Acc: 0.193 Test Loss: 3.361 Test Acc: 0.193
Validation loss decreased (-0.190555 --> -0.192908).  Saving model ...
Epoch: 37 cost time: 0.5221080780029297
Epoch: 37, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.373 Vali Acc: 0.193 Test Loss: 3.373 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5571091175079346
Epoch: 38, Steps: 10 | Train Loss: 0.811 Vali Loss: 3.388 Vali Acc: 0.208 Test Loss: 3.388 Test Acc: 0.208
Validation loss decreased (-0.192908 --> -0.208201).  Saving model ...
Epoch: 39 cost time: 0.5301873683929443
Epoch: 39, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.395 Vali Acc: 0.213 Test Loss: 3.395 Test Acc: 0.213
Validation loss decreased (-0.208201 --> -0.212907).  Saving model ...
Epoch: 40 cost time: 0.5536572933197021
Epoch: 40, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.414 Vali Acc: 0.211 Test Loss: 3.414 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5365910530090332
Epoch: 41, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.438 Vali Acc: 0.214 Test Loss: 3.438 Test Acc: 0.214
Validation loss decreased (-0.212907 --> -0.214083).  Saving model ...
Epoch: 42 cost time: 0.5696284770965576
Epoch: 42, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.459 Vali Acc: 0.222 Test Loss: 3.459 Test Acc: 0.222
Validation loss decreased (-0.214083 --> -0.222318).  Saving model ...
Epoch: 43 cost time: 0.546647310256958
Epoch: 43, Steps: 10 | Train Loss: 0.569 Vali Loss: 3.469 Vali Acc: 0.224 Test Loss: 3.469 Test Acc: 0.224
Validation loss decreased (-0.222318 --> -0.223495).  Saving model ...
Epoch: 44 cost time: 0.5206506252288818
Epoch: 44, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.485 Vali Acc: 0.221 Test Loss: 3.485 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5119187831878662
Epoch: 45, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.507 Vali Acc: 0.226 Test Loss: 3.507 Test Acc: 0.226
Validation loss decreased (-0.223495 --> -0.225847).  Saving model ...
Epoch: 46 cost time: 0.5961418151855469
Epoch: 46, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.523 Vali Acc: 0.236 Test Loss: 3.523 Test Acc: 0.236
Validation loss decreased (-0.225847 --> -0.236435).  Saving model ...
Epoch: 47 cost time: 0.5247185230255127
Epoch: 47, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.534 Vali Acc: 0.234 Test Loss: 3.534 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4710068702697754
Epoch: 48, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.532 Vali Acc: 0.238 Test Loss: 3.532 Test Acc: 0.238
Validation loss decreased (-0.236435 --> -0.237612).  Saving model ...
Epoch: 49 cost time: 0.5345008373260498
Epoch: 49, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.569 Vali Acc: 0.238 Test Loss: 3.569 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4642603397369385
Epoch: 50, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.585 Vali Acc: 0.234 Test Loss: 3.585 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5327832698822021
Epoch: 51, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.582 Vali Acc: 0.236 Test Loss: 3.582 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.47839927673339844
Epoch: 52, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.609 Vali Acc: 0.234 Test Loss: 3.609 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.48481202125549316
Epoch: 53, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.627 Vali Acc: 0.240 Test Loss: 3.627 Test Acc: 0.240
Validation loss decreased (-0.237612 --> -0.239964).  Saving model ...
Epoch: 54 cost time: 0.5235774517059326
Epoch: 54, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.629 Vali Acc: 0.238 Test Loss: 3.629 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5064342021942139
Epoch: 55, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.663 Vali Acc: 0.240 Test Loss: 3.663 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.4949374198913574
Epoch: 56, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.701 Vali Acc: 0.236 Test Loss: 3.701 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5285842418670654
Epoch: 57, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.709 Vali Acc: 0.242 Test Loss: 3.709 Test Acc: 0.242
Validation loss decreased (-0.239964 --> -0.242316).  Saving model ...
Epoch: 58 cost time: 0.49559473991394043
Epoch: 58, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.701 Vali Acc: 0.242 Test Loss: 3.701 Test Acc: 0.242
Validation loss decreased (-0.242316 --> -0.242316).  Saving model ...
Epoch: 59 cost time: 0.5247197151184082
Epoch: 59, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.726 Vali Acc: 0.244 Test Loss: 3.726 Test Acc: 0.244
Validation loss decreased (-0.242316 --> -0.243492).  Saving model ...
Epoch: 60 cost time: 0.5161399841308594
Epoch: 60, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.739 Vali Acc: 0.242 Test Loss: 3.739 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5381999015808105
Epoch: 61, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.763 Vali Acc: 0.247 Test Loss: 3.763 Test Acc: 0.247
Validation loss decreased (-0.243492 --> -0.247021).  Saving model ...
Epoch: 62 cost time: 0.5118772983551025
Epoch: 62, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.775 Vali Acc: 0.246 Test Loss: 3.775 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5074639320373535
Epoch: 63, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.775 Vali Acc: 0.245 Test Loss: 3.775 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.5681986808776855
Epoch: 64, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.797 Vali Acc: 0.247 Test Loss: 3.797 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5588572025299072
Epoch: 65, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.816 Vali Acc: 0.253 Test Loss: 3.816 Test Acc: 0.253
Validation loss decreased (-0.247021 --> -0.252903).  Saving model ...
Epoch: 66 cost time: 0.5769295692443848
Epoch: 66, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.841 Vali Acc: 0.245 Test Loss: 3.841 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.4916672706604004
Epoch: 67, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.853 Vali Acc: 0.239 Test Loss: 3.853 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5073800086975098
Epoch: 68, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.881 Vali Acc: 0.241 Test Loss: 3.881 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5598597526550293
Epoch: 69, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.869 Vali Acc: 0.256 Test Loss: 3.869 Test Acc: 0.256
Validation loss decreased (-0.252903 --> -0.256432).  Saving model ...
Epoch: 70 cost time: 0.5353474617004395
Epoch: 70, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.890 Vali Acc: 0.255 Test Loss: 3.890 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5408916473388672
Epoch: 71, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.905 Vali Acc: 0.248 Test Loss: 3.905 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5554282665252686
Epoch: 72, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.920 Vali Acc: 0.256 Test Loss: 3.920 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5550577640533447
Epoch: 73, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.931 Vali Acc: 0.262 Test Loss: 3.931 Test Acc: 0.262
Validation loss decreased (-0.256432 --> -0.262314).  Saving model ...
Epoch: 74 cost time: 0.5056939125061035
Epoch: 74, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.949 Vali Acc: 0.261 Test Loss: 3.949 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.5260889530181885
Epoch: 75, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.970 Vali Acc: 0.249 Test Loss: 3.970 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.5435137748718262
Epoch: 76, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.999 Vali Acc: 0.251 Test Loss: 3.999 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5089714527130127
Epoch: 77, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.999 Vali Acc: 0.256 Test Loss: 3.999 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.5403006076812744
Epoch: 78, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.994 Vali Acc: 0.264 Test Loss: 3.994 Test Acc: 0.264
Validation loss decreased (-0.262314 --> -0.263489).  Saving model ...
Epoch: 79 cost time: 0.5212306976318359
Epoch: 79, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.008 Vali Acc: 0.265 Test Loss: 4.008 Test Acc: 0.265
Validation loss decreased (-0.263489 --> -0.264666).  Saving model ...
Epoch: 80 cost time: 0.574225664138794
Epoch: 80, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.031 Vali Acc: 0.260 Test Loss: 4.031 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.515986442565918
Epoch: 81, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.066 Vali Acc: 0.251 Test Loss: 4.066 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.519963264465332
Epoch: 82, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.072 Vali Acc: 0.251 Test Loss: 4.072 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.5365521907806396
Epoch: 83, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.068 Vali Acc: 0.259 Test Loss: 4.068 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.5238037109375
Epoch: 84, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.078 Vali Acc: 0.267 Test Loss: 4.078 Test Acc: 0.267
Validation loss decreased (-0.264666 --> -0.267018).  Saving model ...
Epoch: 85 cost time: 0.5622024536132812
Epoch: 85, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.085 Vali Acc: 0.265 Test Loss: 4.085 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.5721821784973145
Epoch: 86, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.088 Vali Acc: 0.259 Test Loss: 4.088 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.6208367347717285
Epoch: 87, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.080 Vali Acc: 0.265 Test Loss: 4.080 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.5312769412994385
Epoch: 88, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.094 Vali Acc: 0.265 Test Loss: 4.094 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.5562264919281006
Epoch: 89, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.114 Vali Acc: 0.261 Test Loss: 4.114 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.5080461502075195
Epoch: 90, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.117 Vali Acc: 0.261 Test Loss: 4.117 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.5188772678375244
Epoch: 91, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.125 Vali Acc: 0.264 Test Loss: 4.125 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.4918668270111084
Epoch: 92, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.158 Vali Acc: 0.266 Test Loss: 4.158 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.5299062728881836
Epoch: 93, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.172 Vali Acc: 0.265 Test Loss: 4.172 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.5554060935974121
Epoch: 94, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.199 Vali Acc: 0.258 Test Loss: 4.199 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 26186
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8474905490875244
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.369 Vali Acc: 0.038 Test Loss: 3.369 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.5062808990478516
Epoch: 2, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.363 Vali Acc: 0.045 Test Loss: 3.363 Test Acc: 0.045
Validation loss decreased (-0.037613 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.488025426864624
Epoch: 3, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.357 Vali Acc: 0.044 Test Loss: 3.357 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.48905491828918457
Epoch: 4, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.349 Vali Acc: 0.046 Test Loss: 3.349 Test Acc: 0.046
Validation loss decreased (-0.044672 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 0.4609956741333008
Epoch: 5, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.340 Vali Acc: 0.051 Test Loss: 3.340 Test Acc: 0.051
Validation loss decreased (-0.045849 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 0.5113162994384766
Epoch: 6, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.332 Vali Acc: 0.058 Test Loss: 3.332 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 0.4878525733947754
Epoch: 7, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.325 Vali Acc: 0.064 Test Loss: 3.325 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063496).  Saving model ...
Epoch: 8 cost time: 0.497664213180542
Epoch: 8, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.321 Vali Acc: 0.062 Test Loss: 3.321 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48813605308532715
Epoch: 9, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.319 Vali Acc: 0.062 Test Loss: 3.319 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.44372081756591797
Epoch: 10, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.318 Vali Acc: 0.065 Test Loss: 3.318 Test Acc: 0.065
Validation loss decreased (-0.063496 --> -0.064673).  Saving model ...
Epoch: 11 cost time: 0.5181443691253662
Epoch: 11, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.316 Vali Acc: 0.071 Test Loss: 3.316 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 12 cost time: 0.5434262752532959
Epoch: 12, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.318 Vali Acc: 0.075 Test Loss: 3.318 Test Acc: 0.075
Validation loss decreased (-0.070555 --> -0.075261).  Saving model ...
Epoch: 13 cost time: 0.49397778511047363
Epoch: 13, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.317 Vali Acc: 0.075 Test Loss: 3.317 Test Acc: 0.075
Validation loss decreased (-0.075261 --> -0.075261).  Saving model ...
Epoch: 14 cost time: 0.4926748275756836
Epoch: 14, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.318 Vali Acc: 0.076 Test Loss: 3.318 Test Acc: 0.076
Validation loss decreased (-0.075261 --> -0.076437).  Saving model ...
Epoch: 15 cost time: 0.5154895782470703
Epoch: 15, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.317 Vali Acc: 0.079 Test Loss: 3.317 Test Acc: 0.079
Validation loss decreased (-0.076437 --> -0.078790).  Saving model ...
Epoch: 16 cost time: 0.5111997127532959
Epoch: 16, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.315 Vali Acc: 0.081 Test Loss: 3.315 Test Acc: 0.081
Validation loss decreased (-0.078790 --> -0.081143).  Saving model ...
Epoch: 17 cost time: 0.487598180770874
Epoch: 17, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.311 Vali Acc: 0.088 Test Loss: 3.311 Test Acc: 0.088
Validation loss decreased (-0.081143 --> -0.088202).  Saving model ...
Epoch: 18 cost time: 0.5190086364746094
Epoch: 18, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.310 Vali Acc: 0.087 Test Loss: 3.310 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5932610034942627
Epoch: 19, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.306 Vali Acc: 0.096 Test Loss: 3.306 Test Acc: 0.096
Validation loss decreased (-0.088202 --> -0.096438).  Saving model ...
Epoch: 20 cost time: 0.5427687168121338
Epoch: 20, Steps: 10 | Train Loss: 2.256 Vali Loss: 3.300 Vali Acc: 0.104 Test Loss: 3.300 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103496).  Saving model ...
Epoch: 21 cost time: 0.5129375457763672
Epoch: 21, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.298 Vali Acc: 0.109 Test Loss: 3.298 Test Acc: 0.109
Validation loss decreased (-0.103496 --> -0.109379).  Saving model ...
Epoch: 22 cost time: 0.5103216171264648
Epoch: 22, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.301 Vali Acc: 0.116 Test Loss: 3.301 Test Acc: 0.116
Validation loss decreased (-0.109379 --> -0.116438).  Saving model ...
Epoch: 23 cost time: 0.5195188522338867
Epoch: 23, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.302 Vali Acc: 0.122 Test Loss: 3.302 Test Acc: 0.122
Validation loss decreased (-0.116438 --> -0.122320).  Saving model ...
Epoch: 24 cost time: 0.4770197868347168
Epoch: 24, Steps: 10 | Train Loss: 1.957 Vali Loss: 3.298 Vali Acc: 0.125 Test Loss: 3.298 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 25 cost time: 0.5157887935638428
Epoch: 25, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.300 Vali Acc: 0.131 Test Loss: 3.300 Test Acc: 0.131
Validation loss decreased (-0.124673 --> -0.130555).  Saving model ...
Epoch: 26 cost time: 0.513206958770752
Epoch: 26, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.299 Vali Acc: 0.138 Test Loss: 3.299 Test Acc: 0.138
Validation loss decreased (-0.130555 --> -0.137614).  Saving model ...
Epoch: 27 cost time: 0.5950696468353271
Epoch: 27, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.309 Vali Acc: 0.139 Test Loss: 3.309 Test Acc: 0.139
Validation loss decreased (-0.137614 --> -0.138790).  Saving model ...
Epoch: 28 cost time: 0.5470888614654541
Epoch: 28, Steps: 10 | Train Loss: 1.690 Vali Loss: 3.317 Vali Acc: 0.136 Test Loss: 3.317 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4954259395599365
Epoch: 29, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.329 Vali Acc: 0.138 Test Loss: 3.329 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5603399276733398
Epoch: 30, Steps: 10 | Train Loss: 1.624 Vali Loss: 3.331 Vali Acc: 0.145 Test Loss: 3.331 Test Acc: 0.145
Validation loss decreased (-0.138790 --> -0.144673).  Saving model ...
Epoch: 31 cost time: 0.5311052799224854
Epoch: 31, Steps: 10 | Train Loss: 1.613 Vali Loss: 3.333 Vali Acc: 0.149 Test Loss: 3.333 Test Acc: 0.149
Validation loss decreased (-0.144673 --> -0.149378).  Saving model ...
Epoch: 32 cost time: 0.5215237140655518
Epoch: 32, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.337 Vali Acc: 0.152 Test Loss: 3.337 Test Acc: 0.152
Validation loss decreased (-0.149378 --> -0.151731).  Saving model ...
Epoch: 33 cost time: 0.5397729873657227
Epoch: 33, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.349 Vali Acc: 0.156 Test Loss: 3.349 Test Acc: 0.156
Validation loss decreased (-0.151731 --> -0.156437).  Saving model ...
Epoch: 34 cost time: 0.5275213718414307
Epoch: 34, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.356 Vali Acc: 0.166 Test Loss: 3.356 Test Acc: 0.166
Validation loss decreased (-0.156437 --> -0.165849).  Saving model ...
Epoch: 35 cost time: 0.5138630867004395
Epoch: 35, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.370 Vali Acc: 0.166 Test Loss: 3.370 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5047497749328613
Epoch: 36, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.383 Vali Acc: 0.165 Test Loss: 3.383 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5586118698120117
Epoch: 37, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.390 Vali Acc: 0.166 Test Loss: 3.390 Test Acc: 0.166
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5305595397949219
Epoch: 38, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.403 Vali Acc: 0.168 Test Loss: 3.403 Test Acc: 0.168
Validation loss decreased (-0.165849 --> -0.168201).  Saving model ...
Epoch: 39 cost time: 0.5318028926849365
Epoch: 39, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.409 Vali Acc: 0.173 Test Loss: 3.409 Test Acc: 0.173
Validation loss decreased (-0.168201 --> -0.172907).  Saving model ...
Epoch: 40 cost time: 0.5301642417907715
Epoch: 40, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.420 Vali Acc: 0.172 Test Loss: 3.420 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5839903354644775
Epoch: 41, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.434 Vali Acc: 0.181 Test Loss: 3.434 Test Acc: 0.181
Validation loss decreased (-0.172907 --> -0.181142).  Saving model ...
Epoch: 42 cost time: 0.5165379047393799
Epoch: 42, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.448 Vali Acc: 0.180 Test Loss: 3.448 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5370948314666748
Epoch: 43, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.453 Vali Acc: 0.178 Test Loss: 3.453 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5037975311279297
Epoch: 44, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.472 Vali Acc: 0.176 Test Loss: 3.472 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.48638010025024414
Epoch: 45, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.488 Vali Acc: 0.175 Test Loss: 3.488 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5123023986816406
Epoch: 46, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.508 Vali Acc: 0.178 Test Loss: 3.508 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4934818744659424
Epoch: 47, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.530 Vali Acc: 0.185 Test Loss: 3.530 Test Acc: 0.185
Validation loss decreased (-0.181142 --> -0.184671).  Saving model ...
Epoch: 48 cost time: 0.4311408996582031
Epoch: 48, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.546 Vali Acc: 0.187 Test Loss: 3.546 Test Acc: 0.187
Validation loss decreased (-0.184671 --> -0.187023).  Saving model ...
Epoch: 49 cost time: 0.5305249691009521
Epoch: 49, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.556 Vali Acc: 0.196 Test Loss: 3.556 Test Acc: 0.196
Validation loss decreased (-0.187023 --> -0.196435).  Saving model ...
Epoch: 50 cost time: 0.5211079120635986
Epoch: 50, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.579 Vali Acc: 0.196 Test Loss: 3.579 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5132594108581543
Epoch: 51, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.584 Vali Acc: 0.198 Test Loss: 3.584 Test Acc: 0.198
Validation loss decreased (-0.196435 --> -0.197611).  Saving model ...
Epoch: 52 cost time: 0.49204468727111816
Epoch: 52, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.599 Vali Acc: 0.201 Test Loss: 3.599 Test Acc: 0.201
Validation loss decreased (-0.197611 --> -0.201140).  Saving model ...
Epoch: 53 cost time: 0.5348718166351318
Epoch: 53, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.618 Vali Acc: 0.198 Test Loss: 3.618 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.49073266983032227
Epoch: 54, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.631 Vali Acc: 0.202 Test Loss: 3.631 Test Acc: 0.202
Validation loss decreased (-0.201140 --> -0.202317).  Saving model ...
Epoch: 55 cost time: 0.4994542598724365
Epoch: 55, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.660 Vali Acc: 0.202 Test Loss: 3.660 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.48253726959228516
Epoch: 56, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.688 Vali Acc: 0.206 Test Loss: 3.688 Test Acc: 0.206
Validation loss decreased (-0.202317 --> -0.205845).  Saving model ...
Epoch: 57 cost time: 0.4840884208679199
Epoch: 57, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.699 Vali Acc: 0.205 Test Loss: 3.699 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.517864465713501
Epoch: 58, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.710 Vali Acc: 0.202 Test Loss: 3.710 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.527468204498291
Epoch: 59, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.725 Vali Acc: 0.204 Test Loss: 3.725 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.49185943603515625
Epoch: 60, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.745 Vali Acc: 0.206 Test Loss: 3.745 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.537010669708252
Epoch: 61, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.745 Vali Acc: 0.202 Test Loss: 3.745 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5259461402893066
Epoch: 62, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.747 Vali Acc: 0.207 Test Loss: 3.747 Test Acc: 0.207
Validation loss decreased (-0.205845 --> -0.207021).  Saving model ...
Epoch: 63 cost time: 0.4976794719696045
Epoch: 63, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.752 Vali Acc: 0.209 Test Loss: 3.752 Test Acc: 0.209
Validation loss decreased (-0.207021 --> -0.209374).  Saving model ...
Epoch: 64 cost time: 0.48984289169311523
Epoch: 64, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.790 Vali Acc: 0.209 Test Loss: 3.790 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5216224193572998
Epoch: 65, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.828 Vali Acc: 0.214 Test Loss: 3.828 Test Acc: 0.214
Validation loss decreased (-0.209374 --> -0.214079).  Saving model ...
Epoch: 66 cost time: 0.567009687423706
Epoch: 66, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.857 Vali Acc: 0.213 Test Loss: 3.857 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5319666862487793
Epoch: 67, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.855 Vali Acc: 0.218 Test Loss: 3.855 Test Acc: 0.218
Validation loss decreased (-0.214079 --> -0.217609).  Saving model ...
Epoch: 68 cost time: 0.48525404930114746
Epoch: 68, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.857 Vali Acc: 0.216 Test Loss: 3.857 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.509624719619751
Epoch: 69, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.859 Vali Acc: 0.215 Test Loss: 3.859 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5246632099151611
Epoch: 70, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.872 Vali Acc: 0.218 Test Loss: 3.872 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5452980995178223
Epoch: 71, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.877 Vali Acc: 0.215 Test Loss: 3.877 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.638207197189331
Epoch: 72, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.916 Vali Acc: 0.215 Test Loss: 3.916 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5887267589569092
Epoch: 73, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.926 Vali Acc: 0.216 Test Loss: 3.926 Test Acc: 0.216
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5234212875366211
Epoch: 74, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.954 Vali Acc: 0.218 Test Loss: 3.954 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.5031774044036865
Epoch: 75, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.964 Vali Acc: 0.216 Test Loss: 3.964 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.5463724136352539
Epoch: 76, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.984 Vali Acc: 0.219 Test Loss: 3.984 Test Acc: 0.219
Validation loss decreased (-0.217609 --> -0.218784).  Saving model ...
Epoch: 77 cost time: 0.524592399597168
Epoch: 77, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.005 Vali Acc: 0.220 Test Loss: 4.005 Test Acc: 0.220
Validation loss decreased (-0.218784 --> -0.219960).  Saving model ...
Epoch: 78 cost time: 0.5263943672180176
Epoch: 78, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.016 Vali Acc: 0.218 Test Loss: 4.016 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5285029411315918
Epoch: 79, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.031 Vali Acc: 0.221 Test Loss: 4.031 Test Acc: 0.221
Validation loss decreased (-0.219960 --> -0.221136).  Saving model ...
Epoch: 80 cost time: 0.5734446048736572
Epoch: 80, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.070 Vali Acc: 0.215 Test Loss: 4.070 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5243852138519287
Epoch: 81, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.079 Vali Acc: 0.218 Test Loss: 4.079 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5215818881988525
Epoch: 82, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.103 Vali Acc: 0.215 Test Loss: 4.103 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.565976619720459
Epoch: 83, Steps: 10 | Train Loss: 0.131 Vali Loss: 4.086 Vali Acc: 0.213 Test Loss: 4.086 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.5363829135894775
Epoch: 84, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.104 Vali Acc: 0.213 Test Loss: 4.104 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.5497150421142578
Epoch: 85, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.142 Vali Acc: 0.215 Test Loss: 4.142 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.5645678043365479
Epoch: 86, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.160 Vali Acc: 0.218 Test Loss: 4.160 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.5185136795043945
Epoch: 87, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.157 Vali Acc: 0.215 Test Loss: 4.157 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.5230076313018799
Epoch: 88, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.171 Vali Acc: 0.214 Test Loss: 4.171 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.5235958099365234
Epoch: 89, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.175 Vali Acc: 0.219 Test Loss: 4.175 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2211764705882353
model parameter : 22570
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.82560396194458
Epoch: 1, Steps: 10 | Train Loss: 3.503 Vali Loss: 3.340 Vali Acc: 0.047 Test Loss: 3.340 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.4851689338684082
Epoch: 2, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.329 Vali Acc: 0.058 Test Loss: 3.329 Test Acc: 0.058
Validation loss decreased (-0.047025 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.49256062507629395
Epoch: 3, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.324 Vali Acc: 0.060 Test Loss: 3.324 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.48938894271850586
Epoch: 4, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.316 Vali Acc: 0.062 Test Loss: 3.316 Test Acc: 0.062
Validation loss decreased (-0.059967 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.5103709697723389
Epoch: 5, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.306 Vali Acc: 0.064 Test Loss: 3.306 Test Acc: 0.064
Validation loss decreased (-0.062320 --> -0.063496).  Saving model ...
Epoch: 6 cost time: 0.5267577171325684
Epoch: 6, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.295 Vali Acc: 0.062 Test Loss: 3.295 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5290606021881104
Epoch: 7, Steps: 10 | Train Loss: 3.165 Vali Loss: 3.287 Vali Acc: 0.062 Test Loss: 3.287 Test Acc: 0.062
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5047707557678223
Epoch: 8, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.278 Vali Acc: 0.064 Test Loss: 3.278 Test Acc: 0.064
Validation loss decreased (-0.063496 --> -0.063497).  Saving model ...
Epoch: 9 cost time: 0.5218095779418945
Epoch: 9, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.270 Vali Acc: 0.064 Test Loss: 3.270 Test Acc: 0.064
Validation loss decreased (-0.063497 --> -0.063497).  Saving model ...
Epoch: 10 cost time: 0.5256147384643555
Epoch: 10, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.265 Vali Acc: 0.066 Test Loss: 3.265 Test Acc: 0.066
Validation loss decreased (-0.063497 --> -0.065850).  Saving model ...
Epoch: 11 cost time: 0.40674424171447754
Epoch: 11, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.258 Vali Acc: 0.068 Test Loss: 3.258 Test Acc: 0.068
Validation loss decreased (-0.065850 --> -0.068203).  Saving model ...
Epoch: 12 cost time: 0.5140459537506104
Epoch: 12, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.253 Vali Acc: 0.075 Test Loss: 3.253 Test Acc: 0.075
Validation loss decreased (-0.068203 --> -0.075262).  Saving model ...
Epoch: 13 cost time: 0.5137233734130859
Epoch: 13, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.246 Vali Acc: 0.080 Test Loss: 3.246 Test Acc: 0.080
Validation loss decreased (-0.075262 --> -0.079968).  Saving model ...
Epoch: 14 cost time: 0.5251045227050781
Epoch: 14, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.245 Vali Acc: 0.085 Test Loss: 3.245 Test Acc: 0.085
Validation loss decreased (-0.079968 --> -0.084673).  Saving model ...
Epoch: 15 cost time: 0.513493537902832
Epoch: 15, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.245 Vali Acc: 0.085 Test Loss: 3.245 Test Acc: 0.085
Validation loss decreased (-0.084673 --> -0.084673).  Saving model ...
Epoch: 16 cost time: 0.5706591606140137
Epoch: 16, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.245 Vali Acc: 0.092 Test Loss: 3.245 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 17 cost time: 0.5137579441070557
Epoch: 17, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.244 Vali Acc: 0.096 Test Loss: 3.244 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 18 cost time: 0.4871654510498047
Epoch: 18, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 19 cost time: 0.5268557071685791
Epoch: 19, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.242 Vali Acc: 0.113 Test Loss: 3.242 Test Acc: 0.113
Validation loss decreased (-0.101144 --> -0.112909).  Saving model ...
Epoch: 20 cost time: 0.5182085037231445
Epoch: 20, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.244 Vali Acc: 0.120 Test Loss: 3.244 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 21 cost time: 0.544257640838623
Epoch: 21, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.242 Vali Acc: 0.122 Test Loss: 3.242 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122321).  Saving model ...
Epoch: 22 cost time: 0.4975566864013672
Epoch: 22, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.241 Vali Acc: 0.127 Test Loss: 3.241 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127026).  Saving model ...
Epoch: 23 cost time: 0.5262682437896729
Epoch: 23, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.242 Vali Acc: 0.128 Test Loss: 3.242 Test Acc: 0.128
Validation loss decreased (-0.127026 --> -0.128203).  Saving model ...
Epoch: 24 cost time: 0.5131790637969971
Epoch: 24, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.245 Vali Acc: 0.133 Test Loss: 3.245 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 25 cost time: 0.5159499645233154
Epoch: 25, Steps: 10 | Train Loss: 2.114 Vali Loss: 3.243 Vali Acc: 0.136 Test Loss: 3.243 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136438).  Saving model ...
Epoch: 26 cost time: 0.5415973663330078
Epoch: 26, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.248 Vali Acc: 0.135 Test Loss: 3.248 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5510110855102539
Epoch: 27, Steps: 10 | Train Loss: 1.944 Vali Loss: 3.256 Vali Acc: 0.139 Test Loss: 3.256 Test Acc: 0.139
Validation loss decreased (-0.136438 --> -0.138791).  Saving model ...
Epoch: 28 cost time: 0.5426287651062012
Epoch: 28, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.261 Vali Acc: 0.144 Test Loss: 3.261 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 29 cost time: 0.5026509761810303
Epoch: 29, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.269 Vali Acc: 0.145 Test Loss: 3.269 Test Acc: 0.145
Validation loss decreased (-0.143497 --> -0.144673).  Saving model ...
Epoch: 30 cost time: 0.5340299606323242
Epoch: 30, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.273 Vali Acc: 0.151 Test Loss: 3.273 Test Acc: 0.151
Validation loss decreased (-0.144673 --> -0.150556).  Saving model ...
Epoch: 31 cost time: 0.5064942836761475
Epoch: 31, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.277 Vali Acc: 0.153 Test Loss: 3.277 Test Acc: 0.153
Validation loss decreased (-0.150556 --> -0.152908).  Saving model ...
Epoch: 32 cost time: 0.5351011753082275
Epoch: 32, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.279 Vali Acc: 0.155 Test Loss: 3.279 Test Acc: 0.155
Validation loss decreased (-0.152908 --> -0.155261).  Saving model ...
Epoch: 33 cost time: 0.5192806720733643
Epoch: 33, Steps: 10 | Train Loss: 1.520 Vali Loss: 3.284 Vali Acc: 0.158 Test Loss: 3.284 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 34 cost time: 0.5420229434967041
Epoch: 34, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.292 Vali Acc: 0.166 Test Loss: 3.292 Test Acc: 0.166
Validation loss decreased (-0.157614 --> -0.165849).  Saving model ...
Epoch: 35 cost time: 0.5201668739318848
Epoch: 35, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.296 Vali Acc: 0.174 Test Loss: 3.296 Test Acc: 0.174
Validation loss decreased (-0.165849 --> -0.174085).  Saving model ...
Epoch: 36 cost time: 0.5139875411987305
Epoch: 36, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.313 Vali Acc: 0.180 Test Loss: 3.313 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 37 cost time: 0.4912557601928711
Epoch: 37, Steps: 10 | Train Loss: 1.362 Vali Loss: 3.306 Vali Acc: 0.186 Test Loss: 3.306 Test Acc: 0.186
Validation loss decreased (-0.179967 --> -0.185849).  Saving model ...
Epoch: 38 cost time: 0.5358943939208984
Epoch: 38, Steps: 10 | Train Loss: 1.279 Vali Loss: 3.311 Vali Acc: 0.182 Test Loss: 3.311 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5142467021942139
Epoch: 39, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.320 Vali Acc: 0.185 Test Loss: 3.320 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5151410102844238
Epoch: 40, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.326 Vali Acc: 0.191 Test Loss: 3.326 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190555).  Saving model ...
Epoch: 41 cost time: 0.4556863307952881
Epoch: 41, Steps: 10 | Train Loss: 1.141 Vali Loss: 3.336 Vali Acc: 0.196 Test Loss: 3.336 Test Acc: 0.196
Validation loss decreased (-0.190555 --> -0.196437).  Saving model ...
Epoch: 42 cost time: 0.4991011619567871
Epoch: 42, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.354 Vali Acc: 0.201 Test Loss: 3.354 Test Acc: 0.201
Validation loss decreased (-0.196437 --> -0.201143).  Saving model ...
Epoch: 43 cost time: 0.44900083541870117
Epoch: 43, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.370 Vali Acc: 0.202 Test Loss: 3.370 Test Acc: 0.202
Validation loss decreased (-0.201143 --> -0.202319).  Saving model ...
Epoch: 44 cost time: 0.5106844902038574
Epoch: 44, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.378 Vali Acc: 0.200 Test Loss: 3.378 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4896738529205322
Epoch: 45, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.379 Vali Acc: 0.207 Test Loss: 3.379 Test Acc: 0.207
Validation loss decreased (-0.202319 --> -0.207025).  Saving model ...
Epoch: 46 cost time: 0.5457754135131836
Epoch: 46, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.391 Vali Acc: 0.214 Test Loss: 3.391 Test Acc: 0.214
Validation loss decreased (-0.207025 --> -0.214084).  Saving model ...
Epoch: 47 cost time: 0.49639892578125
Epoch: 47, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.422 Vali Acc: 0.205 Test Loss: 3.422 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.48802661895751953
Epoch: 48, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.433 Vali Acc: 0.209 Test Loss: 3.433 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.43026089668273926
Epoch: 49, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.427 Vali Acc: 0.213 Test Loss: 3.427 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4672250747680664
Epoch: 50, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.431 Vali Acc: 0.221 Test Loss: 3.431 Test Acc: 0.221
Validation loss decreased (-0.214084 --> -0.221142).  Saving model ...
Epoch: 51 cost time: 0.49187445640563965
Epoch: 51, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.434 Vali Acc: 0.219 Test Loss: 3.434 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4942183494567871
Epoch: 52, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.454 Vali Acc: 0.222 Test Loss: 3.454 Test Acc: 0.222
Validation loss decreased (-0.221142 --> -0.222318).  Saving model ...
Epoch: 53 cost time: 0.482452392578125
Epoch: 53, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.479 Vali Acc: 0.225 Test Loss: 3.479 Test Acc: 0.225
Validation loss decreased (-0.222318 --> -0.224671).  Saving model ...
Epoch: 54 cost time: 0.48984575271606445
Epoch: 54, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.506 Vali Acc: 0.220 Test Loss: 3.506 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.48699426651000977
Epoch: 55, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.505 Vali Acc: 0.218 Test Loss: 3.505 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.4490499496459961
Epoch: 56, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.517 Vali Acc: 0.220 Test Loss: 3.517 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.4714202880859375
Epoch: 57, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.540 Vali Acc: 0.225 Test Loss: 3.540 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.4719119071960449
Epoch: 58, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.557 Vali Acc: 0.219 Test Loss: 3.557 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.562178373336792
Epoch: 59, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.574 Vali Acc: 0.220 Test Loss: 3.574 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.48162364959716797
Epoch: 60, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.581 Vali Acc: 0.224 Test Loss: 3.581 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.5617287158966064
Epoch: 61, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.587 Vali Acc: 0.232 Test Loss: 3.587 Test Acc: 0.232
Validation loss decreased (-0.224671 --> -0.231729).  Saving model ...
Epoch: 62 cost time: 0.519141674041748
Epoch: 62, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.608 Vali Acc: 0.232 Test Loss: 3.608 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.53281569480896
Epoch: 63, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.624 Vali Acc: 0.233 Test Loss: 3.624 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232905).  Saving model ...
Epoch: 64 cost time: 0.5166759490966797
Epoch: 64, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.616 Vali Acc: 0.235 Test Loss: 3.616 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235258).  Saving model ...
Epoch: 65 cost time: 0.5515289306640625
Epoch: 65, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.631 Vali Acc: 0.236 Test Loss: 3.631 Test Acc: 0.236
Validation loss decreased (-0.235258 --> -0.236434).  Saving model ...
Epoch: 66 cost time: 0.5327370166778564
Epoch: 66, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.654 Vali Acc: 0.234 Test Loss: 3.654 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.49504733085632324
Epoch: 67, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.674 Vali Acc: 0.234 Test Loss: 3.674 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5174086093902588
Epoch: 68, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.699 Vali Acc: 0.233 Test Loss: 3.699 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.47855687141418457
Epoch: 69, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.694 Vali Acc: 0.242 Test Loss: 3.694 Test Acc: 0.242
Validation loss decreased (-0.236434 --> -0.242316).  Saving model ...
Epoch: 70 cost time: 0.5214188098907471
Epoch: 70, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.703 Vali Acc: 0.241 Test Loss: 3.703 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.5319802761077881
Epoch: 71, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.714 Vali Acc: 0.234 Test Loss: 3.714 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5058248043060303
Epoch: 72, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.723 Vali Acc: 0.241 Test Loss: 3.723 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5391101837158203
Epoch: 73, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.752 Vali Acc: 0.234 Test Loss: 3.752 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5371122360229492
Epoch: 74, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.768 Vali Acc: 0.239 Test Loss: 3.768 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.5086884498596191
Epoch: 75, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.778 Vali Acc: 0.240 Test Loss: 3.778 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.5850141048431396
Epoch: 76, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.779 Vali Acc: 0.239 Test Loss: 3.779 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.5670385360717773
Epoch: 77, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.801 Vali Acc: 0.236 Test Loss: 3.801 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.5582404136657715
Epoch: 78, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.809 Vali Acc: 0.234 Test Loss: 3.809 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.5499880313873291
Epoch: 79, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.817 Vali Acc: 0.239 Test Loss: 3.817 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 21434
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5128977298736572
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.355 Vali Acc: 0.035 Test Loss: 3.355 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.5187153816223145
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.346 Vali Acc: 0.054 Test Loss: 3.346 Test Acc: 0.054
Validation loss decreased (-0.035261 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.5334618091583252
Epoch: 3, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.379 Vali Acc: 0.080 Test Loss: 3.379 Test Acc: 0.080
Validation loss decreased (-0.054084 --> -0.079966).  Saving model ...
Epoch: 4 cost time: 0.49256467819213867
Epoch: 4, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.341 Vali Acc: 0.093 Test Loss: 3.341 Test Acc: 0.093
Validation loss decreased (-0.079966 --> -0.092908).  Saving model ...
Epoch: 5 cost time: 0.4757118225097656
Epoch: 5, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.316 Vali Acc: 0.095 Test Loss: 3.316 Test Acc: 0.095
Validation loss decreased (-0.092908 --> -0.095261).  Saving model ...
Epoch: 6 cost time: 0.5066964626312256
Epoch: 6, Steps: 10 | Train Loss: 2.642 Vali Loss: 3.282 Vali Acc: 0.115 Test Loss: 3.282 Test Acc: 0.115
Validation loss decreased (-0.095261 --> -0.115261).  Saving model ...
Epoch: 7 cost time: 0.47077441215515137
Epoch: 7, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.246 Vali Acc: 0.133 Test Loss: 3.246 Test Acc: 0.133
Validation loss decreased (-0.115261 --> -0.132909).  Saving model ...
Epoch: 8 cost time: 0.48268818855285645
Epoch: 8, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.255 Vali Acc: 0.147 Test Loss: 3.255 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147026).  Saving model ...
Epoch: 9 cost time: 0.493638277053833
Epoch: 9, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.257 Vali Acc: 0.151 Test Loss: 3.257 Test Acc: 0.151
Validation loss decreased (-0.147026 --> -0.150556).  Saving model ...
Epoch: 10 cost time: 0.48574352264404297
Epoch: 10, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.236 Vali Acc: 0.164 Test Loss: 3.236 Test Acc: 0.164
Validation loss decreased (-0.150556 --> -0.163497).  Saving model ...
Epoch: 11 cost time: 0.520035982131958
Epoch: 11, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.251 Vali Acc: 0.164 Test Loss: 3.251 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47528719902038574
Epoch: 12, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.295 Vali Acc: 0.182 Test Loss: 3.295 Test Acc: 0.182
Validation loss decreased (-0.163497 --> -0.182320).  Saving model ...
Epoch: 13 cost time: 0.5238335132598877
Epoch: 13, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.319 Vali Acc: 0.181 Test Loss: 3.319 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.48836374282836914
Epoch: 14, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.362 Vali Acc: 0.191 Test Loss: 3.362 Test Acc: 0.191
Validation loss decreased (-0.182320 --> -0.190555).  Saving model ...
Epoch: 15 cost time: 0.49709153175354004
Epoch: 15, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.409 Vali Acc: 0.201 Test Loss: 3.409 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201142).  Saving model ...
Epoch: 16 cost time: 0.4680671691894531
Epoch: 16, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.460 Vali Acc: 0.204 Test Loss: 3.460 Test Acc: 0.204
Validation loss decreased (-0.201142 --> -0.203495).  Saving model ...
Epoch: 17 cost time: 0.4736044406890869
Epoch: 17, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.523 Vali Acc: 0.211 Test Loss: 3.523 Test Acc: 0.211
Validation loss decreased (-0.203495 --> -0.210553).  Saving model ...
Epoch: 18 cost time: 0.5064921379089355
Epoch: 18, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.602 Vali Acc: 0.221 Test Loss: 3.602 Test Acc: 0.221
Validation loss decreased (-0.210553 --> -0.221140).  Saving model ...
Epoch: 19 cost time: 0.4713296890258789
Epoch: 19, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.644 Vali Acc: 0.227 Test Loss: 3.644 Test Acc: 0.227
Validation loss decreased (-0.221140 --> -0.227022).  Saving model ...
Epoch: 20 cost time: 0.4685850143432617
Epoch: 20, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.736 Vali Acc: 0.231 Test Loss: 3.736 Test Acc: 0.231
Validation loss decreased (-0.227022 --> -0.230551).  Saving model ...
Epoch: 21 cost time: 0.5046699047088623
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.832 Vali Acc: 0.233 Test Loss: 3.832 Test Acc: 0.233
Validation loss decreased (-0.230551 --> -0.232903).  Saving model ...
Epoch: 22 cost time: 0.5252883434295654
Epoch: 22, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.894 Vali Acc: 0.236 Test Loss: 3.894 Test Acc: 0.236
Validation loss decreased (-0.232903 --> -0.236432).  Saving model ...
Epoch: 23 cost time: 0.5109446048736572
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.965 Vali Acc: 0.238 Test Loss: 3.965 Test Acc: 0.238
Validation loss decreased (-0.236432 --> -0.237607).  Saving model ...
Epoch: 24 cost time: 0.5301284790039062
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.029 Vali Acc: 0.236 Test Loss: 4.029 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5008499622344971
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.061 Vali Acc: 0.233 Test Loss: 4.061 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5486288070678711
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.133 Vali Acc: 0.238 Test Loss: 4.133 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5491929054260254
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.183 Vali Acc: 0.241 Test Loss: 4.183 Test Acc: 0.241
Validation loss decreased (-0.237607 --> -0.241135).  Saving model ...
Epoch: 28 cost time: 0.4811995029449463
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.210 Vali Acc: 0.251 Test Loss: 4.210 Test Acc: 0.251
Validation loss decreased (-0.241135 --> -0.250546).  Saving model ...
Epoch: 29 cost time: 0.5347166061401367
Epoch: 29, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.254 Vali Acc: 0.246 Test Loss: 4.254 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5251467227935791
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.294 Vali Acc: 0.236 Test Loss: 4.294 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5064435005187988
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.311 Vali Acc: 0.241 Test Loss: 4.311 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.546823263168335
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.343 Vali Acc: 0.249 Test Loss: 4.343 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5220639705657959
Epoch: 33, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.373 Vali Acc: 0.242 Test Loss: 4.373 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.5417137145996094
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.388 Vali Acc: 0.248 Test Loss: 4.388 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5247931480407715
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.391 Vali Acc: 0.253 Test Loss: 4.391 Test Acc: 0.253
Validation loss decreased (-0.250546 --> -0.252897).  Saving model ...
Epoch: 36 cost time: 0.5855700969696045
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.416 Vali Acc: 0.258 Test Loss: 4.416 Test Acc: 0.258
Validation loss decreased (-0.252897 --> -0.257603).  Saving model ...
Epoch: 37 cost time: 0.5466511249542236
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.448 Vali Acc: 0.259 Test Loss: 4.448 Test Acc: 0.259
Validation loss decreased (-0.257603 --> -0.258779).  Saving model ...
Epoch: 38 cost time: 0.524970293045044
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.468 Vali Acc: 0.258 Test Loss: 4.468 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5321271419525146
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.495 Vali Acc: 0.259 Test Loss: 4.495 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5088529586791992
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.514 Vali Acc: 0.253 Test Loss: 4.514 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5226709842681885
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.513 Vali Acc: 0.255 Test Loss: 4.513 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5201900005340576
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.539 Vali Acc: 0.256 Test Loss: 4.539 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5055677890777588
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.557 Vali Acc: 0.252 Test Loss: 4.557 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.517554521560669
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.566 Vali Acc: 0.258 Test Loss: 4.566 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5004923343658447
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.586 Vali Acc: 0.251 Test Loss: 4.586 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.58199143409729
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.609 Vali Acc: 0.252 Test Loss: 4.609 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.4953458309173584
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.637 Vali Acc: 0.249 Test Loss: 4.637 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 101530
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.558943748474121
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.352 Vali Acc: 0.036 Test Loss: 3.352 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.4830162525177002
Epoch: 2, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.326 Vali Acc: 0.036 Test Loss: 3.326 Test Acc: 0.036
Validation loss decreased (-0.036437 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.5315651893615723
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.318 Vali Acc: 0.046 Test Loss: 3.318 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 0.4976663589477539
Epoch: 4, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.314 Vali Acc: 0.053 Test Loss: 3.314 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.4646282196044922
Epoch: 5, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.306 Vali Acc: 0.064 Test Loss: 3.306 Test Acc: 0.064
Validation loss decreased (-0.052908 --> -0.063496).  Saving model ...
Epoch: 6 cost time: 0.49266791343688965
Epoch: 6, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.298 Vali Acc: 0.085 Test Loss: 3.298 Test Acc: 0.085
Validation loss decreased (-0.063496 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.468717098236084
Epoch: 7, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.273 Vali Acc: 0.098 Test Loss: 3.273 Test Acc: 0.098
Validation loss decreased (-0.084673 --> -0.097614).  Saving model ...
Epoch: 8 cost time: 0.47870969772338867
Epoch: 8, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.240 Vali Acc: 0.118 Test Loss: 3.240 Test Acc: 0.118
Validation loss decreased (-0.097614 --> -0.117615).  Saving model ...
Epoch: 9 cost time: 0.49145078659057617
Epoch: 9, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.232 Vali Acc: 0.128 Test Loss: 3.232 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 0.50205397605896
Epoch: 10, Steps: 10 | Train Loss: 2.278 Vali Loss: 3.220 Vali Acc: 0.133 Test Loss: 3.220 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 11 cost time: 0.48963117599487305
Epoch: 11, Steps: 10 | Train Loss: 2.172 Vali Loss: 3.223 Vali Acc: 0.139 Test Loss: 3.223 Test Acc: 0.139
Validation loss decreased (-0.132909 --> -0.138791).  Saving model ...
Epoch: 12 cost time: 0.45508766174316406
Epoch: 12, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.217 Vali Acc: 0.147 Test Loss: 3.217 Test Acc: 0.147
Validation loss decreased (-0.138791 --> -0.147027).  Saving model ...
Epoch: 13 cost time: 0.4842219352722168
Epoch: 13, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.205 Vali Acc: 0.166 Test Loss: 3.205 Test Acc: 0.166
Validation loss decreased (-0.147027 --> -0.165850).  Saving model ...
Epoch: 14 cost time: 0.4767720699310303
Epoch: 14, Steps: 10 | Train Loss: 1.653 Vali Loss: 3.211 Vali Acc: 0.173 Test Loss: 3.211 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172909).  Saving model ...
Epoch: 15 cost time: 0.49857330322265625
Epoch: 15, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.225 Vali Acc: 0.180 Test Loss: 3.225 Test Acc: 0.180
Validation loss decreased (-0.172909 --> -0.179968).  Saving model ...
Epoch: 16 cost time: 0.514232873916626
Epoch: 16, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.248 Vali Acc: 0.188 Test Loss: 3.248 Test Acc: 0.188
Validation loss decreased (-0.179968 --> -0.188203).  Saving model ...
Epoch: 17 cost time: 0.5050060749053955
Epoch: 17, Steps: 10 | Train Loss: 1.266 Vali Loss: 3.265 Vali Acc: 0.193 Test Loss: 3.265 Test Acc: 0.193
Validation loss decreased (-0.188203 --> -0.192909).  Saving model ...
Epoch: 18 cost time: 0.4650239944458008
Epoch: 18, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.292 Vali Acc: 0.204 Test Loss: 3.292 Test Acc: 0.204
Validation loss decreased (-0.192909 --> -0.203496).  Saving model ...
Epoch: 19 cost time: 0.476931095123291
Epoch: 19, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.327 Vali Acc: 0.211 Test Loss: 3.327 Test Acc: 0.211
Validation loss decreased (-0.203496 --> -0.210555).  Saving model ...
Epoch: 20 cost time: 0.5349009037017822
Epoch: 20, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.339 Vali Acc: 0.213 Test Loss: 3.339 Test Acc: 0.213
Validation loss decreased (-0.210555 --> -0.212908).  Saving model ...
Epoch: 21 cost time: 0.49075984954833984
Epoch: 21, Steps: 10 | Train Loss: 0.803 Vali Loss: 3.388 Vali Acc: 0.211 Test Loss: 3.388 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4006044864654541
Epoch: 22, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.423 Vali Acc: 0.221 Test Loss: 3.423 Test Acc: 0.221
Validation loss decreased (-0.212908 --> -0.221142).  Saving model ...
Epoch: 23 cost time: 0.47586560249328613
Epoch: 23, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.472 Vali Acc: 0.229 Test Loss: 3.472 Test Acc: 0.229
Validation loss decreased (-0.221142 --> -0.229377).  Saving model ...
Epoch: 24 cost time: 0.5222039222717285
Epoch: 24, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.518 Vali Acc: 0.240 Test Loss: 3.518 Test Acc: 0.240
Validation loss decreased (-0.229377 --> -0.239965).  Saving model ...
Epoch: 25 cost time: 0.5225069522857666
Epoch: 25, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.560 Vali Acc: 0.244 Test Loss: 3.560 Test Acc: 0.244
Validation loss decreased (-0.239965 --> -0.243494).  Saving model ...
Epoch: 26 cost time: 0.47447776794433594
Epoch: 26, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.613 Vali Acc: 0.236 Test Loss: 3.613 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.48559045791625977
Epoch: 27, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.639 Vali Acc: 0.242 Test Loss: 3.639 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5032079219818115
Epoch: 28, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.683 Vali Acc: 0.245 Test Loss: 3.683 Test Acc: 0.245
Validation loss decreased (-0.243494 --> -0.244669).  Saving model ...
Epoch: 29 cost time: 0.5307118892669678
Epoch: 29, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.762 Vali Acc: 0.241 Test Loss: 3.762 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5320701599121094
Epoch: 30, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.795 Vali Acc: 0.249 Test Loss: 3.795 Test Acc: 0.249
Validation loss decreased (-0.244669 --> -0.249374).  Saving model ...
Epoch: 31 cost time: 0.4887115955352783
Epoch: 31, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.840 Vali Acc: 0.248 Test Loss: 3.840 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5392637252807617
Epoch: 32, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.891 Vali Acc: 0.244 Test Loss: 3.891 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5053613185882568
Epoch: 33, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.920 Vali Acc: 0.248 Test Loss: 3.920 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4902184009552002
Epoch: 34, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.947 Vali Acc: 0.254 Test Loss: 3.947 Test Acc: 0.254
Validation loss decreased (-0.249374 --> -0.254078).  Saving model ...
Epoch: 35 cost time: 0.5002717971801758
Epoch: 35, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.984 Vali Acc: 0.252 Test Loss: 3.984 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5070939064025879
Epoch: 36, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.015 Vali Acc: 0.254 Test Loss: 4.015 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5045912265777588
Epoch: 37, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.050 Vali Acc: 0.255 Test Loss: 4.050 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255254).  Saving model ...
Epoch: 38 cost time: 0.5401017665863037
Epoch: 38, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.085 Vali Acc: 0.245 Test Loss: 4.085 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49652862548828125
Epoch: 39, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.109 Vali Acc: 0.242 Test Loss: 4.109 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5095562934875488
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.123 Vali Acc: 0.245 Test Loss: 4.123 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.515131950378418
Epoch: 41, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.142 Vali Acc: 0.247 Test Loss: 4.142 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4729349613189697
Epoch: 42, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.165 Vali Acc: 0.255 Test Loss: 4.165 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5119462013244629
Epoch: 43, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.217 Vali Acc: 0.258 Test Loss: 4.217 Test Acc: 0.258
Validation loss decreased (-0.255254 --> -0.257605).  Saving model ...
Epoch: 44 cost time: 0.5414021015167236
Epoch: 44, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.246 Vali Acc: 0.254 Test Loss: 4.246 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5181570053100586
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.261 Vali Acc: 0.249 Test Loss: 4.261 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.519099235534668
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.274 Vali Acc: 0.248 Test Loss: 4.274 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5241966247558594
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.284 Vali Acc: 0.248 Test Loss: 4.284 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5269224643707275
Epoch: 48, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.301 Vali Acc: 0.246 Test Loss: 4.301 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.49401402473449707
Epoch: 49, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.313 Vali Acc: 0.249 Test Loss: 4.313 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5180296897888184
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.340 Vali Acc: 0.252 Test Loss: 4.340 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5018026828765869
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.358 Vali Acc: 0.248 Test Loss: 4.358 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.49346256256103516
Epoch: 52, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.388 Vali Acc: 0.248 Test Loss: 4.388 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.463057279586792
Epoch: 53, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.422 Vali Acc: 0.253 Test Loss: 4.422 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 54170
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5737512111663818
Epoch: 1, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.413 Vali Acc: 0.035 Test Loss: 3.413 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 0.4949789047241211
Epoch: 2, Steps: 10 | Train Loss: 3.418 Vali Loss: 3.370 Vali Acc: 0.040 Test Loss: 3.370 Test Acc: 0.040
Validation loss decreased (-0.035260 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.5131537914276123
Epoch: 3, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.345 Vali Acc: 0.032 Test Loss: 3.345 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4475243091583252
Epoch: 4, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.335 Vali Acc: 0.046 Test Loss: 3.335 Test Acc: 0.046
Validation loss decreased (-0.039966 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 0.49153852462768555
Epoch: 5, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.337 Vali Acc: 0.055 Test Loss: 3.337 Test Acc: 0.055
Validation loss decreased (-0.045849 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.5204730033874512
Epoch: 6, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.341 Vali Acc: 0.059 Test Loss: 3.341 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 7 cost time: 0.4626777172088623
Epoch: 7, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.342 Vali Acc: 0.068 Test Loss: 3.342 Test Acc: 0.068
Validation loss decreased (-0.058790 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 0.48157238960266113
Epoch: 8, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.324 Vali Acc: 0.081 Test Loss: 3.324 Test Acc: 0.081
Validation loss decreased (-0.068202 --> -0.081143).  Saving model ...
Epoch: 9 cost time: 0.49645280838012695
Epoch: 9, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.307 Vali Acc: 0.082 Test Loss: 3.307 Test Acc: 0.082
Validation loss decreased (-0.081143 --> -0.082320).  Saving model ...
Epoch: 10 cost time: 0.5854570865631104
Epoch: 10, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.296 Vali Acc: 0.096 Test Loss: 3.296 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.47223687171936035
Epoch: 11, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.272 Vali Acc: 0.102 Test Loss: 3.272 Test Acc: 0.102
Validation loss decreased (-0.096438 --> -0.102320).  Saving model ...
Epoch: 12 cost time: 0.5093638896942139
Epoch: 12, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.262 Vali Acc: 0.113 Test Loss: 3.262 Test Acc: 0.113
Validation loss decreased (-0.102320 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.4799017906188965
Epoch: 13, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.243 Vali Acc: 0.124 Test Loss: 3.243 Test Acc: 0.124
Validation loss decreased (-0.112909 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 0.47473931312561035
Epoch: 14, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.242 Vali Acc: 0.128 Test Loss: 3.242 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 0.4340250492095947
Epoch: 15, Steps: 10 | Train Loss: 1.961 Vali Loss: 3.249 Vali Acc: 0.133 Test Loss: 3.249 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.5314962863922119
Epoch: 16, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.236 Vali Acc: 0.147 Test Loss: 3.236 Test Acc: 0.147
Validation loss decreased (-0.132909 --> -0.147026).  Saving model ...
Epoch: 17 cost time: 0.5714256763458252
Epoch: 17, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.234 Vali Acc: 0.159 Test Loss: 3.234 Test Acc: 0.159
Validation loss decreased (-0.147026 --> -0.158791).  Saving model ...
Epoch: 18 cost time: 0.5369017124176025
Epoch: 18, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.240 Vali Acc: 0.172 Test Loss: 3.240 Test Acc: 0.172
Validation loss decreased (-0.158791 --> -0.171732).  Saving model ...
Epoch: 19 cost time: 0.5184481143951416
Epoch: 19, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.246 Vali Acc: 0.184 Test Loss: 3.246 Test Acc: 0.184
Validation loss decreased (-0.171732 --> -0.183497).  Saving model ...
Epoch: 20 cost time: 0.48775267601013184
Epoch: 20, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.251 Vali Acc: 0.193 Test Loss: 3.251 Test Acc: 0.193
Validation loss decreased (-0.183497 --> -0.192909).  Saving model ...
Epoch: 21 cost time: 0.5352632999420166
Epoch: 21, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.259 Vali Acc: 0.196 Test Loss: 3.259 Test Acc: 0.196
Validation loss decreased (-0.192909 --> -0.196438).  Saving model ...
Epoch: 22 cost time: 0.49813055992126465
Epoch: 22, Steps: 10 | Train Loss: 1.106 Vali Loss: 3.275 Vali Acc: 0.212 Test Loss: 3.275 Test Acc: 0.212
Validation loss decreased (-0.196438 --> -0.211732).  Saving model ...
Epoch: 23 cost time: 0.46450257301330566
Epoch: 23, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.296 Vali Acc: 0.211 Test Loss: 3.296 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.48053812980651855
Epoch: 24, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.323 Vali Acc: 0.214 Test Loss: 3.323 Test Acc: 0.214
Validation loss decreased (-0.211732 --> -0.214084).  Saving model ...
Epoch: 25 cost time: 0.4523448944091797
Epoch: 25, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.346 Vali Acc: 0.211 Test Loss: 3.346 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.46266794204711914
Epoch: 26, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.374 Vali Acc: 0.207 Test Loss: 3.374 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.45273661613464355
Epoch: 27, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.399 Vali Acc: 0.221 Test Loss: 3.399 Test Acc: 0.221
Validation loss decreased (-0.214084 --> -0.221142).  Saving model ...
Epoch: 28 cost time: 0.46527647972106934
Epoch: 28, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.433 Vali Acc: 0.224 Test Loss: 3.433 Test Acc: 0.224
Validation loss decreased (-0.221142 --> -0.223495).  Saving model ...
Epoch: 29 cost time: 0.4720137119293213
Epoch: 29, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.468 Vali Acc: 0.224 Test Loss: 3.468 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.47112250328063965
Epoch: 30, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.484 Vali Acc: 0.218 Test Loss: 3.484 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4641866683959961
Epoch: 31, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.523 Vali Acc: 0.220 Test Loss: 3.523 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.43822741508483887
Epoch: 32, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.574 Vali Acc: 0.222 Test Loss: 3.574 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.42685937881469727
Epoch: 33, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.607 Vali Acc: 0.220 Test Loss: 3.607 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.45871782302856445
Epoch: 34, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.640 Vali Acc: 0.225 Test Loss: 3.640 Test Acc: 0.225
Validation loss decreased (-0.223495 --> -0.224669).  Saving model ...
Epoch: 35 cost time: 0.43492794036865234
Epoch: 35, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.652 Vali Acc: 0.234 Test Loss: 3.652 Test Acc: 0.234
Validation loss decreased (-0.224669 --> -0.234081).  Saving model ...
Epoch: 36 cost time: 0.5193071365356445
Epoch: 36, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.685 Vali Acc: 0.229 Test Loss: 3.685 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48979878425598145
Epoch: 37, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.682 Vali Acc: 0.233 Test Loss: 3.682 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4963212013244629
Epoch: 38, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.737 Vali Acc: 0.233 Test Loss: 3.737 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.5378575325012207
Epoch: 39, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.763 Vali Acc: 0.231 Test Loss: 3.763 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.47376322746276855
Epoch: 40, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.781 Vali Acc: 0.228 Test Loss: 3.781 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5139694213867188
Epoch: 41, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.804 Vali Acc: 0.228 Test Loss: 3.804 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.49509096145629883
Epoch: 42, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.823 Vali Acc: 0.231 Test Loss: 3.823 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5164699554443359
Epoch: 43, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.856 Vali Acc: 0.234 Test Loss: 3.856 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.49590086936950684
Epoch: 44, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.883 Vali Acc: 0.232 Test Loss: 3.883 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.50685715675354
Epoch: 45, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.897 Vali Acc: 0.233 Test Loss: 3.897 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23411764705882354
model parameter : 38010
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5415256023406982
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.398 Vali Acc: 0.036 Test Loss: 3.398 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.45681142807006836
Epoch: 2, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.374 Vali Acc: 0.046 Test Loss: 3.374 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.5372314453125
Epoch: 3, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.354 Vali Acc: 0.051 Test Loss: 3.354 Test Acc: 0.051
Validation loss decreased (-0.045849 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.5675764083862305
Epoch: 4, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.342 Vali Acc: 0.055 Test Loss: 3.342 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.5228629112243652
Epoch: 5, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.331 Vali Acc: 0.060 Test Loss: 3.331 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.5523324012756348
Epoch: 6, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.319 Vali Acc: 0.067 Test Loss: 3.319 Test Acc: 0.067
Validation loss decreased (-0.059967 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.5363631248474121
Epoch: 7, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.311 Vali Acc: 0.075 Test Loss: 3.311 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.5527706146240234
Epoch: 8, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.308 Vali Acc: 0.085 Test Loss: 3.308 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 0.49156904220581055
Epoch: 9, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.297 Vali Acc: 0.101 Test Loss: 3.297 Test Acc: 0.101
Validation loss decreased (-0.084673 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.5613315105438232
Epoch: 10, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.290 Vali Acc: 0.107 Test Loss: 3.290 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107026).  Saving model ...
Epoch: 11 cost time: 0.5099709033966064
Epoch: 11, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.279 Vali Acc: 0.115 Test Loss: 3.279 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115261).  Saving model ...
Epoch: 12 cost time: 0.49474120140075684
Epoch: 12, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.271 Vali Acc: 0.126 Test Loss: 3.271 Test Acc: 0.126
Validation loss decreased (-0.115261 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.4625051021575928
Epoch: 13, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.262 Vali Acc: 0.128 Test Loss: 3.262 Test Acc: 0.128
Validation loss decreased (-0.125850 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.46337032318115234
Epoch: 14, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.260 Vali Acc: 0.129 Test Loss: 3.260 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 15 cost time: 0.5525963306427002
Epoch: 15, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.250 Vali Acc: 0.135 Test Loss: 3.250 Test Acc: 0.135
Validation loss decreased (-0.129379 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 0.4686422348022461
Epoch: 16, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.247 Vali Acc: 0.152 Test Loss: 3.247 Test Acc: 0.152
Validation loss decreased (-0.135262 --> -0.151732).  Saving model ...
Epoch: 17 cost time: 0.5543553829193115
Epoch: 17, Steps: 10 | Train Loss: 1.971 Vali Loss: 3.247 Vali Acc: 0.160 Test Loss: 3.247 Test Acc: 0.160
Validation loss decreased (-0.151732 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.5245833396911621
Epoch: 18, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.246 Vali Acc: 0.171 Test Loss: 3.246 Test Acc: 0.171
Validation loss decreased (-0.159968 --> -0.170556).  Saving model ...
Epoch: 19 cost time: 0.5189242362976074
Epoch: 19, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.246 Vali Acc: 0.175 Test Loss: 3.246 Test Acc: 0.175
Validation loss decreased (-0.170556 --> -0.175262).  Saving model ...
Epoch: 20 cost time: 0.5214102268218994
Epoch: 20, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.244 Vali Acc: 0.179 Test Loss: 3.244 Test Acc: 0.179
Validation loss decreased (-0.175262 --> -0.178791).  Saving model ...
Epoch: 21 cost time: 0.5138022899627686
Epoch: 21, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.251 Vali Acc: 0.184 Test Loss: 3.251 Test Acc: 0.184
Validation loss decreased (-0.178791 --> -0.183497).  Saving model ...
Epoch: 22 cost time: 0.5609550476074219
Epoch: 22, Steps: 10 | Train Loss: 1.458 Vali Loss: 3.255 Vali Acc: 0.195 Test Loss: 3.255 Test Acc: 0.195
Validation loss decreased (-0.183497 --> -0.195262).  Saving model ...
Epoch: 23 cost time: 0.5431721210479736
Epoch: 23, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.263 Vali Acc: 0.195 Test Loss: 3.263 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.51694655418396
Epoch: 24, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.285 Vali Acc: 0.198 Test Loss: 3.285 Test Acc: 0.198
Validation loss decreased (-0.195262 --> -0.197614).  Saving model ...
Epoch: 25 cost time: 0.47055840492248535
Epoch: 25, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.294 Vali Acc: 0.208 Test Loss: 3.294 Test Acc: 0.208
Validation loss decreased (-0.197614 --> -0.208202).  Saving model ...
Epoch: 26 cost time: 0.5880873203277588
Epoch: 26, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.308 Vali Acc: 0.204 Test Loss: 3.308 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.494844913482666
Epoch: 27, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.335 Vali Acc: 0.207 Test Loss: 3.335 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6196184158325195
Epoch: 28, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.353 Vali Acc: 0.212 Test Loss: 3.353 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211731).  Saving model ...
Epoch: 29 cost time: 0.516770601272583
Epoch: 29, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.363 Vali Acc: 0.212 Test Loss: 3.363 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5184605121612549
Epoch: 30, Steps: 10 | Train Loss: 0.789 Vali Loss: 3.385 Vali Acc: 0.225 Test Loss: 3.385 Test Acc: 0.225
Validation loss decreased (-0.211731 --> -0.224672).  Saving model ...
Epoch: 31 cost time: 0.5097479820251465
Epoch: 31, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.410 Vali Acc: 0.231 Test Loss: 3.410 Test Acc: 0.231
Validation loss decreased (-0.224672 --> -0.230554).  Saving model ...
Epoch: 32 cost time: 0.5535497665405273
Epoch: 32, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.436 Vali Acc: 0.229 Test Loss: 3.436 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5045454502105713
Epoch: 33, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.456 Vali Acc: 0.235 Test Loss: 3.456 Test Acc: 0.235
Validation loss decreased (-0.230554 --> -0.235260).  Saving model ...
Epoch: 34 cost time: 0.5295796394348145
Epoch: 34, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.470 Vali Acc: 0.242 Test Loss: 3.470 Test Acc: 0.242
Validation loss decreased (-0.235260 --> -0.242318).  Saving model ...
Epoch: 35 cost time: 0.5393764972686768
Epoch: 35, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.506 Vali Acc: 0.242 Test Loss: 3.506 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5223653316497803
Epoch: 36, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.529 Vali Acc: 0.244 Test Loss: 3.529 Test Acc: 0.244
Validation loss decreased (-0.242318 --> -0.243494).  Saving model ...
Epoch: 37 cost time: 0.4709620475769043
Epoch: 37, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.544 Vali Acc: 0.241 Test Loss: 3.544 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5790197849273682
Epoch: 38, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.566 Vali Acc: 0.244 Test Loss: 3.566 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5285677909851074
Epoch: 39, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.604 Vali Acc: 0.248 Test Loss: 3.604 Test Acc: 0.248
Validation loss decreased (-0.243494 --> -0.248199).  Saving model ...
Epoch: 40 cost time: 0.48514294624328613
Epoch: 40, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.640 Vali Acc: 0.249 Test Loss: 3.640 Test Acc: 0.249
Validation loss decreased (-0.248199 --> -0.249375).  Saving model ...
Epoch: 41 cost time: 0.5375881195068359
Epoch: 41, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.674 Vali Acc: 0.254 Test Loss: 3.674 Test Acc: 0.254
Validation loss decreased (-0.249375 --> -0.254081).  Saving model ...
Epoch: 42 cost time: 0.5257298946380615
Epoch: 42, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.701 Vali Acc: 0.251 Test Loss: 3.701 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5464756488800049
Epoch: 43, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.729 Vali Acc: 0.246 Test Loss: 3.729 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.488173246383667
Epoch: 44, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.750 Vali Acc: 0.242 Test Loss: 3.750 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5394129753112793
Epoch: 45, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.767 Vali Acc: 0.249 Test Loss: 3.767 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5183520317077637
Epoch: 46, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.781 Vali Acc: 0.255 Test Loss: 3.781 Test Acc: 0.255
Validation loss decreased (-0.254081 --> -0.255256).  Saving model ...
Epoch: 47 cost time: 0.5336403846740723
Epoch: 47, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.800 Vali Acc: 0.251 Test Loss: 3.800 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5120944976806641
Epoch: 48, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.822 Vali Acc: 0.248 Test Loss: 3.822 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5140962600708008
Epoch: 49, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.836 Vali Acc: 0.259 Test Loss: 3.836 Test Acc: 0.259
Validation loss decreased (-0.255256 --> -0.258785).  Saving model ...
Epoch: 50 cost time: 0.4940347671508789
Epoch: 50, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.876 Vali Acc: 0.260 Test Loss: 3.876 Test Acc: 0.260
Validation loss decreased (-0.258785 --> -0.259961).  Saving model ...
Epoch: 51 cost time: 0.5167367458343506
Epoch: 51, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.909 Vali Acc: 0.260 Test Loss: 3.909 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5050883293151855
Epoch: 52, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.932 Vali Acc: 0.261 Test Loss: 3.932 Test Acc: 0.261
Validation loss decreased (-0.259961 --> -0.261137).  Saving model ...
Epoch: 53 cost time: 0.5113925933837891
Epoch: 53, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.926 Vali Acc: 0.261 Test Loss: 3.926 Test Acc: 0.261
Validation loss decreased (-0.261137 --> -0.261137).  Saving model ...
Epoch: 54 cost time: 0.4997255802154541
Epoch: 54, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.932 Vali Acc: 0.260 Test Loss: 3.932 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5775954723358154
Epoch: 55, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.946 Vali Acc: 0.262 Test Loss: 3.946 Test Acc: 0.262
Validation loss decreased (-0.261137 --> -0.262313).  Saving model ...
Epoch: 56 cost time: 0.5346386432647705
Epoch: 56, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.968 Vali Acc: 0.264 Test Loss: 3.968 Test Acc: 0.264
Validation loss decreased (-0.262313 --> -0.263490).  Saving model ...
Epoch: 57 cost time: 0.5471971035003662
Epoch: 57, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.998 Vali Acc: 0.256 Test Loss: 3.998 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5399408340454102
Epoch: 58, Steps: 10 | Train Loss: 0.102 Vali Loss: 4.020 Vali Acc: 0.262 Test Loss: 4.020 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5215282440185547
Epoch: 59, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.050 Vali Acc: 0.260 Test Loss: 4.050 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5751540660858154
Epoch: 60, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.054 Vali Acc: 0.258 Test Loss: 4.054 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5090188980102539
Epoch: 61, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.065 Vali Acc: 0.261 Test Loss: 4.065 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5031483173370361
Epoch: 62, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.080 Vali Acc: 0.261 Test Loss: 4.080 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5329060554504395
Epoch: 63, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.109 Vali Acc: 0.265 Test Loss: 4.109 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264665).  Saving model ...
Epoch: 64 cost time: 0.5481798648834229
Epoch: 64, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.127 Vali Acc: 0.266 Test Loss: 4.127 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265841).  Saving model ...
Epoch: 65 cost time: 0.5868513584136963
Epoch: 65, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.143 Vali Acc: 0.269 Test Loss: 4.143 Test Acc: 0.269
Validation loss decreased (-0.265841 --> -0.269370).  Saving model ...
Epoch: 66 cost time: 0.5318429470062256
Epoch: 66, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.150 Vali Acc: 0.267 Test Loss: 4.150 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5312378406524658
Epoch: 67, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.150 Vali Acc: 0.264 Test Loss: 4.150 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5411126613616943
Epoch: 68, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.165 Vali Acc: 0.262 Test Loss: 4.165 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5359642505645752
Epoch: 69, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.188 Vali Acc: 0.264 Test Loss: 4.188 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.5298869609832764
Epoch: 70, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.199 Vali Acc: 0.262 Test Loss: 4.199 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.5240559577941895
Epoch: 71, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.216 Vali Acc: 0.262 Test Loss: 4.216 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5645804405212402
Epoch: 72, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.237 Vali Acc: 0.266 Test Loss: 4.237 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5270116329193115
Epoch: 73, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.236 Vali Acc: 0.262 Test Loss: 4.236 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.5165865421295166
Epoch: 74, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.247 Vali Acc: 0.266 Test Loss: 4.247 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.5757055282592773
Epoch: 75, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.255 Vali Acc: 0.266 Test Loss: 4.255 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 30586
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5247371196746826
Epoch: 1, Steps: 10 | Train Loss: 3.526 Vali Loss: 3.391 Vali Acc: 0.027 Test Loss: 3.391 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.4981193542480469
Epoch: 2, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.376 Vali Acc: 0.026 Test Loss: 3.376 Test Acc: 0.026
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4970247745513916
Epoch: 3, Steps: 10 | Train Loss: 3.449 Vali Loss: 3.368 Vali Acc: 0.031 Test Loss: 3.368 Test Acc: 0.031
Validation loss decreased (-0.027025 --> -0.030555).  Saving model ...
Epoch: 4 cost time: 0.47156214714050293
Epoch: 4, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.362 Vali Acc: 0.033 Test Loss: 3.362 Test Acc: 0.033
Validation loss decreased (-0.030555 --> -0.032908).  Saving model ...
Epoch: 5 cost time: 0.46245741844177246
Epoch: 5, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.351 Vali Acc: 0.038 Test Loss: 3.351 Test Acc: 0.038
Validation loss decreased (-0.032908 --> -0.037614).  Saving model ...
Epoch: 6 cost time: 0.46514892578125
Epoch: 6, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.342 Vali Acc: 0.044 Test Loss: 3.342 Test Acc: 0.044
Validation loss decreased (-0.037614 --> -0.043496).  Saving model ...
Epoch: 7 cost time: 0.4718925952911377
Epoch: 7, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.337 Vali Acc: 0.044 Test Loss: 3.337 Test Acc: 0.044
Validation loss decreased (-0.043496 --> -0.043496).  Saving model ...
Epoch: 8 cost time: 0.582486629486084
Epoch: 8, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.333 Vali Acc: 0.055 Test Loss: 3.333 Test Acc: 0.055
Validation loss decreased (-0.043496 --> -0.055261).  Saving model ...
Epoch: 9 cost time: 0.46471309661865234
Epoch: 9, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.331 Vali Acc: 0.062 Test Loss: 3.331 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 10 cost time: 0.4145679473876953
Epoch: 10, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.328 Vali Acc: 0.067 Test Loss: 3.328 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 11 cost time: 0.4267585277557373
Epoch: 11, Steps: 10 | Train Loss: 2.888 Vali Loss: 3.328 Vali Acc: 0.067 Test Loss: 3.328 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4608490467071533
Epoch: 12, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.324 Vali Acc: 0.076 Test Loss: 3.324 Test Acc: 0.076
Validation loss decreased (-0.067026 --> -0.076437).  Saving model ...
Epoch: 13 cost time: 0.42317843437194824
Epoch: 13, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.318 Vali Acc: 0.079 Test Loss: 3.318 Test Acc: 0.079
Validation loss decreased (-0.076437 --> -0.078790).  Saving model ...
Epoch: 14 cost time: 0.4544694423675537
Epoch: 14, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.309 Vali Acc: 0.086 Test Loss: 3.309 Test Acc: 0.086
Validation loss decreased (-0.078790 --> -0.085849).  Saving model ...
Epoch: 15 cost time: 0.4241652488708496
Epoch: 15, Steps: 10 | Train Loss: 2.547 Vali Loss: 3.301 Vali Acc: 0.085 Test Loss: 3.301 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43767476081848145
Epoch: 16, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.293 Vali Acc: 0.093 Test Loss: 3.293 Test Acc: 0.093
Validation loss decreased (-0.085849 --> -0.092908).  Saving model ...
Epoch: 17 cost time: 0.43863701820373535
Epoch: 17, Steps: 10 | Train Loss: 2.485 Vali Loss: 3.288 Vali Acc: 0.106 Test Loss: 3.288 Test Acc: 0.106
Validation loss decreased (-0.092908 --> -0.105849).  Saving model ...
Epoch: 18 cost time: 0.4438505172729492
Epoch: 18, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.278 Vali Acc: 0.104 Test Loss: 3.278 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4201817512512207
Epoch: 19, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.278 Vali Acc: 0.114 Test Loss: 3.278 Test Acc: 0.114
Validation loss decreased (-0.105849 --> -0.114085).  Saving model ...
Epoch: 20 cost time: 0.4737067222595215
Epoch: 20, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.275 Vali Acc: 0.124 Test Loss: 3.275 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123497).  Saving model ...
Epoch: 21 cost time: 0.4742436408996582
Epoch: 21, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.270 Vali Acc: 0.124 Test Loss: 3.270 Test Acc: 0.124
Validation loss decreased (-0.123497 --> -0.123497).  Saving model ...
Epoch: 22 cost time: 0.5059871673583984
Epoch: 22, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.264 Vali Acc: 0.128 Test Loss: 3.264 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 23 cost time: 0.455890417098999
Epoch: 23, Steps: 10 | Train Loss: 1.873 Vali Loss: 3.259 Vali Acc: 0.135 Test Loss: 3.259 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 24 cost time: 0.5060851573944092
Epoch: 24, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.263 Vali Acc: 0.136 Test Loss: 3.263 Test Acc: 0.136
Validation loss decreased (-0.135262 --> -0.136438).  Saving model ...
Epoch: 25 cost time: 0.49262452125549316
Epoch: 25, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.266 Vali Acc: 0.145 Test Loss: 3.266 Test Acc: 0.145
Validation loss decreased (-0.136438 --> -0.144673).  Saving model ...
Epoch: 26 cost time: 0.5321426391601562
Epoch: 26, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.273 Vali Acc: 0.147 Test Loss: 3.273 Test Acc: 0.147
Validation loss decreased (-0.144673 --> -0.147026).  Saving model ...
Epoch: 27 cost time: 0.5209672451019287
Epoch: 27, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.279 Vali Acc: 0.151 Test Loss: 3.279 Test Acc: 0.151
Validation loss decreased (-0.147026 --> -0.150555).  Saving model ...
Epoch: 28 cost time: 0.5223140716552734
Epoch: 28, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.284 Vali Acc: 0.161 Test Loss: 3.284 Test Acc: 0.161
Validation loss decreased (-0.150555 --> -0.161144).  Saving model ...
Epoch: 29 cost time: 0.5301492214202881
Epoch: 29, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.287 Vali Acc: 0.164 Test Loss: 3.287 Test Acc: 0.164
Validation loss decreased (-0.161144 --> -0.163497).  Saving model ...
Epoch: 30 cost time: 0.5165610313415527
Epoch: 30, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.293 Vali Acc: 0.169 Test Loss: 3.293 Test Acc: 0.169
Validation loss decreased (-0.163497 --> -0.169379).  Saving model ...
Epoch: 31 cost time: 0.513824462890625
Epoch: 31, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.304 Vali Acc: 0.171 Test Loss: 3.304 Test Acc: 0.171
Validation loss decreased (-0.169379 --> -0.170555).  Saving model ...
Epoch: 32 cost time: 0.518451452255249
Epoch: 32, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.319 Vali Acc: 0.172 Test Loss: 3.319 Test Acc: 0.172
Validation loss decreased (-0.170555 --> -0.171732).  Saving model ...
Epoch: 33 cost time: 0.4699976444244385
Epoch: 33, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.326 Vali Acc: 0.174 Test Loss: 3.326 Test Acc: 0.174
Validation loss decreased (-0.171732 --> -0.174084).  Saving model ...
Epoch: 34 cost time: 0.5006968975067139
Epoch: 34, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.333 Vali Acc: 0.179 Test Loss: 3.333 Test Acc: 0.179
Validation loss decreased (-0.174084 --> -0.178790).  Saving model ...
Epoch: 35 cost time: 0.4979593753814697
Epoch: 35, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.345 Vali Acc: 0.187 Test Loss: 3.345 Test Acc: 0.187
Validation loss decreased (-0.178790 --> -0.187025).  Saving model ...
Epoch: 36 cost time: 0.5237879753112793
Epoch: 36, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.356 Vali Acc: 0.192 Test Loss: 3.356 Test Acc: 0.192
Validation loss decreased (-0.187025 --> -0.191731).  Saving model ...
Epoch: 37 cost time: 0.5023374557495117
Epoch: 37, Steps: 10 | Train Loss: 0.898 Vali Loss: 3.375 Vali Acc: 0.193 Test Loss: 3.375 Test Acc: 0.193
Validation loss decreased (-0.191731 --> -0.192907).  Saving model ...
Epoch: 38 cost time: 0.5382988452911377
Epoch: 38, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.396 Vali Acc: 0.191 Test Loss: 3.396 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.48241758346557617
Epoch: 39, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.412 Vali Acc: 0.196 Test Loss: 3.412 Test Acc: 0.196
Validation loss decreased (-0.192907 --> -0.196436).  Saving model ...
Epoch: 40 cost time: 0.4999382495880127
Epoch: 40, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.430 Vali Acc: 0.202 Test Loss: 3.430 Test Acc: 0.202
Validation loss decreased (-0.196436 --> -0.202319).  Saving model ...
Epoch: 41 cost time: 0.4747636318206787
Epoch: 41, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.449 Vali Acc: 0.201 Test Loss: 3.449 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.48189806938171387
Epoch: 42, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.452 Vali Acc: 0.202 Test Loss: 3.452 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5006718635559082
Epoch: 43, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.479 Vali Acc: 0.202 Test Loss: 3.479 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.4984116554260254
Epoch: 44, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.498 Vali Acc: 0.205 Test Loss: 3.498 Test Acc: 0.205
Validation loss decreased (-0.202319 --> -0.204671).  Saving model ...
Epoch: 45 cost time: 0.5581145286560059
Epoch: 45, Steps: 10 | Train Loss: 0.526 Vali Loss: 3.511 Vali Acc: 0.206 Test Loss: 3.511 Test Acc: 0.206
Validation loss decreased (-0.204671 --> -0.205847).  Saving model ...
Epoch: 46 cost time: 0.5300822257995605
Epoch: 46, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.524 Vali Acc: 0.208 Test Loss: 3.524 Test Acc: 0.208
Validation loss decreased (-0.205847 --> -0.208200).  Saving model ...
Epoch: 47 cost time: 0.4856903553009033
Epoch: 47, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.551 Vali Acc: 0.207 Test Loss: 3.551 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.48035717010498047
Epoch: 48, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.582 Vali Acc: 0.206 Test Loss: 3.582 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4579195976257324
Epoch: 49, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.596 Vali Acc: 0.207 Test Loss: 3.596 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5321905612945557
Epoch: 50, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.607 Vali Acc: 0.207 Test Loss: 3.607 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5018398761749268
Epoch: 51, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.626 Vali Acc: 0.215 Test Loss: 3.626 Test Acc: 0.215
Validation loss decreased (-0.208200 --> -0.215258).  Saving model ...
Epoch: 52 cost time: 0.4931333065032959
Epoch: 52, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.630 Vali Acc: 0.211 Test Loss: 3.630 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4812791347503662
Epoch: 53, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.646 Vali Acc: 0.214 Test Loss: 3.646 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5046730041503906
Epoch: 54, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.673 Vali Acc: 0.216 Test Loss: 3.673 Test Acc: 0.216
Validation loss decreased (-0.215258 --> -0.216434).  Saving model ...
Epoch: 55 cost time: 0.4308168888092041
Epoch: 55, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.692 Vali Acc: 0.220 Test Loss: 3.692 Test Acc: 0.220
Validation loss decreased (-0.216434 --> -0.219963).  Saving model ...
Epoch: 56 cost time: 0.48955488204956055
Epoch: 56, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.716 Vali Acc: 0.215 Test Loss: 3.716 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.48566341400146484
Epoch: 57, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.719 Vali Acc: 0.220 Test Loss: 3.719 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4071645736694336
Epoch: 58, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.757 Vali Acc: 0.216 Test Loss: 3.757 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.47986602783203125
Epoch: 59, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.773 Vali Acc: 0.219 Test Loss: 3.773 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5295054912567139
Epoch: 60, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.783 Vali Acc: 0.216 Test Loss: 3.783 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5298612117767334
Epoch: 61, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.806 Vali Acc: 0.221 Test Loss: 3.806 Test Acc: 0.221
Validation loss decreased (-0.219963 --> -0.221138).  Saving model ...
Epoch: 62 cost time: 0.489471435546875
Epoch: 62, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.822 Vali Acc: 0.218 Test Loss: 3.822 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5456902980804443
Epoch: 63, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.839 Vali Acc: 0.222 Test Loss: 3.839 Test Acc: 0.222
Validation loss decreased (-0.221138 --> -0.222315).  Saving model ...
Epoch: 64 cost time: 0.514385461807251
Epoch: 64, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.854 Vali Acc: 0.221 Test Loss: 3.854 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.4742906093597412
Epoch: 65, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.867 Vali Acc: 0.224 Test Loss: 3.867 Test Acc: 0.224
Validation loss decreased (-0.222315 --> -0.223491).  Saving model ...
Epoch: 66 cost time: 0.5127432346343994
Epoch: 66, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.863 Vali Acc: 0.224 Test Loss: 3.863 Test Acc: 0.224
Validation loss decreased (-0.223491 --> -0.223491).  Saving model ...
Epoch: 67 cost time: 0.5166952610015869
Epoch: 67, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.874 Vali Acc: 0.222 Test Loss: 3.874 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.48757171630859375
Epoch: 68, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.906 Vali Acc: 0.226 Test Loss: 3.906 Test Acc: 0.226
Validation loss decreased (-0.223491 --> -0.225843).  Saving model ...
Epoch: 69 cost time: 0.5726244449615479
Epoch: 69, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.918 Vali Acc: 0.219 Test Loss: 3.918 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5188617706298828
Epoch: 70, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.925 Vali Acc: 0.221 Test Loss: 3.925 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5125627517700195
Epoch: 71, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.942 Vali Acc: 0.216 Test Loss: 3.942 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5490508079528809
Epoch: 72, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.953 Vali Acc: 0.218 Test Loss: 3.953 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.4819207191467285
Epoch: 73, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.974 Vali Acc: 0.221 Test Loss: 3.974 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5336148738861084
Epoch: 74, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.005 Vali Acc: 0.222 Test Loss: 4.005 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5582201480865479
Epoch: 75, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.003 Vali Acc: 0.227 Test Loss: 4.003 Test Acc: 0.227
Validation loss decreased (-0.225843 --> -0.227019).  Saving model ...
Epoch: 76 cost time: 0.5498602390289307
Epoch: 76, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.023 Vali Acc: 0.231 Test Loss: 4.023 Test Acc: 0.231
Validation loss decreased (-0.227019 --> -0.230548).  Saving model ...
Epoch: 77 cost time: 0.4969296455383301
Epoch: 77, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.027 Vali Acc: 0.233 Test Loss: 4.027 Test Acc: 0.233
Validation loss decreased (-0.230548 --> -0.232901).  Saving model ...
Epoch: 78 cost time: 0.48093175888061523
Epoch: 78, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.024 Vali Acc: 0.234 Test Loss: 4.024 Test Acc: 0.234
Validation loss decreased (-0.232901 --> -0.234077).  Saving model ...
Epoch: 79 cost time: 0.507347822189331
Epoch: 79, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.038 Vali Acc: 0.232 Test Loss: 4.038 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.4417750835418701
Epoch: 80, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.042 Vali Acc: 0.229 Test Loss: 4.042 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.45618438720703125
Epoch: 81, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.060 Vali Acc: 0.227 Test Loss: 4.060 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.4804675579071045
Epoch: 82, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.090 Vali Acc: 0.232 Test Loss: 4.090 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.4655942916870117
Epoch: 83, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.100 Vali Acc: 0.240 Test Loss: 4.100 Test Acc: 0.240
Validation loss decreased (-0.234077 --> -0.239959).  Saving model ...
Epoch: 84 cost time: 0.5167694091796875
Epoch: 84, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.099 Vali Acc: 0.240 Test Loss: 4.099 Test Acc: 0.240
Validation loss decreased (-0.239959 --> -0.239959).  Saving model ...
Epoch: 85 cost time: 0.4564704895019531
Epoch: 85, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.127 Vali Acc: 0.241 Test Loss: 4.127 Test Acc: 0.241
Validation loss decreased (-0.239959 --> -0.241135).  Saving model ...
Epoch: 86 cost time: 0.5192265510559082
Epoch: 86, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.151 Vali Acc: 0.238 Test Loss: 4.151 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.5675175189971924
Epoch: 87, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.145 Vali Acc: 0.232 Test Loss: 4.145 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.4763052463531494
Epoch: 88, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.151 Vali Acc: 0.234 Test Loss: 4.151 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.5269200801849365
Epoch: 89, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.164 Vali Acc: 0.233 Test Loss: 4.164 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.4718630313873291
Epoch: 90, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.173 Vali Acc: 0.235 Test Loss: 4.173 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.5353188514709473
Epoch: 91, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.188 Vali Acc: 0.232 Test Loss: 4.188 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.4881293773651123
Epoch: 92, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.192 Vali Acc: 0.234 Test Loss: 4.192 Test Acc: 0.234
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.5383167266845703
Epoch: 93, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.193 Vali Acc: 0.242 Test Loss: 4.193 Test Acc: 0.242
Validation loss decreased (-0.241135 --> -0.242311).  Saving model ...
Epoch: 94 cost time: 0.49749159812927246
Epoch: 94, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.219 Vali Acc: 0.238 Test Loss: 4.219 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5573320388793945
Epoch: 95, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.223 Vali Acc: 0.241 Test Loss: 4.223 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.44002604484558105
Epoch: 96, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.242 Vali Acc: 0.241 Test Loss: 4.242 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.5000989437103271
Epoch: 97, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.247 Vali Acc: 0.235 Test Loss: 4.247 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.4935877323150635
Epoch: 98, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.256 Vali Acc: 0.235 Test Loss: 4.256 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.5173404216766357
Epoch: 99, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.269 Vali Acc: 0.240 Test Loss: 4.269 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 0.5097610950469971
Epoch: 100, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.272 Vali Acc: 0.244 Test Loss: 4.272 Test Acc: 0.244
Validation loss decreased (-0.242311 --> -0.243487).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 21962
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.558152198791504
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.384 Vali Acc: 0.039 Test Loss: 3.384 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.5516865253448486
Epoch: 2, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.377 Vali Acc: 0.040 Test Loss: 3.377 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.5003769397735596
Epoch: 3, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.374 Vali Acc: 0.042 Test Loss: 3.374 Test Acc: 0.042
Validation loss decreased (-0.039966 --> -0.042319).  Saving model ...
Epoch: 4 cost time: 0.4803295135498047
Epoch: 4, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.369 Vali Acc: 0.048 Test Loss: 3.369 Test Acc: 0.048
Validation loss decreased (-0.042319 --> -0.048202).  Saving model ...
Epoch: 5 cost time: 0.4901285171508789
Epoch: 5, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.363 Vali Acc: 0.054 Test Loss: 3.363 Test Acc: 0.054
Validation loss decreased (-0.048202 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 0.5301048755645752
Epoch: 6, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.354 Vali Acc: 0.049 Test Loss: 3.354 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5600607395172119
Epoch: 7, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.348 Vali Acc: 0.053 Test Loss: 3.348 Test Acc: 0.053
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.48567843437194824
Epoch: 8, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.343 Vali Acc: 0.060 Test Loss: 3.343 Test Acc: 0.060
Validation loss decreased (-0.054084 --> -0.059967).  Saving model ...
Epoch: 9 cost time: 0.4916658401489258
Epoch: 9, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.338 Vali Acc: 0.066 Test Loss: 3.338 Test Acc: 0.066
Validation loss decreased (-0.059967 --> -0.065849).  Saving model ...
Epoch: 10 cost time: 0.5168962478637695
Epoch: 10, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.336 Vali Acc: 0.072 Test Loss: 3.336 Test Acc: 0.072
Validation loss decreased (-0.065849 --> -0.071731).  Saving model ...
Epoch: 11 cost time: 0.48272156715393066
Epoch: 11, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.335 Vali Acc: 0.075 Test Loss: 3.335 Test Acc: 0.075
Validation loss decreased (-0.071731 --> -0.075261).  Saving model ...
Epoch: 12 cost time: 0.5263266563415527
Epoch: 12, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.335 Vali Acc: 0.084 Test Loss: 3.335 Test Acc: 0.084
Validation loss decreased (-0.075261 --> -0.083496).  Saving model ...
Epoch: 13 cost time: 0.43070244789123535
Epoch: 13, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.332 Vali Acc: 0.084 Test Loss: 3.332 Test Acc: 0.084
Validation loss decreased (-0.083496 --> -0.083496).  Saving model ...
Epoch: 14 cost time: 0.5836422443389893
Epoch: 14, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.328 Vali Acc: 0.086 Test Loss: 3.328 Test Acc: 0.086
Validation loss decreased (-0.083496 --> -0.085849).  Saving model ...
Epoch: 15 cost time: 0.5519704818725586
Epoch: 15, Steps: 10 | Train Loss: 2.660 Vali Loss: 3.326 Vali Acc: 0.091 Test Loss: 3.326 Test Acc: 0.091
Validation loss decreased (-0.085849 --> -0.090555).  Saving model ...
Epoch: 16 cost time: 0.5273287296295166
Epoch: 16, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.326 Vali Acc: 0.094 Test Loss: 3.326 Test Acc: 0.094
Validation loss decreased (-0.090555 --> -0.094084).  Saving model ...
Epoch: 17 cost time: 0.5220906734466553
Epoch: 17, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.322 Vali Acc: 0.098 Test Loss: 3.322 Test Acc: 0.098
Validation loss decreased (-0.094084 --> -0.097614).  Saving model ...
Epoch: 18 cost time: 0.5276954174041748
Epoch: 18, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.320 Vali Acc: 0.102 Test Loss: 3.320 Test Acc: 0.102
Validation loss decreased (-0.097614 --> -0.102320).  Saving model ...
Epoch: 19 cost time: 0.5100259780883789
Epoch: 19, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.315 Vali Acc: 0.099 Test Loss: 3.315 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5361747741699219
Epoch: 20, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.314 Vali Acc: 0.108 Test Loss: 3.314 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108202).  Saving model ...
Epoch: 21 cost time: 0.4306950569152832
Epoch: 21, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.314 Vali Acc: 0.108 Test Loss: 3.314 Test Acc: 0.108
Validation loss decreased (-0.108202 --> -0.108202).  Saving model ...
Epoch: 22 cost time: 0.49065613746643066
Epoch: 22, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.311 Vali Acc: 0.113 Test Loss: 3.311 Test Acc: 0.113
Validation loss decreased (-0.108202 --> -0.112908).  Saving model ...
Epoch: 23 cost time: 0.5046892166137695
Epoch: 23, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.309 Vali Acc: 0.114 Test Loss: 3.309 Test Acc: 0.114
Validation loss decreased (-0.112908 --> -0.114085).  Saving model ...
Epoch: 24 cost time: 0.4898991584777832
Epoch: 24, Steps: 10 | Train Loss: 2.047 Vali Loss: 3.311 Vali Acc: 0.122 Test Loss: 3.311 Test Acc: 0.122
Validation loss decreased (-0.114085 --> -0.122320).  Saving model ...
Epoch: 25 cost time: 0.5226740837097168
Epoch: 25, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.312 Vali Acc: 0.125 Test Loss: 3.312 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 26 cost time: 0.4563937187194824
Epoch: 26, Steps: 10 | Train Loss: 1.950 Vali Loss: 3.315 Vali Acc: 0.132 Test Loss: 3.315 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 27 cost time: 0.4629788398742676
Epoch: 27, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.323 Vali Acc: 0.134 Test Loss: 3.323 Test Acc: 0.134
Validation loss decreased (-0.131732 --> -0.134084).  Saving model ...
Epoch: 28 cost time: 0.5273382663726807
Epoch: 28, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.322 Vali Acc: 0.138 Test Loss: 3.322 Test Acc: 0.138
Validation loss decreased (-0.134084 --> -0.137614).  Saving model ...
Epoch: 29 cost time: 0.4328279495239258
Epoch: 29, Steps: 10 | Train Loss: 1.705 Vali Loss: 3.331 Vali Acc: 0.148 Test Loss: 3.331 Test Acc: 0.148
Validation loss decreased (-0.137614 --> -0.148202).  Saving model ...
Epoch: 30 cost time: 0.5345449447631836
Epoch: 30, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.337 Vali Acc: 0.154 Test Loss: 3.337 Test Acc: 0.154
Validation loss decreased (-0.148202 --> -0.154084).  Saving model ...
Epoch: 31 cost time: 0.5136203765869141
Epoch: 31, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.336 Vali Acc: 0.159 Test Loss: 3.336 Test Acc: 0.159
Validation loss decreased (-0.154084 --> -0.158790).  Saving model ...
Epoch: 32 cost time: 0.5252869129180908
Epoch: 32, Steps: 10 | Train Loss: 1.522 Vali Loss: 3.347 Vali Acc: 0.155 Test Loss: 3.347 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5434880256652832
Epoch: 33, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.356 Vali Acc: 0.162 Test Loss: 3.356 Test Acc: 0.162
Validation loss decreased (-0.158790 --> -0.162319).  Saving model ...
Epoch: 34 cost time: 0.5590639114379883
Epoch: 34, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.363 Vali Acc: 0.165 Test Loss: 3.363 Test Acc: 0.165
Validation loss decreased (-0.162319 --> -0.164672).  Saving model ...
Epoch: 35 cost time: 0.5446531772613525
Epoch: 35, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.374 Vali Acc: 0.167 Test Loss: 3.374 Test Acc: 0.167
Validation loss decreased (-0.164672 --> -0.167025).  Saving model ...
Epoch: 36 cost time: 0.5310320854187012
Epoch: 36, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.391 Vali Acc: 0.168 Test Loss: 3.391 Test Acc: 0.168
Validation loss decreased (-0.167025 --> -0.168201).  Saving model ...
Epoch: 37 cost time: 0.4983031749725342
Epoch: 37, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.390 Vali Acc: 0.168 Test Loss: 3.390 Test Acc: 0.168
Validation loss decreased (-0.168201 --> -0.168201).  Saving model ...
Epoch: 38 cost time: 0.5488412380218506
Epoch: 38, Steps: 10 | Train Loss: 1.145 Vali Loss: 3.403 Vali Acc: 0.169 Test Loss: 3.403 Test Acc: 0.169
Validation loss decreased (-0.168201 --> -0.169378).  Saving model ...
Epoch: 39 cost time: 0.5061111450195312
Epoch: 39, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.416 Vali Acc: 0.176 Test Loss: 3.416 Test Acc: 0.176
Validation loss decreased (-0.169378 --> -0.176436).  Saving model ...
Epoch: 40 cost time: 0.5595231056213379
Epoch: 40, Steps: 10 | Train Loss: 1.021 Vali Loss: 3.424 Vali Acc: 0.180 Test Loss: 3.424 Test Acc: 0.180
Validation loss decreased (-0.176436 --> -0.179966).  Saving model ...
Epoch: 41 cost time: 0.48373937606811523
Epoch: 41, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.432 Vali Acc: 0.187 Test Loss: 3.432 Test Acc: 0.187
Validation loss decreased (-0.179966 --> -0.187024).  Saving model ...
Epoch: 42 cost time: 0.46064138412475586
Epoch: 42, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.447 Vali Acc: 0.187 Test Loss: 3.447 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5052924156188965
Epoch: 43, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.465 Vali Acc: 0.191 Test Loss: 3.465 Test Acc: 0.191
Validation loss decreased (-0.187024 --> -0.190554).  Saving model ...
Epoch: 44 cost time: 0.5225112438201904
Epoch: 44, Steps: 10 | Train Loss: 0.826 Vali Loss: 3.490 Vali Acc: 0.193 Test Loss: 3.490 Test Acc: 0.193
Validation loss decreased (-0.190554 --> -0.192906).  Saving model ...
Epoch: 45 cost time: 0.5308897495269775
Epoch: 45, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.500 Vali Acc: 0.194 Test Loss: 3.500 Test Acc: 0.194
Validation loss decreased (-0.192906 --> -0.194083).  Saving model ...
Epoch: 46 cost time: 0.4828829765319824
Epoch: 46, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.519 Vali Acc: 0.198 Test Loss: 3.519 Test Acc: 0.198
Validation loss decreased (-0.194083 --> -0.197612).  Saving model ...
Epoch: 47 cost time: 0.5622639656066895
Epoch: 47, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.537 Vali Acc: 0.198 Test Loss: 3.537 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.49622106552124023
Epoch: 48, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.552 Vali Acc: 0.200 Test Loss: 3.552 Test Acc: 0.200
Validation loss decreased (-0.197612 --> -0.199964).  Saving model ...
Epoch: 49 cost time: 0.5031387805938721
Epoch: 49, Steps: 10 | Train Loss: 0.654 Vali Loss: 3.554 Vali Acc: 0.206 Test Loss: 3.554 Test Acc: 0.206
Validation loss decreased (-0.199964 --> -0.205847).  Saving model ...
Epoch: 50 cost time: 0.49495601654052734
Epoch: 50, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.563 Vali Acc: 0.208 Test Loss: 3.563 Test Acc: 0.208
Validation loss decreased (-0.205847 --> -0.208200).  Saving model ...
Epoch: 51 cost time: 0.4312441349029541
Epoch: 51, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.596 Vali Acc: 0.212 Test Loss: 3.596 Test Acc: 0.212
Validation loss decreased (-0.208200 --> -0.211729).  Saving model ...
Epoch: 52 cost time: 0.5257670879364014
Epoch: 52, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.617 Vali Acc: 0.206 Test Loss: 3.617 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5110006332397461
Epoch: 53, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.629 Vali Acc: 0.204 Test Loss: 3.629 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5094814300537109
Epoch: 54, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.649 Vali Acc: 0.213 Test Loss: 3.649 Test Acc: 0.213
Validation loss decreased (-0.211729 --> -0.212905).  Saving model ...
Epoch: 55 cost time: 0.5236225128173828
Epoch: 55, Steps: 10 | Train Loss: 0.486 Vali Loss: 3.676 Vali Acc: 0.211 Test Loss: 3.676 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.4991488456726074
Epoch: 56, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.701 Vali Acc: 0.211 Test Loss: 3.701 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5491178035736084
Epoch: 57, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.719 Vali Acc: 0.207 Test Loss: 3.719 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5001063346862793
Epoch: 58, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.726 Vali Acc: 0.211 Test Loss: 3.726 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5192503929138184
Epoch: 59, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.740 Vali Acc: 0.212 Test Loss: 3.740 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.49172306060791016
Epoch: 60, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.790 Vali Acc: 0.207 Test Loss: 3.790 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.4973185062408447
Epoch: 61, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.814 Vali Acc: 0.209 Test Loss: 3.814 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.5142521858215332
Epoch: 62, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.824 Vali Acc: 0.213 Test Loss: 3.824 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.48476171493530273
Epoch: 63, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.846 Vali Acc: 0.214 Test Loss: 3.846 Test Acc: 0.214
Validation loss decreased (-0.212905 --> -0.214079).  Saving model ...
Epoch: 64 cost time: 0.5866739749908447
Epoch: 64, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.858 Vali Acc: 0.218 Test Loss: 3.858 Test Acc: 0.218
Validation loss decreased (-0.214079 --> -0.217608).  Saving model ...
Epoch: 65 cost time: 0.5162429809570312
Epoch: 65, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.872 Vali Acc: 0.214 Test Loss: 3.872 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.4737508296966553
Epoch: 66, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.884 Vali Acc: 0.213 Test Loss: 3.884 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5337176322937012
Epoch: 67, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.887 Vali Acc: 0.224 Test Loss: 3.887 Test Acc: 0.224
Validation loss decreased (-0.217608 --> -0.223491).  Saving model ...
Epoch: 68 cost time: 0.5587711334228516
Epoch: 68, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.936 Vali Acc: 0.218 Test Loss: 3.936 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5572917461395264
Epoch: 69, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.947 Vali Acc: 0.216 Test Loss: 3.947 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.4933328628540039
Epoch: 70, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.966 Vali Acc: 0.216 Test Loss: 3.966 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.49742722511291504
Epoch: 71, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.978 Vali Acc: 0.218 Test Loss: 3.978 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.4872739315032959
Epoch: 72, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.996 Vali Acc: 0.212 Test Loss: 3.996 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5317895412445068
Epoch: 73, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.025 Vali Acc: 0.215 Test Loss: 4.025 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.5747416019439697
Epoch: 74, Steps: 10 | Train Loss: 0.165 Vali Loss: 4.039 Vali Acc: 0.218 Test Loss: 4.039 Test Acc: 0.218
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.4843568801879883
Epoch: 75, Steps: 10 | Train Loss: 0.178 Vali Loss: 4.060 Vali Acc: 0.224 Test Loss: 4.060 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.5009732246398926
Epoch: 76, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.069 Vali Acc: 0.231 Test Loss: 4.069 Test Acc: 0.231
Validation loss decreased (-0.223491 --> -0.230548).  Saving model ...
Epoch: 77 cost time: 0.5622756481170654
Epoch: 77, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.088 Vali Acc: 0.231 Test Loss: 4.088 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5389344692230225
Epoch: 78, Steps: 10 | Train Loss: 0.172 Vali Loss: 4.101 Vali Acc: 0.226 Test Loss: 4.101 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.5769004821777344
Epoch: 79, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.124 Vali Acc: 0.226 Test Loss: 4.124 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.5450575351715088
Epoch: 80, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.146 Vali Acc: 0.221 Test Loss: 4.146 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5846152305603027
Epoch: 81, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.150 Vali Acc: 0.225 Test Loss: 4.150 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.5351169109344482
Epoch: 82, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.159 Vali Acc: 0.226 Test Loss: 4.159 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.4852015972137451
Epoch: 83, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.170 Vali Acc: 0.228 Test Loss: 4.170 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.503943920135498
Epoch: 84, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.177 Vali Acc: 0.228 Test Loss: 4.177 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.5081355571746826
Epoch: 85, Steps: 10 | Train Loss: 0.109 Vali Loss: 4.192 Vali Acc: 0.228 Test Loss: 4.192 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.5094342231750488
Epoch: 86, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.207 Vali Acc: 0.229 Test Loss: 4.207 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23058823529411765
model parameter : 18346
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6462485790252686
Epoch: 1, Steps: 10 | Train Loss: 3.602 Vali Loss: 3.394 Vali Acc: 0.021 Test Loss: 3.394 Test Acc: 0.021
Validation loss decreased (inf --> -0.021143).  Saving model ...
Epoch: 2 cost time: 0.4978775978088379
Epoch: 2, Steps: 10 | Train Loss: 3.587 Vali Loss: 3.389 Vali Acc: 0.026 Test Loss: 3.389 Test Acc: 0.026
Validation loss decreased (-0.021143 --> -0.025848).  Saving model ...
Epoch: 3 cost time: 0.5243110656738281
Epoch: 3, Steps: 10 | Train Loss: 3.555 Vali Loss: 3.382 Vali Acc: 0.033 Test Loss: 3.382 Test Acc: 0.033
Validation loss decreased (-0.025848 --> -0.032907).  Saving model ...
Epoch: 4 cost time: 0.4834256172180176
Epoch: 4, Steps: 10 | Train Loss: 3.438 Vali Loss: 3.371 Vali Acc: 0.029 Test Loss: 3.371 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4982912540435791
Epoch: 5, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.355 Vali Acc: 0.033 Test Loss: 3.355 Test Acc: 0.033
Validation loss decreased (-0.032907 --> -0.032908).  Saving model ...
Epoch: 6 cost time: 0.48468470573425293
Epoch: 6, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.341 Vali Acc: 0.036 Test Loss: 3.341 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036437).  Saving model ...
Epoch: 7 cost time: 0.46548986434936523
Epoch: 7, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.326 Vali Acc: 0.036 Test Loss: 3.326 Test Acc: 0.036
Validation loss decreased (-0.036437 --> -0.036437).  Saving model ...
Epoch: 8 cost time: 0.49107980728149414
Epoch: 8, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.314 Vali Acc: 0.045 Test Loss: 3.314 Test Acc: 0.045
Validation loss decreased (-0.036437 --> -0.044673).  Saving model ...
Epoch: 9 cost time: 0.47458624839782715
Epoch: 9, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.302 Vali Acc: 0.053 Test Loss: 3.302 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 10 cost time: 0.4653768539428711
Epoch: 10, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.294 Vali Acc: 0.059 Test Loss: 3.294 Test Acc: 0.059
Validation loss decreased (-0.052908 --> -0.058791).  Saving model ...
Epoch: 11 cost time: 0.4778120517730713
Epoch: 11, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.285 Vali Acc: 0.064 Test Loss: 3.285 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 12 cost time: 0.5238828659057617
Epoch: 12, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.279 Vali Acc: 0.076 Test Loss: 3.279 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 13 cost time: 0.5393874645233154
Epoch: 13, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.274 Vali Acc: 0.081 Test Loss: 3.274 Test Acc: 0.081
Validation loss decreased (-0.076438 --> -0.081144).  Saving model ...
Epoch: 14 cost time: 0.5141880512237549
Epoch: 14, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.268 Vali Acc: 0.086 Test Loss: 3.268 Test Acc: 0.086
Validation loss decreased (-0.081144 --> -0.085850).  Saving model ...
Epoch: 15 cost time: 0.47349023818969727
Epoch: 15, Steps: 10 | Train Loss: 2.783 Vali Loss: 3.262 Vali Acc: 0.092 Test Loss: 3.262 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 16 cost time: 0.5301125049591064
Epoch: 16, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.258 Vali Acc: 0.095 Test Loss: 3.258 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 17 cost time: 0.5300030708312988
Epoch: 17, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.255 Vali Acc: 0.099 Test Loss: 3.255 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 18 cost time: 0.48644161224365234
Epoch: 18, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.252 Vali Acc: 0.104 Test Loss: 3.252 Test Acc: 0.104
Validation loss decreased (-0.098791 --> -0.103497).  Saving model ...
Epoch: 19 cost time: 0.5778772830963135
Epoch: 19, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.248 Vali Acc: 0.107 Test Loss: 3.248 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 20 cost time: 0.4963994026184082
Epoch: 20, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.247 Vali Acc: 0.114 Test Loss: 3.247 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 21 cost time: 0.5455503463745117
Epoch: 21, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.245 Vali Acc: 0.121 Test Loss: 3.245 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 22 cost time: 0.5513603687286377
Epoch: 22, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.245 Vali Acc: 0.131 Test Loss: 3.245 Test Acc: 0.131
Validation loss decreased (-0.121144 --> -0.130556).  Saving model ...
Epoch: 23 cost time: 0.5402817726135254
Epoch: 23, Steps: 10 | Train Loss: 2.264 Vali Loss: 3.247 Vali Acc: 0.126 Test Loss: 3.247 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5693099498748779
Epoch: 24, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.249 Vali Acc: 0.131 Test Loss: 3.249 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5463125705718994
Epoch: 25, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.249 Vali Acc: 0.141 Test Loss: 3.249 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141144).  Saving model ...
Epoch: 26 cost time: 0.504673957824707
Epoch: 26, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.249 Vali Acc: 0.144 Test Loss: 3.249 Test Acc: 0.144
Validation loss decreased (-0.141144 --> -0.143497).  Saving model ...
Epoch: 27 cost time: 0.535059928894043
Epoch: 27, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.250 Vali Acc: 0.147 Test Loss: 3.250 Test Acc: 0.147
Validation loss decreased (-0.143497 --> -0.147026).  Saving model ...
Epoch: 28 cost time: 0.5102367401123047
Epoch: 28, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.255 Vali Acc: 0.146 Test Loss: 3.255 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5765244960784912
Epoch: 29, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.259 Vali Acc: 0.147 Test Loss: 3.259 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5174028873443604
Epoch: 30, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.264 Vali Acc: 0.146 Test Loss: 3.264 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5164031982421875
Epoch: 31, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.271 Vali Acc: 0.146 Test Loss: 3.271 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5249173641204834
Epoch: 32, Steps: 10 | Train Loss: 1.700 Vali Loss: 3.275 Vali Acc: 0.153 Test Loss: 3.275 Test Acc: 0.153
Validation loss decreased (-0.147026 --> -0.152908).  Saving model ...
Epoch: 33 cost time: 0.5237019062042236
Epoch: 33, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.275 Vali Acc: 0.155 Test Loss: 3.275 Test Acc: 0.155
Validation loss decreased (-0.152908 --> -0.155261).  Saving model ...
Epoch: 34 cost time: 0.5002107620239258
Epoch: 34, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.276 Vali Acc: 0.161 Test Loss: 3.276 Test Acc: 0.161
Validation loss decreased (-0.155261 --> -0.161144).  Saving model ...
Epoch: 35 cost time: 0.5062289237976074
Epoch: 35, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.288 Vali Acc: 0.165 Test Loss: 3.288 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 36 cost time: 0.4178807735443115
Epoch: 36, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.296 Vali Acc: 0.165 Test Loss: 3.296 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5138547420501709
Epoch: 37, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.303 Vali Acc: 0.172 Test Loss: 3.303 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171732).  Saving model ...
Epoch: 38 cost time: 0.5597639083862305
Epoch: 38, Steps: 10 | Train Loss: 1.372 Vali Loss: 3.305 Vali Acc: 0.174 Test Loss: 3.305 Test Acc: 0.174
Validation loss decreased (-0.171732 --> -0.174085).  Saving model ...
Epoch: 39 cost time: 0.4994997978210449
Epoch: 39, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.320 Vali Acc: 0.179 Test Loss: 3.320 Test Acc: 0.179
Validation loss decreased (-0.174085 --> -0.178790).  Saving model ...
Epoch: 40 cost time: 0.4929535388946533
Epoch: 40, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.327 Vali Acc: 0.186 Test Loss: 3.327 Test Acc: 0.186
Validation loss decreased (-0.178790 --> -0.185849).  Saving model ...
Epoch: 41 cost time: 0.5210592746734619
Epoch: 41, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.337 Vali Acc: 0.188 Test Loss: 3.337 Test Acc: 0.188
Validation loss decreased (-0.185849 --> -0.188202).  Saving model ...
Epoch: 42 cost time: 0.5048327445983887
Epoch: 42, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.343 Vali Acc: 0.193 Test Loss: 3.343 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 43 cost time: 0.5151827335357666
Epoch: 43, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.361 Vali Acc: 0.194 Test Loss: 3.361 Test Acc: 0.194
Validation loss decreased (-0.192908 --> -0.194084).  Saving model ...
Epoch: 44 cost time: 0.4563775062561035
Epoch: 44, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.372 Vali Acc: 0.192 Test Loss: 3.372 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5058495998382568
Epoch: 45, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.376 Vali Acc: 0.196 Test Loss: 3.376 Test Acc: 0.196
Validation loss decreased (-0.194084 --> -0.196437).  Saving model ...
Epoch: 46 cost time: 0.49689149856567383
Epoch: 46, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.389 Vali Acc: 0.202 Test Loss: 3.389 Test Acc: 0.202
Validation loss decreased (-0.196437 --> -0.202319).  Saving model ...
Epoch: 47 cost time: 0.5112237930297852
Epoch: 47, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.398 Vali Acc: 0.207 Test Loss: 3.398 Test Acc: 0.207
Validation loss decreased (-0.202319 --> -0.207025).  Saving model ...
Epoch: 48 cost time: 0.4909529685974121
Epoch: 48, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.410 Vali Acc: 0.208 Test Loss: 3.410 Test Acc: 0.208
Validation loss decreased (-0.207025 --> -0.208201).  Saving model ...
Epoch: 49 cost time: 0.510981559753418
Epoch: 49, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.432 Vali Acc: 0.207 Test Loss: 3.432 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5535047054290771
Epoch: 50, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.445 Vali Acc: 0.211 Test Loss: 3.445 Test Acc: 0.211
Validation loss decreased (-0.208201 --> -0.210554).  Saving model ...
Epoch: 51 cost time: 0.5210232734680176
Epoch: 51, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.458 Vali Acc: 0.216 Test Loss: 3.458 Test Acc: 0.216
Validation loss decreased (-0.210554 --> -0.216436).  Saving model ...
Epoch: 52 cost time: 0.5280613899230957
Epoch: 52, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.470 Vali Acc: 0.215 Test Loss: 3.470 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5159702301025391
Epoch: 53, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.477 Vali Acc: 0.213 Test Loss: 3.477 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5082612037658691
Epoch: 54, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.503 Vali Acc: 0.213 Test Loss: 3.503 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5176076889038086
Epoch: 55, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.510 Vali Acc: 0.209 Test Loss: 3.510 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5193285942077637
Epoch: 56, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.518 Vali Acc: 0.215 Test Loss: 3.518 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.4778726100921631
Epoch: 57, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.545 Vali Acc: 0.218 Test Loss: 3.545 Test Acc: 0.218
Validation loss decreased (-0.216436 --> -0.217612).  Saving model ...
Epoch: 58 cost time: 0.5220434665679932
Epoch: 58, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.556 Vali Acc: 0.221 Test Loss: 3.556 Test Acc: 0.221
Validation loss decreased (-0.217612 --> -0.221141).  Saving model ...
Epoch: 59 cost time: 0.543128490447998
Epoch: 59, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.565 Vali Acc: 0.219 Test Loss: 3.565 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5204946994781494
Epoch: 60, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.576 Vali Acc: 0.221 Test Loss: 3.576 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5012161731719971
Epoch: 61, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.595 Vali Acc: 0.221 Test Loss: 3.595 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.4918248653411865
Epoch: 62, Steps: 10 | Train Loss: 0.416 Vali Loss: 3.611 Vali Acc: 0.218 Test Loss: 3.611 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.4850163459777832
Epoch: 63, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.637 Vali Acc: 0.219 Test Loss: 3.637 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5027673244476318
Epoch: 64, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.647 Vali Acc: 0.224 Test Loss: 3.647 Test Acc: 0.224
Validation loss decreased (-0.221141 --> -0.223493).  Saving model ...
Epoch: 65 cost time: 0.5262529850006104
Epoch: 65, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.660 Vali Acc: 0.226 Test Loss: 3.660 Test Acc: 0.226
Validation loss decreased (-0.223493 --> -0.225846).  Saving model ...
Epoch: 66 cost time: 0.5512008666992188
Epoch: 66, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.672 Vali Acc: 0.224 Test Loss: 3.672 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5186355113983154
Epoch: 67, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.694 Vali Acc: 0.229 Test Loss: 3.694 Test Acc: 0.229
Validation loss decreased (-0.225846 --> -0.229375).  Saving model ...
Epoch: 68 cost time: 0.5397689342498779
Epoch: 68, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.718 Vali Acc: 0.229 Test Loss: 3.718 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5549228191375732
Epoch: 69, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.730 Vali Acc: 0.226 Test Loss: 3.730 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.5330924987792969
Epoch: 70, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.740 Vali Acc: 0.225 Test Loss: 3.740 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5011510848999023
Epoch: 71, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.766 Vali Acc: 0.225 Test Loss: 3.766 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5193357467651367
Epoch: 72, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.787 Vali Acc: 0.228 Test Loss: 3.787 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5132994651794434
Epoch: 73, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.782 Vali Acc: 0.229 Test Loss: 3.782 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.48744678497314453
Epoch: 74, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.795 Vali Acc: 0.232 Test Loss: 3.795 Test Acc: 0.232
Validation loss decreased (-0.229375 --> -0.231727).  Saving model ...
Epoch: 75 cost time: 0.48598742485046387
Epoch: 75, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.804 Vali Acc: 0.232 Test Loss: 3.804 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5592336654663086
Epoch: 76, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.820 Vali Acc: 0.236 Test Loss: 3.820 Test Acc: 0.236
Validation loss decreased (-0.231727 --> -0.236432).  Saving model ...
Epoch: 77 cost time: 0.5438566207885742
Epoch: 77, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.852 Vali Acc: 0.234 Test Loss: 3.852 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5268740653991699
Epoch: 78, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.863 Vali Acc: 0.234 Test Loss: 3.863 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.49138903617858887
Epoch: 79, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.869 Vali Acc: 0.234 Test Loss: 3.869 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.5382554531097412
Epoch: 80, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.880 Vali Acc: 0.231 Test Loss: 3.880 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.46534276008605957
Epoch: 81, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.880 Vali Acc: 0.233 Test Loss: 3.880 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.4227421283721924
Epoch: 82, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.899 Vali Acc: 0.238 Test Loss: 3.899 Test Acc: 0.238
Validation loss decreased (-0.236432 --> -0.237608).  Saving model ...
Epoch: 83 cost time: 0.48217034339904785
Epoch: 83, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.941 Vali Acc: 0.231 Test Loss: 3.941 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.493790864944458
Epoch: 84, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.955 Vali Acc: 0.233 Test Loss: 3.955 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.5342667102813721
Epoch: 85, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.953 Vali Acc: 0.225 Test Loss: 3.953 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5314083099365234
Epoch: 86, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.967 Vali Acc: 0.232 Test Loss: 3.967 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.498795747756958
Epoch: 87, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.985 Vali Acc: 0.236 Test Loss: 3.985 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.46963953971862793
Epoch: 88, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.997 Vali Acc: 0.240 Test Loss: 3.997 Test Acc: 0.240
Validation loss decreased (-0.237608 --> -0.239960).  Saving model ...
Epoch: 89 cost time: 0.45766758918762207
Epoch: 89, Steps: 10 | Train Loss: 0.126 Vali Loss: 4.006 Vali Acc: 0.236 Test Loss: 4.006 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.42543816566467285
Epoch: 90, Steps: 10 | Train Loss: 0.127 Vali Loss: 4.025 Vali Acc: 0.239 Test Loss: 4.025 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.5647175312042236
Epoch: 91, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.019 Vali Acc: 0.239 Test Loss: 4.019 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.48358964920043945
Epoch: 92, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.030 Vali Acc: 0.240 Test Loss: 4.030 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.5680716037750244
Epoch: 93, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.036 Vali Acc: 0.241 Test Loss: 4.036 Test Acc: 0.241
Validation loss decreased (-0.239960 --> -0.241136).  Saving model ...
Epoch: 94 cost time: 0.5034019947052002
Epoch: 94, Steps: 10 | Train Loss: 0.114 Vali Loss: 4.050 Vali Acc: 0.247 Test Loss: 4.050 Test Acc: 0.247
Validation loss decreased (-0.241136 --> -0.247018).  Saving model ...
Epoch: 95 cost time: 0.4830493927001953
Epoch: 95, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.054 Vali Acc: 0.242 Test Loss: 4.054 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.5197615623474121
Epoch: 96, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.063 Vali Acc: 0.233 Test Loss: 4.063 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.5047276020050049
Epoch: 97, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.071 Vali Acc: 0.235 Test Loss: 4.071 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.5028476715087891
Epoch: 98, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.093 Vali Acc: 0.234 Test Loss: 4.093 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.46577930450439453
Epoch: 99, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.123 Vali Acc: 0.236 Test Loss: 4.123 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.514732837677002
Epoch: 100, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.137 Vali Acc: 0.238 Test Loss: 4.137 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el2_dm16_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 17210
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4761900901794434
Epoch: 1, Steps: 10 | Train Loss: 3.453 Vali Loss: 3.380 Vali Acc: 0.060 Test Loss: 3.380 Test Acc: 0.060
Validation loss decreased (inf --> -0.059966).  Saving model ...
Epoch: 2 cost time: 0.5079407691955566
Epoch: 2, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.443 Vali Acc: 0.119 Test Loss: 3.443 Test Acc: 0.119
Validation loss decreased (-0.059966 --> -0.118789).  Saving model ...
Epoch: 3 cost time: 0.530095100402832
Epoch: 3, Steps: 10 | Train Loss: 2.092 Vali Loss: 3.314 Vali Acc: 0.167 Test Loss: 3.314 Test Acc: 0.167
Validation loss decreased (-0.118789 --> -0.167026).  Saving model ...
Epoch: 4 cost time: 0.5216784477233887
Epoch: 4, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.562 Vali Acc: 0.158 Test Loss: 3.562 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5132403373718262
Epoch: 5, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.698 Vali Acc: 0.220 Test Loss: 3.698 Test Acc: 0.220
Validation loss decreased (-0.167026 --> -0.219963).  Saving model ...
Epoch: 6 cost time: 0.5221765041351318
Epoch: 6, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.889 Vali Acc: 0.219 Test Loss: 3.889 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5044152736663818
Epoch: 7, Steps: 10 | Train Loss: 0.325 Vali Loss: 4.330 Vali Acc: 0.211 Test Loss: 4.330 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.37684059143066406
Epoch: 8, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.275 Vali Acc: 0.231 Test Loss: 4.275 Test Acc: 0.231
Validation loss decreased (-0.219963 --> -0.230545).  Saving model ...
Epoch: 9 cost time: 0.5102975368499756
Epoch: 9, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.957 Vali Acc: 0.238 Test Loss: 4.957 Test Acc: 0.238
Validation loss decreased (-0.230545 --> -0.237597).  Saving model ...
Epoch: 10 cost time: 0.4854466915130615
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 5.159 Vali Acc: 0.226 Test Loss: 5.159 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48426055908203125
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.296 Vali Acc: 0.239 Test Loss: 5.296 Test Acc: 0.239
Validation loss decreased (-0.237597 --> -0.238771).  Saving model ...
Epoch: 12 cost time: 0.48178911209106445
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 5.524 Vali Acc: 0.240 Test Loss: 5.524 Test Acc: 0.240
Validation loss decreased (-0.238771 --> -0.239945).  Saving model ...
Epoch: 13 cost time: 0.4785459041595459
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.451 Vali Acc: 0.248 Test Loss: 5.451 Test Acc: 0.248
Validation loss decreased (-0.239945 --> -0.248181).  Saving model ...
Epoch: 14 cost time: 0.4926908016204834
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.562 Vali Acc: 0.246 Test Loss: 5.562 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4991164207458496
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.865 Vali Acc: 0.245 Test Loss: 5.865 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4405019283294678
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.735 Vali Acc: 0.264 Test Loss: 5.735 Test Acc: 0.264
Validation loss decreased (-0.248181 --> -0.263472).  Saving model ...
Epoch: 17 cost time: 0.4732182025909424
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.709 Vali Acc: 0.264 Test Loss: 5.709 Test Acc: 0.264
Validation loss decreased (-0.263472 --> -0.263472).  Saving model ...
Epoch: 18 cost time: 0.49770569801330566
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.723 Vali Acc: 0.265 Test Loss: 5.723 Test Acc: 0.265
Validation loss decreased (-0.263472 --> -0.264649).  Saving model ...
Epoch: 19 cost time: 0.4992353916168213
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.728 Vali Acc: 0.265 Test Loss: 5.728 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48621177673339844
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.735 Vali Acc: 0.266 Test Loss: 5.735 Test Acc: 0.266
Validation loss decreased (-0.264649 --> -0.265825).  Saving model ...
Epoch: 21 cost time: 0.46022748947143555
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.737 Vali Acc: 0.269 Test Loss: 5.737 Test Acc: 0.269
Validation loss decreased (-0.265825 --> -0.269354).  Saving model ...
Epoch: 22 cost time: 0.4805331230163574
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.734 Vali Acc: 0.268 Test Loss: 5.734 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5268261432647705
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.744 Vali Acc: 0.269 Test Loss: 5.744 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4805750846862793
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.751 Vali Acc: 0.268 Test Loss: 5.751 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.42879223823547363
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.767 Vali Acc: 0.271 Test Loss: 5.767 Test Acc: 0.271
Validation loss decreased (-0.269354 --> -0.270531).  Saving model ...
Epoch: 26 cost time: 0.5500895977020264
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.793 Vali Acc: 0.269 Test Loss: 5.793 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5241572856903076
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.806 Vali Acc: 0.267 Test Loss: 5.806 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5336041450500488
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.832 Vali Acc: 0.265 Test Loss: 5.832 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5405542850494385
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.847 Vali Acc: 0.268 Test Loss: 5.847 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5144801139831543
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.860 Vali Acc: 0.272 Test Loss: 5.860 Test Acc: 0.272
Validation loss decreased (-0.270531 --> -0.271706).  Saving model ...
Epoch: 31 cost time: 0.576629638671875
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.862 Vali Acc: 0.271 Test Loss: 5.862 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5421485900878906
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.870 Vali Acc: 0.269 Test Loss: 5.870 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5424373149871826
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.879 Vali Acc: 0.269 Test Loss: 5.879 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5270946025848389
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.897 Vali Acc: 0.272 Test Loss: 5.897 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5105457305908203
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.914 Vali Acc: 0.272 Test Loss: 5.914 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5153534412384033
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.914 Vali Acc: 0.273 Test Loss: 5.914 Test Acc: 0.273
Validation loss decreased (-0.271706 --> -0.272882).  Saving model ...
Epoch: 37 cost time: 0.5282871723175049
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.271 Test Loss: 5.933 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5393602848052979
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.937 Vali Acc: 0.274 Test Loss: 5.937 Test Acc: 0.274
Validation loss decreased (-0.272882 --> -0.274058).  Saving model ...
Epoch: 39 cost time: 0.5519368648529053
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.944 Vali Acc: 0.273 Test Loss: 5.944 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5294013023376465
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.942 Vali Acc: 0.273 Test Loss: 5.942 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5795238018035889
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.958 Vali Acc: 0.274 Test Loss: 5.958 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5125665664672852
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.964 Vali Acc: 0.274 Test Loss: 5.964 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5174589157104492
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.975 Vali Acc: 0.275 Test Loss: 5.975 Test Acc: 0.275
Validation loss decreased (-0.274058 --> -0.275234).  Saving model ...
Epoch: 44 cost time: 0.5285284519195557
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.980 Vali Acc: 0.275 Test Loss: 5.980 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5640993118286133
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.984 Vali Acc: 0.273 Test Loss: 5.984 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5627701282501221
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.001 Vali Acc: 0.274 Test Loss: 6.001 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4919569492340088
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.006 Vali Acc: 0.274 Test Loss: 6.006 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.570711612701416
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.019 Vali Acc: 0.273 Test Loss: 6.019 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.46569347381591797
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.028 Vali Acc: 0.272 Test Loss: 6.028 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5017440319061279
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.024 Vali Acc: 0.272 Test Loss: 6.024 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.4873063564300537
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.033 Vali Acc: 0.272 Test Loss: 6.033 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5038361549377441
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.045 Vali Acc: 0.272 Test Loss: 6.045 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.4731454849243164
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.062 Vali Acc: 0.272 Test Loss: 6.062 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 892058
model size : 5.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7707600593566895
Epoch: 1, Steps: 10 | Train Loss: 3.420 Vali Loss: 3.397 Vali Acc: 0.041 Test Loss: 3.397 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.49875330924987793
Epoch: 2, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.412 Vali Acc: 0.078 Test Loss: 3.412 Test Acc: 0.078
Validation loss decreased (-0.041143 --> -0.077613).  Saving model ...
Epoch: 3 cost time: 0.4750247001647949
Epoch: 3, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.324 Vali Acc: 0.129 Test Loss: 3.324 Test Acc: 0.129
Validation loss decreased (-0.077613 --> -0.129379).  Saving model ...
Epoch: 4 cost time: 0.5136013031005859
Epoch: 4, Steps: 10 | Train Loss: 1.897 Vali Loss: 3.281 Vali Acc: 0.161 Test Loss: 3.281 Test Acc: 0.161
Validation loss decreased (-0.129379 --> -0.161144).  Saving model ...
Epoch: 5 cost time: 0.4702785015106201
Epoch: 5, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.384 Vali Acc: 0.185 Test Loss: 3.384 Test Acc: 0.185
Validation loss decreased (-0.161144 --> -0.184672).  Saving model ...
Epoch: 6 cost time: 0.462552547454834
Epoch: 6, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.486 Vali Acc: 0.204 Test Loss: 3.486 Test Acc: 0.204
Validation loss decreased (-0.184672 --> -0.203495).  Saving model ...
Epoch: 7 cost time: 0.47187280654907227
Epoch: 7, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.587 Vali Acc: 0.231 Test Loss: 3.587 Test Acc: 0.231
Validation loss decreased (-0.203495 --> -0.230552).  Saving model ...
Epoch: 8 cost time: 0.5274415016174316
Epoch: 8, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.730 Vali Acc: 0.232 Test Loss: 3.730 Test Acc: 0.232
Validation loss decreased (-0.230552 --> -0.231727).  Saving model ...
Epoch: 9 cost time: 0.5320167541503906
Epoch: 9, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.924 Vali Acc: 0.218 Test Loss: 3.924 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5263323783874512
Epoch: 10, Steps: 10 | Train Loss: 0.183 Vali Loss: 4.066 Vali Acc: 0.239 Test Loss: 4.066 Test Acc: 0.239
Validation loss decreased (-0.231727 --> -0.238783).  Saving model ...
Epoch: 11 cost time: 0.5243992805480957
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.366 Vali Acc: 0.236 Test Loss: 4.366 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5452826023101807
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.454 Vali Acc: 0.251 Test Loss: 4.454 Test Acc: 0.251
Validation loss decreased (-0.238783 --> -0.250544).  Saving model ...
Epoch: 13 cost time: 0.5114119052886963
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.544 Vali Acc: 0.244 Test Loss: 4.544 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5236911773681641
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.735 Vali Acc: 0.244 Test Loss: 4.735 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5701634883880615
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.812 Vali Acc: 0.246 Test Loss: 4.812 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5419924259185791
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.866 Vali Acc: 0.249 Test Loss: 4.866 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5277218818664551
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.908 Vali Acc: 0.255 Test Loss: 4.908 Test Acc: 0.255
Validation loss decreased (-0.250544 --> -0.255245).  Saving model ...
Epoch: 18 cost time: 0.5104801654815674
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.906 Vali Acc: 0.258 Test Loss: 4.906 Test Acc: 0.258
Validation loss decreased (-0.255245 --> -0.257598).  Saving model ...
Epoch: 19 cost time: 0.5305161476135254
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.915 Vali Acc: 0.259 Test Loss: 4.915 Test Acc: 0.259
Validation loss decreased (-0.257598 --> -0.258774).  Saving model ...
Epoch: 20 cost time: 0.5000123977661133
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.940 Vali Acc: 0.260 Test Loss: 4.940 Test Acc: 0.260
Validation loss decreased (-0.258774 --> -0.259951).  Saving model ...
Epoch: 21 cost time: 0.518589973449707
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.981 Vali Acc: 0.259 Test Loss: 4.981 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5232501029968262
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.006 Vali Acc: 0.260 Test Loss: 5.006 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5115869045257568
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.045 Vali Acc: 0.259 Test Loss: 5.045 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5332958698272705
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.075 Vali Acc: 0.258 Test Loss: 5.075 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4908621311187744
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.088 Vali Acc: 0.260 Test Loss: 5.088 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5290744304656982
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.093 Vali Acc: 0.264 Test Loss: 5.093 Test Acc: 0.264
Validation loss decreased (-0.259951 --> -0.263478).  Saving model ...
Epoch: 27 cost time: 0.5604157447814941
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.112 Vali Acc: 0.264 Test Loss: 5.112 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5592918395996094
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.143 Vali Acc: 0.262 Test Loss: 5.143 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5002701282501221
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.163 Vali Acc: 0.259 Test Loss: 5.163 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5174458026885986
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.191 Vali Acc: 0.260 Test Loss: 5.191 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4498019218444824
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.203 Vali Acc: 0.260 Test Loss: 5.203 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.44181251525878906
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.209 Vali Acc: 0.262 Test Loss: 5.209 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4529883861541748
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.218 Vali Acc: 0.265 Test Loss: 5.218 Test Acc: 0.265
Validation loss decreased (-0.263478 --> -0.264654).  Saving model ...
Epoch: 34 cost time: 0.5099632740020752
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.247 Vali Acc: 0.261 Test Loss: 5.247 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.48584771156311035
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.257 Vali Acc: 0.259 Test Loss: 5.257 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4744296073913574
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.266 Vali Acc: 0.260 Test Loss: 5.266 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.49897122383117676
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.280 Vali Acc: 0.261 Test Loss: 5.280 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.47920823097229004
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.314 Vali Acc: 0.264 Test Loss: 5.314 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.41033196449279785
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.326 Vali Acc: 0.262 Test Loss: 5.326 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.528231143951416
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.336 Vali Acc: 0.265 Test Loss: 5.336 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.48183774948120117
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.359 Vali Acc: 0.265 Test Loss: 5.359 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.49611353874206543
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.365 Vali Acc: 0.264 Test Loss: 5.365 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4687047004699707
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.385 Vali Acc: 0.266 Test Loss: 5.385 Test Acc: 0.266
Validation loss decreased (-0.264654 --> -0.265829).  Saving model ...
Epoch: 44 cost time: 0.4911930561065674
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.404 Vali Acc: 0.267 Test Loss: 5.404 Test Acc: 0.267
Validation loss decreased (-0.265829 --> -0.267005).  Saving model ...
Epoch: 45 cost time: 0.4751911163330078
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.408 Vali Acc: 0.264 Test Loss: 5.408 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.45265817642211914
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.423 Vali Acc: 0.262 Test Loss: 5.423 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4104146957397461
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.443 Vali Acc: 0.266 Test Loss: 5.443 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.48017287254333496
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.471 Vali Acc: 0.265 Test Loss: 5.471 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.49347686767578125
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.478 Vali Acc: 0.266 Test Loss: 5.478 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.49883031845092773
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.474 Vali Acc: 0.264 Test Loss: 5.474 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5307831764221191
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.485 Vali Acc: 0.264 Test Loss: 5.485 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5500319004058838
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.502 Vali Acc: 0.262 Test Loss: 5.502 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.49738383293151855
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.513 Vali Acc: 0.264 Test Loss: 5.513 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.4972224235534668
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.514 Vali Acc: 0.261 Test Loss: 5.514 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 513178
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5129482746124268
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.308 Vali Acc: 0.044 Test Loss: 3.308 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4828922748565674
Epoch: 2, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.330 Vali Acc: 0.079 Test Loss: 3.330 Test Acc: 0.079
Validation loss decreased (-0.043496 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 0.5050170421600342
Epoch: 3, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.346 Vali Acc: 0.098 Test Loss: 3.346 Test Acc: 0.098
Validation loss decreased (-0.078790 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.5248804092407227
Epoch: 4, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.241 Vali Acc: 0.131 Test Loss: 3.241 Test Acc: 0.131
Validation loss decreased (-0.097614 --> -0.130556).  Saving model ...
Epoch: 5 cost time: 0.46642136573791504
Epoch: 5, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.225 Vali Acc: 0.156 Test Loss: 3.225 Test Acc: 0.156
Validation loss decreased (-0.130556 --> -0.156438).  Saving model ...
Epoch: 6 cost time: 0.514514684677124
Epoch: 6, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.310 Vali Acc: 0.168 Test Loss: 3.310 Test Acc: 0.168
Validation loss decreased (-0.156438 --> -0.168202).  Saving model ...
Epoch: 7 cost time: 0.46569204330444336
Epoch: 7, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.370 Vali Acc: 0.213 Test Loss: 3.370 Test Acc: 0.213
Validation loss decreased (-0.168202 --> -0.212907).  Saving model ...
Epoch: 8 cost time: 0.4640669822692871
Epoch: 8, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.458 Vali Acc: 0.219 Test Loss: 3.458 Test Acc: 0.219
Validation loss decreased (-0.212907 --> -0.218789).  Saving model ...
Epoch: 9 cost time: 0.506554126739502
Epoch: 9, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.587 Vali Acc: 0.233 Test Loss: 3.587 Test Acc: 0.233
Validation loss decreased (-0.218789 --> -0.232905).  Saving model ...
Epoch: 10 cost time: 0.45949864387512207
Epoch: 10, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.698 Vali Acc: 0.229 Test Loss: 3.698 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4894685745239258
Epoch: 11, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.891 Vali Acc: 0.235 Test Loss: 3.891 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235255).  Saving model ...
Epoch: 12 cost time: 0.4968082904815674
Epoch: 12, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.907 Vali Acc: 0.247 Test Loss: 3.907 Test Acc: 0.247
Validation loss decreased (-0.235255 --> -0.247020).  Saving model ...
Epoch: 13 cost time: 0.4399731159210205
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.027 Vali Acc: 0.251 Test Loss: 4.027 Test Acc: 0.251
Validation loss decreased (-0.247020 --> -0.250548).  Saving model ...
Epoch: 14 cost time: 0.4704165458679199
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.299 Vali Acc: 0.233 Test Loss: 4.299 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.49155664443969727
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.351 Vali Acc: 0.240 Test Loss: 4.351 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.44774746894836426
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.399 Vali Acc: 0.234 Test Loss: 4.399 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4228804111480713
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.458 Vali Acc: 0.240 Test Loss: 4.458 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4439554214477539
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.557 Vali Acc: 0.239 Test Loss: 4.557 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.443927526473999
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.590 Vali Acc: 0.238 Test Loss: 4.590 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4323465824127197
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.607 Vali Acc: 0.246 Test Loss: 4.607 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.36780762672424316
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.655 Vali Acc: 0.251 Test Loss: 4.655 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4381217956542969
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.678 Vali Acc: 0.252 Test Loss: 4.678 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251718).  Saving model ...
Epoch: 23 cost time: 0.45258378982543945
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.723 Vali Acc: 0.244 Test Loss: 4.723 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4746429920196533
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.749 Vali Acc: 0.244 Test Loss: 4.749 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.44829249382019043
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.762 Vali Acc: 0.249 Test Loss: 4.762 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.46260499954223633
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.796 Vali Acc: 0.251 Test Loss: 4.796 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.42971181869506836
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.825 Vali Acc: 0.256 Test Loss: 4.825 Test Acc: 0.256
Validation loss decreased (-0.251718 --> -0.256422).  Saving model ...
Epoch: 28 cost time: 0.42429661750793457
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.851 Vali Acc: 0.251 Test Loss: 4.851 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.44893884658813477
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.868 Vali Acc: 0.251 Test Loss: 4.868 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.39882326126098633
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.872 Vali Acc: 0.254 Test Loss: 4.872 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5218231678009033
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.887 Vali Acc: 0.253 Test Loss: 4.887 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5038444995880127
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.914 Vali Acc: 0.252 Test Loss: 4.914 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4682426452636719
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.935 Vali Acc: 0.252 Test Loss: 4.935 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5036418437957764
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.950 Vali Acc: 0.253 Test Loss: 4.950 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.49492359161376953
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.977 Vali Acc: 0.256 Test Loss: 4.977 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4345710277557373
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.979 Vali Acc: 0.256 Test Loss: 4.979 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5054123401641846
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.976 Vali Acc: 0.255 Test Loss: 4.976 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 383898
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.489109754562378
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.343 Vali Acc: 0.044 Test Loss: 3.343 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4510767459869385
Epoch: 2, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.347 Vali Acc: 0.071 Test Loss: 3.347 Test Acc: 0.071
Validation loss decreased (-0.043496 --> -0.070555).  Saving model ...
Epoch: 3 cost time: 0.44028401374816895
Epoch: 3, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.350 Vali Acc: 0.088 Test Loss: 3.350 Test Acc: 0.088
Validation loss decreased (-0.070555 --> -0.088202).  Saving model ...
Epoch: 4 cost time: 0.426342248916626
Epoch: 4, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.278 Vali Acc: 0.131 Test Loss: 3.278 Test Acc: 0.131
Validation loss decreased (-0.088202 --> -0.130555).  Saving model ...
Epoch: 5 cost time: 0.43842244148254395
Epoch: 5, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.252 Vali Acc: 0.159 Test Loss: 3.252 Test Acc: 0.159
Validation loss decreased (-0.130555 --> -0.158791).  Saving model ...
Epoch: 6 cost time: 0.4734385013580322
Epoch: 6, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.294 Vali Acc: 0.173 Test Loss: 3.294 Test Acc: 0.173
Validation loss decreased (-0.158791 --> -0.172908).  Saving model ...
Epoch: 7 cost time: 0.4481971263885498
Epoch: 7, Steps: 10 | Train Loss: 1.281 Vali Loss: 3.334 Vali Acc: 0.195 Test Loss: 3.334 Test Acc: 0.195
Validation loss decreased (-0.172908 --> -0.195261).  Saving model ...
Epoch: 8 cost time: 0.4236717224121094
Epoch: 8, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.383 Vali Acc: 0.224 Test Loss: 3.383 Test Acc: 0.224
Validation loss decreased (-0.195261 --> -0.223496).  Saving model ...
Epoch: 9 cost time: 0.4508328437805176
Epoch: 9, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.474 Vali Acc: 0.208 Test Loss: 3.474 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4394352436065674
Epoch: 10, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.575 Vali Acc: 0.228 Test Loss: 3.575 Test Acc: 0.228
Validation loss decreased (-0.223496 --> -0.228200).  Saving model ...
Epoch: 11 cost time: 0.4591681957244873
Epoch: 11, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.660 Vali Acc: 0.232 Test Loss: 3.660 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231728).  Saving model ...
Epoch: 12 cost time: 0.445742130279541
Epoch: 12, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.743 Vali Acc: 0.244 Test Loss: 3.743 Test Acc: 0.244
Validation loss decreased (-0.231728 --> -0.243492).  Saving model ...
Epoch: 13 cost time: 0.4073357582092285
Epoch: 13, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.953 Vali Acc: 0.229 Test Loss: 3.953 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3946824073791504
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.996 Vali Acc: 0.254 Test Loss: 3.996 Test Acc: 0.254
Validation loss decreased (-0.243492 --> -0.254078).  Saving model ...
Epoch: 15 cost time: 0.4487743377685547
Epoch: 15, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.158 Vali Acc: 0.242 Test Loss: 4.158 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4689650535583496
Epoch: 16, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.235 Vali Acc: 0.249 Test Loss: 4.235 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.40413904190063477
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.375 Vali Acc: 0.245 Test Loss: 4.375 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4196295738220215
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.332 Vali Acc: 0.251 Test Loss: 4.332 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4110219478607178
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.379 Vali Acc: 0.252 Test Loss: 4.379 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5006983280181885
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.467 Vali Acc: 0.253 Test Loss: 4.467 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.43320631980895996
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.586 Vali Acc: 0.248 Test Loss: 4.586 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.42697858810424805
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.582 Vali Acc: 0.253 Test Loss: 4.582 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4117298126220703
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.572 Vali Acc: 0.253 Test Loss: 4.572 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.45047426223754883
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.587 Vali Acc: 0.252 Test Loss: 4.587 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 324506
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5990538597106934
Epoch: 1, Steps: 10 | Train Loss: 3.460 Vali Loss: 3.375 Vali Acc: 0.041 Test Loss: 3.375 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.42103123664855957
Epoch: 2, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.359 Vali Acc: 0.064 Test Loss: 3.359 Test Acc: 0.064
Validation loss decreased (-0.041143 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.4420335292816162
Epoch: 3, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.351 Vali Acc: 0.089 Test Loss: 3.351 Test Acc: 0.089
Validation loss decreased (-0.063496 --> -0.089378).  Saving model ...
Epoch: 4 cost time: 0.3912053108215332
Epoch: 4, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.335 Vali Acc: 0.099 Test Loss: 3.335 Test Acc: 0.099
Validation loss decreased (-0.089378 --> -0.098790).  Saving model ...
Epoch: 5 cost time: 0.4440650939941406
Epoch: 5, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.312 Vali Acc: 0.125 Test Loss: 3.312 Test Acc: 0.125
Validation loss decreased (-0.098790 --> -0.124673).  Saving model ...
Epoch: 6 cost time: 0.425098180770874
Epoch: 6, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.289 Vali Acc: 0.141 Test Loss: 3.289 Test Acc: 0.141
Validation loss decreased (-0.124673 --> -0.141144).  Saving model ...
Epoch: 7 cost time: 0.44103550910949707
Epoch: 7, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.283 Vali Acc: 0.175 Test Loss: 3.283 Test Acc: 0.175
Validation loss decreased (-0.141144 --> -0.175261).  Saving model ...
Epoch: 8 cost time: 0.46054863929748535
Epoch: 8, Steps: 10 | Train Loss: 1.481 Vali Loss: 3.299 Vali Acc: 0.185 Test Loss: 3.299 Test Acc: 0.185
Validation loss decreased (-0.175261 --> -0.184673).  Saving model ...
Epoch: 9 cost time: 0.4579002857208252
Epoch: 9, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.329 Vali Acc: 0.200 Test Loss: 3.329 Test Acc: 0.200
Validation loss decreased (-0.184673 --> -0.199967).  Saving model ...
Epoch: 10 cost time: 0.4163665771484375
Epoch: 10, Steps: 10 | Train Loss: 0.973 Vali Loss: 3.353 Vali Acc: 0.224 Test Loss: 3.353 Test Acc: 0.224
Validation loss decreased (-0.199967 --> -0.223496).  Saving model ...
Epoch: 11 cost time: 0.4194200038909912
Epoch: 11, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.422 Vali Acc: 0.221 Test Loss: 3.422 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4326961040496826
Epoch: 12, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.489 Vali Acc: 0.245 Test Loss: 3.489 Test Acc: 0.245
Validation loss decreased (-0.223496 --> -0.244671).  Saving model ...
Epoch: 13 cost time: 0.44039225578308105
Epoch: 13, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.575 Vali Acc: 0.227 Test Loss: 3.575 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.37244176864624023
Epoch: 14, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.658 Vali Acc: 0.227 Test Loss: 3.658 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4819986820220947
Epoch: 15, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.759 Vali Acc: 0.236 Test Loss: 3.759 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4398174285888672
Epoch: 16, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.843 Vali Acc: 0.244 Test Loss: 3.843 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.48779821395874023
Epoch: 17, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.939 Vali Acc: 0.236 Test Loss: 3.939 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.418687105178833
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.025 Vali Acc: 0.238 Test Loss: 4.025 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.42782044410705566
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.040 Vali Acc: 0.244 Test Loss: 4.040 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3938174247741699
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.093 Vali Acc: 0.249 Test Loss: 4.093 Test Acc: 0.249
Validation loss decreased (-0.244671 --> -0.249371).  Saving model ...
Epoch: 21 cost time: 0.4157068729400635
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.153 Vali Acc: 0.265 Test Loss: 4.153 Test Acc: 0.265
Validation loss decreased (-0.249371 --> -0.264664).  Saving model ...
Epoch: 22 cost time: 0.41049861907958984
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.209 Vali Acc: 0.262 Test Loss: 4.209 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5295493602752686
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.220 Vali Acc: 0.265 Test Loss: 4.220 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.40454721450805664
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.254 Vali Acc: 0.267 Test Loss: 4.254 Test Acc: 0.267
Validation loss decreased (-0.264664 --> -0.267016).  Saving model ...
Epoch: 25 cost time: 0.4263768196105957
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.341 Vali Acc: 0.256 Test Loss: 4.341 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5689425468444824
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.369 Vali Acc: 0.256 Test Loss: 4.369 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5839898586273193
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.357 Vali Acc: 0.260 Test Loss: 4.357 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3862931728363037
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.354 Vali Acc: 0.267 Test Loss: 4.354 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.45047688484191895
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.377 Vali Acc: 0.259 Test Loss: 4.377 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.46204590797424316
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.394 Vali Acc: 0.262 Test Loss: 4.394 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.42556118965148926
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.420 Vali Acc: 0.266 Test Loss: 4.420 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5314590930938721
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.434 Vali Acc: 0.265 Test Loss: 4.434 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5358467102050781
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.459 Vali Acc: 0.265 Test Loss: 4.459 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.44817686080932617
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.466 Vali Acc: 0.265 Test Loss: 4.466 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 255514
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4436736106872559
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.322 Vali Acc: 0.044 Test Loss: 3.322 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4232139587402344
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.286 Vali Acc: 0.056 Test Loss: 3.286 Test Acc: 0.056
Validation loss decreased (-0.043496 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.39763689041137695
Epoch: 3, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.265 Vali Acc: 0.080 Test Loss: 3.265 Test Acc: 0.080
Validation loss decreased (-0.056438 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.3756563663482666
Epoch: 4, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.266 Vali Acc: 0.101 Test Loss: 3.266 Test Acc: 0.101
Validation loss decreased (-0.079967 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.42322683334350586
Epoch: 5, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.259 Vali Acc: 0.125 Test Loss: 3.259 Test Acc: 0.125
Validation loss decreased (-0.101144 --> -0.124673).  Saving model ...
Epoch: 6 cost time: 0.43056631088256836
Epoch: 6, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.260 Vali Acc: 0.134 Test Loss: 3.260 Test Acc: 0.134
Validation loss decreased (-0.124673 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.41758275032043457
Epoch: 7, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.259 Vali Acc: 0.156 Test Loss: 3.259 Test Acc: 0.156
Validation loss decreased (-0.134085 --> -0.156438).  Saving model ...
Epoch: 8 cost time: 0.3982713222503662
Epoch: 8, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.249 Vali Acc: 0.175 Test Loss: 3.249 Test Acc: 0.175
Validation loss decreased (-0.156438 --> -0.175262).  Saving model ...
Epoch: 9 cost time: 0.395876407623291
Epoch: 9, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.246 Vali Acc: 0.185 Test Loss: 3.246 Test Acc: 0.185
Validation loss decreased (-0.175262 --> -0.184673).  Saving model ...
Epoch: 10 cost time: 0.43497300148010254
Epoch: 10, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.280 Vali Acc: 0.204 Test Loss: 3.280 Test Acc: 0.204
Validation loss decreased (-0.184673 --> -0.203497).  Saving model ...
Epoch: 11 cost time: 0.34059691429138184
Epoch: 11, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.322 Vali Acc: 0.206 Test Loss: 3.322 Test Acc: 0.206
Validation loss decreased (-0.203497 --> -0.205849).  Saving model ...
Epoch: 12 cost time: 0.4325435161590576
Epoch: 12, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.391 Vali Acc: 0.212 Test Loss: 3.391 Test Acc: 0.212
Validation loss decreased (-0.205849 --> -0.211731).  Saving model ...
Epoch: 13 cost time: 0.39284753799438477
Epoch: 13, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.449 Vali Acc: 0.224 Test Loss: 3.449 Test Acc: 0.224
Validation loss decreased (-0.211731 --> -0.223495).  Saving model ...
Epoch: 14 cost time: 0.4198026657104492
Epoch: 14, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.529 Vali Acc: 0.224 Test Loss: 3.529 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3918454647064209
Epoch: 15, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.610 Vali Acc: 0.234 Test Loss: 3.610 Test Acc: 0.234
Validation loss decreased (-0.223495 --> -0.234082).  Saving model ...
Epoch: 16 cost time: 0.40132927894592285
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.677 Vali Acc: 0.227 Test Loss: 3.677 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4082000255584717
Epoch: 17, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.765 Vali Acc: 0.235 Test Loss: 3.765 Test Acc: 0.235
Validation loss decreased (-0.234082 --> -0.235256).  Saving model ...
Epoch: 18 cost time: 0.39283180236816406
Epoch: 18, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.826 Vali Acc: 0.246 Test Loss: 3.826 Test Acc: 0.246
Validation loss decreased (-0.235256 --> -0.245844).  Saving model ...
Epoch: 19 cost time: 0.34044575691223145
Epoch: 19, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.904 Vali Acc: 0.249 Test Loss: 3.904 Test Acc: 0.249
Validation loss decreased (-0.245844 --> -0.249373).  Saving model ...
Epoch: 20 cost time: 0.39601659774780273
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.956 Vali Acc: 0.251 Test Loss: 3.956 Test Acc: 0.251
Validation loss decreased (-0.249373 --> -0.250549).  Saving model ...
Epoch: 21 cost time: 0.39548301696777344
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.011 Vali Acc: 0.251 Test Loss: 4.011 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4111762046813965
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.073 Vali Acc: 0.251 Test Loss: 4.073 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3832132816314697
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.074 Vali Acc: 0.253 Test Loss: 4.074 Test Acc: 0.253
Validation loss decreased (-0.250549 --> -0.252900).  Saving model ...
Epoch: 24 cost time: 0.4080677032470703
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.113 Vali Acc: 0.247 Test Loss: 4.113 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.37811994552612305
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.160 Vali Acc: 0.248 Test Loss: 4.160 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.37355637550354004
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.202 Vali Acc: 0.251 Test Loss: 4.202 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3241138458251953
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.244 Vali Acc: 0.255 Test Loss: 4.244 Test Acc: 0.255
Validation loss decreased (-0.252900 --> -0.255252).  Saving model ...
Epoch: 28 cost time: 0.5079250335693359
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.262 Vali Acc: 0.258 Test Loss: 4.262 Test Acc: 0.258
Validation loss decreased (-0.255252 --> -0.257604).  Saving model ...
Epoch: 29 cost time: 0.3930938243865967
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.267 Vali Acc: 0.264 Test Loss: 4.267 Test Acc: 0.264
Validation loss decreased (-0.257604 --> -0.263487).  Saving model ...
Epoch: 30 cost time: 0.3880476951599121
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.287 Vali Acc: 0.265 Test Loss: 4.287 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264663).  Saving model ...
Epoch: 31 cost time: 0.3735980987548828
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.306 Vali Acc: 0.262 Test Loss: 4.306 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4563868045806885
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.337 Vali Acc: 0.266 Test Loss: 4.337 Test Acc: 0.266
Validation loss decreased (-0.264663 --> -0.265839).  Saving model ...
Epoch: 33 cost time: 0.4309685230255127
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.352 Vali Acc: 0.262 Test Loss: 4.352 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4439234733581543
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.382 Vali Acc: 0.266 Test Loss: 4.382 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4609692096710205
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.398 Vali Acc: 0.262 Test Loss: 4.398 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.42502737045288086
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.421 Vali Acc: 0.260 Test Loss: 4.421 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4307875633239746
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.449 Vali Acc: 0.265 Test Loss: 4.449 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.40700626373291016
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.464 Vali Acc: 0.264 Test Loss: 4.464 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.41010403633117676
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.469 Vali Acc: 0.262 Test Loss: 4.469 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4555518627166748
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.485 Vali Acc: 0.264 Test Loss: 4.485 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.43213844299316406
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.498 Vali Acc: 0.261 Test Loss: 4.498 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.48078322410583496
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.509 Vali Acc: 0.260 Test Loss: 4.509 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 226586
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4804809093475342
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.357 Vali Acc: 0.072 Test Loss: 3.357 Test Acc: 0.072
Validation loss decreased (inf --> -0.071731).  Saving model ...
Epoch: 2 cost time: 0.4049670696258545
Epoch: 2, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.318 Vali Acc: 0.059 Test Loss: 3.318 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.3864767551422119
Epoch: 3, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.298 Vali Acc: 0.075 Test Loss: 3.298 Test Acc: 0.075
Validation loss decreased (-0.071731 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.4358656406402588
Epoch: 4, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.301 Vali Acc: 0.092 Test Loss: 3.301 Test Acc: 0.092
Validation loss decreased (-0.075261 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 0.4042224884033203
Epoch: 5, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.291 Vali Acc: 0.122 Test Loss: 3.291 Test Acc: 0.122
Validation loss decreased (-0.091732 --> -0.122320).  Saving model ...
Epoch: 6 cost time: 0.41477131843566895
Epoch: 6, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.277 Vali Acc: 0.140 Test Loss: 3.277 Test Acc: 0.140
Validation loss decreased (-0.122320 --> -0.139967).  Saving model ...
Epoch: 7 cost time: 0.42648911476135254
Epoch: 7, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.280 Vali Acc: 0.142 Test Loss: 3.280 Test Acc: 0.142
Validation loss decreased (-0.139967 --> -0.142320).  Saving model ...
Epoch: 8 cost time: 0.3995857238769531
Epoch: 8, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.286 Vali Acc: 0.153 Test Loss: 3.286 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152908).  Saving model ...
Epoch: 9 cost time: 0.41958117485046387
Epoch: 9, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.297 Vali Acc: 0.168 Test Loss: 3.297 Test Acc: 0.168
Validation loss decreased (-0.152908 --> -0.168202).  Saving model ...
Epoch: 10 cost time: 0.44716882705688477
Epoch: 10, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.316 Vali Acc: 0.179 Test Loss: 3.316 Test Acc: 0.179
Validation loss decreased (-0.168202 --> -0.178790).  Saving model ...
Epoch: 11 cost time: 0.4689478874206543
Epoch: 11, Steps: 10 | Train Loss: 1.235 Vali Loss: 3.343 Vali Acc: 0.188 Test Loss: 3.343 Test Acc: 0.188
Validation loss decreased (-0.178790 --> -0.188202).  Saving model ...
Epoch: 12 cost time: 0.40712928771972656
Epoch: 12, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.359 Vali Acc: 0.193 Test Loss: 3.359 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 13 cost time: 0.44540953636169434
Epoch: 13, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.414 Vali Acc: 0.204 Test Loss: 3.414 Test Acc: 0.204
Validation loss decreased (-0.192908 --> -0.203495).  Saving model ...
Epoch: 14 cost time: 0.4051346778869629
Epoch: 14, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.466 Vali Acc: 0.207 Test Loss: 3.466 Test Acc: 0.207
Validation loss decreased (-0.203495 --> -0.207024).  Saving model ...
Epoch: 15 cost time: 0.40692877769470215
Epoch: 15, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.520 Vali Acc: 0.214 Test Loss: 3.520 Test Acc: 0.214
Validation loss decreased (-0.207024 --> -0.214082).  Saving model ...
Epoch: 16 cost time: 0.42261338233947754
Epoch: 16, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.594 Vali Acc: 0.231 Test Loss: 3.594 Test Acc: 0.231
Validation loss decreased (-0.214082 --> -0.230552).  Saving model ...
Epoch: 17 cost time: 0.4030015468597412
Epoch: 17, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.640 Vali Acc: 0.236 Test Loss: 3.640 Test Acc: 0.236
Validation loss decreased (-0.230552 --> -0.236434).  Saving model ...
Epoch: 18 cost time: 0.41437268257141113
Epoch: 18, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.670 Vali Acc: 0.234 Test Loss: 3.670 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42949485778808594
Epoch: 19, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.770 Vali Acc: 0.236 Test Loss: 3.770 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.41317248344421387
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.806 Vali Acc: 0.240 Test Loss: 3.806 Test Acc: 0.240
Validation loss decreased (-0.236434 --> -0.239962).  Saving model ...
Epoch: 21 cost time: 0.4349033832550049
Epoch: 21, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.849 Vali Acc: 0.244 Test Loss: 3.849 Test Acc: 0.244
Validation loss decreased (-0.239962 --> -0.243491).  Saving model ...
Epoch: 22 cost time: 0.4615437984466553
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.883 Vali Acc: 0.242 Test Loss: 3.883 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4791581630706787
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.917 Vali Acc: 0.248 Test Loss: 3.917 Test Acc: 0.248
Validation loss decreased (-0.243491 --> -0.248196).  Saving model ...
Epoch: 24 cost time: 0.43247509002685547
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.959 Vali Acc: 0.253 Test Loss: 3.959 Test Acc: 0.253
Validation loss decreased (-0.248196 --> -0.252902).  Saving model ...
Epoch: 25 cost time: 0.4659104347229004
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.976 Vali Acc: 0.256 Test Loss: 3.976 Test Acc: 0.256
Validation loss decreased (-0.252902 --> -0.256431).  Saving model ...
Epoch: 26 cost time: 0.48955297470092773
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.008 Vali Acc: 0.255 Test Loss: 4.008 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4714186191558838
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.061 Vali Acc: 0.254 Test Loss: 4.061 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.49518561363220215
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.092 Vali Acc: 0.259 Test Loss: 4.092 Test Acc: 0.259
Validation loss decreased (-0.256431 --> -0.258783).  Saving model ...
Epoch: 29 cost time: 0.45519566535949707
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.114 Vali Acc: 0.260 Test Loss: 4.114 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259959).  Saving model ...
Epoch: 30 cost time: 0.4749412536621094
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.127 Vali Acc: 0.259 Test Loss: 4.127 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4795384407043457
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.141 Vali Acc: 0.255 Test Loss: 4.141 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.42278575897216797
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.168 Vali Acc: 0.254 Test Loss: 4.168 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.40956950187683105
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.160 Vali Acc: 0.254 Test Loss: 4.160 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4423670768737793
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.177 Vali Acc: 0.260 Test Loss: 4.177 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.517117977142334
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.183 Vali Acc: 0.260 Test Loss: 4.183 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4466242790222168
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.208 Vali Acc: 0.268 Test Loss: 4.208 Test Acc: 0.268
Validation loss decreased (-0.259959 --> -0.268193).  Saving model ...
Epoch: 37 cost time: 0.48088884353637695
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.223 Vali Acc: 0.267 Test Loss: 4.223 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.48104166984558105
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.237 Vali Acc: 0.262 Test Loss: 4.237 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.46769118309020996
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.256 Vali Acc: 0.265 Test Loss: 4.256 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4404027462005615
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.273 Vali Acc: 0.269 Test Loss: 4.273 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269369).  Saving model ...
Epoch: 41 cost time: 0.42336153984069824
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.298 Vali Acc: 0.269 Test Loss: 4.298 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.45261645317077637
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.309 Vali Acc: 0.269 Test Loss: 4.309 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.45812463760375977
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.322 Vali Acc: 0.266 Test Loss: 4.322 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.46341991424560547
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.335 Vali Acc: 0.267 Test Loss: 4.335 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.43942737579345703
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.344 Vali Acc: 0.264 Test Loss: 4.344 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.42204737663269043
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.356 Vali Acc: 0.265 Test Loss: 4.356 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.4164142608642578
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.368 Vali Acc: 0.271 Test Loss: 4.368 Test Acc: 0.271
Validation loss decreased (-0.269369 --> -0.270545).  Saving model ...
Epoch: 48 cost time: 0.4387481212615967
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.380 Vali Acc: 0.266 Test Loss: 4.380 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4539313316345215
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.382 Vali Acc: 0.266 Test Loss: 4.382 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4412086009979248
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.386 Vali Acc: 0.269 Test Loss: 4.386 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5115113258361816
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.388 Vali Acc: 0.269 Test Loss: 4.388 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.446932315826416
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.415 Vali Acc: 0.271 Test Loss: 4.415 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.41349315643310547
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.422 Vali Acc: 0.268 Test Loss: 4.422 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.43809032440185547
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.434 Vali Acc: 0.266 Test Loss: 4.434 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.486316442489624
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.444 Vali Acc: 0.268 Test Loss: 4.444 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.48030805587768555
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.455 Vali Acc: 0.273 Test Loss: 4.455 Test Acc: 0.273
Validation loss decreased (-0.270545 --> -0.272897).  Saving model ...
Epoch: 57 cost time: 0.4246644973754883
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.466 Vali Acc: 0.267 Test Loss: 4.466 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5023424625396729
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.496 Vali Acc: 0.268 Test Loss: 4.496 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.46780848503112793
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.492 Vali Acc: 0.261 Test Loss: 4.492 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.43775391578674316
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.488 Vali Acc: 0.261 Test Loss: 4.488 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.4484672546386719
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.506 Vali Acc: 0.262 Test Loss: 4.506 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.4828801155090332
Epoch: 62, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.509 Vali Acc: 0.264 Test Loss: 4.509 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.449432373046875
Epoch: 63, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.531 Vali Acc: 0.267 Test Loss: 4.531 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.4354367256164551
Epoch: 64, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.540 Vali Acc: 0.268 Test Loss: 4.540 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.4464859962463379
Epoch: 65, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.555 Vali Acc: 0.269 Test Loss: 4.555 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.4433302879333496
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.558 Vali Acc: 0.271 Test Loss: 4.558 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 217498
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5736360549926758
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.394 Vali Acc: 0.051 Test Loss: 3.394 Test Acc: 0.051
Validation loss decreased (inf --> -0.050554).  Saving model ...
Epoch: 2 cost time: 0.5399506092071533
Epoch: 2, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.465 Vali Acc: 0.124 Test Loss: 3.465 Test Acc: 0.124
Validation loss decreased (-0.050554 --> -0.123495).  Saving model ...
Epoch: 3 cost time: 0.44661617279052734
Epoch: 3, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.292 Vali Acc: 0.179 Test Loss: 3.292 Test Acc: 0.179
Validation loss decreased (-0.123495 --> -0.178791).  Saving model ...
Epoch: 4 cost time: 0.5049736499786377
Epoch: 4, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.562 Vali Acc: 0.196 Test Loss: 3.562 Test Acc: 0.196
Validation loss decreased (-0.178791 --> -0.196435).  Saving model ...
Epoch: 5 cost time: 0.526832103729248
Epoch: 5, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.668 Vali Acc: 0.226 Test Loss: 3.668 Test Acc: 0.226
Validation loss decreased (-0.196435 --> -0.225846).  Saving model ...
Epoch: 6 cost time: 0.48941469192504883
Epoch: 6, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.822 Vali Acc: 0.222 Test Loss: 3.822 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.47757959365844727
Epoch: 7, Steps: 10 | Train Loss: 0.356 Vali Loss: 4.240 Vali Acc: 0.233 Test Loss: 4.240 Test Acc: 0.233
Validation loss decreased (-0.225846 --> -0.232899).  Saving model ...
Epoch: 8 cost time: 0.4781014919281006
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.445 Vali Acc: 0.245 Test Loss: 4.445 Test Acc: 0.245
Validation loss decreased (-0.232899 --> -0.244661).  Saving model ...
Epoch: 9 cost time: 0.5198361873626709
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 4.548 Vali Acc: 0.241 Test Loss: 4.548 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.46387243270874023
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.899 Vali Acc: 0.251 Test Loss: 4.899 Test Acc: 0.251
Validation loss decreased (-0.244661 --> -0.250539).  Saving model ...
Epoch: 11 cost time: 0.5500006675720215
Epoch: 11, Steps: 10 | Train Loss: 0.036 Vali Loss: 5.105 Vali Acc: 0.254 Test Loss: 5.105 Test Acc: 0.254
Validation loss decreased (-0.250539 --> -0.254067).  Saving model ...
Epoch: 12 cost time: 0.5503451824188232
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.340 Vali Acc: 0.254 Test Loss: 5.340 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47868967056274414
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.551 Vali Acc: 0.262 Test Loss: 5.551 Test Acc: 0.262
Validation loss decreased (-0.254067 --> -0.262297).  Saving model ...
Epoch: 14 cost time: 0.4704718589782715
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.667 Vali Acc: 0.255 Test Loss: 5.667 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.49581098556518555
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.701 Vali Acc: 0.255 Test Loss: 5.701 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.49307990074157715
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.763 Vali Acc: 0.262 Test Loss: 5.763 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.497161865234375
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.728 Vali Acc: 0.262 Test Loss: 5.728 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3555772304534912
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.726 Vali Acc: 0.261 Test Loss: 5.726 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4996800422668457
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.731 Vali Acc: 0.262 Test Loss: 5.731 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5377259254455566
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.761 Vali Acc: 0.266 Test Loss: 5.761 Test Acc: 0.266
Validation loss decreased (-0.262297 --> -0.265825).  Saving model ...
Epoch: 21 cost time: 0.508674144744873
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.801 Vali Acc: 0.268 Test Loss: 5.801 Test Acc: 0.268
Validation loss decreased (-0.265825 --> -0.268177).  Saving model ...
Epoch: 22 cost time: 0.5352954864501953
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.816 Vali Acc: 0.267 Test Loss: 5.816 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5166161060333252
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.844 Vali Acc: 0.268 Test Loss: 5.844 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5058410167694092
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.874 Vali Acc: 0.271 Test Loss: 5.874 Test Acc: 0.271
Validation loss decreased (-0.268177 --> -0.270529).  Saving model ...
Epoch: 25 cost time: 0.5041921138763428
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.879 Vali Acc: 0.266 Test Loss: 5.879 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.517857551574707
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.886 Vali Acc: 0.267 Test Loss: 5.886 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5973043441772461
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.911 Vali Acc: 0.274 Test Loss: 5.911 Test Acc: 0.274
Validation loss decreased (-0.270529 --> -0.274059).  Saving model ...
Epoch: 28 cost time: 0.5699212551116943
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.272 Test Loss: 5.933 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5324106216430664
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.933 Vali Acc: 0.269 Test Loss: 5.933 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5172357559204102
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.932 Vali Acc: 0.269 Test Loss: 5.932 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5444903373718262
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.936 Vali Acc: 0.269 Test Loss: 5.936 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5479757785797119
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.946 Vali Acc: 0.271 Test Loss: 5.946 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.5045580863952637
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.951 Vali Acc: 0.268 Test Loss: 5.951 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5493617057800293
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.955 Vali Acc: 0.269 Test Loss: 5.955 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5250165462493896
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.971 Vali Acc: 0.273 Test Loss: 5.971 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5571825504302979
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.985 Vali Acc: 0.272 Test Loss: 5.985 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5449256896972656
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.994 Vali Acc: 0.272 Test Loss: 5.994 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 859162
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.649078607559204
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.310 Vali Acc: 0.035 Test Loss: 3.310 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.4192016124725342
Epoch: 2, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.320 Vali Acc: 0.085 Test Loss: 3.320 Test Acc: 0.085
Validation loss decreased (-0.035261 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 0.44730043411254883
Epoch: 3, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.265 Vali Acc: 0.125 Test Loss: 3.265 Test Acc: 0.125
Validation loss decreased (-0.084673 --> -0.124673).  Saving model ...
Epoch: 4 cost time: 0.365506649017334
Epoch: 4, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.243 Vali Acc: 0.173 Test Loss: 3.243 Test Acc: 0.173
Validation loss decreased (-0.124673 --> -0.172909).  Saving model ...
Epoch: 5 cost time: 0.4191720485687256
Epoch: 5, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.355 Vali Acc: 0.188 Test Loss: 3.355 Test Acc: 0.188
Validation loss decreased (-0.172909 --> -0.188202).  Saving model ...
Epoch: 6 cost time: 0.40152430534362793
Epoch: 6, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.418 Vali Acc: 0.211 Test Loss: 3.418 Test Acc: 0.211
Validation loss decreased (-0.188202 --> -0.210554).  Saving model ...
Epoch: 7 cost time: 0.4342806339263916
Epoch: 7, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.597 Vali Acc: 0.202 Test Loss: 3.597 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4833667278289795
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.730 Vali Acc: 0.234 Test Loss: 3.730 Test Acc: 0.234
Validation loss decreased (-0.210554 --> -0.234080).  Saving model ...
Epoch: 9 cost time: 0.45468759536743164
Epoch: 9, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.827 Vali Acc: 0.232 Test Loss: 3.827 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.41851282119750977
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 4.067 Vali Acc: 0.242 Test Loss: 4.067 Test Acc: 0.242
Validation loss decreased (-0.234080 --> -0.242312).  Saving model ...
Epoch: 11 cost time: 0.4234580993652344
Epoch: 11, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.175 Vali Acc: 0.241 Test Loss: 4.175 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5410490036010742
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.353 Vali Acc: 0.242 Test Loss: 4.353 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.46188855171203613
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.509 Vali Acc: 0.259 Test Loss: 4.509 Test Acc: 0.259
Validation loss decreased (-0.242312 --> -0.258778).  Saving model ...
Epoch: 14 cost time: 0.4765512943267822
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.670 Vali Acc: 0.254 Test Loss: 4.670 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.46716904640197754
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.750 Vali Acc: 0.261 Test Loss: 4.750 Test Acc: 0.261
Validation loss decreased (-0.258778 --> -0.261129).  Saving model ...
Epoch: 16 cost time: 0.478595495223999
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.852 Vali Acc: 0.252 Test Loss: 4.852 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4728662967681885
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.827 Vali Acc: 0.260 Test Loss: 4.827 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.49912214279174805
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.877 Vali Acc: 0.255 Test Loss: 4.877 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4785497188568115
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.916 Vali Acc: 0.261 Test Loss: 4.916 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5271260738372803
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.945 Vali Acc: 0.261 Test Loss: 4.945 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.48915839195251465
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.983 Vali Acc: 0.261 Test Loss: 4.983 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5519731044769287
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.984 Vali Acc: 0.256 Test Loss: 4.984 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4884660243988037
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.006 Vali Acc: 0.256 Test Loss: 5.006 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.49127840995788574
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.023 Vali Acc: 0.255 Test Loss: 5.023 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4917902946472168
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.045 Vali Acc: 0.259 Test Loss: 5.045 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 480282
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7089531421661377
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.332 Vali Acc: 0.035 Test Loss: 3.332 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.3732290267944336
Epoch: 2, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.333 Vali Acc: 0.062 Test Loss: 3.333 Test Acc: 0.062
Validation loss decreased (-0.035261 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.46061182022094727
Epoch: 3, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.324 Vali Acc: 0.100 Test Loss: 3.324 Test Acc: 0.100
Validation loss decreased (-0.062320 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 0.45093226432800293
Epoch: 4, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.256 Vali Acc: 0.136 Test Loss: 3.256 Test Acc: 0.136
Validation loss decreased (-0.099967 --> -0.136438).  Saving model ...
Epoch: 5 cost time: 0.4634287357330322
Epoch: 5, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.231 Vali Acc: 0.174 Test Loss: 3.231 Test Acc: 0.174
Validation loss decreased (-0.136438 --> -0.174085).  Saving model ...
Epoch: 6 cost time: 0.4913763999938965
Epoch: 6, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.344 Vali Acc: 0.167 Test Loss: 3.344 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4265565872192383
Epoch: 7, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.355 Vali Acc: 0.206 Test Loss: 3.355 Test Acc: 0.206
Validation loss decreased (-0.174085 --> -0.205849).  Saving model ...
Epoch: 8 cost time: 0.45740342140197754
Epoch: 8, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.452 Vali Acc: 0.215 Test Loss: 3.452 Test Acc: 0.215
Validation loss decreased (-0.205849 --> -0.215260).  Saving model ...
Epoch: 9 cost time: 0.45131826400756836
Epoch: 9, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.581 Vali Acc: 0.225 Test Loss: 3.581 Test Acc: 0.225
Validation loss decreased (-0.215260 --> -0.224670).  Saving model ...
Epoch: 10 cost time: 0.43038511276245117
Epoch: 10, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.691 Vali Acc: 0.232 Test Loss: 3.691 Test Acc: 0.232
Validation loss decreased (-0.224670 --> -0.231728).  Saving model ...
Epoch: 11 cost time: 0.4352414608001709
Epoch: 11, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.793 Vali Acc: 0.232 Test Loss: 3.793 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46463847160339355
Epoch: 12, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.953 Vali Acc: 0.228 Test Loss: 3.953 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.44271159172058105
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.091 Vali Acc: 0.233 Test Loss: 4.091 Test Acc: 0.233
Validation loss decreased (-0.231728 --> -0.232900).  Saving model ...
Epoch: 14 cost time: 0.44513535499572754
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.198 Vali Acc: 0.248 Test Loss: 4.198 Test Acc: 0.248
Validation loss decreased (-0.232900 --> -0.248193).  Saving model ...
Epoch: 15 cost time: 0.4232769012451172
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.350 Vali Acc: 0.245 Test Loss: 4.350 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4895138740539551
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.427 Vali Acc: 0.248 Test Loss: 4.427 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3921084403991699
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.470 Vali Acc: 0.248 Test Loss: 4.470 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5233154296875
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.562 Vali Acc: 0.251 Test Loss: 4.562 Test Acc: 0.251
Validation loss decreased (-0.248193 --> -0.250543).  Saving model ...
Epoch: 19 cost time: 0.4767494201660156
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.618 Vali Acc: 0.251 Test Loss: 4.618 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5254964828491211
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.660 Vali Acc: 0.261 Test Loss: 4.660 Test Acc: 0.261
Validation loss decreased (-0.250543 --> -0.261130).  Saving model ...
Epoch: 21 cost time: 0.5302178859710693
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.679 Vali Acc: 0.248 Test Loss: 4.679 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5300865173339844
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.681 Vali Acc: 0.245 Test Loss: 4.681 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5102918148040771
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.694 Vali Acc: 0.251 Test Loss: 4.694 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5948200225830078
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.719 Vali Acc: 0.253 Test Loss: 4.719 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5275053977966309
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.748 Vali Acc: 0.255 Test Loss: 4.748 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4915463924407959
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.776 Vali Acc: 0.252 Test Loss: 4.776 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.55084228515625
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.786 Vali Acc: 0.253 Test Loss: 4.786 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4685957431793213
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.806 Vali Acc: 0.256 Test Loss: 4.806 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.495699405670166
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.818 Vali Acc: 0.258 Test Loss: 4.818 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5153853893280029
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.843 Vali Acc: 0.260 Test Loss: 4.843 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 351002
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4033071994781494
Epoch: 1, Steps: 10 | Train Loss: 3.532 Vali Loss: 3.342 Vali Acc: 0.047 Test Loss: 3.342 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.44734835624694824
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.324 Vali Acc: 0.056 Test Loss: 3.324 Test Acc: 0.056
Validation loss decreased (-0.047025 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.47371530532836914
Epoch: 3, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.335 Vali Acc: 0.079 Test Loss: 3.335 Test Acc: 0.079
Validation loss decreased (-0.056437 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.4581122398376465
Epoch: 4, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.279 Vali Acc: 0.109 Test Loss: 3.279 Test Acc: 0.109
Validation loss decreased (-0.078790 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.4477698802947998
Epoch: 5, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.250 Vali Acc: 0.156 Test Loss: 3.250 Test Acc: 0.156
Validation loss decreased (-0.109379 --> -0.156438).  Saving model ...
Epoch: 6 cost time: 0.46723341941833496
Epoch: 6, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.260 Vali Acc: 0.162 Test Loss: 3.260 Test Acc: 0.162
Validation loss decreased (-0.156438 --> -0.162320).  Saving model ...
Epoch: 7 cost time: 0.37273693084716797
Epoch: 7, Steps: 10 | Train Loss: 1.414 Vali Loss: 3.312 Vali Acc: 0.186 Test Loss: 3.312 Test Acc: 0.186
Validation loss decreased (-0.162320 --> -0.185849).  Saving model ...
Epoch: 8 cost time: 0.3956787586212158
Epoch: 8, Steps: 10 | Train Loss: 1.150 Vali Loss: 3.344 Vali Acc: 0.199 Test Loss: 3.344 Test Acc: 0.199
Validation loss decreased (-0.185849 --> -0.198790).  Saving model ...
Epoch: 9 cost time: 0.4267244338989258
Epoch: 9, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.441 Vali Acc: 0.224 Test Loss: 3.441 Test Acc: 0.224
Validation loss decreased (-0.198790 --> -0.223495).  Saving model ...
Epoch: 10 cost time: 0.3934314250946045
Epoch: 10, Steps: 10 | Train Loss: 0.651 Vali Loss: 3.510 Vali Acc: 0.212 Test Loss: 3.510 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4196155071258545
Epoch: 11, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.600 Vali Acc: 0.231 Test Loss: 3.600 Test Acc: 0.231
Validation loss decreased (-0.223495 --> -0.230552).  Saving model ...
Epoch: 12 cost time: 0.3889622688293457
Epoch: 12, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.775 Vali Acc: 0.233 Test Loss: 3.775 Test Acc: 0.233
Validation loss decreased (-0.230552 --> -0.232903).  Saving model ...
Epoch: 13 cost time: 0.39882397651672363
Epoch: 13, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.847 Vali Acc: 0.233 Test Loss: 3.847 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45899486541748047
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.979 Vali Acc: 0.234 Test Loss: 3.979 Test Acc: 0.234
Validation loss decreased (-0.232903 --> -0.234078).  Saving model ...
Epoch: 15 cost time: 0.4218931198120117
Epoch: 15, Steps: 10 | Train Loss: 0.123 Vali Loss: 4.057 Vali Acc: 0.246 Test Loss: 4.057 Test Acc: 0.246
Validation loss decreased (-0.234078 --> -0.245842).  Saving model ...
Epoch: 16 cost time: 0.39520883560180664
Epoch: 16, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.233 Vali Acc: 0.253 Test Loss: 4.233 Test Acc: 0.253
Validation loss decreased (-0.245842 --> -0.252899).  Saving model ...
Epoch: 17 cost time: 0.4786834716796875
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.317 Vali Acc: 0.247 Test Loss: 4.317 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3349330425262451
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.367 Vali Acc: 0.240 Test Loss: 4.367 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4531588554382324
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.374 Vali Acc: 0.253 Test Loss: 4.374 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4139699935913086
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.415 Vali Acc: 0.254 Test Loss: 4.415 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254073).  Saving model ...
Epoch: 21 cost time: 0.4476604461669922
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.488 Vali Acc: 0.249 Test Loss: 4.488 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.453721284866333
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.509 Vali Acc: 0.248 Test Loss: 4.509 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4531898498535156
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.526 Vali Acc: 0.251 Test Loss: 4.526 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.44911980628967285
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.552 Vali Acc: 0.251 Test Loss: 4.552 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4805333614349365
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.579 Vali Acc: 0.256 Test Loss: 4.579 Test Acc: 0.256
Validation loss decreased (-0.254073 --> -0.256425).  Saving model ...
Epoch: 26 cost time: 0.46697425842285156
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.605 Vali Acc: 0.254 Test Loss: 4.605 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5281810760498047
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.632 Vali Acc: 0.249 Test Loss: 4.632 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5010952949523926
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.666 Vali Acc: 0.256 Test Loss: 4.666 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4648113250732422
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.676 Vali Acc: 0.255 Test Loss: 4.676 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.42594289779663086
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.683 Vali Acc: 0.256 Test Loss: 4.683 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4634120464324951
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.722 Vali Acc: 0.259 Test Loss: 4.722 Test Acc: 0.259
Validation loss decreased (-0.256425 --> -0.258776).  Saving model ...
Epoch: 32 cost time: 0.4479026794433594
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.733 Vali Acc: 0.256 Test Loss: 4.733 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4368252754211426
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.752 Vali Acc: 0.255 Test Loss: 4.752 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4900319576263428
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.761 Vali Acc: 0.256 Test Loss: 4.761 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4920628070831299
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.776 Vali Acc: 0.256 Test Loss: 4.776 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4635918140411377
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.811 Vali Acc: 0.253 Test Loss: 4.811 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.48236894607543945
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.836 Vali Acc: 0.253 Test Loss: 4.836 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4845113754272461
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.839 Vali Acc: 0.255 Test Loss: 4.839 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3923616409301758
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.847 Vali Acc: 0.256 Test Loss: 4.847 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5108616352081299
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.865 Vali Acc: 0.254 Test Loss: 4.865 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4080681800842285
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.871 Vali Acc: 0.254 Test Loss: 4.871 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 291610
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4777965545654297
Epoch: 1, Steps: 10 | Train Loss: 3.431 Vali Loss: 3.387 Vali Acc: 0.039 Test Loss: 3.387 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.43369603157043457
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.341 Vali Acc: 0.047 Test Loss: 3.341 Test Acc: 0.047
Validation loss decreased (-0.038790 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.48416972160339355
Epoch: 3, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.320 Vali Acc: 0.084 Test Loss: 3.320 Test Acc: 0.084
Validation loss decreased (-0.047025 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.3976113796234131
Epoch: 4, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.312 Vali Acc: 0.102 Test Loss: 3.312 Test Acc: 0.102
Validation loss decreased (-0.083496 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.4321553707122803
Epoch: 5, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.281 Vali Acc: 0.128 Test Loss: 3.281 Test Acc: 0.128
Validation loss decreased (-0.102320 --> -0.128202).  Saving model ...
Epoch: 6 cost time: 0.4207601547241211
Epoch: 6, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.256 Vali Acc: 0.147 Test Loss: 3.256 Test Acc: 0.147
Validation loss decreased (-0.128202 --> -0.147026).  Saving model ...
Epoch: 7 cost time: 0.3530910015106201
Epoch: 7, Steps: 10 | Train Loss: 1.759 Vali Loss: 3.268 Vali Acc: 0.164 Test Loss: 3.268 Test Acc: 0.164
Validation loss decreased (-0.147026 --> -0.163497).  Saving model ...
Epoch: 8 cost time: 0.46776485443115234
Epoch: 8, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.287 Vali Acc: 0.181 Test Loss: 3.287 Test Acc: 0.181
Validation loss decreased (-0.163497 --> -0.181144).  Saving model ...
Epoch: 9 cost time: 0.43669891357421875
Epoch: 9, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.336 Vali Acc: 0.194 Test Loss: 3.336 Test Acc: 0.194
Validation loss decreased (-0.181144 --> -0.194084).  Saving model ...
Epoch: 10 cost time: 0.4061870574951172
Epoch: 10, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.379 Vali Acc: 0.204 Test Loss: 3.379 Test Acc: 0.204
Validation loss decreased (-0.194084 --> -0.203496).  Saving model ...
Epoch: 11 cost time: 0.45881175994873047
Epoch: 11, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.448 Vali Acc: 0.219 Test Loss: 3.448 Test Acc: 0.219
Validation loss decreased (-0.203496 --> -0.218789).  Saving model ...
Epoch: 12 cost time: 0.46405553817749023
Epoch: 12, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.503 Vali Acc: 0.231 Test Loss: 3.503 Test Acc: 0.231
Validation loss decreased (-0.218789 --> -0.230553).  Saving model ...
Epoch: 13 cost time: 0.4539499282836914
Epoch: 13, Steps: 10 | Train Loss: 0.494 Vali Loss: 3.553 Vali Acc: 0.236 Test Loss: 3.553 Test Acc: 0.236
Validation loss decreased (-0.230553 --> -0.236435).  Saving model ...
Epoch: 14 cost time: 0.4412515163421631
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.675 Vali Acc: 0.241 Test Loss: 3.675 Test Acc: 0.241
Validation loss decreased (-0.236435 --> -0.241140).  Saving model ...
Epoch: 15 cost time: 0.4767136573791504
Epoch: 15, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.718 Vali Acc: 0.254 Test Loss: 3.718 Test Acc: 0.254
Validation loss decreased (-0.241140 --> -0.254080).  Saving model ...
Epoch: 16 cost time: 0.43474578857421875
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.822 Vali Acc: 0.252 Test Loss: 3.822 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4509420394897461
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.904 Vali Acc: 0.251 Test Loss: 3.904 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.40914106369018555
Epoch: 18, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.987 Vali Acc: 0.259 Test Loss: 3.987 Test Acc: 0.259
Validation loss decreased (-0.254080 --> -0.258784).  Saving model ...
Epoch: 19 cost time: 0.43262577056884766
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.062 Vali Acc: 0.258 Test Loss: 4.062 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4427027702331543
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.156 Vali Acc: 0.246 Test Loss: 4.156 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4284689426422119
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.178 Vali Acc: 0.252 Test Loss: 4.178 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4416463375091553
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.195 Vali Acc: 0.261 Test Loss: 4.195 Test Acc: 0.261
Validation loss decreased (-0.258784 --> -0.261135).  Saving model ...
Epoch: 23 cost time: 0.4343068599700928
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.216 Vali Acc: 0.261 Test Loss: 4.216 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4631690979003906
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.218 Vali Acc: 0.262 Test Loss: 4.218 Test Acc: 0.262
Validation loss decreased (-0.261135 --> -0.262311).  Saving model ...
Epoch: 25 cost time: 0.45891642570495605
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.244 Vali Acc: 0.260 Test Loss: 4.244 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4418609142303467
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.287 Vali Acc: 0.268 Test Loss: 4.287 Test Acc: 0.268
Validation loss decreased (-0.262311 --> -0.268192).  Saving model ...
Epoch: 27 cost time: 0.4447462558746338
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.303 Vali Acc: 0.266 Test Loss: 4.303 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3973510265350342
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.320 Vali Acc: 0.266 Test Loss: 4.320 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.48611998558044434
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.356 Vali Acc: 0.269 Test Loss: 4.356 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 30 cost time: 0.4230661392211914
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.406 Vali Acc: 0.266 Test Loss: 4.406 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4499344825744629
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.422 Vali Acc: 0.267 Test Loss: 4.422 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.454531192779541
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.452 Vali Acc: 0.265 Test Loss: 4.452 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4905734062194824
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.453 Vali Acc: 0.268 Test Loss: 4.453 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4336526393890381
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.468 Vali Acc: 0.273 Test Loss: 4.468 Test Acc: 0.273
Validation loss decreased (-0.269368 --> -0.272896).  Saving model ...
Epoch: 35 cost time: 0.4422621726989746
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.482 Vali Acc: 0.272 Test Loss: 4.482 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4577662944793701
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.499 Vali Acc: 0.271 Test Loss: 4.499 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.43169355392456055
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.495 Vali Acc: 0.272 Test Loss: 4.495 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.44962024688720703
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.503 Vali Acc: 0.278 Test Loss: 4.503 Test Acc: 0.278
Validation loss decreased (-0.272896 --> -0.277602).  Saving model ...
Epoch: 39 cost time: 0.4514636993408203
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.506 Vali Acc: 0.275 Test Loss: 4.506 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.43172168731689453
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.526 Vali Acc: 0.278 Test Loss: 4.526 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.42398643493652344
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.544 Vali Acc: 0.276 Test Loss: 4.544 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4547703266143799
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.565 Vali Acc: 0.273 Test Loss: 4.565 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4401075839996338
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.595 Vali Acc: 0.275 Test Loss: 4.595 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.45705175399780273
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.601 Vali Acc: 0.272 Test Loss: 4.601 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.43871426582336426
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.608 Vali Acc: 0.274 Test Loss: 4.608 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.46617746353149414
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.621 Vali Acc: 0.276 Test Loss: 4.621 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4329075813293457
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.628 Vali Acc: 0.276 Test Loss: 4.628 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.44462060928344727
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.641 Vali Acc: 0.275 Test Loss: 4.641 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 222618
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4214003086090088
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.383 Vali Acc: 0.038 Test Loss: 3.383 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.45642685890197754
Epoch: 2, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.340 Vali Acc: 0.062 Test Loss: 3.340 Test Acc: 0.062
Validation loss decreased (-0.037613 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.4719696044921875
Epoch: 3, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.312 Vali Acc: 0.091 Test Loss: 3.312 Test Acc: 0.091
Validation loss decreased (-0.062320 --> -0.090555).  Saving model ...
Epoch: 4 cost time: 0.44188809394836426
Epoch: 4, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.301 Vali Acc: 0.107 Test Loss: 3.301 Test Acc: 0.107
Validation loss decreased (-0.090555 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.4554407596588135
Epoch: 5, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.304 Vali Acc: 0.127 Test Loss: 3.304 Test Acc: 0.127
Validation loss decreased (-0.107026 --> -0.127026).  Saving model ...
Epoch: 6 cost time: 0.4719266891479492
Epoch: 6, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.286 Vali Acc: 0.146 Test Loss: 3.286 Test Acc: 0.146
Validation loss decreased (-0.127026 --> -0.145849).  Saving model ...
Epoch: 7 cost time: 0.45384788513183594
Epoch: 7, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.264 Vali Acc: 0.165 Test Loss: 3.264 Test Acc: 0.165
Validation loss decreased (-0.145849 --> -0.164673).  Saving model ...
Epoch: 8 cost time: 0.46088504791259766
Epoch: 8, Steps: 10 | Train Loss: 1.759 Vali Loss: 3.272 Vali Acc: 0.172 Test Loss: 3.272 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171732).  Saving model ...
Epoch: 9 cost time: 0.43309926986694336
Epoch: 9, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.287 Vali Acc: 0.175 Test Loss: 3.287 Test Acc: 0.175
Validation loss decreased (-0.171732 --> -0.175261).  Saving model ...
Epoch: 10 cost time: 0.4721815586090088
Epoch: 10, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.333 Vali Acc: 0.191 Test Loss: 3.333 Test Acc: 0.191
Validation loss decreased (-0.175261 --> -0.190555).  Saving model ...
Epoch: 11 cost time: 0.35218143463134766
Epoch: 11, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.391 Vali Acc: 0.204 Test Loss: 3.391 Test Acc: 0.204
Validation loss decreased (-0.190555 --> -0.203496).  Saving model ...
Epoch: 12 cost time: 0.43889856338500977
Epoch: 12, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.431 Vali Acc: 0.206 Test Loss: 3.431 Test Acc: 0.206
Validation loss decreased (-0.203496 --> -0.205848).  Saving model ...
Epoch: 13 cost time: 0.44165468215942383
Epoch: 13, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.483 Vali Acc: 0.212 Test Loss: 3.483 Test Acc: 0.212
Validation loss decreased (-0.205848 --> -0.211730).  Saving model ...
Epoch: 14 cost time: 0.4224112033843994
Epoch: 14, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.553 Vali Acc: 0.219 Test Loss: 3.553 Test Acc: 0.219
Validation loss decreased (-0.211730 --> -0.218788).  Saving model ...
Epoch: 15 cost time: 0.493680477142334
Epoch: 15, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.617 Vali Acc: 0.228 Test Loss: 3.617 Test Acc: 0.228
Validation loss decreased (-0.218788 --> -0.228199).  Saving model ...
Epoch: 16 cost time: 0.48713064193725586
Epoch: 16, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.685 Vali Acc: 0.239 Test Loss: 3.685 Test Acc: 0.239
Validation loss decreased (-0.228199 --> -0.238787).  Saving model ...
Epoch: 17 cost time: 0.4173908233642578
Epoch: 17, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.775 Vali Acc: 0.242 Test Loss: 3.775 Test Acc: 0.242
Validation loss decreased (-0.238787 --> -0.242315).  Saving model ...
Epoch: 18 cost time: 0.416731595993042
Epoch: 18, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.821 Vali Acc: 0.255 Test Loss: 3.821 Test Acc: 0.255
Validation loss decreased (-0.242315 --> -0.255256).  Saving model ...
Epoch: 19 cost time: 0.42864513397216797
Epoch: 19, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.923 Vali Acc: 0.242 Test Loss: 3.923 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.40780019760131836
Epoch: 20, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.990 Vali Acc: 0.252 Test Loss: 3.990 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4781808853149414
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.061 Vali Acc: 0.256 Test Loss: 4.061 Test Acc: 0.256
Validation loss decreased (-0.255256 --> -0.256430).  Saving model ...
Epoch: 22 cost time: 0.42858290672302246
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.111 Vali Acc: 0.256 Test Loss: 4.111 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.43068957328796387
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.143 Vali Acc: 0.251 Test Loss: 4.143 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4446835517883301
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.189 Vali Acc: 0.251 Test Loss: 4.189 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4433901309967041
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.219 Vali Acc: 0.248 Test Loss: 4.219 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.43507933616638184
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.250 Vali Acc: 0.254 Test Loss: 4.250 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4255843162536621
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.263 Vali Acc: 0.251 Test Loss: 4.263 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.46535325050354004
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.279 Vali Acc: 0.252 Test Loss: 4.279 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4503333568572998
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.310 Vali Acc: 0.253 Test Loss: 4.310 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4839601516723633
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.340 Vali Acc: 0.252 Test Loss: 4.340 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4578101634979248
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.367 Vali Acc: 0.256 Test Loss: 4.367 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 193690
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3926918506622314
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.337 Vali Acc: 0.033 Test Loss: 3.337 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.4759256839752197
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.305 Vali Acc: 0.040 Test Loss: 3.305 Test Acc: 0.040
Validation loss decreased (-0.032908 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.4392244815826416
Epoch: 3, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.291 Vali Acc: 0.067 Test Loss: 3.291 Test Acc: 0.067
Validation loss decreased (-0.039967 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.4800527095794678
Epoch: 4, Steps: 10 | Train Loss: 2.839 Vali Loss: 3.281 Vali Acc: 0.086 Test Loss: 3.281 Test Acc: 0.086
Validation loss decreased (-0.067026 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.4667022228240967
Epoch: 5, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.285 Vali Acc: 0.107 Test Loss: 3.285 Test Acc: 0.107
Validation loss decreased (-0.085850 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 0.46729540824890137
Epoch: 6, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.278 Vali Acc: 0.125 Test Loss: 3.278 Test Acc: 0.125
Validation loss decreased (-0.107026 --> -0.124673).  Saving model ...
Epoch: 7 cost time: 0.44586753845214844
Epoch: 7, Steps: 10 | Train Loss: 2.179 Vali Loss: 3.281 Vali Acc: 0.138 Test Loss: 3.281 Test Acc: 0.138
Validation loss decreased (-0.124673 --> -0.137614).  Saving model ...
Epoch: 8 cost time: 0.4655449390411377
Epoch: 8, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.279 Vali Acc: 0.161 Test Loss: 3.279 Test Acc: 0.161
Validation loss decreased (-0.137614 --> -0.161144).  Saving model ...
Epoch: 9 cost time: 0.4746859073638916
Epoch: 9, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.283 Vali Acc: 0.169 Test Loss: 3.283 Test Acc: 0.169
Validation loss decreased (-0.161144 --> -0.169379).  Saving model ...
Epoch: 10 cost time: 0.48428893089294434
Epoch: 10, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.327 Vali Acc: 0.180 Test Loss: 3.327 Test Acc: 0.180
Validation loss decreased (-0.169379 --> -0.179967).  Saving model ...
Epoch: 11 cost time: 0.4537076950073242
Epoch: 11, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.368 Vali Acc: 0.185 Test Loss: 3.368 Test Acc: 0.185
Validation loss decreased (-0.179967 --> -0.184672).  Saving model ...
Epoch: 12 cost time: 0.4239974021911621
Epoch: 12, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.389 Vali Acc: 0.191 Test Loss: 3.389 Test Acc: 0.191
Validation loss decreased (-0.184672 --> -0.190554).  Saving model ...
Epoch: 13 cost time: 0.42398548126220703
Epoch: 13, Steps: 10 | Train Loss: 0.961 Vali Loss: 3.434 Vali Acc: 0.201 Test Loss: 3.434 Test Acc: 0.201
Validation loss decreased (-0.190554 --> -0.201142).  Saving model ...
Epoch: 14 cost time: 0.4531679153442383
Epoch: 14, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.481 Vali Acc: 0.196 Test Loss: 3.481 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.43271780014038086
Epoch: 15, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.541 Vali Acc: 0.211 Test Loss: 3.541 Test Acc: 0.211
Validation loss decreased (-0.201142 --> -0.210553).  Saving model ...
Epoch: 16 cost time: 0.44354891777038574
Epoch: 16, Steps: 10 | Train Loss: 0.546 Vali Loss: 3.616 Vali Acc: 0.213 Test Loss: 3.616 Test Acc: 0.213
Validation loss decreased (-0.210553 --> -0.212905).  Saving model ...
Epoch: 17 cost time: 0.44514989852905273
Epoch: 17, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.685 Vali Acc: 0.225 Test Loss: 3.685 Test Acc: 0.225
Validation loss decreased (-0.212905 --> -0.224669).  Saving model ...
Epoch: 18 cost time: 0.4780914783477783
Epoch: 18, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.714 Vali Acc: 0.231 Test Loss: 3.714 Test Acc: 0.231
Validation loss decreased (-0.224669 --> -0.230551).  Saving model ...
Epoch: 19 cost time: 0.45635509490966797
Epoch: 19, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.796 Vali Acc: 0.232 Test Loss: 3.796 Test Acc: 0.232
Validation loss decreased (-0.230551 --> -0.231727).  Saving model ...
Epoch: 20 cost time: 0.41515469551086426
Epoch: 20, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.867 Vali Acc: 0.236 Test Loss: 3.867 Test Acc: 0.236
Validation loss decreased (-0.231727 --> -0.236432).  Saving model ...
Epoch: 21 cost time: 0.48128700256347656
Epoch: 21, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.959 Vali Acc: 0.248 Test Loss: 3.959 Test Acc: 0.248
Validation loss decreased (-0.236432 --> -0.248196).  Saving model ...
Epoch: 22 cost time: 0.4786975383758545
Epoch: 22, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.975 Vali Acc: 0.252 Test Loss: 3.975 Test Acc: 0.252
Validation loss decreased (-0.248196 --> -0.251725).  Saving model ...
Epoch: 23 cost time: 0.46006202697753906
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.996 Vali Acc: 0.252 Test Loss: 3.996 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4279165267944336
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.056 Vali Acc: 0.252 Test Loss: 4.056 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4909048080444336
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.084 Vali Acc: 0.249 Test Loss: 4.084 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.42191052436828613
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.127 Vali Acc: 0.245 Test Loss: 4.127 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.46646571159362793
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.139 Vali Acc: 0.254 Test Loss: 4.139 Test Acc: 0.254
Validation loss decreased (-0.251725 --> -0.254076).  Saving model ...
Epoch: 28 cost time: 0.4862949848175049
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.161 Vali Acc: 0.255 Test Loss: 4.161 Test Acc: 0.255
Validation loss decreased (-0.254076 --> -0.255253).  Saving model ...
Epoch: 29 cost time: 0.4801490306854248
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.190 Vali Acc: 0.259 Test Loss: 4.190 Test Acc: 0.259
Validation loss decreased (-0.255253 --> -0.258782).  Saving model ...
Epoch: 30 cost time: 0.45037341117858887
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.199 Vali Acc: 0.262 Test Loss: 4.199 Test Acc: 0.262
Validation loss decreased (-0.258782 --> -0.262311).  Saving model ...
Epoch: 31 cost time: 0.46080636978149414
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.221 Vali Acc: 0.261 Test Loss: 4.221 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.47005462646484375
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.262 Vali Acc: 0.264 Test Loss: 4.262 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 33 cost time: 0.4815249443054199
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.290 Vali Acc: 0.262 Test Loss: 4.290 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4840850830078125
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.321 Vali Acc: 0.260 Test Loss: 4.321 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4711623191833496
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.329 Vali Acc: 0.262 Test Loss: 4.329 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5253734588623047
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.324 Vali Acc: 0.262 Test Loss: 4.324 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4693775177001953
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.349 Vali Acc: 0.264 Test Loss: 4.349 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.46417236328125
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.371 Vali Acc: 0.266 Test Loss: 4.371 Test Acc: 0.266
Validation loss decreased (-0.263487 --> -0.265839).  Saving model ...
Epoch: 39 cost time: 0.49759793281555176
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.385 Vali Acc: 0.266 Test Loss: 4.385 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.47640419006347656
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.411 Vali Acc: 0.269 Test Loss: 4.411 Test Acc: 0.269
Validation loss decreased (-0.265839 --> -0.269368).  Saving model ...
Epoch: 41 cost time: 0.5122590065002441
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.423 Vali Acc: 0.268 Test Loss: 4.423 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.43244147300720215
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.435 Vali Acc: 0.267 Test Loss: 4.435 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4469294548034668
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.450 Vali Acc: 0.268 Test Loss: 4.450 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.4579124450683594
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.446 Vali Acc: 0.265 Test Loss: 4.446 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.4394712448120117
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.458 Vali Acc: 0.265 Test Loss: 4.458 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5345144271850586
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.479 Vali Acc: 0.269 Test Loss: 4.479 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.4599182605743408
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.487 Vali Acc: 0.272 Test Loss: 4.487 Test Acc: 0.272
Validation loss decreased (-0.269368 --> -0.271720).  Saving model ...
Epoch: 48 cost time: 0.4766116142272949
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.511 Vali Acc: 0.267 Test Loss: 4.511 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.471940279006958
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.530 Vali Acc: 0.268 Test Loss: 4.530 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4086272716522217
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.531 Vali Acc: 0.272 Test Loss: 4.531 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.46265673637390137
Epoch: 51, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.528 Vali Acc: 0.272 Test Loss: 4.528 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.45485472679138184
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.546 Vali Acc: 0.268 Test Loss: 4.546 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.47667574882507324
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.549 Vali Acc: 0.271 Test Loss: 4.549 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.4212367534637451
Epoch: 54, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.557 Vali Acc: 0.272 Test Loss: 4.557 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.4386470317840576
Epoch: 55, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.580 Vali Acc: 0.273 Test Loss: 4.580 Test Acc: 0.273
Validation loss decreased (-0.271720 --> -0.272895).  Saving model ...
Epoch: 56 cost time: 0.43117809295654297
Epoch: 56, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.583 Vali Acc: 0.273 Test Loss: 4.583 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4597945213317871
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.584 Vali Acc: 0.272 Test Loss: 4.584 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4814298152923584
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.588 Vali Acc: 0.275 Test Loss: 4.588 Test Acc: 0.275
Validation loss decreased (-0.272895 --> -0.275248).  Saving model ...
Epoch: 59 cost time: 0.47286415100097656
Epoch: 59, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.629 Vali Acc: 0.275 Test Loss: 4.629 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.43334412574768066
Epoch: 60, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.625 Vali Acc: 0.271 Test Loss: 4.625 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.4821007251739502
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.635 Vali Acc: 0.275 Test Loss: 4.635 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.43804383277893066
Epoch: 62, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.651 Vali Acc: 0.276 Test Loss: 4.651 Test Acc: 0.276
Validation loss decreased (-0.275248 --> -0.276424).  Saving model ...
Epoch: 63 cost time: 0.4883921146392822
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.645 Vali Acc: 0.272 Test Loss: 4.645 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.459758996963501
Epoch: 64, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.638 Vali Acc: 0.272 Test Loss: 4.638 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5219910144805908
Epoch: 65, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.652 Vali Acc: 0.271 Test Loss: 4.652 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.48904848098754883
Epoch: 66, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.671 Vali Acc: 0.271 Test Loss: 4.671 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.4505729675292969
Epoch: 67, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.688 Vali Acc: 0.273 Test Loss: 4.688 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.48546504974365234
Epoch: 68, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.684 Vali Acc: 0.271 Test Loss: 4.684 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.48583149909973145
Epoch: 69, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.702 Vali Acc: 0.271 Test Loss: 4.702 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.4513108730316162
Epoch: 70, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.715 Vali Acc: 0.273 Test Loss: 4.715 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.477219820022583
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.712 Vali Acc: 0.271 Test Loss: 4.712 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.4752364158630371
Epoch: 72, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.714 Vali Acc: 0.274 Test Loss: 4.714 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 184602
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6348357200622559
Epoch: 1, Steps: 10 | Train Loss: 3.476 Vali Loss: 3.341 Vali Acc: 0.062 Test Loss: 3.341 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 0.5182232856750488
Epoch: 2, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.389 Vali Acc: 0.109 Test Loss: 3.389 Test Acc: 0.109
Validation loss decreased (-0.062320 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 0.5799233913421631
Epoch: 3, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.222 Vali Acc: 0.182 Test Loss: 3.222 Test Acc: 0.182
Validation loss decreased (-0.109378 --> -0.182321).  Saving model ...
Epoch: 4 cost time: 0.5489513874053955
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.461 Vali Acc: 0.188 Test Loss: 3.461 Test Acc: 0.188
Validation loss decreased (-0.182321 --> -0.188201).  Saving model ...
Epoch: 5 cost time: 0.47737860679626465
Epoch: 5, Steps: 10 | Train Loss: 0.992 Vali Loss: 3.603 Vali Acc: 0.218 Test Loss: 3.603 Test Acc: 0.218
Validation loss decreased (-0.188201 --> -0.217611).  Saving model ...
Epoch: 6 cost time: 0.5182163715362549
Epoch: 6, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.901 Vali Acc: 0.239 Test Loss: 3.901 Test Acc: 0.239
Validation loss decreased (-0.217611 --> -0.238785).  Saving model ...
Epoch: 7 cost time: 0.5549201965332031
Epoch: 7, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.291 Vali Acc: 0.200 Test Loss: 4.291 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5145995616912842
Epoch: 8, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.426 Vali Acc: 0.246 Test Loss: 4.426 Test Acc: 0.246
Validation loss decreased (-0.238785 --> -0.245838).  Saving model ...
Epoch: 9 cost time: 0.5266642570495605
Epoch: 9, Steps: 10 | Train Loss: 0.148 Vali Loss: 4.698 Vali Acc: 0.228 Test Loss: 4.698 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5142221450805664
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.880 Vali Acc: 0.245 Test Loss: 4.880 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4736182689666748
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 5.201 Vali Acc: 0.248 Test Loss: 5.201 Test Acc: 0.248
Validation loss decreased (-0.245838 --> -0.248183).  Saving model ...
Epoch: 12 cost time: 0.511988639831543
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.426 Vali Acc: 0.239 Test Loss: 5.426 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5167462825775146
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 5.747 Vali Acc: 0.236 Test Loss: 5.747 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5215182304382324
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.902 Vali Acc: 0.246 Test Loss: 5.902 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5155713558197021
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.959 Vali Acc: 0.258 Test Loss: 5.959 Test Acc: 0.258
Validation loss decreased (-0.248183 --> -0.257587).  Saving model ...
Epoch: 16 cost time: 0.5005502700805664
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.223 Vali Acc: 0.261 Test Loss: 6.223 Test Acc: 0.261
Validation loss decreased (-0.257587 --> -0.261114).  Saving model ...
Epoch: 17 cost time: 0.5134835243225098
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.031 Vali Acc: 0.251 Test Loss: 6.031 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5002779960632324
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.094 Vali Acc: 0.267 Test Loss: 6.094 Test Acc: 0.267
Validation loss decreased (-0.261114 --> -0.266998).  Saving model ...
Epoch: 19 cost time: 0.4073519706726074
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.296 Vali Acc: 0.261 Test Loss: 6.296 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5436677932739258
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.157 Vali Acc: 0.267 Test Loss: 6.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5528573989868164
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.127 Vali Acc: 0.273 Test Loss: 6.127 Test Acc: 0.273
Validation loss decreased (-0.266998 --> -0.272880).  Saving model ...
Epoch: 22 cost time: 0.5457468032836914
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.124 Vali Acc: 0.274 Test Loss: 6.124 Test Acc: 0.274
Validation loss decreased (-0.272880 --> -0.274056).  Saving model ...
Epoch: 23 cost time: 0.6130926609039307
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.121 Vali Acc: 0.274 Test Loss: 6.121 Test Acc: 0.274
Validation loss decreased (-0.274056 --> -0.274056).  Saving model ...
Epoch: 24 cost time: 0.5692362785339355
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.112 Vali Acc: 0.273 Test Loss: 6.112 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5271692276000977
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.108 Vali Acc: 0.272 Test Loss: 6.108 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5201873779296875
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.112 Vali Acc: 0.271 Test Loss: 6.112 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5155189037322998
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.116 Vali Acc: 0.269 Test Loss: 6.116 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5495538711547852
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.132 Vali Acc: 0.275 Test Loss: 6.132 Test Acc: 0.275
Validation loss decreased (-0.274056 --> -0.275233).  Saving model ...
Epoch: 29 cost time: 0.5635700225830078
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.136 Vali Acc: 0.276 Test Loss: 6.136 Test Acc: 0.276
Validation loss decreased (-0.275233 --> -0.276409).  Saving model ...
Epoch: 30 cost time: 0.580845832824707
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.147 Vali Acc: 0.279 Test Loss: 6.147 Test Acc: 0.279
Validation loss decreased (-0.276409 --> -0.278762).  Saving model ...
Epoch: 31 cost time: 0.5216355323791504
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.151 Vali Acc: 0.279 Test Loss: 6.151 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5592994689941406
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.158 Vali Acc: 0.279 Test Loss: 6.158 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5535500049591064
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.174 Vali Acc: 0.278 Test Loss: 6.174 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5404307842254639
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.195 Vali Acc: 0.276 Test Loss: 6.195 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5326230525970459
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.190 Vali Acc: 0.276 Test Loss: 6.190 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5456218719482422
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.187 Vali Acc: 0.275 Test Loss: 6.187 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5583271980285645
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.193 Vali Acc: 0.275 Test Loss: 6.193 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5526843070983887
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.197 Vali Acc: 0.274 Test Loss: 6.197 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.41113829612731934
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.205 Vali Acc: 0.273 Test Loss: 6.205 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.48796534538269043
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.207 Vali Acc: 0.274 Test Loss: 6.207 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 842714
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5168676376342773
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.345 Vali Acc: 0.049 Test Loss: 3.345 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.4171934127807617
Epoch: 2, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.403 Vali Acc: 0.094 Test Loss: 3.403 Test Acc: 0.094
Validation loss decreased (-0.049378 --> -0.094084).  Saving model ...
Epoch: 3 cost time: 0.463137149810791
Epoch: 3, Steps: 10 | Train Loss: 2.497 Vali Loss: 3.293 Vali Acc: 0.127 Test Loss: 3.293 Test Acc: 0.127
Validation loss decreased (-0.094084 --> -0.127026).  Saving model ...
Epoch: 4 cost time: 0.42534804344177246
Epoch: 4, Steps: 10 | Train Loss: 1.883 Vali Loss: 3.251 Vali Acc: 0.174 Test Loss: 3.251 Test Acc: 0.174
Validation loss decreased (-0.127026 --> -0.174085).  Saving model ...
Epoch: 5 cost time: 0.457439661026001
Epoch: 5, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.345 Vali Acc: 0.181 Test Loss: 3.345 Test Acc: 0.181
Validation loss decreased (-0.174085 --> -0.181143).  Saving model ...
Epoch: 6 cost time: 0.44828224182128906
Epoch: 6, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.496 Vali Acc: 0.191 Test Loss: 3.496 Test Acc: 0.191
Validation loss decreased (-0.181143 --> -0.190553).  Saving model ...
Epoch: 7 cost time: 0.4152970314025879
Epoch: 7, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.599 Vali Acc: 0.226 Test Loss: 3.599 Test Acc: 0.226
Validation loss decreased (-0.190553 --> -0.225846).  Saving model ...
Epoch: 8 cost time: 0.4345393180847168
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.738 Vali Acc: 0.227 Test Loss: 3.738 Test Acc: 0.227
Validation loss decreased (-0.225846 --> -0.227021).  Saving model ...
Epoch: 9 cost time: 0.4790024757385254
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.826 Vali Acc: 0.242 Test Loss: 3.826 Test Acc: 0.242
Validation loss decreased (-0.227021 --> -0.242315).  Saving model ...
Epoch: 10 cost time: 0.4938664436340332
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.980 Vali Acc: 0.235 Test Loss: 3.980 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.500744104385376
Epoch: 11, Steps: 10 | Train Loss: 0.132 Vali Loss: 4.193 Vali Acc: 0.236 Test Loss: 4.193 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5552761554718018
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.393 Vali Acc: 0.238 Test Loss: 4.393 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5083663463592529
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.541 Vali Acc: 0.249 Test Loss: 4.541 Test Acc: 0.249
Validation loss decreased (-0.242315 --> -0.249366).  Saving model ...
Epoch: 14 cost time: 0.5123798847198486
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.698 Vali Acc: 0.241 Test Loss: 4.698 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.48595285415649414
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.770 Vali Acc: 0.255 Test Loss: 4.770 Test Acc: 0.255
Validation loss decreased (-0.249366 --> -0.255246).  Saving model ...
Epoch: 16 cost time: 0.5156104564666748
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.861 Vali Acc: 0.232 Test Loss: 4.861 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5384190082550049
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.817 Vali Acc: 0.249 Test Loss: 4.817 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5182175636291504
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.873 Vali Acc: 0.251 Test Loss: 4.873 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5144796371459961
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.002 Vali Acc: 0.251 Test Loss: 5.002 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5024988651275635
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.023 Vali Acc: 0.251 Test Loss: 5.023 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5121643543243408
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.067 Vali Acc: 0.252 Test Loss: 5.067 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.507948637008667
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.090 Vali Acc: 0.253 Test Loss: 5.090 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.528308629989624
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.083 Vali Acc: 0.252 Test Loss: 5.083 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5316388607025146
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.107 Vali Acc: 0.254 Test Loss: 5.107 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.48503589630126953
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.128 Vali Acc: 0.253 Test Loss: 5.128 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 463834
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5446324348449707
Epoch: 1, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.312 Vali Acc: 0.052 Test Loss: 3.312 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.3901784420013428
Epoch: 2, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.342 Vali Acc: 0.081 Test Loss: 3.342 Test Acc: 0.081
Validation loss decreased (-0.051732 --> -0.081143).  Saving model ...
Epoch: 3 cost time: 0.4179832935333252
Epoch: 3, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.346 Vali Acc: 0.100 Test Loss: 3.346 Test Acc: 0.100
Validation loss decreased (-0.081143 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 0.3915858268737793
Epoch: 4, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.244 Vali Acc: 0.139 Test Loss: 3.244 Test Acc: 0.139
Validation loss decreased (-0.099967 --> -0.138791).  Saving model ...
Epoch: 5 cost time: 0.4135153293609619
Epoch: 5, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.235 Vali Acc: 0.164 Test Loss: 3.235 Test Acc: 0.164
Validation loss decreased (-0.138791 --> -0.163497).  Saving model ...
Epoch: 6 cost time: 0.37538909912109375
Epoch: 6, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.307 Vali Acc: 0.167 Test Loss: 3.307 Test Acc: 0.167
Validation loss decreased (-0.163497 --> -0.167026).  Saving model ...
Epoch: 7 cost time: 0.39383721351623535
Epoch: 7, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.356 Vali Acc: 0.195 Test Loss: 3.356 Test Acc: 0.195
Validation loss decreased (-0.167026 --> -0.195261).  Saving model ...
Epoch: 8 cost time: 0.39788079261779785
Epoch: 8, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.458 Vali Acc: 0.198 Test Loss: 3.458 Test Acc: 0.198
Validation loss decreased (-0.195261 --> -0.197612).  Saving model ...
Epoch: 9 cost time: 0.42556309700012207
Epoch: 9, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.542 Vali Acc: 0.224 Test Loss: 3.542 Test Acc: 0.224
Validation loss decreased (-0.197612 --> -0.223494).  Saving model ...
Epoch: 10 cost time: 0.40146636962890625
Epoch: 10, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.663 Vali Acc: 0.226 Test Loss: 3.663 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225846).  Saving model ...
Epoch: 11 cost time: 0.43012547492980957
Epoch: 11, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.799 Vali Acc: 0.235 Test Loss: 3.799 Test Acc: 0.235
Validation loss decreased (-0.225846 --> -0.235256).  Saving model ...
Epoch: 12 cost time: 0.4336886405944824
Epoch: 12, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.918 Vali Acc: 0.232 Test Loss: 3.918 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.478593111038208
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.123 Vali Acc: 0.238 Test Loss: 4.123 Test Acc: 0.238
Validation loss decreased (-0.235256 --> -0.237606).  Saving model ...
Epoch: 14 cost time: 0.39838600158691406
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.172 Vali Acc: 0.245 Test Loss: 4.172 Test Acc: 0.245
Validation loss decreased (-0.237606 --> -0.244664).  Saving model ...
Epoch: 15 cost time: 0.38982248306274414
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.214 Vali Acc: 0.254 Test Loss: 4.214 Test Acc: 0.254
Validation loss decreased (-0.244664 --> -0.254076).  Saving model ...
Epoch: 16 cost time: 0.4483802318572998
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.303 Vali Acc: 0.254 Test Loss: 4.303 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5665991306304932
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.421 Vali Acc: 0.259 Test Loss: 4.421 Test Acc: 0.259
Validation loss decreased (-0.254076 --> -0.258779).  Saving model ...
Epoch: 18 cost time: 0.49120283126831055
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.517 Vali Acc: 0.255 Test Loss: 4.517 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4483156204223633
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.457 Vali Acc: 0.253 Test Loss: 4.457 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4324033260345459
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.476 Vali Acc: 0.261 Test Loss: 4.476 Test Acc: 0.261
Validation loss decreased (-0.258779 --> -0.261132).  Saving model ...
Epoch: 21 cost time: 0.4388878345489502
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.571 Vali Acc: 0.259 Test Loss: 4.571 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.34047603607177734
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.640 Vali Acc: 0.256 Test Loss: 4.640 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.39354515075683594
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.601 Vali Acc: 0.262 Test Loss: 4.601 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262307).  Saving model ...
Epoch: 24 cost time: 0.43160152435302734
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.262 Test Loss: 4.630 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.46233534812927246
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.650 Vali Acc: 0.265 Test Loss: 4.650 Test Acc: 0.265
Validation loss decreased (-0.262307 --> -0.264659).  Saving model ...
Epoch: 26 cost time: 0.380047082901001
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.686 Vali Acc: 0.265 Test Loss: 4.686 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3942141532897949
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.711 Vali Acc: 0.262 Test Loss: 4.711 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.44356274604797363
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.736 Vali Acc: 0.262 Test Loss: 4.736 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.41494107246398926
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.743 Vali Acc: 0.264 Test Loss: 4.743 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.44475436210632324
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.761 Vali Acc: 0.266 Test Loss: 4.761 Test Acc: 0.266
Validation loss decreased (-0.264659 --> -0.265835).  Saving model ...
Epoch: 31 cost time: 0.43711400032043457
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.784 Vali Acc: 0.264 Test Loss: 4.784 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.39754772186279297
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.814 Vali Acc: 0.260 Test Loss: 4.814 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.3832991123199463
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.831 Vali Acc: 0.259 Test Loss: 4.831 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.3844563961029053
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.846 Vali Acc: 0.259 Test Loss: 4.846 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.3727753162384033
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.852 Vali Acc: 0.260 Test Loss: 4.852 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.35512781143188477
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.852 Vali Acc: 0.260 Test Loss: 4.852 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.3592517375946045
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.847 Vali Acc: 0.262 Test Loss: 4.847 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.39638733863830566
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.873 Vali Acc: 0.264 Test Loss: 4.873 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.36342787742614746
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.882 Vali Acc: 0.265 Test Loss: 4.882 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.37487053871154785
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.901 Vali Acc: 0.266 Test Loss: 4.901 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 334554
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5672335624694824
Epoch: 1, Steps: 10 | Train Loss: 3.460 Vali Loss: 3.352 Vali Acc: 0.033 Test Loss: 3.352 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.44434309005737305
Epoch: 2, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.325 Vali Acc: 0.058 Test Loss: 3.325 Test Acc: 0.058
Validation loss decreased (-0.032908 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.43689751625061035
Epoch: 3, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.361 Vali Acc: 0.084 Test Loss: 3.361 Test Acc: 0.084
Validation loss decreased (-0.057614 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.48389244079589844
Epoch: 4, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.310 Vali Acc: 0.120 Test Loss: 3.310 Test Acc: 0.120
Validation loss decreased (-0.083496 --> -0.119967).  Saving model ...
Epoch: 5 cost time: 0.41759204864501953
Epoch: 5, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.244 Vali Acc: 0.145 Test Loss: 3.244 Test Acc: 0.145
Validation loss decreased (-0.119967 --> -0.144673).  Saving model ...
Epoch: 6 cost time: 0.4251856803894043
Epoch: 6, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.244 Vali Acc: 0.166 Test Loss: 3.244 Test Acc: 0.166
Validation loss decreased (-0.144673 --> -0.165850).  Saving model ...
Epoch: 7 cost time: 0.41709399223327637
Epoch: 7, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.283 Vali Acc: 0.181 Test Loss: 3.283 Test Acc: 0.181
Validation loss decreased (-0.165850 --> -0.181144).  Saving model ...
Epoch: 8 cost time: 0.4457418918609619
Epoch: 8, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.331 Vali Acc: 0.194 Test Loss: 3.331 Test Acc: 0.194
Validation loss decreased (-0.181144 --> -0.194084).  Saving model ...
Epoch: 9 cost time: 0.44487833976745605
Epoch: 9, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.416 Vali Acc: 0.213 Test Loss: 3.416 Test Acc: 0.213
Validation loss decreased (-0.194084 --> -0.212907).  Saving model ...
Epoch: 10 cost time: 0.4481222629547119
Epoch: 10, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.470 Vali Acc: 0.222 Test Loss: 3.470 Test Acc: 0.222
Validation loss decreased (-0.212907 --> -0.222318).  Saving model ...
Epoch: 11 cost time: 0.4331958293914795
Epoch: 11, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.553 Vali Acc: 0.252 Test Loss: 3.553 Test Acc: 0.252
Validation loss decreased (-0.222318 --> -0.251729).  Saving model ...
Epoch: 12 cost time: 0.39165663719177246
Epoch: 12, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.753 Vali Acc: 0.231 Test Loss: 3.753 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4481978416442871
Epoch: 13, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.750 Vali Acc: 0.238 Test Loss: 3.750 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.45269227027893066
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.971 Vali Acc: 0.245 Test Loss: 3.971 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.43715620040893555
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.069 Vali Acc: 0.248 Test Loss: 4.069 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4507935047149658
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.203 Vali Acc: 0.244 Test Loss: 4.203 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4669058322906494
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.222 Vali Acc: 0.255 Test Loss: 4.222 Test Acc: 0.255
Validation loss decreased (-0.251729 --> -0.255252).  Saving model ...
Epoch: 18 cost time: 0.48827219009399414
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.282 Vali Acc: 0.260 Test Loss: 4.282 Test Acc: 0.260
Validation loss decreased (-0.255252 --> -0.259957).  Saving model ...
Epoch: 19 cost time: 0.46521925926208496
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.346 Vali Acc: 0.249 Test Loss: 4.346 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4585278034210205
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.394 Vali Acc: 0.246 Test Loss: 4.394 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4996638298034668
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.432 Vali Acc: 0.248 Test Loss: 4.432 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4594237804412842
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.508 Vali Acc: 0.252 Test Loss: 4.508 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.43529415130615234
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.552 Vali Acc: 0.252 Test Loss: 4.552 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4360506534576416
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.568 Vali Acc: 0.253 Test Loss: 4.568 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.41948580741882324
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.580 Vali Acc: 0.248 Test Loss: 4.580 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.44877004623413086
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.618 Vali Acc: 0.248 Test Loss: 4.618 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4442458152770996
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.620 Vali Acc: 0.251 Test Loss: 4.620 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.42771339416503906
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.248 Test Loss: 4.630 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 275162
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5060315132141113
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.374 Vali Acc: 0.032 Test Loss: 3.374 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.44614744186401367
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.336 Vali Acc: 0.049 Test Loss: 3.336 Test Acc: 0.049
Validation loss decreased (-0.031731 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.4455544948577881
Epoch: 3, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.327 Vali Acc: 0.069 Test Loss: 3.327 Test Acc: 0.069
Validation loss decreased (-0.049378 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 0.42842578887939453
Epoch: 4, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.319 Vali Acc: 0.088 Test Loss: 3.319 Test Acc: 0.088
Validation loss decreased (-0.069378 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 0.4592885971069336
Epoch: 5, Steps: 10 | Train Loss: 2.332 Vali Loss: 3.302 Vali Acc: 0.116 Test Loss: 3.302 Test Acc: 0.116
Validation loss decreased (-0.088202 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.41777658462524414
Epoch: 6, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.265 Vali Acc: 0.138 Test Loss: 3.265 Test Acc: 0.138
Validation loss decreased (-0.116438 --> -0.137614).  Saving model ...
Epoch: 7 cost time: 0.44750070571899414
Epoch: 7, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.248 Vali Acc: 0.159 Test Loss: 3.248 Test Acc: 0.159
Validation loss decreased (-0.137614 --> -0.158791).  Saving model ...
Epoch: 8 cost time: 0.42428016662597656
Epoch: 8, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.295 Vali Acc: 0.166 Test Loss: 3.295 Test Acc: 0.166
Validation loss decreased (-0.158791 --> -0.165849).  Saving model ...
Epoch: 9 cost time: 0.400601863861084
Epoch: 9, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.321 Vali Acc: 0.184 Test Loss: 3.321 Test Acc: 0.184
Validation loss decreased (-0.165849 --> -0.183496).  Saving model ...
Epoch: 10 cost time: 0.4648599624633789
Epoch: 10, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.361 Vali Acc: 0.201 Test Loss: 3.361 Test Acc: 0.201
Validation loss decreased (-0.183496 --> -0.201143).  Saving model ...
Epoch: 11 cost time: 0.4449594020843506
Epoch: 11, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.428 Vali Acc: 0.219 Test Loss: 3.428 Test Acc: 0.219
Validation loss decreased (-0.201143 --> -0.218789).  Saving model ...
Epoch: 12 cost time: 0.44138360023498535
Epoch: 12, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.523 Vali Acc: 0.219 Test Loss: 3.523 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.43207764625549316
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.611 Vali Acc: 0.226 Test Loss: 3.611 Test Acc: 0.226
Validation loss decreased (-0.218789 --> -0.225846).  Saving model ...
Epoch: 14 cost time: 0.42713451385498047
Epoch: 14, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.636 Vali Acc: 0.233 Test Loss: 3.636 Test Acc: 0.233
Validation loss decreased (-0.225846 --> -0.232905).  Saving model ...
Epoch: 15 cost time: 0.436992883682251
Epoch: 15, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.742 Vali Acc: 0.222 Test Loss: 3.742 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.44225287437438965
Epoch: 16, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.847 Vali Acc: 0.235 Test Loss: 3.847 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235256).  Saving model ...
Epoch: 17 cost time: 0.4426741600036621
Epoch: 17, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.960 Vali Acc: 0.231 Test Loss: 3.960 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.43846988677978516
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.089 Vali Acc: 0.241 Test Loss: 4.089 Test Acc: 0.241
Validation loss decreased (-0.235256 --> -0.241136).  Saving model ...
Epoch: 19 cost time: 0.4367532730102539
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.119 Vali Acc: 0.244 Test Loss: 4.119 Test Acc: 0.244
Validation loss decreased (-0.241136 --> -0.243488).  Saving model ...
Epoch: 20 cost time: 0.4548685550689697
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.109 Vali Acc: 0.245 Test Loss: 4.109 Test Acc: 0.245
Validation loss decreased (-0.243488 --> -0.244665).  Saving model ...
Epoch: 21 cost time: 0.4462578296661377
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.155 Vali Acc: 0.244 Test Loss: 4.155 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.37556958198547363
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.249 Vali Acc: 0.242 Test Loss: 4.249 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4566650390625
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.297 Vali Acc: 0.251 Test Loss: 4.297 Test Acc: 0.251
Validation loss decreased (-0.244665 --> -0.250545).  Saving model ...
Epoch: 24 cost time: 0.4165618419647217
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.315 Vali Acc: 0.253 Test Loss: 4.315 Test Acc: 0.253
Validation loss decreased (-0.250545 --> -0.252898).  Saving model ...
Epoch: 25 cost time: 0.425950288772583
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.320 Vali Acc: 0.252 Test Loss: 4.320 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4284205436706543
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.334 Vali Acc: 0.259 Test Loss: 4.334 Test Acc: 0.259
Validation loss decreased (-0.252898 --> -0.258780).  Saving model ...
Epoch: 27 cost time: 0.45102477073669434
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.355 Vali Acc: 0.256 Test Loss: 4.355 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4265134334564209
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.385 Vali Acc: 0.255 Test Loss: 4.385 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4252457618713379
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.419 Vali Acc: 0.258 Test Loss: 4.419 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.43921995162963867
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.434 Vali Acc: 0.260 Test Loss: 4.434 Test Acc: 0.260
Validation loss decreased (-0.258780 --> -0.259956).  Saving model ...
Epoch: 31 cost time: 0.4418642520904541
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.456 Vali Acc: 0.259 Test Loss: 4.456 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.45136380195617676
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.477 Vali Acc: 0.264 Test Loss: 4.477 Test Acc: 0.264
Validation loss decreased (-0.259956 --> -0.263485).  Saving model ...
Epoch: 33 cost time: 0.4226043224334717
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.490 Vali Acc: 0.262 Test Loss: 4.490 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4488203525543213
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.531 Vali Acc: 0.265 Test Loss: 4.531 Test Acc: 0.265
Validation loss decreased (-0.263485 --> -0.264661).  Saving model ...
Epoch: 35 cost time: 0.43671584129333496
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.539 Vali Acc: 0.260 Test Loss: 4.539 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4294929504394531
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.556 Vali Acc: 0.264 Test Loss: 4.556 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.45223069190979004
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.561 Vali Acc: 0.265 Test Loss: 4.561 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4117603302001953
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.587 Vali Acc: 0.271 Test Loss: 4.587 Test Acc: 0.271
Validation loss decreased (-0.264661 --> -0.270542).  Saving model ...
Epoch: 39 cost time: 0.46884632110595703
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.604 Vali Acc: 0.266 Test Loss: 4.604 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3736093044281006
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.631 Vali Acc: 0.267 Test Loss: 4.631 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.44435548782348633
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.647 Vali Acc: 0.269 Test Loss: 4.647 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4413604736328125
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.652 Vali Acc: 0.268 Test Loss: 4.652 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4721205234527588
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.661 Vali Acc: 0.272 Test Loss: 4.661 Test Acc: 0.272
Validation loss decreased (-0.270542 --> -0.271718).  Saving model ...
Epoch: 44 cost time: 0.47856712341308594
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.675 Vali Acc: 0.272 Test Loss: 4.675 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.417449951171875
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.675 Vali Acc: 0.271 Test Loss: 4.675 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.44289708137512207
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.683 Vali Acc: 0.269 Test Loss: 4.683 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4421677589416504
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.690 Vali Acc: 0.273 Test Loss: 4.690 Test Acc: 0.273
Validation loss decreased (-0.271718 --> -0.272894).  Saving model ...
Epoch: 48 cost time: 0.46921372413635254
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.690 Vali Acc: 0.273 Test Loss: 4.690 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.423691987991333
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.718 Vali Acc: 0.272 Test Loss: 4.718 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.42087769508361816
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.733 Vali Acc: 0.274 Test Loss: 4.733 Test Acc: 0.274
Validation loss decreased (-0.272894 --> -0.274070).  Saving model ...
Epoch: 51 cost time: 0.4503021240234375
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.743 Vali Acc: 0.279 Test Loss: 4.743 Test Acc: 0.279
Validation loss decreased (-0.274070 --> -0.278776).  Saving model ...
Epoch: 52 cost time: 0.46632909774780273
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.747 Vali Acc: 0.276 Test Loss: 4.747 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.367048978805542
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.754 Vali Acc: 0.276 Test Loss: 4.754 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.44961118698120117
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.768 Vali Acc: 0.276 Test Loss: 4.768 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.431304931640625
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.777 Vali Acc: 0.278 Test Loss: 4.777 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.42275238037109375
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.775 Vali Acc: 0.278 Test Loss: 4.775 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.4407196044921875
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.789 Vali Acc: 0.279 Test Loss: 4.789 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.4218933582305908
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.792 Vali Acc: 0.279 Test Loss: 4.792 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.4254007339477539
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.799 Vali Acc: 0.280 Test Loss: 4.799 Test Acc: 0.280
Validation loss decreased (-0.278776 --> -0.279952).  Saving model ...
Epoch: 60 cost time: 0.4306621551513672
Epoch: 60, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.811 Vali Acc: 0.280 Test Loss: 4.811 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.4304347038269043
Epoch: 61, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.279 Test Loss: 4.837 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.4682648181915283
Epoch: 62, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.281 Test Loss: 4.837 Test Acc: 0.281
Validation loss decreased (-0.279952 --> -0.281128).  Saving model ...
Epoch: 63 cost time: 0.42821455001831055
Epoch: 63, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.845 Vali Acc: 0.279 Test Loss: 4.845 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.418198823928833
Epoch: 64, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.850 Vali Acc: 0.280 Test Loss: 4.850 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4686708450317383
Epoch: 65, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.853 Vali Acc: 0.279 Test Loss: 4.853 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.45808982849121094
Epoch: 66, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.870 Vali Acc: 0.280 Test Loss: 4.870 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.4420781135559082
Epoch: 67, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.892 Vali Acc: 0.280 Test Loss: 4.892 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.43146848678588867
Epoch: 68, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.899 Vali Acc: 0.280 Test Loss: 4.899 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.4409370422363281
Epoch: 69, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.906 Vali Acc: 0.281 Test Loss: 4.906 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.4600186347961426
Epoch: 70, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.908 Vali Acc: 0.281 Test Loss: 4.908 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.42701220512390137
Epoch: 71, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.914 Vali Acc: 0.281 Test Loss: 4.914 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.43414759635925293
Epoch: 72, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.915 Vali Acc: 0.280 Test Loss: 4.915 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 206170
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7289338111877441
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.337 Vali Acc: 0.041 Test Loss: 3.337 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.4406886100769043
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.283 Vali Acc: 0.073 Test Loss: 3.283 Test Acc: 0.073
Validation loss decreased (-0.041143 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.4234299659729004
Epoch: 3, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.254 Vali Acc: 0.088 Test Loss: 3.254 Test Acc: 0.088
Validation loss decreased (-0.072908 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 0.41869211196899414
Epoch: 4, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.249 Vali Acc: 0.102 Test Loss: 3.249 Test Acc: 0.102
Validation loss decreased (-0.088203 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.4241905212402344
Epoch: 5, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.249 Vali Acc: 0.115 Test Loss: 3.249 Test Acc: 0.115
Validation loss decreased (-0.102320 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.42564868927001953
Epoch: 6, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.229 Vali Acc: 0.134 Test Loss: 3.229 Test Acc: 0.134
Validation loss decreased (-0.115262 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.45629048347473145
Epoch: 7, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
Validation loss decreased (-0.134085 --> -0.158791).  Saving model ...
Epoch: 8 cost time: 0.424177885055542
Epoch: 8, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.223 Vali Acc: 0.167 Test Loss: 3.223 Test Acc: 0.167
Validation loss decreased (-0.158791 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 0.4611237049102783
Epoch: 9, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.229 Vali Acc: 0.191 Test Loss: 3.229 Test Acc: 0.191
Validation loss decreased (-0.167027 --> -0.190556).  Saving model ...
Epoch: 10 cost time: 0.42861056327819824
Epoch: 10, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.276 Vali Acc: 0.191 Test Loss: 3.276 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4577808380126953
Epoch: 11, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.310 Vali Acc: 0.205 Test Loss: 3.310 Test Acc: 0.205
Validation loss decreased (-0.190556 --> -0.204673).  Saving model ...
Epoch: 12 cost time: 0.43697381019592285
Epoch: 12, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.346 Vali Acc: 0.220 Test Loss: 3.346 Test Acc: 0.220
Validation loss decreased (-0.204673 --> -0.219967).  Saving model ...
Epoch: 13 cost time: 0.42292308807373047
Epoch: 13, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.421 Vali Acc: 0.216 Test Loss: 3.421 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43799877166748047
Epoch: 14, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.480 Vali Acc: 0.229 Test Loss: 3.480 Test Acc: 0.229
Validation loss decreased (-0.219967 --> -0.229377).  Saving model ...
Epoch: 15 cost time: 0.42000913619995117
Epoch: 15, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.548 Vali Acc: 0.226 Test Loss: 3.548 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43882179260253906
Epoch: 16, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.629 Vali Acc: 0.234 Test Loss: 3.629 Test Acc: 0.234
Validation loss decreased (-0.229377 --> -0.234081).  Saving model ...
Epoch: 17 cost time: 0.43311452865600586
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.713 Vali Acc: 0.233 Test Loss: 3.713 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5049228668212891
Epoch: 18, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.754 Vali Acc: 0.251 Test Loss: 3.754 Test Acc: 0.251
Validation loss decreased (-0.234081 --> -0.250551).  Saving model ...
Epoch: 19 cost time: 0.4428088665008545
Epoch: 19, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.858 Vali Acc: 0.249 Test Loss: 3.858 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.42828869819641113
Epoch: 20, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.935 Vali Acc: 0.249 Test Loss: 3.935 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4366774559020996
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.018 Vali Acc: 0.241 Test Loss: 4.018 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4544036388397217
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.077 Vali Acc: 0.246 Test Loss: 4.077 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.44254231452941895
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.094 Vali Acc: 0.258 Test Loss: 4.094 Test Acc: 0.258
Validation loss decreased (-0.250551 --> -0.257606).  Saving model ...
Epoch: 24 cost time: 0.4475245475769043
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.161 Vali Acc: 0.253 Test Loss: 4.161 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4161815643310547
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.179 Vali Acc: 0.254 Test Loss: 4.179 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.42096734046936035
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.187 Vali Acc: 0.261 Test Loss: 4.187 Test Acc: 0.261
Validation loss decreased (-0.257606 --> -0.261135).  Saving model ...
Epoch: 27 cost time: 0.44246912002563477
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.223 Vali Acc: 0.260 Test Loss: 4.223 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.43475890159606934
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.249 Vali Acc: 0.255 Test Loss: 4.249 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.41786670684814453
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.280 Vali Acc: 0.258 Test Loss: 4.280 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4393630027770996
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.294 Vali Acc: 0.258 Test Loss: 4.294 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.42444491386413574
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.307 Vali Acc: 0.258 Test Loss: 4.307 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4349792003631592
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.340 Vali Acc: 0.259 Test Loss: 4.340 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4165487289428711
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.364 Vali Acc: 0.264 Test Loss: 4.364 Test Acc: 0.264
Validation loss decreased (-0.261135 --> -0.263486).  Saving model ...
Epoch: 34 cost time: 0.4525878429412842
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.395 Vali Acc: 0.262 Test Loss: 4.395 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4199559688568115
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.425 Vali Acc: 0.255 Test Loss: 4.425 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5206997394561768
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.443 Vali Acc: 0.253 Test Loss: 4.443 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.46478962898254395
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.457 Vali Acc: 0.249 Test Loss: 4.457 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4593336582183838
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.467 Vali Acc: 0.252 Test Loss: 4.467 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4573044776916504
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.486 Vali Acc: 0.253 Test Loss: 4.486 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4531106948852539
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.492 Vali Acc: 0.254 Test Loss: 4.492 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4933891296386719
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.511 Vali Acc: 0.254 Test Loss: 4.511 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.42423462867736816
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.536 Vali Acc: 0.256 Test Loss: 4.536 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.42616939544677734
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.556 Vali Acc: 0.255 Test Loss: 4.556 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 177242
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5134012699127197
Epoch: 1, Steps: 10 | Train Loss: 3.460 Vali Loss: 3.358 Vali Acc: 0.042 Test Loss: 3.358 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.44686436653137207
Epoch: 2, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.329 Vali Acc: 0.056 Test Loss: 3.329 Test Acc: 0.056
Validation loss decreased (-0.042319 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.44364047050476074
Epoch: 3, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.316 Vali Acc: 0.064 Test Loss: 3.316 Test Acc: 0.064
Validation loss decreased (-0.056437 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.45192456245422363
Epoch: 4, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.308 Vali Acc: 0.081 Test Loss: 3.308 Test Acc: 0.081
Validation loss decreased (-0.063496 --> -0.081143).  Saving model ...
Epoch: 5 cost time: 0.43068909645080566
Epoch: 5, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.302 Vali Acc: 0.092 Test Loss: 3.302 Test Acc: 0.092
Validation loss decreased (-0.081143 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.41161680221557617
Epoch: 6, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.290 Vali Acc: 0.109 Test Loss: 3.290 Test Acc: 0.109
Validation loss decreased (-0.091732 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.44243764877319336
Epoch: 7, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.276 Vali Acc: 0.121 Test Loss: 3.276 Test Acc: 0.121
Validation loss decreased (-0.109379 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 0.39420509338378906
Epoch: 8, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.287 Vali Acc: 0.138 Test Loss: 3.287 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137614).  Saving model ...
Epoch: 9 cost time: 0.4230175018310547
Epoch: 9, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.297 Vali Acc: 0.147 Test Loss: 3.297 Test Acc: 0.147
Validation loss decreased (-0.137614 --> -0.147026).  Saving model ...
Epoch: 10 cost time: 0.42168378829956055
Epoch: 10, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.328 Vali Acc: 0.155 Test Loss: 3.328 Test Acc: 0.155
Validation loss decreased (-0.147026 --> -0.155261).  Saving model ...
Epoch: 11 cost time: 0.4245784282684326
Epoch: 11, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.335 Vali Acc: 0.172 Test Loss: 3.335 Test Acc: 0.172
Validation loss decreased (-0.155261 --> -0.171731).  Saving model ...
Epoch: 12 cost time: 0.4598064422607422
Epoch: 12, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.351 Vali Acc: 0.187 Test Loss: 3.351 Test Acc: 0.187
Validation loss decreased (-0.171731 --> -0.187025).  Saving model ...
Epoch: 13 cost time: 0.43531250953674316
Epoch: 13, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.401 Vali Acc: 0.199 Test Loss: 3.401 Test Acc: 0.199
Validation loss decreased (-0.187025 --> -0.198790).  Saving model ...
Epoch: 14 cost time: 0.45571470260620117
Epoch: 14, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.484 Vali Acc: 0.200 Test Loss: 3.484 Test Acc: 0.200
Validation loss decreased (-0.198790 --> -0.199965).  Saving model ...
Epoch: 15 cost time: 0.44167399406433105
Epoch: 15, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.525 Vali Acc: 0.213 Test Loss: 3.525 Test Acc: 0.213
Validation loss decreased (-0.199965 --> -0.212906).  Saving model ...
Epoch: 16 cost time: 0.42227864265441895
Epoch: 16, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.590 Vali Acc: 0.229 Test Loss: 3.590 Test Acc: 0.229
Validation loss decreased (-0.212906 --> -0.229376).  Saving model ...
Epoch: 17 cost time: 0.4314436912536621
Epoch: 17, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.626 Vali Acc: 0.231 Test Loss: 3.626 Test Acc: 0.231
Validation loss decreased (-0.229376 --> -0.230552).  Saving model ...
Epoch: 18 cost time: 0.4128286838531494
Epoch: 18, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.694 Vali Acc: 0.239 Test Loss: 3.694 Test Acc: 0.239
Validation loss decreased (-0.230552 --> -0.238787).  Saving model ...
Epoch: 19 cost time: 0.4533805847167969
Epoch: 19, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.772 Vali Acc: 0.234 Test Loss: 3.772 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3636152744293213
Epoch: 20, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.832 Vali Acc: 0.238 Test Loss: 3.832 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4250824451446533
Epoch: 21, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.869 Vali Acc: 0.246 Test Loss: 3.869 Test Acc: 0.246
Validation loss decreased (-0.238787 --> -0.245844).  Saving model ...
Epoch: 22 cost time: 0.47379112243652344
Epoch: 22, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.918 Vali Acc: 0.247 Test Loss: 3.918 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247020).  Saving model ...
Epoch: 23 cost time: 0.40529346466064453
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.919 Vali Acc: 0.249 Test Loss: 3.919 Test Acc: 0.249
Validation loss decreased (-0.247020 --> -0.249373).  Saving model ...
Epoch: 24 cost time: 0.4330720901489258
Epoch: 24, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.934 Vali Acc: 0.259 Test Loss: 3.934 Test Acc: 0.259
Validation loss decreased (-0.249373 --> -0.258784).  Saving model ...
Epoch: 25 cost time: 0.4087245464324951
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.982 Vali Acc: 0.254 Test Loss: 3.982 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.43669962882995605
Epoch: 26, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.993 Vali Acc: 0.262 Test Loss: 3.993 Test Acc: 0.262
Validation loss decreased (-0.258784 --> -0.262313).  Saving model ...
Epoch: 27 cost time: 0.4436659812927246
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.014 Vali Acc: 0.264 Test Loss: 4.014 Test Acc: 0.264
Validation loss decreased (-0.262313 --> -0.263489).  Saving model ...
Epoch: 28 cost time: 0.44025683403015137
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.055 Vali Acc: 0.258 Test Loss: 4.055 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.44988560676574707
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.070 Vali Acc: 0.259 Test Loss: 4.070 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.42095088958740234
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.087 Vali Acc: 0.256 Test Loss: 4.087 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4323573112487793
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.117 Vali Acc: 0.255 Test Loss: 4.117 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4187781810760498
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.152 Vali Acc: 0.258 Test Loss: 4.152 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4576294422149658
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.158 Vali Acc: 0.259 Test Loss: 4.158 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4305095672607422
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.184 Vali Acc: 0.258 Test Loss: 4.184 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4454052448272705
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.223 Vali Acc: 0.258 Test Loss: 4.223 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4434998035430908
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.233 Vali Acc: 0.264 Test Loss: 4.233 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4070134162902832
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.235 Vali Acc: 0.260 Test Loss: 4.235 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm128_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 168154
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5933363437652588
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.329 Vali Acc: 0.047 Test Loss: 3.329 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.47780513763427734
Epoch: 2, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.391 Vali Acc: 0.088 Test Loss: 3.391 Test Acc: 0.088
Validation loss decreased (-0.047026 --> -0.088201).  Saving model ...
Epoch: 3 cost time: 0.47615790367126465
Epoch: 3, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.282 Vali Acc: 0.140 Test Loss: 3.282 Test Acc: 0.140
Validation loss decreased (-0.088201 --> -0.139967).  Saving model ...
Epoch: 4 cost time: 0.4491260051727295
Epoch: 4, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.242 Vali Acc: 0.145 Test Loss: 3.242 Test Acc: 0.145
Validation loss decreased (-0.139967 --> -0.144673).  Saving model ...
Epoch: 5 cost time: 0.4466068744659424
Epoch: 5, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.244 Vali Acc: 0.202 Test Loss: 3.244 Test Acc: 0.202
Validation loss decreased (-0.144673 --> -0.202321).  Saving model ...
Epoch: 6 cost time: 0.44266843795776367
Epoch: 6, Steps: 10 | Train Loss: 1.034 Vali Loss: 3.463 Vali Acc: 0.206 Test Loss: 3.463 Test Acc: 0.206
Validation loss decreased (-0.202321 --> -0.205848).  Saving model ...
Epoch: 7 cost time: 0.4781026840209961
Epoch: 7, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.446 Vali Acc: 0.216 Test Loss: 3.446 Test Acc: 0.216
Validation loss decreased (-0.205848 --> -0.216436).  Saving model ...
Epoch: 8 cost time: 0.4676034450531006
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.642 Vali Acc: 0.225 Test Loss: 3.642 Test Acc: 0.225
Validation loss decreased (-0.216436 --> -0.224669).  Saving model ...
Epoch: 9 cost time: 0.5153617858886719
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.763 Vali Acc: 0.245 Test Loss: 3.763 Test Acc: 0.245
Validation loss decreased (-0.224669 --> -0.244668).  Saving model ...
Epoch: 10 cost time: 0.5421321392059326
Epoch: 10, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.977 Vali Acc: 0.242 Test Loss: 3.977 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.556995153427124
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.109 Vali Acc: 0.248 Test Loss: 4.109 Test Acc: 0.248
Validation loss decreased (-0.244668 --> -0.248194).  Saving model ...
Epoch: 12 cost time: 0.5076894760131836
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.436 Vali Acc: 0.232 Test Loss: 4.436 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5468900203704834
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.480 Vali Acc: 0.247 Test Loss: 4.480 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5185472965240479
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.545 Vali Acc: 0.248 Test Loss: 4.545 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5644040107727051
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.634 Vali Acc: 0.251 Test Loss: 4.634 Test Acc: 0.251
Validation loss decreased (-0.248194 --> -0.250542).  Saving model ...
Epoch: 16 cost time: 0.5637433528900146
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.692 Vali Acc: 0.258 Test Loss: 4.692 Test Acc: 0.258
Validation loss decreased (-0.250542 --> -0.257600).  Saving model ...
Epoch: 17 cost time: 0.5509293079376221
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.748 Vali Acc: 0.261 Test Loss: 4.748 Test Acc: 0.261
Validation loss decreased (-0.257600 --> -0.261129).  Saving model ...
Epoch: 18 cost time: 0.4904043674468994
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.793 Vali Acc: 0.256 Test Loss: 4.793 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5493218898773193
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.835 Vali Acc: 0.261 Test Loss: 4.835 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5125508308410645
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.838 Vali Acc: 0.261 Test Loss: 4.838 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4998769760131836
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.861 Vali Acc: 0.262 Test Loss: 4.861 Test Acc: 0.262
Validation loss decreased (-0.261129 --> -0.262304).  Saving model ...
Epoch: 22 cost time: 0.5311825275421143
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.895 Vali Acc: 0.264 Test Loss: 4.895 Test Acc: 0.264
Validation loss decreased (-0.262304 --> -0.263480).  Saving model ...
Epoch: 23 cost time: 0.5517187118530273
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.899 Vali Acc: 0.265 Test Loss: 4.899 Test Acc: 0.265
Validation loss decreased (-0.263480 --> -0.264657).  Saving model ...
Epoch: 24 cost time: 0.5289914608001709
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.907 Vali Acc: 0.262 Test Loss: 4.907 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5333569049835205
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.921 Vali Acc: 0.265 Test Loss: 4.921 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5570659637451172
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.934 Vali Acc: 0.264 Test Loss: 4.934 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4839911460876465
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.972 Vali Acc: 0.265 Test Loss: 4.972 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4671618938446045
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.995 Vali Acc: 0.266 Test Loss: 4.995 Test Acc: 0.266
Validation loss decreased (-0.264657 --> -0.265832).  Saving model ...
Epoch: 29 cost time: 0.4885098934173584
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.010 Vali Acc: 0.265 Test Loss: 5.010 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.486724853515625
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.031 Vali Acc: 0.262 Test Loss: 5.031 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.40966224670410156
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.039 Vali Acc: 0.265 Test Loss: 5.039 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.48667192459106445
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.052 Vali Acc: 0.266 Test Loss: 5.052 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.37488245964050293
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.077 Vali Acc: 0.269 Test Loss: 5.077 Test Acc: 0.269
Validation loss decreased (-0.265832 --> -0.269361).  Saving model ...
Epoch: 34 cost time: 0.4853661060333252
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.102 Vali Acc: 0.267 Test Loss: 5.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4716215133666992
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.124 Vali Acc: 0.265 Test Loss: 5.124 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.45745015144348145
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.137 Vali Acc: 0.267 Test Loss: 5.137 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4218897819519043
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.149 Vali Acc: 0.266 Test Loss: 5.149 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.43552398681640625
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.156 Vali Acc: 0.266 Test Loss: 5.156 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4708995819091797
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.172 Vali Acc: 0.265 Test Loss: 5.172 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5129475593566895
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.185 Vali Acc: 0.266 Test Loss: 5.185 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5409440994262695
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.188 Vali Acc: 0.267 Test Loss: 5.188 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.494335412979126
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.217 Vali Acc: 0.266 Test Loss: 5.217 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.47960591316223145
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.237 Vali Acc: 0.264 Test Loss: 5.237 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 429786
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4953124523162842
Epoch: 1, Steps: 10 | Train Loss: 3.486 Vali Loss: 3.317 Vali Acc: 0.038 Test Loss: 3.317 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.4294545650482178
Epoch: 2, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.332 Vali Acc: 0.051 Test Loss: 3.332 Test Acc: 0.051
Validation loss decreased (-0.037614 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.4321744441986084
Epoch: 3, Steps: 10 | Train Loss: 2.877 Vali Loss: 3.335 Vali Acc: 0.084 Test Loss: 3.335 Test Acc: 0.084
Validation loss decreased (-0.050555 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.4571504592895508
Epoch: 4, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.310 Vali Acc: 0.124 Test Loss: 3.310 Test Acc: 0.124
Validation loss decreased (-0.083496 --> -0.123496).  Saving model ...
Epoch: 5 cost time: 0.43706607818603516
Epoch: 5, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.261 Vali Acc: 0.140 Test Loss: 3.261 Test Acc: 0.140
Validation loss decreased (-0.123496 --> -0.139967).  Saving model ...
Epoch: 6 cost time: 0.45519065856933594
Epoch: 6, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.248 Vali Acc: 0.168 Test Loss: 3.248 Test Acc: 0.168
Validation loss decreased (-0.139967 --> -0.168203).  Saving model ...
Epoch: 7 cost time: 0.4687950611114502
Epoch: 7, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.260 Vali Acc: 0.196 Test Loss: 3.260 Test Acc: 0.196
Validation loss decreased (-0.168203 --> -0.196438).  Saving model ...
Epoch: 8 cost time: 0.4601476192474365
Epoch: 8, Steps: 10 | Train Loss: 1.171 Vali Loss: 3.371 Vali Acc: 0.185 Test Loss: 3.371 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4065568447113037
Epoch: 9, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.404 Vali Acc: 0.213 Test Loss: 3.404 Test Acc: 0.213
Validation loss decreased (-0.196438 --> -0.212907).  Saving model ...
Epoch: 10 cost time: 0.44455647468566895
Epoch: 10, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.445 Vali Acc: 0.227 Test Loss: 3.445 Test Acc: 0.227
Validation loss decreased (-0.212907 --> -0.227024).  Saving model ...
Epoch: 11 cost time: 0.4781198501586914
Epoch: 11, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.548 Vali Acc: 0.246 Test Loss: 3.548 Test Acc: 0.246
Validation loss decreased (-0.227024 --> -0.245847).  Saving model ...
Epoch: 12 cost time: 0.44149279594421387
Epoch: 12, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.651 Vali Acc: 0.241 Test Loss: 3.651 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4470202922821045
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.736 Vali Acc: 0.252 Test Loss: 3.736 Test Acc: 0.252
Validation loss decreased (-0.245847 --> -0.251727).  Saving model ...
Epoch: 14 cost time: 0.44705986976623535
Epoch: 14, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.838 Vali Acc: 0.254 Test Loss: 3.838 Test Acc: 0.254
Validation loss decreased (-0.251727 --> -0.254079).  Saving model ...
Epoch: 15 cost time: 0.44356489181518555
Epoch: 15, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.940 Vali Acc: 0.261 Test Loss: 3.940 Test Acc: 0.261
Validation loss decreased (-0.254079 --> -0.261137).  Saving model ...
Epoch: 16 cost time: 0.44460415840148926
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.045 Vali Acc: 0.265 Test Loss: 4.045 Test Acc: 0.265
Validation loss decreased (-0.261137 --> -0.264665).  Saving model ...
Epoch: 17 cost time: 0.4469571113586426
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.192 Vali Acc: 0.255 Test Loss: 4.192 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.44853711128234863
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.221 Vali Acc: 0.265 Test Loss: 4.221 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4136536121368408
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.228 Vali Acc: 0.272 Test Loss: 4.228 Test Acc: 0.272
Validation loss decreased (-0.264665 --> -0.271722).  Saving model ...
Epoch: 20 cost time: 0.43128538131713867
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.264 Vali Acc: 0.272 Test Loss: 4.264 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4346797466278076
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.314 Vali Acc: 0.267 Test Loss: 4.314 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.37837862968444824
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.340 Vali Acc: 0.273 Test Loss: 4.340 Test Acc: 0.273
Validation loss decreased (-0.271722 --> -0.272898).  Saving model ...
Epoch: 23 cost time: 0.473499059677124
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.380 Vali Acc: 0.271 Test Loss: 4.380 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42093896865844727
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.415 Vali Acc: 0.274 Test Loss: 4.415 Test Acc: 0.274
Validation loss decreased (-0.272898 --> -0.274074).  Saving model ...
Epoch: 25 cost time: 0.4671361446380615
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.440 Vali Acc: 0.274 Test Loss: 4.440 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4132513999938965
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.474 Vali Acc: 0.275 Test Loss: 4.474 Test Acc: 0.275
Validation loss decreased (-0.274074 --> -0.275249).  Saving model ...
Epoch: 27 cost time: 0.45404744148254395
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.526 Vali Acc: 0.272 Test Loss: 4.526 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4227867126464844
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.543 Vali Acc: 0.273 Test Loss: 4.543 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.46988368034362793
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.556 Vali Acc: 0.273 Test Loss: 4.556 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4601004123687744
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.574 Vali Acc: 0.275 Test Loss: 4.574 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.46988892555236816
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.574 Vali Acc: 0.275 Test Loss: 4.574 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4418632984161377
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.605 Vali Acc: 0.275 Test Loss: 4.605 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.42983245849609375
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.635 Vali Acc: 0.273 Test Loss: 4.635 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4429497718811035
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.647 Vali Acc: 0.269 Test Loss: 4.647 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4587404727935791
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.677 Vali Acc: 0.267 Test Loss: 4.677 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4457423686981201
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.683 Vali Acc: 0.267 Test Loss: 4.683 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 240346
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6867432594299316
Epoch: 1, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.366 Vali Acc: 0.036 Test Loss: 3.366 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.4182779788970947
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.318 Vali Acc: 0.046 Test Loss: 3.318 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.43059778213500977
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.323 Vali Acc: 0.076 Test Loss: 3.323 Test Acc: 0.076
Validation loss decreased (-0.045849 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.36620569229125977
Epoch: 4, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.296 Vali Acc: 0.105 Test Loss: 3.296 Test Acc: 0.105
Validation loss decreased (-0.076437 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.4429800510406494
Epoch: 5, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.270 Vali Acc: 0.118 Test Loss: 3.270 Test Acc: 0.118
Validation loss decreased (-0.104673 --> -0.117614).  Saving model ...
Epoch: 6 cost time: 0.4925265312194824
Epoch: 6, Steps: 10 | Train Loss: 2.166 Vali Loss: 3.232 Vali Acc: 0.125 Test Loss: 3.232 Test Acc: 0.125
Validation loss decreased (-0.117614 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 0.4580872058868408
Epoch: 7, Steps: 10 | Train Loss: 1.924 Vali Loss: 3.226 Vali Acc: 0.140 Test Loss: 3.226 Test Acc: 0.140
Validation loss decreased (-0.124674 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.419574499130249
Epoch: 8, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.239 Vali Acc: 0.169 Test Loss: 3.239 Test Acc: 0.169
Validation loss decreased (-0.139968 --> -0.169379).  Saving model ...
Epoch: 9 cost time: 0.44765567779541016
Epoch: 9, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.271 Vali Acc: 0.181 Test Loss: 3.271 Test Acc: 0.181
Validation loss decreased (-0.169379 --> -0.181144).  Saving model ...
Epoch: 10 cost time: 0.4358987808227539
Epoch: 10, Steps: 10 | Train Loss: 1.192 Vali Loss: 3.312 Vali Acc: 0.195 Test Loss: 3.312 Test Acc: 0.195
Validation loss decreased (-0.181144 --> -0.195261).  Saving model ...
Epoch: 11 cost time: 0.47098803520202637
Epoch: 11, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.362 Vali Acc: 0.204 Test Loss: 3.362 Test Acc: 0.204
Validation loss decreased (-0.195261 --> -0.203496).  Saving model ...
Epoch: 12 cost time: 0.4368135929107666
Epoch: 12, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.396 Vali Acc: 0.214 Test Loss: 3.396 Test Acc: 0.214
Validation loss decreased (-0.203496 --> -0.214084).  Saving model ...
Epoch: 13 cost time: 0.4392545223236084
Epoch: 13, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.444 Vali Acc: 0.231 Test Loss: 3.444 Test Acc: 0.231
Validation loss decreased (-0.214084 --> -0.230554).  Saving model ...
Epoch: 14 cost time: 0.42220544815063477
Epoch: 14, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.537 Vali Acc: 0.233 Test Loss: 3.537 Test Acc: 0.233
Validation loss decreased (-0.230554 --> -0.232906).  Saving model ...
Epoch: 15 cost time: 0.42873668670654297
Epoch: 15, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.590 Vali Acc: 0.229 Test Loss: 3.590 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.44640350341796875
Epoch: 16, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.709 Vali Acc: 0.234 Test Loss: 3.709 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234081).  Saving model ...
Epoch: 17 cost time: 0.5713527202606201
Epoch: 17, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.797 Vali Acc: 0.256 Test Loss: 3.797 Test Acc: 0.256
Validation loss decreased (-0.234081 --> -0.256433).  Saving model ...
Epoch: 18 cost time: 0.40161800384521484
Epoch: 18, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.893 Vali Acc: 0.245 Test Loss: 3.893 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.43874049186706543
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.926 Vali Acc: 0.253 Test Loss: 3.926 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.49013257026672363
Epoch: 20, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.998 Vali Acc: 0.254 Test Loss: 3.998 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.40220022201538086
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.120 Vali Acc: 0.253 Test Loss: 4.120 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.47049474716186523
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.144 Vali Acc: 0.253 Test Loss: 4.144 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4655036926269531
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.159 Vali Acc: 0.258 Test Loss: 4.159 Test Acc: 0.258
Validation loss decreased (-0.256433 --> -0.257605).  Saving model ...
Epoch: 24 cost time: 0.46978092193603516
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.237 Vali Acc: 0.251 Test Loss: 4.237 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4605400562286377
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.278 Vali Acc: 0.255 Test Loss: 4.278 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.45430588722229004
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.309 Vali Acc: 0.249 Test Loss: 4.309 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4542372226715088
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.341 Vali Acc: 0.253 Test Loss: 4.341 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.43665122985839844
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.368 Vali Acc: 0.256 Test Loss: 4.368 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.33371400833129883
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.385 Vali Acc: 0.262 Test Loss: 4.385 Test Acc: 0.262
Validation loss decreased (-0.257605 --> -0.262309).  Saving model ...
Epoch: 30 cost time: 0.4496018886566162
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.399 Vali Acc: 0.268 Test Loss: 4.399 Test Acc: 0.268
Validation loss decreased (-0.262309 --> -0.268191).  Saving model ...
Epoch: 31 cost time: 0.4532206058502197
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.425 Vali Acc: 0.262 Test Loss: 4.425 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4655036926269531
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.453 Vali Acc: 0.256 Test Loss: 4.453 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4313509464263916
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.479 Vali Acc: 0.258 Test Loss: 4.479 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4237484931945801
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.500 Vali Acc: 0.262 Test Loss: 4.500 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4554147720336914
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.519 Vali Acc: 0.260 Test Loss: 4.519 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.43343305587768555
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.541 Vali Acc: 0.261 Test Loss: 4.541 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.45745015144348145
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.543 Vali Acc: 0.258 Test Loss: 4.543 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.44802427291870117
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.550 Vali Acc: 0.259 Test Loss: 4.550 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4742734432220459
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.577 Vali Acc: 0.254 Test Loss: 4.577 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.47437286376953125
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.578 Vali Acc: 0.256 Test Loss: 4.578 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 175706
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5087065696716309
Epoch: 1, Steps: 10 | Train Loss: 3.452 Vali Loss: 3.332 Vali Acc: 0.032 Test Loss: 3.332 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.4365081787109375
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.317 Vali Acc: 0.047 Test Loss: 3.317 Test Acc: 0.047
Validation loss decreased (-0.031731 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.43244051933288574
Epoch: 3, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.326 Vali Acc: 0.059 Test Loss: 3.326 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058790).  Saving model ...
Epoch: 4 cost time: 0.45830464363098145
Epoch: 4, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.320 Vali Acc: 0.075 Test Loss: 3.320 Test Acc: 0.075
Validation loss decreased (-0.058790 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.4140806198120117
Epoch: 5, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.285 Vali Acc: 0.104 Test Loss: 3.285 Test Acc: 0.104
Validation loss decreased (-0.075261 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.42705512046813965
Epoch: 6, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.270 Vali Acc: 0.134 Test Loss: 3.270 Test Acc: 0.134
Validation loss decreased (-0.103497 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.445847749710083
Epoch: 7, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.251 Vali Acc: 0.144 Test Loss: 3.251 Test Acc: 0.144
Validation loss decreased (-0.134085 --> -0.143497).  Saving model ...
Epoch: 8 cost time: 0.454728364944458
Epoch: 8, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.245 Vali Acc: 0.153 Test Loss: 3.245 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 9 cost time: 0.4518008232116699
Epoch: 9, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.272 Vali Acc: 0.173 Test Loss: 3.272 Test Acc: 0.173
Validation loss decreased (-0.152909 --> -0.172908).  Saving model ...
Epoch: 10 cost time: 0.43945837020874023
Epoch: 10, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.299 Vali Acc: 0.185 Test Loss: 3.299 Test Acc: 0.185
Validation loss decreased (-0.172908 --> -0.184673).  Saving model ...
Epoch: 11 cost time: 0.4291117191314697
Epoch: 11, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.329 Vali Acc: 0.189 Test Loss: 3.329 Test Acc: 0.189
Validation loss decreased (-0.184673 --> -0.189378).  Saving model ...
Epoch: 12 cost time: 0.4302198886871338
Epoch: 12, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.349 Vali Acc: 0.205 Test Loss: 3.349 Test Acc: 0.205
Validation loss decreased (-0.189378 --> -0.204672).  Saving model ...
Epoch: 13 cost time: 0.4736940860748291
Epoch: 13, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.387 Vali Acc: 0.218 Test Loss: 3.387 Test Acc: 0.218
Validation loss decreased (-0.204672 --> -0.217613).  Saving model ...
Epoch: 14 cost time: 0.4649510383605957
Epoch: 14, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.451 Vali Acc: 0.222 Test Loss: 3.451 Test Acc: 0.222
Validation loss decreased (-0.217613 --> -0.222318).  Saving model ...
Epoch: 15 cost time: 0.4089696407318115
Epoch: 15, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.517 Vali Acc: 0.235 Test Loss: 3.517 Test Acc: 0.235
Validation loss decreased (-0.222318 --> -0.235259).  Saving model ...
Epoch: 16 cost time: 0.43533825874328613
Epoch: 16, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.602 Vali Acc: 0.235 Test Loss: 3.602 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47929978370666504
Epoch: 17, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.654 Vali Acc: 0.256 Test Loss: 3.654 Test Acc: 0.256
Validation loss decreased (-0.235259 --> -0.256434).  Saving model ...
Epoch: 18 cost time: 0.4635782241821289
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.700 Vali Acc: 0.255 Test Loss: 3.700 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.45609164237976074
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.769 Vali Acc: 0.254 Test Loss: 3.769 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.45974159240722656
Epoch: 20, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.881 Vali Acc: 0.244 Test Loss: 3.881 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4524238109588623
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.965 Vali Acc: 0.248 Test Loss: 3.965 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.45366430282592773
Epoch: 22, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.992 Vali Acc: 0.259 Test Loss: 3.992 Test Acc: 0.259
Validation loss decreased (-0.256434 --> -0.258784).  Saving model ...
Epoch: 23 cost time: 0.4234657287597656
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.046 Vali Acc: 0.264 Test Loss: 4.046 Test Acc: 0.264
Validation loss decreased (-0.258784 --> -0.263489).  Saving model ...
Epoch: 24 cost time: 0.45033860206604004
Epoch: 24, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.111 Vali Acc: 0.252 Test Loss: 4.111 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4579927921295166
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.151 Vali Acc: 0.252 Test Loss: 4.151 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.45789575576782227
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.185 Vali Acc: 0.255 Test Loss: 4.185 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4578113555908203
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.224 Vali Acc: 0.259 Test Loss: 4.224 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4197571277618408
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.246 Vali Acc: 0.269 Test Loss: 4.246 Test Acc: 0.269
Validation loss decreased (-0.263489 --> -0.269369).  Saving model ...
Epoch: 29 cost time: 0.43659377098083496
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.257 Vali Acc: 0.272 Test Loss: 4.257 Test Acc: 0.272
Validation loss decreased (-0.269369 --> -0.271722).  Saving model ...
Epoch: 30 cost time: 0.43739867210388184
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.297 Vali Acc: 0.269 Test Loss: 4.297 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4518868923187256
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.319 Vali Acc: 0.269 Test Loss: 4.319 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4500405788421631
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.341 Vali Acc: 0.272 Test Loss: 4.341 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.45040154457092285
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.371 Vali Acc: 0.267 Test Loss: 4.371 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5015854835510254
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.388 Vali Acc: 0.266 Test Loss: 4.388 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4324309825897217
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.416 Vali Acc: 0.269 Test Loss: 4.416 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5325021743774414
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.442 Vali Acc: 0.269 Test Loss: 4.442 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4459197521209717
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.467 Vali Acc: 0.269 Test Loss: 4.467 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.46224117279052734
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.498 Vali Acc: 0.271 Test Loss: 4.498 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4488999843597412
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.507 Vali Acc: 0.269 Test Loss: 4.507 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 146010
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4458320140838623
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.340 Vali Acc: 0.027 Test Loss: 3.340 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.4544193744659424
Epoch: 2, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.318 Vali Acc: 0.052 Test Loss: 3.318 Test Acc: 0.052
Validation loss decreased (-0.027025 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.45649266242980957
Epoch: 3, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.297 Vali Acc: 0.078 Test Loss: 3.297 Test Acc: 0.078
Validation loss decreased (-0.051732 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.4682345390319824
Epoch: 4, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.292 Vali Acc: 0.100 Test Loss: 3.292 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099967).  Saving model ...
Epoch: 5 cost time: 0.4489467144012451
Epoch: 5, Steps: 10 | Train Loss: 2.800 Vali Loss: 3.287 Vali Acc: 0.113 Test Loss: 3.287 Test Acc: 0.113
Validation loss decreased (-0.099967 --> -0.112908).  Saving model ...
Epoch: 6 cost time: 0.43102550506591797
Epoch: 6, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.277 Vali Acc: 0.122 Test Loss: 3.277 Test Acc: 0.122
Validation loss decreased (-0.112908 --> -0.122320).  Saving model ...
Epoch: 7 cost time: 0.4658033847808838
Epoch: 7, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.266 Vali Acc: 0.136 Test Loss: 3.266 Test Acc: 0.136
Validation loss decreased (-0.122320 --> -0.136438).  Saving model ...
Epoch: 8 cost time: 0.3819851875305176
Epoch: 8, Steps: 10 | Train Loss: 2.246 Vali Loss: 3.255 Vali Acc: 0.142 Test Loss: 3.255 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142320).  Saving model ...
Epoch: 9 cost time: 0.4477579593658447
Epoch: 9, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.245 Vali Acc: 0.149 Test Loss: 3.245 Test Acc: 0.149
Validation loss decreased (-0.142320 --> -0.149379).  Saving model ...
Epoch: 10 cost time: 0.43097972869873047
Epoch: 10, Steps: 10 | Train Loss: 1.798 Vali Loss: 3.249 Vali Acc: 0.165 Test Loss: 3.249 Test Acc: 0.165
Validation loss decreased (-0.149379 --> -0.164673).  Saving model ...
Epoch: 11 cost time: 0.4421732425689697
Epoch: 11, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.255 Vali Acc: 0.179 Test Loss: 3.255 Test Acc: 0.179
Validation loss decreased (-0.164673 --> -0.178791).  Saving model ...
Epoch: 12 cost time: 0.44331836700439453
Epoch: 12, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.261 Vali Acc: 0.189 Test Loss: 3.261 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189379).  Saving model ...
Epoch: 13 cost time: 0.4468989372253418
Epoch: 13, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.285 Vali Acc: 0.199 Test Loss: 3.285 Test Acc: 0.199
Validation loss decreased (-0.189379 --> -0.198791).  Saving model ...
Epoch: 14 cost time: 0.44986462593078613
Epoch: 14, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.310 Vali Acc: 0.212 Test Loss: 3.310 Test Acc: 0.212
Validation loss decreased (-0.198791 --> -0.211732).  Saving model ...
Epoch: 15 cost time: 0.42236971855163574
Epoch: 15, Steps: 10 | Train Loss: 0.926 Vali Loss: 3.348 Vali Acc: 0.219 Test Loss: 3.348 Test Acc: 0.219
Validation loss decreased (-0.211732 --> -0.218790).  Saving model ...
Epoch: 16 cost time: 0.43241286277770996
Epoch: 16, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.407 Vali Acc: 0.220 Test Loss: 3.407 Test Acc: 0.220
Validation loss decreased (-0.218790 --> -0.219966).  Saving model ...
Epoch: 17 cost time: 0.446455717086792
Epoch: 17, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.443 Vali Acc: 0.226 Test Loss: 3.443 Test Acc: 0.226
Validation loss decreased (-0.219966 --> -0.225848).  Saving model ...
Epoch: 18 cost time: 0.4305849075317383
Epoch: 18, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.487 Vali Acc: 0.240 Test Loss: 3.487 Test Acc: 0.240
Validation loss decreased (-0.225848 --> -0.239965).  Saving model ...
Epoch: 19 cost time: 0.4465489387512207
Epoch: 19, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.540 Vali Acc: 0.241 Test Loss: 3.540 Test Acc: 0.241
Validation loss decreased (-0.239965 --> -0.241141).  Saving model ...
Epoch: 20 cost time: 0.49136996269226074
Epoch: 20, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.591 Vali Acc: 0.234 Test Loss: 3.591 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.47200798988342285
Epoch: 21, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.638 Vali Acc: 0.234 Test Loss: 3.638 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.47781872749328613
Epoch: 22, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.707 Vali Acc: 0.234 Test Loss: 3.707 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4802396297454834
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.771 Vali Acc: 0.226 Test Loss: 3.771 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4689304828643799
Epoch: 24, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.824 Vali Acc: 0.239 Test Loss: 3.824 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4759047031402588
Epoch: 25, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.862 Vali Acc: 0.246 Test Loss: 3.862 Test Acc: 0.246
Validation loss decreased (-0.241141 --> -0.245844).  Saving model ...
Epoch: 26 cost time: 0.4620327949523926
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.898 Vali Acc: 0.240 Test Loss: 3.898 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.446256160736084
Epoch: 27, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.960 Vali Acc: 0.236 Test Loss: 3.960 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4671950340270996
Epoch: 28, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.008 Vali Acc: 0.233 Test Loss: 4.008 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4474806785583496
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.047 Vali Acc: 0.236 Test Loss: 4.047 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.45332837104797363
Epoch: 30, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.060 Vali Acc: 0.246 Test Loss: 4.060 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4390413761138916
Epoch: 31, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.073 Vali Acc: 0.247 Test Loss: 4.073 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247018).  Saving model ...
Epoch: 32 cost time: 0.43731141090393066
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.099 Vali Acc: 0.248 Test Loss: 4.099 Test Acc: 0.248
Validation loss decreased (-0.247018 --> -0.248194).  Saving model ...
Epoch: 33 cost time: 0.4661421775817871
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.144 Vali Acc: 0.248 Test Loss: 4.144 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.47536802291870117
Epoch: 34, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.180 Vali Acc: 0.251 Test Loss: 4.180 Test Acc: 0.251
Validation loss decreased (-0.248194 --> -0.250546).  Saving model ...
Epoch: 35 cost time: 0.4285919666290283
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.214 Vali Acc: 0.252 Test Loss: 4.214 Test Acc: 0.252
Validation loss decreased (-0.250546 --> -0.251723).  Saving model ...
Epoch: 36 cost time: 0.46855616569519043
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.214 Vali Acc: 0.252 Test Loss: 4.214 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.45139455795288086
Epoch: 37, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.232 Vali Acc: 0.252 Test Loss: 4.232 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5161769390106201
Epoch: 38, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.254 Vali Acc: 0.253 Test Loss: 4.254 Test Acc: 0.253
Validation loss decreased (-0.251723 --> -0.252899).  Saving model ...
Epoch: 39 cost time: 0.4205362796783447
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.262 Vali Acc: 0.252 Test Loss: 4.262 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4602663516998291
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.296 Vali Acc: 0.249 Test Loss: 4.296 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.44941115379333496
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.331 Vali Acc: 0.247 Test Loss: 4.331 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.44572925567626953
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.344 Vali Acc: 0.251 Test Loss: 4.344 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4752058982849121
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.354 Vali Acc: 0.254 Test Loss: 4.354 Test Acc: 0.254
Validation loss decreased (-0.252899 --> -0.254074).  Saving model ...
Epoch: 44 cost time: 0.4426558017730713
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.367 Vali Acc: 0.251 Test Loss: 4.367 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4366786479949951
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.376 Vali Acc: 0.251 Test Loss: 4.376 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4642500877380371
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.386 Vali Acc: 0.256 Test Loss: 4.386 Test Acc: 0.256
Validation loss decreased (-0.254074 --> -0.256427).  Saving model ...
Epoch: 47 cost time: 0.4271841049194336
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.397 Vali Acc: 0.259 Test Loss: 4.397 Test Acc: 0.259
Validation loss decreased (-0.256427 --> -0.258780).  Saving model ...
Epoch: 48 cost time: 0.43521547317504883
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.403 Vali Acc: 0.260 Test Loss: 4.403 Test Acc: 0.260
Validation loss decreased (-0.258780 --> -0.259956).  Saving model ...
Epoch: 49 cost time: 0.4495279788970947
Epoch: 49, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.427 Vali Acc: 0.261 Test Loss: 4.427 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 50 cost time: 0.4595069885253906
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.434 Vali Acc: 0.261 Test Loss: 4.434 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5201256275177002
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.458 Vali Acc: 0.260 Test Loss: 4.458 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4781320095062256
Epoch: 52, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.488 Vali Acc: 0.260 Test Loss: 4.488 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.42424893379211426
Epoch: 53, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.492 Vali Acc: 0.261 Test Loss: 4.492 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.38846373558044434
Epoch: 54, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.491 Vali Acc: 0.264 Test Loss: 4.491 Test Acc: 0.264
Validation loss decreased (-0.261132 --> -0.263484).  Saving model ...
Epoch: 55 cost time: 0.4075202941894531
Epoch: 55, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.521 Vali Acc: 0.265 Test Loss: 4.521 Test Acc: 0.265
Validation loss decreased (-0.263484 --> -0.264661).  Saving model ...
Epoch: 56 cost time: 0.40090513229370117
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.547 Vali Acc: 0.262 Test Loss: 4.547 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4222071170806885
Epoch: 57, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.547 Vali Acc: 0.264 Test Loss: 4.547 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.44611072540283203
Epoch: 58, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.556 Vali Acc: 0.264 Test Loss: 4.556 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.42737603187561035
Epoch: 59, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.563 Vali Acc: 0.264 Test Loss: 4.563 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.43790531158447266
Epoch: 60, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.563 Vali Acc: 0.266 Test Loss: 4.563 Test Acc: 0.266
Validation loss decreased (-0.264661 --> -0.265837).  Saving model ...
Epoch: 61 cost time: 0.3782002925872803
Epoch: 61, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.588 Vali Acc: 0.262 Test Loss: 4.588 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4055001735687256
Epoch: 62, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.594 Vali Acc: 0.266 Test Loss: 4.594 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.44301915168762207
Epoch: 63, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.592 Vali Acc: 0.266 Test Loss: 4.592 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.41492700576782227
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.590 Vali Acc: 0.265 Test Loss: 4.590 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.4186410903930664
Epoch: 65, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.605 Vali Acc: 0.266 Test Loss: 4.605 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.3758985996246338
Epoch: 66, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.266 Test Loss: 4.610 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.3879430294036865
Epoch: 67, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.617 Vali Acc: 0.264 Test Loss: 4.617 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.4748194217681885
Epoch: 68, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.646 Vali Acc: 0.265 Test Loss: 4.646 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.4079153537750244
Epoch: 69, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.663 Vali Acc: 0.265 Test Loss: 4.663 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.4410872459411621
Epoch: 70, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.671 Vali Acc: 0.265 Test Loss: 4.671 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 111514
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4076547622680664
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.392 Vali Acc: 0.033 Test Loss: 3.392 Test Acc: 0.033
Validation loss decreased (inf --> -0.032907).  Saving model ...
Epoch: 2 cost time: 0.4334278106689453
Epoch: 2, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.374 Vali Acc: 0.046 Test Loss: 3.374 Test Acc: 0.046
Validation loss decreased (-0.032907 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.457089900970459
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.352 Vali Acc: 0.055 Test Loss: 3.352 Test Acc: 0.055
Validation loss decreased (-0.045849 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.42694830894470215
Epoch: 4, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.340 Vali Acc: 0.075 Test Loss: 3.340 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.4587888717651367
Epoch: 5, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.329 Vali Acc: 0.089 Test Loss: 3.329 Test Acc: 0.089
Validation loss decreased (-0.075261 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 0.45547056198120117
Epoch: 6, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.317 Vali Acc: 0.101 Test Loss: 3.317 Test Acc: 0.101
Validation loss decreased (-0.089378 --> -0.101143).  Saving model ...
Epoch: 7 cost time: 0.4373631477355957
Epoch: 7, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.307 Vali Acc: 0.119 Test Loss: 3.307 Test Acc: 0.119
Validation loss decreased (-0.101143 --> -0.118790).  Saving model ...
Epoch: 8 cost time: 0.42833542823791504
Epoch: 8, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.294 Vali Acc: 0.120 Test Loss: 3.294 Test Acc: 0.120
Validation loss decreased (-0.118790 --> -0.119967).  Saving model ...
Epoch: 9 cost time: 0.4489755630493164
Epoch: 9, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.285 Vali Acc: 0.132 Test Loss: 3.285 Test Acc: 0.132
Validation loss decreased (-0.119967 --> -0.131732).  Saving model ...
Epoch: 10 cost time: 0.421830415725708
Epoch: 10, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.271 Vali Acc: 0.144 Test Loss: 3.271 Test Acc: 0.144
Validation loss decreased (-0.131732 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.468874454498291
Epoch: 11, Steps: 10 | Train Loss: 1.881 Vali Loss: 3.270 Vali Acc: 0.149 Test Loss: 3.270 Test Acc: 0.149
Validation loss decreased (-0.143497 --> -0.149379).  Saving model ...
Epoch: 12 cost time: 0.4450356960296631
Epoch: 12, Steps: 10 | Train Loss: 1.758 Vali Loss: 3.278 Vali Acc: 0.162 Test Loss: 3.278 Test Acc: 0.162
Validation loss decreased (-0.149379 --> -0.162320).  Saving model ...
Epoch: 13 cost time: 0.46323561668395996
Epoch: 13, Steps: 10 | Train Loss: 1.570 Vali Loss: 3.288 Vali Acc: 0.161 Test Loss: 3.288 Test Acc: 0.161
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.44687724113464355
Epoch: 14, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.308 Vali Acc: 0.174 Test Loss: 3.308 Test Acc: 0.174
Validation loss decreased (-0.162320 --> -0.174085).  Saving model ...
Epoch: 15 cost time: 0.4224705696105957
Epoch: 15, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.324 Vali Acc: 0.180 Test Loss: 3.324 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 16 cost time: 0.4450411796569824
Epoch: 16, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.345 Vali Acc: 0.179 Test Loss: 3.345 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.40000152587890625
Epoch: 17, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.375 Vali Acc: 0.193 Test Loss: 3.375 Test Acc: 0.193
Validation loss decreased (-0.179967 --> -0.192907).  Saving model ...
Epoch: 18 cost time: 0.4158635139465332
Epoch: 18, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.407 Vali Acc: 0.204 Test Loss: 3.407 Test Acc: 0.204
Validation loss decreased (-0.192907 --> -0.203495).  Saving model ...
Epoch: 19 cost time: 0.39079999923706055
Epoch: 19, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.433 Vali Acc: 0.202 Test Loss: 3.433 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4586794376373291
Epoch: 20, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.468 Vali Acc: 0.202 Test Loss: 3.468 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4495396614074707
Epoch: 21, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.517 Vali Acc: 0.202 Test Loss: 3.517 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.45240139961242676
Epoch: 22, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.555 Vali Acc: 0.204 Test Loss: 3.555 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4598705768585205
Epoch: 23, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.614 Vali Acc: 0.206 Test Loss: 3.614 Test Acc: 0.206
Validation loss decreased (-0.203495 --> -0.205846).  Saving model ...
Epoch: 24 cost time: 0.4468419551849365
Epoch: 24, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.664 Vali Acc: 0.213 Test Loss: 3.664 Test Acc: 0.213
Validation loss decreased (-0.205846 --> -0.212905).  Saving model ...
Epoch: 25 cost time: 0.43639707565307617
Epoch: 25, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.706 Vali Acc: 0.218 Test Loss: 3.706 Test Acc: 0.218
Validation loss decreased (-0.212905 --> -0.217610).  Saving model ...
Epoch: 26 cost time: 0.48587918281555176
Epoch: 26, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.744 Vali Acc: 0.222 Test Loss: 3.744 Test Acc: 0.222
Validation loss decreased (-0.217610 --> -0.222316).  Saving model ...
Epoch: 27 cost time: 0.44409656524658203
Epoch: 27, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.793 Vali Acc: 0.227 Test Loss: 3.793 Test Acc: 0.227
Validation loss decreased (-0.222316 --> -0.227021).  Saving model ...
Epoch: 28 cost time: 0.44888877868652344
Epoch: 28, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.817 Vali Acc: 0.225 Test Loss: 3.817 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4519217014312744
Epoch: 29, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.846 Vali Acc: 0.228 Test Loss: 3.846 Test Acc: 0.228
Validation loss decreased (-0.227021 --> -0.228197).  Saving model ...
Epoch: 30 cost time: 0.49246859550476074
Epoch: 30, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.879 Vali Acc: 0.227 Test Loss: 3.879 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.44582629203796387
Epoch: 31, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.929 Vali Acc: 0.222 Test Loss: 3.929 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4528019428253174
Epoch: 32, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.972 Vali Acc: 0.221 Test Loss: 3.972 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5024735927581787
Epoch: 33, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.029 Vali Acc: 0.218 Test Loss: 4.029 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4421274662017822
Epoch: 34, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.035 Vali Acc: 0.219 Test Loss: 4.035 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4342613220214844
Epoch: 35, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.057 Vali Acc: 0.220 Test Loss: 4.057 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.488131046295166
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.082 Vali Acc: 0.227 Test Loss: 4.082 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.47574687004089355
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.102 Vali Acc: 0.229 Test Loss: 4.102 Test Acc: 0.229
Validation loss decreased (-0.228197 --> -0.229371).  Saving model ...
Epoch: 38 cost time: 0.4483368396759033
Epoch: 38, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.139 Vali Acc: 0.221 Test Loss: 4.139 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49803662300109863
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.183 Vali Acc: 0.215 Test Loss: 4.183 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.41704893112182617
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.204 Vali Acc: 0.220 Test Loss: 4.204 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.3572661876678467
Epoch: 41, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.214 Vali Acc: 0.225 Test Loss: 4.214 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4812591075897217
Epoch: 42, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.237 Vali Acc: 0.225 Test Loss: 4.237 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4643125534057617
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.264 Vali Acc: 0.226 Test Loss: 4.264 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4070146083831787
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.283 Vali Acc: 0.227 Test Loss: 4.283 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.44173550605773926
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.315 Vali Acc: 0.225 Test Loss: 4.315 Test Acc: 0.225
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.39865803718566895
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.328 Vali Acc: 0.221 Test Loss: 4.328 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.43122053146362305
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.347 Vali Acc: 0.227 Test Loss: 4.347 Test Acc: 0.227
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 97050
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4642179012298584
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.353 Vali Acc: 0.035 Test Loss: 3.353 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.427107572555542
Epoch: 2, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.338 Vali Acc: 0.031 Test Loss: 3.338 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4351539611816406
Epoch: 3, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.320 Vali Acc: 0.045 Test Loss: 3.320 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.4114253520965576
Epoch: 4, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.300 Vali Acc: 0.053 Test Loss: 3.300 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.4279348850250244
Epoch: 5, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.290 Vali Acc: 0.068 Test Loss: 3.290 Test Acc: 0.068
Validation loss decreased (-0.052908 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 0.41834306716918945
Epoch: 6, Steps: 10 | Train Loss: 2.858 Vali Loss: 3.273 Vali Acc: 0.087 Test Loss: 3.273 Test Acc: 0.087
Validation loss decreased (-0.068202 --> -0.087026).  Saving model ...
Epoch: 7 cost time: 0.4490547180175781
Epoch: 7, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.267 Vali Acc: 0.101 Test Loss: 3.267 Test Acc: 0.101
Validation loss decreased (-0.087026 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.3909580707550049
Epoch: 8, Steps: 10 | Train Loss: 2.522 Vali Loss: 3.259 Vali Acc: 0.102 Test Loss: 3.259 Test Acc: 0.102
Validation loss decreased (-0.101144 --> -0.102320).  Saving model ...
Epoch: 9 cost time: 0.44415760040283203
Epoch: 9, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.250 Vali Acc: 0.118 Test Loss: 3.250 Test Acc: 0.118
Validation loss decreased (-0.102320 --> -0.117615).  Saving model ...
Epoch: 10 cost time: 0.4653611183166504
Epoch: 10, Steps: 10 | Train Loss: 2.248 Vali Loss: 3.249 Vali Acc: 0.127 Test Loss: 3.249 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127026).  Saving model ...
Epoch: 11 cost time: 0.4660780429840088
Epoch: 11, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.243 Vali Acc: 0.139 Test Loss: 3.243 Test Acc: 0.139
Validation loss decreased (-0.127026 --> -0.138791).  Saving model ...
Epoch: 12 cost time: 0.44373345375061035
Epoch: 12, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.235 Vali Acc: 0.158 Test Loss: 3.235 Test Acc: 0.158
Validation loss decreased (-0.138791 --> -0.157615).  Saving model ...
Epoch: 13 cost time: 0.4101238250732422
Epoch: 13, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.245 Vali Acc: 0.171 Test Loss: 3.245 Test Acc: 0.171
Validation loss decreased (-0.157615 --> -0.170556).  Saving model ...
Epoch: 14 cost time: 0.4379007816314697
Epoch: 14, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.261 Vali Acc: 0.179 Test Loss: 3.261 Test Acc: 0.179
Validation loss decreased (-0.170556 --> -0.178791).  Saving model ...
Epoch: 15 cost time: 0.43041014671325684
Epoch: 15, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.280 Vali Acc: 0.181 Test Loss: 3.280 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181144).  Saving model ...
Epoch: 16 cost time: 0.4510331153869629
Epoch: 16, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.296 Vali Acc: 0.194 Test Loss: 3.296 Test Acc: 0.194
Validation loss decreased (-0.181144 --> -0.194085).  Saving model ...
Epoch: 17 cost time: 0.4403188228607178
Epoch: 17, Steps: 10 | Train Loss: 1.232 Vali Loss: 3.310 Vali Acc: 0.206 Test Loss: 3.310 Test Acc: 0.206
Validation loss decreased (-0.194085 --> -0.205849).  Saving model ...
Epoch: 18 cost time: 0.4093286991119385
Epoch: 18, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.335 Vali Acc: 0.205 Test Loss: 3.335 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.41800475120544434
Epoch: 19, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.355 Vali Acc: 0.211 Test Loss: 3.355 Test Acc: 0.211
Validation loss decreased (-0.205849 --> -0.210555).  Saving model ...
Epoch: 20 cost time: 0.48786091804504395
Epoch: 20, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.389 Vali Acc: 0.208 Test Loss: 3.389 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.41529083251953125
Epoch: 21, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.423 Vali Acc: 0.219 Test Loss: 3.423 Test Acc: 0.219
Validation loss decreased (-0.210555 --> -0.218789).  Saving model ...
Epoch: 22 cost time: 0.42711639404296875
Epoch: 22, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.454 Vali Acc: 0.221 Test Loss: 3.454 Test Acc: 0.221
Validation loss decreased (-0.218789 --> -0.221142).  Saving model ...
Epoch: 23 cost time: 0.43806028366088867
Epoch: 23, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.494 Vali Acc: 0.226 Test Loss: 3.494 Test Acc: 0.226
Validation loss decreased (-0.221142 --> -0.225847).  Saving model ...
Epoch: 24 cost time: 0.44438838958740234
Epoch: 24, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.543 Vali Acc: 0.231 Test Loss: 3.543 Test Acc: 0.231
Validation loss decreased (-0.225847 --> -0.230553).  Saving model ...
Epoch: 25 cost time: 0.4242711067199707
Epoch: 25, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.578 Vali Acc: 0.228 Test Loss: 3.578 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.453291654586792
Epoch: 26, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.618 Vali Acc: 0.236 Test Loss: 3.618 Test Acc: 0.236
Validation loss decreased (-0.230553 --> -0.236434).  Saving model ...
Epoch: 27 cost time: 0.4601168632507324
Epoch: 27, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.649 Vali Acc: 0.238 Test Loss: 3.649 Test Acc: 0.238
Validation loss decreased (-0.236434 --> -0.237611).  Saving model ...
Epoch: 28 cost time: 0.4397270679473877
Epoch: 28, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.676 Vali Acc: 0.238 Test Loss: 3.676 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.485792875289917
Epoch: 29, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.711 Vali Acc: 0.232 Test Loss: 3.711 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.42738938331604004
Epoch: 30, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.753 Vali Acc: 0.240 Test Loss: 3.753 Test Acc: 0.240
Validation loss decreased (-0.237611 --> -0.239962).  Saving model ...
Epoch: 31 cost time: 0.44102001190185547
Epoch: 31, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.789 Vali Acc: 0.246 Test Loss: 3.789 Test Acc: 0.246
Validation loss decreased (-0.239962 --> -0.245844).  Saving model ...
Epoch: 32 cost time: 0.45042967796325684
Epoch: 32, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.812 Vali Acc: 0.244 Test Loss: 3.812 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.43118834495544434
Epoch: 33, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.846 Vali Acc: 0.247 Test Loss: 3.846 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247020).  Saving model ...
Epoch: 34 cost time: 0.45670533180236816
Epoch: 34, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.862 Vali Acc: 0.248 Test Loss: 3.862 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248197).  Saving model ...
Epoch: 35 cost time: 0.4658360481262207
Epoch: 35, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.888 Vali Acc: 0.248 Test Loss: 3.888 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4447319507598877
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.907 Vali Acc: 0.241 Test Loss: 3.907 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4614849090576172
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.920 Vali Acc: 0.248 Test Loss: 3.920 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.44398045539855957
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.947 Vali Acc: 0.246 Test Loss: 3.947 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4598836898803711
Epoch: 39, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.965 Vali Acc: 0.249 Test Loss: 3.965 Test Acc: 0.249
Validation loss decreased (-0.248197 --> -0.249372).  Saving model ...
Epoch: 40 cost time: 0.43065786361694336
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.984 Vali Acc: 0.248 Test Loss: 3.984 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.47257089614868164
Epoch: 41, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.008 Vali Acc: 0.248 Test Loss: 4.008 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.44368815422058105
Epoch: 42, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.037 Vali Acc: 0.251 Test Loss: 4.037 Test Acc: 0.251
Validation loss decreased (-0.249372 --> -0.250548).  Saving model ...
Epoch: 43 cost time: 0.4579591751098633
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.061 Vali Acc: 0.246 Test Loss: 4.061 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.44823312759399414
Epoch: 44, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.083 Vali Acc: 0.247 Test Loss: 4.083 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.43277645111083984
Epoch: 45, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.098 Vali Acc: 0.255 Test Loss: 4.098 Test Acc: 0.255
Validation loss decreased (-0.250548 --> -0.255253).  Saving model ...
Epoch: 46 cost time: 0.45064306259155273
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.126 Vali Acc: 0.253 Test Loss: 4.126 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4388430118560791
Epoch: 47, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.133 Vali Acc: 0.249 Test Loss: 4.133 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4364175796508789
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.128 Vali Acc: 0.247 Test Loss: 4.128 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.43642163276672363
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.135 Vali Acc: 0.251 Test Loss: 4.135 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4487888813018799
Epoch: 50, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.162 Vali Acc: 0.251 Test Loss: 4.162 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.44227051734924316
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.181 Vali Acc: 0.252 Test Loss: 4.181 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.37200379371643066
Epoch: 52, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.180 Vali Acc: 0.253 Test Loss: 4.180 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.46561455726623535
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.190 Vali Acc: 0.260 Test Loss: 4.190 Test Acc: 0.260
Validation loss decreased (-0.255253 --> -0.259958).  Saving model ...
Epoch: 54 cost time: 0.44908785820007324
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.210 Vali Acc: 0.258 Test Loss: 4.210 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.4379384517669678
Epoch: 55, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.228 Vali Acc: 0.253 Test Loss: 4.228 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.46120429039001465
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.246 Vali Acc: 0.253 Test Loss: 4.246 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.41457343101501465
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.255 Vali Acc: 0.249 Test Loss: 4.255 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.4454944133758545
Epoch: 58, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.264 Vali Acc: 0.247 Test Loss: 4.264 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.46062326431274414
Epoch: 59, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.280 Vali Acc: 0.249 Test Loss: 4.280 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.4586758613586426
Epoch: 60, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.300 Vali Acc: 0.254 Test Loss: 4.300 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.44910335540771484
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.321 Vali Acc: 0.253 Test Loss: 4.321 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.4570271968841553
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.326 Vali Acc: 0.253 Test Loss: 4.326 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.4686880111694336
Epoch: 63, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.334 Vali Acc: 0.253 Test Loss: 4.334 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 92506
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.508910894393921
Epoch: 1, Steps: 10 | Train Loss: 3.444 Vali Loss: 3.351 Vali Acc: 0.044 Test Loss: 3.351 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4622166156768799
Epoch: 2, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.350 Vali Acc: 0.087 Test Loss: 3.350 Test Acc: 0.087
Validation loss decreased (-0.043496 --> -0.087025).  Saving model ...
Epoch: 3 cost time: 0.43106794357299805
Epoch: 3, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.304 Vali Acc: 0.125 Test Loss: 3.304 Test Acc: 0.125
Validation loss decreased (-0.087025 --> -0.124673).  Saving model ...
Epoch: 4 cost time: 0.41731739044189453
Epoch: 4, Steps: 10 | Train Loss: 2.058 Vali Loss: 3.277 Vali Acc: 0.165 Test Loss: 3.277 Test Acc: 0.165
Validation loss decreased (-0.124673 --> -0.164673).  Saving model ...
Epoch: 5 cost time: 0.4739508628845215
Epoch: 5, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.300 Vali Acc: 0.179 Test Loss: 3.300 Test Acc: 0.179
Validation loss decreased (-0.164673 --> -0.178791).  Saving model ...
Epoch: 6 cost time: 0.3509950637817383
Epoch: 6, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.399 Vali Acc: 0.192 Test Loss: 3.399 Test Acc: 0.192
Validation loss decreased (-0.178791 --> -0.191731).  Saving model ...
Epoch: 7 cost time: 0.44678449630737305
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.577 Vali Acc: 0.194 Test Loss: 3.577 Test Acc: 0.194
Validation loss decreased (-0.191731 --> -0.194082).  Saving model ...
Epoch: 8 cost time: 0.4417905807495117
Epoch: 8, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.599 Vali Acc: 0.219 Test Loss: 3.599 Test Acc: 0.219
Validation loss decreased (-0.194082 --> -0.218788).  Saving model ...
Epoch: 9 cost time: 0.42400622367858887
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 3.795 Vali Acc: 0.227 Test Loss: 3.795 Test Acc: 0.227
Validation loss decreased (-0.218788 --> -0.227021).  Saving model ...
Epoch: 10 cost time: 0.41602540016174316
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.932 Vali Acc: 0.231 Test Loss: 3.932 Test Acc: 0.231
Validation loss decreased (-0.227021 --> -0.230549).  Saving model ...
Epoch: 11 cost time: 0.4561483860015869
Epoch: 11, Steps: 10 | Train Loss: 0.130 Vali Loss: 4.206 Vali Acc: 0.239 Test Loss: 4.206 Test Acc: 0.239
Validation loss decreased (-0.230549 --> -0.238781).  Saving model ...
Epoch: 12 cost time: 0.4809257984161377
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.298 Vali Acc: 0.236 Test Loss: 4.298 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.46723055839538574
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.456 Vali Acc: 0.255 Test Loss: 4.456 Test Acc: 0.255
Validation loss decreased (-0.238781 --> -0.255250).  Saving model ...
Epoch: 14 cost time: 0.47410011291503906
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.558 Vali Acc: 0.244 Test Loss: 4.558 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4988734722137451
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.580 Vali Acc: 0.251 Test Loss: 4.580 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4821007251739502
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.606 Vali Acc: 0.269 Test Loss: 4.606 Test Acc: 0.269
Validation loss decreased (-0.255250 --> -0.269366).  Saving model ...
Epoch: 17 cost time: 0.48747706413269043
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.697 Vali Acc: 0.266 Test Loss: 4.697 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5240533351898193
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.766 Vali Acc: 0.271 Test Loss: 4.766 Test Acc: 0.271
Validation loss decreased (-0.269366 --> -0.270541).  Saving model ...
Epoch: 19 cost time: 0.4894373416900635
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.790 Vali Acc: 0.268 Test Loss: 4.790 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.501706600189209
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.802 Vali Acc: 0.274 Test Loss: 4.802 Test Acc: 0.274
Validation loss decreased (-0.270541 --> -0.274070).  Saving model ...
Epoch: 21 cost time: 0.4721360206604004
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.817 Vali Acc: 0.271 Test Loss: 4.817 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49666786193847656
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.856 Vali Acc: 0.272 Test Loss: 4.856 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5300219058990479
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.881 Vali Acc: 0.274 Test Loss: 4.881 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5870273113250732
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.918 Vali Acc: 0.272 Test Loss: 4.918 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5363650321960449
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.942 Vali Acc: 0.268 Test Loss: 4.942 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5002319812774658
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.976 Vali Acc: 0.271 Test Loss: 4.976 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5248806476593018
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.005 Vali Acc: 0.266 Test Loss: 5.005 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4911510944366455
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.022 Vali Acc: 0.269 Test Loss: 5.022 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.3970603942871094
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.040 Vali Acc: 0.272 Test Loss: 5.040 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4165201187133789
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.071 Vali Acc: 0.269 Test Loss: 5.071 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 413274
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6091299057006836
Epoch: 1, Steps: 10 | Train Loss: 3.453 Vali Loss: 3.349 Vali Acc: 0.036 Test Loss: 3.349 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.43685436248779297
Epoch: 2, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.350 Vali Acc: 0.064 Test Loss: 3.350 Test Acc: 0.064
Validation loss decreased (-0.036437 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.34360170364379883
Epoch: 3, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.389 Vali Acc: 0.089 Test Loss: 3.389 Test Acc: 0.089
Validation loss decreased (-0.063496 --> -0.089378).  Saving model ...
Epoch: 4 cost time: 0.4380960464477539
Epoch: 4, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.285 Vali Acc: 0.107 Test Loss: 3.285 Test Acc: 0.107
Validation loss decreased (-0.089378 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.4408543109893799
Epoch: 5, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.220 Vali Acc: 0.141 Test Loss: 3.220 Test Acc: 0.141
Validation loss decreased (-0.107026 --> -0.141144).  Saving model ...
Epoch: 6 cost time: 0.4141085147857666
Epoch: 6, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.278 Vali Acc: 0.148 Test Loss: 3.278 Test Acc: 0.148
Validation loss decreased (-0.141144 --> -0.148203).  Saving model ...
Epoch: 7 cost time: 0.4052314758300781
Epoch: 7, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.294 Vali Acc: 0.162 Test Loss: 3.294 Test Acc: 0.162
Validation loss decreased (-0.148203 --> -0.162320).  Saving model ...
Epoch: 8 cost time: 0.46164679527282715
Epoch: 8, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.336 Vali Acc: 0.202 Test Loss: 3.336 Test Acc: 0.202
Validation loss decreased (-0.162320 --> -0.202320).  Saving model ...
Epoch: 9 cost time: 0.4118189811706543
Epoch: 9, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.419 Vali Acc: 0.206 Test Loss: 3.419 Test Acc: 0.206
Validation loss decreased (-0.202320 --> -0.205848).  Saving model ...
Epoch: 10 cost time: 0.4525332450866699
Epoch: 10, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.468 Vali Acc: 0.222 Test Loss: 3.468 Test Acc: 0.222
Validation loss decreased (-0.205848 --> -0.222318).  Saving model ...
Epoch: 11 cost time: 0.43332934379577637
Epoch: 11, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.521 Vali Acc: 0.233 Test Loss: 3.521 Test Acc: 0.233
Validation loss decreased (-0.222318 --> -0.232906).  Saving model ...
Epoch: 12 cost time: 0.4224836826324463
Epoch: 12, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.690 Vali Acc: 0.232 Test Loss: 3.690 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41533851623535156
Epoch: 13, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.743 Vali Acc: 0.247 Test Loss: 3.743 Test Acc: 0.247
Validation loss decreased (-0.232906 --> -0.247021).  Saving model ...
Epoch: 14 cost time: 0.4507319927215576
Epoch: 14, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.810 Vali Acc: 0.251 Test Loss: 3.810 Test Acc: 0.251
Validation loss decreased (-0.247021 --> -0.250550).  Saving model ...
Epoch: 15 cost time: 0.47862887382507324
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.011 Vali Acc: 0.244 Test Loss: 4.011 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3866004943847656
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.049 Vali Acc: 0.253 Test Loss: 4.049 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252901).  Saving model ...
Epoch: 17 cost time: 0.4483191967010498
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.106 Vali Acc: 0.272 Test Loss: 4.106 Test Acc: 0.272
Validation loss decreased (-0.252901 --> -0.271724).  Saving model ...
Epoch: 18 cost time: 0.42824411392211914
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.241 Vali Acc: 0.261 Test Loss: 4.241 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.411651611328125
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.319 Vali Acc: 0.251 Test Loss: 4.319 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4404139518737793
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.365 Vali Acc: 0.253 Test Loss: 4.365 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.379657506942749
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.370 Vali Acc: 0.265 Test Loss: 4.370 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.42313599586486816
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.462 Vali Acc: 0.259 Test Loss: 4.462 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4162929058074951
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.498 Vali Acc: 0.255 Test Loss: 4.498 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4255650043487549
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.536 Vali Acc: 0.264 Test Loss: 4.536 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.40242576599121094
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.546 Vali Acc: 0.265 Test Loss: 4.546 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4543724060058594
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.547 Vali Acc: 0.268 Test Loss: 4.547 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4573526382446289
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.573 Vali Acc: 0.274 Test Loss: 4.573 Test Acc: 0.274
Validation loss decreased (-0.271724 --> -0.274072).  Saving model ...
Epoch: 28 cost time: 0.4385035037994385
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.598 Vali Acc: 0.269 Test Loss: 4.598 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3947734832763672
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.618 Vali Acc: 0.271 Test Loss: 4.618 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.434431791305542
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.650 Vali Acc: 0.274 Test Loss: 4.650 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.40662312507629395
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.678 Vali Acc: 0.273 Test Loss: 4.678 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.438077449798584
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.693 Vali Acc: 0.269 Test Loss: 4.693 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.39389729499816895
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.734 Vali Acc: 0.271 Test Loss: 4.734 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4401228427886963
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.744 Vali Acc: 0.266 Test Loss: 4.744 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.43653345108032227
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.756 Vali Acc: 0.273 Test Loss: 4.756 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4520995616912842
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.789 Vali Acc: 0.272 Test Loss: 4.789 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.420795202255249
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.822 Vali Acc: 0.272 Test Loss: 4.822 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 223834
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3924479484558105
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.342 Vali Acc: 0.048 Test Loss: 3.342 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.45093584060668945
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.334 Vali Acc: 0.073 Test Loss: 3.334 Test Acc: 0.073
Validation loss decreased (-0.048202 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.433544397354126
Epoch: 3, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.343 Vali Acc: 0.084 Test Loss: 3.343 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083496).  Saving model ...
Epoch: 4 cost time: 0.425095796585083
Epoch: 4, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.322 Vali Acc: 0.098 Test Loss: 3.322 Test Acc: 0.098
Validation loss decreased (-0.083496 --> -0.097614).  Saving model ...
Epoch: 5 cost time: 0.45400404930114746
Epoch: 5, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.295 Vali Acc: 0.116 Test Loss: 3.295 Test Acc: 0.116
Validation loss decreased (-0.097614 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 0.41874098777770996
Epoch: 6, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.263 Vali Acc: 0.134 Test Loss: 3.263 Test Acc: 0.134
Validation loss decreased (-0.116438 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.44482946395874023
Epoch: 7, Steps: 10 | Train Loss: 1.934 Vali Loss: 3.254 Vali Acc: 0.149 Test Loss: 3.254 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149379).  Saving model ...
Epoch: 8 cost time: 0.34453296661376953
Epoch: 8, Steps: 10 | Train Loss: 1.636 Vali Loss: 3.282 Vali Acc: 0.165 Test Loss: 3.282 Test Acc: 0.165
Validation loss decreased (-0.149379 --> -0.164673).  Saving model ...
Epoch: 9 cost time: 0.42966628074645996
Epoch: 9, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.323 Vali Acc: 0.172 Test Loss: 3.323 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171731).  Saving model ...
Epoch: 10 cost time: 0.4064924716949463
Epoch: 10, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.349 Vali Acc: 0.188 Test Loss: 3.349 Test Acc: 0.188
Validation loss decreased (-0.171731 --> -0.188202).  Saving model ...
Epoch: 11 cost time: 0.45319557189941406
Epoch: 11, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.406 Vali Acc: 0.194 Test Loss: 3.406 Test Acc: 0.194
Validation loss decreased (-0.188202 --> -0.194084).  Saving model ...
Epoch: 12 cost time: 0.45459675788879395
Epoch: 12, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.496 Vali Acc: 0.195 Test Loss: 3.496 Test Acc: 0.195
Validation loss decreased (-0.194084 --> -0.195259).  Saving model ...
Epoch: 13 cost time: 0.41486024856567383
Epoch: 13, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.511 Vali Acc: 0.218 Test Loss: 3.511 Test Acc: 0.218
Validation loss decreased (-0.195259 --> -0.217612).  Saving model ...
Epoch: 14 cost time: 0.37087106704711914
Epoch: 14, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.577 Vali Acc: 0.232 Test Loss: 3.577 Test Acc: 0.232
Validation loss decreased (-0.217612 --> -0.231729).  Saving model ...
Epoch: 15 cost time: 0.43785953521728516
Epoch: 15, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.681 Vali Acc: 0.221 Test Loss: 3.681 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43567895889282227
Epoch: 16, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.767 Vali Acc: 0.231 Test Loss: 3.767 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.42318010330200195
Epoch: 17, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.832 Vali Acc: 0.233 Test Loss: 3.832 Test Acc: 0.233
Validation loss decreased (-0.231729 --> -0.232903).  Saving model ...
Epoch: 18 cost time: 0.4258136749267578
Epoch: 18, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.924 Vali Acc: 0.239 Test Loss: 3.924 Test Acc: 0.239
Validation loss decreased (-0.232903 --> -0.238784).  Saving model ...
Epoch: 19 cost time: 0.4391601085662842
Epoch: 19, Steps: 10 | Train Loss: 0.136 Vali Loss: 4.000 Vali Acc: 0.247 Test Loss: 4.000 Test Acc: 0.247
Validation loss decreased (-0.238784 --> -0.247019).  Saving model ...
Epoch: 20 cost time: 0.42183971405029297
Epoch: 20, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.081 Vali Acc: 0.235 Test Loss: 4.081 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44417691230773926
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.175 Vali Acc: 0.247 Test Loss: 4.175 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4540746212005615
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.222 Vali Acc: 0.249 Test Loss: 4.222 Test Acc: 0.249
Validation loss decreased (-0.247019 --> -0.249370).  Saving model ...
Epoch: 23 cost time: 0.49058032035827637
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.283 Vali Acc: 0.241 Test Loss: 4.283 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42279577255249023
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.362 Vali Acc: 0.242 Test Loss: 4.362 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4577198028564453
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.383 Vali Acc: 0.238 Test Loss: 4.383 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.42791152000427246
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.400 Vali Acc: 0.245 Test Loss: 4.400 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.44299840927124023
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.443 Vali Acc: 0.242 Test Loss: 4.443 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.46024274826049805
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.483 Vali Acc: 0.239 Test Loss: 4.483 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.43842601776123047
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.500 Vali Acc: 0.247 Test Loss: 4.500 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4197571277618408
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.512 Vali Acc: 0.244 Test Loss: 4.512 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4301743507385254
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.539 Vali Acc: 0.242 Test Loss: 4.539 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4819014072418213
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.573 Vali Acc: 0.241 Test Loss: 4.573 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 159194
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.587629795074463
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.370 Vali Acc: 0.039 Test Loss: 3.370 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.44898271560668945
Epoch: 2, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.337 Vali Acc: 0.064 Test Loss: 3.337 Test Acc: 0.064
Validation loss decreased (-0.038790 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.4010143280029297
Epoch: 3, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.339 Vali Acc: 0.069 Test Loss: 3.339 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069378).  Saving model ...
Epoch: 4 cost time: 0.36512255668640137
Epoch: 4, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.347 Vali Acc: 0.087 Test Loss: 3.347 Test Acc: 0.087
Validation loss decreased (-0.069378 --> -0.087025).  Saving model ...
Epoch: 5 cost time: 0.46187520027160645
Epoch: 5, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.337 Vali Acc: 0.099 Test Loss: 3.337 Test Acc: 0.099
Validation loss decreased (-0.087025 --> -0.098790).  Saving model ...
Epoch: 6 cost time: 0.42323756217956543
Epoch: 6, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.302 Vali Acc: 0.125 Test Loss: 3.302 Test Acc: 0.125
Validation loss decreased (-0.098790 --> -0.124673).  Saving model ...
Epoch: 7 cost time: 0.44591593742370605
Epoch: 7, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.275 Vali Acc: 0.132 Test Loss: 3.275 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 8 cost time: 0.42716526985168457
Epoch: 8, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.273 Vali Acc: 0.151 Test Loss: 3.273 Test Acc: 0.151
Validation loss decreased (-0.131732 --> -0.150556).  Saving model ...
Epoch: 9 cost time: 0.4091982841491699
Epoch: 9, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.270 Vali Acc: 0.165 Test Loss: 3.270 Test Acc: 0.165
Validation loss decreased (-0.150556 --> -0.164673).  Saving model ...
Epoch: 10 cost time: 0.377727746963501
Epoch: 10, Steps: 10 | Train Loss: 1.388 Vali Loss: 3.297 Vali Acc: 0.182 Test Loss: 3.297 Test Acc: 0.182
Validation loss decreased (-0.164673 --> -0.182320).  Saving model ...
Epoch: 11 cost time: 0.4468505382537842
Epoch: 11, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.317 Vali Acc: 0.199 Test Loss: 3.317 Test Acc: 0.199
Validation loss decreased (-0.182320 --> -0.198790).  Saving model ...
Epoch: 12 cost time: 0.41881585121154785
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.344 Vali Acc: 0.201 Test Loss: 3.344 Test Acc: 0.201
Validation loss decreased (-0.198790 --> -0.201143).  Saving model ...
Epoch: 13 cost time: 0.423656702041626
Epoch: 13, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.407 Vali Acc: 0.222 Test Loss: 3.407 Test Acc: 0.222
Validation loss decreased (-0.201143 --> -0.222319).  Saving model ...
Epoch: 14 cost time: 0.4525918960571289
Epoch: 14, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.456 Vali Acc: 0.235 Test Loss: 3.456 Test Acc: 0.235
Validation loss decreased (-0.222319 --> -0.235260).  Saving model ...
Epoch: 15 cost time: 0.4334542751312256
Epoch: 15, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.516 Vali Acc: 0.226 Test Loss: 3.516 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.46331238746643066
Epoch: 16, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.545 Vali Acc: 0.242 Test Loss: 3.545 Test Acc: 0.242
Validation loss decreased (-0.235260 --> -0.242317).  Saving model ...
Epoch: 17 cost time: 0.43799614906311035
Epoch: 17, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.573 Vali Acc: 0.248 Test Loss: 3.573 Test Acc: 0.248
Validation loss decreased (-0.242317 --> -0.248200).  Saving model ...
Epoch: 18 cost time: 0.4456193447113037
Epoch: 18, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.670 Vali Acc: 0.261 Test Loss: 3.670 Test Acc: 0.261
Validation loss decreased (-0.248200 --> -0.261140).  Saving model ...
Epoch: 19 cost time: 0.49047398567199707
Epoch: 19, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.783 Vali Acc: 0.249 Test Loss: 3.783 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4398384094238281
Epoch: 20, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.813 Vali Acc: 0.254 Test Loss: 3.813 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.44953250885009766
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.884 Vali Acc: 0.247 Test Loss: 3.884 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4238882064819336
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.942 Vali Acc: 0.262 Test Loss: 3.942 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262314).  Saving model ...
Epoch: 23 cost time: 0.46939587593078613
Epoch: 23, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.011 Vali Acc: 0.248 Test Loss: 4.011 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.45201706886291504
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.060 Vali Acc: 0.247 Test Loss: 4.060 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4204556941986084
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.098 Vali Acc: 0.252 Test Loss: 4.098 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4584658145904541
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.145 Vali Acc: 0.251 Test Loss: 4.145 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3960094451904297
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.174 Vali Acc: 0.247 Test Loss: 4.174 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4383852481842041
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.191 Vali Acc: 0.248 Test Loss: 4.191 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4057955741882324
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.215 Vali Acc: 0.255 Test Loss: 4.215 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.44598913192749023
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.273 Vali Acc: 0.254 Test Loss: 4.273 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.38905930519104004
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.290 Vali Acc: 0.253 Test Loss: 4.290 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.3585057258605957
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.316 Vali Acc: 0.254 Test Loss: 4.316 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 129498
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3235132694244385
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.355 Vali Acc: 0.036 Test Loss: 3.355 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.4311532974243164
Epoch: 2, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.334 Vali Acc: 0.041 Test Loss: 3.334 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.4559934139251709
Epoch: 3, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.316 Vali Acc: 0.060 Test Loss: 3.316 Test Acc: 0.060
Validation loss decreased (-0.041143 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.442760705947876
Epoch: 4, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.308 Vali Acc: 0.074 Test Loss: 3.308 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.4394803047180176
Epoch: 5, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.306 Vali Acc: 0.081 Test Loss: 3.306 Test Acc: 0.081
Validation loss decreased (-0.074085 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 0.42221736907958984
Epoch: 6, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.305 Vali Acc: 0.098 Test Loss: 3.305 Test Acc: 0.098
Validation loss decreased (-0.081143 --> -0.097614).  Saving model ...
Epoch: 7 cost time: 0.4408884048461914
Epoch: 7, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.291 Vali Acc: 0.107 Test Loss: 3.291 Test Acc: 0.107
Validation loss decreased (-0.097614 --> -0.107026).  Saving model ...
Epoch: 8 cost time: 0.451587438583374
Epoch: 8, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.290 Vali Acc: 0.118 Test Loss: 3.290 Test Acc: 0.118
Validation loss decreased (-0.107026 --> -0.117614).  Saving model ...
Epoch: 9 cost time: 0.43924784660339355
Epoch: 9, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.281 Vali Acc: 0.131 Test Loss: 3.281 Test Acc: 0.131
Validation loss decreased (-0.117614 --> -0.130555).  Saving model ...
Epoch: 10 cost time: 0.4544224739074707
Epoch: 10, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.274 Vali Acc: 0.138 Test Loss: 3.274 Test Acc: 0.138
Validation loss decreased (-0.130555 --> -0.137614).  Saving model ...
Epoch: 11 cost time: 0.4028966426849365
Epoch: 11, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.275 Vali Acc: 0.154 Test Loss: 3.275 Test Acc: 0.154
Validation loss decreased (-0.137614 --> -0.154085).  Saving model ...
Epoch: 12 cost time: 0.4213573932647705
Epoch: 12, Steps: 10 | Train Loss: 1.518 Vali Loss: 3.291 Vali Acc: 0.158 Test Loss: 3.291 Test Acc: 0.158
Validation loss decreased (-0.154085 --> -0.157614).  Saving model ...
Epoch: 13 cost time: 0.4229893684387207
Epoch: 13, Steps: 10 | Train Loss: 1.312 Vali Loss: 3.323 Vali Acc: 0.162 Test Loss: 3.323 Test Acc: 0.162
Validation loss decreased (-0.157614 --> -0.162320).  Saving model ...
Epoch: 14 cost time: 0.42636847496032715
Epoch: 14, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.349 Vali Acc: 0.180 Test Loss: 3.349 Test Acc: 0.180
Validation loss decreased (-0.162320 --> -0.179967).  Saving model ...
Epoch: 15 cost time: 0.44463372230529785
Epoch: 15, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.383 Vali Acc: 0.187 Test Loss: 3.383 Test Acc: 0.187
Validation loss decreased (-0.179967 --> -0.187025).  Saving model ...
Epoch: 16 cost time: 0.4507882595062256
Epoch: 16, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.422 Vali Acc: 0.188 Test Loss: 3.422 Test Acc: 0.188
Validation loss decreased (-0.187025 --> -0.188201).  Saving model ...
Epoch: 17 cost time: 0.41238951683044434
Epoch: 17, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.458 Vali Acc: 0.208 Test Loss: 3.458 Test Acc: 0.208
Validation loss decreased (-0.188201 --> -0.208201).  Saving model ...
Epoch: 18 cost time: 0.4572739601135254
Epoch: 18, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.490 Vali Acc: 0.211 Test Loss: 3.490 Test Acc: 0.211
Validation loss decreased (-0.208201 --> -0.210553).  Saving model ...
Epoch: 19 cost time: 0.4368889331817627
Epoch: 19, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.540 Vali Acc: 0.211 Test Loss: 3.540 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4398946762084961
Epoch: 20, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.602 Vali Acc: 0.219 Test Loss: 3.602 Test Acc: 0.219
Validation loss decreased (-0.210553 --> -0.218788).  Saving model ...
Epoch: 21 cost time: 0.43204236030578613
Epoch: 21, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.660 Vali Acc: 0.219 Test Loss: 3.660 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3619837760925293
Epoch: 22, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.705 Vali Acc: 0.220 Test Loss: 3.705 Test Acc: 0.220
Validation loss decreased (-0.218788 --> -0.219963).  Saving model ...
Epoch: 23 cost time: 0.4022965431213379
Epoch: 23, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.749 Vali Acc: 0.233 Test Loss: 3.749 Test Acc: 0.233
Validation loss decreased (-0.219963 --> -0.232904).  Saving model ...
Epoch: 24 cost time: 0.4097404479980469
Epoch: 24, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.829 Vali Acc: 0.233 Test Loss: 3.829 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4632868766784668
Epoch: 25, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.884 Vali Acc: 0.231 Test Loss: 3.884 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.47556447982788086
Epoch: 26, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.919 Vali Acc: 0.221 Test Loss: 3.919 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4578878879547119
Epoch: 27, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.951 Vali Acc: 0.228 Test Loss: 3.951 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.38271141052246094
Epoch: 28, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.989 Vali Acc: 0.229 Test Loss: 3.989 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4770538806915283
Epoch: 29, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.019 Vali Acc: 0.226 Test Loss: 4.019 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4448873996734619
Epoch: 30, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.051 Vali Acc: 0.231 Test Loss: 4.051 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.40557861328125
Epoch: 31, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.074 Vali Acc: 0.229 Test Loss: 4.074 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4158897399902344
Epoch: 32, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.093 Vali Acc: 0.233 Test Loss: 4.093 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.40588998794555664
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.117 Vali Acc: 0.235 Test Loss: 4.117 Test Acc: 0.235
Validation loss decreased (-0.232904 --> -0.235253).  Saving model ...
Epoch: 34 cost time: 0.4204294681549072
Epoch: 34, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.153 Vali Acc: 0.240 Test Loss: 4.153 Test Acc: 0.240
Validation loss decreased (-0.235253 --> -0.239958).  Saving model ...
Epoch: 35 cost time: 0.47582149505615234
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.177 Vali Acc: 0.241 Test Loss: 4.177 Test Acc: 0.241
Validation loss decreased (-0.239958 --> -0.241135).  Saving model ...
Epoch: 36 cost time: 0.4640069007873535
Epoch: 36, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.206 Vali Acc: 0.244 Test Loss: 4.206 Test Acc: 0.244
Validation loss decreased (-0.241135 --> -0.243487).  Saving model ...
Epoch: 37 cost time: 0.4301636219024658
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.228 Vali Acc: 0.242 Test Loss: 4.228 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4582490921020508
Epoch: 38, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.241 Vali Acc: 0.242 Test Loss: 4.241 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.470125675201416
Epoch: 39, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.267 Vali Acc: 0.240 Test Loss: 4.267 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.45986127853393555
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.300 Vali Acc: 0.245 Test Loss: 4.300 Test Acc: 0.245
Validation loss decreased (-0.243487 --> -0.244663).  Saving model ...
Epoch: 41 cost time: 0.4551534652709961
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.313 Vali Acc: 0.247 Test Loss: 4.313 Test Acc: 0.247
Validation loss decreased (-0.244663 --> -0.247016).  Saving model ...
Epoch: 42 cost time: 0.4750247001647949
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.339 Vali Acc: 0.247 Test Loss: 4.339 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.435300350189209
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.361 Vali Acc: 0.235 Test Loss: 4.361 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4453864097595215
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.374 Vali Acc: 0.235 Test Loss: 4.374 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.42087769508361816
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.381 Vali Acc: 0.238 Test Loss: 4.381 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.42815256118774414
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.395 Vali Acc: 0.245 Test Loss: 4.395 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.44507837295532227
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.437 Vali Acc: 0.240 Test Loss: 4.437 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.46517062187194824
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.436 Vali Acc: 0.242 Test Loss: 4.436 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.4121668338775635
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.456 Vali Acc: 0.241 Test Loss: 4.456 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.4499795436859131
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.450 Vali Acc: 0.238 Test Loss: 4.450 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.4436173439025879
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.464 Vali Acc: 0.239 Test Loss: 4.464 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 95002
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5839924812316895
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.366 Vali Acc: 0.040 Test Loss: 3.366 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4157443046569824
Epoch: 2, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.350 Vali Acc: 0.047 Test Loss: 3.350 Test Acc: 0.047
Validation loss decreased (-0.039966 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.46780896186828613
Epoch: 3, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.332 Vali Acc: 0.049 Test Loss: 3.332 Test Acc: 0.049
Validation loss decreased (-0.047025 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 0.41208815574645996
Epoch: 4, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.319 Vali Acc: 0.062 Test Loss: 3.319 Test Acc: 0.062
Validation loss decreased (-0.049378 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.47831249237060547
Epoch: 5, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.310 Vali Acc: 0.080 Test Loss: 3.310 Test Acc: 0.080
Validation loss decreased (-0.062320 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.4271414279937744
Epoch: 6, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.304 Vali Acc: 0.100 Test Loss: 3.304 Test Acc: 0.100
Validation loss decreased (-0.079967 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 0.46856164932250977
Epoch: 7, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.296 Vali Acc: 0.113 Test Loss: 3.296 Test Acc: 0.113
Validation loss decreased (-0.099967 --> -0.112908).  Saving model ...
Epoch: 8 cost time: 0.43651247024536133
Epoch: 8, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.287 Vali Acc: 0.122 Test Loss: 3.287 Test Acc: 0.122
Validation loss decreased (-0.112908 --> -0.122320).  Saving model ...
Epoch: 9 cost time: 0.4349842071533203
Epoch: 9, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.286 Vali Acc: 0.124 Test Loss: 3.286 Test Acc: 0.124
Validation loss decreased (-0.122320 --> -0.123497).  Saving model ...
Epoch: 10 cost time: 0.41603565216064453
Epoch: 10, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.286 Vali Acc: 0.138 Test Loss: 3.286 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137614).  Saving model ...
Epoch: 11 cost time: 0.438518762588501
Epoch: 11, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.285 Vali Acc: 0.151 Test Loss: 3.285 Test Acc: 0.151
Validation loss decreased (-0.137614 --> -0.150555).  Saving model ...
Epoch: 12 cost time: 0.4304361343383789
Epoch: 12, Steps: 10 | Train Loss: 1.740 Vali Loss: 3.277 Vali Acc: 0.162 Test Loss: 3.277 Test Acc: 0.162
Validation loss decreased (-0.150555 --> -0.162320).  Saving model ...
Epoch: 13 cost time: 0.4406623840332031
Epoch: 13, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.279 Vali Acc: 0.171 Test Loss: 3.279 Test Acc: 0.171
Validation loss decreased (-0.162320 --> -0.170555).  Saving model ...
Epoch: 14 cost time: 0.4346768856048584
Epoch: 14, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.302 Vali Acc: 0.175 Test Loss: 3.302 Test Acc: 0.175
Validation loss decreased (-0.170555 --> -0.175261).  Saving model ...
Epoch: 15 cost time: 0.41626524925231934
Epoch: 15, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.319 Vali Acc: 0.175 Test Loss: 3.319 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.44388365745544434
Epoch: 16, Steps: 10 | Train Loss: 1.186 Vali Loss: 3.349 Vali Acc: 0.191 Test Loss: 3.349 Test Acc: 0.191
Validation loss decreased (-0.175261 --> -0.190555).  Saving model ...
Epoch: 17 cost time: 0.4389305114746094
Epoch: 17, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.383 Vali Acc: 0.192 Test Loss: 3.383 Test Acc: 0.192
Validation loss decreased (-0.190555 --> -0.191731).  Saving model ...
Epoch: 18 cost time: 0.40424203872680664
Epoch: 18, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.414 Vali Acc: 0.198 Test Loss: 3.414 Test Acc: 0.198
Validation loss decreased (-0.191731 --> -0.197613).  Saving model ...
Epoch: 19 cost time: 0.4379549026489258
Epoch: 19, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.451 Vali Acc: 0.206 Test Loss: 3.451 Test Acc: 0.206
Validation loss decreased (-0.197613 --> -0.205848).  Saving model ...
Epoch: 20 cost time: 0.412539005279541
Epoch: 20, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.488 Vali Acc: 0.208 Test Loss: 3.488 Test Acc: 0.208
Validation loss decreased (-0.205848 --> -0.208200).  Saving model ...
Epoch: 21 cost time: 0.4225752353668213
Epoch: 21, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.532 Vali Acc: 0.206 Test Loss: 3.532 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4094207286834717
Epoch: 22, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.596 Vali Acc: 0.206 Test Loss: 3.596 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4292480945587158
Epoch: 23, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.649 Vali Acc: 0.209 Test Loss: 3.649 Test Acc: 0.209
Validation loss decreased (-0.208200 --> -0.209375).  Saving model ...
Epoch: 24 cost time: 0.45858287811279297
Epoch: 24, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.691 Vali Acc: 0.224 Test Loss: 3.691 Test Acc: 0.224
Validation loss decreased (-0.209375 --> -0.223493).  Saving model ...
Epoch: 25 cost time: 0.4188094139099121
Epoch: 25, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.742 Vali Acc: 0.219 Test Loss: 3.742 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.44693660736083984
Epoch: 26, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.757 Vali Acc: 0.225 Test Loss: 3.757 Test Acc: 0.225
Validation loss decreased (-0.223493 --> -0.224668).  Saving model ...
Epoch: 27 cost time: 0.4155142307281494
Epoch: 27, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.786 Vali Acc: 0.235 Test Loss: 3.786 Test Acc: 0.235
Validation loss decreased (-0.224668 --> -0.235256).  Saving model ...
Epoch: 28 cost time: 0.43665003776550293
Epoch: 28, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.831 Vali Acc: 0.235 Test Loss: 3.831 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.42217040061950684
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.884 Vali Acc: 0.235 Test Loss: 3.884 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.40557003021240234
Epoch: 30, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.933 Vali Acc: 0.232 Test Loss: 3.933 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4180898666381836
Epoch: 31, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.950 Vali Acc: 0.231 Test Loss: 3.950 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4241797924041748
Epoch: 32, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.989 Vali Acc: 0.232 Test Loss: 3.989 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4406447410583496
Epoch: 33, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.045 Vali Acc: 0.231 Test Loss: 4.045 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4571869373321533
Epoch: 34, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.068 Vali Acc: 0.233 Test Loss: 4.068 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4399704933166504
Epoch: 35, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.063 Vali Acc: 0.245 Test Loss: 4.063 Test Acc: 0.245
Validation loss decreased (-0.235256 --> -0.244665).  Saving model ...
Epoch: 36 cost time: 0.4516873359680176
Epoch: 36, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.085 Vali Acc: 0.246 Test Loss: 4.085 Test Acc: 0.246
Validation loss decreased (-0.244665 --> -0.245842).  Saving model ...
Epoch: 37 cost time: 0.4297783374786377
Epoch: 37, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.110 Vali Acc: 0.251 Test Loss: 4.110 Test Acc: 0.251
Validation loss decreased (-0.245842 --> -0.250547).  Saving model ...
Epoch: 38 cost time: 0.4423048496246338
Epoch: 38, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.133 Vali Acc: 0.240 Test Loss: 4.133 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4297149181365967
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.182 Vali Acc: 0.240 Test Loss: 4.182 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.3952908515930176
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.189 Vali Acc: 0.239 Test Loss: 4.189 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.43672847747802734
Epoch: 41, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.183 Vali Acc: 0.244 Test Loss: 4.183 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4409968852996826
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.222 Vali Acc: 0.239 Test Loss: 4.222 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5108053684234619
Epoch: 43, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.248 Vali Acc: 0.239 Test Loss: 4.248 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4633002281188965
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.249 Vali Acc: 0.252 Test Loss: 4.249 Test Acc: 0.252
Validation loss decreased (-0.250547 --> -0.251722).  Saving model ...
Epoch: 45 cost time: 0.5168125629425049
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.255 Vali Acc: 0.247 Test Loss: 4.255 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.42823243141174316
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.269 Vali Acc: 0.249 Test Loss: 4.269 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4261476993560791
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.300 Vali Acc: 0.244 Test Loss: 4.300 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.40779757499694824
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.324 Vali Acc: 0.244 Test Loss: 4.324 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.42760419845581055
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.341 Vali Acc: 0.252 Test Loss: 4.341 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4185311794281006
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.361 Vali Acc: 0.242 Test Loss: 4.361 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.44008541107177734
Epoch: 51, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.363 Vali Acc: 0.253 Test Loss: 4.363 Test Acc: 0.253
Validation loss decreased (-0.251722 --> -0.252898).  Saving model ...
Epoch: 52 cost time: 0.4310424327850342
Epoch: 52, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.374 Vali Acc: 0.252 Test Loss: 4.374 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4356348514556885
Epoch: 53, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.382 Vali Acc: 0.251 Test Loss: 4.382 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.42928242683410645
Epoch: 54, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.386 Vali Acc: 0.248 Test Loss: 4.386 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.44489073753356934
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.404 Vali Acc: 0.245 Test Loss: 4.404 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.42427515983581543
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.428 Vali Acc: 0.245 Test Loss: 4.428 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.43372035026550293
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.445 Vali Acc: 0.245 Test Loss: 4.445 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.4621877670288086
Epoch: 58, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.448 Vali Acc: 0.251 Test Loss: 4.448 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.4323310852050781
Epoch: 59, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.454 Vali Acc: 0.248 Test Loss: 4.454 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.44962072372436523
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.473 Vali Acc: 0.251 Test Loss: 4.473 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.4764554500579834
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.486 Vali Acc: 0.253 Test Loss: 4.486 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 80538
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4263207912445068
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.373 Vali Acc: 0.042 Test Loss: 3.373 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.4269583225250244
Epoch: 2, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.358 Vali Acc: 0.054 Test Loss: 3.358 Test Acc: 0.054
Validation loss decreased (-0.042319 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.41793274879455566
Epoch: 3, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.340 Vali Acc: 0.062 Test Loss: 3.340 Test Acc: 0.062
Validation loss decreased (-0.054084 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.4388725757598877
Epoch: 4, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.321 Vali Acc: 0.073 Test Loss: 3.321 Test Acc: 0.073
Validation loss decreased (-0.062320 --> -0.072908).  Saving model ...
Epoch: 5 cost time: 0.42843127250671387
Epoch: 5, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.308 Vali Acc: 0.085 Test Loss: 3.308 Test Acc: 0.085
Validation loss decreased (-0.072908 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.47077512741088867
Epoch: 6, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.297 Vali Acc: 0.093 Test Loss: 3.297 Test Acc: 0.093
Validation loss decreased (-0.084673 --> -0.092908).  Saving model ...
Epoch: 7 cost time: 0.4203801155090332
Epoch: 7, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.289 Vali Acc: 0.100 Test Loss: 3.289 Test Acc: 0.100
Validation loss decreased (-0.092908 --> -0.099967).  Saving model ...
Epoch: 8 cost time: 0.3928709030151367
Epoch: 8, Steps: 10 | Train Loss: 2.435 Vali Loss: 3.283 Vali Acc: 0.108 Test Loss: 3.283 Test Acc: 0.108
Validation loss decreased (-0.099967 --> -0.108202).  Saving model ...
Epoch: 9 cost time: 0.4645986557006836
Epoch: 9, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.274 Vali Acc: 0.115 Test Loss: 3.274 Test Acc: 0.115
Validation loss decreased (-0.108202 --> -0.115261).  Saving model ...
Epoch: 10 cost time: 0.4483153820037842
Epoch: 10, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.264 Vali Acc: 0.127 Test Loss: 3.264 Test Acc: 0.127
Validation loss decreased (-0.115261 --> -0.127026).  Saving model ...
Epoch: 11 cost time: 0.40288209915161133
Epoch: 11, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.262 Vali Acc: 0.138 Test Loss: 3.262 Test Acc: 0.138
Validation loss decreased (-0.127026 --> -0.137614).  Saving model ...
Epoch: 12 cost time: 0.3916633129119873
Epoch: 12, Steps: 10 | Train Loss: 1.896 Vali Loss: 3.258 Vali Acc: 0.147 Test Loss: 3.258 Test Acc: 0.147
Validation loss decreased (-0.137614 --> -0.147026).  Saving model ...
Epoch: 13 cost time: 0.4119246006011963
Epoch: 13, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.261 Vali Acc: 0.154 Test Loss: 3.261 Test Acc: 0.154
Validation loss decreased (-0.147026 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.39723849296569824
Epoch: 14, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.270 Vali Acc: 0.162 Test Loss: 3.270 Test Acc: 0.162
Validation loss decreased (-0.154085 --> -0.162320).  Saving model ...
Epoch: 15 cost time: 0.4018247127532959
Epoch: 15, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.294 Vali Acc: 0.171 Test Loss: 3.294 Test Acc: 0.171
Validation loss decreased (-0.162320 --> -0.170555).  Saving model ...
Epoch: 16 cost time: 0.3937077522277832
Epoch: 16, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.312 Vali Acc: 0.185 Test Loss: 3.312 Test Acc: 0.185
Validation loss decreased (-0.170555 --> -0.184673).  Saving model ...
Epoch: 17 cost time: 0.43871617317199707
Epoch: 17, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.323 Vali Acc: 0.188 Test Loss: 3.323 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188202).  Saving model ...
Epoch: 18 cost time: 0.3586733341217041
Epoch: 18, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.321 Vali Acc: 0.193 Test Loss: 3.321 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 19 cost time: 0.4520871639251709
Epoch: 19, Steps: 10 | Train Loss: 1.029 Vali Loss: 3.348 Vali Acc: 0.199 Test Loss: 3.348 Test Acc: 0.199
Validation loss decreased (-0.192908 --> -0.198790).  Saving model ...
Epoch: 20 cost time: 0.41675782203674316
Epoch: 20, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.373 Vali Acc: 0.206 Test Loss: 3.373 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205849).  Saving model ...
Epoch: 21 cost time: 0.4276862144470215
Epoch: 21, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.408 Vali Acc: 0.213 Test Loss: 3.408 Test Acc: 0.213
Validation loss decreased (-0.205849 --> -0.212907).  Saving model ...
Epoch: 22 cost time: 0.40802526473999023
Epoch: 22, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.437 Vali Acc: 0.220 Test Loss: 3.437 Test Acc: 0.220
Validation loss decreased (-0.212907 --> -0.219966).  Saving model ...
Epoch: 23 cost time: 0.3969848155975342
Epoch: 23, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.467 Vali Acc: 0.225 Test Loss: 3.467 Test Acc: 0.225
Validation loss decreased (-0.219966 --> -0.224671).  Saving model ...
Epoch: 24 cost time: 0.43805742263793945
Epoch: 24, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.509 Vali Acc: 0.227 Test Loss: 3.509 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227024).  Saving model ...
Epoch: 25 cost time: 0.41655468940734863
Epoch: 25, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.531 Vali Acc: 0.232 Test Loss: 3.531 Test Acc: 0.232
Validation loss decreased (-0.227024 --> -0.231729).  Saving model ...
Epoch: 26 cost time: 0.4533090591430664
Epoch: 26, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.575 Vali Acc: 0.240 Test Loss: 3.575 Test Acc: 0.240
Validation loss decreased (-0.231729 --> -0.239964).  Saving model ...
Epoch: 27 cost time: 0.4451334476470947
Epoch: 27, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.630 Vali Acc: 0.234 Test Loss: 3.630 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.42278146743774414
Epoch: 28, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.641 Vali Acc: 0.233 Test Loss: 3.641 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.46349239349365234
Epoch: 29, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.660 Vali Acc: 0.247 Test Loss: 3.660 Test Acc: 0.247
Validation loss decreased (-0.239964 --> -0.247022).  Saving model ...
Epoch: 30 cost time: 0.4164702892303467
Epoch: 30, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.689 Vali Acc: 0.246 Test Loss: 3.689 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4444308280944824
Epoch: 31, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.733 Vali Acc: 0.247 Test Loss: 3.733 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4074673652648926
Epoch: 32, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.756 Vali Acc: 0.251 Test Loss: 3.756 Test Acc: 0.251
Validation loss decreased (-0.247022 --> -0.250551).  Saving model ...
Epoch: 33 cost time: 0.4553196430206299
Epoch: 33, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.798 Vali Acc: 0.247 Test Loss: 3.798 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4185519218444824
Epoch: 34, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.843 Vali Acc: 0.254 Test Loss: 3.843 Test Acc: 0.254
Validation loss decreased (-0.250551 --> -0.254079).  Saving model ...
Epoch: 35 cost time: 0.4186685085296631
Epoch: 35, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.868 Vali Acc: 0.253 Test Loss: 3.868 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4073927402496338
Epoch: 36, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.872 Vali Acc: 0.259 Test Loss: 3.872 Test Acc: 0.259
Validation loss decreased (-0.254079 --> -0.258785).  Saving model ...
Epoch: 37 cost time: 0.3938150405883789
Epoch: 37, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.880 Vali Acc: 0.258 Test Loss: 3.880 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.37842392921447754
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.901 Vali Acc: 0.255 Test Loss: 3.901 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.3995187282562256
Epoch: 39, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.933 Vali Acc: 0.251 Test Loss: 3.933 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4125349521636963
Epoch: 40, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.973 Vali Acc: 0.253 Test Loss: 3.973 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.42400050163269043
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.989 Vali Acc: 0.252 Test Loss: 3.989 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.3986368179321289
Epoch: 42, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.993 Vali Acc: 0.248 Test Loss: 3.993 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.42266416549682617
Epoch: 43, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.007 Vali Acc: 0.251 Test Loss: 4.007 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.3954911231994629
Epoch: 44, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.035 Vali Acc: 0.251 Test Loss: 4.035 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4184246063232422
Epoch: 45, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.046 Vali Acc: 0.254 Test Loss: 4.046 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.42992496490478516
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.065 Vali Acc: 0.255 Test Loss: 4.065 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 75994
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3312735557556152
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.312 Vali Acc: 0.058 Test Loss: 3.312 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.37115931510925293
Epoch: 2, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.401 Vali Acc: 0.098 Test Loss: 3.401 Test Acc: 0.098
Validation loss decreased (-0.057614 --> -0.097613).  Saving model ...
Epoch: 3 cost time: 0.40900588035583496
Epoch: 3, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.279 Vali Acc: 0.127 Test Loss: 3.279 Test Acc: 0.127
Validation loss decreased (-0.097613 --> -0.127026).  Saving model ...
Epoch: 4 cost time: 0.4062793254852295
Epoch: 4, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.231 Vali Acc: 0.149 Test Loss: 3.231 Test Acc: 0.149
Validation loss decreased (-0.127026 --> -0.149379).  Saving model ...
Epoch: 5 cost time: 0.3757350444793701
Epoch: 5, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.313 Vali Acc: 0.180 Test Loss: 3.313 Test Acc: 0.180
Validation loss decreased (-0.149379 --> -0.179967).  Saving model ...
Epoch: 6 cost time: 0.3890974521636963
Epoch: 6, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.403 Vali Acc: 0.212 Test Loss: 3.403 Test Acc: 0.212
Validation loss decreased (-0.179967 --> -0.211731).  Saving model ...
Epoch: 7 cost time: 0.4251985549926758
Epoch: 7, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.519 Vali Acc: 0.225 Test Loss: 3.519 Test Acc: 0.225
Validation loss decreased (-0.211731 --> -0.224671).  Saving model ...
Epoch: 8 cost time: 0.41490697860717773
Epoch: 8, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.577 Vali Acc: 0.227 Test Loss: 3.577 Test Acc: 0.227
Validation loss decreased (-0.224671 --> -0.227023).  Saving model ...
Epoch: 9 cost time: 0.38463735580444336
Epoch: 9, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.871 Vali Acc: 0.221 Test Loss: 3.871 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4034719467163086
Epoch: 10, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.890 Vali Acc: 0.242 Test Loss: 3.890 Test Acc: 0.242
Validation loss decreased (-0.227023 --> -0.242314).  Saving model ...
Epoch: 11 cost time: 0.4042079448699951
Epoch: 11, Steps: 10 | Train Loss: 0.158 Vali Loss: 4.323 Vali Acc: 0.236 Test Loss: 4.323 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.432847261428833
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.276 Vali Acc: 0.234 Test Loss: 4.276 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3861827850341797
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.535 Vali Acc: 0.247 Test Loss: 4.535 Test Acc: 0.247
Validation loss decreased (-0.242314 --> -0.247013).  Saving model ...
Epoch: 14 cost time: 0.5193252563476562
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.543 Vali Acc: 0.256 Test Loss: 4.543 Test Acc: 0.256
Validation loss decreased (-0.247013 --> -0.256425).  Saving model ...
Epoch: 15 cost time: 0.4643254280090332
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.577 Vali Acc: 0.256 Test Loss: 4.577 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5523974895477295
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.737 Vali Acc: 0.247 Test Loss: 4.737 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5079281330108643
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.694 Vali Acc: 0.261 Test Loss: 4.694 Test Acc: 0.261
Validation loss decreased (-0.256425 --> -0.261130).  Saving model ...
Epoch: 18 cost time: 0.4609105587005615
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.716 Vali Acc: 0.258 Test Loss: 4.716 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5142345428466797
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.780 Vali Acc: 0.258 Test Loss: 4.780 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4835999011993408
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.816 Vali Acc: 0.266 Test Loss: 4.816 Test Acc: 0.266
Validation loss decreased (-0.261130 --> -0.265834).  Saving model ...
Epoch: 21 cost time: 0.5010159015655518
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.809 Vali Acc: 0.267 Test Loss: 4.809 Test Acc: 0.267
Validation loss decreased (-0.265834 --> -0.267011).  Saving model ...
Epoch: 22 cost time: 0.5157544612884521
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.844 Vali Acc: 0.266 Test Loss: 4.844 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5075595378875732
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.878 Vali Acc: 0.261 Test Loss: 4.878 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5181543827056885
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.895 Vali Acc: 0.267 Test Loss: 4.895 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.478501558303833
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.917 Vali Acc: 0.267 Test Loss: 4.917 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5099718570709229
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.940 Vali Acc: 0.264 Test Loss: 4.940 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.47448301315307617
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.964 Vali Acc: 0.264 Test Loss: 4.964 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5637860298156738
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.990 Vali Acc: 0.262 Test Loss: 4.990 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5521624088287354
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.264 Test Loss: 5.012 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4069979190826416
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.023 Vali Acc: 0.265 Test Loss: 5.023 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.42438364028930664
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.032 Vali Acc: 0.267 Test Loss: 5.032 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 405018
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.519230604171753
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.368 Vali Acc: 0.049 Test Loss: 3.368 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.41259074211120605
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.377 Vali Acc: 0.072 Test Loss: 3.377 Test Acc: 0.072
Validation loss decreased (-0.049378 --> -0.071731).  Saving model ...
Epoch: 3 cost time: 0.41522693634033203
Epoch: 3, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.403 Vali Acc: 0.080 Test Loss: 3.403 Test Acc: 0.080
Validation loss decreased (-0.071731 --> -0.079966).  Saving model ...
Epoch: 4 cost time: 0.42389941215515137
Epoch: 4, Steps: 10 | Train Loss: 2.488 Vali Loss: 3.299 Vali Acc: 0.113 Test Loss: 3.299 Test Acc: 0.113
Validation loss decreased (-0.079966 --> -0.112908).  Saving model ...
Epoch: 5 cost time: 0.4162411689758301
Epoch: 5, Steps: 10 | Train Loss: 2.095 Vali Loss: 3.242 Vali Acc: 0.138 Test Loss: 3.242 Test Acc: 0.138
Validation loss decreased (-0.112908 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 0.47507691383361816
Epoch: 6, Steps: 10 | Train Loss: 1.818 Vali Loss: 3.279 Vali Acc: 0.153 Test Loss: 3.279 Test Acc: 0.153
Validation loss decreased (-0.137615 --> -0.152908).  Saving model ...
Epoch: 7 cost time: 0.4590122699737549
Epoch: 7, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.283 Vali Acc: 0.189 Test Loss: 3.283 Test Acc: 0.189
Validation loss decreased (-0.152908 --> -0.189379).  Saving model ...
Epoch: 8 cost time: 0.4435079097747803
Epoch: 8, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.353 Vali Acc: 0.196 Test Loss: 3.353 Test Acc: 0.196
Validation loss decreased (-0.189379 --> -0.196437).  Saving model ...
Epoch: 9 cost time: 0.45186901092529297
Epoch: 9, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.429 Vali Acc: 0.196 Test Loss: 3.429 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.42728376388549805
Epoch: 10, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.464 Vali Acc: 0.226 Test Loss: 3.464 Test Acc: 0.226
Validation loss decreased (-0.196437 --> -0.225848).  Saving model ...
Epoch: 11 cost time: 0.41788554191589355
Epoch: 11, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.579 Vali Acc: 0.222 Test Loss: 3.579 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4467644691467285
Epoch: 12, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.620 Vali Acc: 0.239 Test Loss: 3.620 Test Acc: 0.239
Validation loss decreased (-0.225848 --> -0.238787).  Saving model ...
Epoch: 13 cost time: 0.40529847145080566
Epoch: 13, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.714 Vali Acc: 0.249 Test Loss: 3.714 Test Acc: 0.249
Validation loss decreased (-0.238787 --> -0.249375).  Saving model ...
Epoch: 14 cost time: 0.44213342666625977
Epoch: 14, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.830 Vali Acc: 0.258 Test Loss: 3.830 Test Acc: 0.258
Validation loss decreased (-0.249375 --> -0.257609).  Saving model ...
Epoch: 15 cost time: 0.4036588668823242
Epoch: 15, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.946 Vali Acc: 0.248 Test Loss: 3.946 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.43553829193115234
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.051 Vali Acc: 0.254 Test Loss: 4.051 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4379448890686035
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.074 Vali Acc: 0.255 Test Loss: 4.074 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4483625888824463
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.239 Vali Acc: 0.248 Test Loss: 4.239 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4310789108276367
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.284 Vali Acc: 0.251 Test Loss: 4.284 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.399768590927124
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.309 Vali Acc: 0.255 Test Loss: 4.309 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4182875156402588
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.343 Vali Acc: 0.265 Test Loss: 4.343 Test Acc: 0.265
Validation loss decreased (-0.257609 --> -0.264662).  Saving model ...
Epoch: 22 cost time: 0.43169474601745605
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.407 Vali Acc: 0.259 Test Loss: 4.407 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.44538450241088867
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.464 Vali Acc: 0.258 Test Loss: 4.464 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4005889892578125
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.479 Vali Acc: 0.261 Test Loss: 4.479 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.42824769020080566
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.497 Vali Acc: 0.261 Test Loss: 4.497 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.3790311813354492
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.555 Vali Acc: 0.258 Test Loss: 4.555 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.420682430267334
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.593 Vali Acc: 0.255 Test Loss: 4.593 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.44536280632019043
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.584 Vali Acc: 0.260 Test Loss: 4.584 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.45143723487854004
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.578 Vali Acc: 0.261 Test Loss: 4.578 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4230155944824219
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.615 Vali Acc: 0.261 Test Loss: 4.615 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.456345796585083
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.649 Vali Acc: 0.260 Test Loss: 4.649 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 215578
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3534226417541504
Epoch: 1, Steps: 10 | Train Loss: 3.585 Vali Loss: 3.371 Vali Acc: 0.028 Test Loss: 3.371 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.4568905830383301
Epoch: 2, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.335 Vali Acc: 0.027 Test Loss: 3.335 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45818638801574707
Epoch: 3, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.351 Vali Acc: 0.051 Test Loss: 3.351 Test Acc: 0.051
Validation loss decreased (-0.028202 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.40599822998046875
Epoch: 4, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.334 Vali Acc: 0.076 Test Loss: 3.334 Test Acc: 0.076
Validation loss decreased (-0.050555 --> -0.076437).  Saving model ...
Epoch: 5 cost time: 0.4675581455230713
Epoch: 5, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.305 Vali Acc: 0.098 Test Loss: 3.305 Test Acc: 0.098
Validation loss decreased (-0.076437 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.4100499153137207
Epoch: 6, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.268 Vali Acc: 0.145 Test Loss: 3.268 Test Acc: 0.145
Validation loss decreased (-0.097614 --> -0.144673).  Saving model ...
Epoch: 7 cost time: 0.41638731956481934
Epoch: 7, Steps: 10 | Train Loss: 1.833 Vali Loss: 3.255 Vali Acc: 0.138 Test Loss: 3.255 Test Acc: 0.138
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4672548770904541
Epoch: 8, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.258 Vali Acc: 0.166 Test Loss: 3.258 Test Acc: 0.166
Validation loss decreased (-0.144673 --> -0.165850).  Saving model ...
Epoch: 9 cost time: 0.43697261810302734
Epoch: 9, Steps: 10 | Train Loss: 1.422 Vali Loss: 3.291 Vali Acc: 0.181 Test Loss: 3.291 Test Acc: 0.181
Validation loss decreased (-0.165850 --> -0.181144).  Saving model ...
Epoch: 10 cost time: 0.43971800804138184
Epoch: 10, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.343 Vali Acc: 0.200 Test Loss: 3.343 Test Acc: 0.200
Validation loss decreased (-0.181144 --> -0.199967).  Saving model ...
Epoch: 11 cost time: 0.43024682998657227
Epoch: 11, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.403 Vali Acc: 0.201 Test Loss: 3.403 Test Acc: 0.201
Validation loss decreased (-0.199967 --> -0.201142).  Saving model ...
Epoch: 12 cost time: 0.44948554039001465
Epoch: 12, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.437 Vali Acc: 0.212 Test Loss: 3.437 Test Acc: 0.212
Validation loss decreased (-0.201142 --> -0.211730).  Saving model ...
Epoch: 13 cost time: 0.4370603561401367
Epoch: 13, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.517 Vali Acc: 0.228 Test Loss: 3.517 Test Acc: 0.228
Validation loss decreased (-0.211730 --> -0.228200).  Saving model ...
Epoch: 14 cost time: 0.438295841217041
Epoch: 14, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.593 Vali Acc: 0.232 Test Loss: 3.593 Test Acc: 0.232
Validation loss decreased (-0.228200 --> -0.231729).  Saving model ...
Epoch: 15 cost time: 0.4497556686401367
Epoch: 15, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.636 Vali Acc: 0.236 Test Loss: 3.636 Test Acc: 0.236
Validation loss decreased (-0.231729 --> -0.236434).  Saving model ...
Epoch: 16 cost time: 0.45583152770996094
Epoch: 16, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.761 Vali Acc: 0.234 Test Loss: 3.761 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4148695468902588
Epoch: 17, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.827 Vali Acc: 0.232 Test Loss: 3.827 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4362959861755371
Epoch: 18, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.917 Vali Acc: 0.233 Test Loss: 3.917 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3922688961029053
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.980 Vali Acc: 0.247 Test Loss: 3.980 Test Acc: 0.247
Validation loss decreased (-0.236434 --> -0.247019).  Saving model ...
Epoch: 20 cost time: 0.43944716453552246
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.050 Vali Acc: 0.241 Test Loss: 4.050 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.40618062019348145
Epoch: 21, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.137 Vali Acc: 0.240 Test Loss: 4.137 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.39256763458251953
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.260 Vali Acc: 0.240 Test Loss: 4.260 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4406309127807617
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.246 Vali Acc: 0.254 Test Loss: 4.246 Test Acc: 0.254
Validation loss decreased (-0.247019 --> -0.254075).  Saving model ...
Epoch: 24 cost time: 0.33745622634887695
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.231 Vali Acc: 0.248 Test Loss: 4.231 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.443958044052124
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.270 Vali Acc: 0.254 Test Loss: 4.270 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4206390380859375
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.334 Vali Acc: 0.254 Test Loss: 4.334 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.4259335994720459
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.360 Vali Acc: 0.255 Test Loss: 4.360 Test Acc: 0.255
Validation loss decreased (-0.254075 --> -0.255251).  Saving model ...
Epoch: 28 cost time: 0.41446781158447266
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.394 Vali Acc: 0.258 Test Loss: 4.394 Test Acc: 0.258
Validation loss decreased (-0.255251 --> -0.257603).  Saving model ...
Epoch: 29 cost time: 0.4333004951477051
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.425 Vali Acc: 0.260 Test Loss: 4.425 Test Acc: 0.260
Validation loss decreased (-0.257603 --> -0.259956).  Saving model ...
Epoch: 30 cost time: 0.3946824073791504
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.463 Vali Acc: 0.261 Test Loss: 4.463 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 31 cost time: 0.4608170986175537
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.472 Vali Acc: 0.256 Test Loss: 4.472 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4388272762298584
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.505 Vali Acc: 0.258 Test Loss: 4.505 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4364030361175537
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.511 Vali Acc: 0.259 Test Loss: 4.511 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4110991954803467
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.536 Vali Acc: 0.260 Test Loss: 4.536 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4389955997467041
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.566 Vali Acc: 0.256 Test Loss: 4.566 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4500598907470703
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.590 Vali Acc: 0.256 Test Loss: 4.590 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4097476005554199
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.605 Vali Acc: 0.255 Test Loss: 4.605 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4308321475982666
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.622 Vali Acc: 0.255 Test Loss: 4.622 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4204576015472412
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.630 Vali Acc: 0.253 Test Loss: 4.630 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.46937012672424316
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.639 Vali Acc: 0.255 Test Loss: 4.639 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 150938
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5957036018371582
Epoch: 1, Steps: 10 | Train Loss: 3.508 Vali Loss: 3.382 Vali Acc: 0.041 Test Loss: 3.382 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.3712892532348633
Epoch: 2, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.332 Vali Acc: 0.044 Test Loss: 3.332 Test Acc: 0.044
Validation loss decreased (-0.041143 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.40076708793640137
Epoch: 3, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.320 Vali Acc: 0.074 Test Loss: 3.320 Test Acc: 0.074
Validation loss decreased (-0.043496 --> -0.074084).  Saving model ...
Epoch: 4 cost time: 0.4015176296234131
Epoch: 4, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.330 Vali Acc: 0.094 Test Loss: 3.330 Test Acc: 0.094
Validation loss decreased (-0.074084 --> -0.094084).  Saving model ...
Epoch: 5 cost time: 0.4120008945465088
Epoch: 5, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.315 Vali Acc: 0.113 Test Loss: 3.315 Test Acc: 0.113
Validation loss decreased (-0.094084 --> -0.112908).  Saving model ...
Epoch: 6 cost time: 0.3813040256500244
Epoch: 6, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.287 Vali Acc: 0.134 Test Loss: 3.287 Test Acc: 0.134
Validation loss decreased (-0.112908 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.4307875633239746
Epoch: 7, Steps: 10 | Train Loss: 2.101 Vali Loss: 3.264 Vali Acc: 0.149 Test Loss: 3.264 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149379).  Saving model ...
Epoch: 8 cost time: 0.4405336380004883
Epoch: 8, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.256 Vali Acc: 0.151 Test Loss: 3.256 Test Acc: 0.151
Validation loss decreased (-0.149379 --> -0.150556).  Saving model ...
Epoch: 9 cost time: 0.5103838443756104
Epoch: 9, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.293 Vali Acc: 0.158 Test Loss: 3.293 Test Acc: 0.158
Validation loss decreased (-0.150556 --> -0.157614).  Saving model ...
Epoch: 10 cost time: 0.382305383682251
Epoch: 10, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.298 Vali Acc: 0.176 Test Loss: 3.298 Test Acc: 0.176
Validation loss decreased (-0.157614 --> -0.176438).  Saving model ...
Epoch: 11 cost time: 0.4450044631958008
Epoch: 11, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.330 Vali Acc: 0.185 Test Loss: 3.330 Test Acc: 0.185
Validation loss decreased (-0.176438 --> -0.184673).  Saving model ...
Epoch: 12 cost time: 0.3816554546356201
Epoch: 12, Steps: 10 | Train Loss: 1.065 Vali Loss: 3.356 Vali Acc: 0.207 Test Loss: 3.356 Test Acc: 0.207
Validation loss decreased (-0.184673 --> -0.207025).  Saving model ...
Epoch: 13 cost time: 0.412994384765625
Epoch: 13, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.390 Vali Acc: 0.219 Test Loss: 3.390 Test Acc: 0.219
Validation loss decreased (-0.207025 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 0.4209260940551758
Epoch: 14, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.437 Vali Acc: 0.220 Test Loss: 3.437 Test Acc: 0.220
Validation loss decreased (-0.218790 --> -0.219966).  Saving model ...
Epoch: 15 cost time: 0.44654273986816406
Epoch: 15, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.505 Vali Acc: 0.228 Test Loss: 3.505 Test Acc: 0.228
Validation loss decreased (-0.219966 --> -0.228200).  Saving model ...
Epoch: 16 cost time: 0.41593170166015625
Epoch: 16, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.574 Vali Acc: 0.231 Test Loss: 3.574 Test Acc: 0.231
Validation loss decreased (-0.228200 --> -0.230552).  Saving model ...
Epoch: 17 cost time: 0.43061280250549316
Epoch: 17, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.586 Vali Acc: 0.247 Test Loss: 3.586 Test Acc: 0.247
Validation loss decreased (-0.230552 --> -0.247023).  Saving model ...
Epoch: 18 cost time: 0.42801666259765625
Epoch: 18, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.711 Vali Acc: 0.240 Test Loss: 3.711 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4347038269042969
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.788 Vali Acc: 0.244 Test Loss: 3.788 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.41735291481018066
Epoch: 20, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.835 Vali Acc: 0.253 Test Loss: 3.835 Test Acc: 0.253
Validation loss decreased (-0.247023 --> -0.252903).  Saving model ...
Epoch: 21 cost time: 0.40725159645080566
Epoch: 21, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.931 Vali Acc: 0.242 Test Loss: 3.931 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4513528347015381
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.968 Vali Acc: 0.239 Test Loss: 3.968 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3852095603942871
Epoch: 23, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.041 Vali Acc: 0.244 Test Loss: 4.041 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4263291358947754
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.091 Vali Acc: 0.241 Test Loss: 4.091 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.3845236301422119
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.113 Vali Acc: 0.242 Test Loss: 4.113 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3991048336029053
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.176 Vali Acc: 0.251 Test Loss: 4.176 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4080967903137207
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.205 Vali Acc: 0.248 Test Loss: 4.205 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.41251325607299805
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.249 Vali Acc: 0.249 Test Loss: 4.249 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.43942856788635254
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.292 Vali Acc: 0.247 Test Loss: 4.292 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.40243029594421387
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.328 Vali Acc: 0.246 Test Loss: 4.328 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 121242
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4722576141357422
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.365 Vali Acc: 0.036 Test Loss: 3.365 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.4134795665740967
Epoch: 2, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.344 Vali Acc: 0.046 Test Loss: 3.344 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.4096550941467285
Epoch: 3, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.331 Vali Acc: 0.054 Test Loss: 3.331 Test Acc: 0.054
Validation loss decreased (-0.045849 --> -0.054084).  Saving model ...
Epoch: 4 cost time: 0.4281594753265381
Epoch: 4, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.325 Vali Acc: 0.065 Test Loss: 3.325 Test Acc: 0.065
Validation loss decreased (-0.054084 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.47661781311035156
Epoch: 5, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.325 Vali Acc: 0.081 Test Loss: 3.325 Test Acc: 0.081
Validation loss decreased (-0.064673 --> -0.081143).  Saving model ...
Epoch: 6 cost time: 0.4066145420074463
Epoch: 6, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.311 Vali Acc: 0.095 Test Loss: 3.311 Test Acc: 0.095
Validation loss decreased (-0.081143 --> -0.095261).  Saving model ...
Epoch: 7 cost time: 0.43157505989074707
Epoch: 7, Steps: 10 | Train Loss: 2.360 Vali Loss: 3.297 Vali Acc: 0.101 Test Loss: 3.297 Test Acc: 0.101
Validation loss decreased (-0.095261 --> -0.101143).  Saving model ...
Epoch: 8 cost time: 0.43274784088134766
Epoch: 8, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.277 Vali Acc: 0.119 Test Loss: 3.277 Test Acc: 0.119
Validation loss decreased (-0.101143 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 0.41755247116088867
Epoch: 9, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.284 Vali Acc: 0.128 Test Loss: 3.284 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128202).  Saving model ...
Epoch: 10 cost time: 0.4308605194091797
Epoch: 10, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.277 Vali Acc: 0.147 Test Loss: 3.277 Test Acc: 0.147
Validation loss decreased (-0.128202 --> -0.147026).  Saving model ...
Epoch: 11 cost time: 0.45334315299987793
Epoch: 11, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.277 Vali Acc: 0.164 Test Loss: 3.277 Test Acc: 0.164
Validation loss decreased (-0.147026 --> -0.163497).  Saving model ...
Epoch: 12 cost time: 0.3993537425994873
Epoch: 12, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.297 Vali Acc: 0.172 Test Loss: 3.297 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 13 cost time: 0.4362447261810303
Epoch: 13, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.324 Vali Acc: 0.179 Test Loss: 3.324 Test Acc: 0.179
Validation loss decreased (-0.171732 --> -0.178790).  Saving model ...
Epoch: 14 cost time: 0.4255564212799072
Epoch: 14, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.341 Vali Acc: 0.195 Test Loss: 3.341 Test Acc: 0.195
Validation loss decreased (-0.178790 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 0.38485097885131836
Epoch: 15, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.380 Vali Acc: 0.211 Test Loss: 3.380 Test Acc: 0.211
Validation loss decreased (-0.195261 --> -0.210554).  Saving model ...
Epoch: 16 cost time: 0.4096517562866211
Epoch: 16, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.407 Vali Acc: 0.209 Test Loss: 3.407 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4027690887451172
Epoch: 17, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.441 Vali Acc: 0.220 Test Loss: 3.441 Test Acc: 0.220
Validation loss decreased (-0.210554 --> -0.219966).  Saving model ...
Epoch: 18 cost time: 0.4282515048980713
Epoch: 18, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.486 Vali Acc: 0.213 Test Loss: 3.486 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.39815211296081543
Epoch: 19, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.558 Vali Acc: 0.214 Test Loss: 3.558 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4005413055419922
Epoch: 20, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.587 Vali Acc: 0.221 Test Loss: 3.587 Test Acc: 0.221
Validation loss decreased (-0.219966 --> -0.221141).  Saving model ...
Epoch: 21 cost time: 0.42135000228881836
Epoch: 21, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.648 Vali Acc: 0.218 Test Loss: 3.648 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3998560905456543
Epoch: 22, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.719 Vali Acc: 0.232 Test Loss: 3.719 Test Acc: 0.232
Validation loss decreased (-0.221141 --> -0.231728).  Saving model ...
Epoch: 23 cost time: 0.4034614562988281
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.786 Vali Acc: 0.234 Test Loss: 3.786 Test Acc: 0.234
Validation loss decreased (-0.231728 --> -0.234080).  Saving model ...
Epoch: 24 cost time: 0.41560840606689453
Epoch: 24, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.830 Vali Acc: 0.238 Test Loss: 3.830 Test Acc: 0.238
Validation loss decreased (-0.234080 --> -0.237609).  Saving model ...
Epoch: 25 cost time: 0.4005241394042969
Epoch: 25, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.866 Vali Acc: 0.232 Test Loss: 3.866 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4347662925720215
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.907 Vali Acc: 0.245 Test Loss: 3.907 Test Acc: 0.245
Validation loss decreased (-0.237609 --> -0.244667).  Saving model ...
Epoch: 27 cost time: 0.410874605178833
Epoch: 27, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.981 Vali Acc: 0.242 Test Loss: 3.981 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.44127893447875977
Epoch: 28, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.001 Vali Acc: 0.246 Test Loss: 4.001 Test Acc: 0.246
Validation loss decreased (-0.244667 --> -0.245842).  Saving model ...
Epoch: 29 cost time: 0.428147554397583
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.050 Vali Acc: 0.248 Test Loss: 4.050 Test Acc: 0.248
Validation loss decreased (-0.245842 --> -0.248195).  Saving model ...
Epoch: 30 cost time: 0.4404571056365967
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.075 Vali Acc: 0.247 Test Loss: 4.075 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.45186614990234375
Epoch: 31, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.092 Vali Acc: 0.252 Test Loss: 4.092 Test Acc: 0.252
Validation loss decreased (-0.248195 --> -0.251724).  Saving model ...
Epoch: 32 cost time: 0.4341731071472168
Epoch: 32, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.131 Vali Acc: 0.248 Test Loss: 4.131 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.43628621101379395
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.165 Vali Acc: 0.244 Test Loss: 4.165 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4562342166900635
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.184 Vali Acc: 0.244 Test Loss: 4.184 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.40611791610717773
Epoch: 35, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.199 Vali Acc: 0.246 Test Loss: 4.199 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.41225457191467285
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.222 Vali Acc: 0.249 Test Loss: 4.222 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4030649662017822
Epoch: 37, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.234 Vali Acc: 0.254 Test Loss: 4.234 Test Acc: 0.254
Validation loss decreased (-0.251724 --> -0.254075).  Saving model ...
Epoch: 38 cost time: 0.42665719985961914
Epoch: 38, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.240 Vali Acc: 0.254 Test Loss: 4.240 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.42775917053222656
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.266 Vali Acc: 0.253 Test Loss: 4.266 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4485194683074951
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.280 Vali Acc: 0.252 Test Loss: 4.280 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4644474983215332
Epoch: 41, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.306 Vali Acc: 0.249 Test Loss: 4.306 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4533576965332031
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.327 Vali Acc: 0.248 Test Loss: 4.327 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4342923164367676
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.350 Vali Acc: 0.251 Test Loss: 4.350 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.3500518798828125
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.374 Vali Acc: 0.252 Test Loss: 4.374 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4179973602294922
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.375 Vali Acc: 0.253 Test Loss: 4.375 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4171559810638428
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.387 Vali Acc: 0.254 Test Loss: 4.387 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.42639780044555664
Epoch: 47, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.398 Vali Acc: 0.254 Test Loss: 4.398 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 86746
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.668609857559204
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.349 Vali Acc: 0.040 Test Loss: 3.349 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.41765689849853516
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.333 Vali Acc: 0.056 Test Loss: 3.333 Test Acc: 0.056
Validation loss decreased (-0.039967 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.4341616630554199
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.321 Vali Acc: 0.068 Test Loss: 3.321 Test Acc: 0.068
Validation loss decreased (-0.056437 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.4074549674987793
Epoch: 4, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.307 Vali Acc: 0.084 Test Loss: 3.307 Test Acc: 0.084
Validation loss decreased (-0.068202 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.4879112243652344
Epoch: 5, Steps: 10 | Train Loss: 2.919 Vali Loss: 3.297 Vali Acc: 0.088 Test Loss: 3.297 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 6 cost time: 0.4239485263824463
Epoch: 6, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.296 Vali Acc: 0.102 Test Loss: 3.296 Test Acc: 0.102
Validation loss decreased (-0.088202 --> -0.102320).  Saving model ...
Epoch: 7 cost time: 0.4641835689544678
Epoch: 7, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.287 Vali Acc: 0.105 Test Loss: 3.287 Test Acc: 0.105
Validation loss decreased (-0.102320 --> -0.104673).  Saving model ...
Epoch: 8 cost time: 0.47629857063293457
Epoch: 8, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.282 Vali Acc: 0.106 Test Loss: 3.282 Test Acc: 0.106
Validation loss decreased (-0.104673 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 0.42488932609558105
Epoch: 9, Steps: 10 | Train Loss: 2.228 Vali Loss: 3.270 Vali Acc: 0.116 Test Loss: 3.270 Test Acc: 0.116
Validation loss decreased (-0.105850 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 0.41384196281433105
Epoch: 10, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.266 Vali Acc: 0.133 Test Loss: 3.266 Test Acc: 0.133
Validation loss decreased (-0.116438 --> -0.132909).  Saving model ...
Epoch: 11 cost time: 0.45880556106567383
Epoch: 11, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.268 Vali Acc: 0.141 Test Loss: 3.268 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 12 cost time: 0.42512059211730957
Epoch: 12, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.272 Vali Acc: 0.152 Test Loss: 3.272 Test Acc: 0.152
Validation loss decreased (-0.141144 --> -0.151732).  Saving model ...
Epoch: 13 cost time: 0.45374083518981934
Epoch: 13, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.285 Vali Acc: 0.154 Test Loss: 3.285 Test Acc: 0.154
Validation loss decreased (-0.151732 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.461456298828125
Epoch: 14, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.298 Vali Acc: 0.156 Test Loss: 3.298 Test Acc: 0.156
Validation loss decreased (-0.154085 --> -0.156438).  Saving model ...
Epoch: 15 cost time: 0.4510776996612549
Epoch: 15, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.301 Vali Acc: 0.171 Test Loss: 3.301 Test Acc: 0.171
Validation loss decreased (-0.156438 --> -0.170555).  Saving model ...
Epoch: 16 cost time: 0.43001580238342285
Epoch: 16, Steps: 10 | Train Loss: 1.196 Vali Loss: 3.329 Vali Acc: 0.186 Test Loss: 3.329 Test Acc: 0.186
Validation loss decreased (-0.170555 --> -0.185849).  Saving model ...
Epoch: 17 cost time: 0.46532487869262695
Epoch: 17, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.375 Vali Acc: 0.191 Test Loss: 3.375 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190554).  Saving model ...
Epoch: 18 cost time: 0.46985387802124023
Epoch: 18, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.402 Vali Acc: 0.199 Test Loss: 3.402 Test Acc: 0.199
Validation loss decreased (-0.190554 --> -0.198790).  Saving model ...
Epoch: 19 cost time: 0.4710874557495117
Epoch: 19, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.461 Vali Acc: 0.199 Test Loss: 3.461 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48876333236694336
Epoch: 20, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.492 Vali Acc: 0.200 Test Loss: 3.492 Test Acc: 0.200
Validation loss decreased (-0.198790 --> -0.199965).  Saving model ...
Epoch: 21 cost time: 0.4844484329223633
Epoch: 21, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.524 Vali Acc: 0.211 Test Loss: 3.524 Test Acc: 0.211
Validation loss decreased (-0.199965 --> -0.210553).  Saving model ...
Epoch: 22 cost time: 0.44832372665405273
Epoch: 22, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.575 Vali Acc: 0.209 Test Loss: 3.575 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4350099563598633
Epoch: 23, Steps: 10 | Train Loss: 0.463 Vali Loss: 3.630 Vali Acc: 0.209 Test Loss: 3.630 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.34636378288269043
Epoch: 24, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.657 Vali Acc: 0.218 Test Loss: 3.657 Test Acc: 0.218
Validation loss decreased (-0.210553 --> -0.217610).  Saving model ...
Epoch: 25 cost time: 0.431473970413208
Epoch: 25, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.712 Vali Acc: 0.221 Test Loss: 3.712 Test Acc: 0.221
Validation loss decreased (-0.217610 --> -0.221139).  Saving model ...
Epoch: 26 cost time: 0.4374840259552002
Epoch: 26, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.786 Vali Acc: 0.220 Test Loss: 3.786 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4191629886627197
Epoch: 27, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.858 Vali Acc: 0.211 Test Loss: 3.858 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4337639808654785
Epoch: 28, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.881 Vali Acc: 0.209 Test Loss: 3.881 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.43480801582336426
Epoch: 29, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.894 Vali Acc: 0.218 Test Loss: 3.894 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.40471577644348145
Epoch: 30, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.934 Vali Acc: 0.222 Test Loss: 3.934 Test Acc: 0.222
Validation loss decreased (-0.221139 --> -0.222314).  Saving model ...
Epoch: 31 cost time: 0.43679070472717285
Epoch: 31, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.985 Vali Acc: 0.218 Test Loss: 3.985 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.40382933616638184
Epoch: 32, Steps: 10 | Train Loss: 0.121 Vali Loss: 4.016 Vali Acc: 0.221 Test Loss: 4.016 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.43447065353393555
Epoch: 33, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.052 Vali Acc: 0.225 Test Loss: 4.052 Test Acc: 0.225
Validation loss decreased (-0.222314 --> -0.224665).  Saving model ...
Epoch: 34 cost time: 0.4058990478515625
Epoch: 34, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.085 Vali Acc: 0.219 Test Loss: 4.085 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4144272804260254
Epoch: 35, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.110 Vali Acc: 0.216 Test Loss: 4.110 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4446601867675781
Epoch: 36, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.149 Vali Acc: 0.218 Test Loss: 4.149 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.43535852432250977
Epoch: 37, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.180 Vali Acc: 0.219 Test Loss: 4.180 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.48093080520629883
Epoch: 38, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.203 Vali Acc: 0.218 Test Loss: 4.203 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4594414234161377
Epoch: 39, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.221 Vali Acc: 0.224 Test Loss: 4.221 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4537339210510254
Epoch: 40, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.241 Vali Acc: 0.221 Test Loss: 4.241 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.46253037452697754
Epoch: 41, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.280 Vali Acc: 0.227 Test Loss: 4.280 Test Acc: 0.227
Validation loss decreased (-0.224665 --> -0.227016).  Saving model ...
Epoch: 42 cost time: 0.41251063346862793
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.310 Vali Acc: 0.228 Test Loss: 4.310 Test Acc: 0.228
Validation loss decreased (-0.227016 --> -0.228192).  Saving model ...
Epoch: 43 cost time: 0.4356269836425781
Epoch: 43, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.318 Vali Acc: 0.227 Test Loss: 4.318 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.41109657287597656
Epoch: 44, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.329 Vali Acc: 0.226 Test Loss: 4.329 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.42290377616882324
Epoch: 45, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.342 Vali Acc: 0.226 Test Loss: 4.342 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5141658782958984
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.361 Vali Acc: 0.228 Test Loss: 4.361 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4409196376800537
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.384 Vali Acc: 0.226 Test Loss: 4.384 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4238762855529785
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.412 Vali Acc: 0.226 Test Loss: 4.412 Test Acc: 0.226
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.43680810928344727
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.435 Vali Acc: 0.227 Test Loss: 4.435 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.403639554977417
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.459 Vali Acc: 0.224 Test Loss: 4.459 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.4474635124206543
Epoch: 51, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.469 Vali Acc: 0.227 Test Loss: 4.469 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.43465566635131836
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.472 Vali Acc: 0.226 Test Loss: 4.472 Test Acc: 0.226
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22823529411764706
model parameter : 72282
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.348792552947998
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.361 Vali Acc: 0.025 Test Loss: 3.361 Test Acc: 0.025
Validation loss decreased (inf --> -0.024672).  Saving model ...
Epoch: 2 cost time: 0.4597315788269043
Epoch: 2, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.335 Vali Acc: 0.031 Test Loss: 3.335 Test Acc: 0.031
Validation loss decreased (-0.024672 --> -0.030555).  Saving model ...
Epoch: 3 cost time: 0.39537549018859863
Epoch: 3, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.311 Vali Acc: 0.039 Test Loss: 3.311 Test Acc: 0.039
Validation loss decreased (-0.030555 --> -0.038790).  Saving model ...
Epoch: 4 cost time: 0.4134206771850586
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.291 Vali Acc: 0.049 Test Loss: 3.291 Test Acc: 0.049
Validation loss decreased (-0.038790 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.41197848320007324
Epoch: 5, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.277 Vali Acc: 0.066 Test Loss: 3.277 Test Acc: 0.066
Validation loss decreased (-0.049379 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 0.4155850410461426
Epoch: 6, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.267 Vali Acc: 0.085 Test Loss: 3.267 Test Acc: 0.085
Validation loss decreased (-0.065850 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 0.4461855888366699
Epoch: 7, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.259 Vali Acc: 0.095 Test Loss: 3.259 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.43000364303588867
Epoch: 8, Steps: 10 | Train Loss: 2.552 Vali Loss: 3.257 Vali Acc: 0.101 Test Loss: 3.257 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 0.43564558029174805
Epoch: 9, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.245 Vali Acc: 0.112 Test Loss: 3.245 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.41275882720947266
Epoch: 10, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.236 Vali Acc: 0.118 Test Loss: 3.236 Test Acc: 0.118
Validation loss decreased (-0.111732 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 0.47274303436279297
Epoch: 11, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.238 Vali Acc: 0.128 Test Loss: 3.238 Test Acc: 0.128
Validation loss decreased (-0.117615 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.39678049087524414
Epoch: 12, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.242 Vali Acc: 0.135 Test Loss: 3.242 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 0.41509509086608887
Epoch: 13, Steps: 10 | Train Loss: 1.689 Vali Loss: 3.242 Vali Acc: 0.148 Test Loss: 3.242 Test Acc: 0.148
Validation loss decreased (-0.135262 --> -0.148203).  Saving model ...
Epoch: 14 cost time: 0.4289562702178955
Epoch: 14, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.251 Vali Acc: 0.153 Test Loss: 3.251 Test Acc: 0.153
Validation loss decreased (-0.148203 --> -0.152909).  Saving model ...
Epoch: 15 cost time: 0.4149599075317383
Epoch: 15, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.260 Vali Acc: 0.172 Test Loss: 3.260 Test Acc: 0.172
Validation loss decreased (-0.152909 --> -0.171732).  Saving model ...
Epoch: 16 cost time: 0.40352654457092285
Epoch: 16, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.268 Vali Acc: 0.173 Test Loss: 3.268 Test Acc: 0.173
Validation loss decreased (-0.171732 --> -0.172909).  Saving model ...
Epoch: 17 cost time: 0.4259939193725586
Epoch: 17, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.289 Vali Acc: 0.181 Test Loss: 3.289 Test Acc: 0.181
Validation loss decreased (-0.172909 --> -0.181144).  Saving model ...
Epoch: 18 cost time: 0.4019005298614502
Epoch: 18, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.306 Vali Acc: 0.195 Test Loss: 3.306 Test Acc: 0.195
Validation loss decreased (-0.181144 --> -0.195261).  Saving model ...
Epoch: 19 cost time: 0.4578585624694824
Epoch: 19, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.331 Vali Acc: 0.200 Test Loss: 3.331 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 20 cost time: 0.4044461250305176
Epoch: 20, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.356 Vali Acc: 0.206 Test Loss: 3.356 Test Acc: 0.206
Validation loss decreased (-0.199967 --> -0.205849).  Saving model ...
Epoch: 21 cost time: 0.38815903663635254
Epoch: 21, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.380 Vali Acc: 0.207 Test Loss: 3.380 Test Acc: 0.207
Validation loss decreased (-0.205849 --> -0.207025).  Saving model ...
Epoch: 22 cost time: 0.4347081184387207
Epoch: 22, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.422 Vali Acc: 0.214 Test Loss: 3.422 Test Acc: 0.214
Validation loss decreased (-0.207025 --> -0.214083).  Saving model ...
Epoch: 23 cost time: 0.4560120105743408
Epoch: 23, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.470 Vali Acc: 0.214 Test Loss: 3.470 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.44815540313720703
Epoch: 24, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.520 Vali Acc: 0.215 Test Loss: 3.520 Test Acc: 0.215
Validation loss decreased (-0.214083 --> -0.215259).  Saving model ...
Epoch: 25 cost time: 0.47646045684814453
Epoch: 25, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.546 Vali Acc: 0.221 Test Loss: 3.546 Test Acc: 0.221
Validation loss decreased (-0.215259 --> -0.221141).  Saving model ...
Epoch: 26 cost time: 0.43497395515441895
Epoch: 26, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.598 Vali Acc: 0.224 Test Loss: 3.598 Test Acc: 0.224
Validation loss decreased (-0.221141 --> -0.223493).  Saving model ...
Epoch: 27 cost time: 0.43349766731262207
Epoch: 27, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.620 Vali Acc: 0.229 Test Loss: 3.620 Test Acc: 0.229
Validation loss decreased (-0.223493 --> -0.229376).  Saving model ...
Epoch: 28 cost time: 0.47310423851013184
Epoch: 28, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.669 Vali Acc: 0.227 Test Loss: 3.669 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.43196630477905273
Epoch: 29, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.693 Vali Acc: 0.229 Test Loss: 3.693 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45074939727783203
Epoch: 30, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.736 Vali Acc: 0.232 Test Loss: 3.736 Test Acc: 0.232
Validation loss decreased (-0.229376 --> -0.231727).  Saving model ...
Epoch: 31 cost time: 0.4242827892303467
Epoch: 31, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.748 Vali Acc: 0.232 Test Loss: 3.748 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.45527124404907227
Epoch: 32, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.778 Vali Acc: 0.232 Test Loss: 3.778 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4029219150543213
Epoch: 33, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.800 Vali Acc: 0.238 Test Loss: 3.800 Test Acc: 0.238
Validation loss decreased (-0.231727 --> -0.237609).  Saving model ...
Epoch: 34 cost time: 0.42745471000671387
Epoch: 34, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.827 Vali Acc: 0.238 Test Loss: 3.827 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4428079128265381
Epoch: 35, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.844 Vali Acc: 0.233 Test Loss: 3.844 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.45241355895996094
Epoch: 36, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.875 Vali Acc: 0.234 Test Loss: 3.875 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.42667222023010254
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.890 Vali Acc: 0.241 Test Loss: 3.890 Test Acc: 0.241
Validation loss decreased (-0.237609 --> -0.241138).  Saving model ...
Epoch: 38 cost time: 0.404937744140625
Epoch: 38, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.913 Vali Acc: 0.244 Test Loss: 3.913 Test Acc: 0.244
Validation loss decreased (-0.241138 --> -0.243490).  Saving model ...
Epoch: 39 cost time: 0.4313817024230957
Epoch: 39, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.925 Vali Acc: 0.254 Test Loss: 3.925 Test Acc: 0.254
Validation loss decreased (-0.243490 --> -0.254078).  Saving model ...
Epoch: 40 cost time: 0.4183387756347656
Epoch: 40, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.955 Vali Acc: 0.248 Test Loss: 3.955 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.45758605003356934
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.980 Vali Acc: 0.248 Test Loss: 3.980 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.47836756706237793
Epoch: 42, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.001 Vali Acc: 0.248 Test Loss: 4.001 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4528470039367676
Epoch: 43, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.031 Vali Acc: 0.246 Test Loss: 4.031 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.45328307151794434
Epoch: 44, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.022 Vali Acc: 0.249 Test Loss: 4.022 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4521780014038086
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.034 Vali Acc: 0.249 Test Loss: 4.034 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4393594264984131
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.044 Vali Acc: 0.248 Test Loss: 4.044 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4368729591369629
Epoch: 47, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.067 Vali Acc: 0.249 Test Loss: 4.067 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.46953415870666504
Epoch: 48, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.078 Vali Acc: 0.249 Test Loss: 4.078 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.35009312629699707
Epoch: 49, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.096 Vali Acc: 0.258 Test Loss: 4.096 Test Acc: 0.258
Validation loss decreased (-0.254078 --> -0.257606).  Saving model ...
Epoch: 50 cost time: 0.42287111282348633
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.108 Vali Acc: 0.256 Test Loss: 4.108 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4284679889678955
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.121 Vali Acc: 0.254 Test Loss: 4.121 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.42400097846984863
Epoch: 52, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.130 Vali Acc: 0.256 Test Loss: 4.130 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.468198299407959
Epoch: 53, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.144 Vali Acc: 0.254 Test Loss: 4.144 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.4134049415588379
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.159 Vali Acc: 0.258 Test Loss: 4.159 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.37933874130249023
Epoch: 55, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.174 Vali Acc: 0.260 Test Loss: 4.174 Test Acc: 0.260
Validation loss decreased (-0.257606 --> -0.259958).  Saving model ...
Epoch: 56 cost time: 0.41598033905029297
Epoch: 56, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.187 Vali Acc: 0.262 Test Loss: 4.187 Test Acc: 0.262
Validation loss decreased (-0.259958 --> -0.262311).  Saving model ...
Epoch: 57 cost time: 0.46533823013305664
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.194 Vali Acc: 0.261 Test Loss: 4.194 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.4265129566192627
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.189 Vali Acc: 0.260 Test Loss: 4.189 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4184739589691162
Epoch: 59, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.208 Vali Acc: 0.264 Test Loss: 4.208 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 60 cost time: 0.45380520820617676
Epoch: 60, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.228 Vali Acc: 0.260 Test Loss: 4.228 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.4446754455566406
Epoch: 61, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.236 Vali Acc: 0.262 Test Loss: 4.236 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.4123077392578125
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.238 Vali Acc: 0.261 Test Loss: 4.238 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.4335286617279053
Epoch: 63, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.249 Vali Acc: 0.265 Test Loss: 4.249 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264663).  Saving model ...
Epoch: 64 cost time: 0.45012402534484863
Epoch: 64, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.264 Vali Acc: 0.262 Test Loss: 4.264 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.46911120414733887
Epoch: 65, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.260 Vali Acc: 0.264 Test Loss: 4.260 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4406125545501709
Epoch: 66, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.269 Vali Acc: 0.267 Test Loss: 4.269 Test Acc: 0.267
Validation loss decreased (-0.264663 --> -0.267016).  Saving model ...
Epoch: 67 cost time: 0.4475228786468506
Epoch: 67, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.298 Vali Acc: 0.269 Test Loss: 4.298 Test Acc: 0.269
Validation loss decreased (-0.267016 --> -0.269369).  Saving model ...
Epoch: 68 cost time: 0.41876792907714844
Epoch: 68, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.305 Vali Acc: 0.268 Test Loss: 4.305 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.39937686920166016
Epoch: 69, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.307 Vali Acc: 0.272 Test Loss: 4.307 Test Acc: 0.272
Validation loss decreased (-0.269369 --> -0.271722).  Saving model ...
Epoch: 70 cost time: 0.44843506813049316
Epoch: 70, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.310 Vali Acc: 0.268 Test Loss: 4.310 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.4281923770904541
Epoch: 71, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.318 Vali Acc: 0.271 Test Loss: 4.318 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.4168689250946045
Epoch: 72, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.333 Vali Acc: 0.268 Test Loss: 4.333 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.4243154525756836
Epoch: 73, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.340 Vali Acc: 0.269 Test Loss: 4.340 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.4183816909790039
Epoch: 74, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.345 Vali Acc: 0.265 Test Loss: 4.345 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.3951289653778076
Epoch: 75, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.355 Vali Acc: 0.267 Test Loss: 4.355 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.45485520362854004
Epoch: 76, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.377 Vali Acc: 0.265 Test Loss: 4.377 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.40404486656188965
Epoch: 77, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.398 Vali Acc: 0.268 Test Loss: 4.398 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.4362521171569824
Epoch: 78, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.400 Vali Acc: 0.272 Test Loss: 4.400 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.38646459579467773
Epoch: 79, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.392 Vali Acc: 0.271 Test Loss: 4.392 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm64_nh16_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 67738
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4330036640167236
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.343 Vali Acc: 0.061 Test Loss: 3.343 Test Acc: 0.061
Validation loss decreased (inf --> -0.061143).  Saving model ...
Epoch: 2 cost time: 0.41932153701782227
Epoch: 2, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.343 Vali Acc: 0.082 Test Loss: 3.343 Test Acc: 0.082
Validation loss decreased (-0.061143 --> -0.082320).  Saving model ...
Epoch: 3 cost time: 0.42484092712402344
Epoch: 3, Steps: 10 | Train Loss: 2.959 Vali Loss: 3.337 Vali Acc: 0.096 Test Loss: 3.337 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096437).  Saving model ...
Epoch: 4 cost time: 0.4265918731689453
Epoch: 4, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.271 Vali Acc: 0.119 Test Loss: 3.271 Test Acc: 0.119
Validation loss decreased (-0.096437 --> -0.118791).  Saving model ...
Epoch: 5 cost time: 0.4097714424133301
Epoch: 5, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.227 Vali Acc: 0.139 Test Loss: 3.227 Test Acc: 0.139
Validation loss decreased (-0.118791 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.432497501373291
Epoch: 6, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.216 Vali Acc: 0.174 Test Loss: 3.216 Test Acc: 0.174
Validation loss decreased (-0.138791 --> -0.174085).  Saving model ...
Epoch: 7 cost time: 0.40912485122680664
Epoch: 7, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.269 Vali Acc: 0.195 Test Loss: 3.269 Test Acc: 0.195
Validation loss decreased (-0.174085 --> -0.195261).  Saving model ...
Epoch: 8 cost time: 0.41095471382141113
Epoch: 8, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.308 Vali Acc: 0.200 Test Loss: 3.308 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 9 cost time: 0.41024017333984375
Epoch: 9, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.332 Vali Acc: 0.220 Test Loss: 3.332 Test Acc: 0.220
Validation loss decreased (-0.199967 --> -0.219967).  Saving model ...
Epoch: 10 cost time: 0.44378232955932617
Epoch: 10, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.430 Vali Acc: 0.222 Test Loss: 3.430 Test Acc: 0.222
Validation loss decreased (-0.219967 --> -0.222319).  Saving model ...
Epoch: 11 cost time: 0.4067220687866211
Epoch: 11, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.539 Vali Acc: 0.232 Test Loss: 3.539 Test Acc: 0.232
Validation loss decreased (-0.222319 --> -0.231729).  Saving model ...
Epoch: 12 cost time: 0.4820590019226074
Epoch: 12, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.573 Vali Acc: 0.255 Test Loss: 3.573 Test Acc: 0.255
Validation loss decreased (-0.231729 --> -0.255258).  Saving model ...
Epoch: 13 cost time: 0.4195427894592285
Epoch: 13, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.721 Vali Acc: 0.249 Test Loss: 3.721 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4220695495605469
Epoch: 14, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.823 Vali Acc: 0.244 Test Loss: 3.823 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.39872312545776367
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.924 Vali Acc: 0.259 Test Loss: 3.924 Test Acc: 0.259
Validation loss decreased (-0.255258 --> -0.258784).  Saving model ...
Epoch: 16 cost time: 0.4218897819519043
Epoch: 16, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.040 Vali Acc: 0.266 Test Loss: 4.040 Test Acc: 0.266
Validation loss decreased (-0.258784 --> -0.265842).  Saving model ...
Epoch: 17 cost time: 0.47452306747436523
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.119 Vali Acc: 0.256 Test Loss: 4.119 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4216170310974121
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.156 Vali Acc: 0.272 Test Loss: 4.156 Test Acc: 0.272
Validation loss decreased (-0.265842 --> -0.271723).  Saving model ...
Epoch: 19 cost time: 0.40261292457580566
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.251 Vali Acc: 0.258 Test Loss: 4.251 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4082956314086914
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.321 Vali Acc: 0.265 Test Loss: 4.321 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.38974905014038086
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.318 Vali Acc: 0.274 Test Loss: 4.318 Test Acc: 0.274
Validation loss decreased (-0.271723 --> -0.274074).  Saving model ...
Epoch: 22 cost time: 0.4200010299682617
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.353 Vali Acc: 0.279 Test Loss: 4.353 Test Acc: 0.279
Validation loss decreased (-0.274074 --> -0.278780).  Saving model ...
Epoch: 23 cost time: 0.4264950752258301
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.372 Vali Acc: 0.280 Test Loss: 4.372 Test Acc: 0.280
Validation loss decreased (-0.278780 --> -0.279956).  Saving model ...
Epoch: 24 cost time: 0.42682337760925293
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.412 Vali Acc: 0.276 Test Loss: 4.412 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.42753171920776367
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.438 Vali Acc: 0.279 Test Loss: 4.438 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.392148494720459
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.459 Vali Acc: 0.279 Test Loss: 4.459 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.42129993438720703
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.500 Vali Acc: 0.274 Test Loss: 4.500 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.43436193466186523
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.524 Vali Acc: 0.279 Test Loss: 4.524 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4279820919036865
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.557 Vali Acc: 0.279 Test Loss: 4.557 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.44710493087768555
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.570 Vali Acc: 0.275 Test Loss: 4.570 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4470982551574707
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.578 Vali Acc: 0.278 Test Loss: 4.578 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4311037063598633
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.600 Vali Acc: 0.279 Test Loss: 4.600 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4429492950439453
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.631 Vali Acc: 0.280 Test Loss: 4.631 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 210938
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.600261926651001
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.378 Vali Acc: 0.027 Test Loss: 3.378 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.4495725631713867
Epoch: 2, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.344 Vali Acc: 0.053 Test Loss: 3.344 Test Acc: 0.053
Validation loss decreased (-0.027025 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.46383213996887207
Epoch: 3, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.360 Vali Acc: 0.073 Test Loss: 3.360 Test Acc: 0.073
Validation loss decreased (-0.052908 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.4356863498687744
Epoch: 4, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.360 Vali Acc: 0.089 Test Loss: 3.360 Test Acc: 0.089
Validation loss decreased (-0.072908 --> -0.089378).  Saving model ...
Epoch: 5 cost time: 0.42022109031677246
Epoch: 5, Steps: 10 | Train Loss: 2.686 Vali Loss: 3.375 Vali Acc: 0.101 Test Loss: 3.375 Test Acc: 0.101
Validation loss decreased (-0.089378 --> -0.101143).  Saving model ...
Epoch: 6 cost time: 0.43978071212768555
Epoch: 6, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.312 Vali Acc: 0.112 Test Loss: 3.312 Test Acc: 0.112
Validation loss decreased (-0.101143 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 0.46268486976623535
Epoch: 7, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.290 Vali Acc: 0.133 Test Loss: 3.290 Test Acc: 0.133
Validation loss decreased (-0.111732 --> -0.132908).  Saving model ...
Epoch: 8 cost time: 0.4586520195007324
Epoch: 8, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.287 Vali Acc: 0.140 Test Loss: 3.287 Test Acc: 0.140
Validation loss decreased (-0.132908 --> -0.139967).  Saving model ...
Epoch: 9 cost time: 0.4130592346191406
Epoch: 9, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.274 Vali Acc: 0.167 Test Loss: 3.274 Test Acc: 0.167
Validation loss decreased (-0.139967 --> -0.167026).  Saving model ...
Epoch: 10 cost time: 0.4393911361694336
Epoch: 10, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.316 Vali Acc: 0.174 Test Loss: 3.316 Test Acc: 0.174
Validation loss decreased (-0.167026 --> -0.174084).  Saving model ...
Epoch: 11 cost time: 0.42946290969848633
Epoch: 11, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.354 Vali Acc: 0.181 Test Loss: 3.354 Test Acc: 0.181
Validation loss decreased (-0.174084 --> -0.181143).  Saving model ...
Epoch: 12 cost time: 0.4616847038269043
Epoch: 12, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.414 Vali Acc: 0.191 Test Loss: 3.414 Test Acc: 0.191
Validation loss decreased (-0.181143 --> -0.190554).  Saving model ...
Epoch: 13 cost time: 0.4507877826690674
Epoch: 13, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.428 Vali Acc: 0.206 Test Loss: 3.428 Test Acc: 0.206
Validation loss decreased (-0.190554 --> -0.205848).  Saving model ...
Epoch: 14 cost time: 0.429140567779541
Epoch: 14, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.463 Vali Acc: 0.219 Test Loss: 3.463 Test Acc: 0.219
Validation loss decreased (-0.205848 --> -0.218789).  Saving model ...
Epoch: 15 cost time: 0.48094701766967773
Epoch: 15, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.525 Vali Acc: 0.224 Test Loss: 3.525 Test Acc: 0.224
Validation loss decreased (-0.218789 --> -0.223494).  Saving model ...
Epoch: 16 cost time: 0.3367147445678711
Epoch: 16, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.567 Vali Acc: 0.234 Test Loss: 3.567 Test Acc: 0.234
Validation loss decreased (-0.223494 --> -0.234082).  Saving model ...
Epoch: 17 cost time: 0.43045711517333984
Epoch: 17, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.630 Vali Acc: 0.233 Test Loss: 3.630 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4242229461669922
Epoch: 18, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.702 Vali Acc: 0.248 Test Loss: 3.702 Test Acc: 0.248
Validation loss decreased (-0.234082 --> -0.248198).  Saving model ...
Epoch: 19 cost time: 0.4376380443572998
Epoch: 19, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.787 Vali Acc: 0.233 Test Loss: 3.787 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.44098544120788574
Epoch: 20, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.812 Vali Acc: 0.248 Test Loss: 3.812 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.41770124435424805
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.905 Vali Acc: 0.249 Test Loss: 3.905 Test Acc: 0.249
Validation loss decreased (-0.248198 --> -0.249373).  Saving model ...
Epoch: 22 cost time: 0.4565746784210205
Epoch: 22, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.030 Vali Acc: 0.233 Test Loss: 4.030 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.43374013900756836
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.037 Vali Acc: 0.249 Test Loss: 4.037 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4146761894226074
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.063 Vali Acc: 0.258 Test Loss: 4.063 Test Acc: 0.258
Validation loss decreased (-0.249373 --> -0.257606).  Saving model ...
Epoch: 25 cost time: 0.45365476608276367
Epoch: 25, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.065 Vali Acc: 0.261 Test Loss: 4.065 Test Acc: 0.261
Validation loss decreased (-0.257606 --> -0.261136).  Saving model ...
Epoch: 26 cost time: 0.43869471549987793
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.144 Vali Acc: 0.255 Test Loss: 4.144 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4254584312438965
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.181 Vali Acc: 0.254 Test Loss: 4.181 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.43000102043151855
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.189 Vali Acc: 0.262 Test Loss: 4.189 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262311).  Saving model ...
Epoch: 29 cost time: 0.4386475086212158
Epoch: 29, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.239 Vali Acc: 0.262 Test Loss: 4.239 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.44220399856567383
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.269 Vali Acc: 0.264 Test Loss: 4.269 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263487).  Saving model ...
Epoch: 31 cost time: 0.4439420700073242
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.281 Vali Acc: 0.265 Test Loss: 4.281 Test Acc: 0.265
Validation loss decreased (-0.263487 --> -0.264663).  Saving model ...
Epoch: 32 cost time: 0.4227325916290283
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.281 Vali Acc: 0.266 Test Loss: 4.281 Test Acc: 0.266
Validation loss decreased (-0.264663 --> -0.265840).  Saving model ...
Epoch: 33 cost time: 0.44011402130126953
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.295 Vali Acc: 0.267 Test Loss: 4.295 Test Acc: 0.267
Validation loss decreased (-0.265840 --> -0.267016).  Saving model ...
Epoch: 34 cost time: 0.4510159492492676
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.318 Vali Acc: 0.272 Test Loss: 4.318 Test Acc: 0.272
Validation loss decreased (-0.267016 --> -0.271722).  Saving model ...
Epoch: 35 cost time: 0.4488508701324463
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.359 Vali Acc: 0.271 Test Loss: 4.359 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4538898468017578
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.391 Vali Acc: 0.261 Test Loss: 4.391 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.41788482666015625
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.395 Vali Acc: 0.265 Test Loss: 4.395 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.3762385845184326
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.415 Vali Acc: 0.266 Test Loss: 4.415 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.40862393379211426
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.428 Vali Acc: 0.268 Test Loss: 4.428 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4142415523529053
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.437 Vali Acc: 0.269 Test Loss: 4.437 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4128296375274658
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.470 Vali Acc: 0.268 Test Loss: 4.470 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.41829371452331543
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.487 Vali Acc: 0.272 Test Loss: 4.487 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4159204959869385
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.481 Vali Acc: 0.275 Test Loss: 4.481 Test Acc: 0.275
Validation loss decreased (-0.271722 --> -0.275249).  Saving model ...
Epoch: 44 cost time: 0.3649444580078125
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.498 Vali Acc: 0.276 Test Loss: 4.498 Test Acc: 0.276
Validation loss decreased (-0.275249 --> -0.276426).  Saving model ...
Epoch: 45 cost time: 0.4094078540802002
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.513 Vali Acc: 0.271 Test Loss: 4.513 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.42208075523376465
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.547 Vali Acc: 0.267 Test Loss: 4.547 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4065558910369873
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.563 Vali Acc: 0.265 Test Loss: 4.563 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4073646068572998
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.572 Vali Acc: 0.267 Test Loss: 4.572 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.40735697746276855
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.596 Vali Acc: 0.267 Test Loss: 4.596 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.39385318756103516
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.607 Vali Acc: 0.269 Test Loss: 4.607 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.3652467727661133
Epoch: 51, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.614 Vali Acc: 0.264 Test Loss: 4.614 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.39867424964904785
Epoch: 52, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.618 Vali Acc: 0.268 Test Loss: 4.618 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.4477498531341553
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.618 Vali Acc: 0.269 Test Loss: 4.618 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.35686683654785156
Epoch: 54, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.622 Vali Acc: 0.271 Test Loss: 4.622 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 116218
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5514333248138428
Epoch: 1, Steps: 10 | Train Loss: 3.532 Vali Loss: 3.334 Vali Acc: 0.044 Test Loss: 3.334 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.4619593620300293
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.309 Vali Acc: 0.061 Test Loss: 3.309 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.44223952293395996
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.301 Vali Acc: 0.076 Test Loss: 3.301 Test Acc: 0.076
Validation loss decreased (-0.061143 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.43454790115356445
Epoch: 4, Steps: 10 | Train Loss: 2.973 Vali Loss: 3.300 Vali Acc: 0.084 Test Loss: 3.300 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.43448591232299805
Epoch: 5, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.294 Vali Acc: 0.094 Test Loss: 3.294 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.4481370449066162
Epoch: 6, Steps: 10 | Train Loss: 2.631 Vali Loss: 3.290 Vali Acc: 0.108 Test Loss: 3.290 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108202).  Saving model ...
Epoch: 7 cost time: 0.4449136257171631
Epoch: 7, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.257 Vali Acc: 0.127 Test Loss: 3.257 Test Acc: 0.127
Validation loss decreased (-0.108202 --> -0.127026).  Saving model ...
Epoch: 8 cost time: 0.40964627265930176
Epoch: 8, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.231 Vali Acc: 0.145 Test Loss: 3.231 Test Acc: 0.145
Validation loss decreased (-0.127026 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 0.40734195709228516
Epoch: 9, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.213 Vali Acc: 0.148 Test Loss: 3.213 Test Acc: 0.148
Validation loss decreased (-0.144674 --> -0.148203).  Saving model ...
Epoch: 10 cost time: 0.4253106117248535
Epoch: 10, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.217 Vali Acc: 0.165 Test Loss: 3.217 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164674).  Saving model ...
Epoch: 11 cost time: 0.42813968658447266
Epoch: 11, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.225 Vali Acc: 0.168 Test Loss: 3.225 Test Acc: 0.168
Validation loss decreased (-0.164674 --> -0.168203).  Saving model ...
Epoch: 12 cost time: 0.44534945487976074
Epoch: 12, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.221 Vali Acc: 0.179 Test Loss: 3.221 Test Acc: 0.179
Validation loss decreased (-0.168203 --> -0.178791).  Saving model ...
Epoch: 13 cost time: 0.43010568618774414
Epoch: 13, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.227 Vali Acc: 0.186 Test Loss: 3.227 Test Acc: 0.186
Validation loss decreased (-0.178791 --> -0.185850).  Saving model ...
Epoch: 14 cost time: 0.428999662399292
Epoch: 14, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.264 Vali Acc: 0.189 Test Loss: 3.264 Test Acc: 0.189
Validation loss decreased (-0.185850 --> -0.189379).  Saving model ...
Epoch: 15 cost time: 0.43477678298950195
Epoch: 15, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.263 Vali Acc: 0.204 Test Loss: 3.263 Test Acc: 0.204
Validation loss decreased (-0.189379 --> -0.203497).  Saving model ...
Epoch: 16 cost time: 0.4405386447906494
Epoch: 16, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.285 Vali Acc: 0.222 Test Loss: 3.285 Test Acc: 0.222
Validation loss decreased (-0.203497 --> -0.222320).  Saving model ...
Epoch: 17 cost time: 0.46945929527282715
Epoch: 17, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.336 Vali Acc: 0.222 Test Loss: 3.336 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4476189613342285
Epoch: 18, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.368 Vali Acc: 0.231 Test Loss: 3.368 Test Acc: 0.231
Validation loss decreased (-0.222320 --> -0.230555).  Saving model ...
Epoch: 19 cost time: 0.4583454132080078
Epoch: 19, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.413 Vali Acc: 0.229 Test Loss: 3.413 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.44748544692993164
Epoch: 20, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.452 Vali Acc: 0.232 Test Loss: 3.452 Test Acc: 0.232
Validation loss decreased (-0.230555 --> -0.231730).  Saving model ...
Epoch: 21 cost time: 0.45911550521850586
Epoch: 21, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.493 Vali Acc: 0.242 Test Loss: 3.493 Test Acc: 0.242
Validation loss decreased (-0.231730 --> -0.242318).  Saving model ...
Epoch: 22 cost time: 0.42414355278015137
Epoch: 22, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.565 Vali Acc: 0.249 Test Loss: 3.565 Test Acc: 0.249
Validation loss decreased (-0.242318 --> -0.249376).  Saving model ...
Epoch: 23 cost time: 0.44787168502807617
Epoch: 23, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.619 Vali Acc: 0.247 Test Loss: 3.619 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4319918155670166
Epoch: 24, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.676 Vali Acc: 0.253 Test Loss: 3.676 Test Acc: 0.253
Validation loss decreased (-0.249376 --> -0.252904).  Saving model ...
Epoch: 25 cost time: 0.49677228927612305
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.729 Vali Acc: 0.253 Test Loss: 3.729 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.43346190452575684
Epoch: 26, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.763 Vali Acc: 0.244 Test Loss: 3.763 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.45944714546203613
Epoch: 27, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.802 Vali Acc: 0.248 Test Loss: 3.802 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4090311527252197
Epoch: 28, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.842 Vali Acc: 0.249 Test Loss: 3.842 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4260716438293457
Epoch: 29, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.905 Vali Acc: 0.241 Test Loss: 3.905 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4557359218597412
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.931 Vali Acc: 0.245 Test Loss: 3.931 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.42353343963623047
Epoch: 31, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.958 Vali Acc: 0.246 Test Loss: 3.958 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.48068690299987793
Epoch: 32, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.983 Vali Acc: 0.254 Test Loss: 3.983 Test Acc: 0.254
Validation loss decreased (-0.252904 --> -0.254078).  Saving model ...
Epoch: 33 cost time: 0.44288206100463867
Epoch: 33, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.013 Vali Acc: 0.256 Test Loss: 4.013 Test Acc: 0.256
Validation loss decreased (-0.254078 --> -0.256430).  Saving model ...
Epoch: 34 cost time: 0.464322566986084
Epoch: 34, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.030 Vali Acc: 0.249 Test Loss: 4.030 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4469025135040283
Epoch: 35, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.064 Vali Acc: 0.254 Test Loss: 4.064 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.45073413848876953
Epoch: 36, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.078 Vali Acc: 0.252 Test Loss: 4.078 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4619560241699219
Epoch: 37, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.105 Vali Acc: 0.259 Test Loss: 4.105 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258782).  Saving model ...
Epoch: 38 cost time: 0.4382598400115967
Epoch: 38, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.135 Vali Acc: 0.261 Test Loss: 4.135 Test Acc: 0.261
Validation loss decreased (-0.258782 --> -0.261135).  Saving model ...
Epoch: 39 cost time: 0.4590446949005127
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.161 Vali Acc: 0.260 Test Loss: 4.161 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4435422420501709
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.170 Vali Acc: 0.259 Test Loss: 4.170 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4511678218841553
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.181 Vali Acc: 0.262 Test Loss: 4.181 Test Acc: 0.262
Validation loss decreased (-0.261135 --> -0.262311).  Saving model ...
Epoch: 42 cost time: 0.45699000358581543
Epoch: 42, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.188 Vali Acc: 0.264 Test Loss: 4.188 Test Acc: 0.264
Validation loss decreased (-0.262311 --> -0.263488).  Saving model ...
Epoch: 43 cost time: 0.45575809478759766
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.208 Vali Acc: 0.265 Test Loss: 4.208 Test Acc: 0.265
Validation loss decreased (-0.263488 --> -0.264664).  Saving model ...
Epoch: 44 cost time: 0.42149853706359863
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.222 Vali Acc: 0.262 Test Loss: 4.222 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4803049564361572
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.231 Vali Acc: 0.265 Test Loss: 4.231 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5099844932556152
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.263 Vali Acc: 0.262 Test Loss: 4.263 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.46390390396118164
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.285 Vali Acc: 0.261 Test Loss: 4.285 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4558277130126953
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.306 Vali Acc: 0.261 Test Loss: 4.306 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.48587608337402344
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.320 Vali Acc: 0.258 Test Loss: 4.320 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.42690420150756836
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.343 Vali Acc: 0.264 Test Loss: 4.343 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.4569087028503418
Epoch: 51, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.345 Vali Acc: 0.264 Test Loss: 4.345 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.4368319511413574
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.348 Vali Acc: 0.262 Test Loss: 4.348 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.4556853771209717
Epoch: 53, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.368 Vali Acc: 0.261 Test Loss: 4.368 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 83898
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5178134441375732
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.384 Vali Acc: 0.027 Test Loss: 3.384 Test Acc: 0.027
Validation loss decreased (inf --> -0.027025).  Saving model ...
Epoch: 2 cost time: 0.45597171783447266
Epoch: 2, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.368 Vali Acc: 0.042 Test Loss: 3.368 Test Acc: 0.042
Validation loss decreased (-0.027025 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.4652061462402344
Epoch: 3, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.361 Vali Acc: 0.053 Test Loss: 3.361 Test Acc: 0.053
Validation loss decreased (-0.042319 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.4691493511199951
Epoch: 4, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.351 Vali Acc: 0.054 Test Loss: 3.351 Test Acc: 0.054
Validation loss decreased (-0.052908 --> -0.054084).  Saving model ...
Epoch: 5 cost time: 0.4851529598236084
Epoch: 5, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.343 Vali Acc: 0.075 Test Loss: 3.343 Test Acc: 0.075
Validation loss decreased (-0.054084 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 0.4242885112762451
Epoch: 6, Steps: 10 | Train Loss: 2.809 Vali Loss: 3.333 Vali Acc: 0.086 Test Loss: 3.333 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085849).  Saving model ...
Epoch: 7 cost time: 0.46146416664123535
Epoch: 7, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.318 Vali Acc: 0.091 Test Loss: 3.318 Test Acc: 0.091
Validation loss decreased (-0.085849 --> -0.090555).  Saving model ...
Epoch: 8 cost time: 0.453855037689209
Epoch: 8, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.303 Vali Acc: 0.100 Test Loss: 3.303 Test Acc: 0.100
Validation loss decreased (-0.090555 --> -0.099967).  Saving model ...
Epoch: 9 cost time: 0.47859978675842285
Epoch: 9, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.298 Vali Acc: 0.106 Test Loss: 3.298 Test Acc: 0.106
Validation loss decreased (-0.099967 --> -0.105849).  Saving model ...
Epoch: 10 cost time: 0.46447134017944336
Epoch: 10, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.296 Vali Acc: 0.128 Test Loss: 3.296 Test Acc: 0.128
Validation loss decreased (-0.105849 --> -0.128202).  Saving model ...
Epoch: 11 cost time: 0.4720907211303711
Epoch: 11, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.289 Vali Acc: 0.136 Test Loss: 3.289 Test Acc: 0.136
Validation loss decreased (-0.128202 --> -0.136438).  Saving model ...
Epoch: 12 cost time: 0.4482743740081787
Epoch: 12, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.272 Vali Acc: 0.152 Test Loss: 3.272 Test Acc: 0.152
Validation loss decreased (-0.136438 --> -0.151732).  Saving model ...
Epoch: 13 cost time: 0.4803171157836914
Epoch: 13, Steps: 10 | Train Loss: 1.668 Vali Loss: 3.284 Vali Acc: 0.166 Test Loss: 3.284 Test Acc: 0.166
Validation loss decreased (-0.151732 --> -0.165850).  Saving model ...
Epoch: 14 cost time: 0.4438967704772949
Epoch: 14, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.284 Vali Acc: 0.181 Test Loss: 3.284 Test Acc: 0.181
Validation loss decreased (-0.165850 --> -0.181144).  Saving model ...
Epoch: 15 cost time: 0.5115785598754883
Epoch: 15, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.304 Vali Acc: 0.172 Test Loss: 3.304 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.411973237991333
Epoch: 16, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.302 Vali Acc: 0.195 Test Loss: 3.302 Test Acc: 0.195
Validation loss decreased (-0.181144 --> -0.195261).  Saving model ...
Epoch: 17 cost time: 0.43843770027160645
Epoch: 17, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.328 Vali Acc: 0.208 Test Loss: 3.328 Test Acc: 0.208
Validation loss decreased (-0.195261 --> -0.208202).  Saving model ...
Epoch: 18 cost time: 0.45197153091430664
Epoch: 18, Steps: 10 | Train Loss: 0.958 Vali Loss: 3.356 Vali Acc: 0.201 Test Loss: 3.356 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46126723289489746
Epoch: 19, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.367 Vali Acc: 0.211 Test Loss: 3.367 Test Acc: 0.211
Validation loss decreased (-0.208202 --> -0.210555).  Saving model ...
Epoch: 20 cost time: 0.458143949508667
Epoch: 20, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.395 Vali Acc: 0.218 Test Loss: 3.395 Test Acc: 0.218
Validation loss decreased (-0.210555 --> -0.217613).  Saving model ...
Epoch: 21 cost time: 0.4833407402038574
Epoch: 21, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.449 Vali Acc: 0.227 Test Loss: 3.449 Test Acc: 0.227
Validation loss decreased (-0.217613 --> -0.227024).  Saving model ...
Epoch: 22 cost time: 0.4632725715637207
Epoch: 22, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.472 Vali Acc: 0.229 Test Loss: 3.472 Test Acc: 0.229
Validation loss decreased (-0.227024 --> -0.229377).  Saving model ...
Epoch: 23 cost time: 0.46522951126098633
Epoch: 23, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.487 Vali Acc: 0.241 Test Loss: 3.487 Test Acc: 0.241
Validation loss decreased (-0.229377 --> -0.241142).  Saving model ...
Epoch: 24 cost time: 0.45476412773132324
Epoch: 24, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.541 Vali Acc: 0.245 Test Loss: 3.541 Test Acc: 0.245
Validation loss decreased (-0.241142 --> -0.244670).  Saving model ...
Epoch: 25 cost time: 0.45578742027282715
Epoch: 25, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.570 Vali Acc: 0.253 Test Loss: 3.570 Test Acc: 0.253
Validation loss decreased (-0.244670 --> -0.252905).  Saving model ...
Epoch: 26 cost time: 0.45199036598205566
Epoch: 26, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.613 Vali Acc: 0.251 Test Loss: 3.613 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4701354503631592
Epoch: 27, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.629 Vali Acc: 0.256 Test Loss: 3.629 Test Acc: 0.256
Validation loss decreased (-0.252905 --> -0.256434).  Saving model ...
Epoch: 28 cost time: 0.4460105895996094
Epoch: 28, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.694 Vali Acc: 0.252 Test Loss: 3.694 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47895240783691406
Epoch: 29, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.736 Vali Acc: 0.247 Test Loss: 3.736 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45908451080322266
Epoch: 30, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.751 Vali Acc: 0.251 Test Loss: 3.751 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.46686482429504395
Epoch: 31, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.771 Vali Acc: 0.248 Test Loss: 3.771 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.46739721298217773
Epoch: 32, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.798 Vali Acc: 0.252 Test Loss: 3.798 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.48784661293029785
Epoch: 33, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.826 Vali Acc: 0.259 Test Loss: 3.826 Test Acc: 0.259
Validation loss decreased (-0.256434 --> -0.258785).  Saving model ...
Epoch: 34 cost time: 0.42462635040283203
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.857 Vali Acc: 0.258 Test Loss: 3.857 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4519321918487549
Epoch: 35, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.918 Vali Acc: 0.252 Test Loss: 3.918 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.43842124938964844
Epoch: 36, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.962 Vali Acc: 0.252 Test Loss: 3.962 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.46461057662963867
Epoch: 37, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.968 Vali Acc: 0.248 Test Loss: 3.968 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.43436121940612793
Epoch: 38, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.968 Vali Acc: 0.252 Test Loss: 3.968 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4660003185272217
Epoch: 39, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.974 Vali Acc: 0.252 Test Loss: 3.974 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4219794273376465
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.997 Vali Acc: 0.255 Test Loss: 3.997 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5004112720489502
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.029 Vali Acc: 0.248 Test Loss: 4.029 Test Acc: 0.248
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4335002899169922
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.068 Vali Acc: 0.248 Test Loss: 4.068 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.47329115867614746
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.092 Vali Acc: 0.255 Test Loss: 4.092 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 69050
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.404458999633789
Epoch: 1, Steps: 10 | Train Loss: 3.581 Vali Loss: 3.344 Vali Acc: 0.051 Test Loss: 3.344 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.48024773597717285
Epoch: 2, Steps: 10 | Train Loss: 3.491 Vali Loss: 3.337 Vali Acc: 0.046 Test Loss: 3.337 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4838285446166992
Epoch: 3, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.322 Vali Acc: 0.052 Test Loss: 3.322 Test Acc: 0.052
Validation loss decreased (-0.050555 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 0.42709994316101074
Epoch: 4, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.307 Vali Acc: 0.059 Test Loss: 3.307 Test Acc: 0.059
Validation loss decreased (-0.051731 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.4767608642578125
Epoch: 5, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.294 Vali Acc: 0.061 Test Loss: 3.294 Test Acc: 0.061
Validation loss decreased (-0.058790 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.45069408416748047
Epoch: 6, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.287 Vali Acc: 0.060 Test Loss: 3.287 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.43997788429260254
Epoch: 7, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.283 Vali Acc: 0.066 Test Loss: 3.283 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065850).  Saving model ...
Epoch: 8 cost time: 0.47344493865966797
Epoch: 8, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.272 Vali Acc: 0.074 Test Loss: 3.272 Test Acc: 0.074
Validation loss decreased (-0.065850 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 0.43563270568847656
Epoch: 9, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.264 Vali Acc: 0.089 Test Loss: 3.264 Test Acc: 0.089
Validation loss decreased (-0.074085 --> -0.089379).  Saving model ...
Epoch: 10 cost time: 0.428070068359375
Epoch: 10, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.258 Vali Acc: 0.102 Test Loss: 3.258 Test Acc: 0.102
Validation loss decreased (-0.089379 --> -0.102320).  Saving model ...
Epoch: 11 cost time: 0.43586158752441406
Epoch: 11, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.250 Vali Acc: 0.109 Test Loss: 3.250 Test Acc: 0.109
Validation loss decreased (-0.102320 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 0.4369494915008545
Epoch: 12, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.244 Vali Acc: 0.119 Test Loss: 3.244 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.47415685653686523
Epoch: 13, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.239 Vali Acc: 0.133 Test Loss: 3.239 Test Acc: 0.133
Validation loss decreased (-0.118791 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.4343843460083008
Epoch: 14, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.233 Vali Acc: 0.148 Test Loss: 3.233 Test Acc: 0.148
Validation loss decreased (-0.132909 --> -0.148203).  Saving model ...
Epoch: 15 cost time: 0.4512660503387451
Epoch: 15, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.237 Vali Acc: 0.149 Test Loss: 3.237 Test Acc: 0.149
Validation loss decreased (-0.148203 --> -0.149379).  Saving model ...
Epoch: 16 cost time: 0.46526193618774414
Epoch: 16, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.241 Vali Acc: 0.171 Test Loss: 3.241 Test Acc: 0.171
Validation loss decreased (-0.149379 --> -0.170556).  Saving model ...
Epoch: 17 cost time: 0.4765644073486328
Epoch: 17, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.247 Vali Acc: 0.179 Test Loss: 3.247 Test Acc: 0.179
Validation loss decreased (-0.170556 --> -0.178791).  Saving model ...
Epoch: 18 cost time: 0.4443337917327881
Epoch: 18, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.263 Vali Acc: 0.186 Test Loss: 3.263 Test Acc: 0.186
Validation loss decreased (-0.178791 --> -0.185850).  Saving model ...
Epoch: 19 cost time: 0.4389610290527344
Epoch: 19, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.273 Vali Acc: 0.193 Test Loss: 3.273 Test Acc: 0.193
Validation loss decreased (-0.185850 --> -0.192908).  Saving model ...
Epoch: 20 cost time: 0.4526350498199463
Epoch: 20, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.284 Vali Acc: 0.202 Test Loss: 3.284 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 21 cost time: 0.47600245475769043
Epoch: 21, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.305 Vali Acc: 0.207 Test Loss: 3.305 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207026).  Saving model ...
Epoch: 22 cost time: 0.4503054618835449
Epoch: 22, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.321 Vali Acc: 0.215 Test Loss: 3.321 Test Acc: 0.215
Validation loss decreased (-0.207026 --> -0.215261).  Saving model ...
Epoch: 23 cost time: 0.4471120834350586
Epoch: 23, Steps: 10 | Train Loss: 0.977 Vali Loss: 3.344 Vali Acc: 0.228 Test Loss: 3.344 Test Acc: 0.228
Validation loss decreased (-0.215261 --> -0.228202).  Saving model ...
Epoch: 24 cost time: 0.46349668502807617
Epoch: 24, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.366 Vali Acc: 0.229 Test Loss: 3.366 Test Acc: 0.229
Validation loss decreased (-0.228202 --> -0.229378).  Saving model ...
Epoch: 25 cost time: 0.4995546340942383
Epoch: 25, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.386 Vali Acc: 0.232 Test Loss: 3.386 Test Acc: 0.232
Validation loss decreased (-0.229378 --> -0.231731).  Saving model ...
Epoch: 26 cost time: 0.4296574592590332
Epoch: 26, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.420 Vali Acc: 0.236 Test Loss: 3.420 Test Acc: 0.236
Validation loss decreased (-0.231731 --> -0.236436).  Saving model ...
Epoch: 27 cost time: 0.45995259284973145
Epoch: 27, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.452 Vali Acc: 0.238 Test Loss: 3.452 Test Acc: 0.238
Validation loss decreased (-0.236436 --> -0.237613).  Saving model ...
Epoch: 28 cost time: 0.4693140983581543
Epoch: 28, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.475 Vali Acc: 0.241 Test Loss: 3.475 Test Acc: 0.241
Validation loss decreased (-0.237613 --> -0.241142).  Saving model ...
Epoch: 29 cost time: 0.48979902267456055
Epoch: 29, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.496 Vali Acc: 0.246 Test Loss: 3.496 Test Acc: 0.246
Validation loss decreased (-0.241142 --> -0.245847).  Saving model ...
Epoch: 30 cost time: 0.4362053871154785
Epoch: 30, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.506 Vali Acc: 0.248 Test Loss: 3.506 Test Acc: 0.248
Validation loss decreased (-0.245847 --> -0.248200).  Saving model ...
Epoch: 31 cost time: 0.45797061920166016
Epoch: 31, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.538 Vali Acc: 0.251 Test Loss: 3.538 Test Acc: 0.251
Validation loss decreased (-0.248200 --> -0.250553).  Saving model ...
Epoch: 32 cost time: 0.47182750701904297
Epoch: 32, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.585 Vali Acc: 0.246 Test Loss: 3.585 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5033860206604004
Epoch: 33, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.621 Vali Acc: 0.251 Test Loss: 3.621 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4425628185272217
Epoch: 34, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.641 Vali Acc: 0.251 Test Loss: 3.641 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.46564173698425293
Epoch: 35, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.655 Vali Acc: 0.249 Test Loss: 3.655 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.438584566116333
Epoch: 36, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.702 Vali Acc: 0.248 Test Loss: 3.702 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4590749740600586
Epoch: 37, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.740 Vali Acc: 0.252 Test Loss: 3.740 Test Acc: 0.252
Validation loss decreased (-0.250553 --> -0.251727).  Saving model ...
Epoch: 38 cost time: 0.4650309085845947
Epoch: 38, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.781 Vali Acc: 0.253 Test Loss: 3.781 Test Acc: 0.253
Validation loss decreased (-0.251727 --> -0.252903).  Saving model ...
Epoch: 39 cost time: 0.46417832374572754
Epoch: 39, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.785 Vali Acc: 0.252 Test Loss: 3.785 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.43625640869140625
Epoch: 40, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.792 Vali Acc: 0.251 Test Loss: 3.792 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4763014316558838
Epoch: 41, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.829 Vali Acc: 0.245 Test Loss: 3.829 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.44182300567626953
Epoch: 42, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.837 Vali Acc: 0.247 Test Loss: 3.837 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.506584644317627
Epoch: 43, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.852 Vali Acc: 0.247 Test Loss: 3.852 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.47471117973327637
Epoch: 44, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.872 Vali Acc: 0.253 Test Loss: 3.872 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4366493225097656
Epoch: 45, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.889 Vali Acc: 0.248 Test Loss: 3.889 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.4659888744354248
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.914 Vali Acc: 0.246 Test Loss: 3.914 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4770665168762207
Epoch: 47, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.926 Vali Acc: 0.248 Test Loss: 3.926 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.47417759895324707
Epoch: 48, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.950 Vali Acc: 0.248 Test Loss: 3.950 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 51802
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5876331329345703
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.377 Vali Acc: 0.034 Test Loss: 3.377 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4589390754699707
Epoch: 2, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.362 Vali Acc: 0.042 Test Loss: 3.362 Test Acc: 0.042
Validation loss decreased (-0.034084 --> -0.042319).  Saving model ...
Epoch: 3 cost time: 0.46671223640441895
Epoch: 3, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.349 Vali Acc: 0.044 Test Loss: 3.349 Test Acc: 0.044
Validation loss decreased (-0.042319 --> -0.043496).  Saving model ...
Epoch: 4 cost time: 0.46921610832214355
Epoch: 4, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.337 Vali Acc: 0.054 Test Loss: 3.337 Test Acc: 0.054
Validation loss decreased (-0.043496 --> -0.054084).  Saving model ...
Epoch: 5 cost time: 0.4938783645629883
Epoch: 5, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.325 Vali Acc: 0.069 Test Loss: 3.325 Test Acc: 0.069
Validation loss decreased (-0.054084 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.47780942916870117
Epoch: 6, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.314 Vali Acc: 0.075 Test Loss: 3.314 Test Acc: 0.075
Validation loss decreased (-0.069379 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.4592883586883545
Epoch: 7, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.307 Vali Acc: 0.080 Test Loss: 3.307 Test Acc: 0.080
Validation loss decreased (-0.075261 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 0.46024489402770996
Epoch: 8, Steps: 10 | Train Loss: 2.799 Vali Loss: 3.297 Vali Acc: 0.092 Test Loss: 3.297 Test Acc: 0.092
Validation loss decreased (-0.079967 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.4432942867279053
Epoch: 9, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.294 Vali Acc: 0.098 Test Loss: 3.294 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 10 cost time: 0.40465307235717773
Epoch: 10, Steps: 10 | Train Loss: 2.587 Vali Loss: 3.285 Vali Acc: 0.113 Test Loss: 3.285 Test Acc: 0.113
Validation loss decreased (-0.097614 --> -0.112908).  Saving model ...
Epoch: 11 cost time: 0.44522929191589355
Epoch: 11, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.276 Vali Acc: 0.120 Test Loss: 3.276 Test Acc: 0.120
Validation loss decreased (-0.112908 --> -0.119967).  Saving model ...
Epoch: 12 cost time: 0.46199989318847656
Epoch: 12, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.266 Vali Acc: 0.125 Test Loss: 3.266 Test Acc: 0.125
Validation loss decreased (-0.119967 --> -0.124673).  Saving model ...
Epoch: 13 cost time: 0.46999573707580566
Epoch: 13, Steps: 10 | Train Loss: 2.295 Vali Loss: 3.260 Vali Acc: 0.126 Test Loss: 3.260 Test Acc: 0.126
Validation loss decreased (-0.124673 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.46322107315063477
Epoch: 14, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.254 Vali Acc: 0.133 Test Loss: 3.254 Test Acc: 0.133
Validation loss decreased (-0.125850 --> -0.132909).  Saving model ...
Epoch: 15 cost time: 0.4753258228302002
Epoch: 15, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.246 Vali Acc: 0.141 Test Loss: 3.246 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141144).  Saving model ...
Epoch: 16 cost time: 0.45299530029296875
Epoch: 16, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.241 Vali Acc: 0.141 Test Loss: 3.241 Test Acc: 0.141
Validation loss decreased (-0.141144 --> -0.141144).  Saving model ...
Epoch: 17 cost time: 0.44615960121154785
Epoch: 17, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.249 Vali Acc: 0.146 Test Loss: 3.249 Test Acc: 0.146
Validation loss decreased (-0.141144 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.4573032855987549
Epoch: 18, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.244 Vali Acc: 0.162 Test Loss: 3.244 Test Acc: 0.162
Validation loss decreased (-0.145850 --> -0.162320).  Saving model ...
Epoch: 19 cost time: 0.4667510986328125
Epoch: 19, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.246 Vali Acc: 0.176 Test Loss: 3.246 Test Acc: 0.176
Validation loss decreased (-0.162320 --> -0.176438).  Saving model ...
Epoch: 20 cost time: 0.47304439544677734
Epoch: 20, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.257 Vali Acc: 0.179 Test Loss: 3.257 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 21 cost time: 0.448742151260376
Epoch: 21, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.263 Vali Acc: 0.185 Test Loss: 3.263 Test Acc: 0.185
Validation loss decreased (-0.178791 --> -0.184673).  Saving model ...
Epoch: 22 cost time: 0.4816877841949463
Epoch: 22, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.274 Vali Acc: 0.189 Test Loss: 3.274 Test Acc: 0.189
Validation loss decreased (-0.184673 --> -0.189379).  Saving model ...
Epoch: 23 cost time: 0.4805135726928711
Epoch: 23, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.285 Vali Acc: 0.193 Test Loss: 3.285 Test Acc: 0.193
Validation loss decreased (-0.189379 --> -0.192908).  Saving model ...
Epoch: 24 cost time: 0.48056721687316895
Epoch: 24, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.297 Vali Acc: 0.195 Test Loss: 3.297 Test Acc: 0.195
Validation loss decreased (-0.192908 --> -0.195261).  Saving model ...
Epoch: 25 cost time: 0.46366047859191895
Epoch: 25, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.306 Vali Acc: 0.204 Test Loss: 3.306 Test Acc: 0.204
Validation loss decreased (-0.195261 --> -0.203496).  Saving model ...
Epoch: 26 cost time: 0.5017495155334473
Epoch: 26, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.322 Vali Acc: 0.202 Test Loss: 3.322 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.45363521575927734
Epoch: 27, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.341 Vali Acc: 0.220 Test Loss: 3.341 Test Acc: 0.220
Validation loss decreased (-0.203496 --> -0.219967).  Saving model ...
Epoch: 28 cost time: 0.45923590660095215
Epoch: 28, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.365 Vali Acc: 0.218 Test Loss: 3.365 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.49836158752441406
Epoch: 29, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.388 Vali Acc: 0.220 Test Loss: 3.388 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4633066654205322
Epoch: 30, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.406 Vali Acc: 0.222 Test Loss: 3.406 Test Acc: 0.222
Validation loss decreased (-0.219967 --> -0.222319).  Saving model ...
Epoch: 31 cost time: 0.42855334281921387
Epoch: 31, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.432 Vali Acc: 0.225 Test Loss: 3.432 Test Acc: 0.225
Validation loss decreased (-0.222319 --> -0.224672).  Saving model ...
Epoch: 32 cost time: 0.4616563320159912
Epoch: 32, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.446 Vali Acc: 0.235 Test Loss: 3.446 Test Acc: 0.235
Validation loss decreased (-0.224672 --> -0.235260).  Saving model ...
Epoch: 33 cost time: 0.49321508407592773
Epoch: 33, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.474 Vali Acc: 0.231 Test Loss: 3.474 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5302443504333496
Epoch: 34, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.499 Vali Acc: 0.229 Test Loss: 3.499 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.45642709732055664
Epoch: 35, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.506 Vali Acc: 0.232 Test Loss: 3.506 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.45364832878112793
Epoch: 36, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.542 Vali Acc: 0.227 Test Loss: 3.542 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4396367073059082
Epoch: 37, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.570 Vali Acc: 0.231 Test Loss: 3.570 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.47009921073913574
Epoch: 38, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.580 Vali Acc: 0.231 Test Loss: 3.580 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4709322452545166
Epoch: 39, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.609 Vali Acc: 0.232 Test Loss: 3.609 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4846067428588867
Epoch: 40, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.618 Vali Acc: 0.228 Test Loss: 3.618 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.47135305404663086
Epoch: 41, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.641 Vali Acc: 0.227 Test Loss: 3.641 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.46369242668151855
Epoch: 42, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.679 Vali Acc: 0.225 Test Loss: 3.679 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 44570
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4593391418457031
Epoch: 1, Steps: 10 | Train Loss: 3.381 Vali Loss: 3.322 Vali Acc: 0.045 Test Loss: 3.322 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.47495174407958984
Epoch: 2, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.317 Vali Acc: 0.035 Test Loss: 3.317 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43120479583740234
Epoch: 3, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.313 Vali Acc: 0.040 Test Loss: 3.313 Test Acc: 0.040
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.508941650390625
Epoch: 4, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.304 Vali Acc: 0.044 Test Loss: 3.304 Test Acc: 0.044
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47292423248291016
Epoch: 5, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.297 Vali Acc: 0.054 Test Loss: 3.297 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 6 cost time: 0.45392322540283203
Epoch: 6, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.289 Vali Acc: 0.061 Test Loss: 3.289 Test Acc: 0.061
Validation loss decreased (-0.054085 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 0.4817328453063965
Epoch: 7, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.282 Vali Acc: 0.068 Test Loss: 3.282 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068202).  Saving model ...
Epoch: 8 cost time: 0.43708300590515137
Epoch: 8, Steps: 10 | Train Loss: 2.813 Vali Loss: 3.279 Vali Acc: 0.078 Test Loss: 3.279 Test Acc: 0.078
Validation loss decreased (-0.068202 --> -0.077614).  Saving model ...
Epoch: 9 cost time: 0.46750450134277344
Epoch: 9, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.276 Vali Acc: 0.089 Test Loss: 3.276 Test Acc: 0.089
Validation loss decreased (-0.077614 --> -0.089379).  Saving model ...
Epoch: 10 cost time: 0.4283573627471924
Epoch: 10, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.268 Vali Acc: 0.096 Test Loss: 3.268 Test Acc: 0.096
Validation loss decreased (-0.089379 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.46191906929016113
Epoch: 11, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.262 Vali Acc: 0.108 Test Loss: 3.262 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.45040178298950195
Epoch: 12, Steps: 10 | Train Loss: 2.452 Vali Loss: 3.254 Vali Acc: 0.118 Test Loss: 3.254 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.5171353816986084
Epoch: 13, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.251 Vali Acc: 0.126 Test Loss: 3.251 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.46552205085754395
Epoch: 14, Steps: 10 | Train Loss: 2.283 Vali Loss: 3.244 Vali Acc: 0.134 Test Loss: 3.244 Test Acc: 0.134
Validation loss decreased (-0.125850 --> -0.134085).  Saving model ...
Epoch: 15 cost time: 0.4847567081451416
Epoch: 15, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.238 Vali Acc: 0.136 Test Loss: 3.238 Test Acc: 0.136
Validation loss decreased (-0.134085 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.46728062629699707
Epoch: 16, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.231 Vali Acc: 0.155 Test Loss: 3.231 Test Acc: 0.155
Validation loss decreased (-0.136438 --> -0.155262).  Saving model ...
Epoch: 17 cost time: 0.47704100608825684
Epoch: 17, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.230 Vali Acc: 0.158 Test Loss: 3.230 Test Acc: 0.158
Validation loss decreased (-0.155262 --> -0.157615).  Saving model ...
Epoch: 18 cost time: 0.42052459716796875
Epoch: 18, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.233 Vali Acc: 0.165 Test Loss: 3.233 Test Acc: 0.165
Validation loss decreased (-0.157615 --> -0.164674).  Saving model ...
Epoch: 19 cost time: 0.47414255142211914
Epoch: 19, Steps: 10 | Train Loss: 1.765 Vali Loss: 3.239 Vali Acc: 0.169 Test Loss: 3.239 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169379).  Saving model ...
Epoch: 20 cost time: 0.46802496910095215
Epoch: 20, Steps: 10 | Train Loss: 1.707 Vali Loss: 3.240 Vali Acc: 0.184 Test Loss: 3.240 Test Acc: 0.184
Validation loss decreased (-0.169379 --> -0.183497).  Saving model ...
Epoch: 21 cost time: 0.4337763786315918
Epoch: 21, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.246 Vali Acc: 0.186 Test Loss: 3.246 Test Acc: 0.186
Validation loss decreased (-0.183497 --> -0.185850).  Saving model ...
Epoch: 22 cost time: 0.45217180252075195
Epoch: 22, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.252 Vali Acc: 0.191 Test Loss: 3.252 Test Acc: 0.191
Validation loss decreased (-0.185850 --> -0.190556).  Saving model ...
Epoch: 23 cost time: 0.46228694915771484
Epoch: 23, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.258 Vali Acc: 0.198 Test Loss: 3.258 Test Acc: 0.198
Validation loss decreased (-0.190556 --> -0.197614).  Saving model ...
Epoch: 24 cost time: 0.42505931854248047
Epoch: 24, Steps: 10 | Train Loss: 1.252 Vali Loss: 3.265 Vali Acc: 0.205 Test Loss: 3.265 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204673).  Saving model ...
Epoch: 25 cost time: 0.49212026596069336
Epoch: 25, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.281 Vali Acc: 0.207 Test Loss: 3.281 Test Acc: 0.207
Validation loss decreased (-0.204673 --> -0.207026).  Saving model ...
Epoch: 26 cost time: 0.44326281547546387
Epoch: 26, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.298 Vali Acc: 0.209 Test Loss: 3.298 Test Acc: 0.209
Validation loss decreased (-0.207026 --> -0.209379).  Saving model ...
Epoch: 27 cost time: 0.4397399425506592
Epoch: 27, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.314 Vali Acc: 0.209 Test Loss: 3.314 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.43592023849487305
Epoch: 28, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.328 Vali Acc: 0.214 Test Loss: 3.328 Test Acc: 0.214
Validation loss decreased (-0.209379 --> -0.214084).  Saving model ...
Epoch: 29 cost time: 0.4468991756439209
Epoch: 29, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.354 Vali Acc: 0.208 Test Loss: 3.354 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.46459269523620605
Epoch: 30, Steps: 10 | Train Loss: 0.830 Vali Loss: 3.372 Vali Acc: 0.214 Test Loss: 3.372 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.47411584854125977
Epoch: 31, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.397 Vali Acc: 0.216 Test Loss: 3.397 Test Acc: 0.216
Validation loss decreased (-0.214084 --> -0.216437).  Saving model ...
Epoch: 32 cost time: 0.44100427627563477
Epoch: 32, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.402 Vali Acc: 0.225 Test Loss: 3.402 Test Acc: 0.225
Validation loss decreased (-0.216437 --> -0.224672).  Saving model ...
Epoch: 33 cost time: 0.4475545883178711
Epoch: 33, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.415 Vali Acc: 0.229 Test Loss: 3.415 Test Acc: 0.229
Validation loss decreased (-0.224672 --> -0.229378).  Saving model ...
Epoch: 34 cost time: 0.5070159435272217
Epoch: 34, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.444 Vali Acc: 0.232 Test Loss: 3.444 Test Acc: 0.232
Validation loss decreased (-0.229378 --> -0.231730).  Saving model ...
Epoch: 35 cost time: 0.5287342071533203
Epoch: 35, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.468 Vali Acc: 0.231 Test Loss: 3.468 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47892284393310547
Epoch: 36, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.496 Vali Acc: 0.231 Test Loss: 3.496 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4589078426361084
Epoch: 37, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.508 Vali Acc: 0.241 Test Loss: 3.508 Test Acc: 0.241
Validation loss decreased (-0.231730 --> -0.241141).  Saving model ...
Epoch: 38 cost time: 0.5015902519226074
Epoch: 38, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.525 Vali Acc: 0.245 Test Loss: 3.525 Test Acc: 0.245
Validation loss decreased (-0.241141 --> -0.244671).  Saving model ...
Epoch: 39 cost time: 0.48336338996887207
Epoch: 39, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.545 Vali Acc: 0.244 Test Loss: 3.545 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4569270610809326
Epoch: 40, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.563 Vali Acc: 0.248 Test Loss: 3.563 Test Acc: 0.248
Validation loss decreased (-0.244671 --> -0.248200).  Saving model ...
Epoch: 41 cost time: 0.46910667419433594
Epoch: 41, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.578 Vali Acc: 0.247 Test Loss: 3.578 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4610416889190674
Epoch: 42, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.607 Vali Acc: 0.249 Test Loss: 3.607 Test Acc: 0.249
Validation loss decreased (-0.248200 --> -0.249376).  Saving model ...
Epoch: 43 cost time: 0.4839768409729004
Epoch: 43, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.623 Vali Acc: 0.251 Test Loss: 3.623 Test Acc: 0.251
Validation loss decreased (-0.249376 --> -0.250552).  Saving model ...
Epoch: 44 cost time: 0.4709951877593994
Epoch: 44, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.633 Vali Acc: 0.254 Test Loss: 3.633 Test Acc: 0.254
Validation loss decreased (-0.250552 --> -0.254081).  Saving model ...
Epoch: 45 cost time: 0.46755528450012207
Epoch: 45, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.649 Vali Acc: 0.259 Test Loss: 3.649 Test Acc: 0.259
Validation loss decreased (-0.254081 --> -0.258787).  Saving model ...
Epoch: 46 cost time: 0.47083330154418945
Epoch: 46, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.684 Vali Acc: 0.258 Test Loss: 3.684 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4654655456542969
Epoch: 47, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.704 Vali Acc: 0.258 Test Loss: 3.704 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.46027278900146484
Epoch: 48, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.733 Vali Acc: 0.253 Test Loss: 3.733 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.43045687675476074
Epoch: 49, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.739 Vali Acc: 0.251 Test Loss: 3.739 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.44458675384521484
Epoch: 50, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.735 Vali Acc: 0.253 Test Loss: 3.735 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.46646690368652344
Epoch: 51, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.752 Vali Acc: 0.255 Test Loss: 3.752 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.47446417808532715
Epoch: 52, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.767 Vali Acc: 0.256 Test Loss: 3.767 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.4819216728210449
Epoch: 53, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.777 Vali Acc: 0.264 Test Loss: 3.777 Test Acc: 0.264
Validation loss decreased (-0.258787 --> -0.263492).  Saving model ...
Epoch: 54 cost time: 0.4834878444671631
Epoch: 54, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.801 Vali Acc: 0.264 Test Loss: 3.801 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.46203160285949707
Epoch: 55, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.818 Vali Acc: 0.265 Test Loss: 3.818 Test Acc: 0.265
Validation loss decreased (-0.263492 --> -0.264668).  Saving model ...
Epoch: 56 cost time: 0.4970829486846924
Epoch: 56, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.835 Vali Acc: 0.262 Test Loss: 3.835 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4459216594696045
Epoch: 57, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.850 Vali Acc: 0.266 Test Loss: 3.850 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265844).  Saving model ...
Epoch: 58 cost time: 0.4782431125640869
Epoch: 58, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.851 Vali Acc: 0.262 Test Loss: 3.851 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.49355578422546387
Epoch: 59, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.862 Vali Acc: 0.265 Test Loss: 3.862 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.45865917205810547
Epoch: 60, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.867 Vali Acc: 0.264 Test Loss: 3.867 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5101337432861328
Epoch: 61, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.900 Vali Acc: 0.262 Test Loss: 3.900 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.44985198974609375
Epoch: 62, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.908 Vali Acc: 0.261 Test Loss: 3.908 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.4393899440765381
Epoch: 63, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.922 Vali Acc: 0.261 Test Loss: 3.922 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.5114364624023438
Epoch: 64, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.932 Vali Acc: 0.261 Test Loss: 3.932 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.4814267158508301
Epoch: 65, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.955 Vali Acc: 0.259 Test Loss: 3.955 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.487804651260376
Epoch: 66, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.969 Vali Acc: 0.259 Test Loss: 3.969 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.503394603729248
Epoch: 67, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.984 Vali Acc: 0.255 Test Loss: 3.984 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 42298
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5325121879577637
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.344 Vali Acc: 0.045 Test Loss: 3.344 Test Acc: 0.045
Validation loss decreased (inf --> -0.044672).  Saving model ...
Epoch: 2 cost time: 0.47041797637939453
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.388 Vali Acc: 0.047 Test Loss: 3.388 Test Acc: 0.047
Validation loss decreased (-0.044672 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.5040895938873291
Epoch: 3, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.339 Vali Acc: 0.098 Test Loss: 3.339 Test Acc: 0.098
Validation loss decreased (-0.047025 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.4524874687194824
Epoch: 4, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.293 Vali Acc: 0.125 Test Loss: 3.293 Test Acc: 0.125
Validation loss decreased (-0.097614 --> -0.124673).  Saving model ...
Epoch: 5 cost time: 0.46663475036621094
Epoch: 5, Steps: 10 | Train Loss: 2.294 Vali Loss: 3.245 Vali Acc: 0.151 Test Loss: 3.245 Test Acc: 0.151
Validation loss decreased (-0.124673 --> -0.150556).  Saving model ...
Epoch: 6 cost time: 0.4761202335357666
Epoch: 6, Steps: 10 | Train Loss: 1.913 Vali Loss: 3.232 Vali Acc: 0.154 Test Loss: 3.232 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154085).  Saving model ...
Epoch: 7 cost time: 0.5073940753936768
Epoch: 7, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.267 Vali Acc: 0.179 Test Loss: 3.267 Test Acc: 0.179
Validation loss decreased (-0.154085 --> -0.178791).  Saving model ...
Epoch: 8 cost time: 0.45773744583129883
Epoch: 8, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.308 Vali Acc: 0.195 Test Loss: 3.308 Test Acc: 0.195
Validation loss decreased (-0.178791 --> -0.195261).  Saving model ...
Epoch: 9 cost time: 0.48017263412475586
Epoch: 9, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.368 Vali Acc: 0.202 Test Loss: 3.368 Test Acc: 0.202
Validation loss decreased (-0.195261 --> -0.202319).  Saving model ...
Epoch: 10 cost time: 0.46433043479919434
Epoch: 10, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.367 Vali Acc: 0.233 Test Loss: 3.367 Test Acc: 0.233
Validation loss decreased (-0.202319 --> -0.232908).  Saving model ...
Epoch: 11 cost time: 0.4642930030822754
Epoch: 11, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.465 Vali Acc: 0.231 Test Loss: 3.465 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48220181465148926
Epoch: 12, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.597 Vali Acc: 0.235 Test Loss: 3.597 Test Acc: 0.235
Validation loss decreased (-0.232908 --> -0.235258).  Saving model ...
Epoch: 13 cost time: 0.4779801368713379
Epoch: 13, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.654 Vali Acc: 0.233 Test Loss: 3.654 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.47031712532043457
Epoch: 14, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.729 Vali Acc: 0.266 Test Loss: 3.729 Test Acc: 0.266
Validation loss decreased (-0.235258 --> -0.265845).  Saving model ...
Epoch: 15 cost time: 0.4875619411468506
Epoch: 15, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.867 Vali Acc: 0.245 Test Loss: 3.867 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.46234607696533203
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.935 Vali Acc: 0.259 Test Loss: 3.935 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4713010787963867
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.028 Vali Acc: 0.265 Test Loss: 4.028 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4694204330444336
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.110 Vali Acc: 0.262 Test Loss: 4.110 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4850623607635498
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.203 Vali Acc: 0.264 Test Loss: 4.203 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4927241802215576
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.250 Vali Acc: 0.268 Test Loss: 4.250 Test Acc: 0.268
Validation loss decreased (-0.265845 --> -0.268193).  Saving model ...
Epoch: 21 cost time: 0.4768862724304199
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.273 Vali Acc: 0.272 Test Loss: 4.273 Test Acc: 0.272
Validation loss decreased (-0.268193 --> -0.271722).  Saving model ...
Epoch: 22 cost time: 0.46722984313964844
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.292 Vali Acc: 0.268 Test Loss: 4.292 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.466477632522583
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.327 Vali Acc: 0.274 Test Loss: 4.327 Test Acc: 0.274
Validation loss decreased (-0.271722 --> -0.274074).  Saving model ...
Epoch: 24 cost time: 0.43698787689208984
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.391 Vali Acc: 0.273 Test Loss: 4.391 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4777398109436035
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.414 Vali Acc: 0.275 Test Loss: 4.414 Test Acc: 0.275
Validation loss decreased (-0.274074 --> -0.275250).  Saving model ...
Epoch: 26 cost time: 0.46745920181274414
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.440 Vali Acc: 0.273 Test Loss: 4.440 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4805738925933838
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.456 Vali Acc: 0.274 Test Loss: 4.456 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5326149463653564
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.486 Vali Acc: 0.273 Test Loss: 4.486 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.46482038497924805
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.504 Vali Acc: 0.275 Test Loss: 4.504 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.46523046493530273
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.526 Vali Acc: 0.269 Test Loss: 4.526 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.45592689514160156
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.553 Vali Acc: 0.273 Test Loss: 4.553 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.46834444999694824
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.571 Vali Acc: 0.278 Test Loss: 4.571 Test Acc: 0.278
Validation loss decreased (-0.275250 --> -0.277601).  Saving model ...
Epoch: 33 cost time: 0.4703786373138428
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.615 Vali Acc: 0.271 Test Loss: 4.615 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5235326290130615
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.653 Vali Acc: 0.271 Test Loss: 4.653 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4503614902496338
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.679 Vali Acc: 0.272 Test Loss: 4.679 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4630553722381592
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.695 Vali Acc: 0.271 Test Loss: 4.695 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.48343563079833984
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.710 Vali Acc: 0.275 Test Loss: 4.710 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5003671646118164
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.712 Vali Acc: 0.273 Test Loss: 4.712 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4724447727203369
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.724 Vali Acc: 0.269 Test Loss: 4.724 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4874553680419922
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.749 Vali Acc: 0.275 Test Loss: 4.749 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.44232726097106934
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.751 Vali Acc: 0.276 Test Loss: 4.751 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.49184203147888184
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.761 Vali Acc: 0.274 Test Loss: 4.761 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 202618
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4650318622589111
Epoch: 1, Steps: 10 | Train Loss: 3.476 Vali Loss: 3.378 Vali Acc: 0.041 Test Loss: 3.378 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.4796767234802246
Epoch: 2, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.333 Vali Acc: 0.054 Test Loss: 3.333 Test Acc: 0.054
Validation loss decreased (-0.041143 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.44301795959472656
Epoch: 3, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.335 Vali Acc: 0.071 Test Loss: 3.335 Test Acc: 0.071
Validation loss decreased (-0.054084 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.4838435649871826
Epoch: 4, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.331 Vali Acc: 0.084 Test Loss: 3.331 Test Acc: 0.084
Validation loss decreased (-0.070555 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.4634222984313965
Epoch: 5, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.311 Vali Acc: 0.099 Test Loss: 3.311 Test Acc: 0.099
Validation loss decreased (-0.083496 --> -0.098790).  Saving model ...
Epoch: 6 cost time: 0.4927351474761963
Epoch: 6, Steps: 10 | Train Loss: 2.434 Vali Loss: 3.288 Vali Acc: 0.111 Test Loss: 3.288 Test Acc: 0.111
Validation loss decreased (-0.098790 --> -0.110555).  Saving model ...
Epoch: 7 cost time: 0.4548497200012207
Epoch: 7, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.259 Vali Acc: 0.131 Test Loss: 3.259 Test Acc: 0.131
Validation loss decreased (-0.110555 --> -0.130556).  Saving model ...
Epoch: 8 cost time: 0.4556856155395508
Epoch: 8, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.256 Vali Acc: 0.144 Test Loss: 3.256 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143497).  Saving model ...
Epoch: 9 cost time: 0.4283487796783447
Epoch: 9, Steps: 10 | Train Loss: 1.722 Vali Loss: 3.254 Vali Acc: 0.164 Test Loss: 3.254 Test Acc: 0.164
Validation loss decreased (-0.143497 --> -0.163497).  Saving model ...
Epoch: 10 cost time: 0.4683518409729004
Epoch: 10, Steps: 10 | Train Loss: 1.516 Vali Loss: 3.272 Vali Acc: 0.168 Test Loss: 3.272 Test Acc: 0.168
Validation loss decreased (-0.163497 --> -0.168203).  Saving model ...
Epoch: 11 cost time: 0.48503637313842773
Epoch: 11, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.352 Vali Acc: 0.178 Test Loss: 3.352 Test Acc: 0.178
Validation loss decreased (-0.168203 --> -0.177614).  Saving model ...
Epoch: 12 cost time: 0.44135594367980957
Epoch: 12, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.363 Vali Acc: 0.194 Test Loss: 3.363 Test Acc: 0.194
Validation loss decreased (-0.177614 --> -0.194084).  Saving model ...
Epoch: 13 cost time: 0.4528830051422119
Epoch: 13, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.420 Vali Acc: 0.188 Test Loss: 3.420 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.42927074432373047
Epoch: 14, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.459 Vali Acc: 0.207 Test Loss: 3.459 Test Acc: 0.207
Validation loss decreased (-0.194084 --> -0.207024).  Saving model ...
Epoch: 15 cost time: 0.41425013542175293
Epoch: 15, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.495 Vali Acc: 0.206 Test Loss: 3.495 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.45909547805786133
Epoch: 16, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.525 Vali Acc: 0.241 Test Loss: 3.525 Test Acc: 0.241
Validation loss decreased (-0.207024 --> -0.241141).  Saving model ...
Epoch: 17 cost time: 0.44452977180480957
Epoch: 17, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.596 Vali Acc: 0.224 Test Loss: 3.596 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4857308864593506
Epoch: 18, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.652 Vali Acc: 0.239 Test Loss: 3.652 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4577791690826416
Epoch: 19, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.726 Vali Acc: 0.246 Test Loss: 3.726 Test Acc: 0.246
Validation loss decreased (-0.241141 --> -0.245845).  Saving model ...
Epoch: 20 cost time: 0.46925973892211914
Epoch: 20, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.820 Vali Acc: 0.238 Test Loss: 3.820 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4535105228424072
Epoch: 21, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.860 Vali Acc: 0.258 Test Loss: 3.860 Test Acc: 0.258
Validation loss decreased (-0.245845 --> -0.257608).  Saving model ...
Epoch: 22 cost time: 0.4703552722930908
Epoch: 22, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.918 Vali Acc: 0.244 Test Loss: 3.918 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4714531898498535
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.935 Vali Acc: 0.252 Test Loss: 3.935 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4759542942047119
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.015 Vali Acc: 0.252 Test Loss: 4.015 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5016317367553711
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.055 Vali Acc: 0.252 Test Loss: 4.055 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4990675449371338
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.070 Vali Acc: 0.255 Test Loss: 4.070 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4430985450744629
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.091 Vali Acc: 0.268 Test Loss: 4.091 Test Acc: 0.268
Validation loss decreased (-0.257608 --> -0.268194).  Saving model ...
Epoch: 28 cost time: 0.4796137809753418
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.166 Vali Acc: 0.265 Test Loss: 4.166 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5028567314147949
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.224 Vali Acc: 0.265 Test Loss: 4.224 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.47257447242736816
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.243 Vali Acc: 0.260 Test Loss: 4.243 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.49447202682495117
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.249 Vali Acc: 0.262 Test Loss: 4.249 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.47040700912475586
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.260 Vali Acc: 0.261 Test Loss: 4.260 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.47964930534362793
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.283 Vali Acc: 0.261 Test Loss: 4.283 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4704561233520508
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.302 Vali Acc: 0.260 Test Loss: 4.302 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4743800163269043
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.324 Vali Acc: 0.261 Test Loss: 4.324 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4784729480743408
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.349 Vali Acc: 0.261 Test Loss: 4.349 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.49459409713745117
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.357 Vali Acc: 0.271 Test Loss: 4.357 Test Acc: 0.271
Validation loss decreased (-0.268194 --> -0.270545).  Saving model ...
Epoch: 38 cost time: 0.5501689910888672
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.392 Vali Acc: 0.274 Test Loss: 4.392 Test Acc: 0.274
Validation loss decreased (-0.270545 --> -0.274074).  Saving model ...
Epoch: 39 cost time: 0.483309268951416
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.416 Vali Acc: 0.276 Test Loss: 4.416 Test Acc: 0.276
Validation loss decreased (-0.274074 --> -0.276426).  Saving model ...
Epoch: 40 cost time: 0.5155107975006104
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.422 Vali Acc: 0.276 Test Loss: 4.422 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4596860408782959
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.434 Vali Acc: 0.278 Test Loss: 4.434 Test Acc: 0.278
Validation loss decreased (-0.276426 --> -0.277603).  Saving model ...
Epoch: 42 cost time: 0.49452805519104004
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.461 Vali Acc: 0.281 Test Loss: 4.461 Test Acc: 0.281
Validation loss decreased (-0.277603 --> -0.281132).  Saving model ...
Epoch: 43 cost time: 0.43901658058166504
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.481 Vali Acc: 0.276 Test Loss: 4.481 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5547916889190674
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.490 Vali Acc: 0.281 Test Loss: 4.490 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.48311567306518555
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.510 Vali Acc: 0.274 Test Loss: 4.510 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.45444488525390625
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.521 Vali Acc: 0.278 Test Loss: 4.521 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.46127915382385254
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.527 Vali Acc: 0.278 Test Loss: 4.527 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.452195405960083
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.539 Vali Acc: 0.275 Test Loss: 4.539 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5447249412536621
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.556 Vali Acc: 0.280 Test Loss: 4.556 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.47885727882385254
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.558 Vali Acc: 0.276 Test Loss: 4.558 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.4893651008605957
Epoch: 51, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.574 Vali Acc: 0.274 Test Loss: 4.574 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.4863870143890381
Epoch: 52, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.589 Vali Acc: 0.282 Test Loss: 4.589 Test Acc: 0.282
Validation loss decreased (-0.281132 --> -0.282307).  Saving model ...
Epoch: 53 cost time: 0.4621694087982178
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.601 Vali Acc: 0.285 Test Loss: 4.601 Test Acc: 0.285
Validation loss decreased (-0.282307 --> -0.284660).  Saving model ...
Epoch: 54 cost time: 0.48739051818847656
Epoch: 54, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.284 Test Loss: 4.610 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.48470211029052734
Epoch: 55, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.630 Vali Acc: 0.284 Test Loss: 4.630 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.469710111618042
Epoch: 56, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.638 Vali Acc: 0.281 Test Loss: 4.638 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5224072933197021
Epoch: 57, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.645 Vali Acc: 0.287 Test Loss: 4.645 Test Acc: 0.287
Validation loss decreased (-0.284660 --> -0.287012).  Saving model ...
Epoch: 58 cost time: 0.4834482669830322
Epoch: 58, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.660 Vali Acc: 0.285 Test Loss: 4.660 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.48347926139831543
Epoch: 59, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.668 Vali Acc: 0.285 Test Loss: 4.668 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.4346432685852051
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.684 Vali Acc: 0.281 Test Loss: 4.684 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.4833102226257324
Epoch: 61, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.700 Vali Acc: 0.284 Test Loss: 4.700 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.4402177333831787
Epoch: 62, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.713 Vali Acc: 0.284 Test Loss: 4.713 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.4511075019836426
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.721 Vali Acc: 0.279 Test Loss: 4.721 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.44614434242248535
Epoch: 64, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.733 Vali Acc: 0.278 Test Loss: 4.733 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.49813008308410645
Epoch: 65, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.757 Vali Acc: 0.279 Test Loss: 4.757 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5101890563964844
Epoch: 66, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.758 Vali Acc: 0.281 Test Loss: 4.758 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.4430220127105713
Epoch: 67, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.760 Vali Acc: 0.285 Test Loss: 4.760 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 107898
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5023472309112549
Epoch: 1, Steps: 10 | Train Loss: 3.506 Vali Loss: 3.351 Vali Acc: 0.032 Test Loss: 3.351 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.47927427291870117
Epoch: 2, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.326 Vali Acc: 0.036 Test Loss: 3.326 Test Acc: 0.036
Validation loss decreased (-0.031731 --> -0.036437).  Saving model ...
Epoch: 3 cost time: 0.5287914276123047
Epoch: 3, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.327 Vali Acc: 0.046 Test Loss: 3.327 Test Acc: 0.046
Validation loss decreased (-0.036437 --> -0.045849).  Saving model ...
Epoch: 4 cost time: 0.47701001167297363
Epoch: 4, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.319 Vali Acc: 0.065 Test Loss: 3.319 Test Acc: 0.065
Validation loss decreased (-0.045849 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.41405272483825684
Epoch: 5, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.313 Vali Acc: 0.073 Test Loss: 3.313 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072908).  Saving model ...
Epoch: 6 cost time: 0.4758329391479492
Epoch: 6, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.295 Vali Acc: 0.084 Test Loss: 3.295 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083496).  Saving model ...
Epoch: 7 cost time: 0.46769261360168457
Epoch: 7, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.258 Vali Acc: 0.102 Test Loss: 3.258 Test Acc: 0.102
Validation loss decreased (-0.083496 --> -0.102320).  Saving model ...
Epoch: 8 cost time: 0.4732232093811035
Epoch: 8, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.243 Vali Acc: 0.108 Test Loss: 3.243 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.45800232887268066
Epoch: 9, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.230 Vali Acc: 0.129 Test Loss: 3.230 Test Acc: 0.129
Validation loss decreased (-0.108203 --> -0.129379).  Saving model ...
Epoch: 10 cost time: 0.4534311294555664
Epoch: 10, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.212 Vali Acc: 0.144 Test Loss: 3.212 Test Acc: 0.144
Validation loss decreased (-0.129379 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 0.4744396209716797
Epoch: 11, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.215 Vali Acc: 0.151 Test Loss: 3.215 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 12 cost time: 0.4239659309387207
Epoch: 12, Steps: 10 | Train Loss: 1.578 Vali Loss: 3.231 Vali Acc: 0.162 Test Loss: 3.231 Test Acc: 0.162
Validation loss decreased (-0.150556 --> -0.162321).  Saving model ...
Epoch: 13 cost time: 0.4830667972564697
Epoch: 13, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.235 Vali Acc: 0.164 Test Loss: 3.235 Test Acc: 0.164
Validation loss decreased (-0.162321 --> -0.163497).  Saving model ...
Epoch: 14 cost time: 0.46404576301574707
Epoch: 14, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.227 Vali Acc: 0.188 Test Loss: 3.227 Test Acc: 0.188
Validation loss decreased (-0.163497 --> -0.188203).  Saving model ...
Epoch: 15 cost time: 0.47327661514282227
Epoch: 15, Steps: 10 | Train Loss: 1.107 Vali Loss: 3.256 Vali Acc: 0.184 Test Loss: 3.256 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4435584545135498
Epoch: 16, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.278 Vali Acc: 0.194 Test Loss: 3.278 Test Acc: 0.194
Validation loss decreased (-0.188203 --> -0.194085).  Saving model ...
Epoch: 17 cost time: 0.4463486671447754
Epoch: 17, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.301 Vali Acc: 0.216 Test Loss: 3.301 Test Acc: 0.216
Validation loss decreased (-0.194085 --> -0.216438).  Saving model ...
Epoch: 18 cost time: 0.4498558044433594
Epoch: 18, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.330 Vali Acc: 0.227 Test Loss: 3.330 Test Acc: 0.227
Validation loss decreased (-0.216438 --> -0.227026).  Saving model ...
Epoch: 19 cost time: 0.5051243305206299
Epoch: 19, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.393 Vali Acc: 0.225 Test Loss: 3.393 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4443047046661377
Epoch: 20, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.455 Vali Acc: 0.233 Test Loss: 3.455 Test Acc: 0.233
Validation loss decreased (-0.227026 --> -0.232907).  Saving model ...
Epoch: 21 cost time: 0.49027276039123535
Epoch: 21, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.469 Vali Acc: 0.240 Test Loss: 3.469 Test Acc: 0.240
Validation loss decreased (-0.232907 --> -0.239965).  Saving model ...
Epoch: 22 cost time: 0.45269250869750977
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.500 Vali Acc: 0.253 Test Loss: 3.500 Test Acc: 0.253
Validation loss decreased (-0.239965 --> -0.252906).  Saving model ...
Epoch: 23 cost time: 0.4575464725494385
Epoch: 23, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.556 Vali Acc: 0.255 Test Loss: 3.556 Test Acc: 0.255
Validation loss decreased (-0.252906 --> -0.255259).  Saving model ...
Epoch: 24 cost time: 0.4442939758300781
Epoch: 24, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.604 Vali Acc: 0.264 Test Loss: 3.604 Test Acc: 0.264
Validation loss decreased (-0.255259 --> -0.263493).  Saving model ...
Epoch: 25 cost time: 0.4687976837158203
Epoch: 25, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.678 Vali Acc: 0.264 Test Loss: 3.678 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4288637638092041
Epoch: 26, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.743 Vali Acc: 0.256 Test Loss: 3.743 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4784269332885742
Epoch: 27, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.765 Vali Acc: 0.262 Test Loss: 3.765 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4393577575683594
Epoch: 28, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.791 Vali Acc: 0.260 Test Loss: 3.791 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.47086501121520996
Epoch: 29, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.818 Vali Acc: 0.264 Test Loss: 3.818 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4310781955718994
Epoch: 30, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.866 Vali Acc: 0.259 Test Loss: 3.866 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4803917407989502
Epoch: 31, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.931 Vali Acc: 0.259 Test Loss: 3.931 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.47557854652404785
Epoch: 32, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.945 Vali Acc: 0.262 Test Loss: 3.945 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5016746520996094
Epoch: 33, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.954 Vali Acc: 0.268 Test Loss: 3.954 Test Acc: 0.268
Validation loss decreased (-0.263493 --> -0.268196).  Saving model ...
Epoch: 34 cost time: 0.46129679679870605
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.977 Vali Acc: 0.261 Test Loss: 3.977 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4820575714111328
Epoch: 35, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.013 Vali Acc: 0.260 Test Loss: 4.013 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4598221778869629
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.057 Vali Acc: 0.266 Test Loss: 4.057 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4735579490661621
Epoch: 37, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.069 Vali Acc: 0.266 Test Loss: 4.069 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.45127272605895996
Epoch: 38, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.091 Vali Acc: 0.262 Test Loss: 4.091 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.47321414947509766
Epoch: 39, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.130 Vali Acc: 0.260 Test Loss: 4.130 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4651474952697754
Epoch: 40, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.133 Vali Acc: 0.261 Test Loss: 4.133 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4779801368713379
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.139 Vali Acc: 0.265 Test Loss: 4.139 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4324760437011719
Epoch: 42, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.166 Vali Acc: 0.267 Test Loss: 4.166 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4529557228088379
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.183 Vali Acc: 0.266 Test Loss: 4.183 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 75578
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6531550884246826
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.321 Vali Acc: 0.055 Test Loss: 3.321 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.46370911598205566
Epoch: 2, Steps: 10 | Train Loss: 3.353 Vali Loss: 3.308 Vali Acc: 0.049 Test Loss: 3.308 Test Acc: 0.049
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43291425704956055
Epoch: 3, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.295 Vali Acc: 0.056 Test Loss: 3.295 Test Acc: 0.056
Validation loss decreased (-0.055261 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 0.4879641532897949
Epoch: 4, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.290 Vali Acc: 0.075 Test Loss: 3.290 Test Acc: 0.075
Validation loss decreased (-0.056438 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.4314267635345459
Epoch: 5, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.292 Vali Acc: 0.085 Test Loss: 3.292 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.44857263565063477
Epoch: 6, Steps: 10 | Train Loss: 2.757 Vali Loss: 3.285 Vali Acc: 0.095 Test Loss: 3.285 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095261).  Saving model ...
Epoch: 7 cost time: 0.46123480796813965
Epoch: 7, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.272 Vali Acc: 0.104 Test Loss: 3.272 Test Acc: 0.104
Validation loss decreased (-0.095261 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.5485293865203857
Epoch: 8, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.252 Vali Acc: 0.107 Test Loss: 3.252 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 0.451052188873291
Epoch: 9, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.242 Vali Acc: 0.121 Test Loss: 3.242 Test Acc: 0.121
Validation loss decreased (-0.107026 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.5151939392089844
Epoch: 10, Steps: 10 | Train Loss: 2.205 Vali Loss: 3.223 Vali Acc: 0.129 Test Loss: 3.223 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 11 cost time: 0.5277235507965088
Epoch: 11, Steps: 10 | Train Loss: 2.026 Vali Loss: 3.233 Vali Acc: 0.138 Test Loss: 3.233 Test Acc: 0.138
Validation loss decreased (-0.129380 --> -0.137615).  Saving model ...
Epoch: 12 cost time: 0.48253464698791504
Epoch: 12, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.222 Vali Acc: 0.149 Test Loss: 3.222 Test Acc: 0.149
Validation loss decreased (-0.137615 --> -0.149380).  Saving model ...
Epoch: 13 cost time: 0.5329174995422363
Epoch: 13, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.230 Vali Acc: 0.152 Test Loss: 3.230 Test Acc: 0.152
Validation loss decreased (-0.149380 --> -0.151732).  Saving model ...
Epoch: 14 cost time: 0.46938276290893555
Epoch: 14, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.233 Vali Acc: 0.168 Test Loss: 3.233 Test Acc: 0.168
Validation loss decreased (-0.151732 --> -0.168203).  Saving model ...
Epoch: 15 cost time: 0.5058281421661377
Epoch: 15, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.245 Vali Acc: 0.184 Test Loss: 3.245 Test Acc: 0.184
Validation loss decreased (-0.168203 --> -0.183497).  Saving model ...
Epoch: 16 cost time: 0.5433464050292969
Epoch: 16, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.264 Vali Acc: 0.188 Test Loss: 3.264 Test Acc: 0.188
Validation loss decreased (-0.183497 --> -0.188203).  Saving model ...
Epoch: 17 cost time: 0.5263936519622803
Epoch: 17, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.283 Vali Acc: 0.199 Test Loss: 3.283 Test Acc: 0.199
Validation loss decreased (-0.188203 --> -0.198791).  Saving model ...
Epoch: 18 cost time: 0.5217444896697998
Epoch: 18, Steps: 10 | Train Loss: 1.027 Vali Loss: 3.321 Vali Acc: 0.204 Test Loss: 3.321 Test Acc: 0.204
Validation loss decreased (-0.198791 --> -0.203496).  Saving model ...
Epoch: 19 cost time: 0.49978160858154297
Epoch: 19, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.342 Vali Acc: 0.209 Test Loss: 3.342 Test Acc: 0.209
Validation loss decreased (-0.203496 --> -0.209378).  Saving model ...
Epoch: 20 cost time: 0.5067946910858154
Epoch: 20, Steps: 10 | Train Loss: 0.840 Vali Loss: 3.369 Vali Acc: 0.226 Test Loss: 3.369 Test Acc: 0.226
Validation loss decreased (-0.209378 --> -0.225849).  Saving model ...
Epoch: 21 cost time: 0.5304908752441406
Epoch: 21, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.410 Vali Acc: 0.220 Test Loss: 3.410 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5284931659698486
Epoch: 22, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.465 Vali Acc: 0.235 Test Loss: 3.465 Test Acc: 0.235
Validation loss decreased (-0.225849 --> -0.235259).  Saving model ...
Epoch: 23 cost time: 0.4573945999145508
Epoch: 23, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.481 Vali Acc: 0.241 Test Loss: 3.481 Test Acc: 0.241
Validation loss decreased (-0.235259 --> -0.241142).  Saving model ...
Epoch: 24 cost time: 0.43761682510375977
Epoch: 24, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.509 Vali Acc: 0.251 Test Loss: 3.509 Test Acc: 0.251
Validation loss decreased (-0.241142 --> -0.250553).  Saving model ...
Epoch: 25 cost time: 0.4402658939361572
Epoch: 25, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.567 Vali Acc: 0.247 Test Loss: 3.567 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4956662654876709
Epoch: 26, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.591 Vali Acc: 0.256 Test Loss: 3.591 Test Acc: 0.256
Validation loss decreased (-0.250553 --> -0.256435).  Saving model ...
Epoch: 27 cost time: 0.5045347213745117
Epoch: 27, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.653 Vali Acc: 0.253 Test Loss: 3.653 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5127353668212891
Epoch: 28, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.697 Vali Acc: 0.265 Test Loss: 3.697 Test Acc: 0.265
Validation loss decreased (-0.256435 --> -0.264669).  Saving model ...
Epoch: 29 cost time: 0.5166490077972412
Epoch: 29, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.735 Vali Acc: 0.265 Test Loss: 3.735 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5018463134765625
Epoch: 30, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.751 Vali Acc: 0.266 Test Loss: 3.751 Test Acc: 0.266
Validation loss decreased (-0.264669 --> -0.265845).  Saving model ...
Epoch: 31 cost time: 0.4946887493133545
Epoch: 31, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.787 Vali Acc: 0.262 Test Loss: 3.787 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4537653923034668
Epoch: 32, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.836 Vali Acc: 0.261 Test Loss: 3.836 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5249497890472412
Epoch: 33, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.879 Vali Acc: 0.266 Test Loss: 3.879 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5160422325134277
Epoch: 34, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.929 Vali Acc: 0.261 Test Loss: 3.929 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.503382682800293
Epoch: 35, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.947 Vali Acc: 0.268 Test Loss: 3.947 Test Acc: 0.268
Validation loss decreased (-0.265845 --> -0.268196).  Saving model ...
Epoch: 36 cost time: 0.4493246078491211
Epoch: 36, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.973 Vali Acc: 0.271 Test Loss: 3.973 Test Acc: 0.271
Validation loss decreased (-0.268196 --> -0.270549).  Saving model ...
Epoch: 37 cost time: 0.4568150043487549
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.010 Vali Acc: 0.269 Test Loss: 4.010 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4592711925506592
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.031 Vali Acc: 0.274 Test Loss: 4.031 Test Acc: 0.274
Validation loss decreased (-0.270549 --> -0.274077).  Saving model ...
Epoch: 39 cost time: 0.4264397621154785
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.067 Vali Acc: 0.266 Test Loss: 4.067 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.48221921920776367
Epoch: 40, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.101 Vali Acc: 0.259 Test Loss: 4.101 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5179271697998047
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.107 Vali Acc: 0.268 Test Loss: 4.107 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5240833759307861
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.119 Vali Acc: 0.271 Test Loss: 4.119 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5249640941619873
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.144 Vali Acc: 0.269 Test Loss: 4.144 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5499715805053711
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.197 Vali Acc: 0.265 Test Loss: 4.197 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5258593559265137
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.203 Vali Acc: 0.261 Test Loss: 4.203 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5157177448272705
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.202 Vali Acc: 0.271 Test Loss: 4.202 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.49726152420043945
Epoch: 47, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.244 Vali Acc: 0.267 Test Loss: 4.244 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.500429630279541
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.253 Vali Acc: 0.264 Test Loss: 4.253 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 60730
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4621326923370361
Epoch: 1, Steps: 10 | Train Loss: 3.431 Vali Loss: 3.366 Vali Acc: 0.049 Test Loss: 3.366 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.47449827194213867
Epoch: 2, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.347 Vali Acc: 0.044 Test Loss: 3.347 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4669501781463623
Epoch: 3, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.325 Vali Acc: 0.048 Test Loss: 3.325 Test Acc: 0.048
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.47246289253234863
Epoch: 4, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.308 Vali Acc: 0.061 Test Loss: 3.308 Test Acc: 0.061
Validation loss decreased (-0.049378 --> -0.061143).  Saving model ...
Epoch: 5 cost time: 0.4996805191040039
Epoch: 5, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.293 Vali Acc: 0.068 Test Loss: 3.293 Test Acc: 0.068
Validation loss decreased (-0.061143 --> -0.068202).  Saving model ...
Epoch: 6 cost time: 0.48458313941955566
Epoch: 6, Steps: 10 | Train Loss: 2.954 Vali Loss: 3.277 Vali Acc: 0.081 Test Loss: 3.277 Test Acc: 0.081
Validation loss decreased (-0.068202 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.4505429267883301
Epoch: 7, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.267 Vali Acc: 0.093 Test Loss: 3.267 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.4729142189025879
Epoch: 8, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.261 Vali Acc: 0.091 Test Loss: 3.261 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4613196849822998
Epoch: 9, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.257 Vali Acc: 0.106 Test Loss: 3.257 Test Acc: 0.106
Validation loss decreased (-0.092909 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 0.48975133895874023
Epoch: 10, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.249 Vali Acc: 0.115 Test Loss: 3.249 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 0.5281283855438232
Epoch: 11, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.244 Vali Acc: 0.125 Test Loss: 3.244 Test Acc: 0.125
Validation loss decreased (-0.115262 --> -0.124673).  Saving model ...
Epoch: 12 cost time: 0.47745418548583984
Epoch: 12, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.235 Vali Acc: 0.129 Test Loss: 3.235 Test Acc: 0.129
Validation loss decreased (-0.124673 --> -0.129379).  Saving model ...
Epoch: 13 cost time: 0.471221923828125
Epoch: 13, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.234 Vali Acc: 0.139 Test Loss: 3.234 Test Acc: 0.139
Validation loss decreased (-0.129379 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 0.49791526794433594
Epoch: 14, Steps: 10 | Train Loss: 1.974 Vali Loss: 3.237 Vali Acc: 0.145 Test Loss: 3.237 Test Acc: 0.145
Validation loss decreased (-0.138791 --> -0.144674).  Saving model ...
Epoch: 15 cost time: 0.5162777900695801
Epoch: 15, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.234 Vali Acc: 0.158 Test Loss: 3.234 Test Acc: 0.158
Validation loss decreased (-0.144674 --> -0.157615).  Saving model ...
Epoch: 16 cost time: 0.5369038581848145
Epoch: 16, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.235 Vali Acc: 0.171 Test Loss: 3.235 Test Acc: 0.171
Validation loss decreased (-0.157615 --> -0.170556).  Saving model ...
Epoch: 17 cost time: 0.5163822174072266
Epoch: 17, Steps: 10 | Train Loss: 1.612 Vali Loss: 3.248 Vali Acc: 0.167 Test Loss: 3.248 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.49964284896850586
Epoch: 18, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.263 Vali Acc: 0.174 Test Loss: 3.263 Test Acc: 0.174
Validation loss decreased (-0.170556 --> -0.174085).  Saving model ...
Epoch: 19 cost time: 0.5110170841217041
Epoch: 19, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.275 Vali Acc: 0.180 Test Loss: 3.275 Test Acc: 0.180
Validation loss decreased (-0.174085 --> -0.179967).  Saving model ...
Epoch: 20 cost time: 0.5140719413757324
Epoch: 20, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.295 Vali Acc: 0.188 Test Loss: 3.295 Test Acc: 0.188
Validation loss decreased (-0.179967 --> -0.188202).  Saving model ...
Epoch: 21 cost time: 0.48044872283935547
Epoch: 21, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.310 Vali Acc: 0.186 Test Loss: 3.310 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5308442115783691
Epoch: 22, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.323 Vali Acc: 0.192 Test Loss: 3.323 Test Acc: 0.192
Validation loss decreased (-0.188202 --> -0.191731).  Saving model ...
Epoch: 23 cost time: 0.5482790470123291
Epoch: 23, Steps: 10 | Train Loss: 0.988 Vali Loss: 3.352 Vali Acc: 0.192 Test Loss: 3.352 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.49924135208129883
Epoch: 24, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.378 Vali Acc: 0.202 Test Loss: 3.378 Test Acc: 0.202
Validation loss decreased (-0.191731 --> -0.202319).  Saving model ...
Epoch: 25 cost time: 0.5564289093017578
Epoch: 25, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.407 Vali Acc: 0.205 Test Loss: 3.407 Test Acc: 0.205
Validation loss decreased (-0.202319 --> -0.204672).  Saving model ...
Epoch: 26 cost time: 0.5223338603973389
Epoch: 26, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.435 Vali Acc: 0.208 Test Loss: 3.435 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208201).  Saving model ...
Epoch: 27 cost time: 0.5174310207366943
Epoch: 27, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.463 Vali Acc: 0.218 Test Loss: 3.463 Test Acc: 0.218
Validation loss decreased (-0.208201 --> -0.217612).  Saving model ...
Epoch: 28 cost time: 0.5148248672485352
Epoch: 28, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.495 Vali Acc: 0.229 Test Loss: 3.495 Test Acc: 0.229
Validation loss decreased (-0.217612 --> -0.229377).  Saving model ...
Epoch: 29 cost time: 0.5131592750549316
Epoch: 29, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.530 Vali Acc: 0.232 Test Loss: 3.530 Test Acc: 0.232
Validation loss decreased (-0.229377 --> -0.231729).  Saving model ...
Epoch: 30 cost time: 0.49676084518432617
Epoch: 30, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.568 Vali Acc: 0.232 Test Loss: 3.568 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5309309959411621
Epoch: 31, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.589 Vali Acc: 0.238 Test Loss: 3.589 Test Acc: 0.238
Validation loss decreased (-0.231729 --> -0.237611).  Saving model ...
Epoch: 32 cost time: 0.531646728515625
Epoch: 32, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.605 Vali Acc: 0.240 Test Loss: 3.605 Test Acc: 0.240
Validation loss decreased (-0.237611 --> -0.239964).  Saving model ...
Epoch: 33 cost time: 0.5133645534515381
Epoch: 33, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.631 Vali Acc: 0.231 Test Loss: 3.631 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5189254283905029
Epoch: 34, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.660 Vali Acc: 0.236 Test Loss: 3.660 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5075879096984863
Epoch: 35, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.703 Vali Acc: 0.238 Test Loss: 3.703 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5304062366485596
Epoch: 36, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.736 Vali Acc: 0.241 Test Loss: 3.736 Test Acc: 0.241
Validation loss decreased (-0.239964 --> -0.241139).  Saving model ...
Epoch: 37 cost time: 0.5193262100219727
Epoch: 37, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.762 Vali Acc: 0.242 Test Loss: 3.762 Test Acc: 0.242
Validation loss decreased (-0.241139 --> -0.242315).  Saving model ...
Epoch: 38 cost time: 0.5154666900634766
Epoch: 38, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.797 Vali Acc: 0.241 Test Loss: 3.797 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5261631011962891
Epoch: 39, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.832 Vali Acc: 0.238 Test Loss: 3.832 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4522426128387451
Epoch: 40, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.834 Vali Acc: 0.241 Test Loss: 3.834 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4266042709350586
Epoch: 41, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.848 Vali Acc: 0.241 Test Loss: 3.848 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5608458518981934
Epoch: 42, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.873 Vali Acc: 0.242 Test Loss: 3.873 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5139012336730957
Epoch: 43, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.899 Vali Acc: 0.244 Test Loss: 3.899 Test Acc: 0.244
Validation loss decreased (-0.242315 --> -0.243490).  Saving model ...
Epoch: 44 cost time: 0.5332152843475342
Epoch: 44, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.949 Vali Acc: 0.245 Test Loss: 3.949 Test Acc: 0.245
Validation loss decreased (-0.243490 --> -0.244666).  Saving model ...
Epoch: 45 cost time: 0.47989773750305176
Epoch: 45, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.970 Vali Acc: 0.249 Test Loss: 3.970 Test Acc: 0.249
Validation loss decreased (-0.244666 --> -0.249372).  Saving model ...
Epoch: 46 cost time: 0.5229427814483643
Epoch: 46, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.976 Vali Acc: 0.246 Test Loss: 3.976 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5200836658477783
Epoch: 47, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.003 Vali Acc: 0.245 Test Loss: 4.003 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5476458072662354
Epoch: 48, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.026 Vali Acc: 0.242 Test Loss: 4.026 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5186736583709717
Epoch: 49, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.045 Vali Acc: 0.245 Test Loss: 4.045 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.47843050956726074
Epoch: 50, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.057 Vali Acc: 0.247 Test Loss: 4.057 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.4539952278137207
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.068 Vali Acc: 0.245 Test Loss: 4.068 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.42388176918029785
Epoch: 52, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.088 Vali Acc: 0.245 Test Loss: 4.088 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.4683363437652588
Epoch: 53, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.100 Vali Acc: 0.245 Test Loss: 4.100 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.5329258441925049
Epoch: 54, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.133 Vali Acc: 0.242 Test Loss: 4.133 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.4640984535217285
Epoch: 55, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.168 Vali Acc: 0.245 Test Loss: 4.168 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 43482
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6173338890075684
Epoch: 1, Steps: 10 | Train Loss: 3.443 Vali Loss: 3.359 Vali Acc: 0.038 Test Loss: 3.359 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.4400486946105957
Epoch: 2, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.350 Vali Acc: 0.045 Test Loss: 3.350 Test Acc: 0.045
Validation loss decreased (-0.037613 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.46446728706359863
Epoch: 3, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.340 Vali Acc: 0.049 Test Loss: 3.340 Test Acc: 0.049
Validation loss decreased (-0.044672 --> -0.049378).  Saving model ...
Epoch: 4 cost time: 0.43964338302612305
Epoch: 4, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.331 Vali Acc: 0.055 Test Loss: 3.331 Test Acc: 0.055
Validation loss decreased (-0.049378 --> -0.055261).  Saving model ...
Epoch: 5 cost time: 0.43598389625549316
Epoch: 5, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.320 Vali Acc: 0.064 Test Loss: 3.320 Test Acc: 0.064
Validation loss decreased (-0.055261 --> -0.063496).  Saving model ...
Epoch: 6 cost time: 0.4085812568664551
Epoch: 6, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.312 Vali Acc: 0.067 Test Loss: 3.312 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.44458866119384766
Epoch: 7, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.307 Vali Acc: 0.075 Test Loss: 3.307 Test Acc: 0.075
Validation loss decreased (-0.067026 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.4110379219055176
Epoch: 8, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.301 Vali Acc: 0.085 Test Loss: 3.301 Test Acc: 0.085
Validation loss decreased (-0.075261 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 0.45862269401550293
Epoch: 9, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.293 Vali Acc: 0.089 Test Loss: 3.293 Test Acc: 0.089
Validation loss decreased (-0.084673 --> -0.089379).  Saving model ...
Epoch: 10 cost time: 0.4384169578552246
Epoch: 10, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.293 Vali Acc: 0.092 Test Loss: 3.293 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 0.4114952087402344
Epoch: 11, Steps: 10 | Train Loss: 2.516 Vali Loss: 3.293 Vali Acc: 0.098 Test Loss: 3.293 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 12 cost time: 0.4785008430480957
Epoch: 12, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.290 Vali Acc: 0.102 Test Loss: 3.290 Test Acc: 0.102
Validation loss decreased (-0.097614 --> -0.102320).  Saving model ...
Epoch: 13 cost time: 0.4554431438446045
Epoch: 13, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.289 Vali Acc: 0.107 Test Loss: 3.289 Test Acc: 0.107
Validation loss decreased (-0.102320 --> -0.107026).  Saving model ...
Epoch: 14 cost time: 0.41966962814331055
Epoch: 14, Steps: 10 | Train Loss: 2.199 Vali Loss: 3.285 Vali Acc: 0.112 Test Loss: 3.285 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 15 cost time: 0.430084228515625
Epoch: 15, Steps: 10 | Train Loss: 2.073 Vali Loss: 3.282 Vali Acc: 0.121 Test Loss: 3.282 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 16 cost time: 0.44037318229675293
Epoch: 16, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.281 Vali Acc: 0.134 Test Loss: 3.281 Test Acc: 0.134
Validation loss decreased (-0.121144 --> -0.134085).  Saving model ...
Epoch: 17 cost time: 0.43183255195617676
Epoch: 17, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.286 Vali Acc: 0.142 Test Loss: 3.286 Test Acc: 0.142
Validation loss decreased (-0.134085 --> -0.142320).  Saving model ...
Epoch: 18 cost time: 0.4163386821746826
Epoch: 18, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.287 Vali Acc: 0.147 Test Loss: 3.287 Test Acc: 0.147
Validation loss decreased (-0.142320 --> -0.147026).  Saving model ...
Epoch: 19 cost time: 0.4586212635040283
Epoch: 19, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.296 Vali Acc: 0.154 Test Loss: 3.296 Test Acc: 0.154
Validation loss decreased (-0.147026 --> -0.154085).  Saving model ...
Epoch: 20 cost time: 0.41842055320739746
Epoch: 20, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.300 Vali Acc: 0.171 Test Loss: 3.300 Test Acc: 0.171
Validation loss decreased (-0.154085 --> -0.170555).  Saving model ...
Epoch: 21 cost time: 0.45449018478393555
Epoch: 21, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.310 Vali Acc: 0.167 Test Loss: 3.310 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4397284984588623
Epoch: 22, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.320 Vali Acc: 0.184 Test Loss: 3.320 Test Acc: 0.184
Validation loss decreased (-0.170555 --> -0.183496).  Saving model ...
Epoch: 23 cost time: 0.49263954162597656
Epoch: 23, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.327 Vali Acc: 0.185 Test Loss: 3.327 Test Acc: 0.185
Validation loss decreased (-0.183496 --> -0.184673).  Saving model ...
Epoch: 24 cost time: 0.44539666175842285
Epoch: 24, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.346 Vali Acc: 0.193 Test Loss: 3.346 Test Acc: 0.193
Validation loss decreased (-0.184673 --> -0.192908).  Saving model ...
Epoch: 25 cost time: 0.47304725646972656
Epoch: 25, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.374 Vali Acc: 0.192 Test Loss: 3.374 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.45835137367248535
Epoch: 26, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.394 Vali Acc: 0.192 Test Loss: 3.394 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4203503131866455
Epoch: 27, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.408 Vali Acc: 0.198 Test Loss: 3.408 Test Acc: 0.198
Validation loss decreased (-0.192908 --> -0.197613).  Saving model ...
Epoch: 28 cost time: 0.41915106773376465
Epoch: 28, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.433 Vali Acc: 0.195 Test Loss: 3.433 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5172092914581299
Epoch: 29, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.457 Vali Acc: 0.195 Test Loss: 3.457 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.446636438369751
Epoch: 30, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.492 Vali Acc: 0.195 Test Loss: 3.492 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4676072597503662
Epoch: 31, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.510 Vali Acc: 0.202 Test Loss: 3.510 Test Acc: 0.202
Validation loss decreased (-0.197613 --> -0.202318).  Saving model ...
Epoch: 32 cost time: 0.4482896327972412
Epoch: 32, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.527 Vali Acc: 0.209 Test Loss: 3.527 Test Acc: 0.209
Validation loss decreased (-0.202318 --> -0.209376).  Saving model ...
Epoch: 33 cost time: 0.4343132972717285
Epoch: 33, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.546 Vali Acc: 0.212 Test Loss: 3.546 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211729).  Saving model ...
Epoch: 34 cost time: 0.45014309883117676
Epoch: 34, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.590 Vali Acc: 0.215 Test Loss: 3.590 Test Acc: 0.215
Validation loss decreased (-0.211729 --> -0.215258).  Saving model ...
Epoch: 35 cost time: 0.47109293937683105
Epoch: 35, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.633 Vali Acc: 0.220 Test Loss: 3.633 Test Acc: 0.220
Validation loss decreased (-0.215258 --> -0.219964).  Saving model ...
Epoch: 36 cost time: 0.4674689769744873
Epoch: 36, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.643 Vali Acc: 0.216 Test Loss: 3.643 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4171302318572998
Epoch: 37, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.670 Vali Acc: 0.220 Test Loss: 3.670 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.516049861907959
Epoch: 38, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.690 Vali Acc: 0.216 Test Loss: 3.690 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4478332996368408
Epoch: 39, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.721 Vali Acc: 0.219 Test Loss: 3.721 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4554567337036133
Epoch: 40, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.747 Vali Acc: 0.222 Test Loss: 3.747 Test Acc: 0.222
Validation loss decreased (-0.219964 --> -0.222315).  Saving model ...
Epoch: 41 cost time: 0.46548986434936523
Epoch: 41, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.776 Vali Acc: 0.221 Test Loss: 3.776 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.48439526557922363
Epoch: 42, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.806 Vali Acc: 0.219 Test Loss: 3.806 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.42313241958618164
Epoch: 43, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.817 Vali Acc: 0.221 Test Loss: 3.817 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.44033169746398926
Epoch: 44, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.842 Vali Acc: 0.222 Test Loss: 3.842 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.4394867420196533
Epoch: 45, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.859 Vali Acc: 0.224 Test Loss: 3.859 Test Acc: 0.224
Validation loss decreased (-0.222315 --> -0.223491).  Saving model ...
Epoch: 46 cost time: 0.4470632076263428
Epoch: 46, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.875 Vali Acc: 0.225 Test Loss: 3.875 Test Acc: 0.225
Validation loss decreased (-0.223491 --> -0.224667).  Saving model ...
Epoch: 47 cost time: 0.45934081077575684
Epoch: 47, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.906 Vali Acc: 0.225 Test Loss: 3.906 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.46513867378234863
Epoch: 48, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.927 Vali Acc: 0.228 Test Loss: 3.927 Test Acc: 0.228
Validation loss decreased (-0.224667 --> -0.228196).  Saving model ...
Epoch: 49 cost time: 0.44398999214172363
Epoch: 49, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.956 Vali Acc: 0.221 Test Loss: 3.956 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.47719883918762207
Epoch: 50, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.982 Vali Acc: 0.227 Test Loss: 3.982 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.48925018310546875
Epoch: 51, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.998 Vali Acc: 0.226 Test Loss: 3.998 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.44518280029296875
Epoch: 52, Steps: 10 | Train Loss: 0.119 Vali Loss: 4.014 Vali Acc: 0.231 Test Loss: 4.014 Test Acc: 0.231
Validation loss decreased (-0.228196 --> -0.230548).  Saving model ...
Epoch: 53 cost time: 0.4737389087677002
Epoch: 53, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.043 Vali Acc: 0.229 Test Loss: 4.043 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.37532877922058105
Epoch: 54, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.052 Vali Acc: 0.228 Test Loss: 4.052 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.4651501178741455
Epoch: 55, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.071 Vali Acc: 0.227 Test Loss: 4.071 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.43412137031555176
Epoch: 56, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.081 Vali Acc: 0.225 Test Loss: 4.081 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.4369053840637207
Epoch: 57, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.090 Vali Acc: 0.225 Test Loss: 4.090 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.44644737243652344
Epoch: 58, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.117 Vali Acc: 0.227 Test Loss: 4.117 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.469224214553833
Epoch: 59, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.120 Vali Acc: 0.225 Test Loss: 4.120 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.46803832054138184
Epoch: 60, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.125 Vali Acc: 0.228 Test Loss: 4.125 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.4886479377746582
Epoch: 61, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.139 Vali Acc: 0.229 Test Loss: 4.139 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.45055699348449707
Epoch: 62, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.153 Vali Acc: 0.231 Test Loss: 4.153 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23058823529411765
model parameter : 36250
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4994785785675049
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.370 Vali Acc: 0.031 Test Loss: 3.370 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.4665098190307617
Epoch: 2, Steps: 10 | Train Loss: 3.445 Vali Loss: 3.363 Vali Acc: 0.034 Test Loss: 3.363 Test Acc: 0.034
Validation loss decreased (-0.030555 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 0.4421994686126709
Epoch: 3, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.355 Vali Acc: 0.041 Test Loss: 3.355 Test Acc: 0.041
Validation loss decreased (-0.034084 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 0.4581465721130371
Epoch: 4, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.345 Vali Acc: 0.041 Test Loss: 3.345 Test Acc: 0.041
Validation loss decreased (-0.041143 --> -0.041143).  Saving model ...
Epoch: 5 cost time: 0.47771120071411133
Epoch: 5, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.333 Vali Acc: 0.046 Test Loss: 3.333 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 6 cost time: 0.48923230171203613
Epoch: 6, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.322 Vali Acc: 0.049 Test Loss: 3.322 Test Acc: 0.049
Validation loss decreased (-0.045849 --> -0.049379).  Saving model ...
Epoch: 7 cost time: 0.466611385345459
Epoch: 7, Steps: 10 | Train Loss: 3.047 Vali Loss: 3.317 Vali Acc: 0.056 Test Loss: 3.317 Test Acc: 0.056
Validation loss decreased (-0.049379 --> -0.056437).  Saving model ...
Epoch: 8 cost time: 0.48824405670166016
Epoch: 8, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.307 Vali Acc: 0.073 Test Loss: 3.307 Test Acc: 0.073
Validation loss decreased (-0.056437 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.48556947708129883
Epoch: 9, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.298 Vali Acc: 0.084 Test Loss: 3.298 Test Acc: 0.084
Validation loss decreased (-0.072908 --> -0.083496).  Saving model ...
Epoch: 10 cost time: 0.455547571182251
Epoch: 10, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.296 Vali Acc: 0.093 Test Loss: 3.296 Test Acc: 0.093
Validation loss decreased (-0.083496 --> -0.092908).  Saving model ...
Epoch: 11 cost time: 0.49097108840942383
Epoch: 11, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.291 Vali Acc: 0.108 Test Loss: 3.291 Test Acc: 0.108
Validation loss decreased (-0.092908 --> -0.108202).  Saving model ...
Epoch: 12 cost time: 0.4535403251647949
Epoch: 12, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.288 Vali Acc: 0.109 Test Loss: 3.288 Test Acc: 0.109
Validation loss decreased (-0.108202 --> -0.109379).  Saving model ...
Epoch: 13 cost time: 0.4715290069580078
Epoch: 13, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.286 Vali Acc: 0.113 Test Loss: 3.286 Test Acc: 0.113
Validation loss decreased (-0.109379 --> -0.112908).  Saving model ...
Epoch: 14 cost time: 0.46197032928466797
Epoch: 14, Steps: 10 | Train Loss: 2.376 Vali Loss: 3.279 Vali Acc: 0.126 Test Loss: 3.279 Test Acc: 0.126
Validation loss decreased (-0.112908 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 0.4550902843475342
Epoch: 15, Steps: 10 | Train Loss: 2.223 Vali Loss: 3.273 Vali Acc: 0.128 Test Loss: 3.273 Test Acc: 0.128
Validation loss decreased (-0.125850 --> -0.128203).  Saving model ...
Epoch: 16 cost time: 0.4615976810455322
Epoch: 16, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.272 Vali Acc: 0.129 Test Loss: 3.272 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129379).  Saving model ...
Epoch: 17 cost time: 0.44348859786987305
Epoch: 17, Steps: 10 | Train Loss: 1.955 Vali Loss: 3.271 Vali Acc: 0.138 Test Loss: 3.271 Test Acc: 0.138
Validation loss decreased (-0.129379 --> -0.137614).  Saving model ...
Epoch: 18 cost time: 0.4714171886444092
Epoch: 18, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.272 Vali Acc: 0.142 Test Loss: 3.272 Test Acc: 0.142
Validation loss decreased (-0.137614 --> -0.142320).  Saving model ...
Epoch: 19 cost time: 0.44415760040283203
Epoch: 19, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.269 Vali Acc: 0.147 Test Loss: 3.269 Test Acc: 0.147
Validation loss decreased (-0.142320 --> -0.147026).  Saving model ...
Epoch: 20 cost time: 0.4550788402557373
Epoch: 20, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.274 Vali Acc: 0.153 Test Loss: 3.274 Test Acc: 0.153
Validation loss decreased (-0.147026 --> -0.152908).  Saving model ...
Epoch: 21 cost time: 0.4634995460510254
Epoch: 21, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.279 Vali Acc: 0.153 Test Loss: 3.279 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.45327019691467285
Epoch: 22, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.283 Vali Acc: 0.164 Test Loss: 3.283 Test Acc: 0.164
Validation loss decreased (-0.152908 --> -0.163497).  Saving model ...
Epoch: 23 cost time: 0.47064971923828125
Epoch: 23, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.294 Vali Acc: 0.162 Test Loss: 3.294 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4684934616088867
Epoch: 24, Steps: 10 | Train Loss: 1.395 Vali Loss: 3.302 Vali Acc: 0.171 Test Loss: 3.302 Test Acc: 0.171
Validation loss decreased (-0.163497 --> -0.170555).  Saving model ...
Epoch: 25 cost time: 0.44849109649658203
Epoch: 25, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.309 Vali Acc: 0.172 Test Loss: 3.309 Test Acc: 0.172
Validation loss decreased (-0.170555 --> -0.171732).  Saving model ...
Epoch: 26 cost time: 0.4463784694671631
Epoch: 26, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.322 Vali Acc: 0.173 Test Loss: 3.322 Test Acc: 0.173
Validation loss decreased (-0.171732 --> -0.172908).  Saving model ...
Epoch: 27 cost time: 0.48345494270324707
Epoch: 27, Steps: 10 | Train Loss: 1.205 Vali Loss: 3.333 Vali Acc: 0.179 Test Loss: 3.333 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178790).  Saving model ...
Epoch: 28 cost time: 0.4652364253997803
Epoch: 28, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.348 Vali Acc: 0.179 Test Loss: 3.348 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.39645981788635254
Epoch: 29, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.373 Vali Acc: 0.179 Test Loss: 3.373 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45464253425598145
Epoch: 30, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.383 Vali Acc: 0.193 Test Loss: 3.383 Test Acc: 0.193
Validation loss decreased (-0.178790 --> -0.192907).  Saving model ...
Epoch: 31 cost time: 0.4386405944824219
Epoch: 31, Steps: 10 | Train Loss: 0.841 Vali Loss: 3.395 Vali Acc: 0.194 Test Loss: 3.395 Test Acc: 0.194
Validation loss decreased (-0.192907 --> -0.194084).  Saving model ...
Epoch: 32 cost time: 0.5110490322113037
Epoch: 32, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.418 Vali Acc: 0.205 Test Loss: 3.418 Test Acc: 0.205
Validation loss decreased (-0.194084 --> -0.204672).  Saving model ...
Epoch: 33 cost time: 0.45412540435791016
Epoch: 33, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.454 Vali Acc: 0.206 Test Loss: 3.454 Test Acc: 0.206
Validation loss decreased (-0.204672 --> -0.205848).  Saving model ...
Epoch: 34 cost time: 0.46430087089538574
Epoch: 34, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.476 Vali Acc: 0.209 Test Loss: 3.476 Test Acc: 0.209
Validation loss decreased (-0.205848 --> -0.209377).  Saving model ...
Epoch: 35 cost time: 0.4582862854003906
Epoch: 35, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.488 Vali Acc: 0.218 Test Loss: 3.488 Test Acc: 0.218
Validation loss decreased (-0.209377 --> -0.217612).  Saving model ...
Epoch: 36 cost time: 0.46167969703674316
Epoch: 36, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.516 Vali Acc: 0.219 Test Loss: 3.516 Test Acc: 0.219
Validation loss decreased (-0.217612 --> -0.218788).  Saving model ...
Epoch: 37 cost time: 0.47806286811828613
Epoch: 37, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.540 Vali Acc: 0.226 Test Loss: 3.540 Test Acc: 0.226
Validation loss decreased (-0.218788 --> -0.225847).  Saving model ...
Epoch: 38 cost time: 0.4681215286254883
Epoch: 38, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.575 Vali Acc: 0.225 Test Loss: 3.575 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4924149513244629
Epoch: 39, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.594 Vali Acc: 0.228 Test Loss: 3.594 Test Acc: 0.228
Validation loss decreased (-0.225847 --> -0.228199).  Saving model ...
Epoch: 40 cost time: 0.47655653953552246
Epoch: 40, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.613 Vali Acc: 0.235 Test Loss: 3.613 Test Acc: 0.235
Validation loss decreased (-0.228199 --> -0.235258).  Saving model ...
Epoch: 41 cost time: 0.5026276111602783
Epoch: 41, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.636 Vali Acc: 0.233 Test Loss: 3.636 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5229978561401367
Epoch: 42, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.677 Vali Acc: 0.241 Test Loss: 3.677 Test Acc: 0.241
Validation loss decreased (-0.235258 --> -0.241140).  Saving model ...
Epoch: 43 cost time: 0.45952463150024414
Epoch: 43, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.684 Vali Acc: 0.236 Test Loss: 3.684 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4425499439239502
Epoch: 44, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.694 Vali Acc: 0.236 Test Loss: 3.694 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4680514335632324
Epoch: 45, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.708 Vali Acc: 0.245 Test Loss: 3.708 Test Acc: 0.245
Validation loss decreased (-0.241140 --> -0.244669).  Saving model ...
Epoch: 46 cost time: 0.4644608497619629
Epoch: 46, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.772 Vali Acc: 0.246 Test Loss: 3.772 Test Acc: 0.246
Validation loss decreased (-0.244669 --> -0.245845).  Saving model ...
Epoch: 47 cost time: 0.48526453971862793
Epoch: 47, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.792 Vali Acc: 0.241 Test Loss: 3.792 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4814777374267578
Epoch: 48, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.792 Vali Acc: 0.240 Test Loss: 3.792 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4601607322692871
Epoch: 49, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.819 Vali Acc: 0.241 Test Loss: 3.819 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4640929698944092
Epoch: 50, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.833 Vali Acc: 0.234 Test Loss: 3.833 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.45177173614501953
Epoch: 51, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.865 Vali Acc: 0.234 Test Loss: 3.865 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.4522593021392822
Epoch: 52, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.883 Vali Acc: 0.231 Test Loss: 3.883 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.47411203384399414
Epoch: 53, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.912 Vali Acc: 0.229 Test Loss: 3.912 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5098481178283691
Epoch: 54, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.933 Vali Acc: 0.231 Test Loss: 3.933 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5184273719787598
Epoch: 55, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.942 Vali Acc: 0.236 Test Loss: 3.942 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.46979784965515137
Epoch: 56, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.964 Vali Acc: 0.238 Test Loss: 3.964 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 33978
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.370962142944336
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.327 Vali Acc: 0.038 Test Loss: 3.327 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.43979430198669434
Epoch: 2, Steps: 10 | Train Loss: 3.256 Vali Loss: 3.361 Vali Acc: 0.064 Test Loss: 3.361 Test Acc: 0.064
Validation loss decreased (-0.037614 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.49092531204223633
Epoch: 3, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.336 Vali Acc: 0.107 Test Loss: 3.336 Test Acc: 0.107
Validation loss decreased (-0.063496 --> -0.107025).  Saving model ...
Epoch: 4 cost time: 0.44971609115600586
Epoch: 4, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.287 Vali Acc: 0.122 Test Loss: 3.287 Test Acc: 0.122
Validation loss decreased (-0.107025 --> -0.122320).  Saving model ...
Epoch: 5 cost time: 0.47205352783203125
Epoch: 5, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.230 Vali Acc: 0.139 Test Loss: 3.230 Test Acc: 0.139
Validation loss decreased (-0.122320 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 0.4378814697265625
Epoch: 6, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.234 Vali Acc: 0.155 Test Loss: 3.234 Test Acc: 0.155
Validation loss decreased (-0.138791 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.41677093505859375
Epoch: 7, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.251 Vali Acc: 0.196 Test Loss: 3.251 Test Acc: 0.196
Validation loss decreased (-0.155262 --> -0.196438).  Saving model ...
Epoch: 8 cost time: 0.4382610321044922
Epoch: 8, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.330 Vali Acc: 0.188 Test Loss: 3.330 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.425983190536499
Epoch: 9, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.299 Vali Acc: 0.226 Test Loss: 3.299 Test Acc: 0.226
Validation loss decreased (-0.196438 --> -0.225849).  Saving model ...
Epoch: 10 cost time: 0.470247745513916
Epoch: 10, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.381 Vali Acc: 0.225 Test Loss: 3.381 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4563591480255127
Epoch: 11, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.500 Vali Acc: 0.236 Test Loss: 3.500 Test Acc: 0.236
Validation loss decreased (-0.225849 --> -0.236436).  Saving model ...
Epoch: 12 cost time: 0.4549837112426758
Epoch: 12, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.494 Vali Acc: 0.231 Test Loss: 3.494 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.42858004570007324
Epoch: 13, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.667 Vali Acc: 0.249 Test Loss: 3.667 Test Acc: 0.249
Validation loss decreased (-0.236436 --> -0.249375).  Saving model ...
Epoch: 14 cost time: 0.4634532928466797
Epoch: 14, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.768 Vali Acc: 0.246 Test Loss: 3.768 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4494595527648926
Epoch: 15, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.776 Vali Acc: 0.260 Test Loss: 3.776 Test Acc: 0.260
Validation loss decreased (-0.249375 --> -0.259962).  Saving model ...
Epoch: 16 cost time: 0.4360651969909668
Epoch: 16, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.953 Vali Acc: 0.258 Test Loss: 3.953 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4838557243347168
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.037 Vali Acc: 0.260 Test Loss: 4.037 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.42622971534729004
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.165 Vali Acc: 0.262 Test Loss: 4.165 Test Acc: 0.262
Validation loss decreased (-0.259962 --> -0.262311).  Saving model ...
Epoch: 19 cost time: 0.4319496154785156
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.193 Vali Acc: 0.267 Test Loss: 4.193 Test Acc: 0.267
Validation loss decreased (-0.262311 --> -0.267017).  Saving model ...
Epoch: 20 cost time: 0.4636726379394531
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.169 Vali Acc: 0.279 Test Loss: 4.169 Test Acc: 0.279
Validation loss decreased (-0.267017 --> -0.278782).  Saving model ...
Epoch: 21 cost time: 0.44707727432250977
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.277 Vali Acc: 0.267 Test Loss: 4.277 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42572021484375
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.314 Vali Acc: 0.268 Test Loss: 4.314 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.43403005599975586
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.350 Vali Acc: 0.276 Test Loss: 4.350 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45268774032592773
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.367 Vali Acc: 0.273 Test Loss: 4.367 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.43536806106567383
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.411 Vali Acc: 0.267 Test Loss: 4.411 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4557933807373047
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.462 Vali Acc: 0.268 Test Loss: 4.462 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.46320557594299316
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.480 Vali Acc: 0.268 Test Loss: 4.480 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.43201494216918945
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.508 Vali Acc: 0.272 Test Loss: 4.508 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4450817108154297
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.537 Vali Acc: 0.269 Test Loss: 4.537 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.47662973403930664
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.556 Vali Acc: 0.273 Test Loss: 4.556 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 198458
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4242255687713623
Epoch: 1, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.355 Vali Acc: 0.031 Test Loss: 3.355 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.43653225898742676
Epoch: 2, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.337 Vali Acc: 0.056 Test Loss: 3.337 Test Acc: 0.056
Validation loss decreased (-0.030555 --> -0.056437).  Saving model ...
Epoch: 3 cost time: 0.48738646507263184
Epoch: 3, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.357 Vali Acc: 0.076 Test Loss: 3.357 Test Acc: 0.076
Validation loss decreased (-0.056437 --> -0.076437).  Saving model ...
Epoch: 4 cost time: 0.45922350883483887
Epoch: 4, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.331 Vali Acc: 0.094 Test Loss: 3.331 Test Acc: 0.094
Validation loss decreased (-0.076437 --> -0.094084).  Saving model ...
Epoch: 5 cost time: 0.47527408599853516
Epoch: 5, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.296 Vali Acc: 0.108 Test Loss: 3.296 Test Acc: 0.108
Validation loss decreased (-0.094084 --> -0.108202).  Saving model ...
Epoch: 6 cost time: 0.46909451484680176
Epoch: 6, Steps: 10 | Train Loss: 2.503 Vali Loss: 3.251 Vali Acc: 0.125 Test Loss: 3.251 Test Acc: 0.125
Validation loss decreased (-0.108202 --> -0.124673).  Saving model ...
Epoch: 7 cost time: 0.47653937339782715
Epoch: 7, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.243 Vali Acc: 0.131 Test Loss: 3.243 Test Acc: 0.131
Validation loss decreased (-0.124673 --> -0.130556).  Saving model ...
Epoch: 8 cost time: 0.4611954689025879
Epoch: 8, Steps: 10 | Train Loss: 1.982 Vali Loss: 3.228 Vali Acc: 0.148 Test Loss: 3.228 Test Acc: 0.148
Validation loss decreased (-0.130556 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.5150752067565918
Epoch: 9, Steps: 10 | Train Loss: 1.791 Vali Loss: 3.247 Vali Acc: 0.165 Test Loss: 3.247 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164673).  Saving model ...
Epoch: 10 cost time: 0.45610928535461426
Epoch: 10, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.264 Vali Acc: 0.175 Test Loss: 3.264 Test Acc: 0.175
Validation loss decreased (-0.164673 --> -0.175261).  Saving model ...
Epoch: 11 cost time: 0.4864006042480469
Epoch: 11, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.277 Vali Acc: 0.191 Test Loss: 3.277 Test Acc: 0.191
Validation loss decreased (-0.175261 --> -0.190555).  Saving model ...
Epoch: 12 cost time: 0.4892427921295166
Epoch: 12, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.311 Vali Acc: 0.188 Test Loss: 3.311 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47583723068237305
Epoch: 13, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.357 Vali Acc: 0.219 Test Loss: 3.357 Test Acc: 0.219
Validation loss decreased (-0.190555 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 0.4760899543762207
Epoch: 14, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.361 Vali Acc: 0.232 Test Loss: 3.361 Test Acc: 0.232
Validation loss decreased (-0.218790 --> -0.231731).  Saving model ...
Epoch: 15 cost time: 0.48622870445251465
Epoch: 15, Steps: 10 | Train Loss: 0.737 Vali Loss: 3.441 Vali Acc: 0.222 Test Loss: 3.441 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.47563815116882324
Epoch: 16, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.504 Vali Acc: 0.233 Test Loss: 3.504 Test Acc: 0.233
Validation loss decreased (-0.231731 --> -0.232906).  Saving model ...
Epoch: 17 cost time: 0.4755263328552246
Epoch: 17, Steps: 10 | Train Loss: 0.505 Vali Loss: 3.540 Vali Acc: 0.242 Test Loss: 3.540 Test Acc: 0.242
Validation loss decreased (-0.232906 --> -0.242318).  Saving model ...
Epoch: 18 cost time: 0.48783349990844727
Epoch: 18, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.636 Vali Acc: 0.229 Test Loss: 3.636 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4730224609375
Epoch: 19, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.705 Vali Acc: 0.240 Test Loss: 3.705 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.47093749046325684
Epoch: 20, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.727 Vali Acc: 0.252 Test Loss: 3.727 Test Acc: 0.252
Validation loss decreased (-0.242318 --> -0.251727).  Saving model ...
Epoch: 21 cost time: 0.48946428298950195
Epoch: 21, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.795 Vali Acc: 0.252 Test Loss: 3.795 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4727921485900879
Epoch: 22, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.880 Vali Acc: 0.251 Test Loss: 3.880 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.47599029541015625
Epoch: 23, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.943 Vali Acc: 0.253 Test Loss: 3.943 Test Acc: 0.253
Validation loss decreased (-0.251727 --> -0.252902).  Saving model ...
Epoch: 24 cost time: 0.5119743347167969
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.936 Vali Acc: 0.258 Test Loss: 3.936 Test Acc: 0.258
Validation loss decreased (-0.252902 --> -0.257608).  Saving model ...
Epoch: 25 cost time: 0.47110700607299805
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.008 Vali Acc: 0.260 Test Loss: 4.008 Test Acc: 0.260
Validation loss decreased (-0.257608 --> -0.259960).  Saving model ...
Epoch: 26 cost time: 0.47332215309143066
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.081 Vali Acc: 0.261 Test Loss: 4.081 Test Acc: 0.261
Validation loss decreased (-0.259960 --> -0.261136).  Saving model ...
Epoch: 27 cost time: 0.5080568790435791
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.115 Vali Acc: 0.255 Test Loss: 4.115 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.46990251541137695
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.124 Vali Acc: 0.253 Test Loss: 4.124 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4501950740814209
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.149 Vali Acc: 0.261 Test Loss: 4.149 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.46154165267944336
Epoch: 30, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.178 Vali Acc: 0.258 Test Loss: 4.178 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.45720410346984863
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.226 Vali Acc: 0.262 Test Loss: 4.226 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262311).  Saving model ...
Epoch: 32 cost time: 0.4368627071380615
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.240 Vali Acc: 0.265 Test Loss: 4.240 Test Acc: 0.265
Validation loss decreased (-0.262311 --> -0.264663).  Saving model ...
Epoch: 33 cost time: 0.44023823738098145
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.268 Vali Acc: 0.264 Test Loss: 4.268 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4761331081390381
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.288 Vali Acc: 0.264 Test Loss: 4.288 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4774303436279297
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.308 Vali Acc: 0.266 Test Loss: 4.308 Test Acc: 0.266
Validation loss decreased (-0.264663 --> -0.265839).  Saving model ...
Epoch: 36 cost time: 0.4896125793457031
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.336 Vali Acc: 0.265 Test Loss: 4.336 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4677557945251465
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.391 Vali Acc: 0.269 Test Loss: 4.391 Test Acc: 0.269
Validation loss decreased (-0.265839 --> -0.269368).  Saving model ...
Epoch: 38 cost time: 0.46675944328308105
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.426 Vali Acc: 0.268 Test Loss: 4.426 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4646949768066406
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.408 Vali Acc: 0.273 Test Loss: 4.408 Test Acc: 0.273
Validation loss decreased (-0.269368 --> -0.272897).  Saving model ...
Epoch: 40 cost time: 0.4582066535949707
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.414 Vali Acc: 0.273 Test Loss: 4.414 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.43694472312927246
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.432 Vali Acc: 0.272 Test Loss: 4.432 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4891791343688965
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.440 Vali Acc: 0.274 Test Loss: 4.440 Test Acc: 0.274
Validation loss decreased (-0.272897 --> -0.274073).  Saving model ...
Epoch: 43 cost time: 0.4771451950073242
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.472 Vali Acc: 0.275 Test Loss: 4.472 Test Acc: 0.275
Validation loss decreased (-0.274073 --> -0.275249).  Saving model ...
Epoch: 44 cost time: 0.48524999618530273
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.490 Vali Acc: 0.279 Test Loss: 4.490 Test Acc: 0.279
Validation loss decreased (-0.275249 --> -0.278779).  Saving model ...
Epoch: 45 cost time: 0.48244571685791016
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.499 Vali Acc: 0.274 Test Loss: 4.499 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.503467321395874
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.506 Vali Acc: 0.271 Test Loss: 4.506 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.45302748680114746
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.528 Vali Acc: 0.271 Test Loss: 4.528 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4598252773284912
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.546 Vali Acc: 0.272 Test Loss: 4.546 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.48023033142089844
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.556 Vali Acc: 0.269 Test Loss: 4.556 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4384326934814453
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.564 Vali Acc: 0.269 Test Loss: 4.564 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.48494696617126465
Epoch: 51, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.572 Vali Acc: 0.272 Test Loss: 4.572 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.4963405132293701
Epoch: 52, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.590 Vali Acc: 0.279 Test Loss: 4.590 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.439410924911499
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.594 Vali Acc: 0.279 Test Loss: 4.594 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.4816741943359375
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.610 Vali Acc: 0.278 Test Loss: 4.610 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 103738
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5296509265899658
Epoch: 1, Steps: 10 | Train Loss: 3.421 Vali Loss: 3.396 Vali Acc: 0.031 Test Loss: 3.396 Test Acc: 0.031
Validation loss decreased (inf --> -0.030554).  Saving model ...
Epoch: 2 cost time: 0.4591245651245117
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.370 Vali Acc: 0.041 Test Loss: 3.370 Test Acc: 0.041
Validation loss decreased (-0.030554 --> -0.041143).  Saving model ...
Epoch: 3 cost time: 0.4310014247894287
Epoch: 3, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.355 Vali Acc: 0.052 Test Loss: 3.355 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051731).  Saving model ...
Epoch: 4 cost time: 0.47182774543762207
Epoch: 4, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.354 Vali Acc: 0.065 Test Loss: 3.354 Test Acc: 0.065
Validation loss decreased (-0.051731 --> -0.064672).  Saving model ...
Epoch: 5 cost time: 0.4532511234283447
Epoch: 5, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.348 Vali Acc: 0.084 Test Loss: 3.348 Test Acc: 0.084
Validation loss decreased (-0.064672 --> -0.083496).  Saving model ...
Epoch: 6 cost time: 0.42535996437072754
Epoch: 6, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.329 Vali Acc: 0.096 Test Loss: 3.329 Test Acc: 0.096
Validation loss decreased (-0.083496 --> -0.096437).  Saving model ...
Epoch: 7 cost time: 0.44158315658569336
Epoch: 7, Steps: 10 | Train Loss: 2.549 Vali Loss: 3.289 Vali Acc: 0.113 Test Loss: 3.289 Test Acc: 0.113
Validation loss decreased (-0.096437 --> -0.112908).  Saving model ...
Epoch: 8 cost time: 0.44803524017333984
Epoch: 8, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.267 Vali Acc: 0.126 Test Loss: 3.267 Test Acc: 0.126
Validation loss decreased (-0.112908 --> -0.125850).  Saving model ...
Epoch: 9 cost time: 0.4567735195159912
Epoch: 9, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.264 Vali Acc: 0.136 Test Loss: 3.264 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 10 cost time: 0.4566209316253662
Epoch: 10, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.259 Vali Acc: 0.136 Test Loss: 3.259 Test Acc: 0.136
Validation loss decreased (-0.136438 --> -0.136438).  Saving model ...
Epoch: 11 cost time: 0.4414842128753662
Epoch: 11, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.252 Vali Acc: 0.152 Test Loss: 3.252 Test Acc: 0.152
Validation loss decreased (-0.136438 --> -0.151732).  Saving model ...
Epoch: 12 cost time: 0.45333003997802734
Epoch: 12, Steps: 10 | Train Loss: 1.573 Vali Loss: 3.254 Vali Acc: 0.156 Test Loss: 3.254 Test Acc: 0.156
Validation loss decreased (-0.151732 --> -0.156438).  Saving model ...
Epoch: 13 cost time: 0.42199063301086426
Epoch: 13, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.266 Vali Acc: 0.172 Test Loss: 3.266 Test Acc: 0.172
Validation loss decreased (-0.156438 --> -0.171732).  Saving model ...
Epoch: 14 cost time: 0.42746543884277344
Epoch: 14, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.272 Vali Acc: 0.179 Test Loss: 3.272 Test Acc: 0.179
Validation loss decreased (-0.171732 --> -0.178791).  Saving model ...
Epoch: 15 cost time: 0.44982051849365234
Epoch: 15, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.296 Vali Acc: 0.189 Test Loss: 3.296 Test Acc: 0.189
Validation loss decreased (-0.178791 --> -0.189379).  Saving model ...
Epoch: 16 cost time: 0.46706271171569824
Epoch: 16, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.340 Vali Acc: 0.188 Test Loss: 3.340 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4453895092010498
Epoch: 17, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.362 Vali Acc: 0.188 Test Loss: 3.362 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.46706342697143555
Epoch: 18, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.401 Vali Acc: 0.215 Test Loss: 3.401 Test Acc: 0.215
Validation loss decreased (-0.189379 --> -0.215260).  Saving model ...
Epoch: 19 cost time: 0.46382999420166016
Epoch: 19, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.451 Vali Acc: 0.222 Test Loss: 3.451 Test Acc: 0.222
Validation loss decreased (-0.215260 --> -0.222318).  Saving model ...
Epoch: 20 cost time: 0.4117317199707031
Epoch: 20, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.493 Vali Acc: 0.218 Test Loss: 3.493 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4563913345336914
Epoch: 21, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.532 Vali Acc: 0.226 Test Loss: 3.532 Test Acc: 0.226
Validation loss decreased (-0.222318 --> -0.225847).  Saving model ...
Epoch: 22 cost time: 0.45011091232299805
Epoch: 22, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.568 Vali Acc: 0.233 Test Loss: 3.568 Test Acc: 0.233
Validation loss decreased (-0.225847 --> -0.232905).  Saving model ...
Epoch: 23 cost time: 0.4390437602996826
Epoch: 23, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.624 Vali Acc: 0.239 Test Loss: 3.624 Test Acc: 0.239
Validation loss decreased (-0.232905 --> -0.238787).  Saving model ...
Epoch: 24 cost time: 0.4872314929962158
Epoch: 24, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.648 Vali Acc: 0.234 Test Loss: 3.648 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4729421138763428
Epoch: 25, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.711 Vali Acc: 0.240 Test Loss: 3.711 Test Acc: 0.240
Validation loss decreased (-0.238787 --> -0.239963).  Saving model ...
Epoch: 26 cost time: 0.46872925758361816
Epoch: 26, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.779 Vali Acc: 0.246 Test Loss: 3.779 Test Acc: 0.246
Validation loss decreased (-0.239963 --> -0.245845).  Saving model ...
Epoch: 27 cost time: 0.46584248542785645
Epoch: 27, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.817 Vali Acc: 0.245 Test Loss: 3.817 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4712693691253662
Epoch: 28, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.882 Vali Acc: 0.240 Test Loss: 3.882 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4588139057159424
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.921 Vali Acc: 0.228 Test Loss: 3.921 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.45996809005737305
Epoch: 30, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.925 Vali Acc: 0.236 Test Loss: 3.925 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5188107490539551
Epoch: 31, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.975 Vali Acc: 0.239 Test Loss: 3.975 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5269317626953125
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.996 Vali Acc: 0.234 Test Loss: 3.996 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.46048927307128906
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.018 Vali Acc: 0.236 Test Loss: 4.018 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4743185043334961
Epoch: 34, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.054 Vali Acc: 0.234 Test Loss: 4.054 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4734666347503662
Epoch: 35, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.119 Vali Acc: 0.236 Test Loss: 4.119 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.49726247787475586
Epoch: 36, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.158 Vali Acc: 0.236 Test Loss: 4.158 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 71418
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5355138778686523
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.355 Vali Acc: 0.038 Test Loss: 3.355 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.4504859447479248
Epoch: 2, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.340 Vali Acc: 0.049 Test Loss: 3.340 Test Acc: 0.049
Validation loss decreased (-0.037614 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.5014679431915283
Epoch: 3, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.329 Vali Acc: 0.072 Test Loss: 3.329 Test Acc: 0.072
Validation loss decreased (-0.049378 --> -0.071731).  Saving model ...
Epoch: 4 cost time: 0.47480225563049316
Epoch: 4, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.323 Vali Acc: 0.079 Test Loss: 3.323 Test Acc: 0.079
Validation loss decreased (-0.071731 --> -0.078790).  Saving model ...
Epoch: 5 cost time: 0.46852660179138184
Epoch: 5, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.319 Vali Acc: 0.092 Test Loss: 3.319 Test Acc: 0.092
Validation loss decreased (-0.078790 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.46863770484924316
Epoch: 6, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.303 Vali Acc: 0.105 Test Loss: 3.303 Test Acc: 0.105
Validation loss decreased (-0.091732 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.45444273948669434
Epoch: 7, Steps: 10 | Train Loss: 2.616 Vali Loss: 3.294 Vali Acc: 0.122 Test Loss: 3.294 Test Acc: 0.122
Validation loss decreased (-0.104673 --> -0.122320).  Saving model ...
Epoch: 8 cost time: 0.4849588871002197
Epoch: 8, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.273 Vali Acc: 0.118 Test Loss: 3.273 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.513965368270874
Epoch: 9, Steps: 10 | Train Loss: 2.290 Vali Loss: 3.259 Vali Acc: 0.128 Test Loss: 3.259 Test Acc: 0.128
Validation loss decreased (-0.122320 --> -0.128203).  Saving model ...
Epoch: 10 cost time: 0.4748084545135498
Epoch: 10, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.250 Vali Acc: 0.140 Test Loss: 3.250 Test Acc: 0.140
Validation loss decreased (-0.128203 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 0.535773754119873
Epoch: 11, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.243 Vali Acc: 0.144 Test Loss: 3.243 Test Acc: 0.144
Validation loss decreased (-0.139968 --> -0.143497).  Saving model ...
Epoch: 12 cost time: 0.45430803298950195
Epoch: 12, Steps: 10 | Train Loss: 1.850 Vali Loss: 3.240 Vali Acc: 0.156 Test Loss: 3.240 Test Acc: 0.156
Validation loss decreased (-0.143497 --> -0.156438).  Saving model ...
Epoch: 13 cost time: 0.4927041530609131
Epoch: 13, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.254 Vali Acc: 0.171 Test Loss: 3.254 Test Acc: 0.171
Validation loss decreased (-0.156438 --> -0.170556).  Saving model ...
Epoch: 14 cost time: 0.45855164527893066
Epoch: 14, Steps: 10 | Train Loss: 1.584 Vali Loss: 3.262 Vali Acc: 0.181 Test Loss: 3.262 Test Acc: 0.181
Validation loss decreased (-0.170556 --> -0.181144).  Saving model ...
Epoch: 15 cost time: 0.49358129501342773
Epoch: 15, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.278 Vali Acc: 0.185 Test Loss: 3.278 Test Acc: 0.185
Validation loss decreased (-0.181144 --> -0.184673).  Saving model ...
Epoch: 16 cost time: 0.47081565856933594
Epoch: 16, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.277 Vali Acc: 0.191 Test Loss: 3.277 Test Acc: 0.191
Validation loss decreased (-0.184673 --> -0.190555).  Saving model ...
Epoch: 17 cost time: 0.4868779182434082
Epoch: 17, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.309 Vali Acc: 0.200 Test Loss: 3.309 Test Acc: 0.200
Validation loss decreased (-0.190555 --> -0.199967).  Saving model ...
Epoch: 18 cost time: 0.4412984848022461
Epoch: 18, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.331 Vali Acc: 0.208 Test Loss: 3.331 Test Acc: 0.208
Validation loss decreased (-0.199967 --> -0.208202).  Saving model ...
Epoch: 19 cost time: 0.4884798526763916
Epoch: 19, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.355 Vali Acc: 0.219 Test Loss: 3.355 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218790).  Saving model ...
Epoch: 20 cost time: 0.4745161533355713
Epoch: 20, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.391 Vali Acc: 0.216 Test Loss: 3.391 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4800288677215576
Epoch: 21, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.431 Vali Acc: 0.219 Test Loss: 3.431 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4722144603729248
Epoch: 22, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.454 Vali Acc: 0.226 Test Loss: 3.454 Test Acc: 0.226
Validation loss decreased (-0.218790 --> -0.225848).  Saving model ...
Epoch: 23 cost time: 0.4651491641998291
Epoch: 23, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.482 Vali Acc: 0.236 Test Loss: 3.482 Test Acc: 0.236
Validation loss decreased (-0.225848 --> -0.236436).  Saving model ...
Epoch: 24 cost time: 0.47857046127319336
Epoch: 24, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.516 Vali Acc: 0.236 Test Loss: 3.516 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.48139238357543945
Epoch: 25, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.568 Vali Acc: 0.242 Test Loss: 3.568 Test Acc: 0.242
Validation loss decreased (-0.236436 --> -0.242317).  Saving model ...
Epoch: 26 cost time: 0.46177196502685547
Epoch: 26, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.616 Vali Acc: 0.241 Test Loss: 3.616 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43230104446411133
Epoch: 27, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.653 Vali Acc: 0.239 Test Loss: 3.653 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4785444736480713
Epoch: 28, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.690 Vali Acc: 0.248 Test Loss: 3.690 Test Acc: 0.248
Validation loss decreased (-0.242317 --> -0.248198).  Saving model ...
Epoch: 29 cost time: 0.43569469451904297
Epoch: 29, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.740 Vali Acc: 0.248 Test Loss: 3.740 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.48554062843322754
Epoch: 30, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.779 Vali Acc: 0.255 Test Loss: 3.779 Test Acc: 0.255
Validation loss decreased (-0.248198 --> -0.255256).  Saving model ...
Epoch: 31 cost time: 0.44316554069519043
Epoch: 31, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.826 Vali Acc: 0.248 Test Loss: 3.826 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4673318862915039
Epoch: 32, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.842 Vali Acc: 0.258 Test Loss: 3.842 Test Acc: 0.258
Validation loss decreased (-0.255256 --> -0.257609).  Saving model ...
Epoch: 33 cost time: 0.48847055435180664
Epoch: 33, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.888 Vali Acc: 0.254 Test Loss: 3.888 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.45718932151794434
Epoch: 34, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.939 Vali Acc: 0.247 Test Loss: 3.939 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.48818016052246094
Epoch: 35, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.966 Vali Acc: 0.249 Test Loss: 3.966 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4906935691833496
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.002 Vali Acc: 0.246 Test Loss: 4.002 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.48872852325439453
Epoch: 37, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.017 Vali Acc: 0.251 Test Loss: 4.017 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4513571262359619
Epoch: 38, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.050 Vali Acc: 0.252 Test Loss: 4.050 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4829123020172119
Epoch: 39, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.112 Vali Acc: 0.251 Test Loss: 4.112 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.45168638229370117
Epoch: 40, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.102 Vali Acc: 0.253 Test Loss: 4.102 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.46024370193481445
Epoch: 41, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.111 Vali Acc: 0.249 Test Loss: 4.111 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.47867798805236816
Epoch: 42, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.147 Vali Acc: 0.249 Test Loss: 4.147 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 56570
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.354227066040039
Epoch: 1, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.371 Vali Acc: 0.041 Test Loss: 3.371 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.47147035598754883
Epoch: 2, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.355 Vali Acc: 0.047 Test Loss: 3.355 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047025).  Saving model ...
Epoch: 3 cost time: 0.4620687961578369
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.341 Vali Acc: 0.055 Test Loss: 3.341 Test Acc: 0.055
Validation loss decreased (-0.047025 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.49959707260131836
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.331 Vali Acc: 0.059 Test Loss: 3.331 Test Acc: 0.059
Validation loss decreased (-0.055261 --> -0.058790).  Saving model ...
Epoch: 5 cost time: 0.4770658016204834
Epoch: 5, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.321 Vali Acc: 0.067 Test Loss: 3.321 Test Acc: 0.067
Validation loss decreased (-0.058790 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.4385991096496582
Epoch: 6, Steps: 10 | Train Loss: 2.995 Vali Loss: 3.313 Vali Acc: 0.072 Test Loss: 3.313 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.44583892822265625
Epoch: 7, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.307 Vali Acc: 0.079 Test Loss: 3.307 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078790).  Saving model ...
Epoch: 8 cost time: 0.45900988578796387
Epoch: 8, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.298 Vali Acc: 0.087 Test Loss: 3.298 Test Acc: 0.087
Validation loss decreased (-0.078790 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 0.4692835807800293
Epoch: 9, Steps: 10 | Train Loss: 2.491 Vali Loss: 3.292 Vali Acc: 0.095 Test Loss: 3.292 Test Acc: 0.095
Validation loss decreased (-0.087026 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.4895963668823242
Epoch: 10, Steps: 10 | Train Loss: 2.439 Vali Loss: 3.286 Vali Acc: 0.102 Test Loss: 3.286 Test Acc: 0.102
Validation loss decreased (-0.095261 --> -0.102320).  Saving model ...
Epoch: 11 cost time: 0.46195054054260254
Epoch: 11, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.273 Vali Acc: 0.106 Test Loss: 3.273 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 12 cost time: 0.46434688568115234
Epoch: 12, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.260 Vali Acc: 0.120 Test Loss: 3.260 Test Acc: 0.120
Validation loss decreased (-0.105850 --> -0.119967).  Saving model ...
Epoch: 13 cost time: 0.4659769535064697
Epoch: 13, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.263 Vali Acc: 0.121 Test Loss: 3.263 Test Acc: 0.121
Validation loss decreased (-0.119967 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 0.4642786979675293
Epoch: 14, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.259 Vali Acc: 0.131 Test Loss: 3.259 Test Acc: 0.131
Validation loss decreased (-0.121144 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.4846799373626709
Epoch: 15, Steps: 10 | Train Loss: 1.796 Vali Loss: 3.262 Vali Acc: 0.136 Test Loss: 3.262 Test Acc: 0.136
Validation loss decreased (-0.130556 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.5611307621002197
Epoch: 16, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.271 Vali Acc: 0.142 Test Loss: 3.271 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142320).  Saving model ...
Epoch: 17 cost time: 0.5197722911834717
Epoch: 17, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.275 Vali Acc: 0.153 Test Loss: 3.275 Test Acc: 0.153
Validation loss decreased (-0.142320 --> -0.152908).  Saving model ...
Epoch: 18 cost time: 0.4960911273956299
Epoch: 18, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.275 Vali Acc: 0.166 Test Loss: 3.275 Test Acc: 0.166
Validation loss decreased (-0.152908 --> -0.165850).  Saving model ...
Epoch: 19 cost time: 0.4632875919342041
Epoch: 19, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.288 Vali Acc: 0.173 Test Loss: 3.288 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172908).  Saving model ...
Epoch: 20 cost time: 0.45464134216308594
Epoch: 20, Steps: 10 | Train Loss: 1.234 Vali Loss: 3.299 Vali Acc: 0.176 Test Loss: 3.299 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176438).  Saving model ...
Epoch: 21 cost time: 0.5334780216217041
Epoch: 21, Steps: 10 | Train Loss: 1.156 Vali Loss: 3.311 Vali Acc: 0.188 Test Loss: 3.311 Test Acc: 0.188
Validation loss decreased (-0.176438 --> -0.188202).  Saving model ...
Epoch: 22 cost time: 0.4806075096130371
Epoch: 22, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.329 Vali Acc: 0.196 Test Loss: 3.329 Test Acc: 0.196
Validation loss decreased (-0.188202 --> -0.196437).  Saving model ...
Epoch: 23 cost time: 0.4800252914428711
Epoch: 23, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.347 Vali Acc: 0.201 Test Loss: 3.347 Test Acc: 0.201
Validation loss decreased (-0.196437 --> -0.201143).  Saving model ...
Epoch: 24 cost time: 0.37098050117492676
Epoch: 24, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.362 Vali Acc: 0.208 Test Loss: 3.362 Test Acc: 0.208
Validation loss decreased (-0.201143 --> -0.208202).  Saving model ...
Epoch: 25 cost time: 0.4681355953216553
Epoch: 25, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.375 Vali Acc: 0.214 Test Loss: 3.375 Test Acc: 0.214
Validation loss decreased (-0.208202 --> -0.214084).  Saving model ...
Epoch: 26 cost time: 0.4555399417877197
Epoch: 26, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.398 Vali Acc: 0.213 Test Loss: 3.398 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.47777628898620605
Epoch: 27, Steps: 10 | Train Loss: 0.645 Vali Loss: 3.417 Vali Acc: 0.225 Test Loss: 3.417 Test Acc: 0.225
Validation loss decreased (-0.214084 --> -0.224672).  Saving model ...
Epoch: 28 cost time: 0.4716930389404297
Epoch: 28, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.457 Vali Acc: 0.226 Test Loss: 3.457 Test Acc: 0.226
Validation loss decreased (-0.224672 --> -0.225848).  Saving model ...
Epoch: 29 cost time: 0.4643287658691406
Epoch: 29, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.498 Vali Acc: 0.224 Test Loss: 3.498 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5077700614929199
Epoch: 30, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.531 Vali Acc: 0.233 Test Loss: 3.531 Test Acc: 0.233
Validation loss decreased (-0.225848 --> -0.232906).  Saving model ...
Epoch: 31 cost time: 0.4964895248413086
Epoch: 31, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.546 Vali Acc: 0.236 Test Loss: 3.546 Test Acc: 0.236
Validation loss decreased (-0.232906 --> -0.236435).  Saving model ...
Epoch: 32 cost time: 0.4848191738128662
Epoch: 32, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.578 Vali Acc: 0.239 Test Loss: 3.578 Test Acc: 0.239
Validation loss decreased (-0.236435 --> -0.238788).  Saving model ...
Epoch: 33 cost time: 0.5244131088256836
Epoch: 33, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.606 Vali Acc: 0.244 Test Loss: 3.606 Test Acc: 0.244
Validation loss decreased (-0.238788 --> -0.243493).  Saving model ...
Epoch: 34 cost time: 0.5530130863189697
Epoch: 34, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.629 Vali Acc: 0.244 Test Loss: 3.629 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.45996522903442383
Epoch: 35, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.674 Vali Acc: 0.242 Test Loss: 3.674 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.44668030738830566
Epoch: 36, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.692 Vali Acc: 0.240 Test Loss: 3.692 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4500267505645752
Epoch: 37, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.715 Vali Acc: 0.248 Test Loss: 3.715 Test Acc: 0.248
Validation loss decreased (-0.243493 --> -0.248198).  Saving model ...
Epoch: 38 cost time: 0.42412805557250977
Epoch: 38, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.737 Vali Acc: 0.246 Test Loss: 3.737 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.43575453758239746
Epoch: 39, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.760 Vali Acc: 0.244 Test Loss: 3.760 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.47719621658325195
Epoch: 40, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.779 Vali Acc: 0.246 Test Loss: 3.779 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.44212841987609863
Epoch: 41, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.802 Vali Acc: 0.246 Test Loss: 3.802 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5212500095367432
Epoch: 42, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.819 Vali Acc: 0.246 Test Loss: 3.819 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.46288633346557617
Epoch: 43, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.863 Vali Acc: 0.252 Test Loss: 3.863 Test Acc: 0.252
Validation loss decreased (-0.248198 --> -0.251726).  Saving model ...
Epoch: 44 cost time: 0.5203323364257812
Epoch: 44, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.861 Vali Acc: 0.253 Test Loss: 3.861 Test Acc: 0.253
Validation loss decreased (-0.251726 --> -0.252903).  Saving model ...
Epoch: 45 cost time: 0.447528600692749
Epoch: 45, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.883 Vali Acc: 0.258 Test Loss: 3.883 Test Acc: 0.258
Validation loss decreased (-0.252903 --> -0.257608).  Saving model ...
Epoch: 46 cost time: 0.4827899932861328
Epoch: 46, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.899 Vali Acc: 0.258 Test Loss: 3.899 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.461043119430542
Epoch: 47, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.927 Vali Acc: 0.258 Test Loss: 3.927 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5401694774627686
Epoch: 48, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.956 Vali Acc: 0.253 Test Loss: 3.956 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.47898244857788086
Epoch: 49, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.975 Vali Acc: 0.256 Test Loss: 3.975 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5102221965789795
Epoch: 50, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.998 Vali Acc: 0.255 Test Loss: 3.998 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5173361301422119
Epoch: 51, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.006 Vali Acc: 0.252 Test Loss: 4.006 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.47861623764038086
Epoch: 52, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.011 Vali Acc: 0.259 Test Loss: 4.011 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258783).  Saving model ...
Epoch: 53 cost time: 0.47907543182373047
Epoch: 53, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.026 Vali Acc: 0.255 Test Loss: 4.026 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4651956558227539
Epoch: 54, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.046 Vali Acc: 0.259 Test Loss: 4.046 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.4604625701904297
Epoch: 55, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.048 Vali Acc: 0.264 Test Loss: 4.048 Test Acc: 0.264
Validation loss decreased (-0.258783 --> -0.263489).  Saving model ...
Epoch: 56 cost time: 0.4715597629547119
Epoch: 56, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.063 Vali Acc: 0.264 Test Loss: 4.063 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.45127177238464355
Epoch: 57, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.084 Vali Acc: 0.262 Test Loss: 4.084 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4653487205505371
Epoch: 58, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.099 Vali Acc: 0.262 Test Loss: 4.099 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5126643180847168
Epoch: 59, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.124 Vali Acc: 0.255 Test Loss: 4.124 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.4747486114501953
Epoch: 60, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.131 Vali Acc: 0.258 Test Loss: 4.131 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.4701707363128662
Epoch: 61, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.141 Vali Acc: 0.264 Test Loss: 4.141 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.46790409088134766
Epoch: 62, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.157 Vali Acc: 0.264 Test Loss: 4.157 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.4513814449310303
Epoch: 63, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.173 Vali Acc: 0.266 Test Loss: 4.173 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265841).  Saving model ...
Epoch: 64 cost time: 0.4555227756500244
Epoch: 64, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.169 Vali Acc: 0.262 Test Loss: 4.169 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.4536020755767822
Epoch: 65, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.183 Vali Acc: 0.264 Test Loss: 4.183 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.4630753993988037
Epoch: 66, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.200 Vali Acc: 0.266 Test Loss: 4.200 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.47339820861816406
Epoch: 67, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.205 Vali Acc: 0.267 Test Loss: 4.205 Test Acc: 0.267
Validation loss decreased (-0.265841 --> -0.267017).  Saving model ...
Epoch: 68 cost time: 0.5463216304779053
Epoch: 68, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.218 Vali Acc: 0.269 Test Loss: 4.218 Test Acc: 0.269
Validation loss decreased (-0.267017 --> -0.269370).  Saving model ...
Epoch: 69 cost time: 0.4489903450012207
Epoch: 69, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.233 Vali Acc: 0.269 Test Loss: 4.233 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4610409736633301
Epoch: 70, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.252 Vali Acc: 0.267 Test Loss: 4.252 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.4459812641143799
Epoch: 71, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.278 Vali Acc: 0.265 Test Loss: 4.278 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.47658681869506836
Epoch: 72, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.283 Vali Acc: 0.266 Test Loss: 4.283 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.47606468200683594
Epoch: 73, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.277 Vali Acc: 0.266 Test Loss: 4.277 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.46914124488830566
Epoch: 74, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.287 Vali Acc: 0.264 Test Loss: 4.287 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.47040367126464844
Epoch: 75, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.295 Vali Acc: 0.264 Test Loss: 4.295 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.42377376556396484
Epoch: 76, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.312 Vali Acc: 0.261 Test Loss: 4.312 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.4965660572052002
Epoch: 77, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.326 Vali Acc: 0.261 Test Loss: 4.326 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.48235440254211426
Epoch: 78, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.335 Vali Acc: 0.265 Test Loss: 4.335 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 39322
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.3933100700378418
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.333 Vali Acc: 0.049 Test Loss: 3.333 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.4411587715148926
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.322 Vali Acc: 0.060 Test Loss: 3.322 Test Acc: 0.060
Validation loss decreased (-0.049378 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.45547962188720703
Epoch: 3, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.312 Vali Acc: 0.074 Test Loss: 3.312 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.46415281295776367
Epoch: 4, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.298 Vali Acc: 0.084 Test Loss: 3.298 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083496).  Saving model ...
Epoch: 5 cost time: 0.41507911682128906
Epoch: 5, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.285 Vali Acc: 0.085 Test Loss: 3.285 Test Acc: 0.085
Validation loss decreased (-0.083496 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.450488805770874
Epoch: 6, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.275 Vali Acc: 0.078 Test Loss: 3.275 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4222705364227295
Epoch: 7, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.268 Vali Acc: 0.092 Test Loss: 3.268 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 0.45521092414855957
Epoch: 8, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.264 Vali Acc: 0.092 Test Loss: 3.264 Test Acc: 0.092
Validation loss decreased (-0.091732 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.44765782356262207
Epoch: 9, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.258 Vali Acc: 0.095 Test Loss: 3.258 Test Acc: 0.095
Validation loss decreased (-0.091732 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 0.46991777420043945
Epoch: 10, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.254 Vali Acc: 0.101 Test Loss: 3.254 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.43687868118286133
Epoch: 11, Steps: 10 | Train Loss: 2.500 Vali Loss: 3.243 Vali Acc: 0.115 Test Loss: 3.243 Test Acc: 0.115
Validation loss decreased (-0.101144 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.43027734756469727
Epoch: 12, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.243 Vali Acc: 0.122 Test Loss: 3.243 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.48232316970825195
Epoch: 13, Steps: 10 | Train Loss: 2.280 Vali Loss: 3.244 Vali Acc: 0.122 Test Loss: 3.244 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45966362953186035
Epoch: 14, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.247 Vali Acc: 0.132 Test Loss: 3.247 Test Acc: 0.132
Validation loss decreased (-0.122321 --> -0.131732).  Saving model ...
Epoch: 15 cost time: 0.4641594886779785
Epoch: 15, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.244 Vali Acc: 0.136 Test Loss: 3.244 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 16 cost time: 0.460784912109375
Epoch: 16, Steps: 10 | Train Loss: 1.999 Vali Loss: 3.241 Vali Acc: 0.135 Test Loss: 3.241 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4696836471557617
Epoch: 17, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.247 Vali Acc: 0.146 Test Loss: 3.247 Test Acc: 0.146
Validation loss decreased (-0.136438 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.4506511688232422
Epoch: 18, Steps: 10 | Train Loss: 1.764 Vali Loss: 3.247 Vali Acc: 0.154 Test Loss: 3.247 Test Acc: 0.154
Validation loss decreased (-0.145850 --> -0.154085).  Saving model ...
Epoch: 19 cost time: 0.4613354206085205
Epoch: 19, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.251 Vali Acc: 0.159 Test Loss: 3.251 Test Acc: 0.159
Validation loss decreased (-0.154085 --> -0.158791).  Saving model ...
Epoch: 20 cost time: 0.45787525177001953
Epoch: 20, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.256 Vali Acc: 0.162 Test Loss: 3.256 Test Acc: 0.162
Validation loss decreased (-0.158791 --> -0.162320).  Saving model ...
Epoch: 21 cost time: 0.4595522880554199
Epoch: 21, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.262 Vali Acc: 0.168 Test Loss: 3.262 Test Acc: 0.168
Validation loss decreased (-0.162320 --> -0.168203).  Saving model ...
Epoch: 22 cost time: 0.4471554756164551
Epoch: 22, Steps: 10 | Train Loss: 1.395 Vali Loss: 3.274 Vali Acc: 0.178 Test Loss: 3.274 Test Acc: 0.178
Validation loss decreased (-0.168203 --> -0.177614).  Saving model ...
Epoch: 23 cost time: 0.4810974597930908
Epoch: 23, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.289 Vali Acc: 0.179 Test Loss: 3.289 Test Acc: 0.179
Validation loss decreased (-0.177614 --> -0.178791).  Saving model ...
Epoch: 24 cost time: 0.44438624382019043
Epoch: 24, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.302 Vali Acc: 0.187 Test Loss: 3.302 Test Acc: 0.187
Validation loss decreased (-0.178791 --> -0.187026).  Saving model ...
Epoch: 25 cost time: 0.4706075191497803
Epoch: 25, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.320 Vali Acc: 0.186 Test Loss: 3.320 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.461993932723999
Epoch: 26, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.332 Vali Acc: 0.187 Test Loss: 3.332 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.44274067878723145
Epoch: 27, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.354 Vali Acc: 0.196 Test Loss: 3.354 Test Acc: 0.196
Validation loss decreased (-0.187026 --> -0.196437).  Saving model ...
Epoch: 28 cost time: 0.44441843032836914
Epoch: 28, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.371 Vali Acc: 0.199 Test Loss: 3.371 Test Acc: 0.199
Validation loss decreased (-0.196437 --> -0.198790).  Saving model ...
Epoch: 29 cost time: 0.44640445709228516
Epoch: 29, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.396 Vali Acc: 0.206 Test Loss: 3.396 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205848).  Saving model ...
Epoch: 30 cost time: 0.47556304931640625
Epoch: 30, Steps: 10 | Train Loss: 0.772 Vali Loss: 3.423 Vali Acc: 0.206 Test Loss: 3.423 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4875814914703369
Epoch: 31, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.445 Vali Acc: 0.205 Test Loss: 3.445 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4693279266357422
Epoch: 32, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.464 Vali Acc: 0.207 Test Loss: 3.464 Test Acc: 0.207
Validation loss decreased (-0.205848 --> -0.207024).  Saving model ...
Epoch: 33 cost time: 0.4569275379180908
Epoch: 33, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.482 Vali Acc: 0.213 Test Loss: 3.482 Test Acc: 0.213
Validation loss decreased (-0.207024 --> -0.212906).  Saving model ...
Epoch: 34 cost time: 0.48084092140197754
Epoch: 34, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.504 Vali Acc: 0.214 Test Loss: 3.504 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214083).  Saving model ...
Epoch: 35 cost time: 0.4836430549621582
Epoch: 35, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.536 Vali Acc: 0.220 Test Loss: 3.536 Test Acc: 0.220
Validation loss decreased (-0.214083 --> -0.219965).  Saving model ...
Epoch: 36 cost time: 0.44585442543029785
Epoch: 36, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.566 Vali Acc: 0.216 Test Loss: 3.566 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48326802253723145
Epoch: 37, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.613 Vali Acc: 0.218 Test Loss: 3.613 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.47252869606018066
Epoch: 38, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.638 Vali Acc: 0.219 Test Loss: 3.638 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4689621925354004
Epoch: 39, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.670 Vali Acc: 0.222 Test Loss: 3.670 Test Acc: 0.222
Validation loss decreased (-0.219965 --> -0.222316).  Saving model ...
Epoch: 40 cost time: 0.46287059783935547
Epoch: 40, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.687 Vali Acc: 0.222 Test Loss: 3.687 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.532381534576416
Epoch: 41, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.699 Vali Acc: 0.231 Test Loss: 3.699 Test Acc: 0.231
Validation loss decreased (-0.222316 --> -0.230551).  Saving model ...
Epoch: 42 cost time: 0.4872002601623535
Epoch: 42, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.716 Vali Acc: 0.231 Test Loss: 3.716 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.48255419731140137
Epoch: 43, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.754 Vali Acc: 0.232 Test Loss: 3.754 Test Acc: 0.232
Validation loss decreased (-0.230551 --> -0.231727).  Saving model ...
Epoch: 44 cost time: 0.4615061283111572
Epoch: 44, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.781 Vali Acc: 0.236 Test Loss: 3.781 Test Acc: 0.236
Validation loss decreased (-0.231727 --> -0.236433).  Saving model ...
Epoch: 45 cost time: 0.49178528785705566
Epoch: 45, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.795 Vali Acc: 0.229 Test Loss: 3.795 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4568507671356201
Epoch: 46, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.830 Vali Acc: 0.232 Test Loss: 3.830 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4805176258087158
Epoch: 47, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.859 Vali Acc: 0.232 Test Loss: 3.859 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.49654650688171387
Epoch: 48, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.893 Vali Acc: 0.232 Test Loss: 3.893 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5348544120788574
Epoch: 49, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.922 Vali Acc: 0.236 Test Loss: 3.922 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.47911596298217773
Epoch: 50, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.948 Vali Acc: 0.236 Test Loss: 3.948 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.4566769599914551
Epoch: 51, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.973 Vali Acc: 0.236 Test Loss: 3.973 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.4722871780395508
Epoch: 52, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.984 Vali Acc: 0.236 Test Loss: 3.984 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.4786062240600586
Epoch: 53, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.003 Vali Acc: 0.233 Test Loss: 4.003 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5001721382141113
Epoch: 54, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.018 Vali Acc: 0.236 Test Loss: 4.018 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 32090
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5947165489196777
Epoch: 1, Steps: 10 | Train Loss: 3.488 Vali Loss: 3.377 Vali Acc: 0.040 Test Loss: 3.377 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4575488567352295
Epoch: 2, Steps: 10 | Train Loss: 3.454 Vali Loss: 3.364 Vali Acc: 0.028 Test Loss: 3.364 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4639134407043457
Epoch: 3, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.350 Vali Acc: 0.033 Test Loss: 3.350 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.483262300491333
Epoch: 4, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.334 Vali Acc: 0.045 Test Loss: 3.334 Test Acc: 0.045
Validation loss decreased (-0.039966 --> -0.044673).  Saving model ...
Epoch: 5 cost time: 0.4650084972381592
Epoch: 5, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.320 Vali Acc: 0.052 Test Loss: 3.320 Test Acc: 0.052
Validation loss decreased (-0.044673 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 0.5007855892181396
Epoch: 6, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.307 Vali Acc: 0.058 Test Loss: 3.307 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 0.4208869934082031
Epoch: 7, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.296 Vali Acc: 0.064 Test Loss: 3.296 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063496).  Saving model ...
Epoch: 8 cost time: 0.47327232360839844
Epoch: 8, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.290 Vali Acc: 0.066 Test Loss: 3.290 Test Acc: 0.066
Validation loss decreased (-0.063496 --> -0.065849).  Saving model ...
Epoch: 9 cost time: 0.4641733169555664
Epoch: 9, Steps: 10 | Train Loss: 2.846 Vali Loss: 3.288 Vali Acc: 0.076 Test Loss: 3.288 Test Acc: 0.076
Validation loss decreased (-0.065849 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 0.502821683883667
Epoch: 10, Steps: 10 | Train Loss: 2.688 Vali Loss: 3.283 Vali Acc: 0.084 Test Loss: 3.283 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 11 cost time: 0.45158839225769043
Epoch: 11, Steps: 10 | Train Loss: 2.655 Vali Loss: 3.281 Vali Acc: 0.093 Test Loss: 3.281 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092908).  Saving model ...
Epoch: 12 cost time: 0.48317432403564453
Epoch: 12, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.277 Vali Acc: 0.093 Test Loss: 3.277 Test Acc: 0.093
Validation loss decreased (-0.092908 --> -0.092908).  Saving model ...
Epoch: 13 cost time: 0.4406116008758545
Epoch: 13, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.269 Vali Acc: 0.105 Test Loss: 3.269 Test Acc: 0.105
Validation loss decreased (-0.092908 --> -0.104673).  Saving model ...
Epoch: 14 cost time: 0.4792041778564453
Epoch: 14, Steps: 10 | Train Loss: 2.407 Vali Loss: 3.265 Vali Acc: 0.113 Test Loss: 3.265 Test Acc: 0.113
Validation loss decreased (-0.104673 --> -0.112909).  Saving model ...
Epoch: 15 cost time: 0.46731066703796387
Epoch: 15, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.262 Vali Acc: 0.119 Test Loss: 3.262 Test Acc: 0.119
Validation loss decreased (-0.112909 --> -0.118791).  Saving model ...
Epoch: 16 cost time: 0.3822288513183594
Epoch: 16, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.259 Vali Acc: 0.125 Test Loss: 3.259 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124673).  Saving model ...
Epoch: 17 cost time: 0.5102488994598389
Epoch: 17, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.254 Vali Acc: 0.126 Test Loss: 3.254 Test Acc: 0.126
Validation loss decreased (-0.124673 --> -0.125850).  Saving model ...
Epoch: 18 cost time: 0.43990230560302734
Epoch: 18, Steps: 10 | Train Loss: 1.921 Vali Loss: 3.252 Vali Acc: 0.136 Test Loss: 3.252 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 19 cost time: 0.4764251708984375
Epoch: 19, Steps: 10 | Train Loss: 1.828 Vali Loss: 3.252 Vali Acc: 0.142 Test Loss: 3.252 Test Acc: 0.142
Validation loss decreased (-0.136438 --> -0.142320).  Saving model ...
Epoch: 20 cost time: 0.452298641204834
Epoch: 20, Steps: 10 | Train Loss: 1.742 Vali Loss: 3.255 Vali Acc: 0.147 Test Loss: 3.255 Test Acc: 0.147
Validation loss decreased (-0.142320 --> -0.147026).  Saving model ...
Epoch: 21 cost time: 0.45058751106262207
Epoch: 21, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.256 Vali Acc: 0.154 Test Loss: 3.256 Test Acc: 0.154
Validation loss decreased (-0.147026 --> -0.154085).  Saving model ...
Epoch: 22 cost time: 0.47696971893310547
Epoch: 22, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.267 Vali Acc: 0.160 Test Loss: 3.267 Test Acc: 0.160
Validation loss decreased (-0.154085 --> -0.159967).  Saving model ...
Epoch: 23 cost time: 0.47687220573425293
Epoch: 23, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.278 Vali Acc: 0.168 Test Loss: 3.278 Test Acc: 0.168
Validation loss decreased (-0.159967 --> -0.168203).  Saving model ...
Epoch: 24 cost time: 0.4929056167602539
Epoch: 24, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.286 Vali Acc: 0.173 Test Loss: 3.286 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172908).  Saving model ...
Epoch: 25 cost time: 0.4739499092102051
Epoch: 25, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.289 Vali Acc: 0.176 Test Loss: 3.289 Test Acc: 0.176
Validation loss decreased (-0.172908 --> -0.176438).  Saving model ...
Epoch: 26 cost time: 0.44907045364379883
Epoch: 26, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.307 Vali Acc: 0.179 Test Loss: 3.307 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178790).  Saving model ...
Epoch: 27 cost time: 0.4621405601501465
Epoch: 27, Steps: 10 | Train Loss: 1.157 Vali Loss: 3.320 Vali Acc: 0.189 Test Loss: 3.320 Test Acc: 0.189
Validation loss decreased (-0.178790 --> -0.189379).  Saving model ...
Epoch: 28 cost time: 0.48728513717651367
Epoch: 28, Steps: 10 | Train Loss: 1.086 Vali Loss: 3.335 Vali Acc: 0.194 Test Loss: 3.335 Test Acc: 0.194
Validation loss decreased (-0.189379 --> -0.194084).  Saving model ...
Epoch: 29 cost time: 0.4663562774658203
Epoch: 29, Steps: 10 | Train Loss: 0.991 Vali Loss: 3.355 Vali Acc: 0.200 Test Loss: 3.355 Test Acc: 0.200
Validation loss decreased (-0.194084 --> -0.199966).  Saving model ...
Epoch: 30 cost time: 0.41940736770629883
Epoch: 30, Steps: 10 | Train Loss: 0.931 Vali Loss: 3.375 Vali Acc: 0.198 Test Loss: 3.375 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4798088073730469
Epoch: 31, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.396 Vali Acc: 0.201 Test Loss: 3.396 Test Acc: 0.201
Validation loss decreased (-0.199966 --> -0.201143).  Saving model ...
Epoch: 32 cost time: 0.4397563934326172
Epoch: 32, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.408 Vali Acc: 0.207 Test Loss: 3.408 Test Acc: 0.207
Validation loss decreased (-0.201143 --> -0.207025).  Saving model ...
Epoch: 33 cost time: 0.5032615661621094
Epoch: 33, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.436 Vali Acc: 0.211 Test Loss: 3.436 Test Acc: 0.211
Validation loss decreased (-0.207025 --> -0.210554).  Saving model ...
Epoch: 34 cost time: 0.45525026321411133
Epoch: 34, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.453 Vali Acc: 0.216 Test Loss: 3.453 Test Acc: 0.216
Validation loss decreased (-0.210554 --> -0.216436).  Saving model ...
Epoch: 35 cost time: 0.507073163986206
Epoch: 35, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.464 Vali Acc: 0.221 Test Loss: 3.464 Test Acc: 0.221
Validation loss decreased (-0.216436 --> -0.221142).  Saving model ...
Epoch: 36 cost time: 0.5087518692016602
Epoch: 36, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.494 Vali Acc: 0.224 Test Loss: 3.494 Test Acc: 0.224
Validation loss decreased (-0.221142 --> -0.223494).  Saving model ...
Epoch: 37 cost time: 0.4795560836791992
Epoch: 37, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.507 Vali Acc: 0.227 Test Loss: 3.507 Test Acc: 0.227
Validation loss decreased (-0.223494 --> -0.227024).  Saving model ...
Epoch: 38 cost time: 0.47562599182128906
Epoch: 38, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.540 Vali Acc: 0.229 Test Loss: 3.540 Test Acc: 0.229
Validation loss decreased (-0.227024 --> -0.229376).  Saving model ...
Epoch: 39 cost time: 0.453474760055542
Epoch: 39, Steps: 10 | Train Loss: 0.407 Vali Loss: 3.557 Vali Acc: 0.234 Test Loss: 3.557 Test Acc: 0.234
Validation loss decreased (-0.229376 --> -0.234082).  Saving model ...
Epoch: 40 cost time: 0.47043704986572266
Epoch: 40, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.571 Vali Acc: 0.236 Test Loss: 3.571 Test Acc: 0.236
Validation loss decreased (-0.234082 --> -0.236435).  Saving model ...
Epoch: 41 cost time: 0.4560356140136719
Epoch: 41, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.598 Vali Acc: 0.240 Test Loss: 3.598 Test Acc: 0.240
Validation loss decreased (-0.236435 --> -0.239964).  Saving model ...
Epoch: 42 cost time: 0.47069382667541504
Epoch: 42, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.608 Vali Acc: 0.242 Test Loss: 3.608 Test Acc: 0.242
Validation loss decreased (-0.239964 --> -0.242317).  Saving model ...
Epoch: 43 cost time: 0.45806145668029785
Epoch: 43, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.631 Vali Acc: 0.248 Test Loss: 3.631 Test Acc: 0.248
Validation loss decreased (-0.242317 --> -0.248199).  Saving model ...
Epoch: 44 cost time: 0.49643635749816895
Epoch: 44, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.655 Vali Acc: 0.251 Test Loss: 3.655 Test Acc: 0.251
Validation loss decreased (-0.248199 --> -0.250552).  Saving model ...
Epoch: 45 cost time: 0.471466064453125
Epoch: 45, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.659 Vali Acc: 0.248 Test Loss: 3.659 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4684720039367676
Epoch: 46, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.671 Vali Acc: 0.252 Test Loss: 3.671 Test Acc: 0.252
Validation loss decreased (-0.250552 --> -0.251728).  Saving model ...
Epoch: 47 cost time: 0.4653315544128418
Epoch: 47, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.701 Vali Acc: 0.255 Test Loss: 3.701 Test Acc: 0.255
Validation loss decreased (-0.251728 --> -0.255257).  Saving model ...
Epoch: 48 cost time: 0.48421359062194824
Epoch: 48, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.737 Vali Acc: 0.251 Test Loss: 3.737 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4646308422088623
Epoch: 49, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.747 Vali Acc: 0.259 Test Loss: 3.747 Test Acc: 0.259
Validation loss decreased (-0.255257 --> -0.258786).  Saving model ...
Epoch: 50 cost time: 0.4905741214752197
Epoch: 50, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.760 Vali Acc: 0.246 Test Loss: 3.760 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4404327869415283
Epoch: 51, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.774 Vali Acc: 0.252 Test Loss: 3.774 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4506242275238037
Epoch: 52, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.790 Vali Acc: 0.249 Test Loss: 3.790 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.46968841552734375
Epoch: 53, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.798 Vali Acc: 0.251 Test Loss: 3.798 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.4663267135620117
Epoch: 54, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.824 Vali Acc: 0.254 Test Loss: 3.824 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.4482142925262451
Epoch: 55, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.834 Vali Acc: 0.254 Test Loss: 3.834 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.47977519035339355
Epoch: 56, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.853 Vali Acc: 0.258 Test Loss: 3.853 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.45946741104125977
Epoch: 57, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.867 Vali Acc: 0.252 Test Loss: 3.867 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.45287489891052246
Epoch: 58, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.895 Vali Acc: 0.251 Test Loss: 3.895 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.5086565017700195
Epoch: 59, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.901 Vali Acc: 0.247 Test Loss: 3.901 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm32_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 29818
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6102588176727295
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.352 Vali Acc: 0.048 Test Loss: 3.352 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.4994039535522461
Epoch: 2, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.337 Vali Acc: 0.062 Test Loss: 3.337 Test Acc: 0.062
Validation loss decreased (-0.048202 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.4610331058502197
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.376 Vali Acc: 0.059 Test Loss: 3.376 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47803688049316406
Epoch: 4, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.355 Vali Acc: 0.088 Test Loss: 3.355 Test Acc: 0.088
Validation loss decreased (-0.062320 --> -0.088202).  Saving model ...
Epoch: 5 cost time: 0.494610071182251
Epoch: 5, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.311 Vali Acc: 0.118 Test Loss: 3.311 Test Acc: 0.118
Validation loss decreased (-0.088202 --> -0.117614).  Saving model ...
Epoch: 6 cost time: 0.4862072467803955
Epoch: 6, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.285 Vali Acc: 0.128 Test Loss: 3.285 Test Acc: 0.128
Validation loss decreased (-0.117614 --> -0.128202).  Saving model ...
Epoch: 7 cost time: 0.467374324798584
Epoch: 7, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.234 Vali Acc: 0.138 Test Loss: 3.234 Test Acc: 0.138
Validation loss decreased (-0.128202 --> -0.137615).  Saving model ...
Epoch: 8 cost time: 0.46815061569213867
Epoch: 8, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.245 Vali Acc: 0.141 Test Loss: 3.245 Test Acc: 0.141
Validation loss decreased (-0.137615 --> -0.141144).  Saving model ...
Epoch: 9 cost time: 0.4769246578216553
Epoch: 9, Steps: 10 | Train Loss: 1.956 Vali Loss: 3.271 Vali Acc: 0.148 Test Loss: 3.271 Test Acc: 0.148
Validation loss decreased (-0.141144 --> -0.148203).  Saving model ...
Epoch: 10 cost time: 0.46570444107055664
Epoch: 10, Steps: 10 | Train Loss: 1.663 Vali Loss: 3.240 Vali Acc: 0.162 Test Loss: 3.240 Test Acc: 0.162
Validation loss decreased (-0.148203 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 0.4847686290740967
Epoch: 11, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.235 Vali Acc: 0.184 Test Loss: 3.235 Test Acc: 0.184
Validation loss decreased (-0.162321 --> -0.183497).  Saving model ...
Epoch: 12 cost time: 0.4786083698272705
Epoch: 12, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.298 Vali Acc: 0.187 Test Loss: 3.298 Test Acc: 0.187
Validation loss decreased (-0.183497 --> -0.187026).  Saving model ...
Epoch: 13 cost time: 0.46013641357421875
Epoch: 13, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.330 Vali Acc: 0.211 Test Loss: 3.330 Test Acc: 0.211
Validation loss decreased (-0.187026 --> -0.210555).  Saving model ...
Epoch: 14 cost time: 0.4912078380584717
Epoch: 14, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.342 Vali Acc: 0.214 Test Loss: 3.342 Test Acc: 0.214
Validation loss decreased (-0.210555 --> -0.214084).  Saving model ...
Epoch: 15 cost time: 0.5031330585479736
Epoch: 15, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.380 Vali Acc: 0.234 Test Loss: 3.380 Test Acc: 0.234
Validation loss decreased (-0.214084 --> -0.234084).  Saving model ...
Epoch: 16 cost time: 0.4459362030029297
Epoch: 16, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.429 Vali Acc: 0.227 Test Loss: 3.429 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4891848564147949
Epoch: 17, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.507 Vali Acc: 0.244 Test Loss: 3.507 Test Acc: 0.244
Validation loss decreased (-0.234084 --> -0.243494).  Saving model ...
Epoch: 18 cost time: 0.5607154369354248
Epoch: 18, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.549 Vali Acc: 0.246 Test Loss: 3.549 Test Acc: 0.246
Validation loss decreased (-0.243494 --> -0.245847).  Saving model ...
Epoch: 19 cost time: 0.48740053176879883
Epoch: 19, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.623 Vali Acc: 0.241 Test Loss: 3.623 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4911463260650635
Epoch: 20, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.688 Vali Acc: 0.259 Test Loss: 3.688 Test Acc: 0.259
Validation loss decreased (-0.245847 --> -0.258787).  Saving model ...
Epoch: 21 cost time: 0.5066368579864502
Epoch: 21, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.787 Vali Acc: 0.256 Test Loss: 3.787 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5014200210571289
Epoch: 22, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.863 Vali Acc: 0.260 Test Loss: 3.863 Test Acc: 0.260
Validation loss decreased (-0.258787 --> -0.259961).  Saving model ...
Epoch: 23 cost time: 0.4968552589416504
Epoch: 23, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.910 Vali Acc: 0.260 Test Loss: 3.910 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5042505264282227
Epoch: 24, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.939 Vali Acc: 0.264 Test Loss: 3.939 Test Acc: 0.264
Validation loss decreased (-0.259961 --> -0.263490).  Saving model ...
Epoch: 25 cost time: 0.5075154304504395
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.983 Vali Acc: 0.268 Test Loss: 3.983 Test Acc: 0.268
Validation loss decreased (-0.263490 --> -0.268195).  Saving model ...
Epoch: 26 cost time: 0.4900691509246826
Epoch: 26, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.037 Vali Acc: 0.261 Test Loss: 4.037 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4980635643005371
Epoch: 27, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.033 Vali Acc: 0.267 Test Loss: 4.033 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5164058208465576
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.086 Vali Acc: 0.267 Test Loss: 4.086 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5056824684143066
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.136 Vali Acc: 0.268 Test Loss: 4.136 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4976541996002197
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.159 Vali Acc: 0.269 Test Loss: 4.159 Test Acc: 0.269
Validation loss decreased (-0.268195 --> -0.269370).  Saving model ...
Epoch: 31 cost time: 0.499509334564209
Epoch: 31, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.186 Vali Acc: 0.266 Test Loss: 4.186 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5202476978302002
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.216 Vali Acc: 0.271 Test Loss: 4.216 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270546).  Saving model ...
Epoch: 33 cost time: 0.5591714382171631
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.247 Vali Acc: 0.266 Test Loss: 4.247 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5274579524993896
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.269 Vali Acc: 0.271 Test Loss: 4.269 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5133686065673828
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.289 Vali Acc: 0.273 Test Loss: 4.289 Test Acc: 0.273
Validation loss decreased (-0.270546 --> -0.272898).  Saving model ...
Epoch: 36 cost time: 0.49280309677124023
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.331 Vali Acc: 0.272 Test Loss: 4.331 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4783473014831543
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.344 Vali Acc: 0.278 Test Loss: 4.344 Test Acc: 0.278
Validation loss decreased (-0.272898 --> -0.277604).  Saving model ...
Epoch: 38 cost time: 0.496551513671875
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.363 Vali Acc: 0.280 Test Loss: 4.363 Test Acc: 0.280
Validation loss decreased (-0.277604 --> -0.279956).  Saving model ...
Epoch: 39 cost time: 0.4954559803009033
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.372 Vali Acc: 0.275 Test Loss: 4.372 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4694535732269287
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.426 Vali Acc: 0.271 Test Loss: 4.426 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4790194034576416
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.444 Vali Acc: 0.271 Test Loss: 4.444 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4925670623779297
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.448 Vali Acc: 0.273 Test Loss: 4.448 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5199277400970459
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.453 Vali Acc: 0.273 Test Loss: 4.453 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5002627372741699
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.464 Vali Acc: 0.279 Test Loss: 4.464 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.46594691276550293
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.464 Vali Acc: 0.278 Test Loss: 4.464 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5381696224212646
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.475 Vali Acc: 0.274 Test Loss: 4.475 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.46491074562072754
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.498 Vali Acc: 0.280 Test Loss: 4.498 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4740183353424072
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.514 Vali Acc: 0.280 Test Loss: 4.514 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 104586
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4439375400543213
Epoch: 1, Steps: 10 | Train Loss: 3.458 Vali Loss: 3.356 Vali Acc: 0.031 Test Loss: 3.356 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.4507756233215332
Epoch: 2, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.330 Vali Acc: 0.042 Test Loss: 3.330 Test Acc: 0.042
Validation loss decreased (-0.030555 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.46040868759155273
Epoch: 3, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.323 Vali Acc: 0.049 Test Loss: 3.323 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.46135973930358887
Epoch: 4, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.334 Vali Acc: 0.064 Test Loss: 3.334 Test Acc: 0.064
Validation loss decreased (-0.049379 --> -0.063496).  Saving model ...
Epoch: 5 cost time: 0.5199987888336182
Epoch: 5, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.326 Vali Acc: 0.079 Test Loss: 3.326 Test Acc: 0.079
Validation loss decreased (-0.063496 --> -0.078790).  Saving model ...
Epoch: 6 cost time: 0.4679570198059082
Epoch: 6, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.318 Vali Acc: 0.086 Test Loss: 3.318 Test Acc: 0.086
Validation loss decreased (-0.078790 --> -0.085849).  Saving model ...
Epoch: 7 cost time: 0.433682918548584
Epoch: 7, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.287 Vali Acc: 0.105 Test Loss: 3.287 Test Acc: 0.105
Validation loss decreased (-0.085849 --> -0.104673).  Saving model ...
Epoch: 8 cost time: 0.45044469833374023
Epoch: 8, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.269 Vali Acc: 0.114 Test Loss: 3.269 Test Acc: 0.114
Validation loss decreased (-0.104673 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.4377408027648926
Epoch: 9, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.254 Vali Acc: 0.125 Test Loss: 3.254 Test Acc: 0.125
Validation loss decreased (-0.114085 --> -0.124673).  Saving model ...
Epoch: 10 cost time: 0.42748141288757324
Epoch: 10, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.227 Vali Acc: 0.134 Test Loss: 3.227 Test Acc: 0.134
Validation loss decreased (-0.124673 --> -0.134085).  Saving model ...
Epoch: 11 cost time: 0.4578382968902588
Epoch: 11, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.232 Vali Acc: 0.149 Test Loss: 3.232 Test Acc: 0.149
Validation loss decreased (-0.134085 --> -0.149379).  Saving model ...
Epoch: 12 cost time: 0.42878079414367676
Epoch: 12, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.228 Vali Acc: 0.144 Test Loss: 3.228 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4222233295440674
Epoch: 13, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.221 Vali Acc: 0.155 Test Loss: 3.221 Test Acc: 0.155
Validation loss decreased (-0.149379 --> -0.155262).  Saving model ...
Epoch: 14 cost time: 0.4432833194732666
Epoch: 14, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.225 Vali Acc: 0.169 Test Loss: 3.225 Test Acc: 0.169
Validation loss decreased (-0.155262 --> -0.169380).  Saving model ...
Epoch: 15 cost time: 0.4427025318145752
Epoch: 15, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.245 Vali Acc: 0.176 Test Loss: 3.245 Test Acc: 0.176
Validation loss decreased (-0.169380 --> -0.176438).  Saving model ...
Epoch: 16 cost time: 0.4473295211791992
Epoch: 16, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.243 Vali Acc: 0.195 Test Loss: 3.243 Test Acc: 0.195
Validation loss decreased (-0.176438 --> -0.195262).  Saving model ...
Epoch: 17 cost time: 0.43155717849731445
Epoch: 17, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.266 Vali Acc: 0.202 Test Loss: 3.266 Test Acc: 0.202
Validation loss decreased (-0.195262 --> -0.202320).  Saving model ...
Epoch: 18 cost time: 0.4346272945404053
Epoch: 18, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.295 Vali Acc: 0.199 Test Loss: 3.295 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4469890594482422
Epoch: 19, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.315 Vali Acc: 0.214 Test Loss: 3.315 Test Acc: 0.214
Validation loss decreased (-0.202320 --> -0.214084).  Saving model ...
Epoch: 20 cost time: 0.4402480125427246
Epoch: 20, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.336 Vali Acc: 0.218 Test Loss: 3.336 Test Acc: 0.218
Validation loss decreased (-0.214084 --> -0.217614).  Saving model ...
Epoch: 21 cost time: 0.4389355182647705
Epoch: 21, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.374 Vali Acc: 0.227 Test Loss: 3.374 Test Acc: 0.227
Validation loss decreased (-0.217614 --> -0.227025).  Saving model ...
Epoch: 22 cost time: 0.5172088146209717
Epoch: 22, Steps: 10 | Train Loss: 0.678 Vali Loss: 3.403 Vali Acc: 0.231 Test Loss: 3.403 Test Acc: 0.231
Validation loss decreased (-0.227025 --> -0.230554).  Saving model ...
Epoch: 23 cost time: 0.4218924045562744
Epoch: 23, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.419 Vali Acc: 0.244 Test Loss: 3.419 Test Acc: 0.244
Validation loss decreased (-0.230554 --> -0.243495).  Saving model ...
Epoch: 24 cost time: 0.4304471015930176
Epoch: 24, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.466 Vali Acc: 0.236 Test Loss: 3.466 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.44906139373779297
Epoch: 25, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.513 Vali Acc: 0.241 Test Loss: 3.513 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4315805435180664
Epoch: 26, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.557 Vali Acc: 0.245 Test Loss: 3.557 Test Acc: 0.245
Validation loss decreased (-0.243495 --> -0.244670).  Saving model ...
Epoch: 27 cost time: 0.4586625099182129
Epoch: 27, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.623 Vali Acc: 0.254 Test Loss: 3.623 Test Acc: 0.254
Validation loss decreased (-0.244670 --> -0.254081).  Saving model ...
Epoch: 28 cost time: 0.45829057693481445
Epoch: 28, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.663 Vali Acc: 0.252 Test Loss: 3.663 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4302082061767578
Epoch: 29, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.719 Vali Acc: 0.259 Test Loss: 3.719 Test Acc: 0.259
Validation loss decreased (-0.254081 --> -0.258786).  Saving model ...
Epoch: 30 cost time: 0.4337043762207031
Epoch: 30, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.771 Vali Acc: 0.261 Test Loss: 3.771 Test Acc: 0.261
Validation loss decreased (-0.258786 --> -0.261139).  Saving model ...
Epoch: 31 cost time: 0.4212198257446289
Epoch: 31, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.795 Vali Acc: 0.266 Test Loss: 3.795 Test Acc: 0.266
Validation loss decreased (-0.261139 --> -0.265844).  Saving model ...
Epoch: 32 cost time: 0.42557215690612793
Epoch: 32, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.822 Vali Acc: 0.266 Test Loss: 3.822 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4400980472564697
Epoch: 33, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.863 Vali Acc: 0.264 Test Loss: 3.863 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4445381164550781
Epoch: 34, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.935 Vali Acc: 0.255 Test Loss: 3.935 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.42289161682128906
Epoch: 35, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.947 Vali Acc: 0.258 Test Loss: 3.947 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.43191981315612793
Epoch: 36, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.978 Vali Acc: 0.264 Test Loss: 3.978 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.413663387298584
Epoch: 37, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.996 Vali Acc: 0.266 Test Loss: 3.996 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.44749021530151367
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.060 Vali Acc: 0.269 Test Loss: 4.060 Test Acc: 0.269
Validation loss decreased (-0.265844 --> -0.269371).  Saving model ...
Epoch: 39 cost time: 0.41759300231933594
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.079 Vali Acc: 0.265 Test Loss: 4.079 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.43096160888671875
Epoch: 40, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.081 Vali Acc: 0.265 Test Loss: 4.081 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4456965923309326
Epoch: 41, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.108 Vali Acc: 0.268 Test Loss: 4.108 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4423062801361084
Epoch: 42, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.131 Vali Acc: 0.267 Test Loss: 4.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.48868417739868164
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.166 Vali Acc: 0.271 Test Loss: 4.166 Test Acc: 0.271
Validation loss decreased (-0.269371 --> -0.270547).  Saving model ...
Epoch: 44 cost time: 0.44028782844543457
Epoch: 44, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.205 Vali Acc: 0.268 Test Loss: 4.205 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4518301486968994
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.227 Vali Acc: 0.271 Test Loss: 4.227 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4705502986907959
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.229 Vali Acc: 0.268 Test Loss: 4.229 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4428749084472656
Epoch: 47, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.259 Vali Acc: 0.265 Test Loss: 4.259 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4848334789276123
Epoch: 48, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.265 Vali Acc: 0.262 Test Loss: 4.265 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4954695701599121
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.273 Vali Acc: 0.264 Test Loss: 4.273 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.44924497604370117
Epoch: 50, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.301 Vali Acc: 0.258 Test Loss: 4.301 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.4715423583984375
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.327 Vali Acc: 0.258 Test Loss: 4.327 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.4449012279510498
Epoch: 52, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.355 Vali Acc: 0.266 Test Loss: 4.355 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.4862210750579834
Epoch: 53, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.378 Vali Acc: 0.266 Test Loss: 4.378 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 57226
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5410687923431396
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.376 Vali Acc: 0.042 Test Loss: 3.376 Test Acc: 0.042
Validation loss decreased (inf --> -0.042319).  Saving model ...
Epoch: 2 cost time: 0.43735671043395996
Epoch: 2, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.344 Vali Acc: 0.049 Test Loss: 3.344 Test Acc: 0.049
Validation loss decreased (-0.042319 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.45878124237060547
Epoch: 3, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.327 Vali Acc: 0.053 Test Loss: 3.327 Test Acc: 0.053
Validation loss decreased (-0.049378 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.42374587059020996
Epoch: 4, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.318 Vali Acc: 0.058 Test Loss: 3.318 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.4528622627258301
Epoch: 5, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.311 Vali Acc: 0.072 Test Loss: 3.311 Test Acc: 0.072
Validation loss decreased (-0.057614 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.4270145893096924
Epoch: 6, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.308 Vali Acc: 0.075 Test Loss: 3.308 Test Acc: 0.075
Validation loss decreased (-0.071732 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.410489559173584
Epoch: 7, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.306 Vali Acc: 0.080 Test Loss: 3.306 Test Acc: 0.080
Validation loss decreased (-0.075261 --> -0.079967).  Saving model ...
Epoch: 8 cost time: 0.3728795051574707
Epoch: 8, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.294 Vali Acc: 0.091 Test Loss: 3.294 Test Acc: 0.091
Validation loss decreased (-0.079967 --> -0.090555).  Saving model ...
Epoch: 9 cost time: 0.4271981716156006
Epoch: 9, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.280 Vali Acc: 0.100 Test Loss: 3.280 Test Acc: 0.100
Validation loss decreased (-0.090555 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 0.4118380546569824
Epoch: 10, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.258 Vali Acc: 0.108 Test Loss: 3.258 Test Acc: 0.108
Validation loss decreased (-0.099967 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.4315059185028076
Epoch: 11, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.240 Vali Acc: 0.120 Test Loss: 3.240 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.4581923484802246
Epoch: 12, Steps: 10 | Train Loss: 2.296 Vali Loss: 3.228 Vali Acc: 0.125 Test Loss: 3.228 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124674).  Saving model ...
Epoch: 13 cost time: 0.4533576965332031
Epoch: 13, Steps: 10 | Train Loss: 2.138 Vali Loss: 3.213 Vali Acc: 0.131 Test Loss: 3.213 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 0.5001473426818848
Epoch: 14, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.205 Vali Acc: 0.140 Test Loss: 3.205 Test Acc: 0.140
Validation loss decreased (-0.130556 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.42176342010498047
Epoch: 15, Steps: 10 | Train Loss: 1.794 Vali Loss: 3.207 Vali Acc: 0.161 Test Loss: 3.207 Test Acc: 0.161
Validation loss decreased (-0.139968 --> -0.161144).  Saving model ...
Epoch: 16 cost time: 0.47220301628112793
Epoch: 16, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.194 Vali Acc: 0.167 Test Loss: 3.194 Test Acc: 0.167
Validation loss decreased (-0.161144 --> -0.167027).  Saving model ...
Epoch: 17 cost time: 0.4576539993286133
Epoch: 17, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.204 Vali Acc: 0.168 Test Loss: 3.204 Test Acc: 0.168
Validation loss decreased (-0.167027 --> -0.168203).  Saving model ...
Epoch: 18 cost time: 0.46044421195983887
Epoch: 18, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.192 Vali Acc: 0.184 Test Loss: 3.192 Test Acc: 0.184
Validation loss decreased (-0.168203 --> -0.183497).  Saving model ...
Epoch: 19 cost time: 0.4701979160308838
Epoch: 19, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.198 Vali Acc: 0.192 Test Loss: 3.198 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191733).  Saving model ...
Epoch: 20 cost time: 0.4447774887084961
Epoch: 20, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.210 Vali Acc: 0.196 Test Loss: 3.210 Test Acc: 0.196
Validation loss decreased (-0.191733 --> -0.196438).  Saving model ...
Epoch: 21 cost time: 0.4126758575439453
Epoch: 21, Steps: 10 | Train Loss: 1.159 Vali Loss: 3.231 Vali Acc: 0.199 Test Loss: 3.231 Test Acc: 0.199
Validation loss decreased (-0.196438 --> -0.198791).  Saving model ...
Epoch: 22 cost time: 0.4526081085205078
Epoch: 22, Steps: 10 | Train Loss: 1.021 Vali Loss: 3.240 Vali Acc: 0.214 Test Loss: 3.240 Test Acc: 0.214
Validation loss decreased (-0.198791 --> -0.214085).  Saving model ...
Epoch: 23 cost time: 0.4547410011291504
Epoch: 23, Steps: 10 | Train Loss: 0.945 Vali Loss: 3.251 Vali Acc: 0.224 Test Loss: 3.251 Test Acc: 0.224
Validation loss decreased (-0.214085 --> -0.223497).  Saving model ...
Epoch: 24 cost time: 0.41609668731689453
Epoch: 24, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.269 Vali Acc: 0.231 Test Loss: 3.269 Test Acc: 0.231
Validation loss decreased (-0.223497 --> -0.230556).  Saving model ...
Epoch: 25 cost time: 0.4517326354980469
Epoch: 25, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.305 Vali Acc: 0.235 Test Loss: 3.305 Test Acc: 0.235
Validation loss decreased (-0.230556 --> -0.235261).  Saving model ...
Epoch: 26 cost time: 0.39391088485717773
Epoch: 26, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.325 Vali Acc: 0.235 Test Loss: 3.325 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4346191883087158
Epoch: 27, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.349 Vali Acc: 0.240 Test Loss: 3.349 Test Acc: 0.240
Validation loss decreased (-0.235261 --> -0.239967).  Saving model ...
Epoch: 28 cost time: 0.4375588893890381
Epoch: 28, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.371 Vali Acc: 0.238 Test Loss: 3.371 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45805835723876953
Epoch: 29, Steps: 10 | Train Loss: 0.468 Vali Loss: 3.388 Vali Acc: 0.241 Test Loss: 3.388 Test Acc: 0.241
Validation loss decreased (-0.239967 --> -0.241143).  Saving model ...
Epoch: 30 cost time: 0.42553234100341797
Epoch: 30, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.409 Vali Acc: 0.251 Test Loss: 3.409 Test Acc: 0.251
Validation loss decreased (-0.241143 --> -0.250554).  Saving model ...
Epoch: 31 cost time: 0.4446694850921631
Epoch: 31, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.449 Vali Acc: 0.244 Test Loss: 3.449 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.42914891242980957
Epoch: 32, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.481 Vali Acc: 0.246 Test Loss: 3.481 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4535980224609375
Epoch: 33, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.525 Vali Acc: 0.247 Test Loss: 3.525 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.47896885871887207
Epoch: 34, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.550 Vali Acc: 0.247 Test Loss: 3.550 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4738962650299072
Epoch: 35, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.583 Vali Acc: 0.240 Test Loss: 3.583 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.43314695358276367
Epoch: 36, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.613 Vali Acc: 0.244 Test Loss: 3.613 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.43416309356689453
Epoch: 37, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.650 Vali Acc: 0.244 Test Loss: 3.650 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4366590976715088
Epoch: 38, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.663 Vali Acc: 0.247 Test Loss: 3.663 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4227023124694824
Epoch: 39, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.678 Vali Acc: 0.252 Test Loss: 3.678 Test Acc: 0.252
Validation loss decreased (-0.250554 --> -0.251728).  Saving model ...
Epoch: 40 cost time: 0.40547633171081543
Epoch: 40, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.692 Vali Acc: 0.251 Test Loss: 3.692 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.45853471755981445
Epoch: 41, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.707 Vali Acc: 0.256 Test Loss: 3.707 Test Acc: 0.256
Validation loss decreased (-0.251728 --> -0.256434).  Saving model ...
Epoch: 42 cost time: 0.43942809104919434
Epoch: 42, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.729 Vali Acc: 0.249 Test Loss: 3.729 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.48795127868652344
Epoch: 43, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.768 Vali Acc: 0.246 Test Loss: 3.768 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4471461772918701
Epoch: 44, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.793 Vali Acc: 0.242 Test Loss: 3.793 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.4710407257080078
Epoch: 45, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.829 Vali Acc: 0.240 Test Loss: 3.829 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.39703798294067383
Epoch: 46, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.827 Vali Acc: 0.246 Test Loss: 3.827 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.455791711807251
Epoch: 47, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.832 Vali Acc: 0.256 Test Loss: 3.832 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.4552164077758789
Epoch: 48, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.837 Vali Acc: 0.256 Test Loss: 3.837 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.4628028869628906
Epoch: 49, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.858 Vali Acc: 0.258 Test Loss: 3.858 Test Acc: 0.258
Validation loss decreased (-0.256434 --> -0.257608).  Saving model ...
Epoch: 50 cost time: 0.43694210052490234
Epoch: 50, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.894 Vali Acc: 0.249 Test Loss: 3.894 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4589681625366211
Epoch: 51, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.922 Vali Acc: 0.251 Test Loss: 3.922 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.43331408500671387
Epoch: 52, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.927 Vali Acc: 0.251 Test Loss: 3.927 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.45348525047302246
Epoch: 53, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.931 Vali Acc: 0.251 Test Loss: 3.931 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.4343254566192627
Epoch: 54, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.917 Vali Acc: 0.255 Test Loss: 3.917 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.43430137634277344
Epoch: 55, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.939 Vali Acc: 0.259 Test Loss: 3.939 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258784).  Saving model ...
Epoch: 56 cost time: 0.4485914707183838
Epoch: 56, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.958 Vali Acc: 0.256 Test Loss: 3.958 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4219231605529785
Epoch: 57, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.988 Vali Acc: 0.251 Test Loss: 3.988 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.46231913566589355
Epoch: 58, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.996 Vali Acc: 0.252 Test Loss: 3.996 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.4391453266143799
Epoch: 59, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.005 Vali Acc: 0.252 Test Loss: 4.005 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.4678936004638672
Epoch: 60, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.022 Vali Acc: 0.255 Test Loss: 4.022 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.4710373878479004
Epoch: 61, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.031 Vali Acc: 0.249 Test Loss: 4.031 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.4430124759674072
Epoch: 62, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.028 Vali Acc: 0.254 Test Loss: 4.028 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.4666929244995117
Epoch: 63, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.049 Vali Acc: 0.258 Test Loss: 4.049 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.4624941349029541
Epoch: 64, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.074 Vali Acc: 0.253 Test Loss: 4.074 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.44776225090026855
Epoch: 65, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.102 Vali Acc: 0.248 Test Loss: 4.102 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 41066
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5201961994171143
Epoch: 1, Steps: 10 | Train Loss: 3.389 Vali Loss: 3.372 Vali Acc: 0.039 Test Loss: 3.372 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.45095086097717285
Epoch: 2, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.353 Vali Acc: 0.040 Test Loss: 3.353 Test Acc: 0.040
Validation loss decreased (-0.038790 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.441211462020874
Epoch: 3, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.338 Vali Acc: 0.040 Test Loss: 3.338 Test Acc: 0.040
Validation loss decreased (-0.039966 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.4479091167449951
Epoch: 4, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.323 Vali Acc: 0.044 Test Loss: 3.323 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 5 cost time: 0.4414379596710205
Epoch: 5, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.315 Vali Acc: 0.060 Test Loss: 3.315 Test Acc: 0.060
Validation loss decreased (-0.043496 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.43427205085754395
Epoch: 6, Steps: 10 | Train Loss: 3.005 Vali Loss: 3.310 Vali Acc: 0.078 Test Loss: 3.310 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 0.45748329162597656
Epoch: 7, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.305 Vali Acc: 0.088 Test Loss: 3.305 Test Acc: 0.088
Validation loss decreased (-0.077614 --> -0.088202).  Saving model ...
Epoch: 8 cost time: 0.4401552677154541
Epoch: 8, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.297 Vali Acc: 0.105 Test Loss: 3.297 Test Acc: 0.105
Validation loss decreased (-0.088202 --> -0.104673).  Saving model ...
Epoch: 9 cost time: 0.46233177185058594
Epoch: 9, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.286 Vali Acc: 0.115 Test Loss: 3.286 Test Acc: 0.115
Validation loss decreased (-0.104673 --> -0.115261).  Saving model ...
Epoch: 10 cost time: 0.4232752323150635
Epoch: 10, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.280 Vali Acc: 0.119 Test Loss: 3.280 Test Acc: 0.119
Validation loss decreased (-0.115261 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 0.4449169635772705
Epoch: 11, Steps: 10 | Train Loss: 2.549 Vali Loss: 3.268 Vali Acc: 0.135 Test Loss: 3.268 Test Acc: 0.135
Validation loss decreased (-0.118791 --> -0.135261).  Saving model ...
Epoch: 12 cost time: 0.4272329807281494
Epoch: 12, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.256 Vali Acc: 0.139 Test Loss: 3.256 Test Acc: 0.139
Validation loss decreased (-0.135261 --> -0.138791).  Saving model ...
Epoch: 13 cost time: 0.4502146244049072
Epoch: 13, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.243 Vali Acc: 0.147 Test Loss: 3.243 Test Acc: 0.147
Validation loss decreased (-0.138791 --> -0.147026).  Saving model ...
Epoch: 14 cost time: 0.45239686965942383
Epoch: 14, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.236 Vali Acc: 0.156 Test Loss: 3.236 Test Acc: 0.156
Validation loss decreased (-0.147026 --> -0.156438).  Saving model ...
Epoch: 15 cost time: 0.432523250579834
Epoch: 15, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.233 Vali Acc: 0.160 Test Loss: 3.233 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159968).  Saving model ...
Epoch: 16 cost time: 0.44492173194885254
Epoch: 16, Steps: 10 | Train Loss: 1.970 Vali Loss: 3.224 Vali Acc: 0.164 Test Loss: 3.224 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 17 cost time: 0.45151329040527344
Epoch: 17, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.225 Vali Acc: 0.173 Test Loss: 3.225 Test Acc: 0.173
Validation loss decreased (-0.163497 --> -0.172909).  Saving model ...
Epoch: 18 cost time: 0.4539947509765625
Epoch: 18, Steps: 10 | Train Loss: 1.838 Vali Loss: 3.225 Vali Acc: 0.179 Test Loss: 3.225 Test Acc: 0.179
Validation loss decreased (-0.172909 --> -0.178791).  Saving model ...
Epoch: 19 cost time: 0.44715166091918945
Epoch: 19, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.238 Vali Acc: 0.186 Test Loss: 3.238 Test Acc: 0.186
Validation loss decreased (-0.178791 --> -0.185850).  Saving model ...
Epoch: 20 cost time: 0.4363887310028076
Epoch: 20, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.234 Vali Acc: 0.191 Test Loss: 3.234 Test Acc: 0.191
Validation loss decreased (-0.185850 --> -0.190556).  Saving model ...
Epoch: 21 cost time: 0.44138193130493164
Epoch: 21, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.243 Vali Acc: 0.196 Test Loss: 3.243 Test Acc: 0.196
Validation loss decreased (-0.190556 --> -0.196438).  Saving model ...
Epoch: 22 cost time: 0.4675862789154053
Epoch: 22, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.251 Vali Acc: 0.200 Test Loss: 3.251 Test Acc: 0.200
Validation loss decreased (-0.196438 --> -0.199967).  Saving model ...
Epoch: 23 cost time: 0.44381260871887207
Epoch: 23, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.257 Vali Acc: 0.202 Test Loss: 3.257 Test Acc: 0.202
Validation loss decreased (-0.199967 --> -0.202320).  Saving model ...
Epoch: 24 cost time: 0.4575967788696289
Epoch: 24, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.271 Vali Acc: 0.214 Test Loss: 3.271 Test Acc: 0.214
Validation loss decreased (-0.202320 --> -0.214085).  Saving model ...
Epoch: 25 cost time: 0.4197545051574707
Epoch: 25, Steps: 10 | Train Loss: 1.129 Vali Loss: 3.292 Vali Acc: 0.212 Test Loss: 3.292 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4518301486968994
Epoch: 26, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.310 Vali Acc: 0.221 Test Loss: 3.310 Test Acc: 0.221
Validation loss decreased (-0.214085 --> -0.221143).  Saving model ...
Epoch: 27 cost time: 0.4447190761566162
Epoch: 27, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.317 Vali Acc: 0.225 Test Loss: 3.317 Test Acc: 0.225
Validation loss decreased (-0.221143 --> -0.224673).  Saving model ...
Epoch: 28 cost time: 0.48437070846557617
Epoch: 28, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.319 Vali Acc: 0.231 Test Loss: 3.319 Test Acc: 0.231
Validation loss decreased (-0.224673 --> -0.230555).  Saving model ...
Epoch: 29 cost time: 0.41616249084472656
Epoch: 29, Steps: 10 | Train Loss: 0.847 Vali Loss: 3.342 Vali Acc: 0.240 Test Loss: 3.342 Test Acc: 0.240
Validation loss decreased (-0.230555 --> -0.239967).  Saving model ...
Epoch: 30 cost time: 0.461437463760376
Epoch: 30, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.358 Vali Acc: 0.236 Test Loss: 3.358 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.463482141494751
Epoch: 31, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.374 Vali Acc: 0.244 Test Loss: 3.374 Test Acc: 0.244
Validation loss decreased (-0.239967 --> -0.243496).  Saving model ...
Epoch: 32 cost time: 0.4780116081237793
Epoch: 32, Steps: 10 | Train Loss: 0.660 Vali Loss: 3.400 Vali Acc: 0.239 Test Loss: 3.400 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.39475250244140625
Epoch: 33, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.432 Vali Acc: 0.242 Test Loss: 3.432 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4219677448272705
Epoch: 34, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.460 Vali Acc: 0.244 Test Loss: 3.460 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4408390522003174
Epoch: 35, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.477 Vali Acc: 0.249 Test Loss: 3.477 Test Acc: 0.249
Validation loss decreased (-0.243496 --> -0.249377).  Saving model ...
Epoch: 36 cost time: 0.439650297164917
Epoch: 36, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.496 Vali Acc: 0.248 Test Loss: 3.496 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.46398019790649414
Epoch: 37, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.538 Vali Acc: 0.241 Test Loss: 3.538 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.42130112648010254
Epoch: 38, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.563 Vali Acc: 0.241 Test Loss: 3.563 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4566981792449951
Epoch: 39, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.571 Vali Acc: 0.256 Test Loss: 3.571 Test Acc: 0.256
Validation loss decreased (-0.249377 --> -0.256435).  Saving model ...
Epoch: 40 cost time: 0.46056246757507324
Epoch: 40, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.594 Vali Acc: 0.259 Test Loss: 3.594 Test Acc: 0.259
Validation loss decreased (-0.256435 --> -0.258788).  Saving model ...
Epoch: 41 cost time: 0.4036860466003418
Epoch: 41, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.630 Vali Acc: 0.260 Test Loss: 3.630 Test Acc: 0.260
Validation loss decreased (-0.258788 --> -0.259964).  Saving model ...
Epoch: 42 cost time: 0.4351356029510498
Epoch: 42, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.664 Vali Acc: 0.256 Test Loss: 3.664 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4238278865814209
Epoch: 43, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.686 Vali Acc: 0.253 Test Loss: 3.686 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4588336944580078
Epoch: 44, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.691 Vali Acc: 0.255 Test Loss: 3.691 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.43861865997314453
Epoch: 45, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.716 Vali Acc: 0.260 Test Loss: 3.716 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4647972583770752
Epoch: 46, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.746 Vali Acc: 0.256 Test Loss: 3.746 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4454374313354492
Epoch: 47, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.750 Vali Acc: 0.261 Test Loss: 3.750 Test Acc: 0.261
Validation loss decreased (-0.259964 --> -0.261139).  Saving model ...
Epoch: 48 cost time: 0.4507577419281006
Epoch: 48, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.761 Vali Acc: 0.262 Test Loss: 3.761 Test Acc: 0.262
Validation loss decreased (-0.261139 --> -0.262315).  Saving model ...
Epoch: 49 cost time: 0.45052671432495117
Epoch: 49, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.785 Vali Acc: 0.259 Test Loss: 3.785 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.47696971893310547
Epoch: 50, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.813 Vali Acc: 0.261 Test Loss: 3.813 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.4470508098602295
Epoch: 51, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.841 Vali Acc: 0.262 Test Loss: 3.841 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.43683934211730957
Epoch: 52, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.864 Vali Acc: 0.264 Test Loss: 3.864 Test Acc: 0.264
Validation loss decreased (-0.262315 --> -0.263491).  Saving model ...
Epoch: 53 cost time: 0.4528470039367676
Epoch: 53, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.883 Vali Acc: 0.262 Test Loss: 3.883 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4272770881652832
Epoch: 54, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.895 Vali Acc: 0.267 Test Loss: 3.895 Test Acc: 0.267
Validation loss decreased (-0.263491 --> -0.267020).  Saving model ...
Epoch: 55 cost time: 0.4065666198730469
Epoch: 55, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.918 Vali Acc: 0.264 Test Loss: 3.918 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.45752882957458496
Epoch: 56, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.929 Vali Acc: 0.265 Test Loss: 3.929 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4326963424682617
Epoch: 57, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.928 Vali Acc: 0.262 Test Loss: 3.928 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.4465959072113037
Epoch: 58, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.963 Vali Acc: 0.261 Test Loss: 3.963 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5006651878356934
Epoch: 59, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.995 Vali Acc: 0.261 Test Loss: 3.995 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.40598034858703613
Epoch: 60, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.017 Vali Acc: 0.261 Test Loss: 4.017 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.46483349800109863
Epoch: 61, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.026 Vali Acc: 0.261 Test Loss: 4.026 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.47427916526794434
Epoch: 62, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.043 Vali Acc: 0.264 Test Loss: 4.043 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.4327089786529541
Epoch: 63, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.064 Vali Acc: 0.259 Test Loss: 4.064 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.40425586700439453
Epoch: 64, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.077 Vali Acc: 0.264 Test Loss: 4.077 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 33642
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.432987928390503
Epoch: 1, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.385 Vali Acc: 0.035 Test Loss: 3.385 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 0.4320652484893799
Epoch: 2, Steps: 10 | Train Loss: 3.424 Vali Loss: 3.381 Vali Acc: 0.040 Test Loss: 3.381 Test Acc: 0.040
Validation loss decreased (-0.035260 --> -0.039966).  Saving model ...
Epoch: 3 cost time: 0.4123721122741699
Epoch: 3, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.376 Vali Acc: 0.040 Test Loss: 3.376 Test Acc: 0.040
Validation loss decreased (-0.039966 --> -0.039966).  Saving model ...
Epoch: 4 cost time: 0.4426589012145996
Epoch: 4, Steps: 10 | Train Loss: 3.412 Vali Loss: 3.368 Vali Acc: 0.044 Test Loss: 3.368 Test Acc: 0.044
Validation loss decreased (-0.039966 --> -0.043496).  Saving model ...
Epoch: 5 cost time: 0.4588038921356201
Epoch: 5, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.359 Vali Acc: 0.054 Test Loss: 3.359 Test Acc: 0.054
Validation loss decreased (-0.043496 --> -0.054084).  Saving model ...
Epoch: 6 cost time: 0.4411921501159668
Epoch: 6, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.347 Vali Acc: 0.058 Test Loss: 3.347 Test Acc: 0.058
Validation loss decreased (-0.054084 --> -0.057614).  Saving model ...
Epoch: 7 cost time: 0.43138718605041504
Epoch: 7, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.342 Vali Acc: 0.071 Test Loss: 3.342 Test Acc: 0.071
Validation loss decreased (-0.057614 --> -0.070555).  Saving model ...
Epoch: 8 cost time: 0.42942380905151367
Epoch: 8, Steps: 10 | Train Loss: 3.042 Vali Loss: 3.336 Vali Acc: 0.076 Test Loss: 3.336 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076437).  Saving model ...
Epoch: 9 cost time: 0.4235725402832031
Epoch: 9, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.329 Vali Acc: 0.091 Test Loss: 3.329 Test Acc: 0.091
Validation loss decreased (-0.076437 --> -0.090555).  Saving model ...
Epoch: 10 cost time: 0.44879722595214844
Epoch: 10, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.327 Vali Acc: 0.095 Test Loss: 3.327 Test Acc: 0.095
Validation loss decreased (-0.090555 --> -0.095261).  Saving model ...
Epoch: 11 cost time: 0.44734716415405273
Epoch: 11, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.321 Vali Acc: 0.096 Test Loss: 3.321 Test Acc: 0.096
Validation loss decreased (-0.095261 --> -0.096437).  Saving model ...
Epoch: 12 cost time: 0.44147586822509766
Epoch: 12, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.314 Vali Acc: 0.105 Test Loss: 3.314 Test Acc: 0.105
Validation loss decreased (-0.096437 --> -0.104673).  Saving model ...
Epoch: 13 cost time: 0.4462549686431885
Epoch: 13, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.311 Vali Acc: 0.107 Test Loss: 3.311 Test Acc: 0.107
Validation loss decreased (-0.104673 --> -0.107026).  Saving model ...
Epoch: 14 cost time: 0.43405723571777344
Epoch: 14, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.301 Vali Acc: 0.112 Test Loss: 3.301 Test Acc: 0.112
Validation loss decreased (-0.107026 --> -0.111732).  Saving model ...
Epoch: 15 cost time: 0.45066356658935547
Epoch: 15, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.296 Vali Acc: 0.121 Test Loss: 3.296 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 16 cost time: 0.44687819480895996
Epoch: 16, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.287 Vali Acc: 0.124 Test Loss: 3.287 Test Acc: 0.124
Validation loss decreased (-0.121144 --> -0.123497).  Saving model ...
Epoch: 17 cost time: 0.4806556701660156
Epoch: 17, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.283 Vali Acc: 0.124 Test Loss: 3.283 Test Acc: 0.124
Validation loss decreased (-0.123497 --> -0.123497).  Saving model ...
Epoch: 18 cost time: 0.4440042972564697
Epoch: 18, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.286 Vali Acc: 0.125 Test Loss: 3.286 Test Acc: 0.125
Validation loss decreased (-0.123497 --> -0.124673).  Saving model ...
Epoch: 19 cost time: 0.46118855476379395
Epoch: 19, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.286 Vali Acc: 0.131 Test Loss: 3.286 Test Acc: 0.131
Validation loss decreased (-0.124673 --> -0.130555).  Saving model ...
Epoch: 20 cost time: 0.4345839023590088
Epoch: 20, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.279 Vali Acc: 0.138 Test Loss: 3.279 Test Acc: 0.138
Validation loss decreased (-0.130555 --> -0.137614).  Saving model ...
Epoch: 21 cost time: 0.4192509651184082
Epoch: 21, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.275 Vali Acc: 0.139 Test Loss: 3.275 Test Acc: 0.139
Validation loss decreased (-0.137614 --> -0.138791).  Saving model ...
Epoch: 22 cost time: 0.49730706214904785
Epoch: 22, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.277 Vali Acc: 0.144 Test Loss: 3.277 Test Acc: 0.144
Validation loss decreased (-0.138791 --> -0.143497).  Saving model ...
Epoch: 23 cost time: 0.4482560157775879
Epoch: 23, Steps: 10 | Train Loss: 1.889 Vali Loss: 3.280 Vali Acc: 0.149 Test Loss: 3.280 Test Acc: 0.149
Validation loss decreased (-0.143497 --> -0.149379).  Saving model ...
Epoch: 24 cost time: 0.4579620361328125
Epoch: 24, Steps: 10 | Train Loss: 1.793 Vali Loss: 3.277 Vali Acc: 0.155 Test Loss: 3.277 Test Acc: 0.155
Validation loss decreased (-0.149379 --> -0.155261).  Saving model ...
Epoch: 25 cost time: 0.4441721439361572
Epoch: 25, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.285 Vali Acc: 0.156 Test Loss: 3.285 Test Acc: 0.156
Validation loss decreased (-0.155261 --> -0.156438).  Saving model ...
Epoch: 26 cost time: 0.4308319091796875
Epoch: 26, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.289 Vali Acc: 0.158 Test Loss: 3.289 Test Acc: 0.158
Validation loss decreased (-0.156438 --> -0.157614).  Saving model ...
Epoch: 27 cost time: 0.45864391326904297
Epoch: 27, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.295 Vali Acc: 0.169 Test Loss: 3.295 Test Acc: 0.169
Validation loss decreased (-0.157614 --> -0.169379).  Saving model ...
Epoch: 28 cost time: 0.4541163444519043
Epoch: 28, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.306 Vali Acc: 0.169 Test Loss: 3.306 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.458695650100708
Epoch: 29, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.315 Vali Acc: 0.173 Test Loss: 3.315 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 30 cost time: 0.5259265899658203
Epoch: 30, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.329 Vali Acc: 0.179 Test Loss: 3.329 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178790).  Saving model ...
Epoch: 31 cost time: 0.450803279876709
Epoch: 31, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.343 Vali Acc: 0.186 Test Loss: 3.343 Test Acc: 0.186
Validation loss decreased (-0.178790 --> -0.185849).  Saving model ...
Epoch: 32 cost time: 0.4759531021118164
Epoch: 32, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.350 Vali Acc: 0.181 Test Loss: 3.350 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4592630863189697
Epoch: 33, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.364 Vali Acc: 0.186 Test Loss: 3.364 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.44559764862060547
Epoch: 34, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.378 Vali Acc: 0.186 Test Loss: 3.378 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4507932662963867
Epoch: 35, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.385 Vali Acc: 0.189 Test Loss: 3.385 Test Acc: 0.189
Validation loss decreased (-0.185849 --> -0.189378).  Saving model ...
Epoch: 36 cost time: 0.4658017158508301
Epoch: 36, Steps: 10 | Train Loss: 0.889 Vali Loss: 3.389 Vali Acc: 0.194 Test Loss: 3.389 Test Acc: 0.194
Validation loss decreased (-0.189378 --> -0.194084).  Saving model ...
Epoch: 37 cost time: 0.43987298011779785
Epoch: 37, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.391 Vali Acc: 0.202 Test Loss: 3.391 Test Acc: 0.202
Validation loss decreased (-0.194084 --> -0.202319).  Saving model ...
Epoch: 38 cost time: 0.4455225467681885
Epoch: 38, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.414 Vali Acc: 0.206 Test Loss: 3.414 Test Acc: 0.206
Validation loss decreased (-0.202319 --> -0.205848).  Saving model ...
Epoch: 39 cost time: 0.4312739372253418
Epoch: 39, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.440 Vali Acc: 0.205 Test Loss: 3.440 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.48503661155700684
Epoch: 40, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.458 Vali Acc: 0.208 Test Loss: 3.458 Test Acc: 0.208
Validation loss decreased (-0.205848 --> -0.208201).  Saving model ...
Epoch: 41 cost time: 0.4513835906982422
Epoch: 41, Steps: 10 | Train Loss: 0.571 Vali Loss: 3.484 Vali Acc: 0.206 Test Loss: 3.484 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4250752925872803
Epoch: 42, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.504 Vali Acc: 0.214 Test Loss: 3.504 Test Acc: 0.214
Validation loss decreased (-0.208201 --> -0.214083).  Saving model ...
Epoch: 43 cost time: 0.5070345401763916
Epoch: 43, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.520 Vali Acc: 0.219 Test Loss: 3.520 Test Acc: 0.219
Validation loss decreased (-0.214083 --> -0.218788).  Saving model ...
Epoch: 44 cost time: 0.4288814067840576
Epoch: 44, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.537 Vali Acc: 0.219 Test Loss: 3.537 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4566833972930908
Epoch: 45, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.551 Vali Acc: 0.220 Test Loss: 3.551 Test Acc: 0.220
Validation loss decreased (-0.218788 --> -0.219964).  Saving model ...
Epoch: 46 cost time: 0.4624919891357422
Epoch: 46, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.568 Vali Acc: 0.219 Test Loss: 3.568 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.46340298652648926
Epoch: 47, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.581 Vali Acc: 0.219 Test Loss: 3.581 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.45462799072265625
Epoch: 48, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.602 Vali Acc: 0.219 Test Loss: 3.602 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.47664690017700195
Epoch: 49, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.612 Vali Acc: 0.220 Test Loss: 3.612 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4519062042236328
Epoch: 50, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.633 Vali Acc: 0.226 Test Loss: 3.633 Test Acc: 0.226
Validation loss decreased (-0.219964 --> -0.225846).  Saving model ...
Epoch: 51 cost time: 0.4836735725402832
Epoch: 51, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.657 Vali Acc: 0.228 Test Loss: 3.657 Test Acc: 0.228
Validation loss decreased (-0.225846 --> -0.228199).  Saving model ...
Epoch: 52 cost time: 0.4827079772949219
Epoch: 52, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.687 Vali Acc: 0.222 Test Loss: 3.687 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.43273353576660156
Epoch: 53, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.707 Vali Acc: 0.228 Test Loss: 3.707 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.4863615036010742
Epoch: 54, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.719 Vali Acc: 0.228 Test Loss: 3.719 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.4402740001678467
Epoch: 55, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.727 Vali Acc: 0.227 Test Loss: 3.727 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4565708637237549
Epoch: 56, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.745 Vali Acc: 0.226 Test Loss: 3.745 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.45226502418518066
Epoch: 57, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.765 Vali Acc: 0.228 Test Loss: 3.765 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.43564867973327637
Epoch: 58, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.768 Vali Acc: 0.224 Test Loss: 3.768 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.3864576816558838
Epoch: 59, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.778 Vali Acc: 0.239 Test Loss: 3.778 Test Acc: 0.239
Validation loss decreased (-0.228199 --> -0.238786).  Saving model ...
Epoch: 60 cost time: 0.4346456527709961
Epoch: 60, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.806 Vali Acc: 0.234 Test Loss: 3.806 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.4498772621154785
Epoch: 61, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.840 Vali Acc: 0.234 Test Loss: 3.840 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.46773552894592285
Epoch: 62, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.860 Vali Acc: 0.238 Test Loss: 3.860 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.43872642517089844
Epoch: 63, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.880 Vali Acc: 0.238 Test Loss: 3.880 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.465198278427124
Epoch: 64, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.879 Vali Acc: 0.239 Test Loss: 3.879 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.46511077880859375
Epoch: 65, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.895 Vali Acc: 0.236 Test Loss: 3.895 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.4271702766418457
Epoch: 66, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.910 Vali Acc: 0.239 Test Loss: 3.910 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.4298086166381836
Epoch: 67, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.914 Vali Acc: 0.238 Test Loss: 3.914 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.46245551109313965
Epoch: 68, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.929 Vali Acc: 0.238 Test Loss: 3.929 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.44582653045654297
Epoch: 69, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.946 Vali Acc: 0.238 Test Loss: 3.946 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2388235294117647
model parameter : 25018
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.407041311264038
Epoch: 1, Steps: 10 | Train Loss: 3.540 Vali Loss: 3.380 Vali Acc: 0.031 Test Loss: 3.380 Test Acc: 0.031
Validation loss decreased (inf --> -0.030554).  Saving model ...
Epoch: 2 cost time: 0.4849362373352051
Epoch: 2, Steps: 10 | Train Loss: 3.532 Vali Loss: 3.371 Vali Acc: 0.029 Test Loss: 3.371 Test Acc: 0.029
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46543216705322266
Epoch: 3, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.362 Vali Acc: 0.033 Test Loss: 3.362 Test Acc: 0.033
Validation loss decreased (-0.030554 --> -0.032908).  Saving model ...
Epoch: 4 cost time: 0.44321560859680176
Epoch: 4, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.352 Vali Acc: 0.035 Test Loss: 3.352 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 5 cost time: 0.49085021018981934
Epoch: 5, Steps: 10 | Train Loss: 3.428 Vali Loss: 3.338 Vali Acc: 0.033 Test Loss: 3.338 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5000855922698975
Epoch: 6, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.326 Vali Acc: 0.041 Test Loss: 3.326 Test Acc: 0.041
Validation loss decreased (-0.035261 --> -0.041143).  Saving model ...
Epoch: 7 cost time: 0.41850996017456055
Epoch: 7, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.316 Vali Acc: 0.053 Test Loss: 3.316 Test Acc: 0.053
Validation loss decreased (-0.041143 --> -0.052908).  Saving model ...
Epoch: 8 cost time: 0.3808786869049072
Epoch: 8, Steps: 10 | Train Loss: 3.168 Vali Loss: 3.309 Vali Acc: 0.058 Test Loss: 3.309 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 9 cost time: 0.4088268280029297
Epoch: 9, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.304 Vali Acc: 0.058 Test Loss: 3.304 Test Acc: 0.058
Validation loss decreased (-0.057614 --> -0.057614).  Saving model ...
Epoch: 10 cost time: 0.38864684104919434
Epoch: 10, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.300 Vali Acc: 0.061 Test Loss: 3.300 Test Acc: 0.061
Validation loss decreased (-0.057614 --> -0.061143).  Saving model ...
Epoch: 11 cost time: 0.42841482162475586
Epoch: 11, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.295 Vali Acc: 0.079 Test Loss: 3.295 Test Acc: 0.079
Validation loss decreased (-0.061143 --> -0.078791).  Saving model ...
Epoch: 12 cost time: 0.36276698112487793
Epoch: 12, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.293 Vali Acc: 0.081 Test Loss: 3.293 Test Acc: 0.081
Validation loss decreased (-0.078791 --> -0.081144).  Saving model ...
Epoch: 13 cost time: 0.4441704750061035
Epoch: 13, Steps: 10 | Train Loss: 2.898 Vali Loss: 3.293 Vali Acc: 0.082 Test Loss: 3.293 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082320).  Saving model ...
Epoch: 14 cost time: 0.5049750804901123
Epoch: 14, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.292 Vali Acc: 0.086 Test Loss: 3.292 Test Acc: 0.086
Validation loss decreased (-0.082320 --> -0.085849).  Saving model ...
Epoch: 15 cost time: 0.4876062870025635
Epoch: 15, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.289 Vali Acc: 0.089 Test Loss: 3.289 Test Acc: 0.089
Validation loss decreased (-0.085849 --> -0.089379).  Saving model ...
Epoch: 16 cost time: 0.47251129150390625
Epoch: 16, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.286 Vali Acc: 0.092 Test Loss: 3.286 Test Acc: 0.092
Validation loss decreased (-0.089379 --> -0.091732).  Saving model ...
Epoch: 17 cost time: 0.47397470474243164
Epoch: 17, Steps: 10 | Train Loss: 2.585 Vali Loss: 3.283 Vali Acc: 0.093 Test Loss: 3.283 Test Acc: 0.093
Validation loss decreased (-0.091732 --> -0.092908).  Saving model ...
Epoch: 18 cost time: 0.47075390815734863
Epoch: 18, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.277 Vali Acc: 0.101 Test Loss: 3.277 Test Acc: 0.101
Validation loss decreased (-0.092908 --> -0.101144).  Saving model ...
Epoch: 19 cost time: 0.45937061309814453
Epoch: 19, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.274 Vali Acc: 0.105 Test Loss: 3.274 Test Acc: 0.105
Validation loss decreased (-0.101144 --> -0.104673).  Saving model ...
Epoch: 20 cost time: 0.46662116050720215
Epoch: 20, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.269 Vali Acc: 0.111 Test Loss: 3.269 Test Acc: 0.111
Validation loss decreased (-0.104673 --> -0.110556).  Saving model ...
Epoch: 21 cost time: 0.4286329746246338
Epoch: 21, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.267 Vali Acc: 0.119 Test Loss: 3.267 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 22 cost time: 0.4673342704772949
Epoch: 22, Steps: 10 | Train Loss: 2.214 Vali Loss: 3.266 Vali Acc: 0.124 Test Loss: 3.266 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 23 cost time: 0.4840126037597656
Epoch: 23, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.268 Vali Acc: 0.131 Test Loss: 3.268 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130556).  Saving model ...
Epoch: 24 cost time: 0.4434504508972168
Epoch: 24, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.264 Vali Acc: 0.135 Test Loss: 3.264 Test Acc: 0.135
Validation loss decreased (-0.130556 --> -0.135261).  Saving model ...
Epoch: 25 cost time: 0.5088284015655518
Epoch: 25, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.263 Vali Acc: 0.140 Test Loss: 3.263 Test Acc: 0.140
Validation loss decreased (-0.135261 --> -0.139967).  Saving model ...
Epoch: 26 cost time: 0.4509704113006592
Epoch: 26, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.261 Vali Acc: 0.141 Test Loss: 3.261 Test Acc: 0.141
Validation loss decreased (-0.139967 --> -0.141144).  Saving model ...
Epoch: 27 cost time: 0.4875774383544922
Epoch: 27, Steps: 10 | Train Loss: 1.898 Vali Loss: 3.261 Vali Acc: 0.149 Test Loss: 3.261 Test Acc: 0.149
Validation loss decreased (-0.141144 --> -0.149379).  Saving model ...
Epoch: 28 cost time: 0.44893717765808105
Epoch: 28, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.264 Vali Acc: 0.152 Test Loss: 3.264 Test Acc: 0.152
Validation loss decreased (-0.149379 --> -0.151732).  Saving model ...
Epoch: 29 cost time: 0.4450852870941162
Epoch: 29, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.267 Vali Acc: 0.151 Test Loss: 3.267 Test Acc: 0.151
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5057065486907959
Epoch: 30, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.271 Vali Acc: 0.154 Test Loss: 3.271 Test Acc: 0.154
Validation loss decreased (-0.151732 --> -0.154085).  Saving model ...
Epoch: 31 cost time: 0.40786314010620117
Epoch: 31, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.273 Vali Acc: 0.153 Test Loss: 3.273 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4141545295715332
Epoch: 32, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.279 Vali Acc: 0.167 Test Loss: 3.279 Test Acc: 0.167
Validation loss decreased (-0.154085 --> -0.167026).  Saving model ...
Epoch: 33 cost time: 0.4108254909515381
Epoch: 33, Steps: 10 | Train Loss: 1.511 Vali Loss: 3.281 Vali Acc: 0.168 Test Loss: 3.281 Test Acc: 0.168
Validation loss decreased (-0.167026 --> -0.168202).  Saving model ...
Epoch: 34 cost time: 0.380664587020874
Epoch: 34, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.287 Vali Acc: 0.174 Test Loss: 3.287 Test Acc: 0.174
Validation loss decreased (-0.168202 --> -0.174085).  Saving model ...
Epoch: 35 cost time: 0.3972179889678955
Epoch: 35, Steps: 10 | Train Loss: 1.331 Vali Loss: 3.295 Vali Acc: 0.182 Test Loss: 3.295 Test Acc: 0.182
Validation loss decreased (-0.174085 --> -0.182320).  Saving model ...
Epoch: 36 cost time: 0.38663649559020996
Epoch: 36, Steps: 10 | Train Loss: 1.292 Vali Loss: 3.298 Vali Acc: 0.187 Test Loss: 3.298 Test Acc: 0.187
Validation loss decreased (-0.182320 --> -0.187026).  Saving model ...
Epoch: 37 cost time: 0.4104428291320801
Epoch: 37, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.302 Vali Acc: 0.191 Test Loss: 3.302 Test Acc: 0.191
Validation loss decreased (-0.187026 --> -0.190555).  Saving model ...
Epoch: 38 cost time: 0.44796228408813477
Epoch: 38, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.312 Vali Acc: 0.200 Test Loss: 3.312 Test Acc: 0.200
Validation loss decreased (-0.190555 --> -0.199967).  Saving model ...
Epoch: 39 cost time: 0.4218156337738037
Epoch: 39, Steps: 10 | Train Loss: 1.105 Vali Loss: 3.321 Vali Acc: 0.200 Test Loss: 3.321 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4362215995788574
Epoch: 40, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.335 Vali Acc: 0.198 Test Loss: 3.335 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.48235559463500977
Epoch: 41, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.347 Vali Acc: 0.205 Test Loss: 3.347 Test Acc: 0.205
Validation loss decreased (-0.199967 --> -0.204672).  Saving model ...
Epoch: 42 cost time: 0.4129762649536133
Epoch: 42, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.370 Vali Acc: 0.207 Test Loss: 3.370 Test Acc: 0.207
Validation loss decreased (-0.204672 --> -0.207025).  Saving model ...
Epoch: 43 cost time: 0.4218618869781494
Epoch: 43, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.383 Vali Acc: 0.206 Test Loss: 3.383 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.43115782737731934
Epoch: 44, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.394 Vali Acc: 0.218 Test Loss: 3.394 Test Acc: 0.218
Validation loss decreased (-0.207025 --> -0.217613).  Saving model ...
Epoch: 45 cost time: 0.3877074718475342
Epoch: 45, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.397 Vali Acc: 0.219 Test Loss: 3.397 Test Acc: 0.219
Validation loss decreased (-0.217613 --> -0.218790).  Saving model ...
Epoch: 46 cost time: 0.3778254985809326
Epoch: 46, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.418 Vali Acc: 0.221 Test Loss: 3.418 Test Acc: 0.221
Validation loss decreased (-0.218790 --> -0.221142).  Saving model ...
Epoch: 47 cost time: 0.38799619674682617
Epoch: 47, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.431 Vali Acc: 0.224 Test Loss: 3.431 Test Acc: 0.224
Validation loss decreased (-0.221142 --> -0.223495).  Saving model ...
Epoch: 48 cost time: 0.4647331237792969
Epoch: 48, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.428 Vali Acc: 0.214 Test Loss: 3.428 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5075156688690186
Epoch: 49, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.454 Vali Acc: 0.219 Test Loss: 3.454 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4624357223510742
Epoch: 50, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.479 Vali Acc: 0.224 Test Loss: 3.479 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4801774024963379
Epoch: 51, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.483 Vali Acc: 0.233 Test Loss: 3.483 Test Acc: 0.233
Validation loss decreased (-0.223495 --> -0.232906).  Saving model ...
Epoch: 52 cost time: 0.46024274826049805
Epoch: 52, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.506 Vali Acc: 0.229 Test Loss: 3.506 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4842560291290283
Epoch: 53, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.521 Vali Acc: 0.229 Test Loss: 3.521 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.48853278160095215
Epoch: 54, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.531 Vali Acc: 0.228 Test Loss: 3.531 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.4602787494659424
Epoch: 55, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.541 Vali Acc: 0.227 Test Loss: 3.541 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5065069198608398
Epoch: 56, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.579 Vali Acc: 0.225 Test Loss: 3.579 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.48024559020996094
Epoch: 57, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.591 Vali Acc: 0.225 Test Loss: 3.591 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.46099328994750977
Epoch: 58, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.612 Vali Acc: 0.225 Test Loss: 3.612 Test Acc: 0.225
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.4761512279510498
Epoch: 59, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.637 Vali Acc: 0.234 Test Loss: 3.637 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234081).  Saving model ...
Epoch: 60 cost time: 0.4827911853790283
Epoch: 60, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.639 Vali Acc: 0.233 Test Loss: 3.639 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.46993184089660645
Epoch: 61, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.650 Vali Acc: 0.238 Test Loss: 3.650 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237611).  Saving model ...
Epoch: 62 cost time: 0.44912123680114746
Epoch: 62, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.667 Vali Acc: 0.235 Test Loss: 3.667 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.48049139976501465
Epoch: 63, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.694 Vali Acc: 0.236 Test Loss: 3.694 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.540508508682251
Epoch: 64, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.711 Vali Acc: 0.241 Test Loss: 3.711 Test Acc: 0.241
Validation loss decreased (-0.237611 --> -0.241139).  Saving model ...
Epoch: 65 cost time: 0.46065807342529297
Epoch: 65, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.724 Vali Acc: 0.235 Test Loss: 3.724 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.46001362800598145
Epoch: 66, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.747 Vali Acc: 0.232 Test Loss: 3.747 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5012061595916748
Epoch: 67, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.743 Vali Acc: 0.235 Test Loss: 3.743 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5085010528564453
Epoch: 68, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.750 Vali Acc: 0.234 Test Loss: 3.750 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.48616552352905273
Epoch: 69, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.756 Vali Acc: 0.238 Test Loss: 3.756 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.49898290634155273
Epoch: 70, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.771 Vali Acc: 0.235 Test Loss: 3.771 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.500004768371582
Epoch: 71, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.778 Vali Acc: 0.236 Test Loss: 3.778 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.4381856918334961
Epoch: 72, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.804 Vali Acc: 0.236 Test Loss: 3.804 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.4715280532836914
Epoch: 73, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.819 Vali Acc: 0.238 Test Loss: 3.819 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.4797213077545166
Epoch: 74, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.838 Vali Acc: 0.239 Test Loss: 3.838 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 21402
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5534069538116455
Epoch: 1, Steps: 10 | Train Loss: 3.458 Vali Loss: 3.355 Vali Acc: 0.036 Test Loss: 3.355 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.46070384979248047
Epoch: 2, Steps: 10 | Train Loss: 3.411 Vali Loss: 3.352 Vali Acc: 0.034 Test Loss: 3.352 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5180990695953369
Epoch: 3, Steps: 10 | Train Loss: 3.414 Vali Loss: 3.348 Vali Acc: 0.029 Test Loss: 3.348 Test Acc: 0.029
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4789540767669678
Epoch: 4, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.338 Vali Acc: 0.028 Test Loss: 3.338 Test Acc: 0.028
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.46318531036376953
Epoch: 5, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.327 Vali Acc: 0.033 Test Loss: 3.327 Test Acc: 0.033
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48090529441833496
Epoch: 6, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.316 Vali Acc: 0.040 Test Loss: 3.316 Test Acc: 0.040
Validation loss decreased (-0.036437 --> -0.039967).  Saving model ...
Epoch: 7 cost time: 0.4967679977416992
Epoch: 7, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.304 Vali Acc: 0.041 Test Loss: 3.304 Test Acc: 0.041
Validation loss decreased (-0.039967 --> -0.041143).  Saving model ...
Epoch: 8 cost time: 0.48808860778808594
Epoch: 8, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.295 Vali Acc: 0.052 Test Loss: 3.295 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051732).  Saving model ...
Epoch: 9 cost time: 0.49281764030456543
Epoch: 9, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.284 Vali Acc: 0.056 Test Loss: 3.284 Test Acc: 0.056
Validation loss decreased (-0.051732 --> -0.056438).  Saving model ...
Epoch: 10 cost time: 0.5460836887359619
Epoch: 10, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.276 Vali Acc: 0.066 Test Loss: 3.276 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 11 cost time: 0.504981517791748
Epoch: 11, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.268 Vali Acc: 0.072 Test Loss: 3.268 Test Acc: 0.072
Validation loss decreased (-0.065850 --> -0.071732).  Saving model ...
Epoch: 12 cost time: 0.4522278308868408
Epoch: 12, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.263 Vali Acc: 0.080 Test Loss: 3.263 Test Acc: 0.080
Validation loss decreased (-0.071732 --> -0.079967).  Saving model ...
Epoch: 13 cost time: 0.5292840003967285
Epoch: 13, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.258 Vali Acc: 0.087 Test Loss: 3.258 Test Acc: 0.087
Validation loss decreased (-0.079967 --> -0.087026).  Saving model ...
Epoch: 14 cost time: 0.4916849136352539
Epoch: 14, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.252 Vali Acc: 0.095 Test Loss: 3.252 Test Acc: 0.095
Validation loss decreased (-0.087026 --> -0.095262).  Saving model ...
Epoch: 15 cost time: 0.5380356311798096
Epoch: 15, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.248 Vali Acc: 0.098 Test Loss: 3.248 Test Acc: 0.098
Validation loss decreased (-0.095262 --> -0.097615).  Saving model ...
Epoch: 16 cost time: 0.49130797386169434
Epoch: 16, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.245 Vali Acc: 0.102 Test Loss: 3.245 Test Acc: 0.102
Validation loss decreased (-0.097615 --> -0.102320).  Saving model ...
Epoch: 17 cost time: 0.5071489810943604
Epoch: 17, Steps: 10 | Train Loss: 2.550 Vali Loss: 3.240 Vali Acc: 0.111 Test Loss: 3.240 Test Acc: 0.111
Validation loss decreased (-0.102320 --> -0.110556).  Saving model ...
Epoch: 18 cost time: 0.5011794567108154
Epoch: 18, Steps: 10 | Train Loss: 2.422 Vali Loss: 3.240 Vali Acc: 0.116 Test Loss: 3.240 Test Acc: 0.116
Validation loss decreased (-0.110556 --> -0.116438).  Saving model ...
Epoch: 19 cost time: 0.5111539363861084
Epoch: 19, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.239 Vali Acc: 0.114 Test Loss: 3.239 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4246816635131836
Epoch: 20, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.239 Vali Acc: 0.121 Test Loss: 3.239 Test Acc: 0.121
Validation loss decreased (-0.116438 --> -0.121144).  Saving model ...
Epoch: 21 cost time: 0.481844425201416
Epoch: 21, Steps: 10 | Train Loss: 2.187 Vali Loss: 3.236 Vali Acc: 0.125 Test Loss: 3.236 Test Acc: 0.125
Validation loss decreased (-0.121144 --> -0.124674).  Saving model ...
Epoch: 22 cost time: 0.44716429710388184
Epoch: 22, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.236 Vali Acc: 0.127 Test Loss: 3.236 Test Acc: 0.127
Validation loss decreased (-0.124674 --> -0.127026).  Saving model ...
Epoch: 23 cost time: 0.49181342124938965
Epoch: 23, Steps: 10 | Train Loss: 2.125 Vali Loss: 3.235 Vali Acc: 0.126 Test Loss: 3.235 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.45882296562194824
Epoch: 24, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.238 Vali Acc: 0.131 Test Loss: 3.238 Test Acc: 0.131
Validation loss decreased (-0.127026 --> -0.130556).  Saving model ...
Epoch: 25 cost time: 0.43547677993774414
Epoch: 25, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.239 Vali Acc: 0.138 Test Loss: 3.239 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 26 cost time: 0.46970129013061523
Epoch: 26, Steps: 10 | Train Loss: 1.949 Vali Loss: 3.243 Vali Acc: 0.146 Test Loss: 3.243 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145850).  Saving model ...
Epoch: 27 cost time: 0.494340181350708
Epoch: 27, Steps: 10 | Train Loss: 1.871 Vali Loss: 3.248 Vali Acc: 0.149 Test Loss: 3.248 Test Acc: 0.149
Validation loss decreased (-0.145850 --> -0.149379).  Saving model ...
Epoch: 28 cost time: 0.49538135528564453
Epoch: 28, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.252 Vali Acc: 0.158 Test Loss: 3.252 Test Acc: 0.158
Validation loss decreased (-0.149379 --> -0.157615).  Saving model ...
Epoch: 29 cost time: 0.4985947608947754
Epoch: 29, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.258 Vali Acc: 0.162 Test Loss: 3.258 Test Acc: 0.162
Validation loss decreased (-0.157615 --> -0.162320).  Saving model ...
Epoch: 30 cost time: 0.4542086124420166
Epoch: 30, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.267 Vali Acc: 0.158 Test Loss: 3.267 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47986865043640137
Epoch: 31, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.271 Vali Acc: 0.165 Test Loss: 3.271 Test Acc: 0.165
Validation loss decreased (-0.162320 --> -0.164673).  Saving model ...
Epoch: 32 cost time: 0.4545588493347168
Epoch: 32, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.280 Vali Acc: 0.169 Test Loss: 3.280 Test Acc: 0.169
Validation loss decreased (-0.164673 --> -0.169379).  Saving model ...
Epoch: 33 cost time: 0.4859907627105713
Epoch: 33, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.286 Vali Acc: 0.167 Test Loss: 3.286 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.48929429054260254
Epoch: 34, Steps: 10 | Train Loss: 1.411 Vali Loss: 3.295 Vali Acc: 0.173 Test Loss: 3.295 Test Acc: 0.173
Validation loss decreased (-0.169379 --> -0.172908).  Saving model ...
Epoch: 35 cost time: 0.4778323173522949
Epoch: 35, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.301 Vali Acc: 0.179 Test Loss: 3.301 Test Acc: 0.179
Validation loss decreased (-0.172908 --> -0.178791).  Saving model ...
Epoch: 36 cost time: 0.47910284996032715
Epoch: 36, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.312 Vali Acc: 0.176 Test Loss: 3.312 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.46204376220703125
Epoch: 37, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.321 Vali Acc: 0.181 Test Loss: 3.321 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181143).  Saving model ...
Epoch: 38 cost time: 0.4438133239746094
Epoch: 38, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.341 Vali Acc: 0.185 Test Loss: 3.341 Test Acc: 0.185
Validation loss decreased (-0.181143 --> -0.184672).  Saving model ...
Epoch: 39 cost time: 0.5063254833221436
Epoch: 39, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.345 Vali Acc: 0.191 Test Loss: 3.345 Test Acc: 0.191
Validation loss decreased (-0.184672 --> -0.190555).  Saving model ...
Epoch: 40 cost time: 0.4488513469696045
Epoch: 40, Steps: 10 | Train Loss: 1.078 Vali Loss: 3.357 Vali Acc: 0.201 Test Loss: 3.357 Test Acc: 0.201
Validation loss decreased (-0.190555 --> -0.201143).  Saving model ...
Epoch: 41 cost time: 0.4548959732055664
Epoch: 41, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.375 Vali Acc: 0.196 Test Loss: 3.375 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4600963592529297
Epoch: 42, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.388 Vali Acc: 0.200 Test Loss: 3.388 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.47559022903442383
Epoch: 43, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.390 Vali Acc: 0.201 Test Loss: 3.390 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.48655223846435547
Epoch: 44, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.416 Vali Acc: 0.202 Test Loss: 3.416 Test Acc: 0.202
Validation loss decreased (-0.201143 --> -0.202319).  Saving model ...
Epoch: 45 cost time: 0.44087862968444824
Epoch: 45, Steps: 10 | Train Loss: 0.893 Vali Loss: 3.429 Vali Acc: 0.202 Test Loss: 3.429 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.44300174713134766
Epoch: 46, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.438 Vali Acc: 0.206 Test Loss: 3.438 Test Acc: 0.206
Validation loss decreased (-0.202319 --> -0.205848).  Saving model ...
Epoch: 47 cost time: 0.4312407970428467
Epoch: 47, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.453 Vali Acc: 0.207 Test Loss: 3.453 Test Acc: 0.207
Validation loss decreased (-0.205848 --> -0.207024).  Saving model ...
Epoch: 48 cost time: 0.5266323089599609
Epoch: 48, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.467 Vali Acc: 0.213 Test Loss: 3.467 Test Acc: 0.213
Validation loss decreased (-0.207024 --> -0.212907).  Saving model ...
Epoch: 49 cost time: 0.40306520462036133
Epoch: 49, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.486 Vali Acc: 0.213 Test Loss: 3.486 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.47529101371765137
Epoch: 50, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.501 Vali Acc: 0.216 Test Loss: 3.501 Test Acc: 0.216
Validation loss decreased (-0.212907 --> -0.216436).  Saving model ...
Epoch: 51 cost time: 0.4672515392303467
Epoch: 51, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.521 Vali Acc: 0.213 Test Loss: 3.521 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.473252534866333
Epoch: 52, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.522 Vali Acc: 0.216 Test Loss: 3.522 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.49942922592163086
Epoch: 53, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.542 Vali Acc: 0.218 Test Loss: 3.542 Test Acc: 0.218
Validation loss decreased (-0.216436 --> -0.217612).  Saving model ...
Epoch: 54 cost time: 0.4816873073577881
Epoch: 54, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.574 Vali Acc: 0.218 Test Loss: 3.574 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.4633598327636719
Epoch: 55, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.607 Vali Acc: 0.215 Test Loss: 3.607 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.4653036594390869
Epoch: 56, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.616 Vali Acc: 0.219 Test Loss: 3.616 Test Acc: 0.219
Validation loss decreased (-0.217612 --> -0.218787).  Saving model ...
Epoch: 57 cost time: 0.48209047317504883
Epoch: 57, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.602 Vali Acc: 0.225 Test Loss: 3.602 Test Acc: 0.225
Validation loss decreased (-0.218787 --> -0.224670).  Saving model ...
Epoch: 58 cost time: 0.470684289932251
Epoch: 58, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.621 Vali Acc: 0.225 Test Loss: 3.621 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5042791366577148
Epoch: 59, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.641 Vali Acc: 0.224 Test Loss: 3.641 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.4704465866088867
Epoch: 60, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.652 Vali Acc: 0.226 Test Loss: 3.652 Test Acc: 0.226
Validation loss decreased (-0.224670 --> -0.225846).  Saving model ...
Epoch: 61 cost time: 0.36031007766723633
Epoch: 61, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.681 Vali Acc: 0.225 Test Loss: 3.681 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.48788976669311523
Epoch: 62, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.686 Vali Acc: 0.226 Test Loss: 3.686 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.44956064224243164
Epoch: 63, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.717 Vali Acc: 0.226 Test Loss: 3.717 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.47582459449768066
Epoch: 64, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.721 Vali Acc: 0.228 Test Loss: 3.721 Test Acc: 0.228
Validation loss decreased (-0.225846 --> -0.228198).  Saving model ...
Epoch: 65 cost time: 0.43306469917297363
Epoch: 65, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.723 Vali Acc: 0.228 Test Loss: 3.723 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.4769284725189209
Epoch: 66, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.744 Vali Acc: 0.228 Test Loss: 3.744 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.433225154876709
Epoch: 67, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.770 Vali Acc: 0.224 Test Loss: 3.770 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.46952390670776367
Epoch: 68, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.774 Vali Acc: 0.229 Test Loss: 3.774 Test Acc: 0.229
Validation loss decreased (-0.228198 --> -0.229374).  Saving model ...
Epoch: 69 cost time: 0.43486905097961426
Epoch: 69, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.789 Vali Acc: 0.232 Test Loss: 3.789 Test Acc: 0.232
Validation loss decreased (-0.229374 --> -0.231727).  Saving model ...
Epoch: 70 cost time: 0.47484898567199707
Epoch: 70, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.824 Vali Acc: 0.231 Test Loss: 3.824 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.47565412521362305
Epoch: 71, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.841 Vali Acc: 0.226 Test Loss: 3.841 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5205390453338623
Epoch: 72, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.864 Vali Acc: 0.225 Test Loss: 3.864 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.4253573417663574
Epoch: 73, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.852 Vali Acc: 0.226 Test Loss: 3.852 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.49362611770629883
Epoch: 74, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.850 Vali Acc: 0.233 Test Loss: 3.850 Test Acc: 0.233
Validation loss decreased (-0.231727 --> -0.232903).  Saving model ...
Epoch: 75 cost time: 0.4630093574523926
Epoch: 75, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.875 Vali Acc: 0.233 Test Loss: 3.875 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.4709651470184326
Epoch: 76, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.901 Vali Acc: 0.235 Test Loss: 3.901 Test Acc: 0.235
Validation loss decreased (-0.232903 --> -0.235255).  Saving model ...
Epoch: 77 cost time: 0.5181159973144531
Epoch: 77, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.885 Vali Acc: 0.234 Test Loss: 3.885 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.457061767578125
Epoch: 78, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.910 Vali Acc: 0.228 Test Loss: 3.910 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.4524805545806885
Epoch: 79, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.937 Vali Acc: 0.227 Test Loss: 3.937 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.5407352447509766
Epoch: 80, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.943 Vali Acc: 0.228 Test Loss: 3.943 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5107247829437256
Epoch: 81, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.967 Vali Acc: 0.233 Test Loss: 3.967 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.48903822898864746
Epoch: 82, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.002 Vali Acc: 0.228 Test Loss: 4.002 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.4325544834136963
Epoch: 83, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.028 Vali Acc: 0.231 Test Loss: 4.028 Test Acc: 0.231
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.4817795753479004
Epoch: 84, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.038 Vali Acc: 0.238 Test Loss: 4.038 Test Acc: 0.238
Validation loss decreased (-0.235255 --> -0.237607).  Saving model ...
Epoch: 85 cost time: 0.46762681007385254
Epoch: 85, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.021 Vali Acc: 0.240 Test Loss: 4.021 Test Acc: 0.240
Validation loss decreased (-0.237607 --> -0.239960).  Saving model ...
Epoch: 86 cost time: 0.4623839855194092
Epoch: 86, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.007 Vali Acc: 0.241 Test Loss: 4.007 Test Acc: 0.241
Validation loss decreased (-0.239960 --> -0.241136).  Saving model ...
Epoch: 87 cost time: 0.5115776062011719
Epoch: 87, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.044 Vali Acc: 0.241 Test Loss: 4.044 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.469710111618042
Epoch: 88, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.070 Vali Acc: 0.232 Test Loss: 4.070 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.5051887035369873
Epoch: 89, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.085 Vali Acc: 0.239 Test Loss: 4.085 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.4635801315307617
Epoch: 90, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.101 Vali Acc: 0.234 Test Loss: 4.101 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.5291063785552979
Epoch: 91, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.118 Vali Acc: 0.233 Test Loss: 4.118 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.45809197425842285
Epoch: 92, Steps: 10 | Train Loss: 0.103 Vali Loss: 4.123 Vali Acc: 0.238 Test Loss: 4.123 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 0.4373283386230469
Epoch: 93, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.147 Vali Acc: 0.236 Test Loss: 4.147 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 0.45757436752319336
Epoch: 94, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.135 Vali Acc: 0.236 Test Loss: 4.135 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 0.47110486030578613
Epoch: 95, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.145 Vali Acc: 0.238 Test Loss: 4.145 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 96 cost time: 0.4473116397857666
Epoch: 96, Steps: 10 | Train Loss: 0.092 Vali Loss: 4.195 Vali Acc: 0.235 Test Loss: 4.195 Test Acc: 0.235
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df256_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2411764705882353
model parameter : 20266
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.526555061340332
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.338 Vali Acc: 0.045 Test Loss: 3.338 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.497143030166626
Epoch: 2, Steps: 10 | Train Loss: 3.386 Vali Loss: 3.347 Vali Acc: 0.042 Test Loss: 3.347 Test Acc: 0.042
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.49096035957336426
Epoch: 3, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.378 Vali Acc: 0.064 Test Loss: 3.378 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063496).  Saving model ...
Epoch: 4 cost time: 0.48611903190612793
Epoch: 4, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.359 Vali Acc: 0.092 Test Loss: 3.359 Test Acc: 0.092
Validation loss decreased (-0.063496 --> -0.091731).  Saving model ...
Epoch: 5 cost time: 0.4951455593109131
Epoch: 5, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.300 Vali Acc: 0.102 Test Loss: 3.300 Test Acc: 0.102
Validation loss decreased (-0.091731 --> -0.102320).  Saving model ...
Epoch: 6 cost time: 0.5353693962097168
Epoch: 6, Steps: 10 | Train Loss: 2.721 Vali Loss: 3.276 Vali Acc: 0.108 Test Loss: 3.276 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.4766535758972168
Epoch: 7, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.244 Vali Acc: 0.136 Test Loss: 3.244 Test Acc: 0.136
Validation loss decreased (-0.108203 --> -0.136438).  Saving model ...
Epoch: 8 cost time: 0.4662950038909912
Epoch: 8, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.249 Vali Acc: 0.140 Test Loss: 3.249 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139968).  Saving model ...
Epoch: 9 cost time: 0.47231006622314453
Epoch: 9, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.212 Vali Acc: 0.155 Test Loss: 3.212 Test Acc: 0.155
Validation loss decreased (-0.139968 --> -0.155262).  Saving model ...
Epoch: 10 cost time: 0.5239324569702148
Epoch: 10, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.233 Vali Acc: 0.162 Test Loss: 3.233 Test Acc: 0.162
Validation loss decreased (-0.155262 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 0.4872009754180908
Epoch: 11, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.219 Vali Acc: 0.185 Test Loss: 3.219 Test Acc: 0.185
Validation loss decreased (-0.162321 --> -0.184674).  Saving model ...
Epoch: 12 cost time: 0.4973025321960449
Epoch: 12, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.267 Vali Acc: 0.182 Test Loss: 3.267 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4944143295288086
Epoch: 13, Steps: 10 | Train Loss: 1.223 Vali Loss: 3.320 Vali Acc: 0.188 Test Loss: 3.320 Test Acc: 0.188
Validation loss decreased (-0.184674 --> -0.188202).  Saving model ...
Epoch: 14 cost time: 0.4800393581390381
Epoch: 14, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.361 Vali Acc: 0.198 Test Loss: 3.361 Test Acc: 0.198
Validation loss decreased (-0.188202 --> -0.197613).  Saving model ...
Epoch: 15 cost time: 0.4750981330871582
Epoch: 15, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.372 Vali Acc: 0.207 Test Loss: 3.372 Test Acc: 0.207
Validation loss decreased (-0.197613 --> -0.207025).  Saving model ...
Epoch: 16 cost time: 0.5012643337249756
Epoch: 16, Steps: 10 | Train Loss: 0.772 Vali Loss: 3.472 Vali Acc: 0.193 Test Loss: 3.472 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5357966423034668
Epoch: 17, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.433 Vali Acc: 0.225 Test Loss: 3.433 Test Acc: 0.225
Validation loss decreased (-0.207025 --> -0.224672).  Saving model ...
Epoch: 18 cost time: 0.4819347858428955
Epoch: 18, Steps: 10 | Train Loss: 0.502 Vali Loss: 3.499 Vali Acc: 0.229 Test Loss: 3.499 Test Acc: 0.229
Validation loss decreased (-0.224672 --> -0.229377).  Saving model ...
Epoch: 19 cost time: 0.4857027530670166
Epoch: 19, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.615 Vali Acc: 0.228 Test Loss: 3.615 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5593390464782715
Epoch: 20, Steps: 10 | Train Loss: 0.307 Vali Loss: 3.652 Vali Acc: 0.234 Test Loss: 3.652 Test Acc: 0.234
Validation loss decreased (-0.229377 --> -0.234081).  Saving model ...
Epoch: 21 cost time: 0.531775712966919
Epoch: 21, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.742 Vali Acc: 0.233 Test Loss: 3.742 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4872016906738281
Epoch: 22, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.835 Vali Acc: 0.235 Test Loss: 3.835 Test Acc: 0.235
Validation loss decreased (-0.234081 --> -0.235256).  Saving model ...
Epoch: 23 cost time: 0.4976952075958252
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.866 Vali Acc: 0.236 Test Loss: 3.866 Test Acc: 0.236
Validation loss decreased (-0.235256 --> -0.236432).  Saving model ...
Epoch: 24 cost time: 0.49930453300476074
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.927 Vali Acc: 0.244 Test Loss: 3.927 Test Acc: 0.244
Validation loss decreased (-0.236432 --> -0.243490).  Saving model ...
Epoch: 25 cost time: 0.4588608741760254
Epoch: 25, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.990 Vali Acc: 0.249 Test Loss: 3.990 Test Acc: 0.249
Validation loss decreased (-0.243490 --> -0.249372).  Saving model ...
Epoch: 26 cost time: 0.4947350025177002
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.011 Vali Acc: 0.259 Test Loss: 4.011 Test Acc: 0.259
Validation loss decreased (-0.249372 --> -0.258783).  Saving model ...
Epoch: 27 cost time: 0.4993417263031006
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.088 Vali Acc: 0.254 Test Loss: 4.088 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.47650790214538574
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.179 Vali Acc: 0.251 Test Loss: 4.179 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.48033642768859863
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.197 Vali Acc: 0.249 Test Loss: 4.197 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5052075386047363
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.203 Vali Acc: 0.248 Test Loss: 4.203 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.48941493034362793
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.237 Vali Acc: 0.252 Test Loss: 4.237 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5580708980560303
Epoch: 32, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.250 Vali Acc: 0.253 Test Loss: 4.250 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5095150470733643
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.278 Vali Acc: 0.252 Test Loss: 4.278 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4980792999267578
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.302 Vali Acc: 0.252 Test Loss: 4.302 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.46669912338256836
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.328 Vali Acc: 0.249 Test Loss: 4.328 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4955012798309326
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.363 Vali Acc: 0.252 Test Loss: 4.363 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 100362
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5121185779571533
Epoch: 1, Steps: 10 | Train Loss: 3.404 Vali Loss: 3.400 Vali Acc: 0.038 Test Loss: 3.400 Test Acc: 0.038
Validation loss decreased (inf --> -0.037613).  Saving model ...
Epoch: 2 cost time: 0.48993873596191406
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.360 Vali Acc: 0.045 Test Loss: 3.360 Test Acc: 0.045
Validation loss decreased (-0.037613 --> -0.044672).  Saving model ...
Epoch: 3 cost time: 0.4530820846557617
Epoch: 3, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.348 Vali Acc: 0.065 Test Loss: 3.348 Test Acc: 0.065
Validation loss decreased (-0.044672 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 0.47153568267822266
Epoch: 4, Steps: 10 | Train Loss: 3.079 Vali Loss: 3.346 Vali Acc: 0.062 Test Loss: 3.346 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.491649866104126
Epoch: 5, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.347 Vali Acc: 0.067 Test Loss: 3.347 Test Acc: 0.067
Validation loss decreased (-0.064672 --> -0.067025).  Saving model ...
Epoch: 6 cost time: 0.44242167472839355
Epoch: 6, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.341 Vali Acc: 0.075 Test Loss: 3.341 Test Acc: 0.075
Validation loss decreased (-0.067025 --> -0.075261).  Saving model ...
Epoch: 7 cost time: 0.4618031978607178
Epoch: 7, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.321 Vali Acc: 0.087 Test Loss: 3.321 Test Acc: 0.087
Validation loss decreased (-0.075261 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.4426870346069336
Epoch: 8, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.296 Vali Acc: 0.102 Test Loss: 3.296 Test Acc: 0.102
Validation loss decreased (-0.087026 --> -0.102320).  Saving model ...
Epoch: 9 cost time: 0.4927840232849121
Epoch: 9, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.281 Vali Acc: 0.112 Test Loss: 3.281 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.4658792018890381
Epoch: 10, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.275 Vali Acc: 0.124 Test Loss: 3.275 Test Acc: 0.124
Validation loss decreased (-0.111732 --> -0.123497).  Saving model ...
Epoch: 11 cost time: 0.48551082611083984
Epoch: 11, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.266 Vali Acc: 0.128 Test Loss: 3.266 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.48363399505615234
Epoch: 12, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.270 Vali Acc: 0.147 Test Loss: 3.270 Test Acc: 0.147
Validation loss decreased (-0.128203 --> -0.147026).  Saving model ...
Epoch: 13 cost time: 0.4513685703277588
Epoch: 13, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.276 Vali Acc: 0.160 Test Loss: 3.276 Test Acc: 0.160
Validation loss decreased (-0.147026 --> -0.159967).  Saving model ...
Epoch: 14 cost time: 0.4910247325897217
Epoch: 14, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.267 Vali Acc: 0.172 Test Loss: 3.267 Test Acc: 0.172
Validation loss decreased (-0.159967 --> -0.171732).  Saving model ...
Epoch: 15 cost time: 0.4779701232910156
Epoch: 15, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.305 Vali Acc: 0.174 Test Loss: 3.305 Test Acc: 0.174
Validation loss decreased (-0.171732 --> -0.174085).  Saving model ...
Epoch: 16 cost time: 0.474137544631958
Epoch: 16, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.313 Vali Acc: 0.179 Test Loss: 3.313 Test Acc: 0.179
Validation loss decreased (-0.174085 --> -0.178790).  Saving model ...
Epoch: 17 cost time: 0.47241973876953125
Epoch: 17, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.315 Vali Acc: 0.191 Test Loss: 3.315 Test Acc: 0.191
Validation loss decreased (-0.178790 --> -0.190555).  Saving model ...
Epoch: 18 cost time: 0.4872853755950928
Epoch: 18, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.340 Vali Acc: 0.194 Test Loss: 3.340 Test Acc: 0.194
Validation loss decreased (-0.190555 --> -0.194084).  Saving model ...
Epoch: 19 cost time: 0.4824235439300537
Epoch: 19, Steps: 10 | Train Loss: 1.085 Vali Loss: 3.356 Vali Acc: 0.204 Test Loss: 3.356 Test Acc: 0.204
Validation loss decreased (-0.194084 --> -0.203496).  Saving model ...
Epoch: 20 cost time: 0.5240011215209961
Epoch: 20, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.397 Vali Acc: 0.214 Test Loss: 3.397 Test Acc: 0.214
Validation loss decreased (-0.203496 --> -0.214084).  Saving model ...
Epoch: 21 cost time: 0.4652838706970215
Epoch: 21, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.426 Vali Acc: 0.209 Test Loss: 3.426 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.45343708992004395
Epoch: 22, Steps: 10 | Train Loss: 0.681 Vali Loss: 3.446 Vali Acc: 0.228 Test Loss: 3.446 Test Acc: 0.228
Validation loss decreased (-0.214084 --> -0.228201).  Saving model ...
Epoch: 23 cost time: 0.4677891731262207
Epoch: 23, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.487 Vali Acc: 0.229 Test Loss: 3.487 Test Acc: 0.229
Validation loss decreased (-0.228201 --> -0.229377).  Saving model ...
Epoch: 24 cost time: 0.5081207752227783
Epoch: 24, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.528 Vali Acc: 0.236 Test Loss: 3.528 Test Acc: 0.236
Validation loss decreased (-0.229377 --> -0.236435).  Saving model ...
Epoch: 25 cost time: 0.4721391201019287
Epoch: 25, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.593 Vali Acc: 0.238 Test Loss: 3.593 Test Acc: 0.238
Validation loss decreased (-0.236435 --> -0.237611).  Saving model ...
Epoch: 26 cost time: 0.3967270851135254
Epoch: 26, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.618 Vali Acc: 0.238 Test Loss: 3.618 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43715763092041016
Epoch: 27, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.678 Vali Acc: 0.242 Test Loss: 3.678 Test Acc: 0.242
Validation loss decreased (-0.237611 --> -0.242316).  Saving model ...
Epoch: 28 cost time: 0.5104773044586182
Epoch: 28, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.749 Vali Acc: 0.239 Test Loss: 3.749 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47362589836120605
Epoch: 29, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.776 Vali Acc: 0.241 Test Loss: 3.776 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.462540864944458
Epoch: 30, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.798 Vali Acc: 0.252 Test Loss: 3.798 Test Acc: 0.252
Validation loss decreased (-0.242316 --> -0.251727).  Saving model ...
Epoch: 31 cost time: 0.4828610420227051
Epoch: 31, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.832 Vali Acc: 0.247 Test Loss: 3.832 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4874284267425537
Epoch: 32, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.877 Vali Acc: 0.251 Test Loss: 3.877 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.46335530281066895
Epoch: 33, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.920 Vali Acc: 0.248 Test Loss: 3.920 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4810638427734375
Epoch: 34, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.963 Vali Acc: 0.251 Test Loss: 3.963 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4558603763580322
Epoch: 35, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.984 Vali Acc: 0.260 Test Loss: 3.984 Test Acc: 0.260
Validation loss decreased (-0.251727 --> -0.259960).  Saving model ...
Epoch: 36 cost time: 0.4719729423522949
Epoch: 36, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.009 Vali Acc: 0.256 Test Loss: 4.009 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.452120304107666
Epoch: 37, Steps: 10 | Train Loss: 0.096 Vali Loss: 4.052 Vali Acc: 0.251 Test Loss: 4.052 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4111185073852539
Epoch: 38, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.088 Vali Acc: 0.249 Test Loss: 4.088 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4475076198577881
Epoch: 39, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.090 Vali Acc: 0.256 Test Loss: 4.090 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4444246292114258
Epoch: 40, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.104 Vali Acc: 0.259 Test Loss: 4.104 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.47690343856811523
Epoch: 41, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.149 Vali Acc: 0.256 Test Loss: 4.149 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5064723491668701
Epoch: 42, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.173 Vali Acc: 0.247 Test Loss: 4.173 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4343111515045166
Epoch: 43, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.200 Vali Acc: 0.259 Test Loss: 4.200 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.46439552307128906
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.212 Vali Acc: 0.261 Test Loss: 4.212 Test Acc: 0.261
Validation loss decreased (-0.259960 --> -0.261134).  Saving model ...
Epoch: 45 cost time: 0.47670793533325195
Epoch: 45, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.230 Vali Acc: 0.260 Test Loss: 4.230 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4701220989227295
Epoch: 46, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.259 Vali Acc: 0.259 Test Loss: 4.259 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5050368309020996
Epoch: 47, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.275 Vali Acc: 0.251 Test Loss: 4.275 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5382347106933594
Epoch: 48, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.298 Vali Acc: 0.249 Test Loss: 4.298 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.49648284912109375
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.308 Vali Acc: 0.246 Test Loss: 4.308 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4967978000640869
Epoch: 50, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.328 Vali Acc: 0.249 Test Loss: 4.328 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.44066786766052246
Epoch: 51, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.349 Vali Acc: 0.253 Test Loss: 4.349 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.4611239433288574
Epoch: 52, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.362 Vali Acc: 0.253 Test Loss: 4.362 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.47838759422302246
Epoch: 53, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.392 Vali Acc: 0.254 Test Loss: 4.392 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.4731307029724121
Epoch: 54, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.395 Vali Acc: 0.260 Test Loss: 4.395 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 53002
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4834182262420654
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.367 Vali Acc: 0.048 Test Loss: 3.367 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.45525121688842773
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.358 Vali Acc: 0.046 Test Loss: 3.358 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48962855339050293
Epoch: 3, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.348 Vali Acc: 0.048 Test Loss: 3.348 Test Acc: 0.048
Validation loss decreased (-0.048202 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.4471735954284668
Epoch: 4, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.338 Vali Acc: 0.053 Test Loss: 3.338 Test Acc: 0.053
Validation loss decreased (-0.048202 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.4771287441253662
Epoch: 5, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.331 Vali Acc: 0.058 Test Loss: 3.331 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 0.4689013957977295
Epoch: 6, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.325 Vali Acc: 0.071 Test Loss: 3.325 Test Acc: 0.071
Validation loss decreased (-0.057614 --> -0.070555).  Saving model ...
Epoch: 7 cost time: 0.4870591163635254
Epoch: 7, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.314 Vali Acc: 0.084 Test Loss: 3.314 Test Acc: 0.084
Validation loss decreased (-0.070555 --> -0.083496).  Saving model ...
Epoch: 8 cost time: 0.46125364303588867
Epoch: 8, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.301 Vali Acc: 0.094 Test Loss: 3.301 Test Acc: 0.094
Validation loss decreased (-0.083496 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.4746665954589844
Epoch: 9, Steps: 10 | Train Loss: 2.626 Vali Loss: 3.297 Vali Acc: 0.094 Test Loss: 3.297 Test Acc: 0.094
Validation loss decreased (-0.094085 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.4740605354309082
Epoch: 10, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.284 Vali Acc: 0.107 Test Loss: 3.284 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107026).  Saving model ...
Epoch: 11 cost time: 0.46071577072143555
Epoch: 11, Steps: 10 | Train Loss: 2.391 Vali Loss: 3.265 Vali Acc: 0.111 Test Loss: 3.265 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 0.4872555732727051
Epoch: 12, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.255 Vali Acc: 0.120 Test Loss: 3.255 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119967).  Saving model ...
Epoch: 13 cost time: 0.4607119560241699
Epoch: 13, Steps: 10 | Train Loss: 2.079 Vali Loss: 3.253 Vali Acc: 0.127 Test Loss: 3.253 Test Acc: 0.127
Validation loss decreased (-0.119967 --> -0.127026).  Saving model ...
Epoch: 14 cost time: 0.5139169692993164
Epoch: 14, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.247 Vali Acc: 0.125 Test Loss: 3.247 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4436793327331543
Epoch: 15, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.247 Vali Acc: 0.135 Test Loss: 3.247 Test Acc: 0.135
Validation loss decreased (-0.127026 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 0.4580817222595215
Epoch: 16, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.247 Vali Acc: 0.139 Test Loss: 3.247 Test Acc: 0.139
Validation loss decreased (-0.135262 --> -0.138791).  Saving model ...
Epoch: 17 cost time: 0.46924376487731934
Epoch: 17, Steps: 10 | Train Loss: 1.654 Vali Loss: 3.249 Vali Acc: 0.147 Test Loss: 3.249 Test Acc: 0.147
Validation loss decreased (-0.138791 --> -0.147026).  Saving model ...
Epoch: 18 cost time: 0.4795713424682617
Epoch: 18, Steps: 10 | Train Loss: 1.558 Vali Loss: 3.251 Vali Acc: 0.161 Test Loss: 3.251 Test Acc: 0.161
Validation loss decreased (-0.147026 --> -0.161144).  Saving model ...
Epoch: 19 cost time: 0.492175817489624
Epoch: 19, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.261 Vali Acc: 0.165 Test Loss: 3.261 Test Acc: 0.165
Validation loss decreased (-0.161144 --> -0.164673).  Saving model ...
Epoch: 20 cost time: 0.5177466869354248
Epoch: 20, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.283 Vali Acc: 0.165 Test Loss: 3.283 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49261903762817383
Epoch: 21, Steps: 10 | Train Loss: 1.215 Vali Loss: 3.288 Vali Acc: 0.172 Test Loss: 3.288 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171732).  Saving model ...
Epoch: 22 cost time: 0.5344729423522949
Epoch: 22, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.316 Vali Acc: 0.182 Test Loss: 3.316 Test Acc: 0.182
Validation loss decreased (-0.171732 --> -0.182320).  Saving model ...
Epoch: 23 cost time: 0.48740482330322266
Epoch: 23, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.330 Vali Acc: 0.186 Test Loss: 3.330 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185849).  Saving model ...
Epoch: 24 cost time: 0.4882805347442627
Epoch: 24, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.339 Vali Acc: 0.192 Test Loss: 3.339 Test Acc: 0.192
Validation loss decreased (-0.185849 --> -0.191731).  Saving model ...
Epoch: 25 cost time: 0.5020298957824707
Epoch: 25, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.364 Vali Acc: 0.198 Test Loss: 3.364 Test Acc: 0.198
Validation loss decreased (-0.191731 --> -0.197613).  Saving model ...
Epoch: 26 cost time: 0.5161559581756592
Epoch: 26, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.411 Vali Acc: 0.195 Test Loss: 3.411 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4912228584289551
Epoch: 27, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.437 Vali Acc: 0.204 Test Loss: 3.437 Test Acc: 0.204
Validation loss decreased (-0.197613 --> -0.203495).  Saving model ...
Epoch: 28 cost time: 0.5100781917572021
Epoch: 28, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.449 Vali Acc: 0.211 Test Loss: 3.449 Test Acc: 0.211
Validation loss decreased (-0.203495 --> -0.210554).  Saving model ...
Epoch: 29 cost time: 0.512969970703125
Epoch: 29, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.471 Vali Acc: 0.213 Test Loss: 3.471 Test Acc: 0.213
Validation loss decreased (-0.210554 --> -0.212906).  Saving model ...
Epoch: 30 cost time: 0.49666929244995117
Epoch: 30, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.503 Vali Acc: 0.214 Test Loss: 3.503 Test Acc: 0.214
Validation loss decreased (-0.212906 --> -0.214083).  Saving model ...
Epoch: 31 cost time: 0.48514580726623535
Epoch: 31, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.523 Vali Acc: 0.214 Test Loss: 3.523 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4804387092590332
Epoch: 32, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.551 Vali Acc: 0.220 Test Loss: 3.551 Test Acc: 0.220
Validation loss decreased (-0.214083 --> -0.219964).  Saving model ...
Epoch: 33 cost time: 0.49308133125305176
Epoch: 33, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.592 Vali Acc: 0.220 Test Loss: 3.592 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4806356430053711
Epoch: 34, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.626 Vali Acc: 0.224 Test Loss: 3.626 Test Acc: 0.224
Validation loss decreased (-0.219964 --> -0.223493).  Saving model ...
Epoch: 35 cost time: 0.431459903717041
Epoch: 35, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.654 Vali Acc: 0.220 Test Loss: 3.654 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.469968318939209
Epoch: 36, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.694 Vali Acc: 0.215 Test Loss: 3.694 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4726524353027344
Epoch: 37, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.714 Vali Acc: 0.218 Test Loss: 3.714 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.47897982597351074
Epoch: 38, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.737 Vali Acc: 0.216 Test Loss: 3.737 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.442462682723999
Epoch: 39, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.769 Vali Acc: 0.216 Test Loss: 3.769 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5245583057403564
Epoch: 40, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.783 Vali Acc: 0.227 Test Loss: 3.783 Test Acc: 0.227
Validation loss decreased (-0.223493 --> -0.227021).  Saving model ...
Epoch: 41 cost time: 0.4766883850097656
Epoch: 41, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.800 Vali Acc: 0.225 Test Loss: 3.800 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5082755088806152
Epoch: 42, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.825 Vali Acc: 0.232 Test Loss: 3.825 Test Acc: 0.232
Validation loss decreased (-0.227021 --> -0.231726).  Saving model ...
Epoch: 43 cost time: 0.4966137409210205
Epoch: 43, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.838 Vali Acc: 0.229 Test Loss: 3.838 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4945509433746338
Epoch: 44, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.862 Vali Acc: 0.235 Test Loss: 3.862 Test Acc: 0.235
Validation loss decreased (-0.231726 --> -0.235256).  Saving model ...
Epoch: 45 cost time: 0.5378296375274658
Epoch: 45, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.906 Vali Acc: 0.227 Test Loss: 3.906 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4588313102722168
Epoch: 46, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.946 Vali Acc: 0.219 Test Loss: 3.946 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4977712631225586
Epoch: 47, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.949 Vali Acc: 0.221 Test Loss: 3.949 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.45255374908447266
Epoch: 48, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.965 Vali Acc: 0.225 Test Loss: 3.965 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.49092531204223633
Epoch: 49, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.977 Vali Acc: 0.226 Test Loss: 3.977 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5031905174255371
Epoch: 50, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.000 Vali Acc: 0.227 Test Loss: 4.000 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.45038414001464844
Epoch: 51, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.007 Vali Acc: 0.229 Test Loss: 4.007 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.44975972175598145
Epoch: 52, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.004 Vali Acc: 0.228 Test Loss: 4.004 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.45267462730407715
Epoch: 53, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.034 Vali Acc: 0.226 Test Loss: 4.034 Test Acc: 0.226
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.44206714630126953
Epoch: 54, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.059 Vali Acc: 0.225 Test Loss: 4.059 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 36842
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5748512744903564
Epoch: 1, Steps: 10 | Train Loss: 3.521 Vali Loss: 3.390 Vali Acc: 0.047 Test Loss: 3.390 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.4496734142303467
Epoch: 2, Steps: 10 | Train Loss: 3.465 Vali Loss: 3.364 Vali Acc: 0.054 Test Loss: 3.364 Test Acc: 0.054
Validation loss decreased (-0.047025 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.4433021545410156
Epoch: 3, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.347 Vali Acc: 0.054 Test Loss: 3.347 Test Acc: 0.054
Validation loss decreased (-0.054084 --> -0.054084).  Saving model ...
Epoch: 4 cost time: 0.46097302436828613
Epoch: 4, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.335 Vali Acc: 0.060 Test Loss: 3.335 Test Acc: 0.060
Validation loss decreased (-0.054084 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.46915102005004883
Epoch: 5, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.324 Vali Acc: 0.060 Test Loss: 3.324 Test Acc: 0.060
Validation loss decreased (-0.059967 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.46202516555786133
Epoch: 6, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.317 Vali Acc: 0.064 Test Loss: 3.317 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063496).  Saving model ...
Epoch: 7 cost time: 0.48099851608276367
Epoch: 7, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.313 Vali Acc: 0.061 Test Loss: 3.313 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.42120933532714844
Epoch: 8, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.314 Vali Acc: 0.069 Test Loss: 3.314 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 0.3929729461669922
Epoch: 9, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.304 Vali Acc: 0.076 Test Loss: 3.304 Test Acc: 0.076
Validation loss decreased (-0.069379 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 0.4805715084075928
Epoch: 10, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.292 Vali Acc: 0.093 Test Loss: 3.292 Test Acc: 0.093
Validation loss decreased (-0.076438 --> -0.092908).  Saving model ...
Epoch: 11 cost time: 0.4772965908050537
Epoch: 11, Steps: 10 | Train Loss: 2.600 Vali Loss: 3.285 Vali Acc: 0.091 Test Loss: 3.285 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4467897415161133
Epoch: 12, Steps: 10 | Train Loss: 2.502 Vali Loss: 3.277 Vali Acc: 0.099 Test Loss: 3.277 Test Acc: 0.099
Validation loss decreased (-0.092908 --> -0.098791).  Saving model ...
Epoch: 13 cost time: 0.4262259006500244
Epoch: 13, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.267 Vali Acc: 0.111 Test Loss: 3.267 Test Acc: 0.111
Validation loss decreased (-0.098791 --> -0.110556).  Saving model ...
Epoch: 14 cost time: 0.469618558883667
Epoch: 14, Steps: 10 | Train Loss: 2.273 Vali Loss: 3.258 Vali Acc: 0.126 Test Loss: 3.258 Test Acc: 0.126
Validation loss decreased (-0.110556 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 0.4145221710205078
Epoch: 15, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.251 Vali Acc: 0.138 Test Loss: 3.251 Test Acc: 0.138
Validation loss decreased (-0.125850 --> -0.137615).  Saving model ...
Epoch: 16 cost time: 0.4615318775177002
Epoch: 16, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.248 Vali Acc: 0.145 Test Loss: 3.248 Test Acc: 0.145
Validation loss decreased (-0.137615 --> -0.144673).  Saving model ...
Epoch: 17 cost time: 0.44576501846313477
Epoch: 17, Steps: 10 | Train Loss: 1.976 Vali Loss: 3.244 Vali Acc: 0.148 Test Loss: 3.244 Test Acc: 0.148
Validation loss decreased (-0.144673 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.5001659393310547
Epoch: 18, Steps: 10 | Train Loss: 1.858 Vali Loss: 3.247 Vali Acc: 0.151 Test Loss: 3.247 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 19 cost time: 0.43807148933410645
Epoch: 19, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.248 Vali Acc: 0.160 Test Loss: 3.248 Test Acc: 0.160
Validation loss decreased (-0.150556 --> -0.159968).  Saving model ...
Epoch: 20 cost time: 0.4437527656555176
Epoch: 20, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.251 Vali Acc: 0.168 Test Loss: 3.251 Test Acc: 0.168
Validation loss decreased (-0.159968 --> -0.168203).  Saving model ...
Epoch: 21 cost time: 0.4621753692626953
Epoch: 21, Steps: 10 | Train Loss: 1.566 Vali Loss: 3.257 Vali Acc: 0.176 Test Loss: 3.257 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 22 cost time: 0.48314642906188965
Epoch: 22, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.254 Vali Acc: 0.187 Test Loss: 3.254 Test Acc: 0.187
Validation loss decreased (-0.176438 --> -0.187026).  Saving model ...
Epoch: 23 cost time: 0.4245734214782715
Epoch: 23, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.267 Vali Acc: 0.198 Test Loss: 3.267 Test Acc: 0.198
Validation loss decreased (-0.187026 --> -0.197614).  Saving model ...
Epoch: 24 cost time: 0.46164703369140625
Epoch: 24, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.292 Vali Acc: 0.205 Test Loss: 3.292 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204673).  Saving model ...
Epoch: 25 cost time: 0.41977405548095703
Epoch: 25, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.304 Vali Acc: 0.206 Test Loss: 3.304 Test Acc: 0.206
Validation loss decreased (-0.204673 --> -0.205849).  Saving model ...
Epoch: 26 cost time: 0.46335411071777344
Epoch: 26, Steps: 10 | Train Loss: 1.099 Vali Loss: 3.315 Vali Acc: 0.212 Test Loss: 3.315 Test Acc: 0.212
Validation loss decreased (-0.205849 --> -0.211732).  Saving model ...
Epoch: 27 cost time: 0.4325268268585205
Epoch: 27, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.328 Vali Acc: 0.224 Test Loss: 3.328 Test Acc: 0.224
Validation loss decreased (-0.211732 --> -0.223496).  Saving model ...
Epoch: 28 cost time: 0.4496123790740967
Epoch: 28, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.343 Vali Acc: 0.229 Test Loss: 3.343 Test Acc: 0.229
Validation loss decreased (-0.223496 --> -0.229378).  Saving model ...
Epoch: 29 cost time: 0.4450662136077881
Epoch: 29, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.374 Vali Acc: 0.228 Test Loss: 3.374 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.41101503372192383
Epoch: 30, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.395 Vali Acc: 0.232 Test Loss: 3.395 Test Acc: 0.232
Validation loss decreased (-0.229378 --> -0.231731).  Saving model ...
Epoch: 31 cost time: 0.4320719242095947
Epoch: 31, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.415 Vali Acc: 0.238 Test Loss: 3.415 Test Acc: 0.238
Validation loss decreased (-0.231731 --> -0.237613).  Saving model ...
Epoch: 32 cost time: 0.40547895431518555
Epoch: 32, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.431 Vali Acc: 0.241 Test Loss: 3.431 Test Acc: 0.241
Validation loss decreased (-0.237613 --> -0.241142).  Saving model ...
Epoch: 33 cost time: 0.4388730525970459
Epoch: 33, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.453 Vali Acc: 0.246 Test Loss: 3.453 Test Acc: 0.246
Validation loss decreased (-0.241142 --> -0.245848).  Saving model ...
Epoch: 34 cost time: 0.4351074695587158
Epoch: 34, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.482 Vali Acc: 0.246 Test Loss: 3.482 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4476039409637451
Epoch: 35, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.503 Vali Acc: 0.247 Test Loss: 3.503 Test Acc: 0.247
Validation loss decreased (-0.245848 --> -0.247024).  Saving model ...
Epoch: 36 cost time: 0.41800570487976074
Epoch: 36, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.537 Vali Acc: 0.249 Test Loss: 3.537 Test Acc: 0.249
Validation loss decreased (-0.247024 --> -0.249376).  Saving model ...
Epoch: 37 cost time: 0.4434018135070801
Epoch: 37, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.558 Vali Acc: 0.252 Test Loss: 3.558 Test Acc: 0.252
Validation loss decreased (-0.249376 --> -0.251729).  Saving model ...
Epoch: 38 cost time: 0.46067333221435547
Epoch: 38, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.585 Vali Acc: 0.255 Test Loss: 3.585 Test Acc: 0.255
Validation loss decreased (-0.251729 --> -0.255258).  Saving model ...
Epoch: 39 cost time: 0.42245984077453613
Epoch: 39, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.632 Vali Acc: 0.251 Test Loss: 3.632 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.44101619720458984
Epoch: 40, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.645 Vali Acc: 0.252 Test Loss: 3.645 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4416937828063965
Epoch: 41, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.675 Vali Acc: 0.255 Test Loss: 3.675 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.47335100173950195
Epoch: 42, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.677 Vali Acc: 0.259 Test Loss: 3.677 Test Acc: 0.259
Validation loss decreased (-0.255258 --> -0.258787).  Saving model ...
Epoch: 43 cost time: 0.4364511966705322
Epoch: 43, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.709 Vali Acc: 0.260 Test Loss: 3.709 Test Acc: 0.260
Validation loss decreased (-0.258787 --> -0.259963).  Saving model ...
Epoch: 44 cost time: 0.46782827377319336
Epoch: 44, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.721 Vali Acc: 0.259 Test Loss: 3.721 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.401686429977417
Epoch: 45, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.749 Vali Acc: 0.259 Test Loss: 3.749 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.430600643157959
Epoch: 46, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.771 Vali Acc: 0.262 Test Loss: 3.771 Test Acc: 0.262
Validation loss decreased (-0.259963 --> -0.262315).  Saving model ...
Epoch: 47 cost time: 0.5002319812774658
Epoch: 47, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.807 Vali Acc: 0.264 Test Loss: 3.807 Test Acc: 0.264
Validation loss decreased (-0.262315 --> -0.263491).  Saving model ...
Epoch: 48 cost time: 0.46941184997558594
Epoch: 48, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.837 Vali Acc: 0.261 Test Loss: 3.837 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.42337489128112793
Epoch: 49, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.854 Vali Acc: 0.262 Test Loss: 3.854 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4987802505493164
Epoch: 50, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.867 Vali Acc: 0.267 Test Loss: 3.867 Test Acc: 0.267
Validation loss decreased (-0.263491 --> -0.267020).  Saving model ...
Epoch: 51 cost time: 0.43883681297302246
Epoch: 51, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.879 Vali Acc: 0.265 Test Loss: 3.879 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.43906283378601074
Epoch: 52, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.901 Vali Acc: 0.261 Test Loss: 3.901 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.4641752243041992
Epoch: 53, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.933 Vali Acc: 0.260 Test Loss: 3.933 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.43308019638061523
Epoch: 54, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.950 Vali Acc: 0.259 Test Loss: 3.950 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.43767666816711426
Epoch: 55, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.959 Vali Acc: 0.260 Test Loss: 3.959 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.4840128421783447
Epoch: 56, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.983 Vali Acc: 0.262 Test Loss: 3.983 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.4402909278869629
Epoch: 57, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.995 Vali Acc: 0.262 Test Loss: 3.995 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.46869492530822754
Epoch: 58, Steps: 10 | Train Loss: 0.095 Vali Loss: 4.007 Vali Acc: 0.267 Test Loss: 4.007 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.3438761234283447
Epoch: 59, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.025 Vali Acc: 0.266 Test Loss: 4.025 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.4329214096069336
Epoch: 60, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.057 Vali Acc: 0.267 Test Loss: 4.057 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 29418
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5125021934509277
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.356 Vali Acc: 0.046 Test Loss: 3.356 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.4821946620941162
Epoch: 2, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.346 Vali Acc: 0.046 Test Loss: 3.346 Test Acc: 0.046
Validation loss decreased (-0.045849 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.43505024909973145
Epoch: 3, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.335 Vali Acc: 0.053 Test Loss: 3.335 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.4826381206512451
Epoch: 4, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.324 Vali Acc: 0.058 Test Loss: 3.324 Test Acc: 0.058
Validation loss decreased (-0.052908 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.4561483860015869
Epoch: 5, Steps: 10 | Train Loss: 3.217 Vali Loss: 3.312 Vali Acc: 0.062 Test Loss: 3.312 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 0.37786126136779785
Epoch: 6, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.303 Vali Acc: 0.068 Test Loss: 3.303 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 7 cost time: 0.4053657054901123
Epoch: 7, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.294 Vali Acc: 0.075 Test Loss: 3.294 Test Acc: 0.075
Validation loss decreased (-0.068202 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.4781064987182617
Epoch: 8, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.290 Vali Acc: 0.086 Test Loss: 3.290 Test Acc: 0.086
Validation loss decreased (-0.075261 --> -0.085849).  Saving model ...
Epoch: 9 cost time: 0.44335198402404785
Epoch: 9, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.286 Vali Acc: 0.079 Test Loss: 3.286 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47460007667541504
Epoch: 10, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.285 Vali Acc: 0.085 Test Loss: 3.285 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4388766288757324
Epoch: 11, Steps: 10 | Train Loss: 2.778 Vali Loss: 3.280 Vali Acc: 0.087 Test Loss: 3.280 Test Acc: 0.087
Validation loss decreased (-0.085849 --> -0.087026).  Saving model ...
Epoch: 12 cost time: 0.473233699798584
Epoch: 12, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.276 Vali Acc: 0.098 Test Loss: 3.276 Test Acc: 0.098
Validation loss decreased (-0.087026 --> -0.097614).  Saving model ...
Epoch: 13 cost time: 0.4330477714538574
Epoch: 13, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.276 Vali Acc: 0.098 Test Loss: 3.276 Test Acc: 0.098
Validation loss decreased (-0.097614 --> -0.097614).  Saving model ...
Epoch: 14 cost time: 0.480593204498291
Epoch: 14, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.269 Vali Acc: 0.100 Test Loss: 3.269 Test Acc: 0.100
Validation loss decreased (-0.097614 --> -0.099967).  Saving model ...
Epoch: 15 cost time: 0.44587278366088867
Epoch: 15, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.264 Vali Acc: 0.109 Test Loss: 3.264 Test Acc: 0.109
Validation loss decreased (-0.099967 --> -0.109379).  Saving model ...
Epoch: 16 cost time: 0.49319911003112793
Epoch: 16, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.257 Vali Acc: 0.109 Test Loss: 3.257 Test Acc: 0.109
Validation loss decreased (-0.109379 --> -0.109379).  Saving model ...
Epoch: 17 cost time: 0.433758020401001
Epoch: 17, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.256 Vali Acc: 0.112 Test Loss: 3.256 Test Acc: 0.112
Validation loss decreased (-0.109379 --> -0.111732).  Saving model ...
Epoch: 18 cost time: 0.47043609619140625
Epoch: 18, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.252 Vali Acc: 0.114 Test Loss: 3.252 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 19 cost time: 0.4521484375
Epoch: 19, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.246 Vali Acc: 0.120 Test Loss: 3.246 Test Acc: 0.120
Validation loss decreased (-0.114085 --> -0.119968).  Saving model ...
Epoch: 20 cost time: 0.42732858657836914
Epoch: 20, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.247 Vali Acc: 0.125 Test Loss: 3.247 Test Acc: 0.125
Validation loss decreased (-0.119968 --> -0.124673).  Saving model ...
Epoch: 21 cost time: 0.43549680709838867
Epoch: 21, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.244 Vali Acc: 0.126 Test Loss: 3.244 Test Acc: 0.126
Validation loss decreased (-0.124673 --> -0.125850).  Saving model ...
Epoch: 22 cost time: 0.4504392147064209
Epoch: 22, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.244 Vali Acc: 0.136 Test Loss: 3.244 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 23 cost time: 0.42107319831848145
Epoch: 23, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.249 Vali Acc: 0.134 Test Loss: 3.249 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.44806408882141113
Epoch: 24, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.244 Vali Acc: 0.140 Test Loss: 3.244 Test Acc: 0.140
Validation loss decreased (-0.136438 --> -0.139968).  Saving model ...
Epoch: 25 cost time: 0.5229873657226562
Epoch: 25, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.249 Vali Acc: 0.145 Test Loss: 3.249 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144673).  Saving model ...
Epoch: 26 cost time: 0.43637847900390625
Epoch: 26, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.251 Vali Acc: 0.151 Test Loss: 3.251 Test Acc: 0.151
Validation loss decreased (-0.144673 --> -0.150556).  Saving model ...
Epoch: 27 cost time: 0.41998720169067383
Epoch: 27, Steps: 10 | Train Loss: 1.598 Vali Loss: 3.261 Vali Acc: 0.156 Test Loss: 3.261 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156438).  Saving model ...
Epoch: 28 cost time: 0.4592742919921875
Epoch: 28, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.270 Vali Acc: 0.160 Test Loss: 3.270 Test Acc: 0.160
Validation loss decreased (-0.156438 --> -0.159967).  Saving model ...
Epoch: 29 cost time: 0.44067859649658203
Epoch: 29, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.273 Vali Acc: 0.168 Test Loss: 3.273 Test Acc: 0.168
Validation loss decreased (-0.159967 --> -0.168203).  Saving model ...
Epoch: 30 cost time: 0.44631075859069824
Epoch: 30, Steps: 10 | Train Loss: 1.328 Vali Loss: 3.284 Vali Acc: 0.172 Test Loss: 3.284 Test Acc: 0.172
Validation loss decreased (-0.168203 --> -0.171732).  Saving model ...
Epoch: 31 cost time: 0.42432355880737305
Epoch: 31, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.289 Vali Acc: 0.178 Test Loss: 3.289 Test Acc: 0.178
Validation loss decreased (-0.171732 --> -0.177614).  Saving model ...
Epoch: 32 cost time: 0.440934419631958
Epoch: 32, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.299 Vali Acc: 0.182 Test Loss: 3.299 Test Acc: 0.182
Validation loss decreased (-0.177614 --> -0.182320).  Saving model ...
Epoch: 33 cost time: 0.44201231002807617
Epoch: 33, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.312 Vali Acc: 0.182 Test Loss: 3.312 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4634671211242676
Epoch: 34, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.320 Vali Acc: 0.192 Test Loss: 3.320 Test Acc: 0.192
Validation loss decreased (-0.182320 --> -0.191732).  Saving model ...
Epoch: 35 cost time: 0.4460911750793457
Epoch: 35, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.338 Vali Acc: 0.195 Test Loss: 3.338 Test Acc: 0.195
Validation loss decreased (-0.191732 --> -0.195261).  Saving model ...
Epoch: 36 cost time: 0.4517834186553955
Epoch: 36, Steps: 10 | Train Loss: 0.949 Vali Loss: 3.359 Vali Acc: 0.195 Test Loss: 3.359 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.45932745933532715
Epoch: 37, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.359 Vali Acc: 0.201 Test Loss: 3.359 Test Acc: 0.201
Validation loss decreased (-0.195261 --> -0.201143).  Saving model ...
Epoch: 38 cost time: 0.45594096183776855
Epoch: 38, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.377 Vali Acc: 0.200 Test Loss: 3.377 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4497847557067871
Epoch: 39, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.396 Vali Acc: 0.209 Test Loss: 3.396 Test Acc: 0.209
Validation loss decreased (-0.201143 --> -0.209378).  Saving model ...
Epoch: 40 cost time: 0.430086612701416
Epoch: 40, Steps: 10 | Train Loss: 0.718 Vali Loss: 3.402 Vali Acc: 0.211 Test Loss: 3.402 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210554).  Saving model ...
Epoch: 41 cost time: 0.47844362258911133
Epoch: 41, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.420 Vali Acc: 0.213 Test Loss: 3.420 Test Acc: 0.213
Validation loss decreased (-0.210554 --> -0.212907).  Saving model ...
Epoch: 42 cost time: 0.45357632637023926
Epoch: 42, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.431 Vali Acc: 0.224 Test Loss: 3.431 Test Acc: 0.224
Validation loss decreased (-0.212907 --> -0.223495).  Saving model ...
Epoch: 43 cost time: 0.449176549911499
Epoch: 43, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.450 Vali Acc: 0.221 Test Loss: 3.450 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4679226875305176
Epoch: 44, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.469 Vali Acc: 0.224 Test Loss: 3.469 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4497354030609131
Epoch: 45, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.482 Vali Acc: 0.222 Test Loss: 3.482 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.41946887969970703
Epoch: 46, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.499 Vali Acc: 0.227 Test Loss: 3.499 Test Acc: 0.227
Validation loss decreased (-0.223495 --> -0.227024).  Saving model ...
Epoch: 47 cost time: 0.45179033279418945
Epoch: 47, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.518 Vali Acc: 0.220 Test Loss: 3.518 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4541149139404297
Epoch: 48, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.527 Vali Acc: 0.228 Test Loss: 3.527 Test Acc: 0.228
Validation loss decreased (-0.227024 --> -0.228200).  Saving model ...
Epoch: 49 cost time: 0.4611055850982666
Epoch: 49, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.538 Vali Acc: 0.229 Test Loss: 3.538 Test Acc: 0.229
Validation loss decreased (-0.228200 --> -0.229376).  Saving model ...
Epoch: 50 cost time: 0.4694328308105469
Epoch: 50, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.564 Vali Acc: 0.220 Test Loss: 3.564 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4919435977935791
Epoch: 51, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.586 Vali Acc: 0.225 Test Loss: 3.586 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4896585941314697
Epoch: 52, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.590 Vali Acc: 0.229 Test Loss: 3.590 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.4539058208465576
Epoch: 53, Steps: 10 | Train Loss: 0.312 Vali Loss: 3.609 Vali Acc: 0.231 Test Loss: 3.609 Test Acc: 0.231
Validation loss decreased (-0.229376 --> -0.230552).  Saving model ...
Epoch: 54 cost time: 0.4883120059967041
Epoch: 54, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.620 Vali Acc: 0.233 Test Loss: 3.620 Test Acc: 0.233
Validation loss decreased (-0.230552 --> -0.232905).  Saving model ...
Epoch: 55 cost time: 0.48813629150390625
Epoch: 55, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.630 Vali Acc: 0.235 Test Loss: 3.630 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235258).  Saving model ...
Epoch: 56 cost time: 0.45673060417175293
Epoch: 56, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.645 Vali Acc: 0.236 Test Loss: 3.645 Test Acc: 0.236
Validation loss decreased (-0.235258 --> -0.236434).  Saving model ...
Epoch: 57 cost time: 0.4876723289489746
Epoch: 57, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.678 Vali Acc: 0.232 Test Loss: 3.678 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.4695160388946533
Epoch: 58, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.684 Vali Acc: 0.232 Test Loss: 3.684 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.47862744331359863
Epoch: 59, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.711 Vali Acc: 0.232 Test Loss: 3.711 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.4463341236114502
Epoch: 60, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.728 Vali Acc: 0.228 Test Loss: 3.728 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.465503454208374
Epoch: 61, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.745 Vali Acc: 0.227 Test Loss: 3.745 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.44894886016845703
Epoch: 62, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.754 Vali Acc: 0.232 Test Loss: 3.754 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.4717438220977783
Epoch: 63, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.762 Vali Acc: 0.232 Test Loss: 3.762 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.4784703254699707
Epoch: 64, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.784 Vali Acc: 0.234 Test Loss: 3.784 Test Acc: 0.234
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.4370450973510742
Epoch: 65, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.806 Vali Acc: 0.235 Test Loss: 3.806 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.49712467193603516
Epoch: 66, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.809 Vali Acc: 0.232 Test Loss: 3.809 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 20794
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5421228408813477
Epoch: 1, Steps: 10 | Train Loss: 3.512 Vali Loss: 3.371 Vali Acc: 0.049 Test Loss: 3.371 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.43924593925476074
Epoch: 2, Steps: 10 | Train Loss: 3.472 Vali Loss: 3.369 Vali Acc: 0.047 Test Loss: 3.369 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43320560455322266
Epoch: 3, Steps: 10 | Train Loss: 3.482 Vali Loss: 3.360 Vali Acc: 0.047 Test Loss: 3.360 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.43660855293273926
Epoch: 4, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.345 Vali Acc: 0.053 Test Loss: 3.345 Test Acc: 0.053
Validation loss decreased (-0.049378 --> -0.052908).  Saving model ...
Epoch: 5 cost time: 0.46297478675842285
Epoch: 5, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.331 Vali Acc: 0.055 Test Loss: 3.331 Test Acc: 0.055
Validation loss decreased (-0.052908 --> -0.055261).  Saving model ...
Epoch: 6 cost time: 0.492631196975708
Epoch: 6, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.318 Vali Acc: 0.060 Test Loss: 3.318 Test Acc: 0.060
Validation loss decreased (-0.055261 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.44121527671813965
Epoch: 7, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.305 Vali Acc: 0.069 Test Loss: 3.305 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 0.49695420265197754
Epoch: 8, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.297 Vali Acc: 0.073 Test Loss: 3.297 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072908).  Saving model ...
Epoch: 9 cost time: 0.4397401809692383
Epoch: 9, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.289 Vali Acc: 0.076 Test Loss: 3.289 Test Acc: 0.076
Validation loss decreased (-0.072908 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 0.4933602809906006
Epoch: 10, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.283 Vali Acc: 0.079 Test Loss: 3.283 Test Acc: 0.079
Validation loss decreased (-0.076438 --> -0.078791).  Saving model ...
Epoch: 11 cost time: 0.42055296897888184
Epoch: 11, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.278 Vali Acc: 0.079 Test Loss: 3.278 Test Acc: 0.079
Validation loss decreased (-0.078791 --> -0.078791).  Saving model ...
Epoch: 12 cost time: 0.47815489768981934
Epoch: 12, Steps: 10 | Train Loss: 2.862 Vali Loss: 3.275 Vali Acc: 0.080 Test Loss: 3.275 Test Acc: 0.080
Validation loss decreased (-0.078791 --> -0.079967).  Saving model ...
Epoch: 13 cost time: 0.490619421005249
Epoch: 13, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.273 Vali Acc: 0.084 Test Loss: 3.273 Test Acc: 0.084
Validation loss decreased (-0.079967 --> -0.083497).  Saving model ...
Epoch: 14 cost time: 0.4317038059234619
Epoch: 14, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.272 Vali Acc: 0.089 Test Loss: 3.272 Test Acc: 0.089
Validation loss decreased (-0.083497 --> -0.089379).  Saving model ...
Epoch: 15 cost time: 0.4462461471557617
Epoch: 15, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.268 Vali Acc: 0.095 Test Loss: 3.268 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095261).  Saving model ...
Epoch: 16 cost time: 0.42861509323120117
Epoch: 16, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.264 Vali Acc: 0.095 Test Loss: 3.264 Test Acc: 0.095
Validation loss decreased (-0.095261 --> -0.095261).  Saving model ...
Epoch: 17 cost time: 0.4633350372314453
Epoch: 17, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.262 Vali Acc: 0.100 Test Loss: 3.262 Test Acc: 0.100
Validation loss decreased (-0.095261 --> -0.099967).  Saving model ...
Epoch: 18 cost time: 0.4320392608642578
Epoch: 18, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.261 Vali Acc: 0.107 Test Loss: 3.261 Test Acc: 0.107
Validation loss decreased (-0.099967 --> -0.107026).  Saving model ...
Epoch: 19 cost time: 0.4332587718963623
Epoch: 19, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.259 Vali Acc: 0.104 Test Loss: 3.259 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.47295689582824707
Epoch: 20, Steps: 10 | Train Loss: 2.375 Vali Loss: 3.259 Vali Acc: 0.111 Test Loss: 3.259 Test Acc: 0.111
Validation loss decreased (-0.107026 --> -0.110556).  Saving model ...
Epoch: 21 cost time: 0.501246452331543
Epoch: 21, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.258 Vali Acc: 0.112 Test Loss: 3.258 Test Acc: 0.112
Validation loss decreased (-0.110556 --> -0.111732).  Saving model ...
Epoch: 22 cost time: 0.4268198013305664
Epoch: 22, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.256 Vali Acc: 0.115 Test Loss: 3.256 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 23 cost time: 0.40434885025024414
Epoch: 23, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.252 Vali Acc: 0.127 Test Loss: 3.252 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127026).  Saving model ...
Epoch: 24 cost time: 0.4815800189971924
Epoch: 24, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.249 Vali Acc: 0.132 Test Loss: 3.249 Test Acc: 0.132
Validation loss decreased (-0.127026 --> -0.131732).  Saving model ...
Epoch: 25 cost time: 0.44365811347961426
Epoch: 25, Steps: 10 | Train Loss: 1.990 Vali Loss: 3.246 Vali Acc: 0.136 Test Loss: 3.246 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 26 cost time: 0.42594361305236816
Epoch: 26, Steps: 10 | Train Loss: 1.991 Vali Loss: 3.249 Vali Acc: 0.138 Test Loss: 3.249 Test Acc: 0.138
Validation loss decreased (-0.136438 --> -0.137615).  Saving model ...
Epoch: 27 cost time: 0.43094682693481445
Epoch: 27, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.251 Vali Acc: 0.144 Test Loss: 3.251 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 28 cost time: 0.45387768745422363
Epoch: 28, Steps: 10 | Train Loss: 1.814 Vali Loss: 3.251 Vali Acc: 0.151 Test Loss: 3.251 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 29 cost time: 0.46633005142211914
Epoch: 29, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.251 Vali Acc: 0.154 Test Loss: 3.251 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154085).  Saving model ...
Epoch: 30 cost time: 0.4444303512573242
Epoch: 30, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.252 Vali Acc: 0.164 Test Loss: 3.252 Test Acc: 0.164
Validation loss decreased (-0.154085 --> -0.163497).  Saving model ...
Epoch: 31 cost time: 0.4640235900878906
Epoch: 31, Steps: 10 | Train Loss: 1.585 Vali Loss: 3.261 Vali Acc: 0.166 Test Loss: 3.261 Test Acc: 0.166
Validation loss decreased (-0.163497 --> -0.165850).  Saving model ...
Epoch: 32 cost time: 0.4670369625091553
Epoch: 32, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.272 Vali Acc: 0.176 Test Loss: 3.272 Test Acc: 0.176
Validation loss decreased (-0.165850 --> -0.176438).  Saving model ...
Epoch: 33 cost time: 0.35749173164367676
Epoch: 33, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.276 Vali Acc: 0.182 Test Loss: 3.276 Test Acc: 0.182
Validation loss decreased (-0.176438 --> -0.182320).  Saving model ...
Epoch: 34 cost time: 0.4747645854949951
Epoch: 34, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.282 Vali Acc: 0.189 Test Loss: 3.282 Test Acc: 0.189
Validation loss decreased (-0.182320 --> -0.189379).  Saving model ...
Epoch: 35 cost time: 0.46851444244384766
Epoch: 35, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.297 Vali Acc: 0.191 Test Loss: 3.297 Test Acc: 0.191
Validation loss decreased (-0.189379 --> -0.190555).  Saving model ...
Epoch: 36 cost time: 0.4689459800720215
Epoch: 36, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.304 Vali Acc: 0.193 Test Loss: 3.304 Test Acc: 0.193
Validation loss decreased (-0.190555 --> -0.192908).  Saving model ...
Epoch: 37 cost time: 0.4403057098388672
Epoch: 37, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.315 Vali Acc: 0.195 Test Loss: 3.315 Test Acc: 0.195
Validation loss decreased (-0.192908 --> -0.195261).  Saving model ...
Epoch: 38 cost time: 0.46094822883605957
Epoch: 38, Steps: 10 | Train Loss: 1.179 Vali Loss: 3.324 Vali Acc: 0.198 Test Loss: 3.324 Test Acc: 0.198
Validation loss decreased (-0.195261 --> -0.197614).  Saving model ...
Epoch: 39 cost time: 0.4942896366119385
Epoch: 39, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.330 Vali Acc: 0.205 Test Loss: 3.330 Test Acc: 0.205
Validation loss decreased (-0.197614 --> -0.204673).  Saving model ...
Epoch: 40 cost time: 0.4831080436706543
Epoch: 40, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.343 Vali Acc: 0.206 Test Loss: 3.343 Test Acc: 0.206
Validation loss decreased (-0.204673 --> -0.205849).  Saving model ...
Epoch: 41 cost time: 0.47406530380249023
Epoch: 41, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.356 Vali Acc: 0.212 Test Loss: 3.356 Test Acc: 0.212
Validation loss decreased (-0.205849 --> -0.211731).  Saving model ...
Epoch: 42 cost time: 0.454315185546875
Epoch: 42, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.373 Vali Acc: 0.211 Test Loss: 3.373 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4635283946990967
Epoch: 43, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.388 Vali Acc: 0.208 Test Loss: 3.388 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.486710786819458
Epoch: 44, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.398 Vali Acc: 0.209 Test Loss: 3.398 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.45471882820129395
Epoch: 45, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.416 Vali Acc: 0.205 Test Loss: 3.416 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4743616580963135
Epoch: 46, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.427 Vali Acc: 0.211 Test Loss: 3.427 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.452683687210083
Epoch: 47, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.439 Vali Acc: 0.216 Test Loss: 3.439 Test Acc: 0.216
Validation loss decreased (-0.211731 --> -0.216436).  Saving model ...
Epoch: 48 cost time: 0.44829654693603516
Epoch: 48, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.452 Vali Acc: 0.215 Test Loss: 3.452 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.43628501892089844
Epoch: 49, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.469 Vali Acc: 0.214 Test Loss: 3.469 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.46106553077697754
Epoch: 50, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.495 Vali Acc: 0.220 Test Loss: 3.495 Test Acc: 0.220
Validation loss decreased (-0.216436 --> -0.219965).  Saving model ...
Epoch: 51 cost time: 0.45792651176452637
Epoch: 51, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.513 Vali Acc: 0.225 Test Loss: 3.513 Test Acc: 0.225
Validation loss decreased (-0.219965 --> -0.224671).  Saving model ...
Epoch: 52 cost time: 0.4673919677734375
Epoch: 52, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.528 Vali Acc: 0.225 Test Loss: 3.528 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4629068374633789
Epoch: 53, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.551 Vali Acc: 0.224 Test Loss: 3.551 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.47746968269348145
Epoch: 54, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.555 Vali Acc: 0.222 Test Loss: 3.555 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.46929335594177246
Epoch: 55, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.563 Vali Acc: 0.229 Test Loss: 3.563 Test Acc: 0.229
Validation loss decreased (-0.224671 --> -0.229376).  Saving model ...
Epoch: 56 cost time: 0.46303367614746094
Epoch: 56, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.580 Vali Acc: 0.227 Test Loss: 3.580 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.43618297576904297
Epoch: 57, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.608 Vali Acc: 0.224 Test Loss: 3.608 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4957907199859619
Epoch: 58, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.620 Vali Acc: 0.224 Test Loss: 3.620 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.4545886516571045
Epoch: 59, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.641 Vali Acc: 0.224 Test Loss: 3.641 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.4631619453430176
Epoch: 60, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.663 Vali Acc: 0.226 Test Loss: 3.663 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.4571051597595215
Epoch: 61, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.671 Vali Acc: 0.222 Test Loss: 3.671 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.45174551010131836
Epoch: 62, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.691 Vali Acc: 0.229 Test Loss: 3.691 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.4378786087036133
Epoch: 63, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.715 Vali Acc: 0.227 Test Loss: 3.715 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.4762837886810303
Epoch: 64, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.737 Vali Acc: 0.225 Test Loss: 3.737 Test Acc: 0.225
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.46973323822021484
Epoch: 65, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.744 Vali Acc: 0.225 Test Loss: 3.744 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22941176470588234
model parameter : 17178
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4280169010162354
Epoch: 1, Steps: 10 | Train Loss: 3.499 Vali Loss: 3.409 Vali Acc: 0.034 Test Loss: 3.409 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.4430232048034668
Epoch: 2, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.397 Vali Acc: 0.035 Test Loss: 3.397 Test Acc: 0.035
Validation loss decreased (-0.034084 --> -0.035260).  Saving model ...
Epoch: 3 cost time: 0.4569966793060303
Epoch: 3, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.390 Vali Acc: 0.042 Test Loss: 3.390 Test Acc: 0.042
Validation loss decreased (-0.035260 --> -0.042319).  Saving model ...
Epoch: 4 cost time: 0.46429967880249023
Epoch: 4, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.381 Vali Acc: 0.045 Test Loss: 3.381 Test Acc: 0.045
Validation loss decreased (-0.042319 --> -0.044672).  Saving model ...
Epoch: 5 cost time: 0.4595954418182373
Epoch: 5, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.372 Vali Acc: 0.051 Test Loss: 3.372 Test Acc: 0.051
Validation loss decreased (-0.044672 --> -0.050555).  Saving model ...
Epoch: 6 cost time: 0.5013241767883301
Epoch: 6, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.364 Vali Acc: 0.055 Test Loss: 3.364 Test Acc: 0.055
Validation loss decreased (-0.050555 --> -0.055260).  Saving model ...
Epoch: 7 cost time: 0.43590760231018066
Epoch: 7, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.356 Vali Acc: 0.058 Test Loss: 3.356 Test Acc: 0.058
Validation loss decreased (-0.055260 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 0.4908924102783203
Epoch: 8, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.349 Vali Acc: 0.060 Test Loss: 3.349 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 9 cost time: 0.4809398651123047
Epoch: 9, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.344 Vali Acc: 0.069 Test Loss: 3.344 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069378).  Saving model ...
Epoch: 10 cost time: 0.46149110794067383
Epoch: 10, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.338 Vali Acc: 0.080 Test Loss: 3.338 Test Acc: 0.080
Validation loss decreased (-0.069378 --> -0.079967).  Saving model ...
Epoch: 11 cost time: 0.49127674102783203
Epoch: 11, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.332 Vali Acc: 0.085 Test Loss: 3.332 Test Acc: 0.085
Validation loss decreased (-0.079967 --> -0.084673).  Saving model ...
Epoch: 12 cost time: 0.46796154975891113
Epoch: 12, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.328 Vali Acc: 0.086 Test Loss: 3.328 Test Acc: 0.086
Validation loss decreased (-0.084673 --> -0.085849).  Saving model ...
Epoch: 13 cost time: 0.47914743423461914
Epoch: 13, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.322 Vali Acc: 0.089 Test Loss: 3.322 Test Acc: 0.089
Validation loss decreased (-0.085849 --> -0.089379).  Saving model ...
Epoch: 14 cost time: 0.47175121307373047
Epoch: 14, Steps: 10 | Train Loss: 2.794 Vali Loss: 3.320 Vali Acc: 0.093 Test Loss: 3.320 Test Acc: 0.093
Validation loss decreased (-0.089379 --> -0.092908).  Saving model ...
Epoch: 15 cost time: 0.528886079788208
Epoch: 15, Steps: 10 | Train Loss: 2.736 Vali Loss: 3.319 Vali Acc: 0.094 Test Loss: 3.319 Test Acc: 0.094
Validation loss decreased (-0.092908 --> -0.094084).  Saving model ...
Epoch: 16 cost time: 0.511465311050415
Epoch: 16, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.313 Vali Acc: 0.100 Test Loss: 3.313 Test Acc: 0.100
Validation loss decreased (-0.094084 --> -0.099967).  Saving model ...
Epoch: 17 cost time: 0.4799230098724365
Epoch: 17, Steps: 10 | Train Loss: 2.604 Vali Loss: 3.309 Vali Acc: 0.101 Test Loss: 3.309 Test Acc: 0.101
Validation loss decreased (-0.099967 --> -0.101143).  Saving model ...
Epoch: 18 cost time: 0.4493250846862793
Epoch: 18, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.309 Vali Acc: 0.107 Test Loss: 3.309 Test Acc: 0.107
Validation loss decreased (-0.101143 --> -0.107026).  Saving model ...
Epoch: 19 cost time: 0.47431063652038574
Epoch: 19, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.305 Vali Acc: 0.113 Test Loss: 3.305 Test Acc: 0.113
Validation loss decreased (-0.107026 --> -0.112908).  Saving model ...
Epoch: 20 cost time: 0.4465291500091553
Epoch: 20, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.306 Vali Acc: 0.118 Test Loss: 3.306 Test Acc: 0.118
Validation loss decreased (-0.112908 --> -0.117614).  Saving model ...
Epoch: 21 cost time: 0.4825863838195801
Epoch: 21, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.309 Vali Acc: 0.122 Test Loss: 3.309 Test Acc: 0.122
Validation loss decreased (-0.117614 --> -0.122320).  Saving model ...
Epoch: 22 cost time: 0.43582868576049805
Epoch: 22, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.312 Vali Acc: 0.125 Test Loss: 3.312 Test Acc: 0.125
Validation loss decreased (-0.122320 --> -0.124673).  Saving model ...
Epoch: 23 cost time: 0.4770064353942871
Epoch: 23, Steps: 10 | Train Loss: 2.260 Vali Loss: 3.316 Vali Acc: 0.125 Test Loss: 3.316 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.46309447288513184
Epoch: 24, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.317 Vali Acc: 0.126 Test Loss: 3.317 Test Acc: 0.126
Validation loss decreased (-0.124673 --> -0.125849).  Saving model ...
Epoch: 25 cost time: 0.5132465362548828
Epoch: 25, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.317 Vali Acc: 0.135 Test Loss: 3.317 Test Acc: 0.135
Validation loss decreased (-0.125849 --> -0.135261).  Saving model ...
Epoch: 26 cost time: 0.4685380458831787
Epoch: 26, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.320 Vali Acc: 0.142 Test Loss: 3.320 Test Acc: 0.142
Validation loss decreased (-0.135261 --> -0.142320).  Saving model ...
Epoch: 27 cost time: 0.4711613655090332
Epoch: 27, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.321 Vali Acc: 0.142 Test Loss: 3.321 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4862644672393799
Epoch: 28, Steps: 10 | Train Loss: 1.951 Vali Loss: 3.324 Vali Acc: 0.146 Test Loss: 3.324 Test Acc: 0.146
Validation loss decreased (-0.142320 --> -0.145849).  Saving model ...
Epoch: 29 cost time: 0.44158077239990234
Epoch: 29, Steps: 10 | Train Loss: 1.843 Vali Loss: 3.328 Vali Acc: 0.142 Test Loss: 3.328 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4780750274658203
Epoch: 30, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.335 Vali Acc: 0.147 Test Loss: 3.335 Test Acc: 0.147
Validation loss decreased (-0.145849 --> -0.147025).  Saving model ...
Epoch: 31 cost time: 0.4832935333251953
Epoch: 31, Steps: 10 | Train Loss: 1.748 Vali Loss: 3.345 Vali Acc: 0.153 Test Loss: 3.345 Test Acc: 0.153
Validation loss decreased (-0.147025 --> -0.152908).  Saving model ...
Epoch: 32 cost time: 0.4669039249420166
Epoch: 32, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.354 Vali Acc: 0.158 Test Loss: 3.354 Test Acc: 0.158
Validation loss decreased (-0.152908 --> -0.157614).  Saving model ...
Epoch: 33 cost time: 0.4548368453979492
Epoch: 33, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.362 Vali Acc: 0.154 Test Loss: 3.362 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.44907236099243164
Epoch: 34, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.369 Vali Acc: 0.158 Test Loss: 3.369 Test Acc: 0.158
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4625284671783447
Epoch: 35, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.378 Vali Acc: 0.165 Test Loss: 3.378 Test Acc: 0.165
Validation loss decreased (-0.157614 --> -0.164672).  Saving model ...
Epoch: 36 cost time: 0.4554612636566162
Epoch: 36, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.396 Vali Acc: 0.168 Test Loss: 3.396 Test Acc: 0.168
Validation loss decreased (-0.164672 --> -0.168201).  Saving model ...
Epoch: 37 cost time: 0.4578263759613037
Epoch: 37, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.409 Vali Acc: 0.167 Test Loss: 3.409 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4438610076904297
Epoch: 38, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.418 Vali Acc: 0.165 Test Loss: 3.418 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.43436098098754883
Epoch: 39, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.428 Vali Acc: 0.165 Test Loss: 3.428 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4913322925567627
Epoch: 40, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.440 Vali Acc: 0.167 Test Loss: 3.440 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4578380584716797
Epoch: 41, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.453 Vali Acc: 0.169 Test Loss: 3.453 Test Acc: 0.169
Validation loss decreased (-0.168201 --> -0.169377).  Saving model ...
Epoch: 42 cost time: 0.4718468189239502
Epoch: 42, Steps: 10 | Train Loss: 1.131 Vali Loss: 3.460 Vali Acc: 0.175 Test Loss: 3.460 Test Acc: 0.175
Validation loss decreased (-0.169377 --> -0.175260).  Saving model ...
Epoch: 43 cost time: 0.4033780097961426
Epoch: 43, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.483 Vali Acc: 0.176 Test Loss: 3.483 Test Acc: 0.176
Validation loss decreased (-0.175260 --> -0.176436).  Saving model ...
Epoch: 44 cost time: 0.42347025871276855
Epoch: 44, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.501 Vali Acc: 0.176 Test Loss: 3.501 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.46039390563964844
Epoch: 45, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.507 Vali Acc: 0.182 Test Loss: 3.507 Test Acc: 0.182
Validation loss decreased (-0.176436 --> -0.182318).  Saving model ...
Epoch: 46 cost time: 0.44440722465515137
Epoch: 46, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.517 Vali Acc: 0.184 Test Loss: 3.517 Test Acc: 0.184
Validation loss decreased (-0.182318 --> -0.183494).  Saving model ...
Epoch: 47 cost time: 0.4546022415161133
Epoch: 47, Steps: 10 | Train Loss: 0.896 Vali Loss: 3.531 Vali Acc: 0.182 Test Loss: 3.531 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4463212490081787
Epoch: 48, Steps: 10 | Train Loss: 0.856 Vali Loss: 3.537 Vali Acc: 0.185 Test Loss: 3.537 Test Acc: 0.185
Validation loss decreased (-0.183494 --> -0.184671).  Saving model ...
Epoch: 49 cost time: 0.45168375968933105
Epoch: 49, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.558 Vali Acc: 0.186 Test Loss: 3.558 Test Acc: 0.186
Validation loss decreased (-0.184671 --> -0.185847).  Saving model ...
Epoch: 50 cost time: 0.4948861598968506
Epoch: 50, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.570 Vali Acc: 0.188 Test Loss: 3.570 Test Acc: 0.188
Validation loss decreased (-0.185847 --> -0.188200).  Saving model ...
Epoch: 51 cost time: 0.5334105491638184
Epoch: 51, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.587 Vali Acc: 0.191 Test Loss: 3.587 Test Acc: 0.191
Validation loss decreased (-0.188200 --> -0.190552).  Saving model ...
Epoch: 52 cost time: 0.4473249912261963
Epoch: 52, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.601 Vali Acc: 0.191 Test Loss: 3.601 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4783639907836914
Epoch: 53, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.616 Vali Acc: 0.191 Test Loss: 3.616 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.4724767208099365
Epoch: 54, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.635 Vali Acc: 0.194 Test Loss: 3.635 Test Acc: 0.194
Validation loss decreased (-0.190552 --> -0.194081).  Saving model ...
Epoch: 55 cost time: 0.5108668804168701
Epoch: 55, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.663 Vali Acc: 0.189 Test Loss: 3.663 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.4516103267669678
Epoch: 56, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.681 Vali Acc: 0.200 Test Loss: 3.681 Test Acc: 0.200
Validation loss decreased (-0.194081 --> -0.199963).  Saving model ...
Epoch: 57 cost time: 0.4677238464355469
Epoch: 57, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.681 Vali Acc: 0.195 Test Loss: 3.681 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5015182495117188
Epoch: 58, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.690 Vali Acc: 0.201 Test Loss: 3.690 Test Acc: 0.201
Validation loss decreased (-0.199963 --> -0.201140).  Saving model ...
Epoch: 59 cost time: 0.44998860359191895
Epoch: 59, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.719 Vali Acc: 0.200 Test Loss: 3.719 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5239839553833008
Epoch: 60, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.748 Vali Acc: 0.195 Test Loss: 3.748 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.47992610931396484
Epoch: 61, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.773 Vali Acc: 0.193 Test Loss: 3.773 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.45099925994873047
Epoch: 62, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.771 Vali Acc: 0.195 Test Loss: 3.771 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.46204566955566406
Epoch: 63, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.789 Vali Acc: 0.198 Test Loss: 3.789 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.47067785263061523
Epoch: 64, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.818 Vali Acc: 0.196 Test Loss: 3.818 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.48895764350891113
Epoch: 65, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.823 Vali Acc: 0.201 Test Loss: 3.823 Test Acc: 0.201
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.4483039379119873
Epoch: 66, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.834 Vali Acc: 0.201 Test Loss: 3.834 Test Acc: 0.201
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.48030877113342285
Epoch: 67, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.858 Vali Acc: 0.202 Test Loss: 3.858 Test Acc: 0.202
Validation loss decreased (-0.201140 --> -0.202314).  Saving model ...
Epoch: 68 cost time: 0.49210405349731445
Epoch: 68, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.882 Vali Acc: 0.207 Test Loss: 3.882 Test Acc: 0.207
Validation loss decreased (-0.202314 --> -0.207020).  Saving model ...
Epoch: 69 cost time: 0.43186283111572266
Epoch: 69, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.899 Vali Acc: 0.208 Test Loss: 3.899 Test Acc: 0.208
Validation loss decreased (-0.207020 --> -0.208196).  Saving model ...
Epoch: 70 cost time: 0.4796018600463867
Epoch: 70, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.912 Vali Acc: 0.215 Test Loss: 3.912 Test Acc: 0.215
Validation loss decreased (-0.208196 --> -0.215255).  Saving model ...
Epoch: 71 cost time: 0.47162365913391113
Epoch: 71, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.906 Vali Acc: 0.211 Test Loss: 3.906 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.3998699188232422
Epoch: 72, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.938 Vali Acc: 0.211 Test Loss: 3.938 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5112130641937256
Epoch: 73, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.934 Vali Acc: 0.211 Test Loss: 3.934 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5349526405334473
Epoch: 74, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.960 Vali Acc: 0.208 Test Loss: 3.960 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.45766329765319824
Epoch: 75, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.986 Vali Acc: 0.206 Test Loss: 3.986 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.45501089096069336
Epoch: 76, Steps: 10 | Train Loss: 0.236 Vali Loss: 4.023 Vali Acc: 0.208 Test Loss: 4.023 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.47090744972229004
Epoch: 77, Steps: 10 | Train Loss: 0.191 Vali Loss: 4.047 Vali Acc: 0.208 Test Loss: 4.047 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.4652676582336426
Epoch: 78, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.083 Vali Acc: 0.206 Test Loss: 4.083 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.4341297149658203
Epoch: 79, Steps: 10 | Train Loss: 0.204 Vali Loss: 4.079 Vali Acc: 0.211 Test Loss: 4.079 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.46629905700683594
Epoch: 80, Steps: 10 | Train Loss: 0.176 Vali Loss: 4.095 Vali Acc: 0.207 Test Loss: 4.095 Test Acc: 0.207
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df128_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.21529411764705883
model parameter : 16042
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5334973335266113
Epoch: 1, Steps: 10 | Train Loss: 3.466 Vali Loss: 3.342 Vali Acc: 0.048 Test Loss: 3.342 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.4720785617828369
Epoch: 2, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.327 Vali Acc: 0.055 Test Loss: 3.327 Test Acc: 0.055
Validation loss decreased (-0.048202 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.4845902919769287
Epoch: 3, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.359 Vali Acc: 0.065 Test Loss: 3.359 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064672).  Saving model ...
Epoch: 4 cost time: 0.45224976539611816
Epoch: 4, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.347 Vali Acc: 0.069 Test Loss: 3.347 Test Acc: 0.069
Validation loss decreased (-0.064672 --> -0.069378).  Saving model ...
Epoch: 5 cost time: 0.44617438316345215
Epoch: 5, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.296 Vali Acc: 0.093 Test Loss: 3.296 Test Acc: 0.093
Validation loss decreased (-0.069378 --> -0.092908).  Saving model ...
Epoch: 6 cost time: 0.4542722702026367
Epoch: 6, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.251 Vali Acc: 0.115 Test Loss: 3.251 Test Acc: 0.115
Validation loss decreased (-0.092908 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 0.48040032386779785
Epoch: 7, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.263 Vali Acc: 0.127 Test Loss: 3.263 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127026).  Saving model ...
Epoch: 8 cost time: 0.4638853073120117
Epoch: 8, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.235 Vali Acc: 0.140 Test Loss: 3.235 Test Acc: 0.140
Validation loss decreased (-0.127026 --> -0.139968).  Saving model ...
Epoch: 9 cost time: 0.4384651184082031
Epoch: 9, Steps: 10 | Train Loss: 2.008 Vali Loss: 3.228 Vali Acc: 0.149 Test Loss: 3.228 Test Acc: 0.149
Validation loss decreased (-0.139968 --> -0.149379).  Saving model ...
Epoch: 10 cost time: 0.4831855297088623
Epoch: 10, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.221 Vali Acc: 0.166 Test Loss: 3.221 Test Acc: 0.166
Validation loss decreased (-0.149379 --> -0.165850).  Saving model ...
Epoch: 11 cost time: 0.4870021343231201
Epoch: 11, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.247 Vali Acc: 0.193 Test Loss: 3.247 Test Acc: 0.193
Validation loss decreased (-0.165850 --> -0.192909).  Saving model ...
Epoch: 12 cost time: 0.4211447238922119
Epoch: 12, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.309 Vali Acc: 0.168 Test Loss: 3.309 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47122836112976074
Epoch: 13, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.323 Vali Acc: 0.174 Test Loss: 3.323 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4601016044616699
Epoch: 14, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.316 Vali Acc: 0.201 Test Loss: 3.316 Test Acc: 0.201
Validation loss decreased (-0.192909 --> -0.201143).  Saving model ...
Epoch: 15 cost time: 0.4812028408050537
Epoch: 15, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.410 Vali Acc: 0.202 Test Loss: 3.410 Test Acc: 0.202
Validation loss decreased (-0.201143 --> -0.202319).  Saving model ...
Epoch: 16 cost time: 0.4489428997039795
Epoch: 16, Steps: 10 | Train Loss: 0.740 Vali Loss: 3.382 Vali Acc: 0.235 Test Loss: 3.382 Test Acc: 0.235
Validation loss decreased (-0.202319 --> -0.235260).  Saving model ...
Epoch: 17 cost time: 0.46849536895751953
Epoch: 17, Steps: 10 | Train Loss: 0.649 Vali Loss: 3.425 Vali Acc: 0.232 Test Loss: 3.425 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5310542583465576
Epoch: 18, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.562 Vali Acc: 0.226 Test Loss: 3.562 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.44385290145874023
Epoch: 19, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.538 Vali Acc: 0.239 Test Loss: 3.538 Test Acc: 0.239
Validation loss decreased (-0.235260 --> -0.238788).  Saving model ...
Epoch: 20 cost time: 0.4654276371002197
Epoch: 20, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.618 Vali Acc: 0.235 Test Loss: 3.618 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4340798854827881
Epoch: 21, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.716 Vali Acc: 0.239 Test Loss: 3.716 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.45322179794311523
Epoch: 22, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.722 Vali Acc: 0.249 Test Loss: 3.722 Test Acc: 0.249
Validation loss decreased (-0.238788 --> -0.249375).  Saving model ...
Epoch: 23 cost time: 0.48966073989868164
Epoch: 23, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.874 Vali Acc: 0.244 Test Loss: 3.874 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4546654224395752
Epoch: 24, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.907 Vali Acc: 0.242 Test Loss: 3.907 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4650435447692871
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.961 Vali Acc: 0.251 Test Loss: 3.961 Test Acc: 0.251
Validation loss decreased (-0.249375 --> -0.250549).  Saving model ...
Epoch: 26 cost time: 0.5075342655181885
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.043 Vali Acc: 0.254 Test Loss: 4.043 Test Acc: 0.254
Validation loss decreased (-0.250549 --> -0.254077).  Saving model ...
Epoch: 27 cost time: 0.47715067863464355
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.057 Vali Acc: 0.256 Test Loss: 4.057 Test Acc: 0.256
Validation loss decreased (-0.254077 --> -0.256430).  Saving model ...
Epoch: 28 cost time: 0.44170093536376953
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.075 Vali Acc: 0.255 Test Loss: 4.075 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4740140438079834
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.134 Vali Acc: 0.259 Test Loss: 4.134 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258782).  Saving model ...
Epoch: 30 cost time: 0.4821157455444336
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.199 Vali Acc: 0.256 Test Loss: 4.199 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4985933303833008
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.259 Vali Acc: 0.249 Test Loss: 4.259 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5030238628387451
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.268 Vali Acc: 0.254 Test Loss: 4.268 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.46297121047973633
Epoch: 33, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.277 Vali Acc: 0.259 Test Loss: 4.277 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.46019816398620605
Epoch: 34, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.272 Vali Acc: 0.260 Test Loss: 4.272 Test Acc: 0.260
Validation loss decreased (-0.258782 --> -0.259957).  Saving model ...
Epoch: 35 cost time: 0.4628438949584961
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.293 Vali Acc: 0.262 Test Loss: 4.293 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262310).  Saving model ...
Epoch: 36 cost time: 0.4559624195098877
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.335 Vali Acc: 0.259 Test Loss: 4.335 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.46404290199279785
Epoch: 37, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.368 Vali Acc: 0.261 Test Loss: 4.368 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.44708991050720215
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.402 Vali Acc: 0.258 Test Loss: 4.402 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4568748474121094
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.419 Vali Acc: 0.260 Test Loss: 4.419 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.47016239166259766
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.437 Vali Acc: 0.262 Test Loss: 4.437 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.37087178230285645
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.451 Vali Acc: 0.260 Test Loss: 4.451 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.46486330032348633
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.459 Vali Acc: 0.262 Test Loss: 4.459 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.48966240882873535
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.494 Vali Acc: 0.260 Test Loss: 4.494 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.47520947456359863
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.521 Vali Acc: 0.264 Test Loss: 4.521 Test Acc: 0.264
Validation loss decreased (-0.262310 --> -0.263484).  Saving model ...
Epoch: 45 cost time: 0.46473121643066406
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.542 Vali Acc: 0.256 Test Loss: 4.542 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.46265244483947754
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.567 Vali Acc: 0.258 Test Loss: 4.567 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4684438705444336
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.576 Vali Acc: 0.262 Test Loss: 4.576 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.516434907913208
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.580 Vali Acc: 0.258 Test Loss: 4.580 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4886138439178467
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.596 Vali Acc: 0.260 Test Loss: 4.596 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.46112775802612305
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.601 Vali Acc: 0.259 Test Loss: 4.601 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.4763185977935791
Epoch: 51, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.614 Vali Acc: 0.262 Test Loss: 4.614 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.4356801509857178
Epoch: 52, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.625 Vali Acc: 0.262 Test Loss: 4.625 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.43401217460632324
Epoch: 53, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.644 Vali Acc: 0.261 Test Loss: 4.644 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.46382761001586914
Epoch: 54, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.658 Vali Acc: 0.261 Test Loss: 4.658 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 98250
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7405438423156738
Epoch: 1, Steps: 10 | Train Loss: 3.447 Vali Loss: 3.384 Vali Acc: 0.040 Test Loss: 3.384 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4654085636138916
Epoch: 2, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.359 Vali Acc: 0.052 Test Loss: 3.359 Test Acc: 0.052
Validation loss decreased (-0.039966 --> -0.051731).  Saving model ...
Epoch: 3 cost time: 0.4806802272796631
Epoch: 3, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.350 Vali Acc: 0.055 Test Loss: 3.350 Test Acc: 0.055
Validation loss decreased (-0.051731 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.453432559967041
Epoch: 4, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.344 Vali Acc: 0.085 Test Loss: 3.344 Test Acc: 0.085
Validation loss decreased (-0.055261 --> -0.084672).  Saving model ...
Epoch: 5 cost time: 0.44663548469543457
Epoch: 5, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.347 Vali Acc: 0.089 Test Loss: 3.347 Test Acc: 0.089
Validation loss decreased (-0.084672 --> -0.089378).  Saving model ...
Epoch: 6 cost time: 0.432114839553833
Epoch: 6, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.330 Vali Acc: 0.091 Test Loss: 3.330 Test Acc: 0.091
Validation loss decreased (-0.089378 --> -0.090555).  Saving model ...
Epoch: 7 cost time: 0.4563784599304199
Epoch: 7, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.312 Vali Acc: 0.101 Test Loss: 3.312 Test Acc: 0.101
Validation loss decreased (-0.090555 --> -0.101143).  Saving model ...
Epoch: 8 cost time: 0.486372709274292
Epoch: 8, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.282 Vali Acc: 0.112 Test Loss: 3.282 Test Acc: 0.112
Validation loss decreased (-0.101143 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 0.43502211570739746
Epoch: 9, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.257 Vali Acc: 0.121 Test Loss: 3.257 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.4721987247467041
Epoch: 10, Steps: 10 | Train Loss: 2.320 Vali Loss: 3.256 Vali Acc: 0.132 Test Loss: 3.256 Test Acc: 0.132
Validation loss decreased (-0.121144 --> -0.131732).  Saving model ...
Epoch: 11 cost time: 0.44818115234375
Epoch: 11, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.245 Vali Acc: 0.127 Test Loss: 3.245 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47192811965942383
Epoch: 12, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.247 Vali Acc: 0.136 Test Loss: 3.247 Test Acc: 0.136
Validation loss decreased (-0.131732 --> -0.136438).  Saving model ...
Epoch: 13 cost time: 0.461566686630249
Epoch: 13, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.246 Vali Acc: 0.159 Test Loss: 3.246 Test Acc: 0.159
Validation loss decreased (-0.136438 --> -0.158791).  Saving model ...
Epoch: 14 cost time: 0.488781213760376
Epoch: 14, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.244 Vali Acc: 0.168 Test Loss: 3.244 Test Acc: 0.168
Validation loss decreased (-0.158791 --> -0.168203).  Saving model ...
Epoch: 15 cost time: 0.46922755241394043
Epoch: 15, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.257 Vali Acc: 0.165 Test Loss: 3.257 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4316558837890625
Epoch: 16, Steps: 10 | Train Loss: 1.504 Vali Loss: 3.280 Vali Acc: 0.184 Test Loss: 3.280 Test Acc: 0.184
Validation loss decreased (-0.168203 --> -0.183497).  Saving model ...
Epoch: 17 cost time: 0.4728531837463379
Epoch: 17, Steps: 10 | Train Loss: 1.370 Vali Loss: 3.304 Vali Acc: 0.185 Test Loss: 3.304 Test Acc: 0.185
Validation loss decreased (-0.183497 --> -0.184673).  Saving model ...
Epoch: 18 cost time: 0.45316600799560547
Epoch: 18, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.302 Vali Acc: 0.188 Test Loss: 3.302 Test Acc: 0.188
Validation loss decreased (-0.184673 --> -0.188202).  Saving model ...
Epoch: 19 cost time: 0.482668399810791
Epoch: 19, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.323 Vali Acc: 0.193 Test Loss: 3.323 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 20 cost time: 0.44886207580566406
Epoch: 20, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.330 Vali Acc: 0.202 Test Loss: 3.330 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 21 cost time: 0.42827773094177246
Epoch: 21, Steps: 10 | Train Loss: 0.902 Vali Loss: 3.371 Vali Acc: 0.209 Test Loss: 3.371 Test Acc: 0.209
Validation loss decreased (-0.202320 --> -0.209378).  Saving model ...
Epoch: 22 cost time: 0.4812500476837158
Epoch: 22, Steps: 10 | Train Loss: 0.749 Vali Loss: 3.419 Vali Acc: 0.215 Test Loss: 3.419 Test Acc: 0.215
Validation loss decreased (-0.209378 --> -0.215260).  Saving model ...
Epoch: 23 cost time: 0.4566357135772705
Epoch: 23, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.443 Vali Acc: 0.224 Test Loss: 3.443 Test Acc: 0.224
Validation loss decreased (-0.215260 --> -0.223495).  Saving model ...
Epoch: 24 cost time: 0.48779797554016113
Epoch: 24, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.464 Vali Acc: 0.240 Test Loss: 3.464 Test Acc: 0.240
Validation loss decreased (-0.223495 --> -0.239965).  Saving model ...
Epoch: 25 cost time: 0.4569892883300781
Epoch: 25, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.530 Vali Acc: 0.246 Test Loss: 3.530 Test Acc: 0.246
Validation loss decreased (-0.239965 --> -0.245847).  Saving model ...
Epoch: 26 cost time: 0.4818305969238281
Epoch: 26, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.550 Vali Acc: 0.242 Test Loss: 3.550 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4691805839538574
Epoch: 27, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.592 Vali Acc: 0.252 Test Loss: 3.592 Test Acc: 0.252
Validation loss decreased (-0.245847 --> -0.251729).  Saving model ...
Epoch: 28 cost time: 0.44613194465637207
Epoch: 28, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.652 Vali Acc: 0.244 Test Loss: 3.652 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.44210124015808105
Epoch: 29, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.697 Vali Acc: 0.245 Test Loss: 3.697 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.44770383834838867
Epoch: 30, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.723 Vali Acc: 0.254 Test Loss: 3.723 Test Acc: 0.254
Validation loss decreased (-0.251729 --> -0.254080).  Saving model ...
Epoch: 31 cost time: 0.4645707607269287
Epoch: 31, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.791 Vali Acc: 0.256 Test Loss: 3.791 Test Acc: 0.256
Validation loss decreased (-0.254080 --> -0.256433).  Saving model ...
Epoch: 32 cost time: 0.47121739387512207
Epoch: 32, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.809 Vali Acc: 0.251 Test Loss: 3.809 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4403560161590576
Epoch: 33, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.859 Vali Acc: 0.260 Test Loss: 3.859 Test Acc: 0.260
Validation loss decreased (-0.256433 --> -0.259961).  Saving model ...
Epoch: 34 cost time: 0.46277832984924316
Epoch: 34, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.901 Vali Acc: 0.260 Test Loss: 3.901 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4233384132385254
Epoch: 35, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.915 Vali Acc: 0.259 Test Loss: 3.915 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.47683072090148926
Epoch: 36, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.944 Vali Acc: 0.264 Test Loss: 3.944 Test Acc: 0.264
Validation loss decreased (-0.259961 --> -0.263490).  Saving model ...
Epoch: 37 cost time: 0.4337656497955322
Epoch: 37, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.965 Vali Acc: 0.266 Test Loss: 3.965 Test Acc: 0.266
Validation loss decreased (-0.263490 --> -0.265843).  Saving model ...
Epoch: 38 cost time: 0.4646754264831543
Epoch: 38, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.995 Vali Acc: 0.259 Test Loss: 3.995 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.457042932510376
Epoch: 39, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.025 Vali Acc: 0.264 Test Loss: 4.025 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.46111464500427246
Epoch: 40, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.068 Vali Acc: 0.267 Test Loss: 4.068 Test Acc: 0.267
Validation loss decreased (-0.265843 --> -0.267018).  Saving model ...
Epoch: 41 cost time: 0.4535534381866455
Epoch: 41, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.102 Vali Acc: 0.264 Test Loss: 4.102 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.485274076461792
Epoch: 42, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.119 Vali Acc: 0.262 Test Loss: 4.119 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4424903392791748
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.150 Vali Acc: 0.260 Test Loss: 4.150 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.45439934730529785
Epoch: 44, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.179 Vali Acc: 0.264 Test Loss: 4.179 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.45900964736938477
Epoch: 45, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.190 Vali Acc: 0.266 Test Loss: 4.190 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.43288254737854004
Epoch: 46, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.210 Vali Acc: 0.265 Test Loss: 4.210 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.46550607681274414
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.225 Vali Acc: 0.268 Test Loss: 4.225 Test Acc: 0.268
Validation loss decreased (-0.267018 --> -0.268193).  Saving model ...
Epoch: 48 cost time: 0.4574289321899414
Epoch: 48, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.262 Vali Acc: 0.268 Test Loss: 4.262 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5036518573760986
Epoch: 49, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.276 Vali Acc: 0.265 Test Loss: 4.276 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.44814324378967285
Epoch: 50, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.292 Vali Acc: 0.262 Test Loss: 4.292 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4923264980316162
Epoch: 51, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.316 Vali Acc: 0.262 Test Loss: 4.316 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.4118356704711914
Epoch: 52, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.335 Vali Acc: 0.262 Test Loss: 4.335 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.4443509578704834
Epoch: 53, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.362 Vali Acc: 0.262 Test Loss: 4.362 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.4873065948486328
Epoch: 54, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.375 Vali Acc: 0.261 Test Loss: 4.375 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.47032880783081055
Epoch: 55, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.403 Vali Acc: 0.266 Test Loss: 4.403 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.47940587997436523
Epoch: 56, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.410 Vali Acc: 0.266 Test Loss: 4.410 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.469987154006958
Epoch: 57, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.416 Vali Acc: 0.261 Test Loss: 4.416 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 50890
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.404984474182129
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.355 Vali Acc: 0.047 Test Loss: 3.355 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.45119214057922363
Epoch: 2, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.333 Vali Acc: 0.044 Test Loss: 3.333 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4255504608154297
Epoch: 3, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.316 Vali Acc: 0.038 Test Loss: 3.316 Test Acc: 0.038
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45631909370422363
Epoch: 4, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.307 Vali Acc: 0.046 Test Loss: 3.307 Test Acc: 0.046
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.43332934379577637
Epoch: 5, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.310 Vali Acc: 0.053 Test Loss: 3.310 Test Acc: 0.053
Validation loss decreased (-0.047025 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 0.4360482692718506
Epoch: 6, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.307 Vali Acc: 0.066 Test Loss: 3.307 Test Acc: 0.066
Validation loss decreased (-0.052908 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.42560887336730957
Epoch: 7, Steps: 10 | Train Loss: 2.816 Vali Loss: 3.300 Vali Acc: 0.075 Test Loss: 3.300 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.4470221996307373
Epoch: 8, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.296 Vali Acc: 0.093 Test Loss: 3.296 Test Acc: 0.093
Validation loss decreased (-0.075261 --> -0.092908).  Saving model ...
Epoch: 9 cost time: 0.43387341499328613
Epoch: 9, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.290 Vali Acc: 0.100 Test Loss: 3.290 Test Acc: 0.100
Validation loss decreased (-0.092908 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 0.45131397247314453
Epoch: 10, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.278 Vali Acc: 0.102 Test Loss: 3.278 Test Acc: 0.102
Validation loss decreased (-0.099967 --> -0.102320).  Saving model ...
Epoch: 11 cost time: 0.42992067337036133
Epoch: 11, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.273 Vali Acc: 0.104 Test Loss: 3.273 Test Acc: 0.104
Validation loss decreased (-0.102320 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.46482324600219727
Epoch: 12, Steps: 10 | Train Loss: 2.321 Vali Loss: 3.258 Vali Acc: 0.114 Test Loss: 3.258 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 13 cost time: 0.42603421211242676
Epoch: 13, Steps: 10 | Train Loss: 2.217 Vali Loss: 3.244 Vali Acc: 0.121 Test Loss: 3.244 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 14 cost time: 0.4144725799560547
Epoch: 14, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.230 Vali Acc: 0.140 Test Loss: 3.230 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.45980024337768555
Epoch: 15, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.230 Vali Acc: 0.146 Test Loss: 3.230 Test Acc: 0.146
Validation loss decreased (-0.139968 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 0.42091941833496094
Epoch: 16, Steps: 10 | Train Loss: 1.734 Vali Loss: 3.228 Vali Acc: 0.164 Test Loss: 3.228 Test Acc: 0.164
Validation loss decreased (-0.145850 --> -0.163497).  Saving model ...
Epoch: 17 cost time: 0.44165778160095215
Epoch: 17, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.232 Vali Acc: 0.173 Test Loss: 3.232 Test Acc: 0.173
Validation loss decreased (-0.163497 --> -0.172909).  Saving model ...
Epoch: 18 cost time: 0.4364449977874756
Epoch: 18, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.250 Vali Acc: 0.179 Test Loss: 3.250 Test Acc: 0.179
Validation loss decreased (-0.172909 --> -0.178791).  Saving model ...
Epoch: 19 cost time: 0.44568777084350586
Epoch: 19, Steps: 10 | Train Loss: 1.458 Vali Loss: 3.257 Vali Acc: 0.176 Test Loss: 3.257 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4127359390258789
Epoch: 20, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.272 Vali Acc: 0.178 Test Loss: 3.272 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.40473318099975586
Epoch: 21, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.274 Vali Acc: 0.193 Test Loss: 3.274 Test Acc: 0.193
Validation loss decreased (-0.178791 --> -0.192908).  Saving model ...
Epoch: 22 cost time: 0.4508974552154541
Epoch: 22, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.285 Vali Acc: 0.199 Test Loss: 3.285 Test Acc: 0.199
Validation loss decreased (-0.192908 --> -0.198791).  Saving model ...
Epoch: 23 cost time: 0.40250134468078613
Epoch: 23, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.300 Vali Acc: 0.200 Test Loss: 3.300 Test Acc: 0.200
Validation loss decreased (-0.198791 --> -0.199967).  Saving model ...
Epoch: 24 cost time: 0.4202308654785156
Epoch: 24, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.323 Vali Acc: 0.209 Test Loss: 3.323 Test Acc: 0.209
Validation loss decreased (-0.199967 --> -0.209379).  Saving model ...
Epoch: 25 cost time: 0.43195366859436035
Epoch: 25, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.348 Vali Acc: 0.206 Test Loss: 3.348 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4395725727081299
Epoch: 26, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.362 Vali Acc: 0.204 Test Loss: 3.362 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4597764015197754
Epoch: 27, Steps: 10 | Train Loss: 0.712 Vali Loss: 3.379 Vali Acc: 0.211 Test Loss: 3.379 Test Acc: 0.211
Validation loss decreased (-0.209379 --> -0.210554).  Saving model ...
Epoch: 28 cost time: 0.45951151847839355
Epoch: 28, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.410 Vali Acc: 0.216 Test Loss: 3.410 Test Acc: 0.216
Validation loss decreased (-0.210554 --> -0.216436).  Saving model ...
Epoch: 29 cost time: 0.4533553123474121
Epoch: 29, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.456 Vali Acc: 0.219 Test Loss: 3.456 Test Acc: 0.219
Validation loss decreased (-0.216436 --> -0.218789).  Saving model ...
Epoch: 30 cost time: 0.37280774116516113
Epoch: 30, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.485 Vali Acc: 0.225 Test Loss: 3.485 Test Acc: 0.225
Validation loss decreased (-0.218789 --> -0.224671).  Saving model ...
Epoch: 31 cost time: 0.41849541664123535
Epoch: 31, Steps: 10 | Train Loss: 0.409 Vali Loss: 3.513 Vali Acc: 0.232 Test Loss: 3.513 Test Acc: 0.232
Validation loss decreased (-0.224671 --> -0.231730).  Saving model ...
Epoch: 32 cost time: 0.47969508171081543
Epoch: 32, Steps: 10 | Train Loss: 0.390 Vali Loss: 3.561 Vali Acc: 0.233 Test Loss: 3.561 Test Acc: 0.233
Validation loss decreased (-0.231730 --> -0.232906).  Saving model ...
Epoch: 33 cost time: 0.4884779453277588
Epoch: 33, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.590 Vali Acc: 0.229 Test Loss: 3.590 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.449939489364624
Epoch: 34, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.609 Vali Acc: 0.232 Test Loss: 3.609 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4475831985473633
Epoch: 35, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.621 Vali Acc: 0.240 Test Loss: 3.621 Test Acc: 0.240
Validation loss decreased (-0.232906 --> -0.239964).  Saving model ...
Epoch: 36 cost time: 0.43627476692199707
Epoch: 36, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.673 Vali Acc: 0.228 Test Loss: 3.673 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.3946976661682129
Epoch: 37, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.710 Vali Acc: 0.238 Test Loss: 3.710 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.417675256729126
Epoch: 38, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.724 Vali Acc: 0.238 Test Loss: 3.724 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.45348048210144043
Epoch: 39, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.753 Vali Acc: 0.231 Test Loss: 3.753 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5100002288818359
Epoch: 40, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.777 Vali Acc: 0.235 Test Loss: 3.777 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4568603038787842
Epoch: 41, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.797 Vali Acc: 0.229 Test Loss: 3.797 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.47641777992248535
Epoch: 42, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.798 Vali Acc: 0.239 Test Loss: 3.798 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.3554816246032715
Epoch: 43, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.829 Vali Acc: 0.236 Test Loss: 3.829 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.4713265895843506
Epoch: 44, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.848 Vali Acc: 0.245 Test Loss: 3.848 Test Acc: 0.245
Validation loss decreased (-0.239964 --> -0.244667).  Saving model ...
Epoch: 45 cost time: 0.5074563026428223
Epoch: 45, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.875 Vali Acc: 0.248 Test Loss: 3.875 Test Acc: 0.248
Validation loss decreased (-0.244667 --> -0.248197).  Saving model ...
Epoch: 46 cost time: 0.4357013702392578
Epoch: 46, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.891 Vali Acc: 0.244 Test Loss: 3.891 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.428633451461792
Epoch: 47, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.928 Vali Acc: 0.241 Test Loss: 3.928 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.44289612770080566
Epoch: 48, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.967 Vali Acc: 0.235 Test Loss: 3.967 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5006470680236816
Epoch: 49, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.977 Vali Acc: 0.238 Test Loss: 3.977 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.43367743492126465
Epoch: 50, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.991 Vali Acc: 0.238 Test Loss: 3.991 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.4553544521331787
Epoch: 51, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.003 Vali Acc: 0.244 Test Loss: 4.003 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.44806408882141113
Epoch: 52, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.028 Vali Acc: 0.242 Test Loss: 4.028 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.46564412117004395
Epoch: 53, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.047 Vali Acc: 0.240 Test Loss: 4.047 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.42677998542785645
Epoch: 54, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.069 Vali Acc: 0.235 Test Loss: 4.069 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.44399189949035645
Epoch: 55, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.072 Vali Acc: 0.245 Test Loss: 4.072 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 34730
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4704771041870117
Epoch: 1, Steps: 10 | Train Loss: 3.467 Vali Loss: 3.409 Vali Acc: 0.026 Test Loss: 3.409 Test Acc: 0.026
Validation loss decreased (inf --> -0.025848).  Saving model ...
Epoch: 2 cost time: 0.45752644538879395
Epoch: 2, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.397 Vali Acc: 0.034 Test Loss: 3.397 Test Acc: 0.034
Validation loss decreased (-0.025848 --> -0.034084).  Saving model ...
Epoch: 3 cost time: 0.4249391555786133
Epoch: 3, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.382 Vali Acc: 0.036 Test Loss: 3.382 Test Acc: 0.036
Validation loss decreased (-0.034084 --> -0.036437).  Saving model ...
Epoch: 4 cost time: 0.4505023956298828
Epoch: 4, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.364 Vali Acc: 0.041 Test Loss: 3.364 Test Acc: 0.041
Validation loss decreased (-0.036437 --> -0.041143).  Saving model ...
Epoch: 5 cost time: 0.45925402641296387
Epoch: 5, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.351 Vali Acc: 0.049 Test Loss: 3.351 Test Acc: 0.049
Validation loss decreased (-0.041143 --> -0.049378).  Saving model ...
Epoch: 6 cost time: 0.43013858795166016
Epoch: 6, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.339 Vali Acc: 0.066 Test Loss: 3.339 Test Acc: 0.066
Validation loss decreased (-0.049378 --> -0.065849).  Saving model ...
Epoch: 7 cost time: 0.44350600242614746
Epoch: 7, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.329 Vali Acc: 0.075 Test Loss: 3.329 Test Acc: 0.075
Validation loss decreased (-0.065849 --> -0.075261).  Saving model ...
Epoch: 8 cost time: 0.4482600688934326
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.320 Vali Acc: 0.087 Test Loss: 3.320 Test Acc: 0.087
Validation loss decreased (-0.075261 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 0.45330142974853516
Epoch: 9, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.312 Vali Acc: 0.095 Test Loss: 3.312 Test Acc: 0.095
Validation loss decreased (-0.087026 --> -0.095261).  Saving model ...
Epoch: 10 cost time: 0.449387788772583
Epoch: 10, Steps: 10 | Train Loss: 2.673 Vali Loss: 3.301 Vali Acc: 0.102 Test Loss: 3.301 Test Acc: 0.102
Validation loss decreased (-0.095261 --> -0.102320).  Saving model ...
Epoch: 11 cost time: 0.4384772777557373
Epoch: 11, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.292 Vali Acc: 0.112 Test Loss: 3.292 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 12 cost time: 0.4700629711151123
Epoch: 12, Steps: 10 | Train Loss: 2.463 Vali Loss: 3.282 Vali Acc: 0.120 Test Loss: 3.282 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119967).  Saving model ...
Epoch: 13 cost time: 0.4315013885498047
Epoch: 13, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.274 Vali Acc: 0.129 Test Loss: 3.274 Test Acc: 0.129
Validation loss decreased (-0.119967 --> -0.129379).  Saving model ...
Epoch: 14 cost time: 0.489307165145874
Epoch: 14, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.263 Vali Acc: 0.139 Test Loss: 3.263 Test Acc: 0.139
Validation loss decreased (-0.129379 --> -0.138791).  Saving model ...
Epoch: 15 cost time: 0.4087703227996826
Epoch: 15, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.258 Vali Acc: 0.132 Test Loss: 3.258 Test Acc: 0.132
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4750230312347412
Epoch: 16, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.251 Vali Acc: 0.146 Test Loss: 3.251 Test Acc: 0.146
Validation loss decreased (-0.138791 --> -0.145850).  Saving model ...
Epoch: 17 cost time: 0.4585399627685547
Epoch: 17, Steps: 10 | Train Loss: 1.906 Vali Loss: 3.252 Vali Acc: 0.152 Test Loss: 3.252 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151732).  Saving model ...
Epoch: 18 cost time: 0.4471144676208496
Epoch: 18, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.252 Vali Acc: 0.161 Test Loss: 3.252 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 19 cost time: 0.45415353775024414
Epoch: 19, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.259 Vali Acc: 0.173 Test Loss: 3.259 Test Acc: 0.173
Validation loss decreased (-0.161144 --> -0.172909).  Saving model ...
Epoch: 20 cost time: 0.4305598735809326
Epoch: 20, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.267 Vali Acc: 0.178 Test Loss: 3.267 Test Acc: 0.178
Validation loss decreased (-0.172909 --> -0.177614).  Saving model ...
Epoch: 21 cost time: 0.45194339752197266
Epoch: 21, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.272 Vali Acc: 0.184 Test Loss: 3.272 Test Acc: 0.184
Validation loss decreased (-0.177614 --> -0.183497).  Saving model ...
Epoch: 22 cost time: 0.42131567001342773
Epoch: 22, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.283 Vali Acc: 0.192 Test Loss: 3.283 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191732).  Saving model ...
Epoch: 23 cost time: 0.4946632385253906
Epoch: 23, Steps: 10 | Train Loss: 1.357 Vali Loss: 3.293 Vali Acc: 0.193 Test Loss: 3.293 Test Acc: 0.193
Validation loss decreased (-0.191732 --> -0.192908).  Saving model ...
Epoch: 24 cost time: 0.4496729373931885
Epoch: 24, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.303 Vali Acc: 0.193 Test Loss: 3.303 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.459566593170166
Epoch: 25, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.321 Vali Acc: 0.202 Test Loss: 3.321 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 26 cost time: 0.48449087142944336
Epoch: 26, Steps: 10 | Train Loss: 1.149 Vali Loss: 3.326 Vali Acc: 0.207 Test Loss: 3.326 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207026).  Saving model ...
Epoch: 27 cost time: 0.4689052104949951
Epoch: 27, Steps: 10 | Train Loss: 1.028 Vali Loss: 3.329 Vali Acc: 0.216 Test Loss: 3.329 Test Acc: 0.216
Validation loss decreased (-0.207026 --> -0.216437).  Saving model ...
Epoch: 28 cost time: 0.4673464298248291
Epoch: 28, Steps: 10 | Train Loss: 1.016 Vali Loss: 3.350 Vali Acc: 0.222 Test Loss: 3.350 Test Acc: 0.222
Validation loss decreased (-0.216437 --> -0.222319).  Saving model ...
Epoch: 29 cost time: 0.4543271064758301
Epoch: 29, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.369 Vali Acc: 0.224 Test Loss: 3.369 Test Acc: 0.224
Validation loss decreased (-0.222319 --> -0.223496).  Saving model ...
Epoch: 30 cost time: 0.45250391960144043
Epoch: 30, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.388 Vali Acc: 0.231 Test Loss: 3.388 Test Acc: 0.231
Validation loss decreased (-0.223496 --> -0.230554).  Saving model ...
Epoch: 31 cost time: 0.46141934394836426
Epoch: 31, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.410 Vali Acc: 0.236 Test Loss: 3.410 Test Acc: 0.236
Validation loss decreased (-0.230554 --> -0.236436).  Saving model ...
Epoch: 32 cost time: 0.4720418453216553
Epoch: 32, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.436 Vali Acc: 0.240 Test Loss: 3.436 Test Acc: 0.240
Validation loss decreased (-0.236436 --> -0.239966).  Saving model ...
Epoch: 33 cost time: 0.44045138359069824
Epoch: 33, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.460 Vali Acc: 0.236 Test Loss: 3.460 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4546976089477539
Epoch: 34, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.482 Vali Acc: 0.239 Test Loss: 3.482 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.43431639671325684
Epoch: 35, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.497 Vali Acc: 0.248 Test Loss: 3.497 Test Acc: 0.248
Validation loss decreased (-0.239966 --> -0.248200).  Saving model ...
Epoch: 36 cost time: 0.4785759449005127
Epoch: 36, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.526 Vali Acc: 0.252 Test Loss: 3.526 Test Acc: 0.252
Validation loss decreased (-0.248200 --> -0.251729).  Saving model ...
Epoch: 37 cost time: 0.4431345462799072
Epoch: 37, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.546 Vali Acc: 0.253 Test Loss: 3.546 Test Acc: 0.253
Validation loss decreased (-0.251729 --> -0.252906).  Saving model ...
Epoch: 38 cost time: 0.44578099250793457
Epoch: 38, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.582 Vali Acc: 0.258 Test Loss: 3.582 Test Acc: 0.258
Validation loss decreased (-0.252906 --> -0.257611).  Saving model ...
Epoch: 39 cost time: 0.4234752655029297
Epoch: 39, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.601 Vali Acc: 0.259 Test Loss: 3.601 Test Acc: 0.259
Validation loss decreased (-0.257611 --> -0.258788).  Saving model ...
Epoch: 40 cost time: 0.49411964416503906
Epoch: 40, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.608 Vali Acc: 0.260 Test Loss: 3.608 Test Acc: 0.260
Validation loss decreased (-0.258788 --> -0.259964).  Saving model ...
Epoch: 41 cost time: 0.43256092071533203
Epoch: 41, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.626 Vali Acc: 0.265 Test Loss: 3.626 Test Acc: 0.265
Validation loss decreased (-0.259964 --> -0.264670).  Saving model ...
Epoch: 42 cost time: 0.4403252601623535
Epoch: 42, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.662 Vali Acc: 0.259 Test Loss: 3.662 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4391951560974121
Epoch: 43, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.695 Vali Acc: 0.255 Test Loss: 3.695 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4265601634979248
Epoch: 44, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.717 Vali Acc: 0.256 Test Loss: 3.717 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5060532093048096
Epoch: 45, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.739 Vali Acc: 0.260 Test Loss: 3.739 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4190547466278076
Epoch: 46, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.772 Vali Acc: 0.258 Test Loss: 3.772 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.45932865142822266
Epoch: 47, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.796 Vali Acc: 0.262 Test Loss: 3.796 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.44142913818359375
Epoch: 48, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.798 Vali Acc: 0.261 Test Loss: 3.798 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.45175766944885254
Epoch: 49, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.810 Vali Acc: 0.258 Test Loss: 3.810 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.4414694309234619
Epoch: 50, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.829 Vali Acc: 0.259 Test Loss: 3.829 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.37398386001586914
Epoch: 51, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.844 Vali Acc: 0.258 Test Loss: 3.844 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 27306
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6005959510803223
Epoch: 1, Steps: 10 | Train Loss: 3.389 Vali Loss: 3.388 Vali Acc: 0.052 Test Loss: 3.388 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 0.4430067539215088
Epoch: 2, Steps: 10 | Train Loss: 3.435 Vali Loss: 3.380 Vali Acc: 0.058 Test Loss: 3.380 Test Acc: 0.058
Validation loss decreased (-0.051731 --> -0.057613).  Saving model ...
Epoch: 3 cost time: 0.4223926067352295
Epoch: 3, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.373 Vali Acc: 0.052 Test Loss: 3.373 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4041299819946289
Epoch: 4, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.361 Vali Acc: 0.054 Test Loss: 3.361 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4266166687011719
Epoch: 5, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.347 Vali Acc: 0.056 Test Loss: 3.347 Test Acc: 0.056
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.37578797340393066
Epoch: 6, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.336 Vali Acc: 0.056 Test Loss: 3.336 Test Acc: 0.056
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.35339784622192383
Epoch: 7, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.330 Vali Acc: 0.061 Test Loss: 3.330 Test Acc: 0.061
Validation loss decreased (-0.057613 --> -0.061143).  Saving model ...
Epoch: 8 cost time: 0.41858768463134766
Epoch: 8, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.324 Vali Acc: 0.062 Test Loss: 3.324 Test Acc: 0.062
Validation loss decreased (-0.061143 --> -0.062320).  Saving model ...
Epoch: 9 cost time: 0.3927302360534668
Epoch: 9, Steps: 10 | Train Loss: 2.995 Vali Loss: 3.318 Vali Acc: 0.068 Test Loss: 3.318 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068202).  Saving model ...
Epoch: 10 cost time: 0.3748023509979248
Epoch: 10, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.313 Vali Acc: 0.082 Test Loss: 3.313 Test Acc: 0.082
Validation loss decreased (-0.068202 --> -0.082320).  Saving model ...
Epoch: 11 cost time: 0.34626340866088867
Epoch: 11, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.307 Vali Acc: 0.096 Test Loss: 3.307 Test Acc: 0.096
Validation loss decreased (-0.082320 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.34517884254455566
Epoch: 12, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.304 Vali Acc: 0.106 Test Loss: 3.304 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105849).  Saving model ...
Epoch: 13 cost time: 0.38814735412597656
Epoch: 13, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.297 Vali Acc: 0.112 Test Loss: 3.297 Test Acc: 0.112
Validation loss decreased (-0.105849 --> -0.111732).  Saving model ...
Epoch: 14 cost time: 0.3599205017089844
Epoch: 14, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.293 Vali Acc: 0.114 Test Loss: 3.293 Test Acc: 0.114
Validation loss decreased (-0.111732 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 0.38846850395202637
Epoch: 15, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.292 Vali Acc: 0.118 Test Loss: 3.292 Test Acc: 0.118
Validation loss decreased (-0.114085 --> -0.117614).  Saving model ...
Epoch: 16 cost time: 0.3663909435272217
Epoch: 16, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.283 Vali Acc: 0.126 Test Loss: 3.283 Test Acc: 0.126
Validation loss decreased (-0.117614 --> -0.125850).  Saving model ...
Epoch: 17 cost time: 0.3668324947357178
Epoch: 17, Steps: 10 | Train Loss: 2.396 Vali Loss: 3.272 Vali Acc: 0.135 Test Loss: 3.272 Test Acc: 0.135
Validation loss decreased (-0.125850 --> -0.135261).  Saving model ...
Epoch: 18 cost time: 0.3488292694091797
Epoch: 18, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.270 Vali Acc: 0.142 Test Loss: 3.270 Test Acc: 0.142
Validation loss decreased (-0.135261 --> -0.142320).  Saving model ...
Epoch: 19 cost time: 0.36949872970581055
Epoch: 19, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.272 Vali Acc: 0.144 Test Loss: 3.272 Test Acc: 0.144
Validation loss decreased (-0.142320 --> -0.143497).  Saving model ...
Epoch: 20 cost time: 0.3920419216156006
Epoch: 20, Steps: 10 | Train Loss: 2.117 Vali Loss: 3.270 Vali Acc: 0.144 Test Loss: 3.270 Test Acc: 0.144
Validation loss decreased (-0.143497 --> -0.143497).  Saving model ...
Epoch: 21 cost time: 0.3868117332458496
Epoch: 21, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.271 Vali Acc: 0.152 Test Loss: 3.271 Test Acc: 0.152
Validation loss decreased (-0.143497 --> -0.151732).  Saving model ...
Epoch: 22 cost time: 0.4604628086090088
Epoch: 22, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.277 Vali Acc: 0.149 Test Loss: 3.277 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.443422794342041
Epoch: 23, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.281 Vali Acc: 0.152 Test Loss: 3.281 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4467275142669678
Epoch: 24, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.285 Vali Acc: 0.161 Test Loss: 3.285 Test Acc: 0.161
Validation loss decreased (-0.151732 --> -0.161144).  Saving model ...
Epoch: 25 cost time: 0.40978503227233887
Epoch: 25, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.291 Vali Acc: 0.167 Test Loss: 3.291 Test Acc: 0.167
Validation loss decreased (-0.161144 --> -0.167026).  Saving model ...
Epoch: 26 cost time: 0.4503016471862793
Epoch: 26, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.292 Vali Acc: 0.169 Test Loss: 3.292 Test Acc: 0.169
Validation loss decreased (-0.167026 --> -0.169379).  Saving model ...
Epoch: 27 cost time: 0.4341282844543457
Epoch: 27, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.300 Vali Acc: 0.175 Test Loss: 3.300 Test Acc: 0.175
Validation loss decreased (-0.169379 --> -0.175261).  Saving model ...
Epoch: 28 cost time: 0.4060389995574951
Epoch: 28, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.306 Vali Acc: 0.182 Test Loss: 3.306 Test Acc: 0.182
Validation loss decreased (-0.175261 --> -0.182320).  Saving model ...
Epoch: 29 cost time: 0.4222700595855713
Epoch: 29, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.314 Vali Acc: 0.181 Test Loss: 3.314 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4482262134552002
Epoch: 30, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.333 Vali Acc: 0.184 Test Loss: 3.333 Test Acc: 0.184
Validation loss decreased (-0.182320 --> -0.183496).  Saving model ...
Epoch: 31 cost time: 0.4427623748779297
Epoch: 31, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.349 Vali Acc: 0.189 Test Loss: 3.349 Test Acc: 0.189
Validation loss decreased (-0.183496 --> -0.189378).  Saving model ...
Epoch: 32 cost time: 0.45042896270751953
Epoch: 32, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.356 Vali Acc: 0.195 Test Loss: 3.356 Test Acc: 0.195
Validation loss decreased (-0.189378 --> -0.195261).  Saving model ...
Epoch: 33 cost time: 0.4219627380371094
Epoch: 33, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.374 Vali Acc: 0.200 Test Loss: 3.374 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199966).  Saving model ...
Epoch: 34 cost time: 0.40294885635375977
Epoch: 34, Steps: 10 | Train Loss: 1.113 Vali Loss: 3.379 Vali Acc: 0.205 Test Loss: 3.379 Test Acc: 0.205
Validation loss decreased (-0.199966 --> -0.204672).  Saving model ...
Epoch: 35 cost time: 0.4298279285430908
Epoch: 35, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.393 Vali Acc: 0.214 Test Loss: 3.393 Test Acc: 0.214
Validation loss decreased (-0.204672 --> -0.214084).  Saving model ...
Epoch: 36 cost time: 0.41707897186279297
Epoch: 36, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.416 Vali Acc: 0.212 Test Loss: 3.416 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4281775951385498
Epoch: 37, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.426 Vali Acc: 0.206 Test Loss: 3.426 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5215063095092773
Epoch: 38, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.443 Vali Acc: 0.212 Test Loss: 3.443 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.42215609550476074
Epoch: 39, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.459 Vali Acc: 0.215 Test Loss: 3.459 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215260).  Saving model ...
Epoch: 40 cost time: 0.4966578483581543
Epoch: 40, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.485 Vali Acc: 0.214 Test Loss: 3.485 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.41664814949035645
Epoch: 41, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.497 Vali Acc: 0.209 Test Loss: 3.497 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.3996298313140869
Epoch: 42, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.512 Vali Acc: 0.218 Test Loss: 3.512 Test Acc: 0.218
Validation loss decreased (-0.215260 --> -0.217612).  Saving model ...
Epoch: 43 cost time: 0.44615793228149414
Epoch: 43, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.532 Vali Acc: 0.220 Test Loss: 3.532 Test Acc: 0.220
Validation loss decreased (-0.217612 --> -0.219965).  Saving model ...
Epoch: 44 cost time: 0.40442371368408203
Epoch: 44, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.536 Vali Acc: 0.222 Test Loss: 3.536 Test Acc: 0.222
Validation loss decreased (-0.219965 --> -0.222318).  Saving model ...
Epoch: 45 cost time: 0.4432189464569092
Epoch: 45, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.545 Vali Acc: 0.222 Test Loss: 3.545 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.41362857818603516
Epoch: 46, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.567 Vali Acc: 0.220 Test Loss: 3.567 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4057183265686035
Epoch: 47, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.587 Vali Acc: 0.235 Test Loss: 3.587 Test Acc: 0.235
Validation loss decreased (-0.222318 --> -0.235258).  Saving model ...
Epoch: 48 cost time: 0.42028164863586426
Epoch: 48, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.602 Vali Acc: 0.245 Test Loss: 3.602 Test Acc: 0.245
Validation loss decreased (-0.235258 --> -0.244670).  Saving model ...
Epoch: 49 cost time: 0.4497349262237549
Epoch: 49, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.618 Vali Acc: 0.241 Test Loss: 3.618 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.44996118545532227
Epoch: 50, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.644 Vali Acc: 0.236 Test Loss: 3.644 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.42456936836242676
Epoch: 51, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.666 Vali Acc: 0.234 Test Loss: 3.666 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.42501378059387207
Epoch: 52, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.677 Vali Acc: 0.234 Test Loss: 3.677 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.428743839263916
Epoch: 53, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.698 Vali Acc: 0.231 Test Loss: 3.698 Test Acc: 0.231
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.4479365348815918
Epoch: 54, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.709 Vali Acc: 0.240 Test Loss: 3.709 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.4515388011932373
Epoch: 55, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.721 Vali Acc: 0.241 Test Loss: 3.721 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.4090261459350586
Epoch: 56, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.752 Vali Acc: 0.240 Test Loss: 3.752 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.4769468307495117
Epoch: 57, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.770 Vali Acc: 0.241 Test Loss: 3.770 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.43130040168762207
Epoch: 58, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.791 Vali Acc: 0.233 Test Loss: 3.791 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 18682
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.5032093524932861
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.367 Vali Acc: 0.033 Test Loss: 3.367 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.4342916011810303
Epoch: 2, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.364 Vali Acc: 0.027 Test Loss: 3.364 Test Acc: 0.027
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4281301498413086
Epoch: 3, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.360 Vali Acc: 0.031 Test Loss: 3.360 Test Acc: 0.031
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4509315490722656
Epoch: 4, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.353 Vali Acc: 0.035 Test Loss: 3.353 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 5 cost time: 0.4626171588897705
Epoch: 5, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.347 Vali Acc: 0.039 Test Loss: 3.347 Test Acc: 0.039
Validation loss decreased (-0.035261 --> -0.038790).  Saving model ...
Epoch: 6 cost time: 0.42929959297180176
Epoch: 6, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.339 Vali Acc: 0.035 Test Loss: 3.339 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4305236339569092
Epoch: 7, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.333 Vali Acc: 0.039 Test Loss: 3.333 Test Acc: 0.039
Validation loss decreased (-0.038790 --> -0.038790).  Saving model ...
Epoch: 8 cost time: 0.4259672164916992
Epoch: 8, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.329 Vali Acc: 0.054 Test Loss: 3.329 Test Acc: 0.054
Validation loss decreased (-0.038790 --> -0.054084).  Saving model ...
Epoch: 9 cost time: 0.42975354194641113
Epoch: 9, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.326 Vali Acc: 0.058 Test Loss: 3.326 Test Acc: 0.058
Validation loss decreased (-0.054084 --> -0.057614).  Saving model ...
Epoch: 10 cost time: 0.45009803771972656
Epoch: 10, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.326 Vali Acc: 0.060 Test Loss: 3.326 Test Acc: 0.060
Validation loss decreased (-0.057614 --> -0.059967).  Saving model ...
Epoch: 11 cost time: 0.4279823303222656
Epoch: 11, Steps: 10 | Train Loss: 2.869 Vali Loss: 3.326 Vali Acc: 0.064 Test Loss: 3.326 Test Acc: 0.064
Validation loss decreased (-0.059967 --> -0.063496).  Saving model ...
Epoch: 12 cost time: 0.4327535629272461
Epoch: 12, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.328 Vali Acc: 0.069 Test Loss: 3.328 Test Acc: 0.069
Validation loss decreased (-0.063496 --> -0.069378).  Saving model ...
Epoch: 13 cost time: 0.44130849838256836
Epoch: 13, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.328 Vali Acc: 0.069 Test Loss: 3.328 Test Acc: 0.069
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4318218231201172
Epoch: 14, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.329 Vali Acc: 0.073 Test Loss: 3.329 Test Acc: 0.073
Validation loss decreased (-0.069378 --> -0.072908).  Saving model ...
Epoch: 15 cost time: 0.46979308128356934
Epoch: 15, Steps: 10 | Train Loss: 2.608 Vali Loss: 3.328 Vali Acc: 0.074 Test Loss: 3.328 Test Acc: 0.074
Validation loss decreased (-0.072908 --> -0.074084).  Saving model ...
Epoch: 16 cost time: 0.4864389896392822
Epoch: 16, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.323 Vali Acc: 0.076 Test Loss: 3.323 Test Acc: 0.076
Validation loss decreased (-0.074084 --> -0.076437).  Saving model ...
Epoch: 17 cost time: 0.4391965866088867
Epoch: 17, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.322 Vali Acc: 0.081 Test Loss: 3.322 Test Acc: 0.081
Validation loss decreased (-0.076437 --> -0.081143).  Saving model ...
Epoch: 18 cost time: 0.4475681781768799
Epoch: 18, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.319 Vali Acc: 0.079 Test Loss: 3.319 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.45366644859313965
Epoch: 19, Steps: 10 | Train Loss: 2.326 Vali Loss: 3.318 Vali Acc: 0.084 Test Loss: 3.318 Test Acc: 0.084
Validation loss decreased (-0.081143 --> -0.083496).  Saving model ...
Epoch: 20 cost time: 0.39950060844421387
Epoch: 20, Steps: 10 | Train Loss: 2.404 Vali Loss: 3.321 Vali Acc: 0.088 Test Loss: 3.321 Test Acc: 0.088
Validation loss decreased (-0.083496 --> -0.088202).  Saving model ...
Epoch: 21 cost time: 0.5123140811920166
Epoch: 21, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.319 Vali Acc: 0.092 Test Loss: 3.319 Test Acc: 0.092
Validation loss decreased (-0.088202 --> -0.091732).  Saving model ...
Epoch: 22 cost time: 0.424588680267334
Epoch: 22, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.319 Vali Acc: 0.098 Test Loss: 3.319 Test Acc: 0.098
Validation loss decreased (-0.091732 --> -0.097614).  Saving model ...
Epoch: 23 cost time: 0.44954562187194824
Epoch: 23, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.319 Vali Acc: 0.099 Test Loss: 3.319 Test Acc: 0.099
Validation loss decreased (-0.097614 --> -0.098790).  Saving model ...
Epoch: 24 cost time: 0.4412105083465576
Epoch: 24, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.322 Vali Acc: 0.104 Test Loss: 3.322 Test Acc: 0.104
Validation loss decreased (-0.098790 --> -0.103496).  Saving model ...
Epoch: 25 cost time: 0.43273448944091797
Epoch: 25, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.321 Vali Acc: 0.106 Test Loss: 3.321 Test Acc: 0.106
Validation loss decreased (-0.103496 --> -0.105849).  Saving model ...
Epoch: 26 cost time: 0.47565531730651855
Epoch: 26, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.324 Vali Acc: 0.109 Test Loss: 3.324 Test Acc: 0.109
Validation loss decreased (-0.105849 --> -0.109379).  Saving model ...
Epoch: 27 cost time: 0.43483686447143555
Epoch: 27, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.332 Vali Acc: 0.120 Test Loss: 3.332 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119967).  Saving model ...
Epoch: 28 cost time: 0.44159364700317383
Epoch: 28, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.341 Vali Acc: 0.126 Test Loss: 3.341 Test Acc: 0.126
Validation loss decreased (-0.119967 --> -0.125849).  Saving model ...
Epoch: 29 cost time: 0.3505592346191406
Epoch: 29, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.342 Vali Acc: 0.126 Test Loss: 3.342 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.42383241653442383
Epoch: 30, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.351 Vali Acc: 0.126 Test Loss: 3.351 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.44703173637390137
Epoch: 31, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.360 Vali Acc: 0.127 Test Loss: 3.360 Test Acc: 0.127
Validation loss decreased (-0.125849 --> -0.127025).  Saving model ...
Epoch: 32 cost time: 0.4422435760498047
Epoch: 32, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.366 Vali Acc: 0.134 Test Loss: 3.366 Test Acc: 0.134
Validation loss decreased (-0.127025 --> -0.134084).  Saving model ...
Epoch: 33 cost time: 0.43267250061035156
Epoch: 33, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.377 Vali Acc: 0.140 Test Loss: 3.377 Test Acc: 0.140
Validation loss decreased (-0.134084 --> -0.139966).  Saving model ...
Epoch: 34 cost time: 0.4702644348144531
Epoch: 34, Steps: 10 | Train Loss: 1.427 Vali Loss: 3.387 Vali Acc: 0.147 Test Loss: 3.387 Test Acc: 0.147
Validation loss decreased (-0.139966 --> -0.147025).  Saving model ...
Epoch: 35 cost time: 0.4182722568511963
Epoch: 35, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.391 Vali Acc: 0.156 Test Loss: 3.391 Test Acc: 0.156
Validation loss decreased (-0.147025 --> -0.156437).  Saving model ...
Epoch: 36 cost time: 0.4204857349395752
Epoch: 36, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.405 Vali Acc: 0.161 Test Loss: 3.405 Test Acc: 0.161
Validation loss decreased (-0.156437 --> -0.161142).  Saving model ...
Epoch: 37 cost time: 0.43697595596313477
Epoch: 37, Steps: 10 | Train Loss: 1.198 Vali Loss: 3.421 Vali Acc: 0.155 Test Loss: 3.421 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.44181323051452637
Epoch: 38, Steps: 10 | Train Loss: 1.184 Vali Loss: 3.433 Vali Acc: 0.165 Test Loss: 3.433 Test Acc: 0.165
Validation loss decreased (-0.161142 --> -0.164672).  Saving model ...
Epoch: 39 cost time: 0.43216681480407715
Epoch: 39, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.448 Vali Acc: 0.168 Test Loss: 3.448 Test Acc: 0.168
Validation loss decreased (-0.164672 --> -0.168201).  Saving model ...
Epoch: 40 cost time: 0.48302149772644043
Epoch: 40, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.458 Vali Acc: 0.168 Test Loss: 3.458 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4355196952819824
Epoch: 41, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.472 Vali Acc: 0.173 Test Loss: 3.472 Test Acc: 0.173
Validation loss decreased (-0.168201 --> -0.172906).  Saving model ...
Epoch: 42 cost time: 0.43990373611450195
Epoch: 42, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.488 Vali Acc: 0.174 Test Loss: 3.488 Test Acc: 0.174
Validation loss decreased (-0.172906 --> -0.174083).  Saving model ...
Epoch: 43 cost time: 0.4672107696533203
Epoch: 43, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.518 Vali Acc: 0.175 Test Loss: 3.518 Test Acc: 0.175
Validation loss decreased (-0.174083 --> -0.175259).  Saving model ...
Epoch: 44 cost time: 0.45873284339904785
Epoch: 44, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.534 Vali Acc: 0.180 Test Loss: 3.534 Test Acc: 0.180
Validation loss decreased (-0.175259 --> -0.179965).  Saving model ...
Epoch: 45 cost time: 0.46784472465515137
Epoch: 45, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.547 Vali Acc: 0.185 Test Loss: 3.547 Test Acc: 0.185
Validation loss decreased (-0.179965 --> -0.184670).  Saving model ...
Epoch: 46 cost time: 0.4577338695526123
Epoch: 46, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.559 Vali Acc: 0.181 Test Loss: 3.559 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.43944501876831055
Epoch: 47, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.566 Vali Acc: 0.185 Test Loss: 3.566 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4477081298828125
Epoch: 48, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.588 Vali Acc: 0.188 Test Loss: 3.588 Test Acc: 0.188
Validation loss decreased (-0.184670 --> -0.188199).  Saving model ...
Epoch: 49 cost time: 0.48625874519348145
Epoch: 49, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.614 Vali Acc: 0.192 Test Loss: 3.614 Test Acc: 0.192
Validation loss decreased (-0.188199 --> -0.191729).  Saving model ...
Epoch: 50 cost time: 0.43511533737182617
Epoch: 50, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.636 Vali Acc: 0.199 Test Loss: 3.636 Test Acc: 0.199
Validation loss decreased (-0.191729 --> -0.198787).  Saving model ...
Epoch: 51 cost time: 0.4876985549926758
Epoch: 51, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.646 Vali Acc: 0.200 Test Loss: 3.646 Test Acc: 0.200
Validation loss decreased (-0.198787 --> -0.199964).  Saving model ...
Epoch: 52 cost time: 0.44629764556884766
Epoch: 52, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.656 Vali Acc: 0.202 Test Loss: 3.656 Test Acc: 0.202
Validation loss decreased (-0.199964 --> -0.202316).  Saving model ...
Epoch: 53 cost time: 0.483107328414917
Epoch: 53, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.687 Vali Acc: 0.198 Test Loss: 3.687 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4382801055908203
Epoch: 54, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.696 Vali Acc: 0.206 Test Loss: 3.696 Test Acc: 0.206
Validation loss decreased (-0.202316 --> -0.205845).  Saving model ...
Epoch: 55 cost time: 0.4239182472229004
Epoch: 55, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.712 Vali Acc: 0.205 Test Loss: 3.712 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.46563100814819336
Epoch: 56, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.736 Vali Acc: 0.208 Test Loss: 3.736 Test Acc: 0.208
Validation loss decreased (-0.205845 --> -0.208198).  Saving model ...
Epoch: 57 cost time: 0.4510078430175781
Epoch: 57, Steps: 10 | Train Loss: 0.426 Vali Loss: 3.760 Vali Acc: 0.205 Test Loss: 3.760 Test Acc: 0.205
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.47153687477111816
Epoch: 58, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.782 Vali Acc: 0.202 Test Loss: 3.782 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.4422011375427246
Epoch: 59, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.803 Vali Acc: 0.207 Test Loss: 3.803 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.4160587787628174
Epoch: 60, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.826 Vali Acc: 0.207 Test Loss: 3.826 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.4461524486541748
Epoch: 61, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.842 Vali Acc: 0.213 Test Loss: 3.842 Test Acc: 0.213
Validation loss decreased (-0.208198 --> -0.212903).  Saving model ...
Epoch: 62 cost time: 0.4147148132324219
Epoch: 62, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.850 Vali Acc: 0.215 Test Loss: 3.850 Test Acc: 0.215
Validation loss decreased (-0.212903 --> -0.215256).  Saving model ...
Epoch: 63 cost time: 0.4557034969329834
Epoch: 63, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.863 Vali Acc: 0.214 Test Loss: 3.863 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.42704010009765625
Epoch: 64, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.892 Vali Acc: 0.215 Test Loss: 3.892 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4443175792694092
Epoch: 65, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.907 Vali Acc: 0.214 Test Loss: 3.907 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.48104357719421387
Epoch: 66, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.928 Vali Acc: 0.213 Test Loss: 3.928 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.4703519344329834
Epoch: 67, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.941 Vali Acc: 0.213 Test Loss: 3.941 Test Acc: 0.213
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.4147813320159912
Epoch: 68, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.958 Vali Acc: 0.215 Test Loss: 3.958 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.42115163803100586
Epoch: 69, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.976 Vali Acc: 0.215 Test Loss: 3.976 Test Acc: 0.215
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.4569690227508545
Epoch: 70, Steps: 10 | Train Loss: 0.240 Vali Loss: 4.013 Vali Acc: 0.214 Test Loss: 4.013 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.4689137935638428
Epoch: 71, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.022 Vali Acc: 0.219 Test Loss: 4.022 Test Acc: 0.219
Validation loss decreased (-0.215256 --> -0.218783).  Saving model ...
Epoch: 72 cost time: 0.4904959201812744
Epoch: 72, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.026 Vali Acc: 0.219 Test Loss: 4.026 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.49514198303222656
Epoch: 73, Steps: 10 | Train Loss: 0.190 Vali Loss: 4.049 Vali Acc: 0.220 Test Loss: 4.049 Test Acc: 0.220
Validation loss decreased (-0.218783 --> -0.219960).  Saving model ...
Epoch: 74 cost time: 0.43805360794067383
Epoch: 74, Steps: 10 | Train Loss: 0.188 Vali Loss: 4.069 Vali Acc: 0.219 Test Loss: 4.069 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.4341084957122803
Epoch: 75, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.079 Vali Acc: 0.219 Test Loss: 4.079 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.43398213386535645
Epoch: 76, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.096 Vali Acc: 0.216 Test Loss: 4.096 Test Acc: 0.216
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.46669793128967285
Epoch: 77, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.111 Vali Acc: 0.218 Test Loss: 4.111 Test Acc: 0.218
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.4332430362701416
Epoch: 78, Steps: 10 | Train Loss: 0.151 Vali Loss: 4.108 Vali Acc: 0.220 Test Loss: 4.108 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.45957159996032715
Epoch: 79, Steps: 10 | Train Loss: 0.169 Vali Loss: 4.143 Vali Acc: 0.214 Test Loss: 4.143 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.5142183303833008
Epoch: 80, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.144 Vali Acc: 0.213 Test Loss: 4.144 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.45599818229675293
Epoch: 81, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.147 Vali Acc: 0.215 Test Loss: 4.147 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.4346592426300049
Epoch: 82, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.161 Vali Acc: 0.218 Test Loss: 4.161 Test Acc: 0.218
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.4934070110321045
Epoch: 83, Steps: 10 | Train Loss: 0.117 Vali Loss: 4.188 Vali Acc: 0.215 Test Loss: 4.188 Test Acc: 0.215
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.22
model parameter : 15066
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps38_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.4667224884033203
Epoch: 1, Steps: 10 | Train Loss: 3.451 Vali Loss: 3.414 Vali Acc: 0.040 Test Loss: 3.414 Test Acc: 0.040
Validation loss decreased (inf --> -0.039966).  Saving model ...
Epoch: 2 cost time: 0.4255845546722412
Epoch: 2, Steps: 10 | Train Loss: 3.491 Vali Loss: 3.405 Vali Acc: 0.049 Test Loss: 3.405 Test Acc: 0.049
Validation loss decreased (-0.039966 --> -0.049378).  Saving model ...
Epoch: 3 cost time: 0.4223208427429199
Epoch: 3, Steps: 10 | Train Loss: 3.448 Vali Loss: 3.397 Vali Acc: 0.047 Test Loss: 3.397 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4365878105163574
Epoch: 4, Steps: 10 | Train Loss: 3.385 Vali Loss: 3.389 Vali Acc: 0.051 Test Loss: 3.389 Test Acc: 0.051
Validation loss decreased (-0.049378 --> -0.050554).  Saving model ...
Epoch: 5 cost time: 0.4333679676055908
Epoch: 5, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.379 Vali Acc: 0.051 Test Loss: 3.379 Test Acc: 0.051
Validation loss decreased (-0.050554 --> -0.050554).  Saving model ...
Epoch: 6 cost time: 0.4260585308074951
Epoch: 6, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.368 Vali Acc: 0.052 Test Loss: 3.368 Test Acc: 0.052
Validation loss decreased (-0.050554 --> -0.051731).  Saving model ...
Epoch: 7 cost time: 0.42980504035949707
Epoch: 7, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.358 Vali Acc: 0.059 Test Loss: 3.358 Test Acc: 0.059
Validation loss decreased (-0.051731 --> -0.058790).  Saving model ...
Epoch: 8 cost time: 0.4105966091156006
Epoch: 8, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.351 Vali Acc: 0.064 Test Loss: 3.351 Test Acc: 0.064
Validation loss decreased (-0.058790 --> -0.063496).  Saving model ...
Epoch: 9 cost time: 0.42645978927612305
Epoch: 9, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.342 Vali Acc: 0.067 Test Loss: 3.342 Test Acc: 0.067
Validation loss decreased (-0.063496 --> -0.067025).  Saving model ...
Epoch: 10 cost time: 0.46413564682006836
Epoch: 10, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.336 Vali Acc: 0.075 Test Loss: 3.336 Test Acc: 0.075
Validation loss decreased (-0.067025 --> -0.075261).  Saving model ...
Epoch: 11 cost time: 0.4086451530456543
Epoch: 11, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.332 Vali Acc: 0.078 Test Loss: 3.332 Test Acc: 0.078
Validation loss decreased (-0.075261 --> -0.077614).  Saving model ...
Epoch: 12 cost time: 0.3992307186126709
Epoch: 12, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.325 Vali Acc: 0.079 Test Loss: 3.325 Test Acc: 0.079
Validation loss decreased (-0.077614 --> -0.078790).  Saving model ...
Epoch: 13 cost time: 0.43150854110717773
Epoch: 13, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.319 Vali Acc: 0.082 Test Loss: 3.319 Test Acc: 0.082
Validation loss decreased (-0.078790 --> -0.082320).  Saving model ...
Epoch: 14 cost time: 0.41513752937316895
Epoch: 14, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.312 Vali Acc: 0.086 Test Loss: 3.312 Test Acc: 0.086
Validation loss decreased (-0.082320 --> -0.085849).  Saving model ...
Epoch: 15 cost time: 0.42181873321533203
Epoch: 15, Steps: 10 | Train Loss: 2.771 Vali Loss: 3.309 Vali Acc: 0.094 Test Loss: 3.309 Test Acc: 0.094
Validation loss decreased (-0.085849 --> -0.094085).  Saving model ...
Epoch: 16 cost time: 0.403637170791626
Epoch: 16, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.309 Vali Acc: 0.099 Test Loss: 3.309 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098790).  Saving model ...
Epoch: 17 cost time: 0.42495107650756836
Epoch: 17, Steps: 10 | Train Loss: 2.621 Vali Loss: 3.305 Vali Acc: 0.102 Test Loss: 3.305 Test Acc: 0.102
Validation loss decreased (-0.098790 --> -0.102320).  Saving model ...
Epoch: 18 cost time: 0.4315476417541504
Epoch: 18, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.301 Vali Acc: 0.108 Test Loss: 3.301 Test Acc: 0.108
Validation loss decreased (-0.102320 --> -0.108202).  Saving model ...
Epoch: 19 cost time: 0.40964818000793457
Epoch: 19, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.299 Vali Acc: 0.114 Test Loss: 3.299 Test Acc: 0.114
Validation loss decreased (-0.108202 --> -0.114085).  Saving model ...
Epoch: 20 cost time: 0.354825496673584
Epoch: 20, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.294 Vali Acc: 0.112 Test Loss: 3.294 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.42093467712402344
Epoch: 21, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.292 Vali Acc: 0.124 Test Loss: 3.292 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123496).  Saving model ...
Epoch: 22 cost time: 0.3881266117095947
Epoch: 22, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.292 Vali Acc: 0.128 Test Loss: 3.292 Test Acc: 0.128
Validation loss decreased (-0.123496 --> -0.128202).  Saving model ...
Epoch: 23 cost time: 0.3966820240020752
Epoch: 23, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.291 Vali Acc: 0.133 Test Loss: 3.291 Test Acc: 0.133
Validation loss decreased (-0.128202 --> -0.132908).  Saving model ...
Epoch: 24 cost time: 0.4213135242462158
Epoch: 24, Steps: 10 | Train Loss: 2.236 Vali Loss: 3.287 Vali Acc: 0.136 Test Loss: 3.287 Test Acc: 0.136
Validation loss decreased (-0.132908 --> -0.136438).  Saving model ...
Epoch: 25 cost time: 0.4453446865081787
Epoch: 25, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.288 Vali Acc: 0.144 Test Loss: 3.288 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 26 cost time: 0.4346790313720703
Epoch: 26, Steps: 10 | Train Loss: 2.058 Vali Loss: 3.289 Vali Acc: 0.146 Test Loss: 3.289 Test Acc: 0.146
Validation loss decreased (-0.143497 --> -0.145849).  Saving model ...
Epoch: 27 cost time: 0.4290742874145508
Epoch: 27, Steps: 10 | Train Loss: 2.036 Vali Loss: 3.294 Vali Acc: 0.152 Test Loss: 3.294 Test Acc: 0.152
Validation loss decreased (-0.145849 --> -0.151732).  Saving model ...
Epoch: 28 cost time: 0.402432918548584
Epoch: 28, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.300 Vali Acc: 0.155 Test Loss: 3.300 Test Acc: 0.155
Validation loss decreased (-0.151732 --> -0.155261).  Saving model ...
Epoch: 29 cost time: 0.32896900177001953
Epoch: 29, Steps: 10 | Train Loss: 1.865 Vali Loss: 3.302 Vali Acc: 0.158 Test Loss: 3.302 Test Acc: 0.158
Validation loss decreased (-0.155261 --> -0.157614).  Saving model ...
Epoch: 30 cost time: 0.440232515335083
Epoch: 30, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.302 Vali Acc: 0.161 Test Loss: 3.302 Test Acc: 0.161
Validation loss decreased (-0.157614 --> -0.161143).  Saving model ...
Epoch: 31 cost time: 0.4350130558013916
Epoch: 31, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.308 Vali Acc: 0.164 Test Loss: 3.308 Test Acc: 0.164
Validation loss decreased (-0.161143 --> -0.163496).  Saving model ...
Epoch: 32 cost time: 0.4219672679901123
Epoch: 32, Steps: 10 | Train Loss: 1.761 Vali Loss: 3.319 Vali Acc: 0.165 Test Loss: 3.319 Test Acc: 0.165
Validation loss decreased (-0.163496 --> -0.164673).  Saving model ...
Epoch: 33 cost time: 0.41928625106811523
Epoch: 33, Steps: 10 | Train Loss: 1.629 Vali Loss: 3.327 Vali Acc: 0.172 Test Loss: 3.327 Test Acc: 0.172
Validation loss decreased (-0.164673 --> -0.171731).  Saving model ...
Epoch: 34 cost time: 0.4147756099700928
Epoch: 34, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.336 Vali Acc: 0.174 Test Loss: 3.336 Test Acc: 0.174
Validation loss decreased (-0.171731 --> -0.174084).  Saving model ...
Epoch: 35 cost time: 0.4270365238189697
Epoch: 35, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.338 Vali Acc: 0.180 Test Loss: 3.338 Test Acc: 0.180
Validation loss decreased (-0.174084 --> -0.179967).  Saving model ...
Epoch: 36 cost time: 0.4684748649597168
Epoch: 36, Steps: 10 | Train Loss: 1.476 Vali Loss: 3.349 Vali Acc: 0.185 Test Loss: 3.349 Test Acc: 0.185
Validation loss decreased (-0.179967 --> -0.184672).  Saving model ...
Epoch: 37 cost time: 0.4329557418823242
Epoch: 37, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.360 Vali Acc: 0.184 Test Loss: 3.360 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.45942020416259766
Epoch: 38, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.378 Vali Acc: 0.184 Test Loss: 3.378 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4330928325653076
Epoch: 39, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.377 Vali Acc: 0.189 Test Loss: 3.377 Test Acc: 0.189
Validation loss decreased (-0.184672 --> -0.189378).  Saving model ...
Epoch: 40 cost time: 0.43868446350097656
Epoch: 40, Steps: 10 | Train Loss: 1.263 Vali Loss: 3.396 Vali Acc: 0.192 Test Loss: 3.396 Test Acc: 0.192
Validation loss decreased (-0.189378 --> -0.191731).  Saving model ...
Epoch: 41 cost time: 0.48238587379455566
Epoch: 41, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.414 Vali Acc: 0.193 Test Loss: 3.414 Test Acc: 0.193
Validation loss decreased (-0.191731 --> -0.192907).  Saving model ...
Epoch: 42 cost time: 0.4490015506744385
Epoch: 42, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.423 Vali Acc: 0.189 Test Loss: 3.423 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4768052101135254
Epoch: 43, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.435 Vali Acc: 0.192 Test Loss: 3.435 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.45330047607421875
Epoch: 44, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.453 Vali Acc: 0.195 Test Loss: 3.453 Test Acc: 0.195
Validation loss decreased (-0.192907 --> -0.195260).  Saving model ...
Epoch: 45 cost time: 0.43776512145996094
Epoch: 45, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.468 Vali Acc: 0.199 Test Loss: 3.468 Test Acc: 0.199
Validation loss decreased (-0.195260 --> -0.198789).  Saving model ...
Epoch: 46 cost time: 0.39832139015197754
Epoch: 46, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.483 Vali Acc: 0.200 Test Loss: 3.483 Test Acc: 0.200
Validation loss decreased (-0.198789 --> -0.199965).  Saving model ...
Epoch: 47 cost time: 0.4384009838104248
Epoch: 47, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.493 Vali Acc: 0.194 Test Loss: 3.493 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.41558146476745605
Epoch: 48, Steps: 10 | Train Loss: 0.890 Vali Loss: 3.507 Vali Acc: 0.192 Test Loss: 3.507 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4532606601715088
Epoch: 49, Steps: 10 | Train Loss: 0.798 Vali Loss: 3.520 Vali Acc: 0.193 Test Loss: 3.520 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4467592239379883
Epoch: 50, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.528 Vali Acc: 0.198 Test Loss: 3.528 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.43967103958129883
Epoch: 51, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.544 Vali Acc: 0.199 Test Loss: 3.544 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.3435647487640381
Epoch: 52, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.549 Vali Acc: 0.202 Test Loss: 3.549 Test Acc: 0.202
Validation loss decreased (-0.199965 --> -0.202317).  Saving model ...
Epoch: 53 cost time: 0.47265052795410156
Epoch: 53, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.569 Vali Acc: 0.199 Test Loss: 3.569 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4217352867126465
Epoch: 54, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.584 Vali Acc: 0.212 Test Loss: 3.584 Test Acc: 0.212
Validation loss decreased (-0.202317 --> -0.211729).  Saving model ...
Epoch: 55 cost time: 0.4050924777984619
Epoch: 55, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.603 Vali Acc: 0.209 Test Loss: 3.603 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.39785027503967285
Epoch: 56, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.634 Vali Acc: 0.207 Test Loss: 3.634 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4034147262573242
Epoch: 57, Steps: 10 | Train Loss: 0.570 Vali Loss: 3.657 Vali Acc: 0.205 Test Loss: 3.657 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.4154813289642334
Epoch: 58, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.667 Vali Acc: 0.207 Test Loss: 3.667 Test Acc: 0.207
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.4513227939605713
Epoch: 59, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.682 Vali Acc: 0.208 Test Loss: 3.682 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.42092323303222656
Epoch: 60, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.697 Vali Acc: 0.215 Test Loss: 3.697 Test Acc: 0.215
Validation loss decreased (-0.211729 --> -0.215257).  Saving model ...
Epoch: 61 cost time: 0.3844597339630127
Epoch: 61, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.722 Vali Acc: 0.220 Test Loss: 3.722 Test Acc: 0.220
Validation loss decreased (-0.215257 --> -0.219963).  Saving model ...
Epoch: 62 cost time: 0.4293177127838135
Epoch: 62, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.736 Vali Acc: 0.222 Test Loss: 3.736 Test Acc: 0.222
Validation loss decreased (-0.219963 --> -0.222316).  Saving model ...
Epoch: 63 cost time: 0.4697890281677246
Epoch: 63, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.737 Vali Acc: 0.218 Test Loss: 3.737 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.426837682723999
Epoch: 64, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.760 Vali Acc: 0.216 Test Loss: 3.760 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4289429187774658
Epoch: 65, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.772 Vali Acc: 0.214 Test Loss: 3.772 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.41919851303100586
Epoch: 66, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.800 Vali Acc: 0.215 Test Loss: 3.800 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.44522523880004883
Epoch: 67, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.808 Vali Acc: 0.209 Test Loss: 3.808 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.41742730140686035
Epoch: 68, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.813 Vali Acc: 0.215 Test Loss: 3.813 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.43671536445617676
Epoch: 69, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.828 Vali Acc: 0.214 Test Loss: 3.828 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.46408605575561523
Epoch: 70, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.852 Vali Acc: 0.219 Test Loss: 3.852 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.43488049507141113
Epoch: 71, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.884 Vali Acc: 0.219 Test Loss: 3.884 Test Acc: 0.219
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.4408905506134033
Epoch: 72, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.917 Vali Acc: 0.219 Test Loss: 3.917 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_PatchTST_UEA_ftM_sl152_ll0_pl0_el1_dm16_nh4_df64_ps38_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2223529411764706
model parameter : 13930
model size : 0.37MB
