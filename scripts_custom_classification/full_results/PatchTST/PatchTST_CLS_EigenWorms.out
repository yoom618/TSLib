Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.595887660980225
Epoch: 1, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.565 Vali Acc: 0.412 Test Loss: 1.565 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 2.1118829250335693
Epoch: 2, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.479 Vali Acc: 0.466 Test Loss: 1.479 Test Acc: 0.466
Validation loss decreased (-0.412198 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 2.328352451324463
Epoch: 3, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 2.2269909381866455
Epoch: 4, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.546 Vali Acc: 0.412 Test Loss: 1.546 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4815995693206787
Epoch: 5, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.670 Vali Acc: 0.504 Test Loss: 1.670 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.36586332321167
Epoch: 6, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.763 Vali Acc: 0.534 Test Loss: 1.763 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534334).  Saving model ...
Epoch: 7 cost time: 2.307983160018921
Epoch: 7, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.215 Vali Acc: 0.527 Test Loss: 2.215 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6660618782043457
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.450 Test Loss: 1.630 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4629549980163574
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.466 Test Loss: 1.693 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.415311574935913
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.919 Vali Acc: 0.519 Test Loss: 1.919 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4256489276885986
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.527 Test Loss: 2.012 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.176170825958252
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.527 Test Loss: 1.982 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1598219871520996
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.527 Test Loss: 1.914 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0958757400512695
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.881 Vali Acc: 0.527 Test Loss: 1.881 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0851333141326904
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.303389310836792
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.527 Test Loss: 1.878 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 758661
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6716928482055664
Epoch: 1, Steps: 8 | Train Loss: 1.652 Vali Loss: 1.648 Vali Acc: 0.397 Test Loss: 1.648 Test Acc: 0.397
Validation loss decreased (inf --> -0.396930).  Saving model ...
Epoch: 2 cost time: 2.0888428688049316
Epoch: 2, Steps: 8 | Train Loss: 1.328 Vali Loss: 1.693 Vali Acc: 0.412 Test Loss: 1.693 Test Acc: 0.412
Validation loss decreased (-0.396930 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 2.054269313812256
Epoch: 3, Steps: 8 | Train Loss: 0.856 Vali Loss: 1.482 Vali Acc: 0.473 Test Loss: 1.482 Test Acc: 0.473
Validation loss decreased (-0.412197 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 2.0235960483551025
Epoch: 4, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.493 Vali Acc: 0.511 Test Loss: 1.493 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 1.9778351783752441
Epoch: 5, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.540 Vali Acc: 0.534 Test Loss: 1.540 Test Acc: 0.534
Validation loss decreased (-0.511435 --> -0.534336).  Saving model ...
Epoch: 6 cost time: 1.9601261615753174
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.022939920425415
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.651 Vali Acc: 0.527 Test Loss: 1.651 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1272573471069336
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.799 Vali Acc: 0.542 Test Loss: 1.799 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541967).  Saving model ...
Epoch: 9 cost time: 2.215761661529541
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.732 Vali Acc: 0.542 Test Loss: 1.732 Test Acc: 0.542
Validation loss decreased (-0.541967 --> -0.541967).  Saving model ...
Epoch: 10 cost time: 1.942063570022583
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.701 Vali Acc: 0.534 Test Loss: 1.701 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2049007415771484
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.731 Vali Acc: 0.542 Test Loss: 1.731 Test Acc: 0.542
Validation loss decreased (-0.541967 --> -0.541967).  Saving model ...
Epoch: 12 cost time: 2.12292218208313
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.767 Vali Acc: 0.534 Test Loss: 1.767 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0705552101135254
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.542 Test Loss: 1.821 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2350709438323975
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.842 Vali Acc: 0.542 Test Loss: 1.842 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.091705799102783
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.542 Test Loss: 1.833 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1205599308013916
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.534 Test Loss: 1.821 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.2087581157684326
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.550 Test Loss: 1.816 Test Acc: 0.550
Validation loss decreased (-0.541967 --> -0.549600).  Saving model ...
Epoch: 18 cost time: 2.0706915855407715
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.820 Vali Acc: 0.550 Test Loss: 1.820 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.895944356918335
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.550 Test Loss: 1.837 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9662115573883057
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.542 Test Loss: 1.846 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0607266426086426
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.542 Test Loss: 1.856 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.124309539794922
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.542 Test Loss: 1.857 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.87013578414917
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.542 Test Loss: 1.869 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1912293434143066
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.542 Test Loss: 1.869 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2407641410827637
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.542 Test Loss: 1.863 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1809418201446533
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.542 Test Loss: 1.867 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.13067364692688
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.542 Test Loss: 1.860 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 662661
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.126506805419922
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 2.025829315185547
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.592 Vali Acc: 0.427 Test Loss: 1.592 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.128854513168335
Epoch: 3, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.497 Vali Acc: 0.496 Test Loss: 1.497 Test Acc: 0.496
Validation loss decreased (-0.427465 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 2.060238838195801
Epoch: 4, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.414 Vali Acc: 0.489 Test Loss: 1.414 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0598630905151367
Epoch: 5, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.422 Vali Acc: 0.489 Test Loss: 1.422 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0302371978759766
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.5932552814483643
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6276276111602783
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 9 cost time: 2.0356252193450928
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.605 Vali Acc: 0.504 Test Loss: 1.605 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.865248203277588
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.639 Vali Acc: 0.504 Test Loss: 1.639 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7633349895477295
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.504 Test Loss: 1.651 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2116432189941406
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.504 Test Loss: 1.653 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0291523933410645
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.658 Vali Acc: 0.504 Test Loss: 1.658 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8225281238555908
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.678 Vali Acc: 0.511 Test Loss: 1.678 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1304070949554443
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.687 Vali Acc: 0.519 Test Loss: 1.687 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.038468360900879
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.678 Vali Acc: 0.511 Test Loss: 1.678 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0334956645965576
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.511 Test Loss: 1.695 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1357150077819824
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.511 Test Loss: 1.715 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 670213
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8631131649017334
Epoch: 1, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.582 Vali Acc: 0.336 Test Loss: 1.582 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 2.364764928817749
Epoch: 2, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.574 Vali Acc: 0.389 Test Loss: 1.574 Test Acc: 0.389
Validation loss decreased (-0.335862 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 2.0488595962524414
Epoch: 3, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.454 Vali Acc: 0.443 Test Loss: 1.454 Test Acc: 0.443
Validation loss decreased (-0.389297 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 2.1569032669067383
Epoch: 4, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.404 Vali Acc: 0.466 Test Loss: 1.404 Test Acc: 0.466
Validation loss decreased (-0.442734 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 2.2506117820739746
Epoch: 5, Steps: 8 | Train Loss: 0.305 Vali Loss: 1.387 Vali Acc: 0.481 Test Loss: 1.387 Test Acc: 0.481
Validation loss decreased (-0.465635 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 2.193941831588745
Epoch: 6, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.7696197032928467
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 2.1558403968811035
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.464 Vali Acc: 0.534 Test Loss: 1.464 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.7803621292114258
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7716991901397705
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2024431228637695
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.154127836227417
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.534 Test Loss: 1.539 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0648763179779053
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.557 Vali Acc: 0.534 Test Loss: 1.557 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2816221714019775
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.551 Vali Acc: 0.534 Test Loss: 1.551 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9395010471343994
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.558 Vali Acc: 0.534 Test Loss: 1.558 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1348366737365723
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.559 Vali Acc: 0.534 Test Loss: 1.559 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.2812092304229736
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.572 Vali Acc: 0.534 Test Loss: 1.572 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4549193382263184
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.534 Test Loss: 1.595 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 700933
model size : 11.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.2951507568359375
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.557 Vali Acc: 0.298 Test Loss: 1.557 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 2.1862335205078125
Epoch: 2, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.475 Vali Acc: 0.427 Test Loss: 1.475 Test Acc: 0.427
Validation loss decreased (-0.297694 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 2.1374897956848145
Epoch: 3, Steps: 8 | Train Loss: 0.893 Vali Loss: 1.427 Vali Acc: 0.489 Test Loss: 1.427 Test Acc: 0.489
Validation loss decreased (-0.427466 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.8823943138122559
Epoch: 4, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.9010541439056396
Epoch: 5, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.417 Vali Acc: 0.519 Test Loss: 1.417 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2360100746154785
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.495 Vali Acc: 0.519 Test Loss: 1.495 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2762160301208496
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.610 Vali Acc: 0.519 Test Loss: 1.610 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2880806922912598
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.622 Vali Acc: 0.504 Test Loss: 1.622 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7830402851104736
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.632 Vali Acc: 0.519 Test Loss: 1.632 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7843239307403564
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.653 Vali Acc: 0.519 Test Loss: 1.653 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8128225803375244
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.668 Vali Acc: 0.519 Test Loss: 1.668 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8761248588562012
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9574472904205322
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.698 Vali Acc: 0.511 Test Loss: 1.698 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7611100673675537
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.706 Vali Acc: 0.511 Test Loss: 1.706 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 792965
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1466128826141357
Epoch: 1, Steps: 8 | Train Loss: 1.815 Vali Loss: 1.720 Vali Acc: 0.168 Test Loss: 1.720 Test Acc: 0.168
Validation loss decreased (inf --> -0.167922).  Saving model ...
Epoch: 2 cost time: 1.2073183059692383
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.594 Vali Acc: 0.344 Test Loss: 1.594 Test Acc: 0.344
Validation loss decreased (-0.167922 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.1087210178375244
Epoch: 3, Steps: 8 | Train Loss: 0.926 Vali Loss: 1.524 Vali Acc: 0.443 Test Loss: 1.524 Test Acc: 0.443
Validation loss decreased (-0.343496 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.206974744796753
Epoch: 4, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
Validation loss decreased (-0.442733 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.1628153324127197
Epoch: 5, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1488773822784424
Epoch: 6, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.393 Vali Acc: 0.466 Test Loss: 1.393 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2661068439483643
Epoch: 7, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.424 Vali Acc: 0.466 Test Loss: 1.424 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.081935167312622
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.480 Vali Acc: 0.519 Test Loss: 1.480 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 9 cost time: 0.9951767921447754
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.522 Vali Acc: 0.519 Test Loss: 1.522 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0265047550201416
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1658604145050049
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.560 Vali Acc: 0.519 Test Loss: 1.560 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0580430030822754
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.566 Vali Acc: 0.519 Test Loss: 1.566 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0901281833648682
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.567 Vali Acc: 0.519 Test Loss: 1.567 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1388978958129883
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.573 Vali Acc: 0.519 Test Loss: 1.573 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2673156261444092
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.584 Vali Acc: 0.519 Test Loss: 1.584 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1359379291534424
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.595 Vali Acc: 0.504 Test Loss: 1.595 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1760358810424805
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.597 Vali Acc: 0.496 Test Loss: 1.597 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0480101108551025
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.496 Test Loss: 1.606 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 892677
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.038209915161133
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.627 Vali Acc: 0.275 Test Loss: 1.627 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.1477797031402588
Epoch: 2, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.595 Vali Acc: 0.374 Test Loss: 1.595 Test Acc: 0.374
Validation loss decreased (-0.274793 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.1789305210113525
Epoch: 3, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.562 Vali Acc: 0.427 Test Loss: 1.562 Test Acc: 0.427
Validation loss decreased (-0.374030 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.1395397186279297
Epoch: 4, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.535 Vali Acc: 0.466 Test Loss: 1.535 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.096369981765747
Epoch: 5, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.548 Vali Acc: 0.489 Test Loss: 1.548 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.0232360363006592
Epoch: 6, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1965956687927246
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.579 Vali Acc: 0.473 Test Loss: 1.579 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.158261775970459
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.615 Vali Acc: 0.489 Test Loss: 1.615 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0845048427581787
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.646 Vali Acc: 0.473 Test Loss: 1.646 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1107804775238037
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.671 Vali Acc: 0.473 Test Loss: 1.671 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0775346755981445
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.685 Vali Acc: 0.473 Test Loss: 1.685 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0672543048858643
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.702 Vali Acc: 0.473 Test Loss: 1.702 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1174142360687256
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.709 Vali Acc: 0.458 Test Loss: 1.709 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1086292266845703
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.719 Vali Acc: 0.458 Test Loss: 1.719 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1124467849731445
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.722 Vali Acc: 0.466 Test Loss: 1.722 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 1003909
model size : 12.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.705885171890259
Epoch: 1, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.721 Vali Acc: 0.420 Test Loss: 1.721 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.9002249240875244
Epoch: 2, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.517 Vali Acc: 0.336 Test Loss: 1.517 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.99534010887146
Epoch: 3, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.453 Vali Acc: 0.534 Test Loss: 1.453 Test Acc: 0.534
Validation loss decreased (-0.419830 --> -0.534337).  Saving model ...
Epoch: 4 cost time: 2.0942060947418213
Epoch: 4, Steps: 8 | Train Loss: 0.182 Vali Loss: 1.604 Vali Acc: 0.527 Test Loss: 1.604 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0427422523498535
Epoch: 5, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.699 Vali Acc: 0.504 Test Loss: 1.699 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.115896701812744
Epoch: 6, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.736 Vali Acc: 0.550 Test Loss: 1.736 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549601).  Saving model ...
Epoch: 7 cost time: 2.097805976867676
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.775 Vali Acc: 0.542 Test Loss: 1.775 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.165376901626587
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.942 Vali Acc: 0.542 Test Loss: 1.942 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0804567337036133
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.978 Vali Acc: 0.542 Test Loss: 1.978 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9571292400360107
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.527 Test Loss: 1.940 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1557388305664062
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.926 Vali Acc: 0.527 Test Loss: 1.926 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.140756845474243
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.527 Test Loss: 1.943 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1334068775177
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.527 Test Loss: 1.970 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0183653831481934
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.527 Test Loss: 1.975 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.197265863418579
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.527 Test Loss: 1.976 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1311185359954834
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.527 Test Loss: 1.969 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 659973
model size : 11.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9630539417266846
Epoch: 1, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.079056978225708
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.578 Vali Acc: 0.435 Test Loss: 1.578 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 2.2367775440216064
Epoch: 3, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.421 Vali Acc: 0.504 Test Loss: 1.421 Test Acc: 0.504
Validation loss decreased (-0.435099 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 2.386835813522339
Epoch: 4, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.411 Vali Acc: 0.519 Test Loss: 1.411 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 2.277672529220581
Epoch: 5, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3833389282226562
Epoch: 6, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 2.435323476791382
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.523 Vali Acc: 0.511 Test Loss: 1.523 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3569018840789795
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3650684356689453
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.807 Vali Acc: 0.534 Test Loss: 1.807 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534333).  Saving model ...
Epoch: 10 cost time: 2.5344088077545166
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.780 Vali Acc: 0.534 Test Loss: 1.780 Test Acc: 0.534
Validation loss decreased (-0.534333 --> -0.534333).  Saving model ...
Epoch: 11 cost time: 2.2501730918884277
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.519 Test Loss: 1.723 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2261271476745605
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.519 Test Loss: 1.721 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3264095783233643
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.519 Test Loss: 1.744 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.287022113800049
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.519 Test Loss: 1.750 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.251666307449341
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.519 Test Loss: 1.782 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2487144470214844
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.519 Test Loss: 1.779 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3506832122802734
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.519 Test Loss: 1.786 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3487770557403564
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.519 Test Loss: 1.792 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2183797359466553
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.519 Test Loss: 1.779 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.5185632705688477
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.519 Test Loss: 1.778 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 563973
model size : 10.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.721987724304199
Epoch: 1, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.3650901317596436
Epoch: 2, Steps: 8 | Train Loss: 1.335 Vali Loss: 1.669 Vali Acc: 0.420 Test Loss: 1.669 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4314756393432617
Epoch: 3, Steps: 8 | Train Loss: 0.909 Vali Loss: 1.497 Vali Acc: 0.504 Test Loss: 1.497 Test Acc: 0.504
Validation loss decreased (-0.419831 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 2.3784267902374268
Epoch: 4, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.445 Vali Acc: 0.542 Test Loss: 1.445 Test Acc: 0.542
Validation loss decreased (-0.503802 --> -0.541970).  Saving model ...
Epoch: 5 cost time: 2.2435781955718994
Epoch: 5, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.439 Vali Acc: 0.542 Test Loss: 1.439 Test Acc: 0.542
Validation loss decreased (-0.541970 --> -0.541970).  Saving model ...
Epoch: 6 cost time: 2.059913396835327
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.518 Vali Acc: 0.542 Test Loss: 1.518 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3266239166259766
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.162754535675049
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.638 Vali Acc: 0.542 Test Loss: 1.638 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.217588186264038
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.713 Vali Acc: 0.557 Test Loss: 1.713 Test Acc: 0.557
Validation loss decreased (-0.541970 --> -0.557235).  Saving model ...
Epoch: 10 cost time: 2.289242744445801
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.739 Vali Acc: 0.542 Test Loss: 1.739 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2386271953582764
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.550 Test Loss: 1.751 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1691360473632812
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.741 Vali Acc: 0.550 Test Loss: 1.741 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2802069187164307
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.747 Vali Acc: 0.542 Test Loss: 1.747 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2820136547088623
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.542 Test Loss: 1.762 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.309422492980957
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.765 Vali Acc: 0.542 Test Loss: 1.765 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2805533409118652
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.550 Test Loss: 1.789 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.233748197555542
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.550 Test Loss: 1.779 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1896255016326904
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.550 Test Loss: 1.774 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9924681186676025
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.550 Test Loss: 1.772 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 571525
model size : 10.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.918335437774658
Epoch: 1, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.560 Vali Acc: 0.374 Test Loss: 1.560 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 2.3544979095458984
Epoch: 2, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.534 Vali Acc: 0.435 Test Loss: 1.534 Test Acc: 0.435
Validation loss decreased (-0.374030 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 2.1948800086975098
Epoch: 3, Steps: 8 | Train Loss: 0.964 Vali Loss: 1.450 Vali Acc: 0.481 Test Loss: 1.450 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 2.333482265472412
Epoch: 4, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.400 Vali Acc: 0.496 Test Loss: 1.400 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 2.3635454177856445
Epoch: 5, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.380 Vali Acc: 0.534 Test Loss: 1.380 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 2.6801950931549072
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.418 Vali Acc: 0.534 Test Loss: 1.418 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5720958709716797
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.528 Vali Acc: 0.527 Test Loss: 1.528 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3233299255371094
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.502 Vali Acc: 0.542 Test Loss: 1.502 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 9 cost time: 2.658489465713501
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.544 Vali Acc: 0.542 Test Loss: 1.544 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.490694522857666
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.599 Vali Acc: 0.534 Test Loss: 1.599 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.820265293121338
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.618 Vali Acc: 0.534 Test Loss: 1.618 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0809402465820312
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.635 Vali Acc: 0.527 Test Loss: 1.635 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9472579956054688
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.649 Vali Acc: 0.534 Test Loss: 1.649 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.855482578277588
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.652 Vali Acc: 0.534 Test Loss: 1.652 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7943267822265625
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.534 Test Loss: 1.655 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9974496364593506
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.656 Vali Acc: 0.534 Test Loss: 1.656 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.964550733566284
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.534 Test Loss: 1.662 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.09995174407959
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.663 Vali Acc: 0.534 Test Loss: 1.663 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 602245
model size : 11.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.344829320907593
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.676 Vali Acc: 0.282 Test Loss: 1.676 Test Acc: 0.282
Validation loss decreased (inf --> -0.282426).  Saving model ...
Epoch: 2 cost time: 2.4772000312805176
Epoch: 2, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.628 Vali Acc: 0.420 Test Loss: 1.628 Test Acc: 0.420
Validation loss decreased (-0.282426 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 2.542900800704956
Epoch: 3, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.610 Vali Acc: 0.427 Test Loss: 1.610 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 2.5758867263793945
Epoch: 4, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 2.74550724029541
Epoch: 5, Steps: 8 | Train Loss: 0.296 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.50423002243042
Epoch: 6, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.560 Vali Acc: 0.489 Test Loss: 1.560 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 7 cost time: 2.623556613922119
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.612 Vali Acc: 0.504 Test Loss: 1.612 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 8 cost time: 2.668952226638794
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.610 Vali Acc: 0.511 Test Loss: 1.610 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511434).  Saving model ...
Epoch: 9 cost time: 2.7251498699188232
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.646 Vali Acc: 0.519 Test Loss: 1.646 Test Acc: 0.519
Validation loss decreased (-0.511434 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 2.6629672050476074
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.674 Vali Acc: 0.527 Test Loss: 1.674 Test Acc: 0.527
Validation loss decreased (-0.519068 --> -0.526701).  Saving model ...
Epoch: 11 cost time: 2.644834280014038
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.690 Vali Acc: 0.511 Test Loss: 1.690 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7847039699554443
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.704 Vali Acc: 0.504 Test Loss: 1.704 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.664139986038208
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.733 Vali Acc: 0.504 Test Loss: 1.733 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7385504245758057
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.749 Vali Acc: 0.504 Test Loss: 1.749 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.423246383666992
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.757 Vali Acc: 0.504 Test Loss: 1.757 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1725618839263916
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.768 Vali Acc: 0.504 Test Loss: 1.768 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2781331539154053
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.504 Test Loss: 1.773 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0721242427825928
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.783 Vali Acc: 0.504 Test Loss: 1.783 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1908936500549316
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.789 Vali Acc: 0.504 Test Loss: 1.789 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.278938055038452
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.792 Vali Acc: 0.504 Test Loss: 1.792 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 694277
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.395646095275879
Epoch: 1, Steps: 8 | Train Loss: 1.789 Vali Loss: 1.610 Vali Acc: 0.282 Test Loss: 1.610 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.4124610424041748
Epoch: 2, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.548 Vali Acc: 0.389 Test Loss: 1.548 Test Acc: 0.389
Validation loss decreased (-0.282427 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.5757761001586914
Epoch: 3, Steps: 8 | Train Loss: 0.955 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.5588667392730713
Epoch: 4, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.4700751304626465
Epoch: 5, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.413 Vali Acc: 0.473 Test Loss: 1.413 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5084762573242188
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.429 Vali Acc: 0.511 Test Loss: 1.429 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.5414454936981201
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.5815746784210205
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4442660808563232
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.514 Vali Acc: 0.542 Test Loss: 1.514 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541970).  Saving model ...
Epoch: 10 cost time: 1.5698015689849854
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.538 Vali Acc: 0.550 Test Loss: 1.538 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549603).  Saving model ...
Epoch: 11 cost time: 1.4887311458587646
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.561 Vali Acc: 0.534 Test Loss: 1.561 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5789849758148193
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.581 Vali Acc: 0.534 Test Loss: 1.581 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5325016975402832
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.587 Vali Acc: 0.534 Test Loss: 1.587 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.519463300704956
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4744579792022705
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.604 Vali Acc: 0.534 Test Loss: 1.604 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5787079334259033
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.610 Vali Acc: 0.534 Test Loss: 1.610 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3418006896972656
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.534 Test Loss: 1.621 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.488555908203125
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.534 Test Loss: 1.631 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.39670991897583
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.642 Vali Acc: 0.534 Test Loss: 1.642 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3689279556274414
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.645 Vali Acc: 0.534 Test Loss: 1.645 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 793989
model size : 11.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.396223545074463
Epoch: 1, Steps: 8 | Train Loss: 1.762 Vali Loss: 1.600 Vali Acc: 0.244 Test Loss: 1.600 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.4846704006195068
Epoch: 2, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.515 Vali Acc: 0.382 Test Loss: 1.515 Test Acc: 0.382
Validation loss decreased (-0.244259 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.446512222290039
Epoch: 3, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.455 Vali Acc: 0.435 Test Loss: 1.455 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.3804662227630615
Epoch: 4, Steps: 8 | Train Loss: 0.468 Vali Loss: 1.407 Vali Acc: 0.466 Test Loss: 1.407 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 1.4503633975982666
Epoch: 5, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.378 Vali Acc: 0.504 Test Loss: 1.378 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.5055065155029297
Epoch: 6, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.5406301021575928
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.434 Vali Acc: 0.527 Test Loss: 1.434 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.4727699756622314
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.453 Vali Acc: 0.527 Test Loss: 1.453 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4574053287506104
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.460 Vali Acc: 0.527 Test Loss: 1.460 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4611308574676514
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.467 Vali Acc: 0.527 Test Loss: 1.467 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4945142269134521
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.484 Vali Acc: 0.527 Test Loss: 1.484 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.539813756942749
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4556589126586914
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.515 Vali Acc: 0.511 Test Loss: 1.515 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4816935062408447
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.589871883392334
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4795868396759033
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.531 Vali Acc: 0.511 Test Loss: 1.531 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.416398525238037
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.511 Test Loss: 1.541 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 905221
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.249283790588379
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.774 Vali Acc: 0.420 Test Loss: 1.774 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 2.3799991607666016
Epoch: 2, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.619 Vali Acc: 0.221 Test Loss: 1.619 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4208314418792725
Epoch: 3, Steps: 8 | Train Loss: 0.546 Vali Loss: 1.582 Vali Acc: 0.489 Test Loss: 1.582 Test Acc: 0.489
Validation loss decreased (-0.419830 --> -0.488534).  Saving model ...
Epoch: 4 cost time: 2.208904504776001
Epoch: 4, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.188924551010132
Epoch: 5, Steps: 8 | Train Loss: 0.059 Vali Loss: 2.233 Vali Acc: 0.534 Test Loss: 2.233 Test Acc: 0.534
Validation loss decreased (-0.488534 --> -0.534329).  Saving model ...
Epoch: 6 cost time: 2.033297538757324
Epoch: 6, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.703 Vali Acc: 0.481 Test Loss: 1.703 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.255286455154419
Epoch: 7, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.396 Vali Acc: 0.519 Test Loss: 2.396 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1409192085266113
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.996 Vali Acc: 0.496 Test Loss: 1.996 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1663286685943604
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.006 Vali Acc: 0.481 Test Loss: 2.006 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.319729804992676
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.519 Test Loss: 2.152 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.366717576980591
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.262 Vali Acc: 0.511 Test Loss: 2.262 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2540860176086426
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.292 Vali Acc: 0.519 Test Loss: 2.292 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.288496732711792
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.527 Test Loss: 2.288 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.210859537124634
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.269 Vali Acc: 0.527 Test Loss: 2.269 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1851375102996826
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.527 Test Loss: 2.259 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 610629
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.16221809387207
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.613 Vali Acc: 0.412 Test Loss: 1.613 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 2.1811740398406982
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 2.2967453002929688
Epoch: 3, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.434 Vali Acc: 0.481 Test Loss: 1.434 Test Acc: 0.481
Validation loss decreased (-0.419831 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.8915760517120361
Epoch: 4, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.463 Vali Acc: 0.489 Test Loss: 1.463 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 2.0947818756103516
Epoch: 5, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.455 Vali Acc: 0.511 Test Loss: 1.455 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 2.23952054977417
Epoch: 6, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.714 Vali Acc: 0.534 Test Loss: 1.714 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534334).  Saving model ...
Epoch: 7 cost time: 2.180542469024658
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.628 Vali Acc: 0.534 Test Loss: 1.628 Test Acc: 0.534
Validation loss decreased (-0.534334 --> -0.534335).  Saving model ...
Epoch: 8 cost time: 2.29380464553833
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
Validation loss decreased (-0.534335 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 2.316441774368286
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.542 Test Loss: 1.748 Test Acc: 0.542
Validation loss decreased (-0.534335 --> -0.541967).  Saving model ...
Epoch: 10 cost time: 2.4723947048187256
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.550 Test Loss: 1.808 Test Acc: 0.550
Validation loss decreased (-0.541967 --> -0.549600).  Saving model ...
Epoch: 11 cost time: 2.3812429904937744
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.534 Test Loss: 1.853 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.45784854888916
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.814 Vali Acc: 0.557 Test Loss: 1.814 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557234).  Saving model ...
Epoch: 13 cost time: 2.3908040523529053
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.557 Test Loss: 1.802 Test Acc: 0.557
Validation loss decreased (-0.557234 --> -0.557234).  Saving model ...
Epoch: 14 cost time: 2.4191384315490723
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.557 Test Loss: 1.827 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4871349334716797
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.557 Test Loss: 1.847 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3926916122436523
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.557 Test Loss: 1.861 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.370159149169922
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.550 Test Loss: 1.867 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4012563228607178
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4263980388641357
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.550 Test Loss: 1.854 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.379573345184326
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.550 Test Loss: 1.868 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0298919677734375
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.550 Test Loss: 1.867 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1774590015411377
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.550 Test Loss: 1.869 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3105416297912598
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.542 Test Loss: 1.862 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 514629
model size : 10.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.907259225845337
Epoch: 1, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.567 Vali Acc: 0.382 Test Loss: 1.567 Test Acc: 0.382
Validation loss decreased (inf --> -0.381664).  Saving model ...
Epoch: 2 cost time: 2.2888951301574707
Epoch: 2, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.620 Vali Acc: 0.427 Test Loss: 1.620 Test Acc: 0.427
Validation loss decreased (-0.381664 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 2.331979990005493
Epoch: 3, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.480 Vali Acc: 0.466 Test Loss: 1.480 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 2.2550203800201416
Epoch: 4, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.437 Vali Acc: 0.519 Test Loss: 1.437 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 2.2094790935516357
Epoch: 5, Steps: 8 | Train Loss: 0.248 Vali Loss: 1.486 Vali Acc: 0.496 Test Loss: 1.486 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1930031776428223
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.517 Vali Acc: 0.511 Test Loss: 1.517 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.090045213699341
Epoch: 7, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.565 Vali Acc: 0.504 Test Loss: 1.565 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.359184980392456
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.768 Vali Acc: 0.511 Test Loss: 1.768 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0957534313201904
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.812 Vali Acc: 0.511 Test Loss: 1.812 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.051837682723999
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.744 Vali Acc: 0.519 Test Loss: 1.744 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2667477130889893
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.732 Vali Acc: 0.511 Test Loss: 1.732 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.175196409225464
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.511 Test Loss: 1.751 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.174102306365967
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.788 Vali Acc: 0.519 Test Loss: 1.788 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3134634494781494
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.496 Test Loss: 1.801 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 522181
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.348868131637573
Epoch: 1, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.525 Vali Acc: 0.382 Test Loss: 1.525 Test Acc: 0.382
Validation loss decreased (inf --> -0.381664).  Saving model ...
Epoch: 2 cost time: 2.4362781047821045
Epoch: 2, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.522 Vali Acc: 0.435 Test Loss: 1.522 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 2.497896909713745
Epoch: 3, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.465 Vali Acc: 0.481 Test Loss: 1.465 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 2.458972930908203
Epoch: 4, Steps: 8 | Train Loss: 0.542 Vali Loss: 1.388 Vali Acc: 0.489 Test Loss: 1.388 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 2.3398029804229736
Epoch: 5, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.390 Vali Acc: 0.511 Test Loss: 1.390 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 2.3637824058532715
Epoch: 6, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.506 Vali Acc: 0.519 Test Loss: 1.506 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 2.3555572032928467
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3852617740631104
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.460 Vali Acc: 0.534 Test Loss: 1.460 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 2.3078763484954834
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.533 Vali Acc: 0.534 Test Loss: 1.533 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.481914758682251
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.587 Vali Acc: 0.534 Test Loss: 1.587 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5774357318878174
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.589 Vali Acc: 0.534 Test Loss: 1.589 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4451797008514404
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.594 Vali Acc: 0.534 Test Loss: 1.594 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.300690174102783
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.534 Test Loss: 1.600 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3522684574127197
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.534 Test Loss: 1.606 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.220999002456665
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.613 Vali Acc: 0.534 Test Loss: 1.613 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0840227603912354
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.623 Vali Acc: 0.534 Test Loss: 1.623 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4225637912750244
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.534 Test Loss: 1.638 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.278583526611328
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.534 Test Loss: 1.656 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 552901
model size : 10.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.999835968017578
Epoch: 1, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.570 Vali Acc: 0.336 Test Loss: 1.570 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 2.197138786315918
Epoch: 2, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.540 Vali Acc: 0.412 Test Loss: 1.540 Test Acc: 0.412
Validation loss decreased (-0.335862 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 2.2044336795806885
Epoch: 3, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.527 Vali Acc: 0.435 Test Loss: 1.527 Test Acc: 0.435
Validation loss decreased (-0.412198 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 2.263498067855835
Epoch: 4, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.449 Vali Acc: 0.481 Test Loss: 1.449 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 2.4137465953826904
Epoch: 5, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.396 Vali Acc: 0.473 Test Loss: 1.396 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4518983364105225
Epoch: 6, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.442 Vali Acc: 0.519 Test Loss: 1.442 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 2.329044818878174
Epoch: 7, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3654088973999023
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.524 Vali Acc: 0.519 Test Loss: 1.524 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1959710121154785
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.587 Vali Acc: 0.519 Test Loss: 1.587 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.960681676864624
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.638 Vali Acc: 0.519 Test Loss: 1.638 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.151668071746826
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.644 Vali Acc: 0.527 Test Loss: 1.644 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526701).  Saving model ...
Epoch: 12 cost time: 2.171394109725952
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.657 Vali Acc: 0.511 Test Loss: 1.657 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.07513165473938
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.667 Vali Acc: 0.511 Test Loss: 1.667 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1421093940734863
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.680 Vali Acc: 0.511 Test Loss: 1.680 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.003560781478882
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.688 Vali Acc: 0.511 Test Loss: 1.688 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.071108818054199
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.703 Vali Acc: 0.504 Test Loss: 1.703 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.242467164993286
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.714 Vali Acc: 0.504 Test Loss: 1.714 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4220242500305176
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.519 Test Loss: 1.716 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5185539722442627
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.519 Test Loss: 1.716 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5716543197631836
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.716 Vali Acc: 0.511 Test Loss: 1.716 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.706530809402466
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.511 Test Loss: 1.724 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 644933
model size : 11.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2048182487487793
Epoch: 1, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.649 Vali Acc: 0.344 Test Loss: 1.649 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 1.21760892868042
Epoch: 2, Steps: 8 | Train Loss: 1.352 Vali Loss: 1.600 Vali Acc: 0.397 Test Loss: 1.600 Test Acc: 0.397
Validation loss decreased (-0.343495 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.3061048984527588
Epoch: 3, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.559 Vali Acc: 0.427 Test Loss: 1.559 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.2015845775604248
Epoch: 4, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.473 Vali Acc: 0.496 Test Loss: 1.473 Test Acc: 0.496
Validation loss decreased (-0.427465 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.4240365028381348
Epoch: 5, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6853947639465332
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.494 Vali Acc: 0.496 Test Loss: 1.494 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6234207153320312
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 1.5505914688110352
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7578682899475098
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.587 Vali Acc: 0.511 Test Loss: 1.587 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5808513164520264
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.596 Vali Acc: 0.504 Test Loss: 1.596 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6781420707702637
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.606 Vali Acc: 0.511 Test Loss: 1.606 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5572149753570557
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.610 Vali Acc: 0.511 Test Loss: 1.610 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6613497734069824
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.620 Vali Acc: 0.511 Test Loss: 1.620 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5638327598571777
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.636 Vali Acc: 0.511 Test Loss: 1.636 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6480822563171387
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.651 Vali Acc: 0.511 Test Loss: 1.651 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6559228897094727
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.660 Vali Acc: 0.519 Test Loss: 1.660 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7402408123016357
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.668 Vali Acc: 0.511 Test Loss: 1.668 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 744645
model size : 11.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9970483779907227
Epoch: 1, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.650 Vali Acc: 0.252 Test Loss: 1.650 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.299471139907837
Epoch: 2, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.600 Vali Acc: 0.321 Test Loss: 1.600 Test Acc: 0.321
Validation loss decreased (-0.251892 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.2149806022644043
Epoch: 3, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.576 Vali Acc: 0.443 Test Loss: 1.576 Test Acc: 0.443
Validation loss decreased (-0.320595 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 1.1862328052520752
Epoch: 4, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
Validation loss decreased (-0.442732 --> -0.480900).  Saving model ...
Epoch: 5 cost time: 1.384368896484375
Epoch: 5, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.595 Vali Acc: 0.466 Test Loss: 1.595 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3776342868804932
Epoch: 6, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.586 Vali Acc: 0.466 Test Loss: 1.586 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2755837440490723
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3795742988586426
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.667 Vali Acc: 0.466 Test Loss: 1.667 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.366363286972046
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.691 Vali Acc: 0.466 Test Loss: 1.691 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3732175827026367
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.709 Vali Acc: 0.473 Test Loss: 1.709 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.301271677017212
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.737 Vali Acc: 0.473 Test Loss: 1.737 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4348564147949219
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.743 Vali Acc: 0.473 Test Loss: 1.743 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4030568599700928
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.754 Vali Acc: 0.489 Test Loss: 1.754 Test Acc: 0.489
Validation loss decreased (-0.480900 --> -0.488532).  Saving model ...
Epoch: 14 cost time: 1.5189614295959473
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.760 Vali Acc: 0.489 Test Loss: 1.760 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4592201709747314
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.764 Vali Acc: 0.489 Test Loss: 1.764 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2603797912597656
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.783 Vali Acc: 0.481 Test Loss: 1.783 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5640158653259277
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.792 Vali Acc: 0.481 Test Loss: 1.792 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5611233711242676
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.794 Vali Acc: 0.481 Test Loss: 1.794 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2790958881378174
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.802 Vali Acc: 0.481 Test Loss: 1.802 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3606369495391846
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.815 Vali Acc: 0.489 Test Loss: 1.815 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4320259094238281
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.489 Test Loss: 1.822 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3748795986175537
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.829 Vali Acc: 0.489 Test Loss: 1.829 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4763543605804443
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.837 Vali Acc: 0.481 Test Loss: 1.837 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm128_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 855877
model size : 12.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6430835723876953
Epoch: 1, Steps: 8 | Train Loss: 1.770 Vali Loss: 1.535 Vali Acc: 0.412 Test Loss: 1.535 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 2.121779441833496
Epoch: 2, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.507 Vali Acc: 0.443 Test Loss: 1.507 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 2.0236289501190186
Epoch: 3, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.418 Vali Acc: 0.466 Test Loss: 1.418 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.9529376029968262
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.305 Vali Acc: 0.504 Test Loss: 1.305 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503804).  Saving model ...
Epoch: 5 cost time: 1.8273661136627197
Epoch: 5, Steps: 8 | Train Loss: 0.308 Vali Loss: 1.358 Vali Acc: 0.557 Test Loss: 1.358 Test Acc: 0.557
Validation loss decreased (-0.503804 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 2.0590384006500244
Epoch: 6, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.360 Vali Acc: 0.542 Test Loss: 1.360 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8124895095825195
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.298 Vali Acc: 0.527 Test Loss: 1.298 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.77586030960083
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.533 Vali Acc: 0.550 Test Loss: 1.533 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7816720008850098
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.650 Vali Acc: 0.550 Test Loss: 1.650 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.89556884765625
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0749785900115967
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1183273792266846
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.576 Vali Acc: 0.527 Test Loss: 1.576 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8796770572662354
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.542 Test Loss: 1.630 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9011797904968262
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.542 Test Loss: 1.651 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.157287120819092
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.534 Test Loss: 1.617 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 330565
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.05384087562561
Epoch: 1, Steps: 8 | Train Loss: 1.750 Vali Loss: 1.622 Vali Acc: 0.267 Test Loss: 1.622 Test Acc: 0.267
Validation loss decreased (inf --> -0.267159).  Saving model ...
Epoch: 2 cost time: 2.217503309249878
Epoch: 2, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.656 Vali Acc: 0.405 Test Loss: 1.656 Test Acc: 0.405
Validation loss decreased (-0.267159 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 2.2755141258239746
Epoch: 3, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.499 Vali Acc: 0.397 Test Loss: 1.499 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3128294944763184
Epoch: 4, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.454 Vali Acc: 0.412 Test Loss: 1.454 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 2.177548885345459
Epoch: 5, Steps: 8 | Train Loss: 0.480 Vali Loss: 1.447 Vali Acc: 0.489 Test Loss: 1.447 Test Acc: 0.489
Validation loss decreased (-0.412199 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 2.465191125869751
Epoch: 6, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.396 Vali Acc: 0.458 Test Loss: 1.396 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.285053253173828
Epoch: 7, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.438 Vali Acc: 0.511 Test Loss: 1.438 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 2.2140283584594727
Epoch: 8, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.369 Vali Acc: 0.489 Test Loss: 1.369 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.215919017791748
Epoch: 9, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.390 Vali Acc: 0.450 Test Loss: 1.390 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3091001510620117
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.494 Vali Acc: 0.504 Test Loss: 1.494 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3053112030029297
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.540 Vali Acc: 0.504 Test Loss: 1.540 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.123035430908203
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.532 Vali Acc: 0.504 Test Loss: 1.532 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.058248519897461
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.495 Vali Acc: 0.481 Test Loss: 1.495 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.28584623336792
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.507 Vali Acc: 0.481 Test Loss: 1.507 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3341541290283203
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.522 Vali Acc: 0.489 Test Loss: 1.522 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3278861045837402
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.541 Vali Acc: 0.496 Test Loss: 1.541 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1324703693389893
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 282565
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.04274582862854
Epoch: 1, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.590 Vali Acc: 0.282 Test Loss: 1.590 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 2.354860782623291
Epoch: 2, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.589 Vali Acc: 0.412 Test Loss: 1.589 Test Acc: 0.412
Validation loss decreased (-0.282427 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 2.385995864868164
Epoch: 3, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.561 Vali Acc: 0.443 Test Loss: 1.561 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 2.3138368129730225
Epoch: 4, Steps: 8 | Train Loss: 0.887 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
Validation loss decreased (-0.442732 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 2.1976044178009033
Epoch: 5, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.478 Vali Acc: 0.481 Test Loss: 1.478 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 2.089461326599121
Epoch: 6, Steps: 8 | Train Loss: 0.407 Vali Loss: 1.494 Vali Acc: 0.481 Test Loss: 1.494 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.343369245529175
Epoch: 7, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.462 Vali Acc: 0.496 Test Loss: 1.462 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 2.454472064971924
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.534 Vali Acc: 0.504 Test Loss: 1.534 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503801).  Saving model ...
Epoch: 9 cost time: 2.3603038787841797
Epoch: 9, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.509 Vali Acc: 0.542 Test Loss: 1.509 Test Acc: 0.542
Validation loss decreased (-0.503801 --> -0.541970).  Saving model ...
Epoch: 10 cost time: 2.1526782512664795
Epoch: 10, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.589 Vali Acc: 0.511 Test Loss: 1.589 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2429440021514893
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.629 Vali Acc: 0.519 Test Loss: 1.629 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3564603328704834
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.320371389389038
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.659 Vali Acc: 0.519 Test Loss: 1.659 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.311093330383301
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.681 Vali Acc: 0.519 Test Loss: 1.681 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.128544807434082
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.678 Vali Acc: 0.527 Test Loss: 1.678 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0210580825805664
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1972007751464844
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3680522441864014
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.685 Vali Acc: 0.527 Test Loss: 1.685 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2537841796875
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.691 Vali Acc: 0.527 Test Loss: 1.691 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 286341
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.185556411743164
Epoch: 1, Steps: 8 | Train Loss: 1.741 Vali Loss: 1.708 Vali Acc: 0.198 Test Loss: 1.708 Test Acc: 0.198
Validation loss decreased (inf --> -0.198456).  Saving model ...
Epoch: 2 cost time: 1.2922282218933105
Epoch: 2, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.613 Vali Acc: 0.405 Test Loss: 1.613 Test Acc: 0.405
Validation loss decreased (-0.198456 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.3181354999542236
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.4530589580535889
Epoch: 4, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.495 Vali Acc: 0.466 Test Loss: 1.495 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.2693772315979004
Epoch: 5, Steps: 8 | Train Loss: 0.660 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.2103803157806396
Epoch: 6, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.399 Vali Acc: 0.496 Test Loss: 1.399 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.3292920589447021
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.376 Vali Acc: 0.527 Test Loss: 1.376 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 8 cost time: 1.4102342128753662
Epoch: 8, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.394 Vali Acc: 0.534 Test Loss: 1.394 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.2480480670928955
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4798688888549805
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.418 Vali Acc: 0.519 Test Loss: 1.418 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.341750144958496
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.422 Vali Acc: 0.519 Test Loss: 1.422 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.529325008392334
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4413764476776123
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4515135288238525
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.470 Vali Acc: 0.527 Test Loss: 1.470 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3597583770751953
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2826404571533203
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2797632217407227
Epoch: 17, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.471 Vali Acc: 0.519 Test Loss: 1.471 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2448227405548096
Epoch: 18, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 301701
model size : 5.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8630623817443848
Epoch: 1, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.606 Vali Acc: 0.336 Test Loss: 1.606 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.2457258701324463
Epoch: 2, Steps: 8 | Train Loss: 1.496 Vali Loss: 1.569 Vali Acc: 0.366 Test Loss: 1.569 Test Acc: 0.366
Validation loss decreased (-0.335862 --> -0.366397).  Saving model ...
Epoch: 3 cost time: 1.26289963722229
Epoch: 3, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.555 Vali Acc: 0.412 Test Loss: 1.555 Test Acc: 0.412
Validation loss decreased (-0.366397 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.2095451354980469
Epoch: 4, Steps: 8 | Train Loss: 0.949 Vali Loss: 1.525 Vali Acc: 0.450 Test Loss: 1.525 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.3391432762145996
Epoch: 5, Steps: 8 | Train Loss: 0.603 Vali Loss: 1.461 Vali Acc: 0.466 Test Loss: 1.461 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.2502148151397705
Epoch: 6, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.442 Vali Acc: 0.458 Test Loss: 1.442 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2614727020263672
Epoch: 7, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.474 Vali Acc: 0.481 Test Loss: 1.474 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.2296924591064453
Epoch: 8, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 1.188352346420288
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.482 Vali Acc: 0.481 Test Loss: 1.482 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1466171741485596
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1964986324310303
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1733567714691162
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.538 Vali Acc: 0.481 Test Loss: 1.538 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2359178066253662
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.555 Vali Acc: 0.489 Test Loss: 1.555 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4019992351531982
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2868688106536865
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.568 Vali Acc: 0.489 Test Loss: 1.568 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2425134181976318
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.575 Vali Acc: 0.489 Test Loss: 1.575 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.291858434677124
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.579 Vali Acc: 0.481 Test Loss: 1.579 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3736073970794678
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.587 Vali Acc: 0.481 Test Loss: 1.587 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 347717
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1436281204223633
Epoch: 1, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.691 Vali Acc: 0.237 Test Loss: 1.691 Test Acc: 0.237
Validation loss decreased (inf --> -0.236624).  Saving model ...
Epoch: 2 cost time: 1.2487425804138184
Epoch: 2, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.585 Vali Acc: 0.351 Test Loss: 1.585 Test Acc: 0.351
Validation loss decreased (-0.236624 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.1841850280761719
Epoch: 3, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
Validation loss decreased (-0.351129 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3677985668182373
Epoch: 4, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.462 Vali Acc: 0.458 Test Loss: 1.462 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.2266757488250732
Epoch: 5, Steps: 8 | Train Loss: 0.512 Vali Loss: 1.412 Vali Acc: 0.466 Test Loss: 1.412 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 1.2539944648742676
Epoch: 6, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.384 Vali Acc: 0.481 Test Loss: 1.384 Test Acc: 0.481
Validation loss decreased (-0.465635 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.2973995208740234
Epoch: 7, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.367 Vali Acc: 0.458 Test Loss: 1.367 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1892666816711426
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.369 Vali Acc: 0.481 Test Loss: 1.369 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.169553279876709
Epoch: 9, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.381 Vali Acc: 0.466 Test Loss: 1.381 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1410386562347412
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.399 Vali Acc: 0.466 Test Loss: 1.399 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1089494228363037
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.415 Vali Acc: 0.473 Test Loss: 1.415 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1935408115386963
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.436 Vali Acc: 0.473 Test Loss: 1.436 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3570117950439453
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.455 Vali Acc: 0.481 Test Loss: 1.455 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2796587944030762
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.468 Vali Acc: 0.481 Test Loss: 1.468 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2388300895690918
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.479 Vali Acc: 0.473 Test Loss: 1.479 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2604129314422607
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.487 Vali Acc: 0.481 Test Loss: 1.487 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2309520244598389
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.495 Vali Acc: 0.473 Test Loss: 1.495 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1121017932891846
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 397573
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.93658709526062
Epoch: 1, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.785 Vali Acc: 0.145 Test Loss: 1.785 Test Acc: 0.145
Validation loss decreased (inf --> -0.145020).  Saving model ...
Epoch: 2 cost time: 1.1640450954437256
Epoch: 2, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.679 Vali Acc: 0.244 Test Loss: 1.679 Test Acc: 0.244
Validation loss decreased (-0.145020 --> -0.244258).  Saving model ...
Epoch: 3 cost time: 1.2507927417755127
Epoch: 3, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.571 Vali Acc: 0.374 Test Loss: 1.571 Test Acc: 0.374
Validation loss decreased (-0.244258 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.2360351085662842
Epoch: 4, Steps: 8 | Train Loss: 0.737 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.374030 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.267378568649292
Epoch: 5, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.494 Vali Acc: 0.427 Test Loss: 1.494 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.3059723377227783
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.359976053237915
Epoch: 7, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.524 Vali Acc: 0.435 Test Loss: 1.524 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 8 cost time: 1.2496223449707031
Epoch: 8, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.548 Vali Acc: 0.466 Test Loss: 1.548 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465633).  Saving model ...
Epoch: 9 cost time: 1.3011727333068848
Epoch: 9, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.552 Vali Acc: 0.466 Test Loss: 1.552 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3947255611419678
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.561 Vali Acc: 0.473 Test Loss: 1.561 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473267).  Saving model ...
Epoch: 11 cost time: 1.373551845550537
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.572 Vali Acc: 0.450 Test Loss: 1.572 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3027231693267822
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.581 Vali Acc: 0.458 Test Loss: 1.581 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3519268035888672
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.606 Vali Acc: 0.466 Test Loss: 1.606 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.354264497756958
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.627 Vali Acc: 0.473 Test Loss: 1.627 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2450194358825684
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.649 Vali Acc: 0.458 Test Loss: 1.649 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.23624849319458
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.662 Vali Acc: 0.466 Test Loss: 1.662 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2178211212158203
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.667 Vali Acc: 0.466 Test Loss: 1.667 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4872703552246094
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.668 Vali Acc: 0.466 Test Loss: 1.668 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.351511001586914
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.675 Vali Acc: 0.473 Test Loss: 1.675 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2477202415466309
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.473 Test Loss: 1.687 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 453189
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.472083806991577
Epoch: 1, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.661 Vali Acc: 0.389 Test Loss: 1.661 Test Acc: 0.389
Validation loss decreased (inf --> -0.389296).  Saving model ...
Epoch: 2 cost time: 1.5343201160430908
Epoch: 2, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.608 Vali Acc: 0.397 Test Loss: 1.608 Test Acc: 0.397
Validation loss decreased (-0.389296 --> -0.396930).  Saving model ...
Epoch: 3 cost time: 1.676640510559082
Epoch: 3, Steps: 8 | Train Loss: 0.926 Vali Loss: 1.504 Vali Acc: 0.397 Test Loss: 1.504 Test Acc: 0.397
Validation loss decreased (-0.396930 --> -0.396932).  Saving model ...
Epoch: 4 cost time: 1.6521632671356201
Epoch: 4, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.509 Vali Acc: 0.496 Test Loss: 1.509 Test Acc: 0.496
Validation loss decreased (-0.396932 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.555539846420288
Epoch: 5, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.580 Vali Acc: 0.504 Test Loss: 1.580 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.5847129821777344
Epoch: 6, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.496 Vali Acc: 0.427 Test Loss: 1.496 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6193089485168457
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.893 Vali Acc: 0.519 Test Loss: 1.893 Test Acc: 0.519
Validation loss decreased (-0.503801 --> -0.519065).  Saving model ...
Epoch: 8 cost time: 1.6106679439544678
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.784 Vali Acc: 0.511 Test Loss: 1.784 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.697148084640503
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.684 Vali Acc: 0.504 Test Loss: 1.684 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6484558582305908
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.861 Vali Acc: 0.519 Test Loss: 1.861 Test Acc: 0.519
Validation loss decreased (-0.519065 --> -0.519065).  Saving model ...
Epoch: 11 cost time: 1.5582854747772217
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.981 Vali Acc: 0.519 Test Loss: 1.981 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5790743827819824
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.943 Vali Acc: 0.519 Test Loss: 1.943 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6178314685821533
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.519 Test Loss: 1.861 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5887839794158936
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.519 Test Loss: 1.831 Test Acc: 0.519
Validation loss decreased (-0.519065 --> -0.519066).  Saving model ...
Epoch: 15 cost time: 1.5996572971343994
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.519 Test Loss: 1.854 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5778021812438965
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.519 Test Loss: 1.875 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6464412212371826
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.519 Test Loss: 1.893 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5869877338409424
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.904 Vali Acc: 0.519 Test Loss: 1.904 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5920336246490479
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.519 Test Loss: 1.915 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5315523147583008
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.906 Vali Acc: 0.519 Test Loss: 1.906 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5486540794372559
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.913 Vali Acc: 0.519 Test Loss: 1.913 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7201836109161377
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.519 Test Loss: 1.914 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6932470798492432
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.927 Vali Acc: 0.519 Test Loss: 1.927 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.674306869506836
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.519 Test Loss: 1.931 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 281029
model size : 5.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5983171463012695
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.587 Vali Acc: 0.405 Test Loss: 1.587 Test Acc: 0.405
Validation loss decreased (inf --> -0.404564).  Saving model ...
Epoch: 2 cost time: 1.7477900981903076
Epoch: 2, Steps: 8 | Train Loss: 1.436 Vali Loss: 1.645 Vali Acc: 0.405 Test Loss: 1.645 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1196224689483643
Epoch: 3, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.547 Vali Acc: 0.443 Test Loss: 1.547 Test Acc: 0.443
Validation loss decreased (-0.404564 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.8198521137237549
Epoch: 4, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.468 Vali Acc: 0.458 Test Loss: 1.468 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.75557279586792
Epoch: 5, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.445 Vali Acc: 0.496 Test Loss: 1.445 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.7831599712371826
Epoch: 6, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.696850299835205
Epoch: 7, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 2.0574722290039062
Epoch: 8, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.446 Vali Acc: 0.511 Test Loss: 1.446 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2475478649139404
Epoch: 9, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.599 Vali Acc: 0.504 Test Loss: 1.599 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1377551555633545
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.612 Vali Acc: 0.504 Test Loss: 1.612 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2000010013580322
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.574 Vali Acc: 0.511 Test Loss: 1.574 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2533891201019287
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.598 Vali Acc: 0.519 Test Loss: 1.598 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.037440776824951
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.645 Vali Acc: 0.519 Test Loss: 1.645 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0750598907470703
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.682 Vali Acc: 0.519 Test Loss: 1.682 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.096284866333008
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.534 Test Loss: 1.675 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534334).  Saving model ...
Epoch: 16 cost time: 2.1211929321289062
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.534 Test Loss: 1.669 Test Acc: 0.534
Validation loss decreased (-0.534334 --> -0.534334).  Saving model ...
Epoch: 17 cost time: 2.166353464126587
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.667 Vali Acc: 0.534 Test Loss: 1.667 Test Acc: 0.534
Validation loss decreased (-0.534334 --> -0.534334).  Saving model ...
Epoch: 18 cost time: 2.306464672088623
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.676 Vali Acc: 0.534 Test Loss: 1.676 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.006880521774292
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.681 Vali Acc: 0.534 Test Loss: 1.681 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.03218412399292
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.696 Vali Acc: 0.534 Test Loss: 1.696 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9362719058990479
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.534 Test Loss: 1.706 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.115351438522339
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.711 Vali Acc: 0.534 Test Loss: 1.711 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.257187604904175
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.534 Test Loss: 1.706 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.194425106048584
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.534 Test Loss: 1.719 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3703553676605225
Epoch: 25, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.734 Vali Acc: 0.534 Test Loss: 1.734 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0376553535461426
Epoch: 26, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.751 Vali Acc: 0.534 Test Loss: 1.751 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2882773876190186
Epoch: 27, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.534 Test Loss: 1.754 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 233029
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.103779077529907
Epoch: 1, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.603 Vali Acc: 0.412 Test Loss: 1.603 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 2.229771137237549
Epoch: 2, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.644 Vali Acc: 0.435 Test Loss: 1.644 Test Acc: 0.435
Validation loss decreased (-0.412198 --> -0.435098).  Saving model ...
Epoch: 3 cost time: 2.0758588314056396
Epoch: 3, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.581 Vali Acc: 0.458 Test Loss: 1.581 Test Acc: 0.458
Validation loss decreased (-0.435098 --> -0.457999).  Saving model ...
Epoch: 4 cost time: 2.210963487625122
Epoch: 4, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.481 Vali Acc: 0.443 Test Loss: 1.481 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.066453218460083
Epoch: 5, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.431 Vali Acc: 0.534 Test Loss: 1.431 Test Acc: 0.534
Validation loss decreased (-0.457999 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 2.0890796184539795
Epoch: 6, Steps: 8 | Train Loss: 0.387 Vali Loss: 1.411 Vali Acc: 0.534 Test Loss: 1.411 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 2.3251891136169434
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.395 Vali Acc: 0.534 Test Loss: 1.395 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 2.096120595932007
Epoch: 8, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2082505226135254
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.487 Vali Acc: 0.550 Test Loss: 1.487 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549603).  Saving model ...
Epoch: 10 cost time: 2.120276689529419
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.517 Vali Acc: 0.542 Test Loss: 1.517 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1044230461120605
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.248081684112549
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.612 Vali Acc: 0.534 Test Loss: 1.612 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.053046703338623
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.646 Vali Acc: 0.534 Test Loss: 1.646 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1317532062530518
Epoch: 14, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.114558458328247
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.634 Vali Acc: 0.527 Test Loss: 1.634 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0322327613830566
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.641 Vali Acc: 0.527 Test Loss: 1.641 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1597468852996826
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.654 Vali Acc: 0.519 Test Loss: 1.654 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1521241664886475
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.674 Vali Acc: 0.527 Test Loss: 1.674 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.073152780532837
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.674 Vali Acc: 0.527 Test Loss: 1.674 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 236805
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3625872135162354
Epoch: 1, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.674 Vali Acc: 0.214 Test Loss: 1.674 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.6035218238830566
Epoch: 2, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.558 Vali Acc: 0.389 Test Loss: 1.558 Test Acc: 0.389
Validation loss decreased (-0.213724 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.5252480506896973
Epoch: 3, Steps: 8 | Train Loss: 1.180 Vali Loss: 1.535 Vali Acc: 0.443 Test Loss: 1.535 Test Acc: 0.443
Validation loss decreased (-0.389297 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.4685821533203125
Epoch: 4, Steps: 8 | Train Loss: 0.923 Vali Loss: 1.485 Vali Acc: 0.443 Test Loss: 1.485 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.5648462772369385
Epoch: 5, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.430 Vali Acc: 0.458 Test Loss: 1.430 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.4190690517425537
Epoch: 6, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.3842110633850098
Epoch: 7, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.413 Vali Acc: 0.496 Test Loss: 1.413 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.3604662418365479
Epoch: 8, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.401 Vali Acc: 0.489 Test Loss: 1.401 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.324725866317749
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.452 Vali Acc: 0.489 Test Loss: 1.452 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4551451206207275
Epoch: 10, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.489 Vali Acc: 0.496 Test Loss: 1.489 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.403587818145752
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.480 Vali Acc: 0.511 Test Loss: 1.480 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.397207498550415
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.346200942993164
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.367039442062378
Epoch: 14, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.537 Vali Acc: 0.511 Test Loss: 1.537 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2513022422790527
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.550 Vali Acc: 0.511 Test Loss: 1.550 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3882133960723877
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.562 Vali Acc: 0.511 Test Loss: 1.562 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5282130241394043
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.567 Vali Acc: 0.511 Test Loss: 1.567 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3863060474395752
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.573 Vali Acc: 0.511 Test Loss: 1.573 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3268651962280273
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5309467315673828
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.390416145324707
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.580 Vali Acc: 0.511 Test Loss: 1.580 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 252165
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9861373901367188
Epoch: 1, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.585 Vali Acc: 0.229 Test Loss: 1.585 Test Acc: 0.229
Validation loss decreased (inf --> -0.228992).  Saving model ...
Epoch: 2 cost time: 1.3281991481781006
Epoch: 2, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.517 Vali Acc: 0.359 Test Loss: 1.517 Test Acc: 0.359
Validation loss decreased (-0.228992 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 1.2259128093719482
Epoch: 3, Steps: 8 | Train Loss: 1.162 Vali Loss: 1.499 Vali Acc: 0.412 Test Loss: 1.499 Test Acc: 0.412
Validation loss decreased (-0.358763 --> -0.412199).  Saving model ...
Epoch: 4 cost time: 1.283907413482666
Epoch: 4, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.478 Vali Acc: 0.443 Test Loss: 1.478 Test Acc: 0.443
Validation loss decreased (-0.412199 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.27769136428833
Epoch: 5, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.462 Vali Acc: 0.450 Test Loss: 1.462 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.184363603591919
Epoch: 6, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.464 Vali Acc: 0.450 Test Loss: 1.464 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2247331142425537
Epoch: 7, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.440 Vali Acc: 0.527 Test Loss: 1.440 Test Acc: 0.527
Validation loss decreased (-0.450367 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.2169947624206543
Epoch: 8, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.443 Vali Acc: 0.519 Test Loss: 1.443 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2652482986450195
Epoch: 9, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1965491771697998
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.451 Vali Acc: 0.496 Test Loss: 1.451 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3280906677246094
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.464 Vali Acc: 0.504 Test Loss: 1.464 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.306204080581665
Epoch: 12, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.500 Vali Acc: 0.504 Test Loss: 1.500 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2283735275268555
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.523 Vali Acc: 0.511 Test Loss: 1.523 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2983884811401367
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.527 Vali Acc: 0.511 Test Loss: 1.527 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2031612396240234
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.534 Vali Acc: 0.511 Test Loss: 1.534 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2628796100616455
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2990684509277344
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.524 Vali Acc: 0.534 Test Loss: 1.524 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 18 cost time: 1.1709353923797607
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.530 Vali Acc: 0.534 Test Loss: 1.530 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.284696102142334
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.039482593536377
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.551 Vali Acc: 0.534 Test Loss: 1.551 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2165935039520264
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.559 Vali Acc: 0.534 Test Loss: 1.559 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1923487186431885
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1494414806365967
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.571 Vali Acc: 0.534 Test Loss: 1.571 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3473522663116455
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.569 Vali Acc: 0.542 Test Loss: 1.569 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 25 cost time: 1.1220836639404297
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.573 Vali Acc: 0.542 Test Loss: 1.573 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2780075073242188
Epoch: 26, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.575 Vali Acc: 0.542 Test Loss: 1.575 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2295031547546387
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.577 Vali Acc: 0.542 Test Loss: 1.577 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1954903602600098
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.597 Vali Acc: 0.534 Test Loss: 1.597 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1995830535888672
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2871525287628174
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.599 Vali Acc: 0.542 Test Loss: 1.599 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.223325490951538
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.608 Vali Acc: 0.534 Test Loss: 1.608 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.412707805633545
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.607 Vali Acc: 0.534 Test Loss: 1.607 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2520911693572998
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.620 Vali Acc: 0.534 Test Loss: 1.620 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1599726676940918
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.621 Vali Acc: 0.534 Test Loss: 1.621 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 298181
model size : 5.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.108659029006958
Epoch: 1, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.780 Vali Acc: 0.137 Test Loss: 1.780 Test Acc: 0.137
Validation loss decreased (inf --> -0.137387).  Saving model ...
Epoch: 2 cost time: 1.4018476009368896
Epoch: 2, Steps: 8 | Train Loss: 1.498 Vali Loss: 1.647 Vali Acc: 0.252 Test Loss: 1.647 Test Acc: 0.252
Validation loss decreased (-0.137387 --> -0.251892).  Saving model ...
Epoch: 3 cost time: 1.2776424884796143
Epoch: 3, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.529 Vali Acc: 0.351 Test Loss: 1.529 Test Acc: 0.351
Validation loss decreased (-0.251892 --> -0.351130).  Saving model ...
Epoch: 4 cost time: 1.3140385150909424
Epoch: 4, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
Validation loss decreased (-0.351130 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.284923791885376
Epoch: 5, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.2750864028930664
Epoch: 6, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.430 Vali Acc: 0.458 Test Loss: 1.430 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3458776473999023
Epoch: 7, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.435 Vali Acc: 0.496 Test Loss: 1.435 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.2961487770080566
Epoch: 8, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3551559448242188
Epoch: 9, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.460 Vali Acc: 0.458 Test Loss: 1.460 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2257981300354004
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.518946647644043
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.514 Vali Acc: 0.473 Test Loss: 1.514 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.329784631729126
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2377238273620605
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.266899824142456
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.538 Vali Acc: 0.466 Test Loss: 1.538 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.326908826828003
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.554 Vali Acc: 0.489 Test Loss: 1.554 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3287270069122314
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.568 Vali Acc: 0.481 Test Loss: 1.568 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3160219192504883
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.574 Vali Acc: 0.473 Test Loss: 1.574 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 348037
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2245049476623535
Epoch: 1, Steps: 8 | Train Loss: 1.707 Vali Loss: 1.707 Vali Acc: 0.183 Test Loss: 1.707 Test Acc: 0.183
Validation loss decreased (inf --> -0.183189).  Saving model ...
Epoch: 2 cost time: 1.3166873455047607
Epoch: 2, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.640 Vali Acc: 0.298 Test Loss: 1.640 Test Acc: 0.298
Validation loss decreased (-0.183189 --> -0.297694).  Saving model ...
Epoch: 3 cost time: 1.3620750904083252
Epoch: 3, Steps: 8 | Train Loss: 1.067 Vali Loss: 1.590 Vali Acc: 0.351 Test Loss: 1.590 Test Acc: 0.351
Validation loss decreased (-0.297694 --> -0.351129).  Saving model ...
Epoch: 4 cost time: 1.308912754058838
Epoch: 4, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.552 Vali Acc: 0.397 Test Loss: 1.552 Test Acc: 0.397
Validation loss decreased (-0.351129 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 1.3234219551086426
Epoch: 5, Steps: 8 | Train Loss: 0.475 Vali Loss: 1.537 Vali Acc: 0.450 Test Loss: 1.537 Test Acc: 0.450
Validation loss decreased (-0.396931 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.2770934104919434
Epoch: 6, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.529 Vali Acc: 0.458 Test Loss: 1.529 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.3700613975524902
Epoch: 7, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.507 Vali Acc: 0.489 Test Loss: 1.507 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.3019089698791504
Epoch: 8, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.524 Vali Acc: 0.489 Test Loss: 1.524 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3064570426940918
Epoch: 9, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3898634910583496
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.565 Vali Acc: 0.466 Test Loss: 1.565 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2658414840698242
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.585 Vali Acc: 0.458 Test Loss: 1.585 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.335982084274292
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.599 Vali Acc: 0.458 Test Loss: 1.599 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4742331504821777
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.609 Vali Acc: 0.450 Test Loss: 1.609 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3252403736114502
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.619 Vali Acc: 0.450 Test Loss: 1.619 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3650362491607666
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.632 Vali Acc: 0.450 Test Loss: 1.632 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3677475452423096
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.643 Vali Acc: 0.450 Test Loss: 1.643 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3771042823791504
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.650 Vali Acc: 0.450 Test Loss: 1.650 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 403653
model size : 5.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.998659133911133
Epoch: 1, Steps: 8 | Train Loss: 1.633 Vali Loss: 1.599 Vali Acc: 0.389 Test Loss: 1.599 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 2.1540346145629883
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.516 Vali Acc: 0.405 Test Loss: 1.516 Test Acc: 0.405
Validation loss decreased (-0.389297 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 2.2414300441741943
Epoch: 3, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.427 Vali Acc: 0.504 Test Loss: 1.427 Test Acc: 0.504
Validation loss decreased (-0.404565 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 2.289508104324341
Epoch: 4, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.379 Vali Acc: 0.519 Test Loss: 1.379 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 2.2280242443084717
Epoch: 5, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.546 Vali Acc: 0.527 Test Loss: 1.546 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526702).  Saving model ...
Epoch: 6 cost time: 2.3325588703155518
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.384 Vali Acc: 0.511 Test Loss: 1.384 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.193467617034912
Epoch: 7, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.803 Vali Acc: 0.527 Test Loss: 1.803 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.214359998703003
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541969).  Saving model ...
Epoch: 9 cost time: 2.322723388671875
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.612 Vali Acc: 0.534 Test Loss: 1.612 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.231471538543701
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.700 Vali Acc: 0.527 Test Loss: 1.700 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.371293783187866
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.768 Vali Acc: 0.534 Test Loss: 1.768 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2227635383605957
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.800 Vali Acc: 0.534 Test Loss: 1.800 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4638469219207764
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.534 Test Loss: 1.795 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.296905517578125
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.534 Test Loss: 1.769 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.284237861633301
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.534 Test Loss: 1.768 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3404955863952637
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.534 Test Loss: 1.782 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.33764910697937
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.534 Test Loss: 1.805 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.356419086456299
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.534 Test Loss: 1.815 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 256261
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.400874137878418
Epoch: 1, Steps: 8 | Train Loss: 1.697 Vali Loss: 1.590 Vali Acc: 0.351 Test Loss: 1.590 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.8982574939727783
Epoch: 2, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.637 Vali Acc: 0.405 Test Loss: 1.637 Test Acc: 0.405
Validation loss decreased (-0.351129 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.7957701683044434
Epoch: 3, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.564 Vali Acc: 0.405 Test Loss: 1.564 Test Acc: 0.405
Validation loss decreased (-0.404564 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.9120757579803467
Epoch: 4, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.468 Vali Acc: 0.427 Test Loss: 1.468 Test Acc: 0.427
Validation loss decreased (-0.404565 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.7469186782836914
Epoch: 5, Steps: 8 | Train Loss: 0.539 Vali Loss: 1.424 Vali Acc: 0.443 Test Loss: 1.424 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442734).  Saving model ...
Epoch: 6 cost time: 1.895573377609253
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.429 Vali Acc: 0.466 Test Loss: 1.429 Test Acc: 0.466
Validation loss decreased (-0.442734 --> -0.465635).  Saving model ...
Epoch: 7 cost time: 1.9262785911560059
Epoch: 7, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.437 Vali Acc: 0.473 Test Loss: 1.437 Test Acc: 0.473
Validation loss decreased (-0.465635 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.8722381591796875
Epoch: 8, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.483 Vali Acc: 0.481 Test Loss: 1.483 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.811730146408081
Epoch: 9, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.586 Vali Acc: 0.519 Test Loss: 1.586 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 1.824704647064209
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.526 Vali Acc: 0.473 Test Loss: 1.526 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9061863422393799
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9242274761199951
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.610 Vali Acc: 0.511 Test Loss: 1.610 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8670945167541504
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.659 Vali Acc: 0.519 Test Loss: 1.659 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9163506031036377
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.649 Vali Acc: 0.511 Test Loss: 1.649 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8707199096679688
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.496 Test Loss: 1.630 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7968883514404297
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.629 Vali Acc: 0.489 Test Loss: 1.629 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7730462551116943
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.634 Vali Acc: 0.481 Test Loss: 1.634 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8020906448364258
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.668 Vali Acc: 0.489 Test Loss: 1.668 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.764636516571045
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.687 Vali Acc: 0.496 Test Loss: 1.687 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 208261
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.745058536529541
Epoch: 1, Steps: 8 | Train Loss: 1.641 Vali Loss: 1.664 Vali Acc: 0.290 Test Loss: 1.664 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 1.6540915966033936
Epoch: 2, Steps: 8 | Train Loss: 1.429 Vali Loss: 1.649 Vali Acc: 0.397 Test Loss: 1.649 Test Acc: 0.397
Validation loss decreased (-0.290060 --> -0.396930).  Saving model ...
Epoch: 3 cost time: 1.7322564125061035
Epoch: 3, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.655 Vali Acc: 0.405 Test Loss: 1.655 Test Acc: 0.405
Validation loss decreased (-0.396930 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.5769293308258057
Epoch: 4, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.582 Vali Acc: 0.466 Test Loss: 1.582 Test Acc: 0.466
Validation loss decreased (-0.404564 --> -0.465633).  Saving model ...
Epoch: 5 cost time: 1.614729881286621
Epoch: 5, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.520 Vali Acc: 0.466 Test Loss: 1.520 Test Acc: 0.466
Validation loss decreased (-0.465633 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.664719820022583
Epoch: 6, Steps: 8 | Train Loss: 0.381 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.8269879817962646
Epoch: 7, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.555 Vali Acc: 0.489 Test Loss: 1.555 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 8 cost time: 1.6433980464935303
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.543 Vali Acc: 0.496 Test Loss: 1.543 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 2.0057554244995117
Epoch: 9, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.579 Vali Acc: 0.496 Test Loss: 1.579 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5003173351287842
Epoch: 10, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.563 Vali Acc: 0.504 Test Loss: 1.563 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 11 cost time: 1.7101233005523682
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.587 Vali Acc: 0.504 Test Loss: 1.587 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9065546989440918
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.609 Vali Acc: 0.504 Test Loss: 1.609 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.652644395828247
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.648 Vali Acc: 0.511 Test Loss: 1.648 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511434).  Saving model ...
Epoch: 14 cost time: 1.7095239162445068
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.680 Vali Acc: 0.511 Test Loss: 1.680 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8591890335083008
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.691 Vali Acc: 0.511 Test Loss: 1.691 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7973315715789795
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.680 Vali Acc: 0.511 Test Loss: 1.680 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.475717306137085
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.677 Vali Acc: 0.519 Test Loss: 1.677 Test Acc: 0.519
Validation loss decreased (-0.511434 --> -0.519067).  Saving model ...
Epoch: 18 cost time: 2.024576187133789
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.684 Vali Acc: 0.519 Test Loss: 1.684 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9692966938018799
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.689 Vali Acc: 0.519 Test Loss: 1.689 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7522094249725342
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.709 Vali Acc: 0.519 Test Loss: 1.709 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.720618486404419
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.714 Vali Acc: 0.519 Test Loss: 1.714 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8850135803222656
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.729 Vali Acc: 0.519 Test Loss: 1.729 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.00814151763916
Epoch: 23, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
Validation loss decreased (-0.519067 --> -0.526700).  Saving model ...
Epoch: 24 cost time: 1.983842134475708
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.712 Vali Acc: 0.527 Test Loss: 1.712 Test Acc: 0.527
Validation loss decreased (-0.526700 --> -0.526700).  Saving model ...
Epoch: 25 cost time: 2.0144124031066895
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.725 Vali Acc: 0.527 Test Loss: 1.725 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0279691219329834
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.752 Vali Acc: 0.527 Test Loss: 1.752 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.156646966934204
Epoch: 27, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.527 Test Loss: 1.763 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8685579299926758
Epoch: 28, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.527 Test Loss: 1.762 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2715651988983154
Epoch: 29, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.749 Vali Acc: 0.527 Test Loss: 1.749 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1004271507263184
Epoch: 30, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.755 Vali Acc: 0.527 Test Loss: 1.755 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8660023212432861
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.519 Test Loss: 1.763 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9058449268341064
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.519 Test Loss: 1.767 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8566012382507324
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.519 Test Loss: 1.772 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.022768020629883
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.519 Test Loss: 1.773 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 212037
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.192645788192749
Epoch: 1, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.745 Vali Acc: 0.191 Test Loss: 1.745 Test Acc: 0.191
Validation loss decreased (inf --> -0.190822).  Saving model ...
Epoch: 2 cost time: 1.2574937343597412
Epoch: 2, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.544 Vali Acc: 0.321 Test Loss: 1.544 Test Acc: 0.321
Validation loss decreased (-0.190822 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.1827313899993896
Epoch: 3, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
Validation loss decreased (-0.320595 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.3469691276550293
Epoch: 4, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.470 Vali Acc: 0.443 Test Loss: 1.470 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.2995188236236572
Epoch: 5, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.434 Vali Acc: 0.473 Test Loss: 1.434 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.2598330974578857
Epoch: 6, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.410 Vali Acc: 0.511 Test Loss: 1.410 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.2825648784637451
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.412 Vali Acc: 0.534 Test Loss: 1.412 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 1.2814619541168213
Epoch: 8, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2630624771118164
Epoch: 9, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.523 Vali Acc: 0.527 Test Loss: 1.523 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4124994277954102
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.501 Vali Acc: 0.527 Test Loss: 1.501 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4475407600402832
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.503 Vali Acc: 0.519 Test Loss: 1.503 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3213908672332764
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.434117317199707
Epoch: 13, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.532 Vali Acc: 0.519 Test Loss: 1.532 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.510063886642456
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.542 Vali Acc: 0.519 Test Loss: 1.542 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3171401023864746
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.546 Vali Acc: 0.519 Test Loss: 1.546 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3504974842071533
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.553 Vali Acc: 0.519 Test Loss: 1.553 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3378570079803467
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.574 Vali Acc: 0.519 Test Loss: 1.574 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 227397
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2170276641845703
Epoch: 1, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.691 Vali Acc: 0.221 Test Loss: 1.691 Test Acc: 0.221
Validation loss decreased (inf --> -0.221357).  Saving model ...
Epoch: 2 cost time: 1.1873862743377686
Epoch: 2, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.623 Vali Acc: 0.313 Test Loss: 1.623 Test Acc: 0.313
Validation loss decreased (-0.221357 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.460707664489746
Epoch: 3, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.582 Vali Acc: 0.412 Test Loss: 1.582 Test Acc: 0.412
Validation loss decreased (-0.312961 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.367072582244873
Epoch: 4, Steps: 8 | Train Loss: 0.885 Vali Loss: 1.552 Vali Acc: 0.466 Test Loss: 1.552 Test Acc: 0.466
Validation loss decreased (-0.412198 --> -0.465633).  Saving model ...
Epoch: 5 cost time: 1.3636834621429443
Epoch: 5, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
Validation loss decreased (-0.465633 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.3441460132598877
Epoch: 6, Steps: 8 | Train Loss: 0.394 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
Validation loss decreased (-0.488534 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.5632131099700928
Epoch: 7, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.49222993850708
Epoch: 8, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.465 Vali Acc: 0.511 Test Loss: 1.465 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3164570331573486
Epoch: 9, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4594533443450928
Epoch: 10, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3355116844177246
Epoch: 11, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.408238410949707
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.387676477432251
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4236791133880615
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.535 Vali Acc: 0.519 Test Loss: 1.535 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4037508964538574
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3391191959381104
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.550 Vali Acc: 0.519 Test Loss: 1.550 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 273413
model size : 5.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9545681476593018
Epoch: 1, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.638 Vali Acc: 0.176 Test Loss: 1.638 Test Acc: 0.176
Validation loss decreased (inf --> -0.175556).  Saving model ...
Epoch: 2 cost time: 1.1737797260284424
Epoch: 2, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.578 Vali Acc: 0.252 Test Loss: 1.578 Test Acc: 0.252
Validation loss decreased (-0.175556 --> -0.251893).  Saving model ...
Epoch: 3 cost time: 1.339031457901001
Epoch: 3, Steps: 8 | Train Loss: 1.150 Vali Loss: 1.520 Vali Acc: 0.397 Test Loss: 1.520 Test Acc: 0.397
Validation loss decreased (-0.251893 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.230247974395752
Epoch: 4, Steps: 8 | Train Loss: 0.805 Vali Loss: 1.487 Vali Acc: 0.443 Test Loss: 1.487 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.219315528869629
Epoch: 5, Steps: 8 | Train Loss: 0.571 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
Validation loss decreased (-0.442733 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.2193243503570557
Epoch: 6, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.445 Vali Acc: 0.511 Test Loss: 1.445 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.2794110774993896
Epoch: 7, Steps: 8 | Train Loss: 0.225 Vali Loss: 1.420 Vali Acc: 0.496 Test Loss: 1.420 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3456921577453613
Epoch: 8, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.2459063529968262
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.436 Vali Acc: 0.527 Test Loss: 1.436 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 10 cost time: 1.1392924785614014
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.464 Vali Acc: 0.504 Test Loss: 1.464 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2701959609985352
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.478 Vali Acc: 0.504 Test Loss: 1.478 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2845091819763184
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.478 Vali Acc: 0.511 Test Loss: 1.478 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3257393836975098
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2085249423980713
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.519 Vali Acc: 0.496 Test Loss: 1.519 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1895015239715576
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.532 Vali Acc: 0.519 Test Loss: 1.532 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3344264030456543
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3446063995361328
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1753954887390137
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2535617351531982
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.553 Vali Acc: 0.511 Test Loss: 1.553 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 323269
model size : 5.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7678871154785156
Epoch: 1, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.726 Vali Acc: 0.237 Test Loss: 1.726 Test Acc: 0.237
Validation loss decreased (inf --> -0.236624).  Saving model ...
Epoch: 2 cost time: 1.2433946132659912
Epoch: 2, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.668 Vali Acc: 0.282 Test Loss: 1.668 Test Acc: 0.282
Validation loss decreased (-0.236624 --> -0.282426).  Saving model ...
Epoch: 3 cost time: 1.1721289157867432
Epoch: 3, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.595 Vali Acc: 0.351 Test Loss: 1.595 Test Acc: 0.351
Validation loss decreased (-0.282426 --> -0.351129).  Saving model ...
Epoch: 4 cost time: 1.282808780670166
Epoch: 4, Steps: 8 | Train Loss: 0.741 Vali Loss: 1.542 Vali Acc: 0.366 Test Loss: 1.542 Test Acc: 0.366
Validation loss decreased (-0.351129 --> -0.366397).  Saving model ...
Epoch: 5 cost time: 1.1255114078521729
Epoch: 5, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.525 Vali Acc: 0.382 Test Loss: 1.525 Test Acc: 0.382
Validation loss decreased (-0.366397 --> -0.381664).  Saving model ...
Epoch: 6 cost time: 1.088019847869873
Epoch: 6, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.516 Vali Acc: 0.435 Test Loss: 1.516 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 1.1861329078674316
Epoch: 7, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.185307502746582
Epoch: 8, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.513 Vali Acc: 0.412 Test Loss: 1.513 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3359041213989258
Epoch: 9, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.526 Vali Acc: 0.412 Test Loss: 1.526 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2564501762390137
Epoch: 10, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.536 Vali Acc: 0.412 Test Loss: 1.536 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3265728950500488
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.556 Vali Acc: 0.435 Test Loss: 1.556 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2669470310211182
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2062339782714844
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.581 Vali Acc: 0.427 Test Loss: 1.581 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.25726318359375
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.592 Vali Acc: 0.420 Test Loss: 1.592 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2313182353973389
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.611 Vali Acc: 0.435 Test Loss: 1.611 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2869539260864258
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.616 Vali Acc: 0.435 Test Loss: 1.616 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm64_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 378885
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.270101308822632
Epoch: 1, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.595 Vali Acc: 0.374 Test Loss: 1.595 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.2952768802642822
Epoch: 2, Steps: 8 | Train Loss: 1.422 Vali Loss: 1.603 Vali Acc: 0.397 Test Loss: 1.603 Test Acc: 0.397
Validation loss decreased (-0.374030 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.3560295104980469
Epoch: 3, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.4262542724609375
Epoch: 4, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.459 Vali Acc: 0.427 Test Loss: 1.459 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.3153023719787598
Epoch: 5, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.461 Vali Acc: 0.511 Test Loss: 1.461 Test Acc: 0.511
Validation loss decreased (-0.427466 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.2430601119995117
Epoch: 6, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.419 Vali Acc: 0.542 Test Loss: 1.419 Test Acc: 0.542
Validation loss decreased (-0.511436 --> -0.541971).  Saving model ...
Epoch: 7 cost time: 1.3536732196807861
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.405 Vali Acc: 0.519 Test Loss: 1.405 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2085464000701904
Epoch: 8, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.513 Vali Acc: 0.542 Test Loss: 1.513 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3100531101226807
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3052852153778076
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.475 Vali Acc: 0.519 Test Loss: 1.475 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4421682357788086
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.608 Vali Acc: 0.527 Test Loss: 1.608 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.447845458984375
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.651 Vali Acc: 0.519 Test Loss: 1.651 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3817918300628662
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.621 Vali Acc: 0.511 Test Loss: 1.621 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4690253734588623
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.601 Vali Acc: 0.504 Test Loss: 1.601 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5081379413604736
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.606 Vali Acc: 0.504 Test Loss: 1.606 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3114500045776367
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 153381
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0472826957702637
Epoch: 1, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.682 Vali Acc: 0.191 Test Loss: 1.682 Test Acc: 0.191
Validation loss decreased (inf --> -0.190823).  Saving model ...
Epoch: 2 cost time: 1.1465497016906738
Epoch: 2, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.657 Vali Acc: 0.397 Test Loss: 1.657 Test Acc: 0.397
Validation loss decreased (-0.190823 --> -0.396930).  Saving model ...
Epoch: 3 cost time: 1.254399299621582
Epoch: 3, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.680 Vali Acc: 0.405 Test Loss: 1.680 Test Acc: 0.405
Validation loss decreased (-0.396930 --> -0.404563).  Saving model ...
Epoch: 4 cost time: 1.2511930465698242
Epoch: 4, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.648 Vali Acc: 0.366 Test Loss: 1.648 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.209909439086914
Epoch: 5, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (-0.404563 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.1452534198760986
Epoch: 6, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.564 Vali Acc: 0.466 Test Loss: 1.564 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465633).  Saving model ...
Epoch: 7 cost time: 1.2448887825012207
Epoch: 7, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.536 Vali Acc: 0.458 Test Loss: 1.536 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2265033721923828
Epoch: 8, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.1772851943969727
Epoch: 9, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.473 Vali Acc: 0.481 Test Loss: 1.473 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3226780891418457
Epoch: 10, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.482 Vali Acc: 0.481 Test Loss: 1.482 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3492746353149414
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.441 Vali Acc: 0.473 Test Loss: 1.441 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.126854419708252
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.481 Vali Acc: 0.481 Test Loss: 1.481 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1865675449371338
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.544 Vali Acc: 0.496 Test Loss: 1.544 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 14 cost time: 1.3447811603546143
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511435).  Saving model ...
Epoch: 15 cost time: 1.1757190227508545
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.500 Vali Acc: 0.511 Test Loss: 1.500 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 16 cost time: 1.481673240661621
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2434194087982178
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.166456699371338
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.542 Vali Acc: 0.511 Test Loss: 1.542 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3431494235992432
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.546 Vali Acc: 0.511 Test Loss: 1.546 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2942674160003662
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.539 Vali Acc: 0.504 Test Loss: 1.539 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3986504077911377
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.537 Vali Acc: 0.489 Test Loss: 1.537 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2871346473693848
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.539 Vali Acc: 0.489 Test Loss: 1.539 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2742815017700195
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.561 Vali Acc: 0.504 Test Loss: 1.561 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1986374855041504
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.569 Vali Acc: 0.504 Test Loss: 1.569 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3874742984771729
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.572 Vali Acc: 0.496 Test Loss: 1.572 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 129381
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9991393089294434
Epoch: 1, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.656 Vali Acc: 0.374 Test Loss: 1.656 Test Acc: 0.374
Validation loss decreased (inf --> -0.374029).  Saving model ...
Epoch: 2 cost time: 1.1683135032653809
Epoch: 2, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.649 Vali Acc: 0.389 Test Loss: 1.649 Test Acc: 0.389
Validation loss decreased (-0.374029 --> -0.389296).  Saving model ...
Epoch: 3 cost time: 1.0923144817352295
Epoch: 3, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.678 Vali Acc: 0.420 Test Loss: 1.678 Test Acc: 0.420
Validation loss decreased (-0.389296 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.1024534702301025
Epoch: 4, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.631 Vali Acc: 0.427 Test Loss: 1.631 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.1648197174072266
Epoch: 5, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.546 Vali Acc: 0.489 Test Loss: 1.546 Test Acc: 0.489
Validation loss decreased (-0.427465 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.2443110942840576
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.481 Vali Acc: 0.519 Test Loss: 1.481 Test Acc: 0.519
Validation loss decreased (-0.488534 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.1658203601837158
Epoch: 7, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.2251431941986084
Epoch: 8, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.392 Vali Acc: 0.534 Test Loss: 1.392 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.273716688156128
Epoch: 9, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.353 Vali Acc: 0.542 Test Loss: 1.353 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 10 cost time: 1.0218868255615234
Epoch: 10, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.339 Vali Acc: 0.542 Test Loss: 1.339 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541971).  Saving model ...
Epoch: 11 cost time: 1.1914966106414795
Epoch: 11, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.312 Vali Acc: 0.534 Test Loss: 1.312 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1354045867919922
Epoch: 12, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.355 Vali Acc: 0.542 Test Loss: 1.355 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2441623210906982
Epoch: 13, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.380 Vali Acc: 0.557 Test Loss: 1.380 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 14 cost time: 1.11619234085083
Epoch: 14, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.392 Vali Acc: 0.557 Test Loss: 1.392 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3067846298217773
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.395 Vali Acc: 0.550 Test Loss: 1.395 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2315077781677246
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.410 Vali Acc: 0.550 Test Loss: 1.410 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1886775493621826
Epoch: 17, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.414 Vali Acc: 0.557 Test Loss: 1.414 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1515107154846191
Epoch: 18, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.413 Vali Acc: 0.550 Test Loss: 1.413 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1197595596313477
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.405 Vali Acc: 0.550 Test Loss: 1.405 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1183366775512695
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0117464065551758
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.478 Vali Acc: 0.557 Test Loss: 1.478 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0467360019683838
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.447 Vali Acc: 0.550 Test Loss: 1.447 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1902837753295898
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.429 Vali Acc: 0.550 Test Loss: 1.429 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 131269
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8124136924743652
Epoch: 1, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.621 Vali Acc: 0.198 Test Loss: 1.621 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.1634268760681152
Epoch: 2, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.574 Vali Acc: 0.351 Test Loss: 1.574 Test Acc: 0.351
Validation loss decreased (-0.198457 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.2807650566101074
Epoch: 3, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.550 Vali Acc: 0.389 Test Loss: 1.550 Test Acc: 0.389
Validation loss decreased (-0.351129 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.1582036018371582
Epoch: 4, Steps: 8 | Train Loss: 1.152 Vali Loss: 1.557 Vali Acc: 0.450 Test Loss: 1.557 Test Acc: 0.450
Validation loss decreased (-0.389297 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.3252804279327393
Epoch: 5, Steps: 8 | Train Loss: 0.927 Vali Loss: 1.526 Vali Acc: 0.420 Test Loss: 1.526 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1979703903198242
Epoch: 6, Steps: 8 | Train Loss: 0.744 Vali Loss: 1.502 Vali Acc: 0.443 Test Loss: 1.502 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2200946807861328
Epoch: 7, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.481 Vali Acc: 0.412 Test Loss: 1.481 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.149153470993042
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.472 Vali Acc: 0.427 Test Loss: 1.472 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1814923286437988
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.3088631629943848
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.436 Vali Acc: 0.443 Test Loss: 1.436 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.306694746017456
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.439 Vali Acc: 0.450 Test Loss: 1.439 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 12 cost time: 1.2128255367279053
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.442 Vali Acc: 0.466 Test Loss: 1.442 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 13 cost time: 1.1797521114349365
Epoch: 13, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.453 Vali Acc: 0.473 Test Loss: 1.453 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 14 cost time: 1.2617051601409912
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.462 Vali Acc: 0.504 Test Loss: 1.462 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503802).  Saving model ...
Epoch: 15 cost time: 1.1887083053588867
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.474 Vali Acc: 0.504 Test Loss: 1.474 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.137397289276123
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.468 Vali Acc: 0.496 Test Loss: 1.468 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1467652320861816
Epoch: 17, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.464 Vali Acc: 0.496 Test Loss: 1.464 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3255882263183594
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.151432752609253
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.477 Vali Acc: 0.496 Test Loss: 1.477 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2824485301971436
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.482 Vali Acc: 0.504 Test Loss: 1.482 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.284919023513794
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.495 Vali Acc: 0.504 Test Loss: 1.495 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1927540302276611
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.498 Vali Acc: 0.511 Test Loss: 1.498 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 23 cost time: 1.4069912433624268
Epoch: 23, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526703).  Saving model ...
Epoch: 24 cost time: 1.2785179615020752
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3042218685150146
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.501 Vali Acc: 0.527 Test Loss: 1.501 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2519516944885254
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.499 Vali Acc: 0.527 Test Loss: 1.499 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2077808380126953
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.510 Vali Acc: 0.511 Test Loss: 1.510 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0772817134857178
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1835639476776123
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2276220321655273
Epoch: 30, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.262869119644165
Epoch: 31, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1688671112060547
Epoch: 32, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.550 Vali Acc: 0.519 Test Loss: 1.550 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1865544319152832
Epoch: 33, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.551 Vali Acc: 0.519 Test Loss: 1.551 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 138949
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1579859256744385
Epoch: 1, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.611 Vali Acc: 0.214 Test Loss: 1.611 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.2815957069396973
Epoch: 2, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.565 Vali Acc: 0.305 Test Loss: 1.565 Test Acc: 0.305
Validation loss decreased (-0.213724 --> -0.305328).  Saving model ...
Epoch: 3 cost time: 1.2763864994049072
Epoch: 3, Steps: 8 | Train Loss: 1.293 Vali Loss: 1.531 Vali Acc: 0.351 Test Loss: 1.531 Test Acc: 0.351
Validation loss decreased (-0.305328 --> -0.351130).  Saving model ...
Epoch: 4 cost time: 1.2296271324157715
Epoch: 4, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.502 Vali Acc: 0.397 Test Loss: 1.502 Test Acc: 0.397
Validation loss decreased (-0.351130 --> -0.396932).  Saving model ...
Epoch: 5 cost time: 1.2402124404907227
Epoch: 5, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.476 Vali Acc: 0.443 Test Loss: 1.476 Test Acc: 0.443
Validation loss decreased (-0.396932 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.2913568019866943
Epoch: 6, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.3645119667053223
Epoch: 7, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.341956615447998
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.435 Vali Acc: 0.481 Test Loss: 1.435 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.1346049308776855
Epoch: 9, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.358537197113037
Epoch: 10, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.416 Vali Acc: 0.481 Test Loss: 1.416 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.1720709800720215
Epoch: 11, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.398 Vali Acc: 0.481 Test Loss: 1.398 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.3369982242584229
Epoch: 12, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.409 Vali Acc: 0.473 Test Loss: 1.409 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2841770648956299
Epoch: 13, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.413 Vali Acc: 0.481 Test Loss: 1.413 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.159555435180664
Epoch: 14, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.421 Vali Acc: 0.489 Test Loss: 1.421 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 15 cost time: 1.2643787860870361
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.426 Vali Acc: 0.504 Test Loss: 1.426 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 16 cost time: 1.2131471633911133
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.435 Vali Acc: 0.504 Test Loss: 1.435 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2557172775268555
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.458 Vali Acc: 0.504 Test Loss: 1.458 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.325197458267212
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2910945415496826
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.475 Vali Acc: 0.489 Test Loss: 1.475 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2223055362701416
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.464 Vali Acc: 0.489 Test Loss: 1.464 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3101553916931152
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.448 Vali Acc: 0.489 Test Loss: 1.448 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1733946800231934
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.449 Vali Acc: 0.504 Test Loss: 1.449 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2605938911437988
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.460 Vali Acc: 0.511 Test Loss: 1.460 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 24 cost time: 1.2504706382751465
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.476 Vali Acc: 0.511 Test Loss: 1.476 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2815971374511719
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.484 Vali Acc: 0.519 Test Loss: 1.484 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 26 cost time: 1.248401403427124
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1508586406707764
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.488 Vali Acc: 0.511 Test Loss: 1.488 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.24259352684021
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.493 Vali Acc: 0.519 Test Loss: 1.493 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1295976638793945
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.509 Vali Acc: 0.519 Test Loss: 1.509 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2260491847991943
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.517 Vali Acc: 0.511 Test Loss: 1.517 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1460826396942139
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.511 Vali Acc: 0.511 Test Loss: 1.511 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.140221118927002
Epoch: 32, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.524 Vali Acc: 0.511 Test Loss: 1.524 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2418627738952637
Epoch: 33, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.542 Vali Acc: 0.511 Test Loss: 1.542 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.154069185256958
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.543 Vali Acc: 0.519 Test Loss: 1.543 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4303748607635498
Epoch: 35, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 161957
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.367805004119873
Epoch: 1, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.624 Vali Acc: 0.260 Test Loss: 1.624 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.2113239765167236
Epoch: 2, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.628 Vali Acc: 0.298 Test Loss: 1.628 Test Acc: 0.298
Validation loss decreased (-0.259526 --> -0.297694).  Saving model ...
Epoch: 3 cost time: 1.3148705959320068
Epoch: 3, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.606 Vali Acc: 0.336 Test Loss: 1.606 Test Acc: 0.336
Validation loss decreased (-0.297694 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 1.2610855102539062
Epoch: 4, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.578 Vali Acc: 0.382 Test Loss: 1.578 Test Acc: 0.382
Validation loss decreased (-0.335862 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.1742045879364014
Epoch: 5, Steps: 8 | Train Loss: 0.798 Vali Loss: 1.555 Vali Acc: 0.435 Test Loss: 1.555 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.236025094985962
Epoch: 6, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.566 Vali Acc: 0.458 Test Loss: 1.566 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.3441815376281738
Epoch: 7, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.566 Vali Acc: 0.466 Test Loss: 1.566 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 8 cost time: 1.240563154220581
Epoch: 8, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.555 Vali Acc: 0.489 Test Loss: 1.555 Test Acc: 0.489
Validation loss decreased (-0.465633 --> -0.488534).  Saving model ...
Epoch: 9 cost time: 1.1829206943511963
Epoch: 9, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.554 Vali Acc: 0.489 Test Loss: 1.554 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 1.3344049453735352
Epoch: 10, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.547 Vali Acc: 0.504 Test Loss: 1.547 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 11 cost time: 1.4364266395568848
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.549 Vali Acc: 0.496 Test Loss: 1.549 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.207366704940796
Epoch: 12, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2956550121307373
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.571 Vali Acc: 0.489 Test Loss: 1.571 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3027539253234863
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.585 Vali Acc: 0.489 Test Loss: 1.585 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.326258659362793
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.591 Vali Acc: 0.504 Test Loss: 1.591 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3699860572814941
Epoch: 16, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.587 Vali Acc: 0.511 Test Loss: 1.587 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511435).  Saving model ...
Epoch: 17 cost time: 1.2074275016784668
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.590 Vali Acc: 0.496 Test Loss: 1.590 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2851886749267578
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.596 Vali Acc: 0.496 Test Loss: 1.596 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2103381156921387
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.609 Vali Acc: 0.496 Test Loss: 1.609 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2135264873504639
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.619 Vali Acc: 0.489 Test Loss: 1.619 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.422497272491455
Epoch: 21, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.649 Vali Acc: 0.496 Test Loss: 1.649 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1970012187957764
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.648 Vali Acc: 0.496 Test Loss: 1.648 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2847161293029785
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.649 Vali Acc: 0.489 Test Loss: 1.649 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2511398792266846
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.650 Vali Acc: 0.481 Test Loss: 1.650 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2929143905639648
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.652 Vali Acc: 0.489 Test Loss: 1.652 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2749884128570557
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.656 Vali Acc: 0.489 Test Loss: 1.656 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 186885
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0462679862976074
Epoch: 1, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.678 Vali Acc: 0.214 Test Loss: 1.678 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.2418429851531982
Epoch: 2, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.669 Vali Acc: 0.198 Test Loss: 1.669 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.271803617477417
Epoch: 3, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.636 Vali Acc: 0.282 Test Loss: 1.636 Test Acc: 0.282
Validation loss decreased (-0.213724 --> -0.282426).  Saving model ...
Epoch: 4 cost time: 1.2290782928466797
Epoch: 4, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.601 Vali Acc: 0.313 Test Loss: 1.601 Test Acc: 0.313
Validation loss decreased (-0.282426 --> -0.312961).  Saving model ...
Epoch: 5 cost time: 1.2111177444458008
Epoch: 5, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.561 Vali Acc: 0.359 Test Loss: 1.561 Test Acc: 0.359
Validation loss decreased (-0.312961 --> -0.358763).  Saving model ...
Epoch: 6 cost time: 1.2031750679016113
Epoch: 6, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.535 Vali Acc: 0.382 Test Loss: 1.535 Test Acc: 0.382
Validation loss decreased (-0.358763 --> -0.381664).  Saving model ...
Epoch: 7 cost time: 1.2654001712799072
Epoch: 7, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.532 Vali Acc: 0.389 Test Loss: 1.532 Test Acc: 0.389
Validation loss decreased (-0.381664 --> -0.389298).  Saving model ...
Epoch: 8 cost time: 1.257585048675537
Epoch: 8, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.389298 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.3738369941711426
Epoch: 9, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.511 Vali Acc: 0.420 Test Loss: 1.511 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 10 cost time: 1.3304674625396729
Epoch: 10, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.525 Vali Acc: 0.443 Test Loss: 1.525 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.200284719467163
Epoch: 11, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.540 Vali Acc: 0.435 Test Loss: 1.540 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2266645431518555
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.534 Vali Acc: 0.405 Test Loss: 1.534 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3851163387298584
Epoch: 13, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.531 Vali Acc: 0.443 Test Loss: 1.531 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2856438159942627
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.536 Vali Acc: 0.435 Test Loss: 1.536 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2453339099884033
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2896754741668701
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.576 Vali Acc: 0.405 Test Loss: 1.576 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6058282852172852
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.574 Vali Acc: 0.435 Test Loss: 1.574 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.192887306213379
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.593 Vali Acc: 0.443 Test Loss: 1.593 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3185162544250488
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.608 Vali Acc: 0.450 Test Loss: 1.608 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450366).  Saving model ...
Epoch: 20 cost time: 1.209075689315796
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.457999).  Saving model ...
Epoch: 21 cost time: 1.3307840824127197
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.608 Vali Acc: 0.435 Test Loss: 1.608 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.383943796157837
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.624 Vali Acc: 0.435 Test Loss: 1.624 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.342844009399414
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.647 Vali Acc: 0.443 Test Loss: 1.647 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3278143405914307
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.655 Vali Acc: 0.450 Test Loss: 1.655 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.489522933959961
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.653 Vali Acc: 0.427 Test Loss: 1.653 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2943589687347412
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.653 Vali Acc: 0.420 Test Loss: 1.653 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3614795207977295
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.650 Vali Acc: 0.427 Test Loss: 1.650 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.320223093032837
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.656 Vali Acc: 0.443 Test Loss: 1.656 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.377934217453003
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.671 Vali Acc: 0.427 Test Loss: 1.671 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3374614715576172
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.691 Vali Acc: 0.427 Test Loss: 1.691 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 214693
model size : 3.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4091992378234863
Epoch: 1, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.505 Vali Acc: 0.389 Test Loss: 1.505 Test Acc: 0.389
Validation loss decreased (inf --> -0.389298).  Saving model ...
Epoch: 2 cost time: 1.3471856117248535
Epoch: 2, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.524 Vali Acc: 0.420 Test Loss: 1.524 Test Acc: 0.420
Validation loss decreased (-0.389298 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.3367462158203125
Epoch: 3, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.468 Vali Acc: 0.458 Test Loss: 1.468 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.3803479671478271
Epoch: 4, Steps: 8 | Train Loss: 0.917 Vali Loss: 1.408 Vali Acc: 0.496 Test Loss: 1.408 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.3850057125091553
Epoch: 5, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.360 Vali Acc: 0.511 Test Loss: 1.360 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.430663824081421
Epoch: 6, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.338 Vali Acc: 0.534 Test Loss: 1.338 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534338).  Saving model ...
Epoch: 7 cost time: 1.4837501049041748
Epoch: 7, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4448201656341553
Epoch: 8, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.431 Vali Acc: 0.527 Test Loss: 1.431 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3825750350952148
Epoch: 9, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.456519603729248
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.447 Vali Acc: 0.527 Test Loss: 1.447 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4492206573486328
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.529 Vali Acc: 0.527 Test Loss: 1.529 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5723533630371094
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7109055519104004
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.509469985961914
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3827247619628906
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.571986198425293
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 128421
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1847660541534424
Epoch: 1, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.606 Vali Acc: 0.244 Test Loss: 1.606 Test Acc: 0.244
Validation loss decreased (inf --> -0.244259).  Saving model ...
Epoch: 2 cost time: 1.1432313919067383
Epoch: 2, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.602 Vali Acc: 0.412 Test Loss: 1.602 Test Acc: 0.412
Validation loss decreased (-0.244259 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.176546573638916
Epoch: 3, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.661 Vali Acc: 0.405 Test Loss: 1.661 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.325897455215454
Epoch: 4, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.576 Vali Acc: 0.443 Test Loss: 1.576 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442732).  Saving model ...
Epoch: 5 cost time: 1.2556476593017578
Epoch: 5, Steps: 8 | Train Loss: 0.954 Vali Loss: 1.502 Vali Acc: 0.435 Test Loss: 1.502 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1717689037322998
Epoch: 6, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
Validation loss decreased (-0.442732 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.163931131362915
Epoch: 7, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1732919216156006
Epoch: 8, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.445 Vali Acc: 0.496 Test Loss: 1.445 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.1776893138885498
Epoch: 9, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.436 Vali Acc: 0.519 Test Loss: 1.436 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.1839370727539062
Epoch: 10, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.427 Vali Acc: 0.534 Test Loss: 1.427 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.236957311630249
Epoch: 11, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.404 Vali Acc: 0.542 Test Loss: 1.404 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.298682451248169
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.453 Vali Acc: 0.542 Test Loss: 1.453 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5149140357971191
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.484 Vali Acc: 0.557 Test Loss: 1.484 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557237).  Saving model ...
Epoch: 14 cost time: 1.2147397994995117
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.491 Vali Acc: 0.565 Test Loss: 1.491 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564871).  Saving model ...
Epoch: 15 cost time: 1.0990746021270752
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.494 Vali Acc: 0.565 Test Loss: 1.494 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2635436058044434
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.482 Vali Acc: 0.565 Test Loss: 1.482 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564871).  Saving model ...
Epoch: 17 cost time: 1.191157579421997
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.476 Vali Acc: 0.565 Test Loss: 1.476 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564871).  Saving model ...
Epoch: 18 cost time: 1.2774090766906738
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.475 Vali Acc: 0.565 Test Loss: 1.475 Test Acc: 0.565
Validation loss decreased (-0.564871 --> -0.564871).  Saving model ...
Epoch: 19 cost time: 1.2402806282043457
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.493 Vali Acc: 0.565 Test Loss: 1.493 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2143821716308594
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.520 Vali Acc: 0.557 Test Loss: 1.520 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1483349800109863
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.512 Vali Acc: 0.565 Test Loss: 1.512 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3109376430511475
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.504 Vali Acc: 0.565 Test Loss: 1.504 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1109156608581543
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.512 Vali Acc: 0.565 Test Loss: 1.512 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2546813488006592
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.523 Vali Acc: 0.565 Test Loss: 1.523 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2032454013824463
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.541 Vali Acc: 0.565 Test Loss: 1.541 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.098726511001587
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.550 Vali Acc: 0.565 Test Loss: 1.550 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2427492141723633
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.549 Vali Acc: 0.565 Test Loss: 1.549 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1903350353240967
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.565 Test Loss: 1.551 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 104421
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0424766540527344
Epoch: 1, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.688 Vali Acc: 0.298 Test Loss: 1.688 Test Acc: 0.298
Validation loss decreased (inf --> -0.297693).  Saving model ...
Epoch: 2 cost time: 1.2336676120758057
Epoch: 2, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.636 Vali Acc: 0.366 Test Loss: 1.636 Test Acc: 0.366
Validation loss decreased (-0.297693 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.2671747207641602
Epoch: 3, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.617 Vali Acc: 0.412 Test Loss: 1.617 Test Acc: 0.412
Validation loss decreased (-0.366396 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.1989867687225342
Epoch: 4, Steps: 8 | Train Loss: 1.166 Vali Loss: 1.589 Vali Acc: 0.427 Test Loss: 1.589 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.2943065166473389
Epoch: 5, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.509 Vali Acc: 0.466 Test Loss: 1.509 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.3224821090698242
Epoch: 6, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2799956798553467
Epoch: 7, Steps: 8 | Train Loss: 0.593 Vali Loss: 1.435 Vali Acc: 0.458 Test Loss: 1.435 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2236077785491943
Epoch: 8, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.402 Vali Acc: 0.466 Test Loss: 1.402 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465635).  Saving model ...
Epoch: 9 cost time: 1.4389855861663818
Epoch: 9, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.366 Vali Acc: 0.466 Test Loss: 1.366 Test Acc: 0.466
Validation loss decreased (-0.465635 --> -0.465635).  Saving model ...
Epoch: 10 cost time: 1.2777550220489502
Epoch: 10, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.372 Vali Acc: 0.473 Test Loss: 1.372 Test Acc: 0.473
Validation loss decreased (-0.465635 --> -0.473269).  Saving model ...
Epoch: 11 cost time: 1.1868128776550293
Epoch: 11, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.424 Vali Acc: 0.466 Test Loss: 1.424 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.319972276687622
Epoch: 12, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.414 Vali Acc: 0.466 Test Loss: 1.414 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2182252407073975
Epoch: 13, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.407 Vali Acc: 0.450 Test Loss: 1.407 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.191385269165039
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3417119979858398
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.437 Vali Acc: 0.450 Test Loss: 1.437 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4654796123504639
Epoch: 16, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.452 Vali Acc: 0.458 Test Loss: 1.452 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3126370906829834
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.487 Vali Acc: 0.458 Test Loss: 1.487 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2304356098175049
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.512 Vali Acc: 0.458 Test Loss: 1.512 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.30617356300354
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2133362293243408
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.520 Vali Acc: 0.466 Test Loss: 1.520 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 106309
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.965149402618408
Epoch: 1, Steps: 8 | Train Loss: 1.889 Vali Loss: 1.576 Vali Acc: 0.298 Test Loss: 1.576 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.1973657608032227
Epoch: 2, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.533 Vali Acc: 0.359 Test Loss: 1.533 Test Acc: 0.359
Validation loss decreased (-0.297694 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 1.207981824874878
Epoch: 3, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.525 Vali Acc: 0.366 Test Loss: 1.525 Test Acc: 0.366
Validation loss decreased (-0.358763 --> -0.366397).  Saving model ...
Epoch: 4 cost time: 1.2019412517547607
Epoch: 4, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.523 Vali Acc: 0.412 Test Loss: 1.523 Test Acc: 0.412
Validation loss decreased (-0.366397 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 1.196319341659546
Epoch: 5, Steps: 8 | Train Loss: 0.982 Vali Loss: 1.489 Vali Acc: 0.420 Test Loss: 1.489 Test Acc: 0.420
Validation loss decreased (-0.412199 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.252878189086914
Epoch: 6, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.467 Vali Acc: 0.443 Test Loss: 1.467 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.1068229675292969
Epoch: 7, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.439 Vali Acc: 0.473 Test Loss: 1.439 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.147404432296753
Epoch: 8, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.417 Vali Acc: 0.481 Test Loss: 1.417 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.3726916313171387
Epoch: 9, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.408 Vali Acc: 0.504 Test Loss: 1.408 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.237633228302002
Epoch: 10, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.392 Vali Acc: 0.473 Test Loss: 1.392 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2826545238494873
Epoch: 11, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.386 Vali Acc: 0.504 Test Loss: 1.386 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.3252458572387695
Epoch: 12, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.397 Vali Acc: 0.504 Test Loss: 1.397 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.355513334274292
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.420 Vali Acc: 0.481 Test Loss: 1.420 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.379528284072876
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.437 Vali Acc: 0.496 Test Loss: 1.437 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3151977062225342
Epoch: 15, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 16 cost time: 1.297478437423706
Epoch: 16, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.452 Vali Acc: 0.511 Test Loss: 1.452 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1640708446502686
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.456 Vali Acc: 0.511 Test Loss: 1.456 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2145874500274658
Epoch: 18, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.463 Vali Acc: 0.511 Test Loss: 1.463 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2327380180358887
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.471 Vali Acc: 0.511 Test Loss: 1.471 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2393999099731445
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.479 Vali Acc: 0.527 Test Loss: 1.479 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 21 cost time: 1.3578033447265625
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 22 cost time: 1.3150537014007568
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.482 Vali Acc: 0.527 Test Loss: 1.482 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2472329139709473
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1860382556915283
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.268242597579956
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.483 Vali Acc: 0.527 Test Loss: 1.483 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2827129364013672
Epoch: 26, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.491 Vali Acc: 0.511 Test Loss: 1.491 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.202028751373291
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.504 Vali Acc: 0.511 Test Loss: 1.504 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3503808975219727
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.507 Vali Acc: 0.511 Test Loss: 1.507 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2180688381195068
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.504 Vali Acc: 0.527 Test Loss: 1.504 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1550922393798828
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.217909574508667
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 113989
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9573421478271484
Epoch: 1, Steps: 8 | Train Loss: 1.735 Vali Loss: 1.624 Vali Acc: 0.252 Test Loss: 1.624 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.170917272567749
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.613 Vali Acc: 0.313 Test Loss: 1.613 Test Acc: 0.313
Validation loss decreased (-0.251892 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.1246235370635986
Epoch: 3, Steps: 8 | Train Loss: 1.349 Vali Loss: 1.595 Vali Acc: 0.344 Test Loss: 1.595 Test Acc: 0.344
Validation loss decreased (-0.312961 --> -0.343495).  Saving model ...
Epoch: 4 cost time: 1.220869779586792
Epoch: 4, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.586 Vali Acc: 0.389 Test Loss: 1.586 Test Acc: 0.389
Validation loss decreased (-0.343495 --> -0.389297).  Saving model ...
Epoch: 5 cost time: 1.239652156829834
Epoch: 5, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.570 Vali Acc: 0.427 Test Loss: 1.570 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.2620389461517334
Epoch: 6, Steps: 8 | Train Loss: 0.721 Vali Loss: 1.540 Vali Acc: 0.458 Test Loss: 1.540 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.2621581554412842
Epoch: 7, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.517 Vali Acc: 0.443 Test Loss: 1.517 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1720991134643555
Epoch: 8, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.505 Vali Acc: 0.466 Test Loss: 1.505 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.2824821472167969
Epoch: 9, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.494 Vali Acc: 0.458 Test Loss: 1.494 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3033699989318848
Epoch: 10, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.494 Vali Acc: 0.481 Test Loss: 1.494 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.2814397811889648
Epoch: 11, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4190726280212402
Epoch: 12, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.485 Vali Acc: 0.458 Test Loss: 1.485 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2594773769378662
Epoch: 13, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.492 Vali Acc: 0.458 Test Loss: 1.492 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2397398948669434
Epoch: 14, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.501 Vali Acc: 0.458 Test Loss: 1.501 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.318347692489624
Epoch: 15, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.513 Vali Acc: 0.466 Test Loss: 1.513 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2627122402191162
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.524 Vali Acc: 0.489 Test Loss: 1.524 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 17 cost time: 1.2533819675445557
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.536 Vali Acc: 0.473 Test Loss: 1.536 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2817823886871338
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.539 Vali Acc: 0.466 Test Loss: 1.539 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4072949886322021
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.557 Vali Acc: 0.481 Test Loss: 1.557 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3596150875091553
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.560 Vali Acc: 0.481 Test Loss: 1.560 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3072295188903809
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.569 Vali Acc: 0.489 Test Loss: 1.569 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2780630588531494
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.585 Vali Acc: 0.489 Test Loss: 1.585 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2208905220031738
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.586 Vali Acc: 0.504 Test Loss: 1.586 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 24 cost time: 1.2055819034576416
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.584 Vali Acc: 0.473 Test Loss: 1.584 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1976902484893799
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.590 Vali Acc: 0.473 Test Loss: 1.590 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.163588523864746
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.598 Vali Acc: 0.496 Test Loss: 1.598 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.190293550491333
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.604 Vali Acc: 0.489 Test Loss: 1.604 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2808291912078857
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.611 Vali Acc: 0.481 Test Loss: 1.611 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1669268608093262
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.609 Vali Acc: 0.466 Test Loss: 1.609 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2805366516113281
Epoch: 30, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.611 Vali Acc: 0.481 Test Loss: 1.611 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2199270725250244
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.623 Vali Acc: 0.466 Test Loss: 1.623 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1635618209838867
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.636 Vali Acc: 0.473 Test Loss: 1.636 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2035696506500244
Epoch: 33, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.643 Vali Acc: 0.481 Test Loss: 1.643 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 136997
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.965205669403076
Epoch: 1, Steps: 8 | Train Loss: 1.767 Vali Loss: 1.806 Vali Acc: 0.191 Test Loss: 1.806 Test Acc: 0.191
Validation loss decreased (inf --> -0.190822).  Saving model ...
Epoch: 2 cost time: 1.2531607151031494
Epoch: 2, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.699 Vali Acc: 0.229 Test Loss: 1.699 Test Acc: 0.229
Validation loss decreased (-0.190822 --> -0.228991).  Saving model ...
Epoch: 3 cost time: 1.2781527042388916
Epoch: 3, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.632 Vali Acc: 0.313 Test Loss: 1.632 Test Acc: 0.313
Validation loss decreased (-0.228991 --> -0.312961).  Saving model ...
Epoch: 4 cost time: 1.1752750873565674
Epoch: 4, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.588 Vali Acc: 0.359 Test Loss: 1.588 Test Acc: 0.359
Validation loss decreased (-0.312961 --> -0.358763).  Saving model ...
Epoch: 5 cost time: 1.2122595310211182
Epoch: 5, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.358763 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.1491444110870361
Epoch: 6, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.531 Vali Acc: 0.466 Test Loss: 1.531 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.211371898651123
Epoch: 7, Steps: 8 | Train Loss: 0.506 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488534).  Saving model ...
Epoch: 8 cost time: 1.2498667240142822
Epoch: 8, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.516 Vali Acc: 0.473 Test Loss: 1.516 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.27113676071167
Epoch: 9, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.514 Vali Acc: 0.450 Test Loss: 1.514 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2192025184631348
Epoch: 10, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.527 Vali Acc: 0.450 Test Loss: 1.527 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3244922161102295
Epoch: 11, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.532 Vali Acc: 0.450 Test Loss: 1.532 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.356682538986206
Epoch: 12, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.532 Vali Acc: 0.443 Test Loss: 1.532 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3119707107543945
Epoch: 13, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.558 Vali Acc: 0.450 Test Loss: 1.558 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2473781108856201
Epoch: 14, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.556 Vali Acc: 0.443 Test Loss: 1.556 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3734338283538818
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.552 Vali Acc: 0.435 Test Loss: 1.552 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1732888221740723
Epoch: 16, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.551 Vali Acc: 0.435 Test Loss: 1.551 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3483953475952148
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.569 Vali Acc: 0.443 Test Loss: 1.569 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 161925
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9232280254364014
Epoch: 1, Steps: 8 | Train Loss: 1.880 Vali Loss: 1.799 Vali Acc: 0.153 Test Loss: 1.799 Test Acc: 0.153
Validation loss decreased (inf --> -0.152654).  Saving model ...
Epoch: 2 cost time: 1.2148749828338623
Epoch: 2, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.714 Vali Acc: 0.206 Test Loss: 1.714 Test Acc: 0.206
Validation loss decreased (-0.152654 --> -0.206090).  Saving model ...
Epoch: 3 cost time: 1.1042492389678955
Epoch: 3, Steps: 8 | Train Loss: 1.426 Vali Loss: 1.633 Vali Acc: 0.244 Test Loss: 1.633 Test Acc: 0.244
Validation loss decreased (-0.206090 --> -0.244258).  Saving model ...
Epoch: 4 cost time: 1.1947920322418213
Epoch: 4, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.558 Vali Acc: 0.290 Test Loss: 1.558 Test Acc: 0.290
Validation loss decreased (-0.244258 --> -0.290061).  Saving model ...
Epoch: 5 cost time: 1.1692907810211182
Epoch: 5, Steps: 8 | Train Loss: 0.846 Vali Loss: 1.512 Vali Acc: 0.374 Test Loss: 1.512 Test Acc: 0.374
Validation loss decreased (-0.290061 --> -0.374031).  Saving model ...
Epoch: 6 cost time: 1.0949294567108154
Epoch: 6, Steps: 8 | Train Loss: 0.640 Vali Loss: 1.492 Vali Acc: 0.397 Test Loss: 1.492 Test Acc: 0.397
Validation loss decreased (-0.374031 --> -0.396932).  Saving model ...
Epoch: 7 cost time: 1.091615915298462
Epoch: 7, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.489 Vali Acc: 0.397 Test Loss: 1.489 Test Acc: 0.397
Validation loss decreased (-0.396932 --> -0.396932).  Saving model ...
Epoch: 8 cost time: 1.0047571659088135
Epoch: 8, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.490 Vali Acc: 0.412 Test Loss: 1.490 Test Acc: 0.412
Validation loss decreased (-0.396932 --> -0.412199).  Saving model ...
Epoch: 9 cost time: 1.2380332946777344
Epoch: 9, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.493 Vali Acc: 0.420 Test Loss: 1.493 Test Acc: 0.420
Validation loss decreased (-0.412199 --> -0.419832).  Saving model ...
Epoch: 10 cost time: 1.2821719646453857
Epoch: 10, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.511 Vali Acc: 0.427 Test Loss: 1.511 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 11 cost time: 1.2158925533294678
Epoch: 11, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2893803119659424
Epoch: 12, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.504 Vali Acc: 0.412 Test Loss: 1.504 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.240096092224121
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.515 Vali Acc: 0.443 Test Loss: 1.515 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 14 cost time: 1.2317514419555664
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.527 Vali Acc: 0.443 Test Loss: 1.527 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2061545848846436
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.556 Vali Acc: 0.435 Test Loss: 1.556 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.18892240524292
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.561 Vali Acc: 0.443 Test Loss: 1.561 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.390383243560791
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.332718849182129
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.575 Vali Acc: 0.412 Test Loss: 1.575 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2830119132995605
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.593 Vali Acc: 0.443 Test Loss: 1.593 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2534160614013672
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.591 Vali Acc: 0.443 Test Loss: 1.591 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3454806804656982
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.597 Vali Acc: 0.435 Test Loss: 1.597 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2489120960235596
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.602 Vali Acc: 0.427 Test Loss: 1.602 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4104375839233398
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.610 Vali Acc: 0.420 Test Loss: 1.610 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 189733
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7706127166748047
Epoch: 1, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.561 Vali Acc: 0.359 Test Loss: 1.561 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.9188132286071777
Epoch: 2, Steps: 8 | Train Loss: 1.450 Vali Loss: 1.655 Vali Acc: 0.435 Test Loss: 1.655 Test Acc: 0.435
Validation loss decreased (-0.358763 --> -0.435098).  Saving model ...
Epoch: 3 cost time: 1.8363924026489258
Epoch: 3, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.877622127532959
Epoch: 4, Steps: 8 | Train Loss: 0.970 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
Validation loss decreased (-0.435098 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 2.0345547199249268
Epoch: 5, Steps: 8 | Train Loss: 0.633 Vali Loss: 1.488 Vali Acc: 0.473 Test Loss: 1.488 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8393185138702393
Epoch: 6, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.409 Vali Acc: 0.489 Test Loss: 1.409 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 7 cost time: 1.8017866611480713
Epoch: 7, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.455 Vali Acc: 0.534 Test Loss: 1.455 Test Acc: 0.534
Validation loss decreased (-0.488536 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 1.8084955215454102
Epoch: 8, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.464 Vali Acc: 0.504 Test Loss: 1.464 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9920601844787598
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8764839172363281
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.485 Vali Acc: 0.527 Test Loss: 1.485 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8617563247680664
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.582 Vali Acc: 0.534 Test Loss: 1.582 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6310625076293945
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.671 Vali Acc: 0.542 Test Loss: 1.671 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541968).  Saving model ...
Epoch: 13 cost time: 1.7080111503601074
Epoch: 13, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.659 Vali Acc: 0.542 Test Loss: 1.659 Test Acc: 0.542
Validation loss decreased (-0.541968 --> -0.541968).  Saving model ...
Epoch: 14 cost time: 1.8088881969451904
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.646 Vali Acc: 0.542 Test Loss: 1.646 Test Acc: 0.542
Validation loss decreased (-0.541968 --> -0.541968).  Saving model ...
Epoch: 15 cost time: 1.7777953147888184
Epoch: 15, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.625 Vali Acc: 0.519 Test Loss: 1.625 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4596776962280273
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.674 Vali Acc: 0.527 Test Loss: 1.674 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.928382396697998
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.678 Vali Acc: 0.527 Test Loss: 1.678 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7873897552490234
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.684 Vali Acc: 0.527 Test Loss: 1.684 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6932902336120605
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.527 Test Loss: 1.683 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0956101417541504
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.691 Vali Acc: 0.519 Test Loss: 1.691 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8861136436462402
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.527 Test Loss: 1.715 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7575397491455078
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.519 Test Loss: 1.709 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.75559401512146
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.703 Vali Acc: 0.519 Test Loss: 1.703 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.834885597229004
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.519 Test Loss: 1.704 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 115941
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.00837779045105
Epoch: 1, Steps: 8 | Train Loss: 1.664 Vali Loss: 1.602 Vali Acc: 0.237 Test Loss: 1.602 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.2849364280700684
Epoch: 2, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.596 Vali Acc: 0.412 Test Loss: 1.596 Test Acc: 0.412
Validation loss decreased (-0.236625 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.1521110534667969
Epoch: 3, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.594 Vali Acc: 0.427 Test Loss: 1.594 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.2206132411956787
Epoch: 4, Steps: 8 | Train Loss: 1.093 Vali Loss: 1.522 Vali Acc: 0.435 Test Loss: 1.522 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.264469861984253
Epoch: 5, Steps: 8 | Train Loss: 0.859 Vali Loss: 1.490 Vali Acc: 0.481 Test Loss: 1.490 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.0666029453277588
Epoch: 6, Steps: 8 | Train Loss: 0.683 Vali Loss: 1.449 Vali Acc: 0.489 Test Loss: 1.449 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.1234233379364014
Epoch: 7, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.424 Vali Acc: 0.504 Test Loss: 1.424 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.2943501472473145
Epoch: 8, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.373 Vali Acc: 0.504 Test Loss: 1.373 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 9 cost time: 1.0914340019226074
Epoch: 9, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.344 Vali Acc: 0.489 Test Loss: 1.344 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2367241382598877
Epoch: 10, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.389 Vali Acc: 0.504 Test Loss: 1.389 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.206355094909668
Epoch: 11, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.372 Vali Acc: 0.504 Test Loss: 1.372 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.1228373050689697
Epoch: 12, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.346 Vali Acc: 0.504 Test Loss: 1.346 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 1.229004144668579
Epoch: 13, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.375 Vali Acc: 0.504 Test Loss: 1.375 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1958012580871582
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.217815637588501
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 1.2361154556274414
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.147918701171875
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.409 Vali Acc: 0.504 Test Loss: 1.409 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1112329959869385
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.426 Vali Acc: 0.511 Test Loss: 1.426 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.220428705215454
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 20 cost time: 1.1931252479553223
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2899043560028076
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.438 Vali Acc: 0.527 Test Loss: 1.438 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.304175615310669
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.435 Vali Acc: 0.527 Test Loss: 1.435 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.35225510597229
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.447 Vali Acc: 0.519 Test Loss: 1.447 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2928524017333984
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.441 Vali Acc: 0.534 Test Loss: 1.441 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 25 cost time: 1.2437937259674072
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.434 Vali Acc: 0.519 Test Loss: 1.434 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.18534255027771
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.432 Vali Acc: 0.519 Test Loss: 1.432 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2879602909088135
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3226094245910645
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2805705070495605
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2575552463531494
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.439 Vali Acc: 0.534 Test Loss: 1.439 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 31 cost time: 1.3198590278625488
Epoch: 31, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.442 Vali Acc: 0.542 Test Loss: 1.442 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 32 cost time: 1.2571101188659668
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.461 Vali Acc: 0.542 Test Loss: 1.461 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2447125911712646
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.479 Vali Acc: 0.542 Test Loss: 1.479 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2745013236999512
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.542 Test Loss: 1.495 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2943754196166992
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.495 Vali Acc: 0.542 Test Loss: 1.495 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2966458797454834
Epoch: 36, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.494 Vali Acc: 0.542 Test Loss: 1.494 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2969131469726562
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.492 Vali Acc: 0.542 Test Loss: 1.492 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2523486614227295
Epoch: 38, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.482 Vali Acc: 0.534 Test Loss: 1.482 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2103614807128906
Epoch: 39, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.251185417175293
Epoch: 40, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.482 Vali Acc: 0.527 Test Loss: 1.482 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3047926425933838
Epoch: 41, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.487 Vali Acc: 0.527 Test Loss: 1.487 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 91941
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8390753269195557
Epoch: 1, Steps: 8 | Train Loss: 1.845 Vali Loss: 1.715 Vali Acc: 0.237 Test Loss: 1.715 Test Acc: 0.237
Validation loss decreased (inf --> -0.236624).  Saving model ...
Epoch: 2 cost time: 1.0708413124084473
Epoch: 2, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.624 Vali Acc: 0.313 Test Loss: 1.624 Test Acc: 0.313
Validation loss decreased (-0.236624 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.0704045295715332
Epoch: 3, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.598 Vali Acc: 0.412 Test Loss: 1.598 Test Acc: 0.412
Validation loss decreased (-0.312961 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.1587419509887695
Epoch: 4, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.111365795135498
Epoch: 5, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.497 Vali Acc: 0.435 Test Loss: 1.497 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.1716597080230713
Epoch: 6, Steps: 8 | Train Loss: 0.748 Vali Loss: 1.435 Vali Acc: 0.458 Test Loss: 1.435 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 7 cost time: 1.0964465141296387
Epoch: 7, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.394 Vali Acc: 0.481 Test Loss: 1.394 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.1058034896850586
Epoch: 8, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.357 Vali Acc: 0.511 Test Loss: 1.357 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511437).  Saving model ...
Epoch: 9 cost time: 1.1231372356414795
Epoch: 9, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.321 Vali Acc: 0.504 Test Loss: 1.321 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1739108562469482
Epoch: 10, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.335 Vali Acc: 0.527 Test Loss: 1.335 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.101952314376831
Epoch: 11, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.312 Vali Acc: 0.504 Test Loss: 1.312 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0780515670776367
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.299 Vali Acc: 0.504 Test Loss: 1.299 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3387796878814697
Epoch: 13, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.363 Vali Acc: 0.511 Test Loss: 1.363 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2735259532928467
Epoch: 14, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2536344528198242
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.406 Vali Acc: 0.504 Test Loss: 1.406 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2508583068847656
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.404 Vali Acc: 0.496 Test Loss: 1.404 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1398470401763916
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.375 Vali Acc: 0.511 Test Loss: 1.375 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2983529567718506
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.400 Vali Acc: 0.511 Test Loss: 1.400 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.354278564453125
Epoch: 19, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.411 Vali Acc: 0.504 Test Loss: 1.411 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1632945537567139
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.426 Vali Acc: 0.496 Test Loss: 1.426 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 93829
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.206488847732544
Epoch: 1, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.619 Vali Acc: 0.237 Test Loss: 1.619 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.3158154487609863
Epoch: 2, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.570 Vali Acc: 0.267 Test Loss: 1.570 Test Acc: 0.267
Validation loss decreased (-0.236625 --> -0.267160).  Saving model ...
Epoch: 3 cost time: 1.21392822265625
Epoch: 3, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.557 Vali Acc: 0.374 Test Loss: 1.557 Test Acc: 0.374
Validation loss decreased (-0.267160 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.2474114894866943
Epoch: 4, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.1638050079345703
Epoch: 5, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.533 Vali Acc: 0.443 Test Loss: 1.533 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.0565245151519775
Epoch: 6, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.494 Vali Acc: 0.450 Test Loss: 1.494 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.1523263454437256
Epoch: 7, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.443 Vali Acc: 0.473 Test Loss: 1.443 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.1352708339691162
Epoch: 8, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.414 Vali Acc: 0.481 Test Loss: 1.414 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.2098546028137207
Epoch: 9, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.405 Vali Acc: 0.504 Test Loss: 1.405 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.1400046348571777
Epoch: 10, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.340 Vali Acc: 0.496 Test Loss: 1.340 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1388530731201172
Epoch: 11, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.315 Vali Acc: 0.504 Test Loss: 1.315 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503804).  Saving model ...
Epoch: 12 cost time: 1.2119500637054443
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.344 Vali Acc: 0.519 Test Loss: 1.344 Test Acc: 0.519
Validation loss decreased (-0.503804 --> -0.519071).  Saving model ...
Epoch: 13 cost time: 1.1523046493530273
Epoch: 13, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.352 Vali Acc: 0.519 Test Loss: 1.352 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1407692432403564
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.361 Vali Acc: 0.519 Test Loss: 1.361 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1728384494781494
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.339 Vali Acc: 0.519 Test Loss: 1.339 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 16 cost time: 1.1638898849487305
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.325 Vali Acc: 0.519 Test Loss: 1.325 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 17 cost time: 1.23087477684021
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.340 Vali Acc: 0.519 Test Loss: 1.340 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1318557262420654
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.351 Vali Acc: 0.519 Test Loss: 1.351 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1120362281799316
Epoch: 19, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0619537830352783
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.341 Vali Acc: 0.519 Test Loss: 1.341 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2768266201019287
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.354 Vali Acc: 0.519 Test Loss: 1.354 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3105220794677734
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 23 cost time: 1.2692222595214844
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 24 cost time: 1.1921796798706055
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.372 Vali Acc: 0.527 Test Loss: 1.372 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4244961738586426
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.394261360168457
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.283841609954834
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2899551391601562
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1600379943847656
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.421 Vali Acc: 0.527 Test Loss: 1.421 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.33921480178833
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.405 Vali Acc: 0.534 Test Loss: 1.405 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 31 cost time: 1.195718765258789
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.389 Vali Acc: 0.527 Test Loss: 1.389 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.357978343963623
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.395 Vali Acc: 0.519 Test Loss: 1.395 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.185626745223999
Epoch: 33, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4245238304138184
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.405 Vali Acc: 0.511 Test Loss: 1.405 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3455450534820557
Epoch: 35, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3031487464904785
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.418 Vali Acc: 0.511 Test Loss: 1.418 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4281673431396484
Epoch: 37, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3361318111419678
Epoch: 38, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.418 Vali Acc: 0.511 Test Loss: 1.418 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1720802783966064
Epoch: 39, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.2870383262634277
Epoch: 40, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.451 Vali Acc: 0.511 Test Loss: 1.451 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 101509
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0843210220336914
Epoch: 1, Steps: 8 | Train Loss: 1.867 Vali Loss: 1.650 Vali Acc: 0.198 Test Loss: 1.650 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 1.1857614517211914
Epoch: 2, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.579 Vali Acc: 0.267 Test Loss: 1.579 Test Acc: 0.267
Validation loss decreased (-0.198457 --> -0.267160).  Saving model ...
Epoch: 3 cost time: 1.2796308994293213
Epoch: 3, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.521 Vali Acc: 0.328 Test Loss: 1.521 Test Acc: 0.328
Validation loss decreased (-0.267160 --> -0.328229).  Saving model ...
Epoch: 4 cost time: 1.2366375923156738
Epoch: 4, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.480 Vali Acc: 0.397 Test Loss: 1.480 Test Acc: 0.397
Validation loss decreased (-0.328229 --> -0.396932).  Saving model ...
Epoch: 5 cost time: 1.0419857501983643
Epoch: 5, Steps: 8 | Train Loss: 0.897 Vali Loss: 1.454 Vali Acc: 0.420 Test Loss: 1.454 Test Acc: 0.420
Validation loss decreased (-0.396932 --> -0.419833).  Saving model ...
Epoch: 6 cost time: 1.267775058746338
Epoch: 6, Steps: 8 | Train Loss: 0.731 Vali Loss: 1.435 Vali Acc: 0.466 Test Loss: 1.435 Test Acc: 0.466
Validation loss decreased (-0.419833 --> -0.465635).  Saving model ...
Epoch: 7 cost time: 1.0690507888793945
Epoch: 7, Steps: 8 | Train Loss: 0.606 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.1997041702270508
Epoch: 8, Steps: 8 | Train Loss: 0.458 Vali Loss: 1.402 Vali Acc: 0.496 Test Loss: 1.402 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.2272169589996338
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.401 Vali Acc: 0.489 Test Loss: 1.401 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3736176490783691
Epoch: 10, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.389 Vali Acc: 0.489 Test Loss: 1.389 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2546570301055908
Epoch: 11, Steps: 8 | Train Loss: 0.188 Vali Loss: 1.401 Vali Acc: 0.473 Test Loss: 1.401 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2244210243225098
Epoch: 12, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2170960903167725
Epoch: 13, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.425 Vali Acc: 0.481 Test Loss: 1.425 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2891690731048584
Epoch: 14, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.428 Vali Acc: 0.473 Test Loss: 1.428 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3489911556243896
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.432 Vali Acc: 0.466 Test Loss: 1.432 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1994516849517822
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.445 Vali Acc: 0.466 Test Loss: 1.445 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.307210922241211
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.457 Vali Acc: 0.466 Test Loss: 1.457 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2999763488769531
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.467 Vali Acc: 0.473 Test Loss: 1.467 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 124517
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.336491584777832
Epoch: 1, Steps: 8 | Train Loss: 1.760 Vali Loss: 1.759 Vali Acc: 0.160 Test Loss: 1.759 Test Acc: 0.160
Validation loss decreased (inf --> -0.160288).  Saving model ...
Epoch: 2 cost time: 1.2888822555541992
Epoch: 2, Steps: 8 | Train Loss: 1.621 Vali Loss: 1.753 Vali Acc: 0.183 Test Loss: 1.753 Test Acc: 0.183
Validation loss decreased (-0.160288 --> -0.183189).  Saving model ...
Epoch: 3 cost time: 1.1713180541992188
Epoch: 3, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.724 Vali Acc: 0.275 Test Loss: 1.724 Test Acc: 0.275
Validation loss decreased (-0.183189 --> -0.274792).  Saving model ...
Epoch: 4 cost time: 1.1875364780426025
Epoch: 4, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.682 Vali Acc: 0.351 Test Loss: 1.682 Test Acc: 0.351
Validation loss decreased (-0.274792 --> -0.351128).  Saving model ...
Epoch: 5 cost time: 1.1099441051483154
Epoch: 5, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.624 Vali Acc: 0.405 Test Loss: 1.624 Test Acc: 0.405
Validation loss decreased (-0.351128 --> -0.404564).  Saving model ...
Epoch: 6 cost time: 1.2322537899017334
Epoch: 6, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.582 Vali Acc: 0.450 Test Loss: 1.582 Test Acc: 0.450
Validation loss decreased (-0.404564 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.127047061920166
Epoch: 7, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.571 Vali Acc: 0.450 Test Loss: 1.571 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 8 cost time: 1.114058017730713
Epoch: 8, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.549 Vali Acc: 0.443 Test Loss: 1.549 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9944784641265869
Epoch: 9, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.520 Vali Acc: 0.458 Test Loss: 1.520 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 1.1241183280944824
Epoch: 10, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1909699440002441
Epoch: 11, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.513 Vali Acc: 0.458 Test Loss: 1.513 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 1.1293396949768066
Epoch: 12, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 13 cost time: 1.2584784030914307
Epoch: 13, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.546 Vali Acc: 0.458 Test Loss: 1.546 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.20460844039917
Epoch: 14, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.561 Vali Acc: 0.458 Test Loss: 1.561 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.251516342163086
Epoch: 15, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.561 Vali Acc: 0.450 Test Loss: 1.561 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.250413179397583
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.564 Vali Acc: 0.450 Test Loss: 1.564 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1994085311889648
Epoch: 17, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.569 Vali Acc: 0.458 Test Loss: 1.569 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1292541027069092
Epoch: 18, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.592 Vali Acc: 0.450 Test Loss: 1.592 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1400086879730225
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.608 Vali Acc: 0.450 Test Loss: 1.608 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.216407060623169
Epoch: 20, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.599 Vali Acc: 0.450 Test Loss: 1.599 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.318446397781372
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.603 Vali Acc: 0.458 Test Loss: 1.603 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4104630947113037
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.627 Vali Acc: 0.458 Test Loss: 1.627 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 149445
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2999472618103027
Epoch: 1, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.625 Vali Acc: 0.298 Test Loss: 1.625 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.1554393768310547
Epoch: 2, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.607 Vali Acc: 0.321 Test Loss: 1.607 Test Acc: 0.321
Validation loss decreased (-0.297694 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.18001389503479
Epoch: 3, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.593 Vali Acc: 0.344 Test Loss: 1.593 Test Acc: 0.344
Validation loss decreased (-0.320595 --> -0.343496).  Saving model ...
Epoch: 4 cost time: 1.2672927379608154
Epoch: 4, Steps: 8 | Train Loss: 0.971 Vali Loss: 1.554 Vali Acc: 0.427 Test Loss: 1.554 Test Acc: 0.427
Validation loss decreased (-0.343496 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.1215620040893555
Epoch: 5, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.224785327911377
Epoch: 6, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.516 Vali Acc: 0.489 Test Loss: 1.516 Test Acc: 0.489
Validation loss decreased (-0.450366 --> -0.488534).  Saving model ...
Epoch: 7 cost time: 1.197244644165039
Epoch: 7, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.482 Vali Acc: 0.481 Test Loss: 1.482 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2148549556732178
Epoch: 8, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.456 Vali Acc: 0.481 Test Loss: 1.456 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9947960376739502
Epoch: 9, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.452 Vali Acc: 0.489 Test Loss: 1.452 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.2051324844360352
Epoch: 10, Steps: 8 | Train Loss: 0.187 Vali Loss: 1.439 Vali Acc: 0.473 Test Loss: 1.439 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2125725746154785
Epoch: 11, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.458 Vali Acc: 0.443 Test Loss: 1.458 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.105074405670166
Epoch: 12, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.481 Vali Acc: 0.450 Test Loss: 1.481 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1904983520507812
Epoch: 13, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.491 Vali Acc: 0.458 Test Loss: 1.491 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0601470470428467
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.493 Vali Acc: 0.466 Test Loss: 1.493 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1095082759857178
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.181873083114624
Epoch: 16, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.503 Vali Acc: 0.473 Test Loss: 1.503 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.018906831741333
Epoch: 17, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0587913990020752
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1398308277130127
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.508 Vali Acc: 0.458 Test Loss: 1.508 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm32_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 177253
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2825522422790527
Epoch: 1, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.576 Vali Acc: 0.328 Test Loss: 1.576 Test Acc: 0.328
Validation loss decreased (inf --> -0.328229).  Saving model ...
Epoch: 2 cost time: 1.3324038982391357
Epoch: 2, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (-0.328229 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.2372136116027832
Epoch: 3, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.26882004737854
Epoch: 4, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.534 Vali Acc: 0.374 Test Loss: 1.534 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1543266773223877
Epoch: 5, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.1527676582336426
Epoch: 6, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.1643261909484863
Epoch: 7, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.486 Vali Acc: 0.489 Test Loss: 1.486 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.2960243225097656
Epoch: 8, Steps: 8 | Train Loss: 0.470 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3803932666778564
Epoch: 9, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511435).  Saving model ...
Epoch: 10 cost time: 1.3932106494903564
Epoch: 10, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.491 Vali Acc: 0.504 Test Loss: 1.491 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2855427265167236
Epoch: 11, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.534 Vali Acc: 0.519 Test Loss: 1.534 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 12 cost time: 1.3651304244995117
Epoch: 12, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.541 Vali Acc: 0.519 Test Loss: 1.541 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1720554828643799
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.582 Vali Acc: 0.481 Test Loss: 1.582 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1577510833740234
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.605 Vali Acc: 0.511 Test Loss: 1.605 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1997852325439453
Epoch: 15, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.605 Vali Acc: 0.504 Test Loss: 1.605 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2928252220153809
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.591 Vali Acc: 0.504 Test Loss: 1.591 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1861188411712646
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.613 Vali Acc: 0.504 Test Loss: 1.613 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1718080043792725
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.628 Vali Acc: 0.519 Test Loss: 1.628 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3868632316589355
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.638 Vali Acc: 0.519 Test Loss: 1.638 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.360459327697754
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.652 Vali Acc: 0.519 Test Loss: 1.652 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1147956848144531
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.644 Vali Acc: 0.504 Test Loss: 1.644 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 74005
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9032740592956543
Epoch: 1, Steps: 8 | Train Loss: 1.677 Vali Loss: 1.638 Vali Acc: 0.298 Test Loss: 1.638 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.1925771236419678
Epoch: 2, Steps: 8 | Train Loss: 1.540 Vali Loss: 1.583 Vali Acc: 0.344 Test Loss: 1.583 Test Acc: 0.344
Validation loss decreased (-0.297694 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.0807652473449707
Epoch: 3, Steps: 8 | Train Loss: 1.461 Vali Loss: 1.592 Vali Acc: 0.382 Test Loss: 1.592 Test Acc: 0.382
Validation loss decreased (-0.343496 --> -0.381663).  Saving model ...
Epoch: 4 cost time: 1.2380156517028809
Epoch: 4, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.570 Vali Acc: 0.374 Test Loss: 1.570 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0488495826721191
Epoch: 5, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.542 Vali Acc: 0.412 Test Loss: 1.542 Test Acc: 0.412
Validation loss decreased (-0.381663 --> -0.412198).  Saving model ...
Epoch: 6 cost time: 1.0707733631134033
Epoch: 6, Steps: 8 | Train Loss: 0.999 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.2362089157104492
Epoch: 7, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.477 Vali Acc: 0.443 Test Loss: 1.477 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.0627024173736572
Epoch: 8, Steps: 8 | Train Loss: 0.728 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 1.0456593036651611
Epoch: 9, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.15877366065979
Epoch: 10, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.393 Vali Acc: 0.496 Test Loss: 1.393 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2209794521331787
Epoch: 11, Steps: 8 | Train Loss: 0.381 Vali Loss: 1.373 Vali Acc: 0.473 Test Loss: 1.373 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1584484577178955
Epoch: 12, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.383 Vali Acc: 0.489 Test Loss: 1.383 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.130929946899414
Epoch: 13, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.361 Vali Acc: 0.496 Test Loss: 1.361 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2065000534057617
Epoch: 14, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.316 Vali Acc: 0.481 Test Loss: 1.316 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2776165008544922
Epoch: 15, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.317 Vali Acc: 0.466 Test Loss: 1.317 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1667768955230713
Epoch: 16, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.348 Vali Acc: 0.489 Test Loss: 1.348 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.224860668182373
Epoch: 17, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.346 Vali Acc: 0.496 Test Loss: 1.346 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1714026927947998
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.352 Vali Acc: 0.504 Test Loss: 1.352 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1629023551940918
Epoch: 19, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.361 Vali Acc: 0.511 Test Loss: 1.361 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511437).  Saving model ...
Epoch: 20 cost time: 1.2986550331115723
Epoch: 20, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.383 Vali Acc: 0.511 Test Loss: 1.383 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2955875396728516
Epoch: 21, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.388 Vali Acc: 0.511 Test Loss: 1.388 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3527820110321045
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2483139038085938
Epoch: 23, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.413 Vali Acc: 0.511 Test Loss: 1.413 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3088114261627197
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.398 Vali Acc: 0.504 Test Loss: 1.398 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.212123155593872
Epoch: 25, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.413 Vali Acc: 0.504 Test Loss: 1.413 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.250053882598877
Epoch: 26, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.430 Vali Acc: 0.504 Test Loss: 1.430 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2625303268432617
Epoch: 27, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1613283157348633
Epoch: 28, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.426 Vali Acc: 0.504 Test Loss: 1.426 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1863360404968262
Epoch: 29, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 62005
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9485204219818115
Epoch: 1, Steps: 8 | Train Loss: 1.775 Vali Loss: 1.668 Vali Acc: 0.206 Test Loss: 1.668 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 1.1274166107177734
Epoch: 2, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.620 Vali Acc: 0.282 Test Loss: 1.620 Test Acc: 0.282
Validation loss decreased (-0.206090 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.1006557941436768
Epoch: 3, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.590 Vali Acc: 0.359 Test Loss: 1.590 Test Acc: 0.359
Validation loss decreased (-0.282427 --> -0.358763).  Saving model ...
Epoch: 4 cost time: 1.0810704231262207
Epoch: 4, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (-0.358763 --> -0.419831).  Saving model ...
Epoch: 5 cost time: 1.0540952682495117
Epoch: 5, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.592 Vali Acc: 0.443 Test Loss: 1.592 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 6 cost time: 1.1389234066009521
Epoch: 6, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.556 Vali Acc: 0.443 Test Loss: 1.556 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.0702497959136963
Epoch: 7, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.519 Vali Acc: 0.443 Test Loss: 1.519 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.1100802421569824
Epoch: 8, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.472 Vali Acc: 0.443 Test Loss: 1.472 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.0462136268615723
Epoch: 9, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.453 Vali Acc: 0.450 Test Loss: 1.453 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 10 cost time: 1.0209293365478516
Epoch: 10, Steps: 8 | Train Loss: 0.653 Vali Loss: 1.445 Vali Acc: 0.473 Test Loss: 1.445 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 11 cost time: 1.0865809917449951
Epoch: 11, Steps: 8 | Train Loss: 0.531 Vali Loss: 1.425 Vali Acc: 0.473 Test Loss: 1.425 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 12 cost time: 1.063962697982788
Epoch: 12, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.378 Vali Acc: 0.489 Test Loss: 1.378 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 13 cost time: 1.058021068572998
Epoch: 13, Steps: 8 | Train Loss: 0.362 Vali Loss: 1.353 Vali Acc: 0.489 Test Loss: 1.353 Test Acc: 0.489
Validation loss decreased (-0.488536 --> -0.488536).  Saving model ...
Epoch: 14 cost time: 1.0600016117095947
Epoch: 14, Steps: 8 | Train Loss: 0.282 Vali Loss: 1.366 Vali Acc: 0.504 Test Loss: 1.366 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503803).  Saving model ...
Epoch: 15 cost time: 1.0267658233642578
Epoch: 15, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.374 Vali Acc: 0.504 Test Loss: 1.374 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1163077354431152
Epoch: 16, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.339 Vali Acc: 0.504 Test Loss: 1.339 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 17 cost time: 1.268247127532959
Epoch: 17, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.355 Vali Acc: 0.511 Test Loss: 1.355 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 18 cost time: 1.141045331954956
Epoch: 18, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
Validation loss decreased (-0.511437 --> -0.526704).  Saving model ...
Epoch: 19 cost time: 1.1524944305419922
Epoch: 19, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.365 Vali Acc: 0.534 Test Loss: 1.365 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.1215331554412842
Epoch: 20, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.365 Vali Acc: 0.542 Test Loss: 1.365 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 21 cost time: 1.0636520385742188
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.369 Vali Acc: 0.542 Test Loss: 1.369 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1764323711395264
Epoch: 22, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.415 Vali Acc: 0.550 Test Loss: 1.415 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549604).  Saving model ...
Epoch: 23 cost time: 1.2677929401397705
Epoch: 23, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.388 Vali Acc: 0.534 Test Loss: 1.388 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3263330459594727
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.383 Vali Acc: 0.534 Test Loss: 1.383 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.302556037902832
Epoch: 25, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.388 Vali Acc: 0.534 Test Loss: 1.388 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2997612953186035
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.399 Vali Acc: 0.550 Test Loss: 1.399 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 27 cost time: 1.1811795234680176
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.404 Vali Acc: 0.542 Test Loss: 1.404 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.432344675064087
Epoch: 28, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.402 Vali Acc: 0.542 Test Loss: 1.402 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3329033851623535
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.397 Vali Acc: 0.550 Test Loss: 1.397 Test Acc: 0.550
Validation loss decreased (-0.549604 --> -0.549604).  Saving model ...
Epoch: 30 cost time: 1.0998926162719727
Epoch: 30, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.408 Vali Acc: 0.550 Test Loss: 1.408 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2367000579833984
Epoch: 31, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3479785919189453
Epoch: 32, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3391106128692627
Epoch: 33, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.468 Vali Acc: 0.550 Test Loss: 1.468 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2879416942596436
Epoch: 34, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.463 Vali Acc: 0.550 Test Loss: 1.463 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3690102100372314
Epoch: 35, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.40706205368042
Epoch: 36, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.451 Vali Acc: 0.542 Test Loss: 1.451 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4177393913269043
Epoch: 37, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.440 Vali Acc: 0.534 Test Loss: 1.440 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2052032947540283
Epoch: 38, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.456 Vali Acc: 0.542 Test Loss: 1.456 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1252052783966064
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.467 Vali Acc: 0.542 Test Loss: 1.467 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 62949
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.928236246109009
Epoch: 1, Steps: 8 | Train Loss: 1.791 Vali Loss: 1.763 Vali Acc: 0.130 Test Loss: 1.763 Test Acc: 0.130
Validation loss decreased (inf --> -0.129753).  Saving model ...
Epoch: 2 cost time: 1.1591885089874268
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.682 Vali Acc: 0.221 Test Loss: 1.682 Test Acc: 0.221
Validation loss decreased (-0.129753 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.2255663871765137
Epoch: 3, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.621 Vali Acc: 0.351 Test Loss: 1.621 Test Acc: 0.351
Validation loss decreased (-0.221357 --> -0.351129).  Saving model ...
Epoch: 4 cost time: 1.2761244773864746
Epoch: 4, Steps: 8 | Train Loss: 1.327 Vali Loss: 1.593 Vali Acc: 0.374 Test Loss: 1.593 Test Acc: 0.374
Validation loss decreased (-0.351129 --> -0.374030).  Saving model ...
Epoch: 5 cost time: 1.205453634262085
Epoch: 5, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.578 Vali Acc: 0.412 Test Loss: 1.578 Test Acc: 0.412
Validation loss decreased (-0.374030 --> -0.412198).  Saving model ...
Epoch: 6 cost time: 1.3318464756011963
Epoch: 6, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.1523072719573975
Epoch: 7, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.507 Vali Acc: 0.458 Test Loss: 1.507 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.1567511558532715
Epoch: 8, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.492 Vali Acc: 0.458 Test Loss: 1.492 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 1.215362310409546
Epoch: 9, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.469 Vali Acc: 0.466 Test Loss: 1.469 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.2406196594238281
Epoch: 10, Steps: 8 | Train Loss: 0.578 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.160637378692627
Epoch: 11, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.434 Vali Acc: 0.466 Test Loss: 1.434 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1430962085723877
Epoch: 12, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.405 Vali Acc: 0.473 Test Loss: 1.405 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1956734657287598
Epoch: 13, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.386 Vali Acc: 0.489 Test Loss: 1.386 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488536).  Saving model ...
Epoch: 14 cost time: 1.2926957607269287
Epoch: 14, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.374 Vali Acc: 0.481 Test Loss: 1.374 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2763636112213135
Epoch: 15, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.383 Vali Acc: 0.489 Test Loss: 1.383 Test Acc: 0.489
Validation loss decreased (-0.488536 --> -0.488536).  Saving model ...
Epoch: 16 cost time: 1.317946195602417
Epoch: 16, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.367 Vali Acc: 0.496 Test Loss: 1.367 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 17 cost time: 1.4547455310821533
Epoch: 17, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.340 Vali Acc: 0.489 Test Loss: 1.340 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.294931411743164
Epoch: 18, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.325 Vali Acc: 0.496 Test Loss: 1.325 Test Acc: 0.496
Validation loss decreased (-0.496170 --> -0.496170).  Saving model ...
Epoch: 19 cost time: 1.1876623630523682
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.337 Vali Acc: 0.489 Test Loss: 1.337 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2564795017242432
Epoch: 20, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.348 Vali Acc: 0.489 Test Loss: 1.348 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1719272136688232
Epoch: 21, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.341 Vali Acc: 0.496 Test Loss: 1.341 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1581380367279053
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.341 Vali Acc: 0.489 Test Loss: 1.341 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1616034507751465
Epoch: 23, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.341 Vali Acc: 0.504 Test Loss: 1.341 Test Acc: 0.504
Validation loss decreased (-0.496170 --> -0.503803).  Saving model ...
Epoch: 24 cost time: 1.2167620658874512
Epoch: 24, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.357 Vali Acc: 0.504 Test Loss: 1.357 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2357735633850098
Epoch: 25, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.364 Vali Acc: 0.496 Test Loss: 1.364 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3997328281402588
Epoch: 26, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4918396472930908
Epoch: 27, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.349 Vali Acc: 0.519 Test Loss: 1.349 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 28 cost time: 1.2968370914459229
Epoch: 28, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.345 Vali Acc: 0.511 Test Loss: 1.345 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2860615253448486
Epoch: 29, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.352 Vali Acc: 0.511 Test Loss: 1.352 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.170820951461792
Epoch: 30, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.363 Vali Acc: 0.504 Test Loss: 1.363 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1859374046325684
Epoch: 31, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.373 Vali Acc: 0.504 Test Loss: 1.373 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2080063819885254
Epoch: 32, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1915638446807861
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2999837398529053
Epoch: 34, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.379 Vali Acc: 0.496 Test Loss: 1.379 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1646063327789307
Epoch: 35, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.405 Vali Acc: 0.504 Test Loss: 1.405 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0847899913787842
Epoch: 36, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2241125106811523
Epoch: 37, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.380 Vali Acc: 0.504 Test Loss: 1.380 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 66789
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1566267013549805
Epoch: 1, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.565 Vali Acc: 0.427 Test Loss: 1.565 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.2270517349243164
Epoch: 2, Steps: 8 | Train Loss: 1.548 Vali Loss: 1.547 Vali Acc: 0.405 Test Loss: 1.547 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2501893043518066
Epoch: 3, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.520 Vali Acc: 0.435 Test Loss: 1.520 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.1576838493347168
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.483 Vali Acc: 0.435 Test Loss: 1.483 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.2377469539642334
Epoch: 5, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.464 Vali Acc: 0.458 Test Loss: 1.464 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.2299020290374756
Epoch: 6, Steps: 8 | Train Loss: 1.008 Vali Loss: 1.445 Vali Acc: 0.481 Test Loss: 1.445 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.1411924362182617
Epoch: 7, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.428 Vali Acc: 0.504 Test Loss: 1.428 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.1536743640899658
Epoch: 8, Steps: 8 | Train Loss: 0.741 Vali Loss: 1.416 Vali Acc: 0.496 Test Loss: 1.416 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.358496904373169
Epoch: 9, Steps: 8 | Train Loss: 0.653 Vali Loss: 1.404 Vali Acc: 0.473 Test Loss: 1.404 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2433106899261475
Epoch: 10, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.394 Vali Acc: 0.489 Test Loss: 1.394 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3063676357269287
Epoch: 11, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.386 Vali Acc: 0.458 Test Loss: 1.386 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1516282558441162
Epoch: 12, Steps: 8 | Train Loss: 0.456 Vali Loss: 1.386 Vali Acc: 0.466 Test Loss: 1.386 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2594006061553955
Epoch: 13, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.366 Vali Acc: 0.473 Test Loss: 1.366 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2032313346862793
Epoch: 14, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.367 Vali Acc: 0.473 Test Loss: 1.367 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1447422504425049
Epoch: 15, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.377 Vali Acc: 0.466 Test Loss: 1.377 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.208794355392456
Epoch: 16, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.367 Vali Acc: 0.466 Test Loss: 1.367 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2376272678375244
Epoch: 17, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.379 Vali Acc: 0.450 Test Loss: 1.379 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 78293
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8492026329040527
Epoch: 1, Steps: 8 | Train Loss: 1.813 Vali Loss: 1.713 Vali Acc: 0.153 Test Loss: 1.713 Test Acc: 0.153
Validation loss decreased (inf --> -0.152655).  Saving model ...
Epoch: 2 cost time: 1.1598570346832275
Epoch: 2, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.662 Vali Acc: 0.198 Test Loss: 1.662 Test Acc: 0.198
Validation loss decreased (-0.152655 --> -0.198457).  Saving model ...
Epoch: 3 cost time: 1.1674854755401611
Epoch: 3, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.604 Vali Acc: 0.275 Test Loss: 1.604 Test Acc: 0.275
Validation loss decreased (-0.198457 --> -0.274793).  Saving model ...
Epoch: 4 cost time: 1.1699039936065674
Epoch: 4, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.556 Vali Acc: 0.336 Test Loss: 1.556 Test Acc: 0.336
Validation loss decreased (-0.274793 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 1.0628061294555664
Epoch: 5, Steps: 8 | Train Loss: 1.091 Vali Loss: 1.526 Vali Acc: 0.336 Test Loss: 1.526 Test Acc: 0.336
Validation loss decreased (-0.335862 --> -0.335863).  Saving model ...
Epoch: 6 cost time: 1.1354949474334717
Epoch: 6, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.488 Vali Acc: 0.382 Test Loss: 1.488 Test Acc: 0.382
Validation loss decreased (-0.335863 --> -0.381665).  Saving model ...
Epoch: 7 cost time: 1.2598724365234375
Epoch: 7, Steps: 8 | Train Loss: 0.767 Vali Loss: 1.461 Vali Acc: 0.382 Test Loss: 1.461 Test Acc: 0.382
Validation loss decreased (-0.381665 --> -0.381665).  Saving model ...
Epoch: 8 cost time: 1.1825733184814453
Epoch: 8, Steps: 8 | Train Loss: 0.687 Vali Loss: 1.447 Vali Acc: 0.397 Test Loss: 1.447 Test Acc: 0.397
Validation loss decreased (-0.381665 --> -0.396932).  Saving model ...
Epoch: 9 cost time: 1.2495744228363037
Epoch: 9, Steps: 8 | Train Loss: 0.586 Vali Loss: 1.445 Vali Acc: 0.420 Test Loss: 1.445 Test Acc: 0.420
Validation loss decreased (-0.396932 --> -0.419833).  Saving model ...
Epoch: 10 cost time: 1.2049527168273926
Epoch: 10, Steps: 8 | Train Loss: 0.476 Vali Loss: 1.448 Vali Acc: 0.435 Test Loss: 1.448 Test Acc: 0.435
Validation loss decreased (-0.419833 --> -0.435100).  Saving model ...
Epoch: 11 cost time: 1.1420259475708008
Epoch: 11, Steps: 8 | Train Loss: 0.425 Vali Loss: 1.447 Vali Acc: 0.420 Test Loss: 1.447 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1944212913513184
Epoch: 12, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.447 Vali Acc: 0.450 Test Loss: 1.447 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 13 cost time: 1.1195275783538818
Epoch: 13, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.423 Vali Acc: 0.458 Test Loss: 1.423 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 14 cost time: 1.1373636722564697
Epoch: 14, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.421 Vali Acc: 0.458 Test Loss: 1.421 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 15 cost time: 1.1823139190673828
Epoch: 15, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.406 Vali Acc: 0.450 Test Loss: 1.406 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2483875751495361
Epoch: 16, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.424 Vali Acc: 0.427 Test Loss: 1.424 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.228142261505127
Epoch: 17, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.408 Vali Acc: 0.443 Test Loss: 1.408 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1814825534820557
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.394 Vali Acc: 0.450 Test Loss: 1.394 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.195641040802002
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.393 Vali Acc: 0.466 Test Loss: 1.393 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 20 cost time: 1.1478872299194336
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
Validation loss decreased (-0.465635 --> -0.473268).  Saving model ...
Epoch: 21 cost time: 1.2799456119537354
Epoch: 21, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.430 Vali Acc: 0.466 Test Loss: 1.430 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.226379156112671
Epoch: 22, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.398 Vali Acc: 0.450 Test Loss: 1.398 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1976957321166992
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.407 Vali Acc: 0.473 Test Loss: 1.407 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 24 cost time: 1.213083267211914
Epoch: 24, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.392 Vali Acc: 0.450 Test Loss: 1.392 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1832396984100342
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.404 Vali Acc: 0.443 Test Loss: 1.404 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.168564796447754
Epoch: 26, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.416 Vali Acc: 0.458 Test Loss: 1.416 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.301342487335205
Epoch: 27, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.456 Vali Acc: 0.473 Test Loss: 1.456 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2313146591186523
Epoch: 28, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.454 Vali Acc: 0.450 Test Loss: 1.454 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2994065284729004
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.435 Vali Acc: 0.466 Test Loss: 1.435 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.194519281387329
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.435 Vali Acc: 0.466 Test Loss: 1.435 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.207470178604126
Epoch: 31, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.434 Vali Acc: 0.443 Test Loss: 1.434 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1639695167541504
Epoch: 32, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.435 Vali Acc: 0.443 Test Loss: 1.435 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1763513088226318
Epoch: 33, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 90757
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1836938858032227
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.761 Vali Acc: 0.206 Test Loss: 1.761 Test Acc: 0.206
Validation loss decreased (inf --> -0.206089).  Saving model ...
Epoch: 2 cost time: 1.0764679908752441
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.736 Vali Acc: 0.229 Test Loss: 1.736 Test Acc: 0.229
Validation loss decreased (-0.206089 --> -0.228990).  Saving model ...
Epoch: 3 cost time: 1.062382698059082
Epoch: 3, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.712 Vali Acc: 0.260 Test Loss: 1.712 Test Acc: 0.260
Validation loss decreased (-0.228990 --> -0.259525).  Saving model ...
Epoch: 4 cost time: 1.3539764881134033
Epoch: 4, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.679 Vali Acc: 0.321 Test Loss: 1.679 Test Acc: 0.321
Validation loss decreased (-0.259525 --> -0.320594).  Saving model ...
Epoch: 5 cost time: 1.2147152423858643
Epoch: 5, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.639 Vali Acc: 0.344 Test Loss: 1.639 Test Acc: 0.344
Validation loss decreased (-0.320594 --> -0.343495).  Saving model ...
Epoch: 6 cost time: 1.1796925067901611
Epoch: 6, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.588 Vali Acc: 0.374 Test Loss: 1.588 Test Acc: 0.374
Validation loss decreased (-0.343495 --> -0.374030).  Saving model ...
Epoch: 7 cost time: 1.1683106422424316
Epoch: 7, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.571 Vali Acc: 0.405 Test Loss: 1.571 Test Acc: 0.405
Validation loss decreased (-0.374030 --> -0.404564).  Saving model ...
Epoch: 8 cost time: 1.297473669052124
Epoch: 8, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.1602821350097656
Epoch: 9, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.545 Vali Acc: 0.405 Test Loss: 1.545 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1682021617889404
Epoch: 10, Steps: 8 | Train Loss: 0.429 Vali Loss: 1.544 Vali Acc: 0.397 Test Loss: 1.544 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2022039890289307
Epoch: 11, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.543 Vali Acc: 0.458 Test Loss: 1.543 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 1.2204527854919434
Epoch: 12, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.543 Vali Acc: 0.443 Test Loss: 1.543 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3915681838989258
Epoch: 13, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.530 Vali Acc: 0.427 Test Loss: 1.530 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.474074363708496
Epoch: 14, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.532 Vali Acc: 0.450 Test Loss: 1.532 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3182523250579834
Epoch: 15, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.567 Vali Acc: 0.435 Test Loss: 1.567 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3125600814819336
Epoch: 16, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.574 Vali Acc: 0.466 Test Loss: 1.574 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 17 cost time: 1.3006470203399658
Epoch: 17, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.575 Vali Acc: 0.435 Test Loss: 1.575 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3617663383483887
Epoch: 18, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.569 Vali Acc: 0.435 Test Loss: 1.569 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3831548690795898
Epoch: 19, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.576 Vali Acc: 0.443 Test Loss: 1.576 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4590766429901123
Epoch: 20, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.592 Vali Acc: 0.427 Test Loss: 1.592 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3874742984771729
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.612 Vali Acc: 0.435 Test Loss: 1.612 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2570621967315674
Epoch: 22, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.618 Vali Acc: 0.435 Test Loss: 1.618 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3233821392059326
Epoch: 23, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.642 Vali Acc: 0.427 Test Loss: 1.642 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2539381980895996
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.621 Vali Acc: 0.405 Test Loss: 1.621 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2258319854736328
Epoch: 25, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.626 Vali Acc: 0.435 Test Loss: 1.626 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2941884994506836
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.622 Vali Acc: 0.435 Test Loss: 1.622 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 104661
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.796619415283203
Epoch: 1, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.590 Vali Acc: 0.275 Test Loss: 1.590 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.2280681133270264
Epoch: 2, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.556 Vali Acc: 0.412 Test Loss: 1.556 Test Acc: 0.412
Validation loss decreased (-0.274793 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.1468727588653564
Epoch: 3, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.545 Vali Acc: 0.405 Test Loss: 1.545 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1739606857299805
Epoch: 4, Steps: 8 | Train Loss: 1.193 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.3240032196044922
Epoch: 5, Steps: 8 | Train Loss: 1.012 Vali Loss: 1.492 Vali Acc: 0.466 Test Loss: 1.492 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.294708013534546
Epoch: 6, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.467 Vali Acc: 0.496 Test Loss: 1.467 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.4449994564056396
Epoch: 7, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.204251766204834
Epoch: 8, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.449 Vali Acc: 0.504 Test Loss: 1.449 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4073662757873535
Epoch: 9, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.425 Vali Acc: 0.504 Test Loss: 1.425 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2281334400177002
Epoch: 10, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.425 Vali Acc: 0.511 Test Loss: 1.425 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511436).  Saving model ...
Epoch: 11 cost time: 1.2461214065551758
Epoch: 11, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4198760986328125
Epoch: 12, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.561 Vali Acc: 0.519 Test Loss: 1.561 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519068).  Saving model ...
Epoch: 13 cost time: 1.3701601028442383
Epoch: 13, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.502 Vali Acc: 0.496 Test Loss: 1.502 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1621792316436768
Epoch: 14, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.504 Vali Acc: 0.496 Test Loss: 1.504 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3612785339355469
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.526 Vali Acc: 0.496 Test Loss: 1.526 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2546138763427734
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.569 Vali Acc: 0.496 Test Loss: 1.569 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3219382762908936
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.605 Vali Acc: 0.496 Test Loss: 1.605 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.297210693359375
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.613 Vali Acc: 0.496 Test Loss: 1.613 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3356401920318604
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.612 Vali Acc: 0.496 Test Loss: 1.612 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2775852680206299
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.620 Vali Acc: 0.496 Test Loss: 1.620 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1315886974334717
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.626 Vali Acc: 0.496 Test Loss: 1.626 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.204394817352295
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.634 Vali Acc: 0.496 Test Loss: 1.634 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 61333
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0989253520965576
Epoch: 1, Steps: 8 | Train Loss: 1.843 Vali Loss: 1.723 Vali Acc: 0.214 Test Loss: 1.723 Test Acc: 0.214
Validation loss decreased (inf --> -0.213723).  Saving model ...
Epoch: 2 cost time: 1.1632604598999023
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.622 Vali Acc: 0.374 Test Loss: 1.622 Test Acc: 0.374
Validation loss decreased (-0.213723 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.227877140045166
Epoch: 3, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.612 Vali Acc: 0.405 Test Loss: 1.612 Test Acc: 0.405
Validation loss decreased (-0.374030 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.216426134109497
Epoch: 4, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.623 Vali Acc: 0.427 Test Loss: 1.623 Test Acc: 0.427
Validation loss decreased (-0.404564 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.073772668838501
Epoch: 5, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.598 Vali Acc: 0.427 Test Loss: 1.598 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.0202305316925049
Epoch: 6, Steps: 8 | Train Loss: 1.033 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2349090576171875
Epoch: 7, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.527 Vali Acc: 0.466 Test Loss: 1.527 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.1907644271850586
Epoch: 8, Steps: 8 | Train Loss: 0.764 Vali Loss: 1.502 Vali Acc: 0.481 Test Loss: 1.502 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.073751449584961
Epoch: 9, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.487 Vali Acc: 0.504 Test Loss: 1.487 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.092599630355835
Epoch: 10, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.489 Vali Acc: 0.496 Test Loss: 1.489 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2403359413146973
Epoch: 11, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.442 Vali Acc: 0.496 Test Loss: 1.442 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.119715690612793
Epoch: 12, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 1.2276475429534912
Epoch: 13, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.428 Vali Acc: 0.504 Test Loss: 1.428 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503803).  Saving model ...
Epoch: 14 cost time: 1.151845932006836
Epoch: 14, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.412 Vali Acc: 0.511 Test Loss: 1.412 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 1.0622565746307373
Epoch: 15, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0891070365905762
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.441 Vali Acc: 0.527 Test Loss: 1.441 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 1.084364414215088
Epoch: 17, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.472 Vali Acc: 0.527 Test Loss: 1.472 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1257529258728027
Epoch: 18, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.466 Vali Acc: 0.527 Test Loss: 1.466 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8571419715881348
Epoch: 19, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3046228885650635
Epoch: 20, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1416442394256592
Epoch: 21, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.493 Vali Acc: 0.527 Test Loss: 1.493 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0483310222625732
Epoch: 22, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.504 Vali Acc: 0.527 Test Loss: 1.504 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9975619316101074
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.507 Vali Acc: 0.534 Test Loss: 1.507 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 24 cost time: 1.243720293045044
Epoch: 24, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.506 Vali Acc: 0.534 Test Loss: 1.506 Test Acc: 0.534
Validation loss decreased (-0.534336 --> -0.534336).  Saving model ...
Epoch: 25 cost time: 1.084874153137207
Epoch: 25, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.522 Vali Acc: 0.534 Test Loss: 1.522 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.161745309829712
Epoch: 26, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.530 Vali Acc: 0.534 Test Loss: 1.530 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1321492195129395
Epoch: 27, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.531 Vali Acc: 0.550 Test Loss: 1.531 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549603).  Saving model ...
Epoch: 28 cost time: 1.2778735160827637
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.536 Vali Acc: 0.550 Test Loss: 1.536 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0910930633544922
Epoch: 29, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.562 Vali Acc: 0.550 Test Loss: 1.562 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.076864242553711
Epoch: 30, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.567 Vali Acc: 0.550 Test Loss: 1.567 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1340222358703613
Epoch: 31, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.573 Vali Acc: 0.550 Test Loss: 1.573 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.181363821029663
Epoch: 32, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2617769241333008
Epoch: 33, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.590 Vali Acc: 0.550 Test Loss: 1.590 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1262435913085938
Epoch: 34, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.583 Vali Acc: 0.550 Test Loss: 1.583 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2036890983581543
Epoch: 35, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.587 Vali Acc: 0.550 Test Loss: 1.587 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1052980422973633
Epoch: 36, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.593 Vali Acc: 0.550 Test Loss: 1.593 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2201128005981445
Epoch: 37, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.602 Vali Acc: 0.550 Test Loss: 1.602 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 49333
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3050942420959473
Epoch: 1, Steps: 8 | Train Loss: 1.760 Vali Loss: 1.692 Vali Acc: 0.260 Test Loss: 1.692 Test Acc: 0.260
Validation loss decreased (inf --> -0.259525).  Saving model ...
Epoch: 2 cost time: 1.1248128414154053
Epoch: 2, Steps: 8 | Train Loss: 1.622 Vali Loss: 1.615 Vali Acc: 0.290 Test Loss: 1.615 Test Acc: 0.290
Validation loss decreased (-0.259525 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 1.196162223815918
Epoch: 3, Steps: 8 | Train Loss: 1.434 Vali Loss: 1.570 Vali Acc: 0.397 Test Loss: 1.570 Test Acc: 0.397
Validation loss decreased (-0.290060 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.223602056503296
Epoch: 4, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.566 Vali Acc: 0.435 Test Loss: 1.566 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.1807374954223633
Epoch: 5, Steps: 8 | Train Loss: 1.141 Vali Loss: 1.573 Vali Acc: 0.427 Test Loss: 1.573 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.12752103805542
Epoch: 6, Steps: 8 | Train Loss: 1.057 Vali Loss: 1.562 Vali Acc: 0.443 Test Loss: 1.562 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442732).  Saving model ...
Epoch: 7 cost time: 1.179215431213379
Epoch: 7, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0500223636627197
Epoch: 8, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.506 Vali Acc: 0.458 Test Loss: 1.506 Test Acc: 0.458
Validation loss decreased (-0.442732 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 1.1482868194580078
Epoch: 9, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.483 Vali Acc: 0.481 Test Loss: 1.483 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 10 cost time: 1.1881163120269775
Epoch: 10, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.458 Vali Acc: 0.450 Test Loss: 1.458 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1159741878509521
Epoch: 11, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.424 Vali Acc: 0.511 Test Loss: 1.424 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.0903356075286865
Epoch: 12, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.403 Vali Acc: 0.519 Test Loss: 1.403 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 1.2148783206939697
Epoch: 13, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.397 Vali Acc: 0.496 Test Loss: 1.397 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1741197109222412
Epoch: 14, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 15 cost time: 1.2501275539398193
Epoch: 15, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 16 cost time: 1.0725452899932861
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.367 Vali Acc: 0.511 Test Loss: 1.367 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2336323261260986
Epoch: 17, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.341 Vali Acc: 0.519 Test Loss: 1.341 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1989784240722656
Epoch: 18, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 19 cost time: 1.18080472946167
Epoch: 19, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.412 Vali Acc: 0.519 Test Loss: 1.412 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3436729907989502
Epoch: 20, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.366 Vali Acc: 0.534 Test Loss: 1.366 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 21 cost time: 1.1846766471862793
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2134003639221191
Epoch: 22, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.373 Vali Acc: 0.527 Test Loss: 1.373 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2514667510986328
Epoch: 23, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2702138423919678
Epoch: 24, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.424 Vali Acc: 0.511 Test Loss: 1.424 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3484301567077637
Epoch: 25, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.397 Vali Acc: 0.511 Test Loss: 1.397 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.158083438873291
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.384 Vali Acc: 0.504 Test Loss: 1.384 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1944425106048584
Epoch: 27, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.416 Vali Acc: 0.511 Test Loss: 1.416 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1880364418029785
Epoch: 28, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.230177640914917
Epoch: 29, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2900238037109375
Epoch: 30, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.409 Vali Acc: 0.527 Test Loss: 1.409 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 50277
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.804006576538086
Epoch: 1, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.603 Vali Acc: 0.374 Test Loss: 1.603 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.274782657623291
Epoch: 2, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.584 Vali Acc: 0.412 Test Loss: 1.584 Test Acc: 0.412
Validation loss decreased (-0.374030 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.3428764343261719
Epoch: 3, Steps: 8 | Train Loss: 1.416 Vali Loss: 1.576 Vali Acc: 0.435 Test Loss: 1.576 Test Acc: 0.435
Validation loss decreased (-0.412198 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.1587343215942383
Epoch: 4, Steps: 8 | Train Loss: 1.256 Vali Loss: 1.568 Vali Acc: 0.435 Test Loss: 1.568 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.2377893924713135
Epoch: 5, Steps: 8 | Train Loss: 1.186 Vali Loss: 1.555 Vali Acc: 0.427 Test Loss: 1.555 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3024382591247559
Epoch: 6, Steps: 8 | Train Loss: 1.089 Vali Loss: 1.534 Vali Acc: 0.450 Test Loss: 1.534 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.2516250610351562
Epoch: 7, Steps: 8 | Train Loss: 0.884 Vali Loss: 1.520 Vali Acc: 0.481 Test Loss: 1.520 Test Acc: 0.481
Validation loss decreased (-0.450366 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.291792869567871
Epoch: 8, Steps: 8 | Train Loss: 0.846 Vali Loss: 1.496 Vali Acc: 0.489 Test Loss: 1.496 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 1.2176311016082764
Epoch: 9, Steps: 8 | Train Loss: 0.712 Vali Loss: 1.468 Vali Acc: 0.496 Test Loss: 1.468 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.0611262321472168
Epoch: 10, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.467 Vali Acc: 0.496 Test Loss: 1.467 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.1535325050354004
Epoch: 11, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.465 Vali Acc: 0.504 Test Loss: 1.465 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.1537361145019531
Epoch: 12, Steps: 8 | Train Loss: 0.466 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.258472204208374
Epoch: 13, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 14 cost time: 1.291184663772583
Epoch: 14, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.516153335571289
Epoch: 15, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.465 Vali Acc: 0.511 Test Loss: 1.465 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3504114151000977
Epoch: 16, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.449 Vali Acc: 0.496 Test Loss: 1.449 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.357600450515747
Epoch: 17, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.436 Vali Acc: 0.489 Test Loss: 1.436 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3068029880523682
Epoch: 18, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.433 Vali Acc: 0.489 Test Loss: 1.433 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.220707893371582
Epoch: 19, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.457 Vali Acc: 0.504 Test Loss: 1.457 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3069477081298828
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.485 Vali Acc: 0.519 Test Loss: 1.485 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2914767265319824
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.491 Vali Acc: 0.519 Test Loss: 1.491 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3110768795013428
Epoch: 22, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.485 Vali Acc: 0.519 Test Loss: 1.485 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.327235221862793
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 54117
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2279984951019287
Epoch: 1, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.663 Vali Acc: 0.244 Test Loss: 1.663 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.1319913864135742
Epoch: 2, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.638 Vali Acc: 0.282 Test Loss: 1.638 Test Acc: 0.282
Validation loss decreased (-0.244258 --> -0.282426).  Saving model ...
Epoch: 3 cost time: 1.1763927936553955
Epoch: 3, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.616 Vali Acc: 0.313 Test Loss: 1.616 Test Acc: 0.313
Validation loss decreased (-0.282426 --> -0.312961).  Saving model ...
Epoch: 4 cost time: 1.0790433883666992
Epoch: 4, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.583 Vali Acc: 0.389 Test Loss: 1.583 Test Acc: 0.389
Validation loss decreased (-0.312961 --> -0.389297).  Saving model ...
Epoch: 5 cost time: 1.1535849571228027
Epoch: 5, Steps: 8 | Train Loss: 1.084 Vali Loss: 1.553 Vali Acc: 0.458 Test Loss: 1.553 Test Acc: 0.458
Validation loss decreased (-0.389297 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.1806330680847168
Epoch: 6, Steps: 8 | Train Loss: 0.939 Vali Loss: 1.530 Vali Acc: 0.489 Test Loss: 1.530 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 7 cost time: 1.1451342105865479
Epoch: 7, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2951240539550781
Epoch: 8, Steps: 8 | Train Loss: 0.721 Vali Loss: 1.507 Vali Acc: 0.473 Test Loss: 1.507 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1749050617218018
Epoch: 9, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.513 Vali Acc: 0.481 Test Loss: 1.513 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.036348581314087
Epoch: 10, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.524 Vali Acc: 0.511 Test Loss: 1.524 Test Acc: 0.511
Validation loss decreased (-0.488534 --> -0.511435).  Saving model ...
Epoch: 11 cost time: 1.1366169452667236
Epoch: 11, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1714839935302734
Epoch: 12, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 13 cost time: 1.1581788063049316
Epoch: 13, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 14 cost time: 1.181750774383545
Epoch: 14, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2501461505889893
Epoch: 15, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.563 Vali Acc: 0.511 Test Loss: 1.563 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3257522583007812
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.554 Vali Acc: 0.511 Test Loss: 1.554 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1903135776519775
Epoch: 17, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.568 Vali Acc: 0.504 Test Loss: 1.568 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.227311372756958
Epoch: 18, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.567 Vali Acc: 0.489 Test Loss: 1.567 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1793227195739746
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.582 Vali Acc: 0.489 Test Loss: 1.582 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2474260330200195
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.590 Vali Acc: 0.489 Test Loss: 1.590 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.198831558227539
Epoch: 21, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.586 Vali Acc: 0.481 Test Loss: 1.586 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1634492874145508
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.598 Vali Acc: 0.489 Test Loss: 1.598 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1923882961273193
Epoch: 23, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.596 Vali Acc: 0.496 Test Loss: 1.596 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 65621
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4703853130340576
Epoch: 1, Steps: 8 | Train Loss: 1.714 Vali Loss: 1.750 Vali Acc: 0.198 Test Loss: 1.750 Test Acc: 0.198
Validation loss decreased (inf --> -0.198456).  Saving model ...
Epoch: 2 cost time: 1.2929911613464355
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.717 Vali Acc: 0.229 Test Loss: 1.717 Test Acc: 0.229
Validation loss decreased (-0.198456 --> -0.228990).  Saving model ...
Epoch: 3 cost time: 1.1740162372589111
Epoch: 3, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.678 Vali Acc: 0.260 Test Loss: 1.678 Test Acc: 0.260
Validation loss decreased (-0.228990 --> -0.259525).  Saving model ...
Epoch: 4 cost time: 1.3048710823059082
Epoch: 4, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.635 Vali Acc: 0.282 Test Loss: 1.635 Test Acc: 0.282
Validation loss decreased (-0.259525 --> -0.282426).  Saving model ...
Epoch: 5 cost time: 1.1233954429626465
Epoch: 5, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.595 Vali Acc: 0.290 Test Loss: 1.595 Test Acc: 0.290
Validation loss decreased (-0.282426 --> -0.290060).  Saving model ...
Epoch: 6 cost time: 1.3427166938781738
Epoch: 6, Steps: 8 | Train Loss: 0.963 Vali Loss: 1.560 Vali Acc: 0.366 Test Loss: 1.560 Test Acc: 0.366
Validation loss decreased (-0.290060 --> -0.366397).  Saving model ...
Epoch: 7 cost time: 1.2310974597930908
Epoch: 7, Steps: 8 | Train Loss: 0.783 Vali Loss: 1.523 Vali Acc: 0.382 Test Loss: 1.523 Test Acc: 0.382
Validation loss decreased (-0.366397 --> -0.381664).  Saving model ...
Epoch: 8 cost time: 1.2746598720550537
Epoch: 8, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.480 Vali Acc: 0.382 Test Loss: 1.480 Test Acc: 0.382
Validation loss decreased (-0.381664 --> -0.381665).  Saving model ...
Epoch: 9 cost time: 1.2911958694458008
Epoch: 9, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.454 Vali Acc: 0.412 Test Loss: 1.454 Test Acc: 0.412
Validation loss decreased (-0.381665 --> -0.412199).  Saving model ...
Epoch: 10 cost time: 1.1915154457092285
Epoch: 10, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.436 Vali Acc: 0.420 Test Loss: 1.436 Test Acc: 0.420
Validation loss decreased (-0.412199 --> -0.419833).  Saving model ...
Epoch: 11 cost time: 1.1003177165985107
Epoch: 11, Steps: 8 | Train Loss: 0.425 Vali Loss: 1.447 Vali Acc: 0.443 Test Loss: 1.447 Test Acc: 0.443
Validation loss decreased (-0.419833 --> -0.442734).  Saving model ...
Epoch: 12 cost time: 1.0452940464019775
Epoch: 12, Steps: 8 | Train Loss: 0.366 Vali Loss: 1.447 Vali Acc: 0.427 Test Loss: 1.447 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2111001014709473
Epoch: 13, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.432 Vali Acc: 0.412 Test Loss: 1.432 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2647275924682617
Epoch: 14, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.400 Vali Acc: 0.420 Test Loss: 1.400 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.110569953918457
Epoch: 15, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.392 Vali Acc: 0.427 Test Loss: 1.392 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1425213813781738
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.402 Vali Acc: 0.435 Test Loss: 1.402 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1129872798919678
Epoch: 17, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.403 Vali Acc: 0.420 Test Loss: 1.403 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.194453477859497
Epoch: 18, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.407 Vali Acc: 0.420 Test Loss: 1.407 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2520496845245361
Epoch: 19, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.426 Vali Acc: 0.443 Test Loss: 1.426 Test Acc: 0.443
Validation loss decreased (-0.442734 --> -0.442734).  Saving model ...
Epoch: 20 cost time: 1.2253413200378418
Epoch: 20, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.423 Vali Acc: 0.427 Test Loss: 1.423 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2411739826202393
Epoch: 21, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.433 Vali Acc: 0.427 Test Loss: 1.433 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1529531478881836
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.439 Vali Acc: 0.427 Test Loss: 1.439 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1539442539215088
Epoch: 23, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.441 Vali Acc: 0.405 Test Loss: 1.441 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.094761610031128
Epoch: 24, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.438 Vali Acc: 0.435 Test Loss: 1.438 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3266596794128418
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.436 Vali Acc: 0.443 Test Loss: 1.436 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2646710872650146
Epoch: 26, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.445 Vali Acc: 0.435 Test Loss: 1.445 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2835898399353027
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.451 Vali Acc: 0.427 Test Loss: 1.451 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4556617736816406
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.458 Vali Acc: 0.435 Test Loss: 1.458 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2475581169128418
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.454 Vali Acc: 0.435 Test Loss: 1.454 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 78085
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3788678646087646
Epoch: 1, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.658 Vali Acc: 0.214 Test Loss: 1.658 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.2731928825378418
Epoch: 2, Steps: 8 | Train Loss: 1.596 Vali Loss: 1.637 Vali Acc: 0.214 Test Loss: 1.637 Test Acc: 0.214
Validation loss decreased (-0.213724 --> -0.213724).  Saving model ...
Epoch: 3 cost time: 1.2724368572235107
Epoch: 3, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.625 Vali Acc: 0.282 Test Loss: 1.625 Test Acc: 0.282
Validation loss decreased (-0.213724 --> -0.282426).  Saving model ...
Epoch: 4 cost time: 1.5498652458190918
Epoch: 4, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.621 Vali Acc: 0.344 Test Loss: 1.621 Test Acc: 0.344
Validation loss decreased (-0.282426 --> -0.343495).  Saving model ...
Epoch: 5 cost time: 1.2997207641601562
Epoch: 5, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.616 Vali Acc: 0.405 Test Loss: 1.616 Test Acc: 0.405
Validation loss decreased (-0.343495 --> -0.404564).  Saving model ...
Epoch: 6 cost time: 1.2907986640930176
Epoch: 6, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.606 Vali Acc: 0.397 Test Loss: 1.606 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1756696701049805
Epoch: 7, Steps: 8 | Train Loss: 0.713 Vali Loss: 1.575 Vali Acc: 0.397 Test Loss: 1.575 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1921474933624268
Epoch: 8, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.3674392700195312
Epoch: 9, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.550 Vali Acc: 0.412 Test Loss: 1.550 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4218673706054688
Epoch: 10, Steps: 8 | Train Loss: 0.445 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 11 cost time: 1.2850501537322998
Epoch: 11, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2776257991790771
Epoch: 12, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.520 Vali Acc: 0.435 Test Loss: 1.520 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 13 cost time: 1.3452579975128174
Epoch: 13, Steps: 8 | Train Loss: 0.268 Vali Loss: 1.523 Vali Acc: 0.427 Test Loss: 1.523 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2542335987091064
Epoch: 14, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.521 Vali Acc: 0.412 Test Loss: 1.521 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3350536823272705
Epoch: 15, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.507 Vali Acc: 0.427 Test Loss: 1.507 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.20865797996521
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 17 cost time: 1.2414617538452148
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.570 Vali Acc: 0.458 Test Loss: 1.570 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 18 cost time: 1.2506051063537598
Epoch: 18, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.553 Vali Acc: 0.427 Test Loss: 1.553 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1686692237854004
Epoch: 19, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.567 Vali Acc: 0.443 Test Loss: 1.567 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3080036640167236
Epoch: 20, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.581 Vali Acc: 0.450 Test Loss: 1.581 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1538524627685547
Epoch: 21, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.580 Vali Acc: 0.420 Test Loss: 1.580 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.202322244644165
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.576 Vali Acc: 0.458 Test Loss: 1.576 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.239583969116211
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.601 Vali Acc: 0.458 Test Loss: 1.601 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2827436923980713
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.605 Vali Acc: 0.443 Test Loss: 1.605 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1561298370361328
Epoch: 25, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.597 Vali Acc: 0.450 Test Loss: 1.597 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1423418521881104
Epoch: 26, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.619 Vali Acc: 0.458 Test Loss: 1.619 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1985673904418945
Epoch: 27, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 91989
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.025855779647827
Epoch: 1, Steps: 8 | Train Loss: 1.692 Vali Loss: 1.542 Vali Acc: 0.382 Test Loss: 1.542 Test Acc: 0.382
Validation loss decreased (inf --> -0.381664).  Saving model ...
Epoch: 2 cost time: 1.2273502349853516
Epoch: 2, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.583 Vali Acc: 0.405 Test Loss: 1.583 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.268186330795288
Epoch: 3, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.584 Vali Acc: 0.389 Test Loss: 1.584 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3648414611816406
Epoch: 4, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.499 Vali Acc: 0.405 Test Loss: 1.499 Test Acc: 0.405
Validation loss decreased (-0.404564 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 1.336754560470581
Epoch: 5, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.471 Vali Acc: 0.443 Test Loss: 1.471 Test Acc: 0.443
Validation loss decreased (-0.404565 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.2712526321411133
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.449 Vali Acc: 0.466 Test Loss: 1.449 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.2595860958099365
Epoch: 7, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.416 Vali Acc: 0.481 Test Loss: 1.416 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.2862095832824707
Epoch: 8, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.388 Vali Acc: 0.519 Test Loss: 1.388 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.3598251342773438
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.394 Vali Acc: 0.504 Test Loss: 1.394 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2978591918945312
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.377 Vali Acc: 0.489 Test Loss: 1.377 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2627792358398438
Epoch: 11, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 12 cost time: 1.3362476825714111
Epoch: 12, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.386 Vali Acc: 0.519 Test Loss: 1.386 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1820683479309082
Epoch: 13, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5417728424072266
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.470 Vali Acc: 0.519 Test Loss: 1.470 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2691538333892822
Epoch: 15, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3400390148162842
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.485 Vali Acc: 0.527 Test Loss: 1.485 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3314952850341797
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3947343826293945
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3977007865905762
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.526 Vali Acc: 0.527 Test Loss: 1.526 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5279841423034668
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.548 Vali Acc: 0.527 Test Loss: 1.548 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2898588180541992
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.556 Vali Acc: 0.527 Test Loss: 1.556 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 54997
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2050154209136963
Epoch: 1, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.619 Vali Acc: 0.237 Test Loss: 1.619 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.2282376289367676
Epoch: 2, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.572 Vali Acc: 0.405 Test Loss: 1.572 Test Acc: 0.405
Validation loss decreased (-0.236625 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.263148546218872
Epoch: 3, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
Validation loss decreased (-0.404564 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.1406755447387695
Epoch: 4, Steps: 8 | Train Loss: 1.358 Vali Loss: 1.574 Vali Acc: 0.458 Test Loss: 1.574 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.2616057395935059
Epoch: 5, Steps: 8 | Train Loss: 1.171 Vali Loss: 1.539 Vali Acc: 0.450 Test Loss: 1.539 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2699542045593262
Epoch: 6, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.492 Vali Acc: 0.443 Test Loss: 1.492 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4464850425720215
Epoch: 7, Steps: 8 | Train Loss: 0.870 Vali Loss: 1.458 Vali Acc: 0.481 Test Loss: 1.458 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.2783877849578857
Epoch: 8, Steps: 8 | Train Loss: 0.741 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.3092460632324219
Epoch: 9, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.258192539215088
Epoch: 10, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.337 Vali Acc: 0.534 Test Loss: 1.337 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534338).  Saving model ...
Epoch: 11 cost time: 1.3496761322021484
Epoch: 11, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.310 Vali Acc: 0.542 Test Loss: 1.310 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 12 cost time: 1.4085824489593506
Epoch: 12, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.284 Vali Acc: 0.542 Test Loss: 1.284 Test Acc: 0.542
Validation loss decreased (-0.541972 --> -0.541972).  Saving model ...
Epoch: 13 cost time: 1.2356271743774414
Epoch: 13, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.272 Vali Acc: 0.527 Test Loss: 1.272 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2254655361175537
Epoch: 14, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.212956190109253
Epoch: 15, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.264 Vali Acc: 0.542 Test Loss: 1.264 Test Acc: 0.542
Validation loss decreased (-0.541972 --> -0.541972).  Saving model ...
Epoch: 16 cost time: 1.2383029460906982
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.270 Vali Acc: 0.542 Test Loss: 1.270 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2725026607513428
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.275 Vali Acc: 0.550 Test Loss: 1.275 Test Acc: 0.550
Validation loss decreased (-0.541972 --> -0.549606).  Saving model ...
Epoch: 18 cost time: 1.1457171440124512
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.290 Vali Acc: 0.557 Test Loss: 1.290 Test Acc: 0.557
Validation loss decreased (-0.549606 --> -0.557239).  Saving model ...
Epoch: 19 cost time: 1.2078964710235596
Epoch: 19, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.303 Vali Acc: 0.557 Test Loss: 1.303 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.310807228088379
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2049095630645752
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.304 Vali Acc: 0.557 Test Loss: 1.304 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2218458652496338
Epoch: 22, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.319 Vali Acc: 0.550 Test Loss: 1.319 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.426630973815918
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.326 Vali Acc: 0.550 Test Loss: 1.326 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3198297023773193
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.336 Vali Acc: 0.542 Test Loss: 1.336 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2404651641845703
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.338 Vali Acc: 0.542 Test Loss: 1.338 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.260488748550415
Epoch: 26, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.350 Vali Acc: 0.542 Test Loss: 1.350 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2889769077301025
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.355 Vali Acc: 0.542 Test Loss: 1.355 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2553884983062744
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.362 Vali Acc: 0.534 Test Loss: 1.362 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 42997
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3143320083618164
Epoch: 1, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.668 Vali Acc: 0.160 Test Loss: 1.668 Test Acc: 0.160
Validation loss decreased (inf --> -0.160289).  Saving model ...
Epoch: 2 cost time: 1.3724300861358643
Epoch: 2, Steps: 8 | Train Loss: 1.638 Vali Loss: 1.587 Vali Acc: 0.275 Test Loss: 1.587 Test Acc: 0.275
Validation loss decreased (-0.160289 --> -0.274793).  Saving model ...
Epoch: 3 cost time: 1.235774278640747
Epoch: 3, Steps: 8 | Train Loss: 1.468 Vali Loss: 1.551 Vali Acc: 0.412 Test Loss: 1.551 Test Acc: 0.412
Validation loss decreased (-0.274793 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.2518415451049805
Epoch: 4, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.554 Vali Acc: 0.427 Test Loss: 1.554 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.2963542938232422
Epoch: 5, Steps: 8 | Train Loss: 1.223 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3832237720489502
Epoch: 6, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.531 Vali Acc: 0.427 Test Loss: 1.531 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.3510534763336182
Epoch: 7, Steps: 8 | Train Loss: 0.969 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.2924559116363525
Epoch: 8, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.467 Vali Acc: 0.466 Test Loss: 1.467 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.330974817276001
Epoch: 9, Steps: 8 | Train Loss: 0.749 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.302722454071045
Epoch: 10, Steps: 8 | Train Loss: 0.622 Vali Loss: 1.413 Vali Acc: 0.504 Test Loss: 1.413 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 11 cost time: 1.298835039138794
Epoch: 11, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.402 Vali Acc: 0.504 Test Loss: 1.402 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.2533040046691895
Epoch: 12, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 13 cost time: 1.247753620147705
Epoch: 13, Steps: 8 | Train Loss: 0.349 Vali Loss: 1.345 Vali Acc: 0.511 Test Loss: 1.345 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 14 cost time: 1.227524757385254
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.342 Vali Acc: 0.519 Test Loss: 1.342 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519071).  Saving model ...
Epoch: 15 cost time: 1.2798492908477783
Epoch: 15, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.322 Vali Acc: 0.511 Test Loss: 1.322 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2641093730926514
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.311 Vali Acc: 0.519 Test Loss: 1.311 Test Acc: 0.519
Validation loss decreased (-0.519071 --> -0.519071).  Saving model ...
Epoch: 17 cost time: 1.2445456981658936
Epoch: 17, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.316 Vali Acc: 0.527 Test Loss: 1.316 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 18 cost time: 1.318289041519165
Epoch: 18, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.334 Vali Acc: 0.542 Test Loss: 1.334 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 19 cost time: 1.195948600769043
Epoch: 19, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.335 Vali Acc: 0.542 Test Loss: 1.335 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.295358419418335
Epoch: 20, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.323 Vali Acc: 0.542 Test Loss: 1.323 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541972).  Saving model ...
Epoch: 21 cost time: 1.2706167697906494
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.332 Vali Acc: 0.534 Test Loss: 1.332 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.393768310546875
Epoch: 22, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.331 Vali Acc: 0.534 Test Loss: 1.331 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2648506164550781
Epoch: 23, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.331 Vali Acc: 0.534 Test Loss: 1.331 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3064706325531006
Epoch: 24, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.330 Vali Acc: 0.534 Test Loss: 1.330 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2765460014343262
Epoch: 25, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.330 Vali Acc: 0.534 Test Loss: 1.330 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2266104221343994
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.334 Vali Acc: 0.534 Test Loss: 1.334 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3242509365081787
Epoch: 27, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.336 Vali Acc: 0.542 Test Loss: 1.336 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.223890781402588
Epoch: 28, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.334 Vali Acc: 0.542 Test Loss: 1.334 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4328911304473877
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.354 Vali Acc: 0.534 Test Loss: 1.354 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3716115951538086
Epoch: 30, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.362 Vali Acc: 0.542 Test Loss: 1.362 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 43941
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1365435123443604
Epoch: 1, Steps: 8 | Train Loss: 1.685 Vali Loss: 1.598 Vali Acc: 0.305 Test Loss: 1.598 Test Acc: 0.305
Validation loss decreased (inf --> -0.305328).  Saving model ...
Epoch: 2 cost time: 1.179701328277588
Epoch: 2, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.567 Vali Acc: 0.344 Test Loss: 1.567 Test Acc: 0.344
Validation loss decreased (-0.305328 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 1.15309739112854
Epoch: 3, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.549 Vali Acc: 0.351 Test Loss: 1.549 Test Acc: 0.351
Validation loss decreased (-0.343496 --> -0.351130).  Saving model ...
Epoch: 4 cost time: 1.2571861743927002
Epoch: 4, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.548 Vali Acc: 0.382 Test Loss: 1.548 Test Acc: 0.382
Validation loss decreased (-0.351130 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.2676832675933838
Epoch: 5, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
Validation loss decreased (-0.381664 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.1740777492523193
Epoch: 6, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1588943004608154
Epoch: 7, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1664237976074219
Epoch: 8, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.507 Vali Acc: 0.443 Test Loss: 1.507 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.1903221607208252
Epoch: 9, Steps: 8 | Train Loss: 0.739 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 10 cost time: 1.3319892883300781
Epoch: 10, Steps: 8 | Train Loss: 0.638 Vali Loss: 1.481 Vali Acc: 0.443 Test Loss: 1.481 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.2928245067596436
Epoch: 11, Steps: 8 | Train Loss: 0.533 Vali Loss: 1.468 Vali Acc: 0.450 Test Loss: 1.468 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 12 cost time: 1.308523416519165
Epoch: 12, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.458 Vali Acc: 0.489 Test Loss: 1.458 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 1.3069591522216797
Epoch: 13, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.440 Vali Acc: 0.481 Test Loss: 1.440 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2389628887176514
Epoch: 14, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.425 Vali Acc: 0.466 Test Loss: 1.425 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.248368263244629
Epoch: 15, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.435 Vali Acc: 0.473 Test Loss: 1.435 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3243029117584229
Epoch: 16, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.443 Vali Acc: 0.473 Test Loss: 1.443 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3341050148010254
Epoch: 17, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.448 Vali Acc: 0.496 Test Loss: 1.448 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 18 cost time: 1.2520172595977783
Epoch: 18, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.455 Vali Acc: 0.496 Test Loss: 1.455 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.323627233505249
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.454 Vali Acc: 0.504 Test Loss: 1.454 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 20 cost time: 1.2427167892456055
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.446 Vali Acc: 0.511 Test Loss: 1.446 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 21 cost time: 1.329068899154663
Epoch: 21, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.458 Vali Acc: 0.489 Test Loss: 1.458 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2532563209533691
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.482 Vali Acc: 0.489 Test Loss: 1.482 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1815848350524902
Epoch: 23, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1580822467803955
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.507 Vali Acc: 0.489 Test Loss: 1.507 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2488093376159668
Epoch: 25, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.500 Vali Acc: 0.496 Test Loss: 1.500 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2495126724243164
Epoch: 26, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2755351066589355
Epoch: 27, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.497 Vali Acc: 0.511 Test Loss: 1.497 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1695210933685303
Epoch: 28, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.515 Vali Acc: 0.496 Test Loss: 1.515 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2200596332550049
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.521 Vali Acc: 0.504 Test Loss: 1.521 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.33034086227417
Epoch: 30, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.520 Vali Acc: 0.504 Test Loss: 1.520 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 47781
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8514466285705566
Epoch: 1, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.614 Vali Acc: 0.275 Test Loss: 1.614 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.082226276397705
Epoch: 2, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.597 Vali Acc: 0.275 Test Loss: 1.597 Test Acc: 0.275
Validation loss decreased (-0.274793 --> -0.274793).  Saving model ...
Epoch: 3 cost time: 1.343553066253662
Epoch: 3, Steps: 8 | Train Loss: 1.427 Vali Loss: 1.580 Vali Acc: 0.366 Test Loss: 1.580 Test Acc: 0.366
Validation loss decreased (-0.274793 --> -0.366396).  Saving model ...
Epoch: 4 cost time: 1.3602168560028076
Epoch: 4, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.572 Vali Acc: 0.397 Test Loss: 1.572 Test Acc: 0.397
Validation loss decreased (-0.366396 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 1.2441494464874268
Epoch: 5, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.571 Vali Acc: 0.382 Test Loss: 1.571 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3477146625518799
Epoch: 6, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 1.2379462718963623
Epoch: 7, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.567 Vali Acc: 0.443 Test Loss: 1.567 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442732).  Saving model ...
Epoch: 8 cost time: 1.354999303817749
Epoch: 8, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.541 Vali Acc: 0.427 Test Loss: 1.541 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2020392417907715
Epoch: 9, Steps: 8 | Train Loss: 0.631 Vali Loss: 1.527 Vali Acc: 0.435 Test Loss: 1.527 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3608644008636475
Epoch: 10, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450366).  Saving model ...
Epoch: 11 cost time: 1.2412092685699463
Epoch: 11, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.550 Vali Acc: 0.443 Test Loss: 1.550 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.438877820968628
Epoch: 12, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.550 Vali Acc: 0.450 Test Loss: 1.550 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3606972694396973
Epoch: 13, Steps: 8 | Train Loss: 0.358 Vali Loss: 1.537 Vali Acc: 0.458 Test Loss: 1.537 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 14 cost time: 1.226571798324585
Epoch: 14, Steps: 8 | Train Loss: 0.295 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3438310623168945
Epoch: 15, Steps: 8 | Train Loss: 0.244 Vali Loss: 1.560 Vali Acc: 0.466 Test Loss: 1.560 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 16 cost time: 1.3423185348510742
Epoch: 16, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.554 Vali Acc: 0.473 Test Loss: 1.554 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473267).  Saving model ...
Epoch: 17 cost time: 1.3695764541625977
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.554 Vali Acc: 0.466 Test Loss: 1.554 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3864054679870605
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.561 Vali Acc: 0.473 Test Loss: 1.561 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1985857486724854
Epoch: 19, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.591 Vali Acc: 0.473 Test Loss: 1.591 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.232121229171753
Epoch: 20, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.594 Vali Acc: 0.481 Test Loss: 1.594 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480900).  Saving model ...
Epoch: 21 cost time: 1.2665691375732422
Epoch: 21, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.598 Vali Acc: 0.473 Test Loss: 1.598 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2654447555541992
Epoch: 22, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.618 Vali Acc: 0.473 Test Loss: 1.618 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2591593265533447
Epoch: 23, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.638 Vali Acc: 0.466 Test Loss: 1.638 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2880418300628662
Epoch: 24, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.635 Vali Acc: 0.473 Test Loss: 1.635 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3916094303131104
Epoch: 25, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.611 Vali Acc: 0.466 Test Loss: 1.611 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3041365146636963
Epoch: 26, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.626 Vali Acc: 0.458 Test Loss: 1.626 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1445934772491455
Epoch: 27, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.646 Vali Acc: 0.466 Test Loss: 1.646 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.229722023010254
Epoch: 28, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.642 Vali Acc: 0.466 Test Loss: 1.642 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1565072536468506
Epoch: 29, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.637 Vali Acc: 0.466 Test Loss: 1.637 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2174603939056396
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.656 Vali Acc: 0.466 Test Loss: 1.656 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 59285
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.271188259124756
Epoch: 1, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.725 Vali Acc: 0.206 Test Loss: 1.725 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 1.381910800933838
Epoch: 2, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.694 Vali Acc: 0.221 Test Loss: 1.694 Test Acc: 0.221
Validation loss decreased (-0.206090 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.3691613674163818
Epoch: 3, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.658 Vali Acc: 0.290 Test Loss: 1.658 Test Acc: 0.290
Validation loss decreased (-0.221357 --> -0.290060).  Saving model ...
Epoch: 4 cost time: 1.484015703201294
Epoch: 4, Steps: 8 | Train Loss: 1.282 Vali Loss: 1.615 Vali Acc: 0.344 Test Loss: 1.615 Test Acc: 0.344
Validation loss decreased (-0.290060 --> -0.343495).  Saving model ...
Epoch: 5 cost time: 1.2585351467132568
Epoch: 5, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.578 Vali Acc: 0.336 Test Loss: 1.578 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3295702934265137
Epoch: 6, Steps: 8 | Train Loss: 0.902 Vali Loss: 1.534 Vali Acc: 0.382 Test Loss: 1.534 Test Acc: 0.382
Validation loss decreased (-0.343495 --> -0.381664).  Saving model ...
Epoch: 7 cost time: 1.4022340774536133
Epoch: 7, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.498 Vali Acc: 0.382 Test Loss: 1.498 Test Acc: 0.382
Validation loss decreased (-0.381664 --> -0.381664).  Saving model ...
Epoch: 8 cost time: 1.2492022514343262
Epoch: 8, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.475 Vali Acc: 0.427 Test Loss: 1.475 Test Acc: 0.427
Validation loss decreased (-0.381664 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 1.263866901397705
Epoch: 9, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.456 Vali Acc: 0.412 Test Loss: 1.456 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2918787002563477
Epoch: 10, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.448 Vali Acc: 0.405 Test Loss: 1.448 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2424721717834473
Epoch: 11, Steps: 8 | Train Loss: 0.433 Vali Loss: 1.415 Vali Acc: 0.427 Test Loss: 1.415 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427467).  Saving model ...
Epoch: 12 cost time: 1.3298766613006592
Epoch: 12, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.404 Vali Acc: 0.420 Test Loss: 1.404 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3059501647949219
Epoch: 13, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.405 Vali Acc: 0.458 Test Loss: 1.405 Test Acc: 0.458
Validation loss decreased (-0.427467 --> -0.458001).  Saving model ...
Epoch: 14 cost time: 1.2996821403503418
Epoch: 14, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.374 Vali Acc: 0.435 Test Loss: 1.374 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2256965637207031
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.396 Vali Acc: 0.443 Test Loss: 1.396 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2398452758789062
Epoch: 16, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.390 Vali Acc: 0.466 Test Loss: 1.390 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 17 cost time: 1.3632304668426514
Epoch: 17, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.396 Vali Acc: 0.443 Test Loss: 1.396 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3737154006958008
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.380 Vali Acc: 0.443 Test Loss: 1.380 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.20534086227417
Epoch: 19, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.375 Vali Acc: 0.450 Test Loss: 1.375 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3973937034606934
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.382 Vali Acc: 0.458 Test Loss: 1.382 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4293546676635742
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.411 Vali Acc: 0.443 Test Loss: 1.411 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.308016061782837
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.409 Vali Acc: 0.450 Test Loss: 1.409 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3074061870574951
Epoch: 23, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.418 Vali Acc: 0.443 Test Loss: 1.418 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4134013652801514
Epoch: 24, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.426 Vali Acc: 0.435 Test Loss: 1.426 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3296277523040771
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.461 Vali Acc: 0.450 Test Loss: 1.461 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4120352268218994
Epoch: 26, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.477 Vali Acc: 0.443 Test Loss: 1.477 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 71749
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.968869686126709
Epoch: 1, Steps: 8 | Train Loss: 1.825 Vali Loss: 1.735 Vali Acc: 0.137 Test Loss: 1.735 Test Acc: 0.137
Validation loss decreased (inf --> -0.137387).  Saving model ...
Epoch: 2 cost time: 1.3062973022460938
Epoch: 2, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.684 Vali Acc: 0.221 Test Loss: 1.684 Test Acc: 0.221
Validation loss decreased (-0.137387 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.1948320865631104
Epoch: 3, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.623 Vali Acc: 0.267 Test Loss: 1.623 Test Acc: 0.267
Validation loss decreased (-0.221357 --> -0.267159).  Saving model ...
Epoch: 4 cost time: 1.0790526866912842
Epoch: 4, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.574 Vali Acc: 0.336 Test Loss: 1.574 Test Acc: 0.336
Validation loss decreased (-0.267159 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 1.2355329990386963
Epoch: 5, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.551 Vali Acc: 0.366 Test Loss: 1.551 Test Acc: 0.366
Validation loss decreased (-0.335862 --> -0.366397).  Saving model ...
Epoch: 6 cost time: 1.1338121891021729
Epoch: 6, Steps: 8 | Train Loss: 0.942 Vali Loss: 1.534 Vali Acc: 0.366 Test Loss: 1.534 Test Acc: 0.366
Validation loss decreased (-0.366397 --> -0.366397).  Saving model ...
Epoch: 7 cost time: 1.2147374153137207
Epoch: 7, Steps: 8 | Train Loss: 0.784 Vali Loss: 1.530 Vali Acc: 0.359 Test Loss: 1.530 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2316272258758545
Epoch: 8, Steps: 8 | Train Loss: 0.664 Vali Loss: 1.530 Vali Acc: 0.359 Test Loss: 1.530 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2419354915618896
Epoch: 9, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.538 Vali Acc: 0.359 Test Loss: 1.538 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.186143159866333
Epoch: 10, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.536 Vali Acc: 0.389 Test Loss: 1.536 Test Acc: 0.389
Validation loss decreased (-0.366397 --> -0.389298).  Saving model ...
Epoch: 11 cost time: 1.0992624759674072
Epoch: 11, Steps: 8 | Train Loss: 0.396 Vali Loss: 1.533 Vali Acc: 0.366 Test Loss: 1.533 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.204775333404541
Epoch: 12, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.513 Vali Acc: 0.374 Test Loss: 1.513 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.27543306350708
Epoch: 13, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.534 Vali Acc: 0.359 Test Loss: 1.534 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.173851490020752
Epoch: 14, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.527 Vali Acc: 0.351 Test Loss: 1.527 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1487185955047607
Epoch: 15, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.529 Vali Acc: 0.382 Test Loss: 1.529 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.176053762435913
Epoch: 16, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.528 Vali Acc: 0.366 Test Loss: 1.528 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2615633010864258
Epoch: 17, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.555 Vali Acc: 0.374 Test Loss: 1.555 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.388166904449463
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.543 Vali Acc: 0.389 Test Loss: 1.543 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1512961387634277
Epoch: 19, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.556 Vali Acc: 0.397 Test Loss: 1.556 Test Acc: 0.397
Validation loss decreased (-0.389298 --> -0.396931).  Saving model ...
Epoch: 20 cost time: 1.238293170928955
Epoch: 20, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.552 Vali Acc: 0.397 Test Loss: 1.552 Test Acc: 0.397
Validation loss decreased (-0.396931 --> -0.396931).  Saving model ...
Epoch: 21 cost time: 1.2026593685150146
Epoch: 21, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.532 Vali Acc: 0.389 Test Loss: 1.532 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2928533554077148
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.543 Vali Acc: 0.405 Test Loss: 1.543 Test Acc: 0.405
Validation loss decreased (-0.396931 --> -0.404565).  Saving model ...
Epoch: 23 cost time: 1.177314281463623
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.544 Vali Acc: 0.405 Test Loss: 1.544 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1897516250610352
Epoch: 24, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.562 Vali Acc: 0.412 Test Loss: 1.562 Test Acc: 0.412
Validation loss decreased (-0.404565 --> -0.412198).  Saving model ...
Epoch: 25 cost time: 1.1482348442077637
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.564 Vali Acc: 0.397 Test Loss: 1.564 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.311809778213501
Epoch: 26, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.545 Vali Acc: 0.427 Test Loss: 1.545 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 27 cost time: 1.25474214553833
Epoch: 27, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.564 Vali Acc: 0.427 Test Loss: 1.564 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2740321159362793
Epoch: 28, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.581 Vali Acc: 0.405 Test Loss: 1.581 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2818317413330078
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.578 Vali Acc: 0.427 Test Loss: 1.578 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4838769435882568
Epoch: 30, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.575 Vali Acc: 0.427 Test Loss: 1.575 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.224294662475586
Epoch: 31, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.583 Vali Acc: 0.435 Test Loss: 1.583 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 32 cost time: 1.2754113674163818
Epoch: 32, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.586 Vali Acc: 0.420 Test Loss: 1.586 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2112019062042236
Epoch: 33, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.593 Vali Acc: 0.412 Test Loss: 1.593 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1663837432861328
Epoch: 34, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.591 Vali Acc: 0.420 Test Loss: 1.591 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1929888725280762
Epoch: 35, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.620 Vali Acc: 0.443 Test Loss: 1.620 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442732).  Saving model ...
Epoch: 36 cost time: 1.1657371520996094
Epoch: 36, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.642 Vali Acc: 0.427 Test Loss: 1.642 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.135650634765625
Epoch: 37, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.633 Vali Acc: 0.427 Test Loss: 1.633 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2243757247924805
Epoch: 38, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.622 Vali Acc: 0.427 Test Loss: 1.622 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2971305847167969
Epoch: 39, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.624 Vali Acc: 0.435 Test Loss: 1.624 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2537212371826172
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.634 Vali Acc: 0.427 Test Loss: 1.634 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2783520221710205
Epoch: 41, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.631 Vali Acc: 0.443 Test Loss: 1.631 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.2299809455871582
Epoch: 42, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.637 Vali Acc: 0.443 Test Loss: 1.637 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.2419853210449219
Epoch: 43, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.647 Vali Acc: 0.427 Test Loss: 1.647 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2369844913482666
Epoch: 44, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.650 Vali Acc: 0.427 Test Loss: 1.650 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2345705032348633
Epoch: 45, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.648 Vali Acc: 0.420 Test Loss: 1.648 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el3_dm16_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 85653
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4329886436462402
Epoch: 1, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.852 Vali Acc: 0.420 Test Loss: 1.852 Test Acc: 0.420
Validation loss decreased (inf --> -0.419829).  Saving model ...
Epoch: 2 cost time: 1.7141733169555664
Epoch: 2, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.559 Vali Acc: 0.389 Test Loss: 1.559 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.75724458694458
Epoch: 3, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.499 Vali Acc: 0.496 Test Loss: 1.499 Test Acc: 0.496
Validation loss decreased (-0.419829 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.7914001941680908
Epoch: 4, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.523 Vali Acc: 0.511 Test Loss: 1.523 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 1.7001550197601318
Epoch: 5, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.925 Vali Acc: 0.527 Test Loss: 1.925 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526698).  Saving model ...
Epoch: 6 cost time: 1.6175642013549805
Epoch: 6, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.965 Vali Acc: 0.534 Test Loss: 1.965 Test Acc: 0.534
Validation loss decreased (-0.526698 --> -0.534331).  Saving model ...
Epoch: 7 cost time: 1.69484281539917
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.131 Vali Acc: 0.534 Test Loss: 2.131 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6640121936798096
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.084 Vali Acc: 0.519 Test Loss: 2.084 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6130871772766113
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.238 Vali Acc: 0.511 Test Loss: 2.238 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5927183628082275
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.511 Test Loss: 2.274 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7885141372680664
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.253 Vali Acc: 0.527 Test Loss: 2.253 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7403230667114258
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.527 Test Loss: 2.242 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7659096717834473
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.247 Vali Acc: 0.519 Test Loss: 2.247 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8216407299041748
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.251 Vali Acc: 0.519 Test Loss: 2.251 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.515937328338623
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.250 Vali Acc: 0.519 Test Loss: 2.250 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.523927927017212
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.230 Vali Acc: 0.519 Test Loss: 2.230 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 626181
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.259828805923462
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.629 Vali Acc: 0.420 Test Loss: 1.629 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3886768817901611
Epoch: 2, Steps: 8 | Train Loss: 1.301 Vali Loss: 1.573 Vali Acc: 0.443 Test Loss: 1.573 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.4014465808868408
Epoch: 3, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
Validation loss decreased (-0.442732 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.4012973308563232
Epoch: 4, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.3639869689941406
Epoch: 5, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.611 Vali Acc: 0.511 Test Loss: 1.611 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4055981636047363
Epoch: 6, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.552 Vali Acc: 0.504 Test Loss: 1.552 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5478925704956055
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.790 Vali Acc: 0.519 Test Loss: 1.790 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4293444156646729
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.857 Vali Acc: 0.504 Test Loss: 1.857 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3907873630523682
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.511 Test Loss: 1.761 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4081180095672607
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.818 Vali Acc: 0.511 Test Loss: 1.818 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4012293815612793
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.874 Vali Acc: 0.511 Test Loss: 1.874 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.405822515487671
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.912 Vali Acc: 0.504 Test Loss: 1.912 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.346071481704712
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.504 Test Loss: 1.923 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.539994716644287
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.504 Test Loss: 1.915 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 530181
model size : 10.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.041381597518921
Epoch: 1, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5465285778045654
Epoch: 2, Steps: 8 | Train Loss: 1.320 Vali Loss: 1.623 Vali Acc: 0.443 Test Loss: 1.623 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.6144413948059082
Epoch: 3, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.516 Vali Acc: 0.489 Test Loss: 1.516 Test Acc: 0.489
Validation loss decreased (-0.442732 --> -0.488534).  Saving model ...
Epoch: 4 cost time: 1.2639758586883545
Epoch: 4, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.505 Vali Acc: 0.557 Test Loss: 1.505 Test Acc: 0.557
Validation loss decreased (-0.488534 --> -0.557237).  Saving model ...
Epoch: 5 cost time: 1.4488344192504883
Epoch: 5, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.467 Vali Acc: 0.550 Test Loss: 1.467 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.487483263015747
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.594 Vali Acc: 0.534 Test Loss: 1.594 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.649820327758789
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.582 Vali Acc: 0.534 Test Loss: 1.582 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3275127410888672
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.723 Vali Acc: 0.550 Test Loss: 1.723 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.475137710571289
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.790 Vali Acc: 0.550 Test Loss: 1.790 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2666549682617188
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.787 Vali Acc: 0.550 Test Loss: 1.787 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4377226829528809
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.786 Vali Acc: 0.550 Test Loss: 1.786 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.453340768814087
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.816 Vali Acc: 0.550 Test Loss: 1.816 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4551446437835693
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.550 Test Loss: 1.835 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3959784507751465
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 537733
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.378955602645874
Epoch: 1, Steps: 8 | Train Loss: 1.729 Vali Loss: 1.621 Vali Acc: 0.328 Test Loss: 1.621 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 1.5672824382781982
Epoch: 2, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.578 Vali Acc: 0.405 Test Loss: 1.578 Test Acc: 0.405
Validation loss decreased (-0.328228 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.3584058284759521
Epoch: 3, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.533 Vali Acc: 0.450 Test Loss: 1.533 Test Acc: 0.450
Validation loss decreased (-0.404564 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.5087506771087646
Epoch: 4, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.5546422004699707
Epoch: 5, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.3502440452575684
Epoch: 6, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.381066083908081
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6352653503417969
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.603 Vali Acc: 0.496 Test Loss: 1.603 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6059784889221191
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.614 Vali Acc: 0.504 Test Loss: 1.614 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5064020156860352
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.626 Vali Acc: 0.504 Test Loss: 1.626 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.577899694442749
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.656 Vali Acc: 0.504 Test Loss: 1.656 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.721456527709961
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.691 Vali Acc: 0.504 Test Loss: 1.691 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.39296555519104
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.719 Vali Acc: 0.504 Test Loss: 1.719 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6561038494110107
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.739 Vali Acc: 0.504 Test Loss: 1.739 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5019567012786865
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.741 Vali Acc: 0.504 Test Loss: 1.741 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 568453
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2972021102905273
Epoch: 1, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.611 Vali Acc: 0.252 Test Loss: 1.611 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.463181972503662
Epoch: 2, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.559 Vali Acc: 0.374 Test Loss: 1.559 Test Acc: 0.374
Validation loss decreased (-0.251892 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.3728578090667725
Epoch: 3, Steps: 8 | Train Loss: 0.921 Vali Loss: 1.530 Vali Acc: 0.443 Test Loss: 1.530 Test Acc: 0.443
Validation loss decreased (-0.374030 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.3869810104370117
Epoch: 4, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.485 Vali Acc: 0.458 Test Loss: 1.485 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.4924161434173584
Epoch: 5, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.2511615753173828
Epoch: 6, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.509 Vali Acc: 0.504 Test Loss: 1.509 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.3106746673583984
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.519 Vali Acc: 0.489 Test Loss: 1.519 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.441354751586914
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.296820878982544
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3384294509887695
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.585 Vali Acc: 0.489 Test Loss: 1.585 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2158756256103516
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.611 Vali Acc: 0.489 Test Loss: 1.611 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.155632495880127
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.618 Vali Acc: 0.489 Test Loss: 1.618 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3162927627563477
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.631 Vali Acc: 0.489 Test Loss: 1.631 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3689374923706055
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.639 Vali Acc: 0.489 Test Loss: 1.639 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.467773199081421
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.489 Test Loss: 1.644 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3778154850006104
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.652 Vali Acc: 0.489 Test Loss: 1.652 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 660485
model size : 11.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2305760383605957
Epoch: 1, Steps: 8 | Train Loss: 1.695 Vali Loss: 1.624 Vali Acc: 0.290 Test Loss: 1.624 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 0.9866807460784912
Epoch: 2, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.537 Vali Acc: 0.351 Test Loss: 1.537 Test Acc: 0.351
Validation loss decreased (-0.290060 --> -0.351130).  Saving model ...
Epoch: 3 cost time: 1.0805847644805908
Epoch: 3, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.505 Vali Acc: 0.458 Test Loss: 1.505 Test Acc: 0.458
Validation loss decreased (-0.351130 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.0473644733428955
Epoch: 4, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.1483664512634277
Epoch: 5, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.438 Vali Acc: 0.473 Test Loss: 1.438 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1160848140716553
Epoch: 6, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.474 Vali Acc: 0.489 Test Loss: 1.474 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.145874261856079
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.542 Vali Acc: 0.511 Test Loss: 1.542 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511435).  Saving model ...
Epoch: 8 cost time: 1.1179640293121338
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.579 Vali Acc: 0.504 Test Loss: 1.579 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1597063541412354
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.572 Vali Acc: 0.511 Test Loss: 1.572 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2671403884887695
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.578 Vali Acc: 0.511 Test Loss: 1.578 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1204230785369873
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.590 Vali Acc: 0.504 Test Loss: 1.590 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0638504028320312
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.607 Vali Acc: 0.511 Test Loss: 1.607 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4266016483306885
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.621 Vali Acc: 0.511 Test Loss: 1.621 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0898938179016113
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.642 Vali Acc: 0.504 Test Loss: 1.642 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0440537929534912
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.658 Vali Acc: 0.504 Test Loss: 1.658 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9449021816253662
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.666 Vali Acc: 0.504 Test Loss: 1.666 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0429184436798096
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.673 Vali Acc: 0.504 Test Loss: 1.673 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 760197
model size : 11.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0225863456726074
Epoch: 1, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.752 Vali Acc: 0.168 Test Loss: 1.752 Test Acc: 0.168
Validation loss decreased (inf --> -0.167921).  Saving model ...
Epoch: 2 cost time: 1.0417134761810303
Epoch: 2, Steps: 8 | Train Loss: 1.330 Vali Loss: 1.589 Vali Acc: 0.366 Test Loss: 1.589 Test Acc: 0.366
Validation loss decreased (-0.167921 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.0493192672729492
Epoch: 3, Steps: 8 | Train Loss: 0.844 Vali Loss: 1.494 Vali Acc: 0.450 Test Loss: 1.494 Test Acc: 0.450
Validation loss decreased (-0.366396 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.9821336269378662
Epoch: 4, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.469 Vali Acc: 0.489 Test Loss: 1.469 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 0.9614853858947754
Epoch: 5, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.437 Vali Acc: 0.489 Test Loss: 1.437 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 0.8746078014373779
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.1466693878173828
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.481 Vali Acc: 0.542 Test Loss: 1.481 Test Acc: 0.542
Validation loss decreased (-0.496169 --> -0.541970).  Saving model ...
Epoch: 8 cost time: 1.196394443511963
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.514 Vali Acc: 0.542 Test Loss: 1.514 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9929726123809814
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.539 Vali Acc: 0.550 Test Loss: 1.539 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549603).  Saving model ...
Epoch: 10 cost time: 1.0488159656524658
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.550 Vali Acc: 0.542 Test Loss: 1.550 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.01542067527771
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.554 Vali Acc: 0.550 Test Loss: 1.554 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0170753002166748
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.559 Vali Acc: 0.550 Test Loss: 1.559 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0409338474273682
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.568 Vali Acc: 0.550 Test Loss: 1.568 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0665841102600098
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.579 Vali Acc: 0.542 Test Loss: 1.579 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9880177974700928
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.590 Vali Acc: 0.542 Test Loss: 1.590 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1013565063476562
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.603 Vali Acc: 0.542 Test Loss: 1.603 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.117170810699463
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.617 Vali Acc: 0.542 Test Loss: 1.617 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0226774215698242
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.627 Vali Acc: 0.542 Test Loss: 1.627 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0792019367218018
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.636 Vali Acc: 0.542 Test Loss: 1.636 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 871429
model size : 12.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.444821834564209
Epoch: 1, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.669 Vali Acc: 0.389 Test Loss: 1.669 Test Acc: 0.389
Validation loss decreased (inf --> -0.389296).  Saving model ...
Epoch: 2 cost time: 1.3720769882202148
Epoch: 2, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.534 Vali Acc: 0.435 Test Loss: 1.534 Test Acc: 0.435
Validation loss decreased (-0.389296 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.7515809535980225
Epoch: 3, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
Validation loss decreased (-0.435099 --> -0.511435).  Saving model ...
Epoch: 4 cost time: 1.668311595916748
Epoch: 4, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.844 Vali Acc: 0.519 Test Loss: 1.844 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519066).  Saving model ...
Epoch: 5 cost time: 1.87215256690979
Epoch: 5, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.620 Vali Acc: 0.511 Test Loss: 1.620 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.630915641784668
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.938 Vali Acc: 0.519 Test Loss: 1.938 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7957255840301514
Epoch: 7, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.778 Vali Acc: 0.435 Test Loss: 1.778 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7112879753112793
Epoch: 8, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.511 Test Loss: 2.031 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7480103969573975
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.240 Vali Acc: 0.511 Test Loss: 2.240 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8377618789672852
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.186 Vali Acc: 0.511 Test Loss: 2.186 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7525033950805664
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.519 Test Loss: 2.093 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6223392486572266
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.519 Test Loss: 2.055 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7377734184265137
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.519 Test Loss: 2.071 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.639596939086914
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.121 Vali Acc: 0.511 Test Loss: 2.121 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 560389
model size : 10.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3724026679992676
Epoch: 1, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.604 Vali Acc: 0.427 Test Loss: 1.604 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.6132667064666748
Epoch: 2, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.527 Vali Acc: 0.435 Test Loss: 1.527 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.5454168319702148
Epoch: 3, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.374 Vali Acc: 0.466 Test Loss: 1.374 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.5557684898376465
Epoch: 4, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.347 Vali Acc: 0.511 Test Loss: 1.347 Test Acc: 0.511
Validation loss decreased (-0.465635 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.6548082828521729
Epoch: 5, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.475 Vali Acc: 0.519 Test Loss: 1.475 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.7074754238128662
Epoch: 6, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.494 Vali Acc: 0.511 Test Loss: 1.494 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7960827350616455
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7340340614318848
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 1.6344244480133057
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.65614914894104
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.527 Test Loss: 1.718 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.691840410232544
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.527 Test Loss: 1.761 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8207225799560547
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.527 Test Loss: 1.774 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.583404779434204
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.527 Test Loss: 1.766 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5470473766326904
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.527 Test Loss: 1.757 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6934869289398193
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.748 Vali Acc: 0.527 Test Loss: 1.748 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6911892890930176
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.527 Test Loss: 1.775 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7795708179473877
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.527 Test Loss: 1.806 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7417614459991455
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.527 Test Loss: 1.823 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 464389
model size : 10.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5727224349975586
Epoch: 1, Steps: 8 | Train Loss: 1.776 Vali Loss: 1.521 Vali Acc: 0.366 Test Loss: 1.521 Test Acc: 0.366
Validation loss decreased (inf --> -0.366397).  Saving model ...
Epoch: 2 cost time: 1.6906533241271973
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (-0.366397 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.76668381690979
Epoch: 3, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.415 Vali Acc: 0.458 Test Loss: 1.415 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.5587782859802246
Epoch: 4, Steps: 8 | Train Loss: 0.552 Vali Loss: 1.359 Vali Acc: 0.504 Test Loss: 1.359 Test Acc: 0.504
Validation loss decreased (-0.458001 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.6443934440612793
Epoch: 5, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.399 Vali Acc: 0.511 Test Loss: 1.399 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.5927581787109375
Epoch: 6, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.464 Vali Acc: 0.511 Test Loss: 1.464 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7582621574401855
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.526 Vali Acc: 0.550 Test Loss: 1.526 Test Acc: 0.550
Validation loss decreased (-0.511436 --> -0.549603).  Saving model ...
Epoch: 8 cost time: 1.72757887840271
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7614307403564453
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.582 Vali Acc: 0.519 Test Loss: 1.582 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6606855392456055
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.668 Vali Acc: 0.527 Test Loss: 1.668 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7628483772277832
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.527 Test Loss: 1.713 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6095349788665771
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.702 Vali Acc: 0.527 Test Loss: 1.702 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7126729488372803
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.706 Vali Acc: 0.534 Test Loss: 1.706 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7468335628509521
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.715 Vali Acc: 0.534 Test Loss: 1.715 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7341687679290771
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.527 Test Loss: 1.720 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8537354469299316
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.741 Vali Acc: 0.534 Test Loss: 1.741 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.810067892074585
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.741 Vali Acc: 0.527 Test Loss: 1.741 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 471941
model size : 10.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.249277353286743
Epoch: 1, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.646 Vali Acc: 0.305 Test Loss: 1.646 Test Acc: 0.305
Validation loss decreased (inf --> -0.305327).  Saving model ...
Epoch: 2 cost time: 1.5260870456695557
Epoch: 2, Steps: 8 | Train Loss: 1.451 Vali Loss: 1.623 Vali Acc: 0.397 Test Loss: 1.623 Test Acc: 0.397
Validation loss decreased (-0.305327 --> -0.396930).  Saving model ...
Epoch: 3 cost time: 1.3987221717834473
Epoch: 3, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.396930 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.516726016998291
Epoch: 4, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.457 Vali Acc: 0.458 Test Loss: 1.457 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.637923240661621
Epoch: 5, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.418 Vali Acc: 0.504 Test Loss: 1.418 Test Acc: 0.504
Validation loss decreased (-0.458001 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.8269307613372803
Epoch: 6, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.6782493591308594
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.742016315460205
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.565 Vali Acc: 0.534 Test Loss: 1.565 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 1.8205671310424805
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8251316547393799
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.625 Vali Acc: 0.527 Test Loss: 1.625 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7504236698150635
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.672 Vali Acc: 0.534 Test Loss: 1.672 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6722941398620605
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.704 Vali Acc: 0.550 Test Loss: 1.704 Test Acc: 0.550
Validation loss decreased (-0.534335 --> -0.549601).  Saving model ...
Epoch: 13 cost time: 1.7802743911743164
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.695 Vali Acc: 0.550 Test Loss: 1.695 Test Acc: 0.550
Validation loss decreased (-0.549601 --> -0.549601).  Saving model ...
Epoch: 14 cost time: 1.7172963619232178
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.693 Vali Acc: 0.542 Test Loss: 1.693 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7006123065948486
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.705 Vali Acc: 0.542 Test Loss: 1.705 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8923275470733643
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.725 Vali Acc: 0.542 Test Loss: 1.725 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8434581756591797
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.730 Vali Acc: 0.542 Test Loss: 1.730 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7691831588745117
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.542 Test Loss: 1.736 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7802002429962158
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.743 Vali Acc: 0.550 Test Loss: 1.743 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8553414344787598
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.550 Test Loss: 1.753 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5906398296356201
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.550 Test Loss: 1.763 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8889596462249756
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.550 Test Loss: 1.768 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7629873752593994
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.542 Test Loss: 1.774 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 502661
model size : 10.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6483893394470215
Epoch: 1, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.651 Vali Acc: 0.229 Test Loss: 1.651 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.8499963283538818
Epoch: 2, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.542 Vali Acc: 0.382 Test Loss: 1.542 Test Acc: 0.382
Validation loss decreased (-0.228991 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.8440561294555664
Epoch: 3, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.497 Vali Acc: 0.458 Test Loss: 1.497 Test Acc: 0.458
Validation loss decreased (-0.381664 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 2.0692358016967773
Epoch: 4, Steps: 8 | Train Loss: 0.557 Vali Loss: 1.454 Vali Acc: 0.481 Test Loss: 1.454 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.9770784378051758
Epoch: 5, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.449 Vali Acc: 0.496 Test Loss: 1.449 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.7890431880950928
Epoch: 6, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.9889135360717773
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.564 Vali Acc: 0.496 Test Loss: 1.564 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0872061252593994
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.590 Vali Acc: 0.511 Test Loss: 1.590 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6505835056304932
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 1.8011066913604736
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.614 Vali Acc: 0.534 Test Loss: 1.614 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534335).  Saving model ...
Epoch: 11 cost time: 1.8655445575714111
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.637 Vali Acc: 0.534 Test Loss: 1.637 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.620757818222046
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.646 Vali Acc: 0.534 Test Loss: 1.646 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6672163009643555
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.668 Vali Acc: 0.534 Test Loss: 1.668 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.801926851272583
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.684 Vali Acc: 0.534 Test Loss: 1.684 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7513210773468018
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.700 Vali Acc: 0.534 Test Loss: 1.700 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6074910163879395
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.709 Vali Acc: 0.534 Test Loss: 1.709 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8094229698181152
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.712 Vali Acc: 0.534 Test Loss: 1.712 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5641748905181885
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.534 Test Loss: 1.715 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6841602325439453
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.728 Vali Acc: 0.534 Test Loss: 1.728 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6376760005950928
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.737 Vali Acc: 0.534 Test Loss: 1.737 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 594693
model size : 11.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0806262493133545
Epoch: 1, Steps: 8 | Train Loss: 1.688 Vali Loss: 1.635 Vali Acc: 0.260 Test Loss: 1.635 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.2596230506896973
Epoch: 2, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.592 Vali Acc: 0.382 Test Loss: 1.592 Test Acc: 0.382
Validation loss decreased (-0.259526 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 1.253171443939209
Epoch: 3, Steps: 8 | Train Loss: 0.903 Vali Loss: 1.547 Vali Acc: 0.427 Test Loss: 1.547 Test Acc: 0.427
Validation loss decreased (-0.381663 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.2864189147949219
Epoch: 4, Steps: 8 | Train Loss: 0.516 Vali Loss: 1.512 Vali Acc: 0.466 Test Loss: 1.512 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.368028163909912
Epoch: 5, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.507 Vali Acc: 0.466 Test Loss: 1.507 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.3800756931304932
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.527 Vali Acc: 0.473 Test Loss: 1.527 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.2382969856262207
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480900).  Saving model ...
Epoch: 8 cost time: 1.320685863494873
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.609 Vali Acc: 0.489 Test Loss: 1.609 Test Acc: 0.489
Validation loss decreased (-0.480900 --> -0.488534).  Saving model ...
Epoch: 9 cost time: 1.340167760848999
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.633 Vali Acc: 0.489 Test Loss: 1.633 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2682428359985352
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.660 Vali Acc: 0.489 Test Loss: 1.660 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2860703468322754
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.684 Vali Acc: 0.489 Test Loss: 1.684 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.317765712738037
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.704 Vali Acc: 0.489 Test Loss: 1.704 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2611308097839355
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.717 Vali Acc: 0.496 Test Loss: 1.717 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496166).  Saving model ...
Epoch: 14 cost time: 1.2511026859283447
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.720 Vali Acc: 0.489 Test Loss: 1.720 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1278343200683594
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.725 Vali Acc: 0.489 Test Loss: 1.725 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0992164611816406
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.481 Test Loss: 1.728 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2523765563964844
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.731 Vali Acc: 0.481 Test Loss: 1.731 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3816125392913818
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.738 Vali Acc: 0.481 Test Loss: 1.738 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.186945915222168
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.489 Test Loss: 1.748 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2207190990447998
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.755 Vali Acc: 0.489 Test Loss: 1.755 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.193695306777954
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.489 Test Loss: 1.767 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.258995532989502
Epoch: 22, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.489 Test Loss: 1.768 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2691116333007812
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.489 Test Loss: 1.773 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 694405
model size : 11.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3489906787872314
Epoch: 1, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.745 Vali Acc: 0.321 Test Loss: 1.745 Test Acc: 0.321
Validation loss decreased (inf --> -0.320593).  Saving model ...
Epoch: 2 cost time: 1.2185726165771484
Epoch: 2, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.639 Vali Acc: 0.366 Test Loss: 1.639 Test Acc: 0.366
Validation loss decreased (-0.320593 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.3077034950256348
Epoch: 3, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.578 Vali Acc: 0.458 Test Loss: 1.578 Test Acc: 0.458
Validation loss decreased (-0.366396 --> -0.457999).  Saving model ...
Epoch: 4 cost time: 1.2246122360229492
Epoch: 4, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.568 Vali Acc: 0.473 Test Loss: 1.568 Test Acc: 0.473
Validation loss decreased (-0.457999 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.353320598602295
Epoch: 5, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.566 Vali Acc: 0.504 Test Loss: 1.566 Test Acc: 0.504
Validation loss decreased (-0.473267 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.3308441638946533
Epoch: 6, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.565 Vali Acc: 0.489 Test Loss: 1.565 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2901480197906494
Epoch: 7, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.564 Vali Acc: 0.496 Test Loss: 1.564 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.047827959060669
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.578 Vali Acc: 0.511 Test Loss: 1.578 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.1531901359558105
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.609 Vali Acc: 0.504 Test Loss: 1.609 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2846951484680176
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.631 Vali Acc: 0.496 Test Loss: 1.631 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4038951396942139
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.645 Vali Acc: 0.504 Test Loss: 1.645 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3250420093536377
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.653 Vali Acc: 0.496 Test Loss: 1.653 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1392185688018799
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.660 Vali Acc: 0.489 Test Loss: 1.660 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2130372524261475
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.670 Vali Acc: 0.496 Test Loss: 1.670 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2171638011932373
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.496 Test Loss: 1.682 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1874010562896729
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.693 Vali Acc: 0.496 Test Loss: 1.693 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.288478136062622
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.702 Vali Acc: 0.481 Test Loss: 1.702 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0632505416870117
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.711 Vali Acc: 0.481 Test Loss: 1.711 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 805637
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.500648021697998
Epoch: 1, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.744 Vali Acc: 0.420 Test Loss: 1.744 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.6253154277801514
Epoch: 2, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.510 Vali Acc: 0.366 Test Loss: 1.510 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7418365478515625
Epoch: 3, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.491 Vali Acc: 0.504 Test Loss: 1.491 Test Acc: 0.504
Validation loss decreased (-0.419830 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.6292049884796143
Epoch: 4, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.647 Vali Acc: 0.511 Test Loss: 1.647 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511434).  Saving model ...
Epoch: 5 cost time: 1.6352264881134033
Epoch: 5, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.619 Vali Acc: 0.519 Test Loss: 1.619 Test Acc: 0.519
Validation loss decreased (-0.511434 --> -0.519068).  Saving model ...
Epoch: 6 cost time: 1.7729592323303223
Epoch: 6, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.880 Vali Acc: 0.511 Test Loss: 1.880 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9263601303100586
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.834 Vali Acc: 0.504 Test Loss: 1.834 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7355539798736572
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.971 Vali Acc: 0.534 Test Loss: 1.971 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534331).  Saving model ...
Epoch: 9 cost time: 1.759718894958496
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.179 Vali Acc: 0.527 Test Loss: 2.179 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8348653316497803
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.247 Vali Acc: 0.519 Test Loss: 2.247 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7012887001037598
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.183 Vali Acc: 0.519 Test Loss: 2.183 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7172260284423828
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.138 Vali Acc: 0.519 Test Loss: 2.138 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7756783962249756
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.126 Vali Acc: 0.511 Test Loss: 2.126 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.84031343460083
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.519 Test Loss: 2.140 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7106101512908936
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.519 Test Loss: 2.164 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6492271423339844
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.165 Vali Acc: 0.519 Test Loss: 2.165 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8915634155273438
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.519 Test Loss: 2.158 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6891322135925293
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.156 Vali Acc: 0.519 Test Loss: 2.156 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 527493
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6645545959472656
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.553 Vali Acc: 0.336 Test Loss: 1.553 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.6875193119049072
Epoch: 2, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.681 Vali Acc: 0.427 Test Loss: 1.681 Test Acc: 0.427
Validation loss decreased (-0.335862 --> -0.427464).  Saving model ...
Epoch: 3 cost time: 1.6482925415039062
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
Validation loss decreased (-0.427464 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.8083875179290771
Epoch: 4, Steps: 8 | Train Loss: 0.464 Vali Loss: 1.513 Vali Acc: 0.534 Test Loss: 1.513 Test Acc: 0.534
Validation loss decreased (-0.450367 --> -0.534336).  Saving model ...
Epoch: 5 cost time: 1.6467556953430176
Epoch: 5, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549604).  Saving model ...
Epoch: 6 cost time: 1.7086670398712158
Epoch: 6, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6703972816467285
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6618270874023438
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7745068073272705
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.747 Vali Acc: 0.519 Test Loss: 1.747 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6874010562896729
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.764 Vali Acc: 0.534 Test Loss: 1.764 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7671122550964355
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.745 Vali Acc: 0.527 Test Loss: 1.745 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6808807849884033
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.741 Vali Acc: 0.527 Test Loss: 1.741 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.6762402057647705
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.527 Test Loss: 1.749 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6416313648223877
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.527 Test Loss: 1.776 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7049317359924316
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 431493
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.474061965942383
Epoch: 1, Steps: 8 | Train Loss: 1.929 Vali Loss: 1.664 Vali Acc: 0.237 Test Loss: 1.664 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.6716194152832031
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.853 Vali Acc: 0.412 Test Loss: 1.853 Test Acc: 0.412
Validation loss decreased (-0.236625 --> -0.412195).  Saving model ...
Epoch: 3 cost time: 1.4479122161865234
Epoch: 3, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.627 Vali Acc: 0.397 Test Loss: 1.627 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.540900468826294
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.485 Vali Acc: 0.466 Test Loss: 1.485 Test Acc: 0.466
Validation loss decreased (-0.412195 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.5566990375518799
Epoch: 5, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.513 Vali Acc: 0.481 Test Loss: 1.513 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.554744005203247
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.563 Vali Acc: 0.466 Test Loss: 1.563 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5327661037445068
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.710 Vali Acc: 0.519 Test Loss: 1.710 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519067).  Saving model ...
Epoch: 8 cost time: 1.6439597606658936
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.639 Vali Acc: 0.489 Test Loss: 1.639 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.461775302886963
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.680 Vali Acc: 0.496 Test Loss: 1.680 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6504614353179932
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.737 Vali Acc: 0.496 Test Loss: 1.737 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4040656089782715
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.788 Vali Acc: 0.504 Test Loss: 1.788 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.598583459854126
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.803 Vali Acc: 0.511 Test Loss: 1.803 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7033753395080566
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.504 Test Loss: 1.798 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5625176429748535
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.496 Test Loss: 1.785 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6650159358978271
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.792 Vali Acc: 0.496 Test Loss: 1.792 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.653235912322998
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.504 Test Loss: 1.782 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5949885845184326
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.504 Test Loss: 1.797 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 439045
model size : 10.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3412320613861084
Epoch: 1, Steps: 8 | Train Loss: 1.635 Vali Loss: 1.605 Vali Acc: 0.321 Test Loss: 1.605 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 1.5910923480987549
Epoch: 2, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.613 Vali Acc: 0.389 Test Loss: 1.613 Test Acc: 0.389
Validation loss decreased (-0.320595 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.4395983219146729
Epoch: 3, Steps: 8 | Train Loss: 0.979 Vali Loss: 1.539 Vali Acc: 0.435 Test Loss: 1.539 Test Acc: 0.435
Validation loss decreased (-0.389297 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.5976145267486572
Epoch: 4, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.456 Vali Acc: 0.435 Test Loss: 1.456 Test Acc: 0.435
Validation loss decreased (-0.435099 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.6141319274902344
Epoch: 5, Steps: 8 | Train Loss: 0.300 Vali Loss: 1.459 Vali Acc: 0.481 Test Loss: 1.459 Test Acc: 0.481
Validation loss decreased (-0.435100 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.7202658653259277
Epoch: 6, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.436 Vali Acc: 0.489 Test Loss: 1.436 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.4700214862823486
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.461 Vali Acc: 0.489 Test Loss: 1.461 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5465760231018066
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.511 Vali Acc: 0.504 Test Loss: 1.511 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 1.7596750259399414
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.528 Vali Acc: 0.496 Test Loss: 1.528 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6398873329162598
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.545 Vali Acc: 0.489 Test Loss: 1.545 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7004168033599854
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.580 Vali Acc: 0.489 Test Loss: 1.580 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7101051807403564
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.598 Vali Acc: 0.496 Test Loss: 1.598 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8959076404571533
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.504 Test Loss: 1.621 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6899445056915283
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.632 Vali Acc: 0.504 Test Loss: 1.632 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7371950149536133
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.630 Vali Acc: 0.496 Test Loss: 1.630 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7653613090515137
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.496 Test Loss: 1.634 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.535679817199707
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.504 Test Loss: 1.642 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8538868427276611
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.652 Vali Acc: 0.504 Test Loss: 1.652 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 469765
model size : 10.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.489384412765503
Epoch: 1, Steps: 8 | Train Loss: 1.784 Vali Loss: 1.665 Vali Acc: 0.252 Test Loss: 1.665 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.68894624710083
Epoch: 2, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.576 Vali Acc: 0.374 Test Loss: 1.576 Test Acc: 0.374
Validation loss decreased (-0.251892 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.8054559230804443
Epoch: 3, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.578 Vali Acc: 0.481 Test Loss: 1.578 Test Acc: 0.481
Validation loss decreased (-0.374030 --> -0.480900).  Saving model ...
Epoch: 4 cost time: 1.7010188102722168
Epoch: 4, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.501 Vali Acc: 0.481 Test Loss: 1.501 Test Acc: 0.481
Validation loss decreased (-0.480900 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.6561386585235596
Epoch: 5, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.474 Vali Acc: 0.481 Test Loss: 1.474 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.8904855251312256
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.496 Vali Acc: 0.527 Test Loss: 1.496 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.8425109386444092
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.539 Vali Acc: 0.519 Test Loss: 1.539 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.645738124847412
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.562 Vali Acc: 0.511 Test Loss: 1.562 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.753943920135498
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7045159339904785
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.635 Vali Acc: 0.511 Test Loss: 1.635 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7715003490447998
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.672 Vali Acc: 0.511 Test Loss: 1.672 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4539828300476074
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.679 Vali Acc: 0.511 Test Loss: 1.679 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7410142421722412
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.678 Vali Acc: 0.511 Test Loss: 1.678 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8275933265686035
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.689 Vali Acc: 0.511 Test Loss: 1.689 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6109681129455566
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.695 Vali Acc: 0.511 Test Loss: 1.695 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7580735683441162
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.710 Vali Acc: 0.511 Test Loss: 1.710 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 561797
model size : 10.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1168932914733887
Epoch: 1, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.620 Vali Acc: 0.298 Test Loss: 1.620 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.287496566772461
Epoch: 2, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.543 Vali Acc: 0.405 Test Loss: 1.543 Test Acc: 0.405
Validation loss decreased (-0.297694 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.1549708843231201
Epoch: 3, Steps: 8 | Train Loss: 0.891 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
Validation loss decreased (-0.404565 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.337143898010254
Epoch: 4, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.454 Vali Acc: 0.458 Test Loss: 1.454 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.259272813796997
Epoch: 5, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.435 Vali Acc: 0.473 Test Loss: 1.435 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.2788081169128418
Epoch: 6, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.1115844249725342
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.520 Vali Acc: 0.481 Test Loss: 1.520 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0540175437927246
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1896874904632568
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.537 Vali Acc: 0.496 Test Loss: 1.537 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 10 cost time: 1.1309943199157715
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.548 Vali Acc: 0.496 Test Loss: 1.548 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.145129919052124
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.561 Vali Acc: 0.496 Test Loss: 1.561 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4422633647918701
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.580 Vali Acc: 0.489 Test Loss: 1.580 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.305492877960205
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.597 Vali Acc: 0.489 Test Loss: 1.597 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3318727016448975
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.608 Vali Acc: 0.496 Test Loss: 1.608 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3085417747497559
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.615 Vali Acc: 0.496 Test Loss: 1.615 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.214116096496582
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.624 Vali Acc: 0.496 Test Loss: 1.624 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.325321912765503
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.634 Vali Acc: 0.496 Test Loss: 1.634 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.271716594696045
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.496 Test Loss: 1.644 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2768278121948242
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.496 Test Loss: 1.646 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 661509
model size : 11.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2255356311798096
Epoch: 1, Steps: 8 | Train Loss: 1.747 Vali Loss: 1.595 Vali Acc: 0.366 Test Loss: 1.595 Test Acc: 0.366
Validation loss decreased (inf --> -0.366396).  Saving model ...
Epoch: 2 cost time: 1.3856563568115234
Epoch: 2, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.538 Vali Acc: 0.397 Test Loss: 1.538 Test Acc: 0.397
Validation loss decreased (-0.366396 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.2222187519073486
Epoch: 3, Steps: 8 | Train Loss: 0.844 Vali Loss: 1.495 Vali Acc: 0.435 Test Loss: 1.495 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.2502131462097168
Epoch: 4, Steps: 8 | Train Loss: 0.436 Vali Loss: 1.460 Vali Acc: 0.473 Test Loss: 1.460 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.2701232433319092
Epoch: 5, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.467 Vali Acc: 0.450 Test Loss: 1.467 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1780848503112793
Epoch: 6, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.481 Vali Acc: 0.466 Test Loss: 1.481 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.386042833328247
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.519 Vali Acc: 0.458 Test Loss: 1.519 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4318714141845703
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2916975021362305
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.574 Vali Acc: 0.450 Test Loss: 1.574 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2093725204467773
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.595 Vali Acc: 0.450 Test Loss: 1.595 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2015156745910645
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.616 Vali Acc: 0.466 Test Loss: 1.616 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.203308343887329
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.635 Vali Acc: 0.473 Test Loss: 1.635 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2467224597930908
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.647 Vali Acc: 0.473 Test Loss: 1.647 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.211456298828125
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.655 Vali Acc: 0.473 Test Loss: 1.655 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm128_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 772741
model size : 11.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.438188314437866
Epoch: 1, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6604456901550293
Epoch: 2, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.6102001667022705
Epoch: 3, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.456 Vali Acc: 0.489 Test Loss: 1.456 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.6523163318634033
Epoch: 4, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.363 Vali Acc: 0.519 Test Loss: 1.363 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.6041555404663086
Epoch: 5, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.337 Vali Acc: 0.542 Test Loss: 1.337 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541971).  Saving model ...
Epoch: 6 cost time: 1.6041502952575684
Epoch: 6, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.432 Vali Acc: 0.534 Test Loss: 1.432 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6943433284759521
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549603).  Saving model ...
Epoch: 8 cost time: 1.4583196640014648
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.522 Vali Acc: 0.542 Test Loss: 1.522 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6483197212219238
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.718 Vali Acc: 0.550 Test Loss: 1.718 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.656081199645996
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.542 Test Loss: 1.720 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6846668720245361
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.557 Test Loss: 1.693 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557235).  Saving model ...
Epoch: 12 cost time: 1.6223597526550293
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.534 Test Loss: 1.725 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.526665449142456
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.534 Test Loss: 1.755 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6884913444519043
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.542 Test Loss: 1.759 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6870219707489014
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.542 Test Loss: 1.778 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7335515022277832
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.534 Test Loss: 1.757 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7042791843414307
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.534 Test Loss: 1.755 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7017831802368164
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.534 Test Loss: 1.775 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4667670726776123
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.783 Vali Acc: 0.534 Test Loss: 1.783 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5312268733978271
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.534 Test Loss: 1.801 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7401599884033203
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.534 Test Loss: 1.810 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 280581
model size : 5.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.404531240463257
Epoch: 1, Steps: 8 | Train Loss: 1.666 Vali Loss: 1.583 Vali Acc: 0.351 Test Loss: 1.583 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.5958631038665771
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.667 Vali Acc: 0.412 Test Loss: 1.667 Test Acc: 0.412
Validation loss decreased (-0.351129 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.6326754093170166
Epoch: 3, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.545 Vali Acc: 0.366 Test Loss: 1.545 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7502803802490234
Epoch: 4, Steps: 8 | Train Loss: 0.782 Vali Loss: 1.457 Vali Acc: 0.435 Test Loss: 1.457 Test Acc: 0.435
Validation loss decreased (-0.412197 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.5047242641448975
Epoch: 5, Steps: 8 | Train Loss: 0.479 Vali Loss: 1.438 Vali Acc: 0.489 Test Loss: 1.438 Test Acc: 0.489
Validation loss decreased (-0.435100 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.4940698146820068
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.470 Vali Acc: 0.450 Test Loss: 1.470 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4984130859375
Epoch: 7, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.485 Vali Acc: 0.489 Test Loss: 1.485 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.596585988998413
Epoch: 8, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.525 Vali Acc: 0.504 Test Loss: 1.525 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 1.5332014560699463
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.551 Vali Acc: 0.519 Test Loss: 1.551 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 1.528076171875
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.578 Vali Acc: 0.496 Test Loss: 1.578 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4541387557983398
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.637 Vali Acc: 0.504 Test Loss: 1.637 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.448927640914917
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.652 Vali Acc: 0.504 Test Loss: 1.652 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5603837966918945
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.647 Vali Acc: 0.496 Test Loss: 1.647 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5220816135406494
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.652 Vali Acc: 0.496 Test Loss: 1.652 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6027121543884277
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.668 Vali Acc: 0.496 Test Loss: 1.668 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6120238304138184
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.496 Test Loss: 1.687 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.693946361541748
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.699 Vali Acc: 0.496 Test Loss: 1.699 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5211644172668457
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.715 Vali Acc: 0.504 Test Loss: 1.715 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.633669137954712
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.504 Test Loss: 1.718 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 232581
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2894108295440674
Epoch: 1, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.653 Vali Acc: 0.313 Test Loss: 1.653 Test Acc: 0.313
Validation loss decreased (inf --> -0.312961).  Saving model ...
Epoch: 2 cost time: 1.3683357238769531
Epoch: 2, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.640 Vali Acc: 0.389 Test Loss: 1.640 Test Acc: 0.389
Validation loss decreased (-0.312961 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 1.451749563217163
Epoch: 3, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.639 Vali Acc: 0.420 Test Loss: 1.639 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.4293577671051025
Epoch: 4, Steps: 8 | Train Loss: 0.932 Vali Loss: 1.582 Vali Acc: 0.458 Test Loss: 1.582 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.457999).  Saving model ...
Epoch: 5 cost time: 1.5319232940673828
Epoch: 5, Steps: 8 | Train Loss: 0.663 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
Validation loss decreased (-0.457999 --> -0.473267).  Saving model ...
Epoch: 6 cost time: 1.5631475448608398
Epoch: 6, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.5715420246124268
Epoch: 7, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.515 Vali Acc: 0.504 Test Loss: 1.515 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6522936820983887
Epoch: 8, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.576 Vali Acc: 0.504 Test Loss: 1.576 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5082688331604004
Epoch: 9, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.564 Vali Acc: 0.504 Test Loss: 1.564 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5686583518981934
Epoch: 10, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.640 Vali Acc: 0.511 Test Loss: 1.640 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4535183906555176
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.722 Vali Acc: 0.527 Test Loss: 1.722 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526700).  Saving model ...
Epoch: 12 cost time: 1.55006742477417
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.740 Vali Acc: 0.527 Test Loss: 1.740 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4393806457519531
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.728 Vali Acc: 0.511 Test Loss: 1.728 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.430257797241211
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.731 Vali Acc: 0.511 Test Loss: 1.731 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4144089221954346
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.753 Vali Acc: 0.511 Test Loss: 1.753 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5499465465545654
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.779 Vali Acc: 0.519 Test Loss: 1.779 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5674705505371094
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.798 Vali Acc: 0.527 Test Loss: 1.798 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4385948181152344
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.799 Vali Acc: 0.519 Test Loss: 1.799 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.448594570159912
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.805 Vali Acc: 0.527 Test Loss: 1.805 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4038183689117432
Epoch: 20, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.808 Vali Acc: 0.527 Test Loss: 1.808 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3436460494995117
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.800 Vali Acc: 0.519 Test Loss: 1.800 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 236357
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.038822650909424
Epoch: 1, Steps: 8 | Train Loss: 1.779 Vali Loss: 1.752 Vali Acc: 0.206 Test Loss: 1.752 Test Acc: 0.206
Validation loss decreased (inf --> -0.206089).  Saving model ...
Epoch: 2 cost time: 1.1441330909729004
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.609 Vali Acc: 0.382 Test Loss: 1.609 Test Acc: 0.382
Validation loss decreased (-0.206089 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 1.2056820392608643
Epoch: 3, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.2189526557922363
Epoch: 4, Steps: 8 | Train Loss: 0.881 Vali Loss: 1.521 Vali Acc: 0.405 Test Loss: 1.521 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1999351978302002
Epoch: 5, Steps: 8 | Train Loss: 0.613 Vali Loss: 1.469 Vali Acc: 0.427 Test Loss: 1.469 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.2801165580749512
Epoch: 6, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.431 Vali Acc: 0.496 Test Loss: 1.431 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.0518138408660889
Epoch: 7, Steps: 8 | Train Loss: 0.260 Vali Loss: 1.422 Vali Acc: 0.489 Test Loss: 1.422 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1898105144500732
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.446 Vali Acc: 0.496 Test Loss: 1.446 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.150296926498413
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.0827269554138184
Epoch: 10, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.469 Vali Acc: 0.504 Test Loss: 1.469 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2378778457641602
Epoch: 11, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.503 Vali Acc: 0.519 Test Loss: 1.503 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 12 cost time: 1.1016035079956055
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.525 Vali Acc: 0.519 Test Loss: 1.525 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2192401885986328
Epoch: 13, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.550 Vali Acc: 0.519 Test Loss: 1.550 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1211121082305908
Epoch: 14, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.548 Vali Acc: 0.527 Test Loss: 1.548 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 15 cost time: 1.0603358745574951
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1262030601501465
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.556 Vali Acc: 0.534 Test Loss: 1.556 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534336).  Saving model ...
Epoch: 17 cost time: 1.1587095260620117
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.562 Vali Acc: 0.534 Test Loss: 1.562 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2002999782562256
Epoch: 18, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1640870571136475
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2431881427764893
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.578 Vali Acc: 0.534 Test Loss: 1.578 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.160914421081543
Epoch: 21, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.582 Vali Acc: 0.534 Test Loss: 1.582 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1726534366607666
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.583 Vali Acc: 0.534 Test Loss: 1.583 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.184786319732666
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3207666873931885
Epoch: 24, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.594 Vali Acc: 0.542 Test Loss: 1.594 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 25 cost time: 1.2127273082733154
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.599 Vali Acc: 0.542 Test Loss: 1.599 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.150475025177002
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.603 Vali Acc: 0.542 Test Loss: 1.603 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3005480766296387
Epoch: 27, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.608 Vali Acc: 0.542 Test Loss: 1.608 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1572227478027344
Epoch: 28, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.616 Vali Acc: 0.534 Test Loss: 1.616 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1959059238433838
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.611 Vali Acc: 0.542 Test Loss: 1.611 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2335858345031738
Epoch: 30, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.617 Vali Acc: 0.542 Test Loss: 1.617 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2773232460021973
Epoch: 31, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.534 Test Loss: 1.625 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1964235305786133
Epoch: 32, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.628 Vali Acc: 0.542 Test Loss: 1.628 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2682273387908936
Epoch: 33, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.634 Vali Acc: 0.542 Test Loss: 1.634 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1587038040161133
Epoch: 34, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.534 Test Loss: 1.638 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 251717
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8710708618164062
Epoch: 1, Steps: 8 | Train Loss: 1.836 Vali Loss: 1.875 Vali Acc: 0.115 Test Loss: 1.875 Test Acc: 0.115
Validation loss decreased (inf --> -0.114485).  Saving model ...
Epoch: 2 cost time: 1.189958095550537
Epoch: 2, Steps: 8 | Train Loss: 1.617 Vali Loss: 1.726 Vali Acc: 0.214 Test Loss: 1.726 Test Acc: 0.214
Validation loss decreased (-0.114485 --> -0.213723).  Saving model ...
Epoch: 3 cost time: 1.1444778442382812
Epoch: 3, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.651 Vali Acc: 0.344 Test Loss: 1.651 Test Acc: 0.344
Validation loss decreased (-0.213723 --> -0.343495).  Saving model ...
Epoch: 4 cost time: 1.1101341247558594
Epoch: 4, Steps: 8 | Train Loss: 0.894 Vali Loss: 1.623 Vali Acc: 0.443 Test Loss: 1.623 Test Acc: 0.443
Validation loss decreased (-0.343495 --> -0.442732).  Saving model ...
Epoch: 5 cost time: 1.2362267971038818
Epoch: 5, Steps: 8 | Train Loss: 0.618 Vali Loss: 1.590 Vali Acc: 0.466 Test Loss: 1.590 Test Acc: 0.466
Validation loss decreased (-0.442732 --> -0.465633).  Saving model ...
Epoch: 6 cost time: 1.239109992980957
Epoch: 6, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.559 Vali Acc: 0.458 Test Loss: 1.559 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0397429466247559
Epoch: 7, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.567 Vali Acc: 0.458 Test Loss: 1.567 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1339201927185059
Epoch: 8, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.587 Vali Acc: 0.473 Test Loss: 1.587 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.1321463584899902
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.603 Vali Acc: 0.466 Test Loss: 1.603 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.203298568725586
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0895278453826904
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.612 Vali Acc: 0.466 Test Loss: 1.612 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.095918893814087
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.629 Vali Acc: 0.466 Test Loss: 1.629 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1504247188568115
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.646 Vali Acc: 0.458 Test Loss: 1.646 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1665842533111572
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.664 Vali Acc: 0.466 Test Loss: 1.664 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0940053462982178
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.680 Vali Acc: 0.466 Test Loss: 1.680 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.166076421737671
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.698 Vali Acc: 0.473 Test Loss: 1.698 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0214974880218506
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.701 Vali Acc: 0.473 Test Loss: 1.701 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1901912689208984
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.707 Vali Acc: 0.466 Test Loss: 1.707 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 297733
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.978022813796997
Epoch: 1, Steps: 8 | Train Loss: 1.800 Vali Loss: 1.694 Vali Acc: 0.229 Test Loss: 1.694 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.2274529933929443
Epoch: 2, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.627 Vali Acc: 0.221 Test Loss: 1.627 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.231311321258545
Epoch: 3, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.547 Vali Acc: 0.397 Test Loss: 1.547 Test Acc: 0.397
Validation loss decreased (-0.228991 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.2989163398742676
Epoch: 4, Steps: 8 | Train Loss: 0.797 Vali Loss: 1.487 Vali Acc: 0.420 Test Loss: 1.487 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.1165263652801514
Epoch: 5, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.436 Vali Acc: 0.458 Test Loss: 1.436 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.2255520820617676
Epoch: 6, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.411 Vali Acc: 0.443 Test Loss: 1.411 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.192429542541504
Epoch: 7, Steps: 8 | Train Loss: 0.217 Vali Loss: 1.420 Vali Acc: 0.443 Test Loss: 1.420 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2729308605194092
Epoch: 8, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.437 Vali Acc: 0.443 Test Loss: 1.437 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2066400051116943
Epoch: 9, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.450 Vali Acc: 0.466 Test Loss: 1.450 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.2408246994018555
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.457 Vali Acc: 0.458 Test Loss: 1.457 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2603180408477783
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.474 Vali Acc: 0.458 Test Loss: 1.474 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2106971740722656
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.492 Vali Acc: 0.489 Test Loss: 1.492 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 1.1954152584075928
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.510 Vali Acc: 0.481 Test Loss: 1.510 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9735610485076904
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.524 Vali Acc: 0.496 Test Loss: 1.524 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 15 cost time: 1.2342321872711182
Epoch: 15, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.534 Vali Acc: 0.496 Test Loss: 1.534 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1296675205230713
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.548 Vali Acc: 0.496 Test Loss: 1.548 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.318110466003418
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.558 Vali Acc: 0.496 Test Loss: 1.558 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1267619132995605
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.567 Vali Acc: 0.496 Test Loss: 1.567 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1127469539642334
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.576 Vali Acc: 0.496 Test Loss: 1.576 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0597262382507324
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.580 Vali Acc: 0.489 Test Loss: 1.580 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0924947261810303
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.586 Vali Acc: 0.489 Test Loss: 1.586 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0483243465423584
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.599 Vali Acc: 0.473 Test Loss: 1.599 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2367885112762451
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.610 Vali Acc: 0.473 Test Loss: 1.610 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2404258251190186
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.619 Vali Acc: 0.473 Test Loss: 1.619 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 347589
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.086840867996216
Epoch: 1, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.579 Vali Acc: 0.275 Test Loss: 1.579 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.2226841449737549
Epoch: 2, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.551 Vali Acc: 0.351 Test Loss: 1.551 Test Acc: 0.351
Validation loss decreased (-0.274793 --> -0.351130).  Saving model ...
Epoch: 3 cost time: 1.1729588508605957
Epoch: 3, Steps: 8 | Train Loss: 1.071 Vali Loss: 1.519 Vali Acc: 0.466 Test Loss: 1.519 Test Acc: 0.466
Validation loss decreased (-0.351130 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.1437323093414307
Epoch: 4, Steps: 8 | Train Loss: 0.699 Vali Loss: 1.519 Vali Acc: 0.435 Test Loss: 1.519 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.246302604675293
Epoch: 5, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.508 Vali Acc: 0.435 Test Loss: 1.508 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1609885692596436
Epoch: 6, Steps: 8 | Train Loss: 0.285 Vali Loss: 1.486 Vali Acc: 0.435 Test Loss: 1.486 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2297892570495605
Epoch: 7, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1544427871704102
Epoch: 8, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.501 Vali Acc: 0.473 Test Loss: 1.501 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.3637645244598389
Epoch: 9, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.508 Vali Acc: 0.435 Test Loss: 1.508 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.191875696182251
Epoch: 10, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.526 Vali Acc: 0.450 Test Loss: 1.526 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.109710454940796
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.538 Vali Acc: 0.473 Test Loss: 1.538 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0900452136993408
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.562 Vali Acc: 0.489 Test Loss: 1.562 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 13 cost time: 1.2533886432647705
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.584 Vali Acc: 0.496 Test Loss: 1.584 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496167).  Saving model ...
Epoch: 14 cost time: 1.2776107788085938
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.598 Vali Acc: 0.481 Test Loss: 1.598 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.359682321548462
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.605 Vali Acc: 0.473 Test Loss: 1.605 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1535544395446777
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.605 Vali Acc: 0.481 Test Loss: 1.605 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3044860363006592
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.612 Vali Acc: 0.473 Test Loss: 1.612 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2790989875793457
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.624 Vali Acc: 0.473 Test Loss: 1.624 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1814935207366943
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.632 Vali Acc: 0.473 Test Loss: 1.632 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1539442539215088
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.645 Vali Acc: 0.481 Test Loss: 1.645 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2107396125793457
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.656 Vali Acc: 0.481 Test Loss: 1.656 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2302772998809814
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.666 Vali Acc: 0.473 Test Loss: 1.666 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2177402973175049
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.675 Vali Acc: 0.466 Test Loss: 1.675 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 403205
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.326622486114502
Epoch: 1, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.690 Vali Acc: 0.420 Test Loss: 1.690 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.5659193992614746
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.587 Vali Acc: 0.427 Test Loss: 1.587 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.453129529953003
Epoch: 3, Steps: 8 | Train Loss: 1.033 Vali Loss: 1.471 Vali Acc: 0.450 Test Loss: 1.471 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.3993725776672363
Epoch: 4, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
Validation loss decreased (-0.450367 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.5598781108856201
Epoch: 5, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.562 Vali Acc: 0.527 Test Loss: 1.562 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4933562278747559
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.437 Vali Acc: 0.489 Test Loss: 1.437 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5445683002471924
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.883 Vali Acc: 0.519 Test Loss: 1.883 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.504704475402832
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.674 Vali Acc: 0.504 Test Loss: 1.674 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.50071382522583
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.619 Vali Acc: 0.496 Test Loss: 1.619 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5268075466156006
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.799 Vali Acc: 0.504 Test Loss: 1.799 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5773026943206787
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.904 Vali Acc: 0.519 Test Loss: 1.904 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7184185981750488
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.519 Test Loss: 1.873 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5497243404388428
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.834 Vali Acc: 0.519 Test Loss: 1.834 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6559727191925049
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.511 Test Loss: 1.810 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 247557
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2926666736602783
Epoch: 1, Steps: 8 | Train Loss: 1.736 Vali Loss: 1.608 Vali Acc: 0.252 Test Loss: 1.608 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.4232025146484375
Epoch: 2, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.558 Vali Acc: 0.412 Test Loss: 1.558 Test Acc: 0.412
Validation loss decreased (-0.251892 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.5140206813812256
Epoch: 3, Steps: 8 | Train Loss: 1.102 Vali Loss: 1.476 Vali Acc: 0.412 Test Loss: 1.476 Test Acc: 0.412
Validation loss decreased (-0.412198 --> -0.412199).  Saving model ...
Epoch: 4 cost time: 1.6339566707611084
Epoch: 4, Steps: 8 | Train Loss: 0.730 Vali Loss: 1.448 Vali Acc: 0.458 Test Loss: 1.448 Test Acc: 0.458
Validation loss decreased (-0.412199 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.685537338256836
Epoch: 5, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.5263159275054932
Epoch: 6, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.403 Vali Acc: 0.473 Test Loss: 1.403 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.672818899154663
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.6863291263580322
Epoch: 8, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.410 Vali Acc: 0.473 Test Loss: 1.410 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.559185266494751
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.466 Vali Acc: 0.511 Test Loss: 1.466 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6000945568084717
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.557 Vali Acc: 0.527 Test Loss: 1.557 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6502845287322998
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.561 Vali Acc: 0.527 Test Loss: 1.561 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.746408462524414
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.529 Vali Acc: 0.519 Test Loss: 1.529 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.601257085800171
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5782103538513184
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.574 Vali Acc: 0.519 Test Loss: 1.574 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4753732681274414
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.599 Vali Acc: 0.511 Test Loss: 1.599 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6243467330932617
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.618 Vali Acc: 0.511 Test Loss: 1.618 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5293638706207275
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.636 Vali Acc: 0.511 Test Loss: 1.636 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 199557
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.134138345718384
Epoch: 1, Steps: 8 | Train Loss: 1.719 Vali Loss: 1.653 Vali Acc: 0.305 Test Loss: 1.653 Test Acc: 0.305
Validation loss decreased (inf --> -0.305327).  Saving model ...
Epoch: 2 cost time: 1.6156411170959473
Epoch: 2, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.631 Vali Acc: 0.382 Test Loss: 1.631 Test Acc: 0.382
Validation loss decreased (-0.305327 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 1.4528231620788574
Epoch: 3, Steps: 8 | Train Loss: 1.203 Vali Loss: 1.630 Vali Acc: 0.443 Test Loss: 1.630 Test Acc: 0.443
Validation loss decreased (-0.381663 --> -0.442732).  Saving model ...
Epoch: 4 cost time: 1.4997546672821045
Epoch: 4, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.554 Vali Acc: 0.443 Test Loss: 1.554 Test Acc: 0.443
Validation loss decreased (-0.442732 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.5687642097473145
Epoch: 5, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.540 Vali Acc: 0.450 Test Loss: 1.540 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.4920902252197266
Epoch: 6, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.507 Vali Acc: 0.496 Test Loss: 1.507 Test Acc: 0.496
Validation loss decreased (-0.450366 --> -0.496168).  Saving model ...
Epoch: 7 cost time: 1.6072115898132324
Epoch: 7, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.531 Vali Acc: 0.519 Test Loss: 1.531 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.415597915649414
Epoch: 8, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.624 Vali Acc: 0.511 Test Loss: 1.624 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4116380214691162
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.576 Vali Acc: 0.519 Test Loss: 1.576 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6908667087554932
Epoch: 10, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.635 Vali Acc: 0.511 Test Loss: 1.635 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.51837158203125
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.745 Vali Acc: 0.519 Test Loss: 1.745 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6045515537261963
Epoch: 12, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.728 Vali Acc: 0.511 Test Loss: 1.728 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5106873512268066
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.730 Vali Acc: 0.511 Test Loss: 1.730 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5912470817565918
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.734 Vali Acc: 0.519 Test Loss: 1.734 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5451319217681885
Epoch: 15, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.769 Vali Acc: 0.511 Test Loss: 1.769 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5939257144927979
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.803 Vali Acc: 0.511 Test Loss: 1.803 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.48114013671875
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.821 Vali Acc: 0.511 Test Loss: 1.821 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 203333
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9456119537353516
Epoch: 1, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.713 Vali Acc: 0.252 Test Loss: 1.713 Test Acc: 0.252
Validation loss decreased (inf --> -0.251891).  Saving model ...
Epoch: 2 cost time: 1.1363935470581055
Epoch: 2, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.617 Vali Acc: 0.313 Test Loss: 1.617 Test Acc: 0.313
Validation loss decreased (-0.251891 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.262537956237793
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.602 Vali Acc: 0.389 Test Loss: 1.602 Test Acc: 0.389
Validation loss decreased (-0.312961 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.1890184879302979
Epoch: 4, Steps: 8 | Train Loss: 0.896 Vali Loss: 1.563 Vali Acc: 0.427 Test Loss: 1.563 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 1.1522905826568604
Epoch: 5, Steps: 8 | Train Loss: 0.630 Vali Loss: 1.494 Vali Acc: 0.435 Test Loss: 1.494 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.1748111248016357
Epoch: 6, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.475 Vali Acc: 0.481 Test Loss: 1.475 Test Acc: 0.481
Validation loss decreased (-0.435100 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.1441972255706787
Epoch: 7, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.182676076889038
Epoch: 8, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.460 Vali Acc: 0.489 Test Loss: 1.460 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 1.2302515506744385
Epoch: 9, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1467561721801758
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.473 Vali Acc: 0.496 Test Loss: 1.473 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 11 cost time: 1.1271367073059082
Epoch: 11, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.512 Vali Acc: 0.511 Test Loss: 1.512 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511435).  Saving model ...
Epoch: 12 cost time: 0.9971370697021484
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.547 Vali Acc: 0.511 Test Loss: 1.547 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9694933891296387
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.553 Vali Acc: 0.511 Test Loss: 1.553 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0647518634796143
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1031434535980225
Epoch: 15, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.573 Vali Acc: 0.504 Test Loss: 1.573 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0499181747436523
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.590 Vali Acc: 0.504 Test Loss: 1.590 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1332430839538574
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.605 Vali Acc: 0.511 Test Loss: 1.605 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1098017692565918
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1472961902618408
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.623 Vali Acc: 0.504 Test Loss: 1.623 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1756184101104736
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.634 Vali Acc: 0.504 Test Loss: 1.634 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.211820125579834
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.635 Vali Acc: 0.511 Test Loss: 1.635 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 218693
model size : 5.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.907630205154419
Epoch: 1, Steps: 8 | Train Loss: 1.665 Vali Loss: 1.653 Vali Acc: 0.237 Test Loss: 1.653 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 1.3389856815338135
Epoch: 2, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.607 Vali Acc: 0.359 Test Loss: 1.607 Test Acc: 0.359
Validation loss decreased (-0.236625 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 1.165353536605835
Epoch: 3, Steps: 8 | Train Loss: 1.138 Vali Loss: 1.591 Vali Acc: 0.374 Test Loss: 1.591 Test Acc: 0.374
Validation loss decreased (-0.358763 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 1.150977373123169
Epoch: 4, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.582 Vali Acc: 0.412 Test Loss: 1.582 Test Acc: 0.412
Validation loss decreased (-0.374030 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.2088310718536377
Epoch: 5, Steps: 8 | Train Loss: 0.615 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.1476774215698242
Epoch: 6, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.1768677234649658
Epoch: 7, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.506 Vali Acc: 0.466 Test Loss: 1.506 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.3272700309753418
Epoch: 8, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.518 Vali Acc: 0.473 Test Loss: 1.518 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.184265375137329
Epoch: 9, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.523 Vali Acc: 0.489 Test Loss: 1.523 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 1.1890480518341064
Epoch: 10, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.540 Vali Acc: 0.489 Test Loss: 1.540 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1449799537658691
Epoch: 11, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.571 Vali Acc: 0.481 Test Loss: 1.571 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.079303503036499
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.596 Vali Acc: 0.489 Test Loss: 1.596 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1743109226226807
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.604 Vali Acc: 0.504 Test Loss: 1.604 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 14 cost time: 1.3021349906921387
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.615 Vali Acc: 0.511 Test Loss: 1.615 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511434).  Saving model ...
Epoch: 15 cost time: 1.460667371749878
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.620 Vali Acc: 0.504 Test Loss: 1.620 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2907891273498535
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.634 Vali Acc: 0.496 Test Loss: 1.634 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2548725605010986
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.642 Vali Acc: 0.504 Test Loss: 1.642 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4380009174346924
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.657 Vali Acc: 0.504 Test Loss: 1.657 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.475635051727295
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.660 Vali Acc: 0.519 Test Loss: 1.660 Test Acc: 0.519
Validation loss decreased (-0.511434 --> -0.519067).  Saving model ...
Epoch: 20 cost time: 1.4284234046936035
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.668 Vali Acc: 0.534 Test Loss: 1.668 Test Acc: 0.534
Validation loss decreased (-0.519067 --> -0.534334).  Saving model ...
Epoch: 21 cost time: 1.5190694332122803
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6148929595947266
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.693 Vali Acc: 0.527 Test Loss: 1.693 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.56544828414917
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.694 Vali Acc: 0.527 Test Loss: 1.694 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3519690036773682
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.703 Vali Acc: 0.519 Test Loss: 1.703 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3970146179199219
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.706 Vali Acc: 0.519 Test Loss: 1.706 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.449247121810913
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.713 Vali Acc: 0.511 Test Loss: 1.713 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5874881744384766
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.722 Vali Acc: 0.511 Test Loss: 1.722 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4515290260314941
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.519 Test Loss: 1.728 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5906617641448975
Epoch: 29, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.732 Vali Acc: 0.519 Test Loss: 1.732 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4012188911437988
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.742 Vali Acc: 0.534 Test Loss: 1.742 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 264709
model size : 5.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8850042819976807
Epoch: 1, Steps: 8 | Train Loss: 1.723 Vali Loss: 1.600 Vali Acc: 0.267 Test Loss: 1.600 Test Acc: 0.267
Validation loss decreased (inf --> -0.267160).  Saving model ...
Epoch: 2 cost time: 0.9950821399688721
Epoch: 2, Steps: 8 | Train Loss: 1.501 Vali Loss: 1.540 Vali Acc: 0.351 Test Loss: 1.540 Test Acc: 0.351
Validation loss decreased (-0.267160 --> -0.351130).  Saving model ...
Epoch: 3 cost time: 1.1790363788604736
Epoch: 3, Steps: 8 | Train Loss: 1.135 Vali Loss: 1.486 Vali Acc: 0.382 Test Loss: 1.486 Test Acc: 0.382
Validation loss decreased (-0.351130 --> -0.381665).  Saving model ...
Epoch: 4 cost time: 1.214184284210205
Epoch: 4, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.450 Vali Acc: 0.412 Test Loss: 1.450 Test Acc: 0.412
Validation loss decreased (-0.381665 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 1.121802568435669
Epoch: 5, Steps: 8 | Train Loss: 0.516 Vali Loss: 1.419 Vali Acc: 0.450 Test Loss: 1.419 Test Acc: 0.450
Validation loss decreased (-0.412199 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.2807893753051758
Epoch: 6, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.388 Vali Acc: 0.489 Test Loss: 1.388 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488536).  Saving model ...
Epoch: 7 cost time: 1.123476505279541
Epoch: 7, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.386 Vali Acc: 0.473 Test Loss: 1.386 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.039168119430542
Epoch: 8, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.404 Vali Acc: 0.496 Test Loss: 1.404 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.2682363986968994
Epoch: 9, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.419 Vali Acc: 0.504 Test Loss: 1.419 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 10 cost time: 1.156233787536621
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.436 Vali Acc: 0.504 Test Loss: 1.436 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0911345481872559
Epoch: 11, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.458 Vali Acc: 0.504 Test Loss: 1.458 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1979708671569824
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.23561692237854
Epoch: 13, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.485 Vali Acc: 0.496 Test Loss: 1.485 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1354377269744873
Epoch: 14, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.492 Vali Acc: 0.504 Test Loss: 1.492 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1741938591003418
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.499 Vali Acc: 0.496 Test Loss: 1.499 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1900017261505127
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.510 Vali Acc: 0.504 Test Loss: 1.510 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1198723316192627
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511435).  Saving model ...
Epoch: 18 cost time: 1.1482183933258057
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.532 Vali Acc: 0.519 Test Loss: 1.532 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 19 cost time: 1.1429178714752197
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.530 Vali Acc: 0.511 Test Loss: 1.530 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1003196239471436
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.542 Vali Acc: 0.511 Test Loss: 1.542 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.03171706199646
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.547 Vali Acc: 0.511 Test Loss: 1.547 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0094282627105713
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.557 Vali Acc: 0.511 Test Loss: 1.557 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.057906150817871
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.567 Vali Acc: 0.511 Test Loss: 1.567 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.163341999053955
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.575 Vali Acc: 0.511 Test Loss: 1.575 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1193358898162842
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.584 Vali Acc: 0.511 Test Loss: 1.584 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0653061866760254
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0624747276306152
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.594 Vali Acc: 0.511 Test Loss: 1.594 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.122744083404541
Epoch: 28, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.598 Vali Acc: 0.511 Test Loss: 1.598 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 314565
model size : 5.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.899066686630249
Epoch: 1, Steps: 8 | Train Loss: 1.757 Vali Loss: 1.643 Vali Acc: 0.191 Test Loss: 1.643 Test Acc: 0.191
Validation loss decreased (inf --> -0.190823).  Saving model ...
Epoch: 2 cost time: 1.0897252559661865
Epoch: 2, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.572 Vali Acc: 0.313 Test Loss: 1.572 Test Acc: 0.313
Validation loss decreased (-0.190823 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.1344847679138184
Epoch: 3, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.514 Vali Acc: 0.412 Test Loss: 1.514 Test Acc: 0.412
Validation loss decreased (-0.312961 --> -0.412199).  Saving model ...
Epoch: 4 cost time: 1.2398319244384766
Epoch: 4, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.459 Vali Acc: 0.435 Test Loss: 1.459 Test Acc: 0.435
Validation loss decreased (-0.412199 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.1493122577667236
Epoch: 5, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.418 Vali Acc: 0.466 Test Loss: 1.418 Test Acc: 0.466
Validation loss decreased (-0.435100 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 1.21791410446167
Epoch: 6, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.396 Vali Acc: 0.466 Test Loss: 1.396 Test Acc: 0.466
Validation loss decreased (-0.465635 --> -0.465635).  Saving model ...
Epoch: 7 cost time: 1.0234553813934326
Epoch: 7, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.422 Vali Acc: 0.466 Test Loss: 1.422 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0058753490447998
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.402 Vali Acc: 0.473 Test Loss: 1.402 Test Acc: 0.473
Validation loss decreased (-0.465635 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 1.2137939929962158
Epoch: 9, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.405 Vali Acc: 0.481 Test Loss: 1.405 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.0676019191741943
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.423 Vali Acc: 0.466 Test Loss: 1.423 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0781116485595703
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.445 Vali Acc: 0.450 Test Loss: 1.445 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1254489421844482
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1244966983795166
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1276648044586182
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.477 Vali Acc: 0.466 Test Loss: 1.477 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0818555355072021
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.480 Vali Acc: 0.466 Test Loss: 1.480 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0866482257843018
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.494 Vali Acc: 0.466 Test Loss: 1.494 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.381784439086914
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.509 Vali Acc: 0.466 Test Loss: 1.509 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3337085247039795
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.523 Vali Acc: 0.466 Test Loss: 1.523 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3560371398925781
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.527 Vali Acc: 0.466 Test Loss: 1.527 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 370181
model size : 5.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3179843425750732
Epoch: 1, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.733 Vali Acc: 0.420 Test Loss: 1.733 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.4614484310150146
Epoch: 2, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.634 Vali Acc: 0.443 Test Loss: 1.634 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.4181735515594482
Epoch: 3, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.431 Vali Acc: 0.481 Test Loss: 1.431 Test Acc: 0.481
Validation loss decreased (-0.442732 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.515791654586792
Epoch: 4, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.475 Vali Acc: 0.527 Test Loss: 1.475 Test Acc: 0.527
Validation loss decreased (-0.480902 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.5626270771026611
Epoch: 5, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.435 Vali Acc: 0.557 Test Loss: 1.435 Test Acc: 0.557
Validation loss decreased (-0.526703 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 1.4124457836151123
Epoch: 6, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3029546737670898
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.604 Vali Acc: 0.550 Test Loss: 1.604 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.42462158203125
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.692 Vali Acc: 0.527 Test Loss: 1.692 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.45589017868042
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.799 Vali Acc: 0.534 Test Loss: 1.799 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5023019313812256
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.845 Vali Acc: 0.557 Test Loss: 1.845 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4677228927612305
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.857 Vali Acc: 0.550 Test Loss: 1.857 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5675427913665771
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.819 Vali Acc: 0.542 Test Loss: 1.819 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4866971969604492
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.542 Test Loss: 1.808 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3398711681365967
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.542 Test Loss: 1.807 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.46616530418396
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.527 Test Loss: 1.830 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 231045
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.941256284713745
Epoch: 1, Steps: 8 | Train Loss: 1.639 Vali Loss: 1.629 Vali Acc: 0.282 Test Loss: 1.629 Test Acc: 0.282
Validation loss decreased (inf --> -0.282426).  Saving model ...
Epoch: 2 cost time: 1.3369061946868896
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.635 Vali Acc: 0.427 Test Loss: 1.635 Test Acc: 0.427
Validation loss decreased (-0.282426 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.2116806507110596
Epoch: 3, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.521 Vali Acc: 0.435 Test Loss: 1.521 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.3054494857788086
Epoch: 4, Steps: 8 | Train Loss: 0.757 Vali Loss: 1.430 Vali Acc: 0.504 Test Loss: 1.430 Test Acc: 0.504
Validation loss decreased (-0.435099 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 1.5759594440460205
Epoch: 5, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.395 Vali Acc: 0.496 Test Loss: 1.395 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.514477252960205
Epoch: 6, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.4129726886749268
Epoch: 7, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.379 Vali Acc: 0.542 Test Loss: 1.379 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541971).  Saving model ...
Epoch: 8 cost time: 1.3251912593841553
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.473 Vali Acc: 0.542 Test Loss: 1.473 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5356464385986328
Epoch: 9, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.506 Vali Acc: 0.534 Test Loss: 1.506 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4103963375091553
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.536 Vali Acc: 0.534 Test Loss: 1.536 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3322160243988037
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.578 Vali Acc: 0.534 Test Loss: 1.578 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3514955043792725
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.577 Vali Acc: 0.534 Test Loss: 1.577 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3977842330932617
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.609 Vali Acc: 0.534 Test Loss: 1.609 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3037192821502686
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.646 Vali Acc: 0.542 Test Loss: 1.646 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3200347423553467
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5186941623687744
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.642 Vali Acc: 0.534 Test Loss: 1.642 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3419060707092285
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 183045
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2590651512145996
Epoch: 1, Steps: 8 | Train Loss: 1.771 Vali Loss: 1.599 Vali Acc: 0.351 Test Loss: 1.599 Test Acc: 0.351
Validation loss decreased (inf --> -0.351129).  Saving model ...
Epoch: 2 cost time: 1.4117681980133057
Epoch: 2, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.608 Vali Acc: 0.397 Test Loss: 1.608 Test Acc: 0.397
Validation loss decreased (-0.351129 --> -0.396930).  Saving model ...
Epoch: 3 cost time: 1.3023128509521484
Epoch: 3, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.594 Vali Acc: 0.405 Test Loss: 1.594 Test Acc: 0.405
Validation loss decreased (-0.396930 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.3477435111999512
Epoch: 4, Steps: 8 | Train Loss: 0.897 Vali Loss: 1.528 Vali Acc: 0.450 Test Loss: 1.528 Test Acc: 0.450
Validation loss decreased (-0.404564 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.2504308223724365
Epoch: 5, Steps: 8 | Train Loss: 0.642 Vali Loss: 1.497 Vali Acc: 0.496 Test Loss: 1.497 Test Acc: 0.496
Validation loss decreased (-0.450366 --> -0.496168).  Saving model ...
Epoch: 6 cost time: 1.3123154640197754
Epoch: 6, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3288779258728027
Epoch: 7, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.511 Vali Acc: 0.481 Test Loss: 1.511 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3437995910644531
Epoch: 8, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.495 Vali Acc: 0.481 Test Loss: 1.495 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3988368511199951
Epoch: 9, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.633 Vali Acc: 0.511 Test Loss: 1.633 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511434).  Saving model ...
Epoch: 10 cost time: 1.3506085872650146
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.600 Vali Acc: 0.504 Test Loss: 1.600 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3805904388427734
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.619 Vali Acc: 0.504 Test Loss: 1.619 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3022029399871826
Epoch: 12, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.667 Vali Acc: 0.534 Test Loss: 1.667 Test Acc: 0.534
Validation loss decreased (-0.511434 --> -0.534334).  Saving model ...
Epoch: 13 cost time: 1.3011448383331299
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.700 Vali Acc: 0.519 Test Loss: 1.700 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3921802043914795
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.733 Vali Acc: 0.519 Test Loss: 1.733 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3257439136505127
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.732 Vali Acc: 0.534 Test Loss: 1.732 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5290658473968506
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.727 Vali Acc: 0.542 Test Loss: 1.727 Test Acc: 0.542
Validation loss decreased (-0.534334 --> -0.541967).  Saving model ...
Epoch: 17 cost time: 1.281468152999878
Epoch: 17, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.720 Vali Acc: 0.534 Test Loss: 1.720 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.52976655960083
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.726 Vali Acc: 0.534 Test Loss: 1.726 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3059649467468262
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.751 Vali Acc: 0.542 Test Loss: 1.751 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4465386867523193
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.766 Vali Acc: 0.542 Test Loss: 1.766 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.442136287689209
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.787 Vali Acc: 0.542 Test Loss: 1.787 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4901092052459717
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.796 Vali Acc: 0.542 Test Loss: 1.796 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.491356611251831
Epoch: 23, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.798 Vali Acc: 0.542 Test Loss: 1.798 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4466962814331055
Epoch: 24, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.534 Test Loss: 1.793 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3318874835968018
Epoch: 25, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.534 Test Loss: 1.799 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4504289627075195
Epoch: 26, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.803 Vali Acc: 0.534 Test Loss: 1.803 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 186821
model size : 5.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.794064521789551
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.709 Vali Acc: 0.321 Test Loss: 1.709 Test Acc: 0.321
Validation loss decreased (inf --> -0.320594).  Saving model ...
Epoch: 2 cost time: 1.1699192523956299
Epoch: 2, Steps: 8 | Train Loss: 1.464 Vali Loss: 1.694 Vali Acc: 0.382 Test Loss: 1.694 Test Acc: 0.382
Validation loss decreased (-0.320594 --> -0.381662).  Saving model ...
Epoch: 3 cost time: 1.1552941799163818
Epoch: 3, Steps: 8 | Train Loss: 1.179 Vali Loss: 1.672 Vali Acc: 0.420 Test Loss: 1.672 Test Acc: 0.420
Validation loss decreased (-0.381662 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.0794482231140137
Epoch: 4, Steps: 8 | Train Loss: 0.883 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.457999).  Saving model ...
Epoch: 5 cost time: 1.1973254680633545
Epoch: 5, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.558 Vali Acc: 0.504 Test Loss: 1.558 Test Acc: 0.504
Validation loss decreased (-0.457999 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.2184135913848877
Epoch: 6, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.19588041305542
Epoch: 7, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.489 Vali Acc: 0.481 Test Loss: 1.489 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2078938484191895
Epoch: 8, Steps: 8 | Train Loss: 0.153 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2493045330047607
Epoch: 9, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.498 Vali Acc: 0.481 Test Loss: 1.498 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.165510892868042
Epoch: 10, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.536 Vali Acc: 0.489 Test Loss: 1.536 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2445926666259766
Epoch: 11, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0983660221099854
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.570 Vali Acc: 0.489 Test Loss: 1.570 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2193331718444824
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.564 Vali Acc: 0.489 Test Loss: 1.564 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1855459213256836
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.559 Vali Acc: 0.496 Test Loss: 1.559 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2695093154907227
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.573 Vali Acc: 0.496 Test Loss: 1.573 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2083535194396973
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.589 Vali Acc: 0.496 Test Loss: 1.589 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 202181
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1015262603759766
Epoch: 1, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.711 Vali Acc: 0.214 Test Loss: 1.711 Test Acc: 0.214
Validation loss decreased (inf --> -0.213723).  Saving model ...
Epoch: 2 cost time: 1.2414605617523193
Epoch: 2, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.637 Vali Acc: 0.298 Test Loss: 1.637 Test Acc: 0.298
Validation loss decreased (-0.213723 --> -0.297694).  Saving model ...
Epoch: 3 cost time: 1.216040849685669
Epoch: 3, Steps: 8 | Train Loss: 1.154 Vali Loss: 1.613 Vali Acc: 0.389 Test Loss: 1.613 Test Acc: 0.389
Validation loss decreased (-0.297694 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.1628589630126953
Epoch: 4, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.585 Vali Acc: 0.435 Test Loss: 1.585 Test Acc: 0.435
Validation loss decreased (-0.389297 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.2920560836791992
Epoch: 5, Steps: 8 | Train Loss: 0.584 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2820768356323242
Epoch: 6, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.550 Vali Acc: 0.427 Test Loss: 1.550 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1830835342407227
Epoch: 7, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.532 Vali Acc: 0.473 Test Loss: 1.532 Test Acc: 0.473
Validation loss decreased (-0.435099 --> -0.473267).  Saving model ...
Epoch: 8 cost time: 1.210233449935913
Epoch: 8, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.524 Vali Acc: 0.466 Test Loss: 1.524 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.793123722076416
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.564 Vali Acc: 0.489 Test Loss: 1.564 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 1.3603785037994385
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.578 Vali Acc: 0.496 Test Loss: 1.578 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496167).  Saving model ...
Epoch: 11 cost time: 1.3104040622711182
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.595 Vali Acc: 0.489 Test Loss: 1.595 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2531421184539795
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.595 Vali Acc: 0.489 Test Loss: 1.595 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2669792175292969
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.602 Vali Acc: 0.481 Test Loss: 1.602 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.332993507385254
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.614 Vali Acc: 0.481 Test Loss: 1.614 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2913460731506348
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.640 Vali Acc: 0.504 Test Loss: 1.640 Test Acc: 0.504
Validation loss decreased (-0.496167 --> -0.503800).  Saving model ...
Epoch: 16 cost time: 1.1435835361480713
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.658 Vali Acc: 0.504 Test Loss: 1.658 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2730576992034912
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.671 Vali Acc: 0.489 Test Loss: 1.671 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2777817249298096
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.680 Vali Acc: 0.481 Test Loss: 1.680 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.203902006149292
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.682 Vali Acc: 0.481 Test Loss: 1.682 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0328044891357422
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.689 Vali Acc: 0.489 Test Loss: 1.689 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2604072093963623
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.699 Vali Acc: 0.489 Test Loss: 1.699 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.159620761871338
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.708 Vali Acc: 0.496 Test Loss: 1.708 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2171998023986816
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.718 Vali Acc: 0.496 Test Loss: 1.718 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1535446643829346
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.729 Vali Acc: 0.489 Test Loss: 1.729 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.174480676651001
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.735 Vali Acc: 0.489 Test Loss: 1.735 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 248197
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.947456121444702
Epoch: 1, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.769 Vali Acc: 0.160 Test Loss: 1.769 Test Acc: 0.160
Validation loss decreased (inf --> -0.160288).  Saving model ...
Epoch: 2 cost time: 1.2601566314697266
Epoch: 2, Steps: 8 | Train Loss: 1.523 Vali Loss: 1.630 Vali Acc: 0.221 Test Loss: 1.630 Test Acc: 0.221
Validation loss decreased (-0.160288 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 1.2864625453948975
Epoch: 3, Steps: 8 | Train Loss: 1.121 Vali Loss: 1.535 Vali Acc: 0.359 Test Loss: 1.535 Test Acc: 0.359
Validation loss decreased (-0.221358 --> -0.358763).  Saving model ...
Epoch: 4 cost time: 1.2843339443206787
Epoch: 4, Steps: 8 | Train Loss: 0.788 Vali Loss: 1.504 Vali Acc: 0.427 Test Loss: 1.504 Test Acc: 0.427
Validation loss decreased (-0.358763 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.3501262664794922
Epoch: 5, Steps: 8 | Train Loss: 0.534 Vali Loss: 1.492 Vali Acc: 0.458 Test Loss: 1.492 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.373232126235962
Epoch: 6, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.467 Vali Acc: 0.481 Test Loss: 1.467 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 7 cost time: 1.1655683517456055
Epoch: 7, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.470 Vali Acc: 0.504 Test Loss: 1.470 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.210216760635376
Epoch: 8, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.478 Vali Acc: 0.489 Test Loss: 1.478 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.371241569519043
Epoch: 9, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.512 Vali Acc: 0.504 Test Loss: 1.512 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.303938627243042
Epoch: 10, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.530 Vali Acc: 0.504 Test Loss: 1.530 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.377779483795166
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.555 Vali Acc: 0.511 Test Loss: 1.555 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 12 cost time: 1.1102540493011475
Epoch: 12, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0507481098175049
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.568 Vali Acc: 0.504 Test Loss: 1.568 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3206312656402588
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.578 Vali Acc: 0.504 Test Loss: 1.578 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.211000919342041
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.595 Vali Acc: 0.504 Test Loss: 1.595 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2993707656860352
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.605 Vali Acc: 0.504 Test Loss: 1.605 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.400026559829712
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.618 Vali Acc: 0.511 Test Loss: 1.618 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1924142837524414
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.634 Vali Acc: 0.511 Test Loss: 1.634 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2135279178619385
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.640 Vali Acc: 0.511 Test Loss: 1.640 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3134584426879883
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.643 Vali Acc: 0.511 Test Loss: 1.643 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2965214252471924
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.655 Vali Acc: 0.511 Test Loss: 1.655 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 298053
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.208977222442627
Epoch: 1, Steps: 8 | Train Loss: 1.675 Vali Loss: 1.612 Vali Acc: 0.214 Test Loss: 1.612 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.132603406906128
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.540 Vali Acc: 0.282 Test Loss: 1.540 Test Acc: 0.282
Validation loss decreased (-0.213724 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.2339470386505127
Epoch: 3, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.464 Vali Acc: 0.405 Test Loss: 1.464 Test Acc: 0.405
Validation loss decreased (-0.282427 --> -0.404566).  Saving model ...
Epoch: 4 cost time: 1.2367708683013916
Epoch: 4, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.432 Vali Acc: 0.450 Test Loss: 1.432 Test Acc: 0.450
Validation loss decreased (-0.404566 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.249138593673706
Epoch: 5, Steps: 8 | Train Loss: 0.422 Vali Loss: 1.414 Vali Acc: 0.481 Test Loss: 1.414 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.3213050365447998
Epoch: 6, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.2356135845184326
Epoch: 7, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.097609281539917
Epoch: 8, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.429 Vali Acc: 0.534 Test Loss: 1.429 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.1958799362182617
Epoch: 9, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.458 Vali Acc: 0.550 Test Loss: 1.458 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 1.3053734302520752
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.477 Vali Acc: 0.542 Test Loss: 1.477 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.206125020980835
Epoch: 11, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.494 Vali Acc: 0.534 Test Loss: 1.494 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.282430648803711
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.506 Vali Acc: 0.534 Test Loss: 1.506 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.333099126815796
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.540 Vali Acc: 0.542 Test Loss: 1.540 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2032866477966309
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.552 Vali Acc: 0.534 Test Loss: 1.552 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.274470329284668
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.556 Vali Acc: 0.534 Test Loss: 1.556 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3960561752319336
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3185553550720215
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.579 Vali Acc: 0.534 Test Loss: 1.579 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3095676898956299
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.581 Vali Acc: 0.542 Test Loss: 1.581 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.489351749420166
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.594 Vali Acc: 0.542 Test Loss: 1.594 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm64_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 353669
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6604042053222656
Epoch: 1, Steps: 8 | Train Loss: 1.724 Vali Loss: 1.613 Vali Acc: 0.359 Test Loss: 1.613 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.4941470623016357
Epoch: 2, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.664 Vali Acc: 0.412 Test Loss: 1.664 Test Acc: 0.412
Validation loss decreased (-0.358763 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.4136605262756348
Epoch: 3, Steps: 8 | Train Loss: 1.268 Vali Loss: 1.576 Vali Acc: 0.382 Test Loss: 1.576 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4569149017333984
Epoch: 4, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.518 Vali Acc: 0.435 Test Loss: 1.518 Test Acc: 0.435
Validation loss decreased (-0.412197 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.407097339630127
Epoch: 5, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.497 Vali Acc: 0.489 Test Loss: 1.497 Test Acc: 0.489
Validation loss decreased (-0.435099 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.3595633506774902
Epoch: 6, Steps: 8 | Train Loss: 0.395 Vali Loss: 1.468 Vali Acc: 0.511 Test Loss: 1.468 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.4715089797973633
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.481 Vali Acc: 0.511 Test Loss: 1.481 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.313509464263916
Epoch: 8, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.473 Vali Acc: 0.527 Test Loss: 1.473 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.3966944217681885
Epoch: 9, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.624 Vali Acc: 0.527 Test Loss: 1.624 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4499239921569824
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.639 Vali Acc: 0.527 Test Loss: 1.639 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3166825771331787
Epoch: 11, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.568 Vali Acc: 0.527 Test Loss: 1.568 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.258502721786499
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.642 Vali Acc: 0.534 Test Loss: 1.642 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534335).  Saving model ...
Epoch: 13 cost time: 1.2891347408294678
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.710 Vali Acc: 0.519 Test Loss: 1.710 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3223042488098145
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.718 Vali Acc: 0.519 Test Loss: 1.718 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.358799934387207
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.719 Vali Acc: 0.519 Test Loss: 1.719 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2304332256317139
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.740 Vali Acc: 0.519 Test Loss: 1.740 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.427600383758545
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.740 Vali Acc: 0.519 Test Loss: 1.740 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4542255401611328
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.734 Vali Acc: 0.527 Test Loss: 1.734 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4245166778564453
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.729 Vali Acc: 0.527 Test Loss: 1.729 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.373755693435669
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.755 Vali Acc: 0.527 Test Loss: 1.755 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.250868558883667
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.765 Vali Acc: 0.527 Test Loss: 1.765 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.321178913116455
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.527 Test Loss: 1.773 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 132357
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.252667188644409
Epoch: 1, Steps: 8 | Train Loss: 1.712 Vali Loss: 1.596 Vali Acc: 0.282 Test Loss: 1.596 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.3485651016235352
Epoch: 2, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.584 Vali Acc: 0.397 Test Loss: 1.584 Test Acc: 0.397
Validation loss decreased (-0.282427 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 1.190955638885498
Epoch: 3, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.623 Vali Acc: 0.397 Test Loss: 1.623 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.438762903213501
Epoch: 4, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.535 Vali Acc: 0.443 Test Loss: 1.535 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.3295557498931885
Epoch: 5, Steps: 8 | Train Loss: 0.845 Vali Loss: 1.497 Vali Acc: 0.450 Test Loss: 1.497 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.4602880477905273
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
Validation loss decreased (-0.450367 --> -0.496168).  Saving model ...
Epoch: 7 cost time: 1.4362661838531494
Epoch: 7, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.441 Vali Acc: 0.473 Test Loss: 1.441 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4116413593292236
Epoch: 8, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.439 Vali Acc: 0.519 Test Loss: 1.439 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.3983371257781982
Epoch: 9, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.408 Vali Acc: 0.519 Test Loss: 1.408 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.3931605815887451
Epoch: 10, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.410 Vali Acc: 0.534 Test Loss: 1.410 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.426419973373413
Epoch: 11, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.381 Vali Acc: 0.542 Test Loss: 1.381 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.4932169914245605
Epoch: 12, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.416 Vali Acc: 0.557 Test Loss: 1.416 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 13 cost time: 1.485809087753296
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.450 Vali Acc: 0.550 Test Loss: 1.450 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.509669542312622
Epoch: 14, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.451 Vali Acc: 0.550 Test Loss: 1.451 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4587647914886475
Epoch: 15, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.470 Vali Acc: 0.557 Test Loss: 1.470 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.346517562866211
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.452 Vali Acc: 0.557 Test Loss: 1.452 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4202580451965332
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.462 Vali Acc: 0.557 Test Loss: 1.462 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4529342651367188
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.465 Vali Acc: 0.557 Test Loss: 1.465 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4311890602111816
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.462 Vali Acc: 0.557 Test Loss: 1.462 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3823902606964111
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.464 Vali Acc: 0.557 Test Loss: 1.464 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4614531993865967
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.463 Vali Acc: 0.557 Test Loss: 1.463 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2416291236877441
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.473 Vali Acc: 0.557 Test Loss: 1.473 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 108357
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.119398593902588
Epoch: 1, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.647 Vali Acc: 0.328 Test Loss: 1.647 Test Acc: 0.328
Validation loss decreased (inf --> -0.328228).  Saving model ...
Epoch: 2 cost time: 1.2617883682250977
Epoch: 2, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.624 Vali Acc: 0.366 Test Loss: 1.624 Test Acc: 0.366
Validation loss decreased (-0.328228 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 1.1569595336914062
Epoch: 3, Steps: 8 | Train Loss: 1.284 Vali Loss: 1.624 Vali Acc: 0.405 Test Loss: 1.624 Test Acc: 0.405
Validation loss decreased (-0.366396 --> -0.404564).  Saving model ...
Epoch: 4 cost time: 1.3779311180114746
Epoch: 4, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.55116868019104
Epoch: 5, Steps: 8 | Train Loss: 0.897 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.408111572265625
Epoch: 6, Steps: 8 | Train Loss: 0.694 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 7 cost time: 1.2991044521331787
Epoch: 7, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.451 Vali Acc: 0.450 Test Loss: 1.451 Test Acc: 0.450
Validation loss decreased (-0.419833 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.2812435626983643
Epoch: 8, Steps: 8 | Train Loss: 0.389 Vali Loss: 1.421 Vali Acc: 0.466 Test Loss: 1.421 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 9 cost time: 1.2729206085205078
Epoch: 9, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.386 Vali Acc: 0.458 Test Loss: 1.386 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.356034278869629
Epoch: 10, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 11 cost time: 1.3777179718017578
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.414 Vali Acc: 0.466 Test Loss: 1.414 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4195444583892822
Epoch: 12, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.421 Vali Acc: 0.481 Test Loss: 1.421 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2631282806396484
Epoch: 13, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.223332405090332
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.453 Vali Acc: 0.496 Test Loss: 1.453 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 15 cost time: 1.3037381172180176
Epoch: 15, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.446 Vali Acc: 0.511 Test Loss: 1.446 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 16 cost time: 1.1967816352844238
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.475 Vali Acc: 0.511 Test Loss: 1.475 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3337266445159912
Epoch: 17, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.480 Vali Acc: 0.511 Test Loss: 1.480 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2575373649597168
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2636585235595703
Epoch: 19, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.481 Vali Acc: 0.511 Test Loss: 1.481 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3447253704071045
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.497 Vali Acc: 0.504 Test Loss: 1.497 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4412670135498047
Epoch: 21, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.530 Vali Acc: 0.511 Test Loss: 1.530 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2521874904632568
Epoch: 22, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2723746299743652
Epoch: 23, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.531 Vali Acc: 0.511 Test Loss: 1.531 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2248952388763428
Epoch: 24, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3628406524658203
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.517 Vali Acc: 0.504 Test Loss: 1.517 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 110245
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1698286533355713
Epoch: 1, Steps: 8 | Train Loss: 1.731 Vali Loss: 1.580 Vali Acc: 0.321 Test Loss: 1.580 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 1.2719240188598633
Epoch: 2, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.521 Vali Acc: 0.405 Test Loss: 1.521 Test Acc: 0.405
Validation loss decreased (-0.320595 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.264622449874878
Epoch: 3, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.502 Vali Acc: 0.405 Test Loss: 1.502 Test Acc: 0.405
Validation loss decreased (-0.404565 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.2519323825836182
Epoch: 4, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.509 Vali Acc: 0.450 Test Loss: 1.509 Test Acc: 0.450
Validation loss decreased (-0.404565 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.2093298435211182
Epoch: 5, Steps: 8 | Train Loss: 0.871 Vali Loss: 1.493 Vali Acc: 0.466 Test Loss: 1.493 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.3137564659118652
Epoch: 6, Steps: 8 | Train Loss: 0.724 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 1.4362962245941162
Epoch: 7, Steps: 8 | Train Loss: 0.562 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.1993963718414307
Epoch: 8, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 0.9921610355377197
Epoch: 9, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.0911636352539062
Epoch: 10, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.0932068824768066
Epoch: 11, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.250786304473877
Epoch: 12, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3036794662475586
Epoch: 13, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.450 Vali Acc: 0.519 Test Loss: 1.450 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.299835205078125
Epoch: 14, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3890230655670166
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3523755073547363
Epoch: 16, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.455 Vali Acc: 0.511 Test Loss: 1.455 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.235708236694336
Epoch: 17, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.467 Vali Acc: 0.519 Test Loss: 1.467 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.330986738204956
Epoch: 18, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.488 Vali Acc: 0.527 Test Loss: 1.488 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 19 cost time: 1.2119243144989014
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3655436038970947
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.503 Vali Acc: 0.519 Test Loss: 1.503 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3180499076843262
Epoch: 21, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.551008701324463
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.505 Vali Acc: 0.511 Test Loss: 1.505 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3392882347106934
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2842962741851807
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.207090139389038
Epoch: 25, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0824151039123535
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.530 Vali Acc: 0.519 Test Loss: 1.530 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.212754487991333
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.535 Vali Acc: 0.519 Test Loss: 1.535 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.239069938659668
Epoch: 28, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.548 Vali Acc: 0.519 Test Loss: 1.548 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 117925
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.246025562286377
Epoch: 1, Steps: 8 | Train Loss: 1.875 Vali Loss: 1.682 Vali Acc: 0.221 Test Loss: 1.682 Test Acc: 0.221
Validation loss decreased (inf --> -0.221357).  Saving model ...
Epoch: 2 cost time: 1.1549043655395508
Epoch: 2, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.606 Vali Acc: 0.221 Test Loss: 1.606 Test Acc: 0.221
Validation loss decreased (-0.221357 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 1.2508301734924316
Epoch: 3, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.546 Vali Acc: 0.366 Test Loss: 1.546 Test Acc: 0.366
Validation loss decreased (-0.221358 --> -0.366397).  Saving model ...
Epoch: 4 cost time: 0.9901363849639893
Epoch: 4, Steps: 8 | Train Loss: 1.093 Vali Loss: 1.504 Vali Acc: 0.412 Test Loss: 1.504 Test Acc: 0.412
Validation loss decreased (-0.366397 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 1.0598416328430176
Epoch: 5, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.470 Vali Acc: 0.466 Test Loss: 1.470 Test Acc: 0.466
Validation loss decreased (-0.412199 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.137939691543579
Epoch: 6, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.329709768295288
Epoch: 7, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.432 Vali Acc: 0.489 Test Loss: 1.432 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.1988325119018555
Epoch: 8, Steps: 8 | Train Loss: 0.392 Vali Loss: 1.417 Vali Acc: 0.466 Test Loss: 1.417 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2551672458648682
Epoch: 9, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488536).  Saving model ...
Epoch: 10 cost time: 1.2083117961883545
Epoch: 10, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.399 Vali Acc: 0.496 Test Loss: 1.399 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.299058437347412
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.395 Vali Acc: 0.504 Test Loss: 1.395 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 12 cost time: 1.238091230392456
Epoch: 12, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2465696334838867
Epoch: 13, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.438 Vali Acc: 0.504 Test Loss: 1.438 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3535809516906738
Epoch: 14, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.445 Vali Acc: 0.504 Test Loss: 1.445 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2298150062561035
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.451 Vali Acc: 0.504 Test Loss: 1.451 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2284858226776123
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.437 Vali Acc: 0.519 Test Loss: 1.437 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 17 cost time: 1.2733945846557617
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.448 Vali Acc: 0.504 Test Loss: 1.448 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2810709476470947
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.460 Vali Acc: 0.504 Test Loss: 1.460 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2396938800811768
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.467 Vali Acc: 0.504 Test Loss: 1.467 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1851065158843994
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.482 Vali Acc: 0.511 Test Loss: 1.482 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1916289329528809
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.494 Vali Acc: 0.511 Test Loss: 1.494 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2640767097473145
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.500 Vali Acc: 0.511 Test Loss: 1.500 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2421379089355469
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.493 Vali Acc: 0.519 Test Loss: 1.493 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1953413486480713
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.498 Vali Acc: 0.519 Test Loss: 1.498 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1493370532989502
Epoch: 25, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 26 cost time: 1.165616512298584
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.515 Vali Acc: 0.504 Test Loss: 1.515 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3627939224243164
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.526 Vali Acc: 0.504 Test Loss: 1.526 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.302875280380249
Epoch: 28, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.522 Vali Acc: 0.519 Test Loss: 1.522 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.227583885192871
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.521 Vali Acc: 0.519 Test Loss: 1.521 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.233222246170044
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.536 Vali Acc: 0.504 Test Loss: 1.536 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1630949974060059
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.543 Vali Acc: 0.519 Test Loss: 1.543 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.018193006515503
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.545 Vali Acc: 0.519 Test Loss: 1.545 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2461133003234863
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.562 Vali Acc: 0.519 Test Loss: 1.562 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1776857376098633
Epoch: 34, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.564 Vali Acc: 0.519 Test Loss: 1.564 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.271580457687378
Epoch: 35, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.571 Vali Acc: 0.519 Test Loss: 1.571 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 140933
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7715249061584473
Epoch: 1, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.835 Vali Acc: 0.153 Test Loss: 1.835 Test Acc: 0.153
Validation loss decreased (inf --> -0.152653).  Saving model ...
Epoch: 2 cost time: 1.1280410289764404
Epoch: 2, Steps: 8 | Train Loss: 1.603 Vali Loss: 1.753 Vali Acc: 0.221 Test Loss: 1.753 Test Acc: 0.221
Validation loss decreased (-0.152653 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.002558708190918
Epoch: 3, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.692 Vali Acc: 0.267 Test Loss: 1.692 Test Acc: 0.267
Validation loss decreased (-0.221357 --> -0.267159).  Saving model ...
Epoch: 4 cost time: 1.1691830158233643
Epoch: 4, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.636 Vali Acc: 0.328 Test Loss: 1.636 Test Acc: 0.328
Validation loss decreased (-0.267159 --> -0.328228).  Saving model ...
Epoch: 5 cost time: 1.1294572353363037
Epoch: 5, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.601 Vali Acc: 0.389 Test Loss: 1.601 Test Acc: 0.389
Validation loss decreased (-0.328228 --> -0.389297).  Saving model ...
Epoch: 6 cost time: 1.091461420059204
Epoch: 6, Steps: 8 | Train Loss: 0.640 Vali Loss: 1.561 Vali Acc: 0.427 Test Loss: 1.561 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427465).  Saving model ...
Epoch: 7 cost time: 1.1435291767120361
Epoch: 7, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.534 Vali Acc: 0.435 Test Loss: 1.534 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 8 cost time: 1.2745018005371094
Epoch: 8, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450366).  Saving model ...
Epoch: 9 cost time: 1.1661953926086426
Epoch: 9, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.520 Vali Acc: 0.458 Test Loss: 1.520 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 0.9888813495635986
Epoch: 10, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 1.1512248516082764
Epoch: 11, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.519 Vali Acc: 0.473 Test Loss: 1.519 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9513461589813232
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0475006103515625
Epoch: 13, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.194230079650879
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 15 cost time: 1.108712911605835
Epoch: 15, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.535 Vali Acc: 0.496 Test Loss: 1.535 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496168).  Saving model ...
Epoch: 16 cost time: 1.2876677513122559
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.253467082977295
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.576 Vali Acc: 0.473 Test Loss: 1.576 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1863834857940674
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.577 Vali Acc: 0.466 Test Loss: 1.577 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1581063270568848
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.562 Vali Acc: 0.473 Test Loss: 1.562 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0822830200195312
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.557 Vali Acc: 0.458 Test Loss: 1.557 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1601355075836182
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.568 Vali Acc: 0.450 Test Loss: 1.568 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9880378246307373
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.579 Vali Acc: 0.443 Test Loss: 1.579 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1057548522949219
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.602 Vali Acc: 0.450 Test Loss: 1.602 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0186614990234375
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.620 Vali Acc: 0.450 Test Loss: 1.620 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0192310810089111
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.625 Vali Acc: 0.450 Test Loss: 1.625 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 165861
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.209780693054199
Epoch: 1, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.678 Vali Acc: 0.267 Test Loss: 1.678 Test Acc: 0.267
Validation loss decreased (inf --> -0.267159).  Saving model ...
Epoch: 2 cost time: 1.0739853382110596
Epoch: 2, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.670 Vali Acc: 0.275 Test Loss: 1.670 Test Acc: 0.275
Validation loss decreased (-0.267159 --> -0.274792).  Saving model ...
Epoch: 3 cost time: 1.1330885887145996
Epoch: 3, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.617 Vali Acc: 0.328 Test Loss: 1.617 Test Acc: 0.328
Validation loss decreased (-0.274792 --> -0.328228).  Saving model ...
Epoch: 4 cost time: 1.0484089851379395
Epoch: 4, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.553 Vali Acc: 0.382 Test Loss: 1.553 Test Acc: 0.382
Validation loss decreased (-0.328228 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.1091251373291016
Epoch: 5, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.507 Vali Acc: 0.405 Test Loss: 1.507 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404565).  Saving model ...
Epoch: 6 cost time: 1.0141849517822266
Epoch: 6, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.457 Vali Acc: 0.435 Test Loss: 1.457 Test Acc: 0.435
Validation loss decreased (-0.404565 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 1.098508358001709
Epoch: 7, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.442 Vali Acc: 0.443 Test Loss: 1.442 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442734).  Saving model ...
Epoch: 8 cost time: 0.9541463851928711
Epoch: 8, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.436 Vali Acc: 0.450 Test Loss: 1.436 Test Acc: 0.450
Validation loss decreased (-0.442734 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.0459158420562744
Epoch: 9, Steps: 8 | Train Loss: 0.214 Vali Loss: 1.454 Vali Acc: 0.435 Test Loss: 1.454 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0011625289916992
Epoch: 10, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.432 Vali Acc: 0.443 Test Loss: 1.432 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0575478076934814
Epoch: 11, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.432 Vali Acc: 0.427 Test Loss: 1.432 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9869749546051025
Epoch: 12, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.452 Vali Acc: 0.435 Test Loss: 1.452 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.038558006286621
Epoch: 13, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.449 Vali Acc: 0.450 Test Loss: 1.449 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9761319160461426
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.452 Vali Acc: 0.458 Test Loss: 1.452 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 15 cost time: 1.0014142990112305
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.465 Vali Acc: 0.450 Test Loss: 1.465 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.945493221282959
Epoch: 16, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.479 Vali Acc: 0.458 Test Loss: 1.479 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0281288623809814
Epoch: 17, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.481 Vali Acc: 0.458 Test Loss: 1.481 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0462706089019775
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.484 Vali Acc: 0.450 Test Loss: 1.484 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9632415771484375
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.485 Vali Acc: 0.443 Test Loss: 1.485 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2661406993865967
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.501 Vali Acc: 0.458 Test Loss: 1.501 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1274521350860596
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.513 Vali Acc: 0.450 Test Loss: 1.513 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.231539011001587
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.530 Vali Acc: 0.450 Test Loss: 1.530 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1707730293273926
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.537 Vali Acc: 0.458 Test Loss: 1.537 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1433775424957275
Epoch: 24, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.535 Vali Acc: 0.466 Test Loss: 1.535 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 25 cost time: 1.1323490142822266
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.531 Vali Acc: 0.458 Test Loss: 1.531 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.151123046875
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1851165294647217
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.555 Vali Acc: 0.466 Test Loss: 1.555 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.197019100189209
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480900).  Saving model ...
Epoch: 29 cost time: 1.0829834938049316
Epoch: 29, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.574 Vali Acc: 0.473 Test Loss: 1.574 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1799960136413574
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.573 Vali Acc: 0.450 Test Loss: 1.573 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3108196258544922
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.583 Vali Acc: 0.466 Test Loss: 1.583 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.136920690536499
Epoch: 32, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.591 Vali Acc: 0.466 Test Loss: 1.591 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1297051906585693
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.589 Vali Acc: 0.473 Test Loss: 1.589 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1145241260528564
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.591 Vali Acc: 0.466 Test Loss: 1.591 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.060852289199829
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.587 Vali Acc: 0.443 Test Loss: 1.587 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0215466022491455
Epoch: 36, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.589 Vali Acc: 0.466 Test Loss: 1.589 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.097141981124878
Epoch: 37, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.598 Vali Acc: 0.458 Test Loss: 1.598 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.095592737197876
Epoch: 38, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.598 Vali Acc: 0.450 Test Loss: 1.598 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 193669
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.136930465698242
Epoch: 1, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.632 Vali Acc: 0.321 Test Loss: 1.632 Test Acc: 0.321
Validation loss decreased (inf --> -0.320594).  Saving model ...
Epoch: 2 cost time: 1.5289180278778076
Epoch: 2, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.651 Vali Acc: 0.412 Test Loss: 1.651 Test Acc: 0.412
Validation loss decreased (-0.320594 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.4257137775421143
Epoch: 3, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.584 Vali Acc: 0.328 Test Loss: 1.584 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4556503295898438
Epoch: 4, Steps: 8 | Train Loss: 0.958 Vali Loss: 1.530 Vali Acc: 0.458 Test Loss: 1.530 Test Acc: 0.458
Validation loss decreased (-0.412197 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.3080086708068848
Epoch: 5, Steps: 8 | Train Loss: 0.650 Vali Loss: 1.521 Vali Acc: 0.481 Test Loss: 1.521 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.462566614151001
Epoch: 6, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.447 Vali Acc: 0.489 Test Loss: 1.447 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.4352459907531738
Epoch: 7, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.458 Vali Acc: 0.496 Test Loss: 1.458 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.33748197555542
Epoch: 8, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3330974578857422
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.554 Vali Acc: 0.496 Test Loss: 1.554 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4755580425262451
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.507 Vali Acc: 0.511 Test Loss: 1.507 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511435).  Saving model ...
Epoch: 11 cost time: 1.477097988128662
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.591 Vali Acc: 0.504 Test Loss: 1.591 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.504018783569336
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.641 Vali Acc: 0.511 Test Loss: 1.641 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5496611595153809
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.621 Vali Acc: 0.504 Test Loss: 1.621 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4678850173950195
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.606 Vali Acc: 0.496 Test Loss: 1.606 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.431062936782837
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.628 Vali Acc: 0.496 Test Loss: 1.628 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5698719024658203
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.650 Vali Acc: 0.504 Test Loss: 1.650 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.434417963027954
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.650 Vali Acc: 0.511 Test Loss: 1.650 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4619929790496826
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.659 Vali Acc: 0.511 Test Loss: 1.659 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5227115154266357
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4233591556549072
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.511 Test Loss: 1.671 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 115717
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6918177604675293
Epoch: 1, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.583 Vali Acc: 0.275 Test Loss: 1.583 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.1348884105682373
Epoch: 2, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.592 Vali Acc: 0.427 Test Loss: 1.592 Test Acc: 0.427
Validation loss decreased (-0.274793 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1784439086914062
Epoch: 3, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.667 Vali Acc: 0.443 Test Loss: 1.667 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442731).  Saving model ...
Epoch: 4 cost time: 1.0905194282531738
Epoch: 4, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.518 Vali Acc: 0.489 Test Loss: 1.518 Test Acc: 0.489
Validation loss decreased (-0.442731 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 1.1713361740112305
Epoch: 5, Steps: 8 | Train Loss: 0.927 Vali Loss: 1.456 Vali Acc: 0.504 Test Loss: 1.456 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.089660406112671
Epoch: 6, Steps: 8 | Train Loss: 0.728 Vali Loss: 1.456 Vali Acc: 0.527 Test Loss: 1.456 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.1820335388183594
Epoch: 7, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.375 Vali Acc: 0.550 Test Loss: 1.375 Test Acc: 0.550
Validation loss decreased (-0.526703 --> -0.549605).  Saving model ...
Epoch: 8 cost time: 1.1236026287078857
Epoch: 8, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.340 Vali Acc: 0.557 Test Loss: 1.340 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 9 cost time: 1.0908384323120117
Epoch: 9, Steps: 8 | Train Loss: 0.226 Vali Loss: 1.348 Vali Acc: 0.565 Test Loss: 1.348 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 10 cost time: 1.1617791652679443
Epoch: 10, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.358 Vali Acc: 0.550 Test Loss: 1.358 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0833756923675537
Epoch: 11, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.435 Vali Acc: 0.557 Test Loss: 1.435 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2567975521087646
Epoch: 12, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.412 Vali Acc: 0.565 Test Loss: 1.412 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2323462963104248
Epoch: 13, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.401 Vali Acc: 0.557 Test Loss: 1.401 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1508054733276367
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.414 Vali Acc: 0.557 Test Loss: 1.414 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0338313579559326
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.421 Vali Acc: 0.565 Test Loss: 1.421 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.323514461517334
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.429 Vali Acc: 0.565 Test Loss: 1.429 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.142772912979126
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.461 Vali Acc: 0.550 Test Loss: 1.461 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1237475872039795
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.479 Vali Acc: 0.534 Test Loss: 1.479 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2040674686431885
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.487 Vali Acc: 0.542 Test Loss: 1.487 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 91717
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0933010578155518
Epoch: 1, Steps: 8 | Train Loss: 1.688 Vali Loss: 1.651 Vali Acc: 0.260 Test Loss: 1.651 Test Acc: 0.260
Validation loss decreased (inf --> -0.259525).  Saving model ...
Epoch: 2 cost time: 1.1873252391815186
Epoch: 2, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.559 Vali Acc: 0.366 Test Loss: 1.559 Test Acc: 0.366
Validation loss decreased (-0.259525 --> -0.366397).  Saving model ...
Epoch: 3 cost time: 1.284306287765503
Epoch: 3, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.561 Vali Acc: 0.420 Test Loss: 1.561 Test Acc: 0.420
Validation loss decreased (-0.366397 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.1568176746368408
Epoch: 4, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.537 Vali Acc: 0.435 Test Loss: 1.537 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 1.188422441482544
Epoch: 5, Steps: 8 | Train Loss: 0.910 Vali Loss: 1.465 Vali Acc: 0.458 Test Loss: 1.465 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.1306629180908203
Epoch: 6, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.431 Vali Acc: 0.450 Test Loss: 1.431 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1497042179107666
Epoch: 7, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.408 Vali Acc: 0.496 Test Loss: 1.408 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 8 cost time: 1.1148762702941895
Epoch: 8, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.383 Vali Acc: 0.489 Test Loss: 1.383 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2034015655517578
Epoch: 9, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.368 Vali Acc: 0.473 Test Loss: 1.368 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1554265022277832
Epoch: 10, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.362 Vali Acc: 0.519 Test Loss: 1.362 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 11 cost time: 1.1683058738708496
Epoch: 11, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.361 Vali Acc: 0.519 Test Loss: 1.361 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 12 cost time: 1.1293461322784424
Epoch: 12, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.381 Vali Acc: 0.519 Test Loss: 1.381 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2128400802612305
Epoch: 13, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.389 Vali Acc: 0.504 Test Loss: 1.389 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1565215587615967
Epoch: 14, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.393 Vali Acc: 0.519 Test Loss: 1.393 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.185986042022705
Epoch: 15, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.411 Vali Acc: 0.519 Test Loss: 1.411 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1870973110198975
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.430 Vali Acc: 0.519 Test Loss: 1.430 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0835862159729004
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.437 Vali Acc: 0.519 Test Loss: 1.437 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.103499412536621
Epoch: 18, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.432 Vali Acc: 0.534 Test Loss: 1.432 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 19 cost time: 1.084313154220581
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.428 Vali Acc: 0.534 Test Loss: 1.428 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 20 cost time: 1.1196174621582031
Epoch: 20, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.439 Vali Acc: 0.542 Test Loss: 1.439 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 21 cost time: 1.158503532409668
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.454 Vali Acc: 0.519 Test Loss: 1.454 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1247689723968506
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.467 Vali Acc: 0.519 Test Loss: 1.467 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0722918510437012
Epoch: 23, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.475 Vali Acc: 0.534 Test Loss: 1.475 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.099329948425293
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.477 Vali Acc: 0.542 Test Loss: 1.477 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2652313709259033
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.489 Vali Acc: 0.534 Test Loss: 1.489 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.076690912246704
Epoch: 26, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.497 Vali Acc: 0.534 Test Loss: 1.497 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2126739025115967
Epoch: 27, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.496 Vali Acc: 0.542 Test Loss: 1.496 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2298760414123535
Epoch: 28, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.509 Vali Acc: 0.542 Test Loss: 1.509 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2314345836639404
Epoch: 29, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.518 Vali Acc: 0.542 Test Loss: 1.518 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1907410621643066
Epoch: 30, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.524 Vali Acc: 0.542 Test Loss: 1.524 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 93605
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5756092071533203
Epoch: 1, Steps: 8 | Train Loss: 1.764 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 1.099625587463379
Epoch: 2, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.569 Vali Acc: 0.321 Test Loss: 1.569 Test Acc: 0.321
Validation loss decreased (-0.259526 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.1434717178344727
Epoch: 3, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.542 Vali Acc: 0.366 Test Loss: 1.542 Test Acc: 0.366
Validation loss decreased (-0.320595 --> -0.366397).  Saving model ...
Epoch: 4 cost time: 0.9577972888946533
Epoch: 4, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.535 Vali Acc: 0.397 Test Loss: 1.535 Test Acc: 0.397
Validation loss decreased (-0.366397 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 1.0104091167449951
Epoch: 5, Steps: 8 | Train Loss: 0.941 Vali Loss: 1.490 Vali Acc: 0.435 Test Loss: 1.490 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 1.0051939487457275
Epoch: 6, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.0620219707489014
Epoch: 7, Steps: 8 | Train Loss: 0.585 Vali Loss: 1.431 Vali Acc: 0.473 Test Loss: 1.431 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.0893115997314453
Epoch: 8, Steps: 8 | Train Loss: 0.467 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488536).  Saving model ...
Epoch: 9 cost time: 1.1725242137908936
Epoch: 9, Steps: 8 | Train Loss: 0.350 Vali Loss: 1.399 Vali Acc: 0.511 Test Loss: 1.399 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511436).  Saving model ...
Epoch: 10 cost time: 1.1081230640411377
Epoch: 10, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.395 Vali Acc: 0.527 Test Loss: 1.395 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.1571974754333496
Epoch: 11, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.401 Vali Acc: 0.527 Test Loss: 1.401 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1312835216522217
Epoch: 12, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0269386768341064
Epoch: 13, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.420 Vali Acc: 0.519 Test Loss: 1.420 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.161147117614746
Epoch: 14, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.433 Vali Acc: 0.519 Test Loss: 1.433 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0417094230651855
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.449 Vali Acc: 0.519 Test Loss: 1.449 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1932423114776611
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.461 Vali Acc: 0.534 Test Loss: 1.461 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 17 cost time: 0.9485516548156738
Epoch: 17, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.474 Vali Acc: 0.534 Test Loss: 1.474 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0814006328582764
Epoch: 18, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.478 Vali Acc: 0.534 Test Loss: 1.478 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0037133693695068
Epoch: 19, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9372670650482178
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.484 Vali Acc: 0.534 Test Loss: 1.484 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.87428879737854
Epoch: 21, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.507 Vali Acc: 0.534 Test Loss: 1.507 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1441316604614258
Epoch: 22, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.517 Vali Acc: 0.542 Test Loss: 1.517 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 23 cost time: 1.0713374614715576
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.520 Vali Acc: 0.534 Test Loss: 1.520 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0957536697387695
Epoch: 24, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.528 Vali Acc: 0.534 Test Loss: 1.528 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1063897609710693
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.531 Vali Acc: 0.534 Test Loss: 1.531 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0556273460388184
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.530 Vali Acc: 0.534 Test Loss: 1.530 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1569633483886719
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.533 Vali Acc: 0.534 Test Loss: 1.533 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1556634902954102
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.538 Vali Acc: 0.534 Test Loss: 1.538 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.02262544631958
Epoch: 29, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.538 Vali Acc: 0.534 Test Loss: 1.538 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.114149570465088
Epoch: 30, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.544 Vali Acc: 0.534 Test Loss: 1.544 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0759174823760986
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.554 Vali Acc: 0.542 Test Loss: 1.554 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.121772289276123
Epoch: 32, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.564 Vali Acc: 0.542 Test Loss: 1.564 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 101285
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8698062896728516
Epoch: 1, Steps: 8 | Train Loss: 1.585 Vali Loss: 1.684 Vali Acc: 0.198 Test Loss: 1.684 Test Acc: 0.198
Validation loss decreased (inf --> -0.198456).  Saving model ...
Epoch: 2 cost time: 1.0821430683135986
Epoch: 2, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.612 Vali Acc: 0.321 Test Loss: 1.612 Test Acc: 0.321
Validation loss decreased (-0.198456 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.202408790588379
Epoch: 3, Steps: 8 | Train Loss: 1.351 Vali Loss: 1.561 Vali Acc: 0.397 Test Loss: 1.561 Test Acc: 0.397
Validation loss decreased (-0.320595 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.1643147468566895
Epoch: 4, Steps: 8 | Train Loss: 1.047 Vali Loss: 1.528 Vali Acc: 0.443 Test Loss: 1.528 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.2313146591186523
Epoch: 5, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.498 Vali Acc: 0.481 Test Loss: 1.498 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.1145179271697998
Epoch: 6, Steps: 8 | Train Loss: 0.660 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.139308214187622
Epoch: 7, Steps: 8 | Train Loss: 0.528 Vali Loss: 1.437 Vali Acc: 0.527 Test Loss: 1.437 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.097050666809082
Epoch: 8, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.409 Vali Acc: 0.519 Test Loss: 1.409 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0860702991485596
Epoch: 9, Steps: 8 | Train Loss: 0.311 Vali Loss: 1.399 Vali Acc: 0.511 Test Loss: 1.399 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1148285865783691
Epoch: 10, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.405 Vali Acc: 0.527 Test Loss: 1.405 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.0464365482330322
Epoch: 11, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.397 Vali Acc: 0.542 Test Loss: 1.397 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 12 cost time: 1.124955654144287
Epoch: 12, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.225675344467163
Epoch: 13, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.406 Vali Acc: 0.504 Test Loss: 1.406 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1398351192474365
Epoch: 14, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.410 Vali Acc: 0.504 Test Loss: 1.410 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1773769855499268
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1547389030456543
Epoch: 16, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.440 Vali Acc: 0.511 Test Loss: 1.440 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0511562824249268
Epoch: 17, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.442 Vali Acc: 0.527 Test Loss: 1.442 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0987846851348877
Epoch: 18, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.053269863128662
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.454 Vali Acc: 0.542 Test Loss: 1.454 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0121245384216309
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.464 Vali Acc: 0.542 Test Loss: 1.464 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1977126598358154
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.472 Vali Acc: 0.534 Test Loss: 1.472 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 124293
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.114511251449585
Epoch: 1, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.810 Vali Acc: 0.107 Test Loss: 1.810 Test Acc: 0.107
Validation loss decreased (inf --> -0.106852).  Saving model ...
Epoch: 2 cost time: 1.1566886901855469
Epoch: 2, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.760 Vali Acc: 0.137 Test Loss: 1.760 Test Acc: 0.137
Validation loss decreased (-0.106852 --> -0.137387).  Saving model ...
Epoch: 3 cost time: 1.2337265014648438
Epoch: 3, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.698 Vali Acc: 0.260 Test Loss: 1.698 Test Acc: 0.260
Validation loss decreased (-0.137387 --> -0.259525).  Saving model ...
Epoch: 4 cost time: 1.22749924659729
Epoch: 4, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.633 Vali Acc: 0.336 Test Loss: 1.633 Test Acc: 0.336
Validation loss decreased (-0.259525 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 1.1306841373443604
Epoch: 5, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.577 Vali Acc: 0.397 Test Loss: 1.577 Test Acc: 0.397
Validation loss decreased (-0.335862 --> -0.396931).  Saving model ...
Epoch: 6 cost time: 1.1730437278747559
Epoch: 6, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.537 Vali Acc: 0.412 Test Loss: 1.537 Test Acc: 0.412
Validation loss decreased (-0.396931 --> -0.412198).  Saving model ...
Epoch: 7 cost time: 1.2354741096496582
Epoch: 7, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.514 Vali Acc: 0.458 Test Loss: 1.514 Test Acc: 0.458
Validation loss decreased (-0.412198 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.1747183799743652
Epoch: 8, Steps: 8 | Train Loss: 0.348 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 9 cost time: 1.0331761837005615
Epoch: 9, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2231221199035645
Epoch: 10, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.494 Vali Acc: 0.443 Test Loss: 1.494 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0826761722564697
Epoch: 11, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.485 Vali Acc: 0.458 Test Loss: 1.485 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1983118057250977
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.513 Vali Acc: 0.466 Test Loss: 1.513 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0278382301330566
Epoch: 13, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.523 Vali Acc: 0.473 Test Loss: 1.523 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1278724670410156
Epoch: 14, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.542 Vali Acc: 0.481 Test Loss: 1.542 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 15 cost time: 1.1987228393554688
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.553 Vali Acc: 0.458 Test Loss: 1.553 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2215290069580078
Epoch: 16, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.556 Vali Acc: 0.466 Test Loss: 1.556 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0933406352996826
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.567 Vali Acc: 0.481 Test Loss: 1.567 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2599198818206787
Epoch: 18, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.573 Vali Acc: 0.473 Test Loss: 1.573 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1689996719360352
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.589 Vali Acc: 0.473 Test Loss: 1.589 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1672992706298828
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.594 Vali Acc: 0.481 Test Loss: 1.594 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1144638061523438
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.613 Vali Acc: 0.489 Test Loss: 1.613 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488533).  Saving model ...
Epoch: 22 cost time: 1.0975699424743652
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.627 Vali Acc: 0.489 Test Loss: 1.627 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.255556344985962
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.632 Vali Acc: 0.473 Test Loss: 1.632 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2658085823059082
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.646 Vali Acc: 0.473 Test Loss: 1.646 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1162655353546143
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.656 Vali Acc: 0.466 Test Loss: 1.656 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2237508296966553
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.662 Vali Acc: 0.473 Test Loss: 1.662 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2251331806182861
Epoch: 27, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.663 Vali Acc: 0.473 Test Loss: 1.663 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0368306636810303
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1743624210357666
Epoch: 29, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.676 Vali Acc: 0.473 Test Loss: 1.676 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2094614505767822
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.688 Vali Acc: 0.466 Test Loss: 1.688 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.074510097503662
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.696 Vali Acc: 0.473 Test Loss: 1.696 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 149221
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.863619565963745
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.638 Vali Acc: 0.221 Test Loss: 1.638 Test Acc: 0.221
Validation loss decreased (inf --> -0.221358).  Saving model ...
Epoch: 2 cost time: 1.1714367866516113
Epoch: 2, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.610 Vali Acc: 0.282 Test Loss: 1.610 Test Acc: 0.282
Validation loss decreased (-0.221358 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 1.1556456089019775
Epoch: 3, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.566 Vali Acc: 0.359 Test Loss: 1.566 Test Acc: 0.359
Validation loss decreased (-0.282427 --> -0.358763).  Saving model ...
Epoch: 4 cost time: 1.196012020111084
Epoch: 4, Steps: 8 | Train Loss: 0.955 Vali Loss: 1.515 Vali Acc: 0.405 Test Loss: 1.515 Test Acc: 0.405
Validation loss decreased (-0.358763 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 1.208885908126831
Epoch: 5, Steps: 8 | Train Loss: 0.733 Vali Loss: 1.485 Vali Acc: 0.420 Test Loss: 1.485 Test Acc: 0.420
Validation loss decreased (-0.404565 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.2200350761413574
Epoch: 6, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.444 Vali Acc: 0.466 Test Loss: 1.444 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.2543857097625732
Epoch: 7, Steps: 8 | Train Loss: 0.388 Vali Loss: 1.435 Vali Acc: 0.443 Test Loss: 1.435 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2388594150543213
Epoch: 8, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.434 Vali Acc: 0.427 Test Loss: 1.434 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2586355209350586
Epoch: 9, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.425 Vali Acc: 0.450 Test Loss: 1.425 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1713626384735107
Epoch: 10, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.456 Vali Acc: 0.443 Test Loss: 1.456 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2740631103515625
Epoch: 11, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.192422866821289
Epoch: 12, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.500 Vali Acc: 0.443 Test Loss: 1.500 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2586698532104492
Epoch: 13, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.513 Vali Acc: 0.374 Test Loss: 1.513 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3009388446807861
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.534 Vali Acc: 0.412 Test Loss: 1.534 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1796650886535645
Epoch: 15, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.558 Vali Acc: 0.435 Test Loss: 1.558 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1658971309661865
Epoch: 16, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.557 Vali Acc: 0.405 Test Loss: 1.557 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 177029
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6753580570220947
Epoch: 1, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.618 Vali Acc: 0.336 Test Loss: 1.618 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.8230361938476562
Epoch: 2, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.704 Vali Acc: 0.420 Test Loss: 1.704 Test Acc: 0.420
Validation loss decreased (-0.335862 --> -0.419830).  Saving model ...
Epoch: 3 cost time: 1.882514238357544
Epoch: 3, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.557 Vali Acc: 0.366 Test Loss: 1.557 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.921762466430664
Epoch: 4, Steps: 8 | Train Loss: 0.902 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
Validation loss decreased (-0.419830 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 2.035851001739502
Epoch: 5, Steps: 8 | Train Loss: 0.660 Vali Loss: 1.431 Vali Acc: 0.504 Test Loss: 1.431 Test Acc: 0.504
Validation loss decreased (-0.450367 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 2.1349856853485107
Epoch: 6, Steps: 8 | Train Loss: 0.402 Vali Loss: 1.465 Vali Acc: 0.496 Test Loss: 1.465 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8760840892791748
Epoch: 7, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.8610179424285889
Epoch: 8, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 2.057332754135132
Epoch: 9, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.477 Vali Acc: 0.550 Test Loss: 1.477 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 10 cost time: 1.986919641494751
Epoch: 10, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.534 Vali Acc: 0.557 Test Loss: 1.534 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557237).  Saving model ...
Epoch: 11 cost time: 1.7564363479614258
Epoch: 11, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.487 Vali Acc: 0.534 Test Loss: 1.487 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9810664653778076
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.547 Vali Acc: 0.534 Test Loss: 1.547 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9668452739715576
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.635 Vali Acc: 0.550 Test Loss: 1.635 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9277241230010986
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.630 Vali Acc: 0.542 Test Loss: 1.630 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8489084243774414
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.618 Vali Acc: 0.542 Test Loss: 1.618 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.907416582107544
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.618 Vali Acc: 0.542 Test Loss: 1.618 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0481388568878174
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.542 Test Loss: 1.630 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9238977432250977
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.667 Vali Acc: 0.542 Test Loss: 1.667 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.947373390197754
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.684 Vali Acc: 0.550 Test Loss: 1.684 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8268883228302002
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.672 Vali Acc: 0.550 Test Loss: 1.672 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 107397
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3440983295440674
Epoch: 1, Steps: 8 | Train Loss: 1.713 Vali Loss: 1.590 Vali Acc: 0.382 Test Loss: 1.590 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 1.4440202713012695
Epoch: 2, Steps: 8 | Train Loss: 1.487 Vali Loss: 1.636 Vali Acc: 0.412 Test Loss: 1.636 Test Acc: 0.412
Validation loss decreased (-0.381663 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.2456812858581543
Epoch: 3, Steps: 8 | Train Loss: 1.292 Vali Loss: 1.656 Vali Acc: 0.412 Test Loss: 1.656 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2251579761505127
Epoch: 4, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.545 Vali Acc: 0.412 Test Loss: 1.545 Test Acc: 0.412
Validation loss decreased (-0.412197 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 1.2713391780853271
Epoch: 5, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
Validation loss decreased (-0.412198 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.1213982105255127
Epoch: 6, Steps: 8 | Train Loss: 0.684 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.2427902221679688
Epoch: 7, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.405 Vali Acc: 0.519 Test Loss: 1.405 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.2164814472198486
Epoch: 8, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.400 Vali Acc: 0.519 Test Loss: 1.400 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.1534442901611328
Epoch: 9, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 1.2394177913665771
Epoch: 10, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.3550810813903809
Epoch: 11, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.374 Vali Acc: 0.519 Test Loss: 1.374 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2772705554962158
Epoch: 12, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.409 Vali Acc: 0.534 Test Loss: 1.409 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 13 cost time: 1.214813470840454
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.402 Vali Acc: 0.519 Test Loss: 1.402 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1748874187469482
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.400 Vali Acc: 0.519 Test Loss: 1.400 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2419416904449463
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.423 Vali Acc: 0.534 Test Loss: 1.423 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2873802185058594
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.454 Vali Acc: 0.534 Test Loss: 1.454 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1693596839904785
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.465 Vali Acc: 0.534 Test Loss: 1.465 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1856117248535156
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.475 Vali Acc: 0.534 Test Loss: 1.475 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.216092824935913
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.462 Vali Acc: 0.534 Test Loss: 1.462 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1576905250549316
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.463 Vali Acc: 0.534 Test Loss: 1.463 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2211718559265137
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.460 Vali Acc: 0.534 Test Loss: 1.460 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4716753959655762
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.481 Vali Acc: 0.534 Test Loss: 1.481 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 83397
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0882046222686768
Epoch: 1, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.657 Vali Acc: 0.214 Test Loss: 1.657 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.2574498653411865
Epoch: 2, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.616 Vali Acc: 0.351 Test Loss: 1.616 Test Acc: 0.351
Validation loss decreased (-0.213724 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.228898525238037
Epoch: 3, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.619 Vali Acc: 0.389 Test Loss: 1.619 Test Acc: 0.389
Validation loss decreased (-0.351129 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.2914252281188965
Epoch: 4, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.628 Vali Acc: 0.405 Test Loss: 1.628 Test Acc: 0.405
Validation loss decreased (-0.389297 --> -0.404564).  Saving model ...
Epoch: 5 cost time: 1.253420114517212
Epoch: 5, Steps: 8 | Train Loss: 0.966 Vali Loss: 1.576 Vali Acc: 0.420 Test Loss: 1.576 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.2069780826568604
Epoch: 6, Steps: 8 | Train Loss: 0.789 Vali Loss: 1.521 Vali Acc: 0.466 Test Loss: 1.521 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.2357773780822754
Epoch: 7, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.509 Vali Acc: 0.481 Test Loss: 1.509 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 1.287337064743042
Epoch: 8, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.498 Vali Acc: 0.496 Test Loss: 1.498 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 1.3583974838256836
Epoch: 9, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.485 Vali Acc: 0.504 Test Loss: 1.485 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.1641755104064941
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.471 Vali Acc: 0.504 Test Loss: 1.471 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 1.278557300567627
Epoch: 11, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3766059875488281
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.478 Vali Acc: 0.504 Test Loss: 1.478 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2144112586975098
Epoch: 13, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.489 Vali Acc: 0.504 Test Loss: 1.489 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2241814136505127
Epoch: 14, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1319050788879395
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.553 Vali Acc: 0.519 Test Loss: 1.553 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519068).  Saving model ...
Epoch: 16 cost time: 1.135124921798706
Epoch: 16, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.524 Vali Acc: 0.519 Test Loss: 1.524 Test Acc: 0.519
Validation loss decreased (-0.519068 --> -0.519069).  Saving model ...
Epoch: 17 cost time: 1.2665624618530273
Epoch: 17, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.523 Vali Acc: 0.511 Test Loss: 1.523 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.09490966796875
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1720588207244873
Epoch: 19, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1685490608215332
Epoch: 20, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.567 Vali Acc: 0.511 Test Loss: 1.567 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1694355010986328
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1222295761108398
Epoch: 22, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.574 Vali Acc: 0.504 Test Loss: 1.574 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.15419340133667
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.578 Vali Acc: 0.504 Test Loss: 1.578 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2234301567077637
Epoch: 24, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.582 Vali Acc: 0.504 Test Loss: 1.582 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2727479934692383
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.602 Vali Acc: 0.504 Test Loss: 1.602 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.157616376876831
Epoch: 26, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.621 Vali Acc: 0.511 Test Loss: 1.621 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 85285
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9273130893707275
Epoch: 1, Steps: 8 | Train Loss: 1.606 Vali Loss: 1.715 Vali Acc: 0.244 Test Loss: 1.715 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.3419625759124756
Epoch: 2, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.634 Vali Acc: 0.359 Test Loss: 1.634 Test Acc: 0.359
Validation loss decreased (-0.244258 --> -0.358762).  Saving model ...
Epoch: 3 cost time: 1.2457759380340576
Epoch: 3, Steps: 8 | Train Loss: 1.305 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (-0.358762 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.209775447845459
Epoch: 4, Steps: 8 | Train Loss: 1.099 Vali Loss: 1.580 Vali Acc: 0.405 Test Loss: 1.580 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1676561832427979
Epoch: 5, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.2786695957183838
Epoch: 6, Steps: 8 | Train Loss: 0.755 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.262030839920044
Epoch: 7, Steps: 8 | Train Loss: 0.564 Vali Loss: 1.499 Vali Acc: 0.450 Test Loss: 1.499 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.320688009262085
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.483 Vali Acc: 0.458 Test Loss: 1.483 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 1.293468713760376
Epoch: 9, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 1.2452380657196045
Epoch: 10, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.465 Vali Acc: 0.458 Test Loss: 1.465 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2881712913513184
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.478 Vali Acc: 0.481 Test Loss: 1.478 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 12 cost time: 1.2510185241699219
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.477 Vali Acc: 0.519 Test Loss: 1.477 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519069).  Saving model ...
Epoch: 13 cost time: 1.1923916339874268
Epoch: 13, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.487 Vali Acc: 0.519 Test Loss: 1.487 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1999430656433105
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.491 Vali Acc: 0.504 Test Loss: 1.491 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2382009029388428
Epoch: 15, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.230750322341919
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.503 Vali Acc: 0.519 Test Loss: 1.503 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3365767002105713
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 18 cost time: 1.1878795623779297
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.510 Vali Acc: 0.519 Test Loss: 1.510 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1825578212738037
Epoch: 19, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.523 Vali Acc: 0.519 Test Loss: 1.523 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2942149639129639
Epoch: 20, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.528 Vali Acc: 0.519 Test Loss: 1.528 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.342970848083496
Epoch: 21, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3559749126434326
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.541 Vali Acc: 0.519 Test Loss: 1.541 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1882503032684326
Epoch: 23, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2768480777740479
Epoch: 24, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.544 Vali Acc: 0.527 Test Loss: 1.544 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.359224796295166
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3518078327178955
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.543 Vali Acc: 0.519 Test Loss: 1.543 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2842228412628174
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.549 Vali Acc: 0.519 Test Loss: 1.549 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 92965
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9893248081207275
Epoch: 1, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.778 Vali Acc: 0.115 Test Loss: 1.778 Test Acc: 0.115
Validation loss decreased (inf --> -0.114486).  Saving model ...
Epoch: 2 cost time: 1.2869904041290283
Epoch: 2, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.681 Vali Acc: 0.191 Test Loss: 1.681 Test Acc: 0.191
Validation loss decreased (-0.114486 --> -0.190823).  Saving model ...
Epoch: 3 cost time: 1.2016594409942627
Epoch: 3, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.602 Vali Acc: 0.290 Test Loss: 1.602 Test Acc: 0.290
Validation loss decreased (-0.190823 --> -0.290060).  Saving model ...
Epoch: 4 cost time: 1.266322135925293
Epoch: 4, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.549 Vali Acc: 0.351 Test Loss: 1.549 Test Acc: 0.351
Validation loss decreased (-0.290060 --> -0.351130).  Saving model ...
Epoch: 5 cost time: 1.2864999771118164
Epoch: 5, Steps: 8 | Train Loss: 0.881 Vali Loss: 1.520 Vali Acc: 0.374 Test Loss: 1.520 Test Acc: 0.374
Validation loss decreased (-0.351130 --> -0.374031).  Saving model ...
Epoch: 6 cost time: 1.2908351421356201
Epoch: 6, Steps: 8 | Train Loss: 0.683 Vali Loss: 1.501 Vali Acc: 0.397 Test Loss: 1.501 Test Acc: 0.397
Validation loss decreased (-0.374031 --> -0.396932).  Saving model ...
Epoch: 7 cost time: 1.2697150707244873
Epoch: 7, Steps: 8 | Train Loss: 0.529 Vali Loss: 1.495 Vali Acc: 0.443 Test Loss: 1.495 Test Acc: 0.443
Validation loss decreased (-0.396932 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.0115110874176025
Epoch: 8, Steps: 8 | Train Loss: 0.381 Vali Loss: 1.477 Vali Acc: 0.443 Test Loss: 1.477 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 9 cost time: 1.029541015625
Epoch: 9, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.450 Vali Acc: 0.435 Test Loss: 1.450 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9728536605834961
Epoch: 10, Steps: 8 | Train Loss: 0.220 Vali Loss: 1.451 Vali Acc: 0.466 Test Loss: 1.451 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 1.1772968769073486
Epoch: 11, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.446 Vali Acc: 0.450 Test Loss: 1.446 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2059741020202637
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.454 Vali Acc: 0.458 Test Loss: 1.454 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2636127471923828
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.461 Vali Acc: 0.489 Test Loss: 1.461 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 14 cost time: 1.1942269802093506
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2429070472717285
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1034605503082275
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.473 Vali Acc: 0.473 Test Loss: 1.473 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2417938709259033
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.478 Vali Acc: 0.481 Test Loss: 1.478 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1793227195739746
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.486 Vali Acc: 0.481 Test Loss: 1.486 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2875497341156006
Epoch: 19, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.492 Vali Acc: 0.481 Test Loss: 1.492 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.15110445022583
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.494 Vali Acc: 0.489 Test Loss: 1.494 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2102432250976562
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.501 Vali Acc: 0.481 Test Loss: 1.501 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2041246891021729
Epoch: 22, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.507 Vali Acc: 0.481 Test Loss: 1.507 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.177457571029663
Epoch: 23, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.512 Vali Acc: 0.489 Test Loss: 1.512 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 115973
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.252747058868408
Epoch: 1, Steps: 8 | Train Loss: 1.739 Vali Loss: 1.690 Vali Acc: 0.252 Test Loss: 1.690 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.2215070724487305
Epoch: 2, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.641 Vali Acc: 0.267 Test Loss: 1.641 Test Acc: 0.267
Validation loss decreased (-0.251892 --> -0.267159).  Saving model ...
Epoch: 3 cost time: 1.1426784992218018
Epoch: 3, Steps: 8 | Train Loss: 1.307 Vali Loss: 1.577 Vali Acc: 0.282 Test Loss: 1.577 Test Acc: 0.282
Validation loss decreased (-0.267159 --> -0.282427).  Saving model ...
Epoch: 4 cost time: 1.0629734992980957
Epoch: 4, Steps: 8 | Train Loss: 1.063 Vali Loss: 1.532 Vali Acc: 0.321 Test Loss: 1.532 Test Acc: 0.321
Validation loss decreased (-0.282427 --> -0.320595).  Saving model ...
Epoch: 5 cost time: 1.0989320278167725
Epoch: 5, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.511 Vali Acc: 0.366 Test Loss: 1.511 Test Acc: 0.366
Validation loss decreased (-0.320595 --> -0.366397).  Saving model ...
Epoch: 6 cost time: 1.1170423030853271
Epoch: 6, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.491 Vali Acc: 0.405 Test Loss: 1.491 Test Acc: 0.405
Validation loss decreased (-0.366397 --> -0.404565).  Saving model ...
Epoch: 7 cost time: 1.1628506183624268
Epoch: 7, Steps: 8 | Train Loss: 0.457 Vali Loss: 1.474 Vali Acc: 0.435 Test Loss: 1.474 Test Acc: 0.435
Validation loss decreased (-0.404565 --> -0.435100).  Saving model ...
Epoch: 8 cost time: 1.2547476291656494
Epoch: 8, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.462 Vali Acc: 0.458 Test Loss: 1.462 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 1.2723767757415771
Epoch: 9, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.450 Vali Acc: 0.450 Test Loss: 1.450 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1719818115234375
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.465 Vali Acc: 0.458 Test Loss: 1.465 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1684644222259521
Epoch: 11, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.464 Vali Acc: 0.443 Test Loss: 1.464 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0019757747650146
Epoch: 12, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.478 Vali Acc: 0.443 Test Loss: 1.478 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.082904577255249
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.101276159286499
Epoch: 14, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.479 Vali Acc: 0.466 Test Loss: 1.479 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 15 cost time: 1.1035420894622803
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9465692043304443
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.475 Vali Acc: 0.496 Test Loss: 1.475 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496168).  Saving model ...
Epoch: 17 cost time: 1.2393407821655273
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.484 Vali Acc: 0.496 Test Loss: 1.484 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0877437591552734
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.503 Vali Acc: 0.473 Test Loss: 1.503 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0868067741394043
Epoch: 19, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.522 Vali Acc: 0.473 Test Loss: 1.522 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1078238487243652
Epoch: 20, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.524 Vali Acc: 0.473 Test Loss: 1.524 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2508413791656494
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.530 Vali Acc: 0.473 Test Loss: 1.530 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.196045160293579
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.539 Vali Acc: 0.473 Test Loss: 1.539 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1281239986419678
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1380276679992676
Epoch: 24, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.547 Vali Acc: 0.473 Test Loss: 1.547 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1554298400878906
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.551 Vali Acc: 0.481 Test Loss: 1.551 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1751322746276855
Epoch: 26, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.564 Vali Acc: 0.489 Test Loss: 1.564 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 140901
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.947808027267456
Epoch: 1, Steps: 8 | Train Loss: 1.790 Vali Loss: 1.645 Vali Acc: 0.237 Test Loss: 1.645 Test Acc: 0.237
Validation loss decreased (inf --> -0.236625).  Saving model ...
Epoch: 2 cost time: 0.9875388145446777
Epoch: 2, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.607 Vali Acc: 0.252 Test Loss: 1.607 Test Acc: 0.252
Validation loss decreased (-0.236625 --> -0.251892).  Saving model ...
Epoch: 3 cost time: 1.1205780506134033
Epoch: 3, Steps: 8 | Train Loss: 1.246 Vali Loss: 1.553 Vali Acc: 0.275 Test Loss: 1.553 Test Acc: 0.275
Validation loss decreased (-0.251892 --> -0.274794).  Saving model ...
Epoch: 4 cost time: 1.1525042057037354
Epoch: 4, Steps: 8 | Train Loss: 0.952 Vali Loss: 1.509 Vali Acc: 0.344 Test Loss: 1.509 Test Acc: 0.344
Validation loss decreased (-0.274794 --> -0.343496).  Saving model ...
Epoch: 5 cost time: 1.0640869140625
Epoch: 5, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.466 Vali Acc: 0.420 Test Loss: 1.466 Test Acc: 0.420
Validation loss decreased (-0.343496 --> -0.419833).  Saving model ...
Epoch: 6 cost time: 1.0883402824401855
Epoch: 6, Steps: 8 | Train Loss: 0.532 Vali Loss: 1.454 Vali Acc: 0.427 Test Loss: 1.454 Test Acc: 0.427
Validation loss decreased (-0.419833 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.0354018211364746
Epoch: 7, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.436 Vali Acc: 0.450 Test Loss: 1.436 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.1461577415466309
Epoch: 8, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.451 Vali Acc: 0.481 Test Loss: 1.451 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.0002317428588867
Epoch: 9, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.442 Vali Acc: 0.466 Test Loss: 1.442 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.028693675994873
Epoch: 10, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.430 Vali Acc: 0.450 Test Loss: 1.430 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0590558052062988
Epoch: 11, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.448 Vali Acc: 0.435 Test Loss: 1.448 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2637073993682861
Epoch: 12, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.471 Vali Acc: 0.450 Test Loss: 1.471 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2381885051727295
Epoch: 13, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.486 Vali Acc: 0.473 Test Loss: 1.486 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2471137046813965
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.141859769821167
Epoch: 15, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2363646030426025
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.518 Vali Acc: 0.458 Test Loss: 1.518 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1702101230621338
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.536 Vali Acc: 0.458 Test Loss: 1.536 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.070040225982666
Epoch: 18, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.552 Vali Acc: 0.466 Test Loss: 1.552 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm32_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 168709
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4243202209472656
Epoch: 1, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.553 Vali Acc: 0.359 Test Loss: 1.553 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 1.2145798206329346
Epoch: 2, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.614 Vali Acc: 0.412 Test Loss: 1.614 Test Acc: 0.412
Validation loss decreased (-0.358763 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.1551358699798584
Epoch: 3, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.3669438362121582
Epoch: 4, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 1.3416624069213867
Epoch: 5, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.495 Vali Acc: 0.458 Test Loss: 1.495 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.1661829948425293
Epoch: 6, Steps: 8 | Train Loss: 0.858 Vali Loss: 1.482 Vali Acc: 0.496 Test Loss: 1.482 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 7 cost time: 1.195167064666748
Epoch: 7, Steps: 8 | Train Loss: 0.658 Vali Loss: 1.462 Vali Acc: 0.489 Test Loss: 1.462 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.255836009979248
Epoch: 8, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.485 Vali Acc: 0.489 Test Loss: 1.485 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.186779499053955
Epoch: 9, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.444 Vali Acc: 0.481 Test Loss: 1.444 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2982516288757324
Epoch: 10, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.494 Vali Acc: 0.496 Test Loss: 1.494 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1825227737426758
Epoch: 11, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.334705114364624
Epoch: 12, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3116822242736816
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.519 Vali Acc: 0.496 Test Loss: 1.519 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.339831829071045
Epoch: 14, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.565 Vali Acc: 0.504 Test Loss: 1.565 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 15 cost time: 1.2355425357818604
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.597 Vali Acc: 0.496 Test Loss: 1.597 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2974441051483154
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.616 Vali Acc: 0.496 Test Loss: 1.616 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.347132682800293
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.610 Vali Acc: 0.504 Test Loss: 1.610 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3323638439178467
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.604 Vali Acc: 0.504 Test Loss: 1.604 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1613752841949463
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.614 Vali Acc: 0.504 Test Loss: 1.614 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2597558498382568
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.640 Vali Acc: 0.504 Test Loss: 1.640 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2045097351074219
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.635 Vali Acc: 0.504 Test Loss: 1.635 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2260591983795166
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.634 Vali Acc: 0.504 Test Loss: 1.634 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.196850299835205
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.636 Vali Acc: 0.504 Test Loss: 1.636 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2348015308380127
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.644 Vali Acc: 0.504 Test Loss: 1.644 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 64389
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.792386770248413
Epoch: 1, Steps: 8 | Train Loss: 1.737 Vali Loss: 1.644 Vali Acc: 0.145 Test Loss: 1.644 Test Acc: 0.145
Validation loss decreased (inf --> -0.145022).  Saving model ...
Epoch: 2 cost time: 1.0658371448516846
Epoch: 2, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.578 Vali Acc: 0.321 Test Loss: 1.578 Test Acc: 0.321
Validation loss decreased (-0.145022 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.1425378322601318
Epoch: 3, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.580 Vali Acc: 0.412 Test Loss: 1.580 Test Acc: 0.412
Validation loss decreased (-0.320595 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.095705509185791
Epoch: 4, Steps: 8 | Train Loss: 1.299 Vali Loss: 1.579 Vali Acc: 0.405 Test Loss: 1.579 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1868503093719482
Epoch: 5, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.542 Vali Acc: 0.427 Test Loss: 1.542 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 6 cost time: 1.0620594024658203
Epoch: 6, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.516 Vali Acc: 0.405 Test Loss: 1.516 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9959173202514648
Epoch: 7, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.491 Vali Acc: 0.466 Test Loss: 1.491 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.1356475353240967
Epoch: 8, Steps: 8 | Train Loss: 0.765 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 1.1225581169128418
Epoch: 9, Steps: 8 | Train Loss: 0.607 Vali Loss: 1.460 Vali Acc: 0.496 Test Loss: 1.460 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.152435541152954
Epoch: 10, Steps: 8 | Train Loss: 0.490 Vali Loss: 1.450 Vali Acc: 0.489 Test Loss: 1.450 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2299776077270508
Epoch: 11, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.2821917533874512
Epoch: 12, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.421 Vali Acc: 0.496 Test Loss: 1.421 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1943042278289795
Epoch: 13, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.443 Vali Acc: 0.527 Test Loss: 1.443 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 14 cost time: 1.2509639263153076
Epoch: 14, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.438 Vali Acc: 0.496 Test Loss: 1.438 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.221952199935913
Epoch: 15, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.449 Vali Acc: 0.489 Test Loss: 1.449 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0618960857391357
Epoch: 16, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.470 Vali Acc: 0.511 Test Loss: 1.470 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1586320400238037
Epoch: 17, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.462 Vali Acc: 0.504 Test Loss: 1.462 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.020446538925171
Epoch: 18, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.463 Vali Acc: 0.504 Test Loss: 1.463 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.213059663772583
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1236217021942139
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.473 Vali Acc: 0.519 Test Loss: 1.473 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2428154945373535
Epoch: 21, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.481 Vali Acc: 0.519 Test Loss: 1.481 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1311640739440918
Epoch: 22, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.494 Vali Acc: 0.504 Test Loss: 1.494 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1486234664916992
Epoch: 23, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.497 Vali Acc: 0.504 Test Loss: 1.497 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 52389
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.760448694229126
Epoch: 1, Steps: 8 | Train Loss: 1.777 Vali Loss: 1.762 Vali Acc: 0.115 Test Loss: 1.762 Test Acc: 0.115
Validation loss decreased (inf --> -0.114486).  Saving model ...
Epoch: 2 cost time: 0.9978945255279541
Epoch: 2, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.697 Vali Acc: 0.198 Test Loss: 1.697 Test Acc: 0.198
Validation loss decreased (-0.114486 --> -0.198456).  Saving model ...
Epoch: 3 cost time: 1.067765474319458
Epoch: 3, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.659 Vali Acc: 0.313 Test Loss: 1.659 Test Acc: 0.313
Validation loss decreased (-0.198456 --> -0.312961).  Saving model ...
Epoch: 4 cost time: 1.0558576583862305
Epoch: 4, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.640 Vali Acc: 0.382 Test Loss: 1.640 Test Acc: 0.382
Validation loss decreased (-0.312961 --> -0.381663).  Saving model ...
Epoch: 5 cost time: 1.136199712753296
Epoch: 5, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.630 Vali Acc: 0.389 Test Loss: 1.630 Test Acc: 0.389
Validation loss decreased (-0.381663 --> -0.389297).  Saving model ...
Epoch: 6 cost time: 1.135895013809204
Epoch: 6, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.603 Vali Acc: 0.382 Test Loss: 1.603 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.044799566268921
Epoch: 7, Steps: 8 | Train Loss: 0.935 Vali Loss: 1.568 Vali Acc: 0.405 Test Loss: 1.568 Test Acc: 0.405
Validation loss decreased (-0.389297 --> -0.404564).  Saving model ...
Epoch: 8 cost time: 1.091139316558838
Epoch: 8, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.537 Vali Acc: 0.412 Test Loss: 1.537 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412198).  Saving model ...
Epoch: 9 cost time: 1.0898797512054443
Epoch: 9, Steps: 8 | Train Loss: 0.704 Vali Loss: 1.509 Vali Acc: 0.473 Test Loss: 1.509 Test Acc: 0.473
Validation loss decreased (-0.412198 --> -0.473267).  Saving model ...
Epoch: 10 cost time: 1.028907060623169
Epoch: 10, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.495 Vali Acc: 0.473 Test Loss: 1.495 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473267).  Saving model ...
Epoch: 11 cost time: 1.1572110652923584
Epoch: 11, Steps: 8 | Train Loss: 0.488 Vali Loss: 1.470 Vali Acc: 0.450 Test Loss: 1.470 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1963613033294678
Epoch: 12, Steps: 8 | Train Loss: 0.413 Vali Loss: 1.473 Vali Acc: 0.466 Test Loss: 1.473 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9731988906860352
Epoch: 13, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.458 Vali Acc: 0.481 Test Loss: 1.458 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480901).  Saving model ...
Epoch: 14 cost time: 0.9717121124267578
Epoch: 14, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.459 Vali Acc: 0.466 Test Loss: 1.459 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0830771923065186
Epoch: 15, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9659087657928467
Epoch: 16, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.458 Vali Acc: 0.466 Test Loss: 1.458 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1047523021697998
Epoch: 17, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.449 Vali Acc: 0.489 Test Loss: 1.449 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 18 cost time: 1.0882411003112793
Epoch: 18, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.459 Vali Acc: 0.489 Test Loss: 1.459 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0637359619140625
Epoch: 19, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0805737972259521
Epoch: 20, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1400690078735352
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.485 Vali Acc: 0.481 Test Loss: 1.485 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2144057750701904
Epoch: 22, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.489 Vali Acc: 0.481 Test Loss: 1.489 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1980798244476318
Epoch: 23, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.498 Vali Acc: 0.481 Test Loss: 1.498 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.152660846710205
Epoch: 24, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.515 Vali Acc: 0.481 Test Loss: 1.515 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.207509994506836
Epoch: 25, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.179934024810791
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.535 Vali Acc: 0.466 Test Loss: 1.535 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0538341999053955
Epoch: 27, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.544 Vali Acc: 0.466 Test Loss: 1.544 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 53333
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5888869762420654
Epoch: 1, Steps: 8 | Train Loss: 1.738 Vali Loss: 1.657 Vali Acc: 0.214 Test Loss: 1.657 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.1853108406066895
Epoch: 2, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.589 Vali Acc: 0.290 Test Loss: 1.589 Test Acc: 0.290
Validation loss decreased (-0.213724 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 1.199272871017456
Epoch: 3, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.552 Vali Acc: 0.359 Test Loss: 1.552 Test Acc: 0.359
Validation loss decreased (-0.290060 --> -0.358763).  Saving model ...
Epoch: 4 cost time: 1.2538647651672363
Epoch: 4, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.532 Vali Acc: 0.397 Test Loss: 1.532 Test Acc: 0.397
Validation loss decreased (-0.358763 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 1.225632667541504
Epoch: 5, Steps: 8 | Train Loss: 1.157 Vali Loss: 1.524 Vali Acc: 0.435 Test Loss: 1.524 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 1.2061922550201416
Epoch: 6, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1766326427459717
Epoch: 7, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.497 Vali Acc: 0.443 Test Loss: 1.497 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 1.096813440322876
Epoch: 8, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 1.1083002090454102
Epoch: 9, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.463 Vali Acc: 0.466 Test Loss: 1.463 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 10 cost time: 1.1111564636230469
Epoch: 10, Steps: 8 | Train Loss: 0.571 Vali Loss: 1.437 Vali Acc: 0.481 Test Loss: 1.437 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 1.197312831878662
Epoch: 11, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.436 Vali Acc: 0.481 Test Loss: 1.436 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 1.1420025825500488
Epoch: 12, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.430 Vali Acc: 0.458 Test Loss: 1.430 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1806514263153076
Epoch: 13, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.430 Vali Acc: 0.481 Test Loss: 1.430 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 14 cost time: 1.163881778717041
Epoch: 14, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.412 Vali Acc: 0.473 Test Loss: 1.412 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2502870559692383
Epoch: 15, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.415 Vali Acc: 0.466 Test Loss: 1.415 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1167523860931396
Epoch: 16, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.410 Vali Acc: 0.450 Test Loss: 1.410 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2081234455108643
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.428 Vali Acc: 0.473 Test Loss: 1.428 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0389037132263184
Epoch: 18, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2087585926055908
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.448 Vali Acc: 0.450 Test Loss: 1.448 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1213583946228027
Epoch: 20, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.453 Vali Acc: 0.450 Test Loss: 1.453 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2198364734649658
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0927352905273438
Epoch: 22, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.471 Vali Acc: 0.466 Test Loss: 1.471 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2195968627929688
Epoch: 23, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.473 Vali Acc: 0.473 Test Loss: 1.473 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 57173
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9421701431274414
Epoch: 1, Steps: 8 | Train Loss: 1.781 Vali Loss: 1.724 Vali Acc: 0.168 Test Loss: 1.724 Test Acc: 0.168
Validation loss decreased (inf --> -0.167922).  Saving model ...
Epoch: 2 cost time: 1.1450159549713135
Epoch: 2, Steps: 8 | Train Loss: 1.640 Vali Loss: 1.667 Vali Acc: 0.221 Test Loss: 1.667 Test Acc: 0.221
Validation loss decreased (-0.167922 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.1923768520355225
Epoch: 3, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.609 Vali Acc: 0.321 Test Loss: 1.609 Test Acc: 0.321
Validation loss decreased (-0.221357 --> -0.320595).  Saving model ...
Epoch: 4 cost time: 1.237215518951416
Epoch: 4, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.569 Vali Acc: 0.321 Test Loss: 1.569 Test Acc: 0.321
Validation loss decreased (-0.320595 --> -0.320595).  Saving model ...
Epoch: 5 cost time: 1.1898465156555176
Epoch: 5, Steps: 8 | Train Loss: 1.079 Vali Loss: 1.536 Vali Acc: 0.397 Test Loss: 1.536 Test Acc: 0.397
Validation loss decreased (-0.320595 --> -0.396931).  Saving model ...
Epoch: 6 cost time: 1.1969120502471924
Epoch: 6, Steps: 8 | Train Loss: 0.941 Vali Loss: 1.526 Vali Acc: 0.427 Test Loss: 1.526 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 1.292238473892212
Epoch: 7, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.515 Vali Acc: 0.458 Test Loss: 1.515 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.194817304611206
Epoch: 8, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.498 Vali Acc: 0.466 Test Loss: 1.498 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.2032554149627686
Epoch: 9, Steps: 8 | Train Loss: 0.569 Vali Loss: 1.487 Vali Acc: 0.458 Test Loss: 1.487 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3487133979797363
Epoch: 10, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.467 Vali Acc: 0.450 Test Loss: 1.467 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3145232200622559
Epoch: 11, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.460 Vali Acc: 0.466 Test Loss: 1.460 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 12 cost time: 1.1673014163970947
Epoch: 12, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.457 Vali Acc: 0.473 Test Loss: 1.457 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 1.132786512374878
Epoch: 13, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.462 Vali Acc: 0.435 Test Loss: 1.462 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.216973066329956
Epoch: 14, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.500 Vali Acc: 0.466 Test Loss: 1.500 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2763588428497314
Epoch: 15, Steps: 8 | Train Loss: 0.228 Vali Loss: 1.517 Vali Acc: 0.466 Test Loss: 1.517 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1378726959228516
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.512 Vali Acc: 0.473 Test Loss: 1.512 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1027436256408691
Epoch: 17, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.517 Vali Acc: 0.473 Test Loss: 1.517 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0179715156555176
Epoch: 18, Steps: 8 | Train Loss: 0.136 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 19 cost time: 1.1310455799102783
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.540 Vali Acc: 0.481 Test Loss: 1.540 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.042954444885254
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.552 Vali Acc: 0.504 Test Loss: 1.552 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503801).  Saving model ...
Epoch: 21 cost time: 1.0882346630096436
Epoch: 21, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.578 Vali Acc: 0.504 Test Loss: 1.578 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2952873706817627
Epoch: 22, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.586 Vali Acc: 0.481 Test Loss: 1.586 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3181886672973633
Epoch: 23, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.583 Vali Acc: 0.496 Test Loss: 1.583 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4405109882354736
Epoch: 24, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.597 Vali Acc: 0.489 Test Loss: 1.597 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1524057388305664
Epoch: 25, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.612 Vali Acc: 0.489 Test Loss: 1.612 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1253275871276855
Epoch: 26, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.622 Vali Acc: 0.481 Test Loss: 1.622 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.268204689025879
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.639 Vali Acc: 0.481 Test Loss: 1.639 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2022438049316406
Epoch: 28, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.653 Vali Acc: 0.496 Test Loss: 1.653 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0872023105621338
Epoch: 29, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.657 Vali Acc: 0.496 Test Loss: 1.657 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1999907493591309
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.678 Vali Acc: 0.481 Test Loss: 1.678 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 68677
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.119544267654419
Epoch: 1, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.650 Vali Acc: 0.214 Test Loss: 1.650 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.3134100437164307
Epoch: 2, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.629 Vali Acc: 0.260 Test Loss: 1.629 Test Acc: 0.260
Validation loss decreased (-0.213724 --> -0.259526).  Saving model ...
Epoch: 3 cost time: 1.1413662433624268
Epoch: 3, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.585 Vali Acc: 0.290 Test Loss: 1.585 Test Acc: 0.290
Validation loss decreased (-0.259526 --> -0.290060).  Saving model ...
Epoch: 4 cost time: 1.05747389793396
Epoch: 4, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.540 Vali Acc: 0.351 Test Loss: 1.540 Test Acc: 0.351
Validation loss decreased (-0.290060 --> -0.351130).  Saving model ...
Epoch: 5 cost time: 1.1562795639038086
Epoch: 5, Steps: 8 | Train Loss: 1.054 Vali Loss: 1.499 Vali Acc: 0.389 Test Loss: 1.499 Test Acc: 0.389
Validation loss decreased (-0.351130 --> -0.389298).  Saving model ...
Epoch: 6 cost time: 1.3054673671722412
Epoch: 6, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.454 Vali Acc: 0.397 Test Loss: 1.454 Test Acc: 0.397
Validation loss decreased (-0.389298 --> -0.396932).  Saving model ...
Epoch: 7 cost time: 1.065279245376587
Epoch: 7, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.419 Vali Acc: 0.427 Test Loss: 1.419 Test Acc: 0.427
Validation loss decreased (-0.396932 --> -0.427467).  Saving model ...
Epoch: 8 cost time: 1.078536033630371
Epoch: 8, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.401 Vali Acc: 0.481 Test Loss: 1.401 Test Acc: 0.481
Validation loss decreased (-0.427467 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 1.116826057434082
Epoch: 9, Steps: 8 | Train Loss: 0.593 Vali Loss: 1.384 Vali Acc: 0.496 Test Loss: 1.384 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 1.144005537033081
Epoch: 10, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 11 cost time: 1.2653827667236328
Epoch: 11, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.371 Vali Acc: 0.481 Test Loss: 1.371 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2090206146240234
Epoch: 12, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.372 Vali Acc: 0.489 Test Loss: 1.372 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2286922931671143
Epoch: 13, Steps: 8 | Train Loss: 0.300 Vali Loss: 1.383 Vali Acc: 0.466 Test Loss: 1.383 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.266831636428833
Epoch: 14, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.398 Vali Acc: 0.466 Test Loss: 1.398 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.125610113143921
Epoch: 15, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.407 Vali Acc: 0.458 Test Loss: 1.407 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.220513105392456
Epoch: 16, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.399 Vali Acc: 0.473 Test Loss: 1.399 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1934545040130615
Epoch: 17, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.406 Vali Acc: 0.466 Test Loss: 1.406 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.215580940246582
Epoch: 18, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.412 Vali Acc: 0.466 Test Loss: 1.412 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1667568683624268
Epoch: 19, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.402 Vali Acc: 0.473 Test Loss: 1.402 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1662118434906006
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 81141
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8582372665405273
Epoch: 1, Steps: 8 | Train Loss: 1.665 Vali Loss: 1.797 Vali Acc: 0.153 Test Loss: 1.797 Test Acc: 0.153
Validation loss decreased (inf --> -0.152654).  Saving model ...
Epoch: 2 cost time: 1.075526475906372
Epoch: 2, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.735 Vali Acc: 0.221 Test Loss: 1.735 Test Acc: 0.221
Validation loss decreased (-0.152654 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 1.1362230777740479
Epoch: 3, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.669 Vali Acc: 0.290 Test Loss: 1.669 Test Acc: 0.290
Validation loss decreased (-0.221357 --> -0.290060).  Saving model ...
Epoch: 4 cost time: 1.1316828727722168
Epoch: 4, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.599 Vali Acc: 0.351 Test Loss: 1.599 Test Acc: 0.351
Validation loss decreased (-0.290060 --> -0.351129).  Saving model ...
Epoch: 5 cost time: 1.4195201396942139
Epoch: 5, Steps: 8 | Train Loss: 0.980 Vali Loss: 1.541 Vali Acc: 0.412 Test Loss: 1.541 Test Acc: 0.412
Validation loss decreased (-0.351129 --> -0.412198).  Saving model ...
Epoch: 6 cost time: 1.0787572860717773
Epoch: 6, Steps: 8 | Train Loss: 0.830 Vali Loss: 1.493 Vali Acc: 0.458 Test Loss: 1.493 Test Acc: 0.458
Validation loss decreased (-0.412198 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.2355923652648926
Epoch: 7, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.483 Vali Acc: 0.458 Test Loss: 1.483 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.2632122039794922
Epoch: 8, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.469 Vali Acc: 0.466 Test Loss: 1.469 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.260352373123169
Epoch: 9, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.1931889057159424
Epoch: 10, Steps: 8 | Train Loss: 0.398 Vali Loss: 1.446 Vali Acc: 0.496 Test Loss: 1.446 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 1.2508087158203125
Epoch: 11, Steps: 8 | Train Loss: 0.357 Vali Loss: 1.439 Vali Acc: 0.473 Test Loss: 1.439 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2008373737335205
Epoch: 12, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.434 Vali Acc: 0.496 Test Loss: 1.434 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 13 cost time: 1.1142091751098633
Epoch: 13, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.426 Vali Acc: 0.496 Test Loss: 1.426 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 1.234877586364746
Epoch: 14, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.429 Vali Acc: 0.527 Test Loss: 1.429 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526703).  Saving model ...
Epoch: 15 cost time: 1.0899639129638672
Epoch: 15, Steps: 8 | Train Loss: 0.177 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.259720802307129
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.440 Vali Acc: 0.466 Test Loss: 1.440 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.208998203277588
Epoch: 17, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.436 Vali Acc: 0.511 Test Loss: 1.436 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1132524013519287
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.440 Vali Acc: 0.489 Test Loss: 1.440 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.206143856048584
Epoch: 19, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.463 Vali Acc: 0.466 Test Loss: 1.463 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.257847547531128
Epoch: 20, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.485 Vali Acc: 0.489 Test Loss: 1.485 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.301192283630371
Epoch: 21, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.496 Vali Acc: 0.496 Test Loss: 1.496 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1802358627319336
Epoch: 22, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.492 Vali Acc: 0.481 Test Loss: 1.492 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2391557693481445
Epoch: 23, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1455893516540527
Epoch: 24, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.517 Vali Acc: 0.481 Test Loss: 1.517 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 95045
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9980719089508057
Epoch: 1, Steps: 8 | Train Loss: 1.657 Vali Loss: 1.613 Vali Acc: 0.344 Test Loss: 1.613 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 0.976938009262085
Epoch: 2, Steps: 8 | Train Loss: 1.488 Vali Loss: 1.640 Vali Acc: 0.420 Test Loss: 1.640 Test Acc: 0.420
Validation loss decreased (-0.343495 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.095609426498413
Epoch: 3, Steps: 8 | Train Loss: 1.312 Vali Loss: 1.634 Vali Acc: 0.435 Test Loss: 1.634 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435098).  Saving model ...
Epoch: 4 cost time: 0.9619619846343994
Epoch: 4, Steps: 8 | Train Loss: 1.174 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1493723392486572
Epoch: 5, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.536 Vali Acc: 0.458 Test Loss: 1.536 Test Acc: 0.458
Validation loss decreased (-0.435098 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.1024048328399658
Epoch: 6, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.507 Vali Acc: 0.489 Test Loss: 1.507 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.1227467060089111
Epoch: 7, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.485 Vali Acc: 0.511 Test Loss: 1.485 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.2010984420776367
Epoch: 8, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.454 Vali Acc: 0.534 Test Loss: 1.454 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 9 cost time: 1.1492834091186523
Epoch: 9, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.474 Vali Acc: 0.511 Test Loss: 1.474 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9370317459106445
Epoch: 10, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.438 Vali Acc: 0.534 Test Loss: 1.438 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 1.0604956150054932
Epoch: 11, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.478 Vali Acc: 0.542 Test Loss: 1.478 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 12 cost time: 1.0904924869537354
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.415 Vali Acc: 0.527 Test Loss: 1.415 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.224266529083252
Epoch: 13, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.501 Vali Acc: 0.573 Test Loss: 1.501 Test Acc: 0.573
Validation loss decreased (-0.541970 --> -0.572504).  Saving model ...
Epoch: 14 cost time: 1.0357120037078857
Epoch: 14, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.497 Vali Acc: 0.542 Test Loss: 1.497 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.073777675628662
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.478 Vali Acc: 0.542 Test Loss: 1.478 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.124755620956421
Epoch: 16, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.496 Vali Acc: 0.527 Test Loss: 1.496 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9833643436431885
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.514 Vali Acc: 0.534 Test Loss: 1.514 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0501999855041504
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.536 Vali Acc: 0.534 Test Loss: 1.536 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9889163970947266
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.527 Vali Acc: 0.534 Test Loss: 1.527 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.168330192565918
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.534 Vali Acc: 0.534 Test Loss: 1.534 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9396219253540039
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.545 Vali Acc: 0.534 Test Loss: 1.545 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1180305480957031
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.549 Vali Acc: 0.534 Test Loss: 1.549 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2394328117370605
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.563 Vali Acc: 0.534 Test Loss: 1.563 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 55941
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.896411418914795
Epoch: 1, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.623 Vali Acc: 0.206 Test Loss: 1.623 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.0399901866912842
Epoch: 2, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.532 Vali Acc: 0.336 Test Loss: 1.532 Test Acc: 0.336
Validation loss decreased (-0.206091 --> -0.335863).  Saving model ...
Epoch: 3 cost time: 0.9907798767089844
Epoch: 3, Steps: 8 | Train Loss: 1.437 Vali Loss: 1.524 Vali Acc: 0.405 Test Loss: 1.524 Test Acc: 0.405
Validation loss decreased (-0.335863 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.0548443794250488
Epoch: 4, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.404565 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.0252487659454346
Epoch: 5, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.471 Vali Acc: 0.458 Test Loss: 1.471 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 1.081998348236084
Epoch: 6, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.445 Vali Acc: 0.466 Test Loss: 1.445 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.1514952182769775
Epoch: 7, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.412 Vali Acc: 0.489 Test Loss: 1.412 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 1.1071300506591797
Epoch: 8, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.391 Vali Acc: 0.489 Test Loss: 1.391 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488536).  Saving model ...
Epoch: 9 cost time: 1.013350248336792
Epoch: 9, Steps: 8 | Train Loss: 0.626 Vali Loss: 1.371 Vali Acc: 0.527 Test Loss: 1.371 Test Acc: 0.527
Validation loss decreased (-0.488536 --> -0.526704).  Saving model ...
Epoch: 10 cost time: 1.0252914428710938
Epoch: 10, Steps: 8 | Train Loss: 0.513 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.1000795364379883
Epoch: 11, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.325 Vali Acc: 0.550 Test Loss: 1.325 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549605).  Saving model ...
Epoch: 12 cost time: 1.0023143291473389
Epoch: 12, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.306 Vali Acc: 0.557 Test Loss: 1.306 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557239).  Saving model ...
Epoch: 13 cost time: 1.1365747451782227
Epoch: 13, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.298 Vali Acc: 0.527 Test Loss: 1.298 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0087056159973145
Epoch: 14, Steps: 8 | Train Loss: 0.175 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1357157230377197
Epoch: 15, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1119816303253174
Epoch: 16, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.290 Vali Acc: 0.534 Test Loss: 1.290 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9949707984924316
Epoch: 17, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.309 Vali Acc: 0.542 Test Loss: 1.309 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0694572925567627
Epoch: 18, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.320 Vali Acc: 0.542 Test Loss: 1.320 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.180189847946167
Epoch: 19, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.320 Vali Acc: 0.534 Test Loss: 1.320 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9389326572418213
Epoch: 20, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.305 Vali Acc: 0.527 Test Loss: 1.305 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1294889450073242
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.311 Vali Acc: 0.527 Test Loss: 1.311 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.089170217514038
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.303 Vali Acc: 0.519 Test Loss: 1.303 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 43941
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1144330501556396
Epoch: 1, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.735 Vali Acc: 0.244 Test Loss: 1.735 Test Acc: 0.244
Validation loss decreased (inf --> -0.244257).  Saving model ...
Epoch: 2 cost time: 1.1195356845855713
Epoch: 2, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.664 Vali Acc: 0.244 Test Loss: 1.664 Test Acc: 0.244
Validation loss decreased (-0.244257 --> -0.244258).  Saving model ...
Epoch: 3 cost time: 1.1404955387115479
Epoch: 3, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.635 Vali Acc: 0.374 Test Loss: 1.635 Test Acc: 0.374
Validation loss decreased (-0.244258 --> -0.374029).  Saving model ...
Epoch: 4 cost time: 1.0983455181121826
Epoch: 4, Steps: 8 | Train Loss: 1.260 Vali Loss: 1.643 Vali Acc: 0.366 Test Loss: 1.643 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.175893783569336
Epoch: 5, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.644 Vali Acc: 0.397 Test Loss: 1.644 Test Acc: 0.397
Validation loss decreased (-0.374029 --> -0.396930).  Saving model ...
Epoch: 6 cost time: 1.1432719230651855
Epoch: 6, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.608 Vali Acc: 0.412 Test Loss: 1.608 Test Acc: 0.412
Validation loss decreased (-0.396930 --> -0.412198).  Saving model ...
Epoch: 7 cost time: 1.194126844406128
Epoch: 7, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.1710681915283203
Epoch: 8, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.535 Vali Acc: 0.427 Test Loss: 1.535 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 9 cost time: 0.9613070487976074
Epoch: 9, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.506 Vali Acc: 0.427 Test Loss: 1.506 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 10 cost time: 1.0301811695098877
Epoch: 10, Steps: 8 | Train Loss: 0.564 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 11 cost time: 1.0863101482391357
Epoch: 11, Steps: 8 | Train Loss: 0.491 Vali Loss: 1.477 Vali Acc: 0.427 Test Loss: 1.477 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.097100019454956
Epoch: 12, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.466 Vali Acc: 0.450 Test Loss: 1.466 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 13 cost time: 1.0590894222259521
Epoch: 13, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.471 Vali Acc: 0.466 Test Loss: 1.471 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 14 cost time: 0.9917616844177246
Epoch: 14, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.447 Vali Acc: 0.473 Test Loss: 1.447 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 15 cost time: 1.0683660507202148
Epoch: 15, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.446 Vali Acc: 0.466 Test Loss: 1.446 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.01957368850708
Epoch: 16, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.457 Vali Acc: 0.473 Test Loss: 1.457 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2253220081329346
Epoch: 17, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.465 Vali Acc: 0.481 Test Loss: 1.465 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 18 cost time: 1.0375406742095947
Epoch: 18, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1007194519042969
Epoch: 19, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.491 Vali Acc: 0.473 Test Loss: 1.491 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0985190868377686
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.486 Vali Acc: 0.466 Test Loss: 1.486 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1326956748962402
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.488 Vali Acc: 0.466 Test Loss: 1.488 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1712994575500488
Epoch: 22, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.498 Vali Acc: 0.466 Test Loss: 1.498 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0752878189086914
Epoch: 23, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.506 Vali Acc: 0.466 Test Loss: 1.506 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1260945796966553
Epoch: 24, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.526 Vali Acc: 0.466 Test Loss: 1.526 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1593513488769531
Epoch: 25, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.542 Vali Acc: 0.466 Test Loss: 1.542 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2055466175079346
Epoch: 26, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.554 Vali Acc: 0.466 Test Loss: 1.554 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1546666622161865
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.554 Vali Acc: 0.466 Test Loss: 1.554 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 44885
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.976113796234131
Epoch: 1, Steps: 8 | Train Loss: 1.742 Vali Loss: 1.781 Vali Acc: 0.145 Test Loss: 1.781 Test Acc: 0.145
Validation loss decreased (inf --> -0.145020).  Saving model ...
Epoch: 2 cost time: 1.014549970626831
Epoch: 2, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.759 Vali Acc: 0.168 Test Loss: 1.759 Test Acc: 0.168
Validation loss decreased (-0.145020 --> -0.167921).  Saving model ...
Epoch: 3 cost time: 1.0640966892242432
Epoch: 3, Steps: 8 | Train Loss: 1.465 Vali Loss: 1.709 Vali Acc: 0.260 Test Loss: 1.709 Test Acc: 0.260
Validation loss decreased (-0.167921 --> -0.259525).  Saving model ...
Epoch: 4 cost time: 1.146183967590332
Epoch: 4, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.671 Vali Acc: 0.336 Test Loss: 1.671 Test Acc: 0.336
Validation loss decreased (-0.259525 --> -0.335861).  Saving model ...
Epoch: 5 cost time: 1.1280736923217773
Epoch: 5, Steps: 8 | Train Loss: 1.140 Vali Loss: 1.643 Vali Acc: 0.351 Test Loss: 1.643 Test Acc: 0.351
Validation loss decreased (-0.335861 --> -0.351129).  Saving model ...
Epoch: 6 cost time: 1.048515796661377
Epoch: 6, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.620 Vali Acc: 0.382 Test Loss: 1.620 Test Acc: 0.382
Validation loss decreased (-0.351129 --> -0.381663).  Saving model ...
Epoch: 7 cost time: 1.188225269317627
Epoch: 7, Steps: 8 | Train Loss: 0.887 Vali Loss: 1.596 Vali Acc: 0.397 Test Loss: 1.596 Test Acc: 0.397
Validation loss decreased (-0.381663 --> -0.396931).  Saving model ...
Epoch: 8 cost time: 1.1338777542114258
Epoch: 8, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.576 Vali Acc: 0.435 Test Loss: 1.576 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 9 cost time: 1.165468692779541
Epoch: 9, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.548 Vali Acc: 0.466 Test Loss: 1.548 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465633).  Saving model ...
Epoch: 10 cost time: 1.0697994232177734
Epoch: 10, Steps: 8 | Train Loss: 0.568 Vali Loss: 1.531 Vali Acc: 0.466 Test Loss: 1.531 Test Acc: 0.466
Validation loss decreased (-0.465633 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 1.0076096057891846
Epoch: 11, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 12 cost time: 1.055366039276123
Epoch: 12, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0949389934539795
Epoch: 13, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.528 Vali Acc: 0.496 Test Loss: 1.528 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 14 cost time: 0.9714498519897461
Epoch: 14, Steps: 8 | Train Loss: 0.287 Vali Loss: 1.521 Vali Acc: 0.489 Test Loss: 1.521 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0407147407531738
Epoch: 15, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 16 cost time: 1.0899269580841064
Epoch: 16, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9770433902740479
Epoch: 17, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.548 Vali Acc: 0.504 Test Loss: 1.548 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0673480033874512
Epoch: 18, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.556 Vali Acc: 0.496 Test Loss: 1.556 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0289502143859863
Epoch: 19, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.578 Vali Acc: 0.496 Test Loss: 1.578 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.034026861190796
Epoch: 20, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.595 Vali Acc: 0.504 Test Loss: 1.595 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.102219820022583
Epoch: 21, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.586 Vali Acc: 0.504 Test Loss: 1.586 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1053364276885986
Epoch: 22, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.594 Vali Acc: 0.504 Test Loss: 1.594 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3215947151184082
Epoch: 23, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.605 Vali Acc: 0.511 Test Loss: 1.605 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511434).  Saving model ...
Epoch: 24 cost time: 1.033186435699463
Epoch: 24, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1558570861816406
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.635 Vali Acc: 0.511 Test Loss: 1.635 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1454520225524902
Epoch: 26, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
Validation loss decreased (-0.511434 --> -0.519068).  Saving model ...
Epoch: 27 cost time: 1.2240467071533203
Epoch: 27, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.642 Vali Acc: 0.519 Test Loss: 1.642 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0732290744781494
Epoch: 28, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.654 Vali Acc: 0.519 Test Loss: 1.654 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1264259815216064
Epoch: 29, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1258227825164795
Epoch: 30, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.686 Vali Acc: 0.511 Test Loss: 1.686 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1317734718322754
Epoch: 31, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.684 Vali Acc: 0.511 Test Loss: 1.684 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.145906925201416
Epoch: 32, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.679 Vali Acc: 0.511 Test Loss: 1.679 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0633716583251953
Epoch: 33, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.684 Vali Acc: 0.519 Test Loss: 1.684 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1508119106292725
Epoch: 34, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.709 Vali Acc: 0.527 Test Loss: 1.709 Test Acc: 0.527
Validation loss decreased (-0.519068 --> -0.526700).  Saving model ...
Epoch: 35 cost time: 1.2369153499603271
Epoch: 35, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2614860534667969
Epoch: 36, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.175055742263794
Epoch: 37, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.722 Vali Acc: 0.534 Test Loss: 1.722 Test Acc: 0.534
Validation loss decreased (-0.526700 --> -0.534334).  Saving model ...
Epoch: 38 cost time: 1.2319982051849365
Epoch: 38, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.723 Vali Acc: 0.534 Test Loss: 1.723 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0263803005218506
Epoch: 39, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.728 Vali Acc: 0.519 Test Loss: 1.728 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.11259126663208
Epoch: 40, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.731 Vali Acc: 0.527 Test Loss: 1.731 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.05340576171875
Epoch: 41, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.736 Vali Acc: 0.511 Test Loss: 1.736 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0626437664031982
Epoch: 42, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.749 Vali Acc: 0.519 Test Loss: 1.749 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1485342979431152
Epoch: 43, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.756 Vali Acc: 0.519 Test Loss: 1.756 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1972627639770508
Epoch: 44, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.758 Vali Acc: 0.519 Test Loss: 1.758 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1049072742462158
Epoch: 45, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.753 Vali Acc: 0.519 Test Loss: 1.753 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1590654850006104
Epoch: 46, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.761 Vali Acc: 0.519 Test Loss: 1.761 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.2230896949768066
Epoch: 47, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.766 Vali Acc: 0.519 Test Loss: 1.766 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 48725
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.117130994796753
Epoch: 1, Steps: 8 | Train Loss: 1.782 Vali Loss: 1.734 Vali Acc: 0.130 Test Loss: 1.734 Test Acc: 0.130
Validation loss decreased (inf --> -0.129754).  Saving model ...
Epoch: 2 cost time: 1.1787896156311035
Epoch: 2, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.722 Vali Acc: 0.198 Test Loss: 1.722 Test Acc: 0.198
Validation loss decreased (-0.129754 --> -0.198456).  Saving model ...
Epoch: 3 cost time: 1.2095065116882324
Epoch: 3, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.706 Vali Acc: 0.237 Test Loss: 1.706 Test Acc: 0.237
Validation loss decreased (-0.198456 --> -0.236624).  Saving model ...
Epoch: 4 cost time: 1.0994830131530762
Epoch: 4, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.687 Vali Acc: 0.290 Test Loss: 1.687 Test Acc: 0.290
Validation loss decreased (-0.236624 --> -0.290059).  Saving model ...
Epoch: 5 cost time: 1.0752358436584473
Epoch: 5, Steps: 8 | Train Loss: 1.133 Vali Loss: 1.667 Vali Acc: 0.336 Test Loss: 1.667 Test Acc: 0.336
Validation loss decreased (-0.290059 --> -0.335861).  Saving model ...
Epoch: 6 cost time: 1.044182300567627
Epoch: 6, Steps: 8 | Train Loss: 1.022 Vali Loss: 1.648 Vali Acc: 0.366 Test Loss: 1.648 Test Acc: 0.366
Validation loss decreased (-0.335861 --> -0.366396).  Saving model ...
Epoch: 7 cost time: 0.9901745319366455
Epoch: 7, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.643 Vali Acc: 0.405 Test Loss: 1.643 Test Acc: 0.405
Validation loss decreased (-0.366396 --> -0.404564).  Saving model ...
Epoch: 8 cost time: 1.1827068328857422
Epoch: 8, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.621 Vali Acc: 0.412 Test Loss: 1.621 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412198).  Saving model ...
Epoch: 9 cost time: 1.1942954063415527
Epoch: 9, Steps: 8 | Train Loss: 0.676 Vali Loss: 1.609 Vali Acc: 0.450 Test Loss: 1.609 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450366).  Saving model ...
Epoch: 10 cost time: 1.2021386623382568
Epoch: 10, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.599 Vali Acc: 0.450 Test Loss: 1.599 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 11 cost time: 1.1827962398529053
Epoch: 11, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.587 Vali Acc: 0.450 Test Loss: 1.587 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 12 cost time: 1.1395952701568604
Epoch: 12, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.588 Vali Acc: 0.435 Test Loss: 1.588 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1417219638824463
Epoch: 13, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.579 Vali Acc: 0.443 Test Loss: 1.579 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.208451271057129
Epoch: 14, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.574 Vali Acc: 0.458 Test Loss: 1.574 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 15 cost time: 1.131784200668335
Epoch: 15, Steps: 8 | Train Loss: 0.281 Vali Loss: 1.570 Vali Acc: 0.473 Test Loss: 1.570 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 16 cost time: 1.1582021713256836
Epoch: 16, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488534).  Saving model ...
Epoch: 17 cost time: 1.162576675415039
Epoch: 17, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2437889575958252
Epoch: 18, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.564 Vali Acc: 0.496 Test Loss: 1.564 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496168).  Saving model ...
Epoch: 19 cost time: 1.249781847000122
Epoch: 19, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1431825160980225
Epoch: 20, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.567 Vali Acc: 0.496 Test Loss: 1.567 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2328510284423828
Epoch: 21, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.591 Vali Acc: 0.466 Test Loss: 1.591 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2175195217132568
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.610 Vali Acc: 0.458 Test Loss: 1.610 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2253942489624023
Epoch: 23, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.599 Vali Acc: 0.473 Test Loss: 1.599 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2477619647979736
Epoch: 24, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.604 Vali Acc: 0.489 Test Loss: 1.604 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2272045612335205
Epoch: 25, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.612 Vali Acc: 0.473 Test Loss: 1.612 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2784996032714844
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.616 Vali Acc: 0.481 Test Loss: 1.616 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.163315773010254
Epoch: 27, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.636 Vali Acc: 0.504 Test Loss: 1.636 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503800).  Saving model ...
Epoch: 28 cost time: 1.293644666671753
Epoch: 28, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.652 Vali Acc: 0.489 Test Loss: 1.652 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2268118858337402
Epoch: 29, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.654 Vali Acc: 0.496 Test Loss: 1.654 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.228449821472168
Epoch: 30, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.652 Vali Acc: 0.481 Test Loss: 1.652 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2299199104309082
Epoch: 31, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.665 Vali Acc: 0.481 Test Loss: 1.665 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2296855449676514
Epoch: 32, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.664 Vali Acc: 0.473 Test Loss: 1.664 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.350529670715332
Epoch: 33, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.657 Vali Acc: 0.489 Test Loss: 1.657 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0915844440460205
Epoch: 34, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.655 Vali Acc: 0.481 Test Loss: 1.655 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1497225761413574
Epoch: 35, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.663 Vali Acc: 0.489 Test Loss: 1.663 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0522489547729492
Epoch: 36, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.684 Vali Acc: 0.489 Test Loss: 1.684 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1285598278045654
Epoch: 37, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.696 Vali Acc: 0.489 Test Loss: 1.696 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 60229
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.236783266067505
Epoch: 1, Steps: 8 | Train Loss: 1.755 Vali Loss: 1.806 Vali Acc: 0.137 Test Loss: 1.806 Test Acc: 0.137
Validation loss decreased (inf --> -0.137387).  Saving model ...
Epoch: 2 cost time: 1.383504867553711
Epoch: 2, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.750 Vali Acc: 0.160 Test Loss: 1.750 Test Acc: 0.160
Validation loss decreased (-0.137387 --> -0.160288).  Saving model ...
Epoch: 3 cost time: 1.261733055114746
Epoch: 3, Steps: 8 | Train Loss: 1.481 Vali Loss: 1.696 Vali Acc: 0.183 Test Loss: 1.696 Test Acc: 0.183
Validation loss decreased (-0.160288 --> -0.183189).  Saving model ...
Epoch: 4 cost time: 1.1631159782409668
Epoch: 4, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.642 Vali Acc: 0.237 Test Loss: 1.642 Test Acc: 0.237
Validation loss decreased (-0.183189 --> -0.236625).  Saving model ...
Epoch: 5 cost time: 1.1418507099151611
Epoch: 5, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.586 Vali Acc: 0.275 Test Loss: 1.586 Test Acc: 0.275
Validation loss decreased (-0.236625 --> -0.274793).  Saving model ...
Epoch: 6 cost time: 1.3086373805999756
Epoch: 6, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.539 Vali Acc: 0.359 Test Loss: 1.539 Test Acc: 0.359
Validation loss decreased (-0.274793 --> -0.358763).  Saving model ...
Epoch: 7 cost time: 1.115645170211792
Epoch: 7, Steps: 8 | Train Loss: 0.788 Vali Loss: 1.511 Vali Acc: 0.382 Test Loss: 1.511 Test Acc: 0.382
Validation loss decreased (-0.358763 --> -0.381664).  Saving model ...
Epoch: 8 cost time: 1.1065950393676758
Epoch: 8, Steps: 8 | Train Loss: 0.624 Vali Loss: 1.506 Vali Acc: 0.412 Test Loss: 1.506 Test Acc: 0.412
Validation loss decreased (-0.381664 --> -0.412199).  Saving model ...
Epoch: 9 cost time: 1.1549313068389893
Epoch: 9, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.500 Vali Acc: 0.389 Test Loss: 1.500 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0418663024902344
Epoch: 10, Steps: 8 | Train Loss: 0.460 Vali Loss: 1.509 Vali Acc: 0.397 Test Loss: 1.509 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.085529088973999
Epoch: 11, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.510 Vali Acc: 0.374 Test Loss: 1.510 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1365728378295898
Epoch: 12, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.496 Vali Acc: 0.405 Test Loss: 1.496 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1418969631195068
Epoch: 13, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.506 Vali Acc: 0.412 Test Loss: 1.506 Test Acc: 0.412
Validation loss decreased (-0.412199 --> -0.412199).  Saving model ...
Epoch: 14 cost time: 1.1244983673095703
Epoch: 14, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
Validation loss decreased (-0.412199 --> -0.427466).  Saving model ...
Epoch: 15 cost time: 1.1314687728881836
Epoch: 15, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.521 Vali Acc: 0.420 Test Loss: 1.521 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.34932541847229
Epoch: 16, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.528 Vali Acc: 0.412 Test Loss: 1.528 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.240224838256836
Epoch: 17, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.508 Vali Acc: 0.412 Test Loss: 1.508 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.16693115234375
Epoch: 18, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.512 Vali Acc: 0.397 Test Loss: 1.512 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1324374675750732
Epoch: 19, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.533 Vali Acc: 0.382 Test Loss: 1.533 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.053818702697754
Epoch: 20, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.556 Vali Acc: 0.382 Test Loss: 1.556 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1623268127441406
Epoch: 21, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.560 Vali Acc: 0.389 Test Loss: 1.560 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0458545684814453
Epoch: 22, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.572 Vali Acc: 0.397 Test Loss: 1.572 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0407226085662842
Epoch: 23, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.590 Vali Acc: 0.389 Test Loss: 1.590 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0862581729888916
Epoch: 24, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.590 Vali Acc: 0.389 Test Loss: 1.590 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 72693
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7629499435424805
Epoch: 1, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.687 Vali Acc: 0.214 Test Loss: 1.687 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.0517067909240723
Epoch: 2, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.666 Vali Acc: 0.229 Test Loss: 1.666 Test Acc: 0.229
Validation loss decreased (-0.213724 --> -0.228991).  Saving model ...
Epoch: 3 cost time: 1.0946588516235352
Epoch: 3, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.642 Vali Acc: 0.275 Test Loss: 1.642 Test Acc: 0.275
Validation loss decreased (-0.228991 --> -0.274793).  Saving model ...
Epoch: 4 cost time: 1.1028270721435547
Epoch: 4, Steps: 8 | Train Loss: 1.230 Vali Loss: 1.613 Vali Acc: 0.336 Test Loss: 1.613 Test Acc: 0.336
Validation loss decreased (-0.274793 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 1.075636863708496
Epoch: 5, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.585 Vali Acc: 0.397 Test Loss: 1.585 Test Acc: 0.397
Validation loss decreased (-0.335862 --> -0.396931).  Saving model ...
Epoch: 6 cost time: 1.1291790008544922
Epoch: 6, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.581 Vali Acc: 0.389 Test Loss: 1.581 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3359036445617676
Epoch: 7, Steps: 8 | Train Loss: 0.703 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 1.2451403141021729
Epoch: 8, Steps: 8 | Train Loss: 0.613 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 9 cost time: 1.1832971572875977
Epoch: 9, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.555 Vali Acc: 0.405 Test Loss: 1.555 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.224914312362671
Epoch: 10, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.570 Vali Acc: 0.412 Test Loss: 1.570 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2480261325836182
Epoch: 11, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.566 Vali Acc: 0.427 Test Loss: 1.566 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 12 cost time: 1.2154955863952637
Epoch: 12, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.538 Vali Acc: 0.412 Test Loss: 1.538 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2764501571655273
Epoch: 13, Steps: 8 | Train Loss: 0.259 Vali Loss: 1.565 Vali Acc: 0.397 Test Loss: 1.565 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1997196674346924
Epoch: 14, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.559 Vali Acc: 0.389 Test Loss: 1.559 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.14518404006958
Epoch: 15, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.542 Vali Acc: 0.397 Test Loss: 1.542 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0781328678131104
Epoch: 16, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.572 Vali Acc: 0.397 Test Loss: 1.572 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0477879047393799
Epoch: 17, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.608 Vali Acc: 0.389 Test Loss: 1.608 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3127892017364502
Epoch: 18, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.591 Vali Acc: 0.374 Test Loss: 1.591 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2665438652038574
Epoch: 19, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.617 Vali Acc: 0.374 Test Loss: 1.617 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2123136520385742
Epoch: 20, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.615 Vali Acc: 0.382 Test Loss: 1.615 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2760365009307861
Epoch: 21, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.620 Vali Acc: 0.351 Test Loss: 1.620 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 86597
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1244301795959473
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.644 Vali Acc: 0.282 Test Loss: 1.644 Test Acc: 0.282
Validation loss decreased (inf --> -0.282426).  Saving model ...
Epoch: 2 cost time: 1.1147265434265137
Epoch: 2, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.667 Vali Acc: 0.412 Test Loss: 1.667 Test Acc: 0.412
Validation loss decreased (-0.282426 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.1509544849395752
Epoch: 3, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.674 Vali Acc: 0.443 Test Loss: 1.674 Test Acc: 0.443
Validation loss decreased (-0.412197 --> -0.442731).  Saving model ...
Epoch: 4 cost time: 1.218329668045044
Epoch: 4, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.595 Vali Acc: 0.443 Test Loss: 1.595 Test Acc: 0.443
Validation loss decreased (-0.442731 --> -0.442732).  Saving model ...
Epoch: 5 cost time: 1.2122626304626465
Epoch: 5, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.542 Vali Acc: 0.450 Test Loss: 1.542 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 1.1127474308013916
Epoch: 6, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.547 Vali Acc: 0.458 Test Loss: 1.547 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 1.1734402179718018
Epoch: 7, Steps: 8 | Train Loss: 0.657 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
Validation loss decreased (-0.458000 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.1189355850219727
Epoch: 8, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.470 Vali Acc: 0.511 Test Loss: 1.470 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 1.1751902103424072
Epoch: 9, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.544 Vali Acc: 0.527 Test Loss: 1.544 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526702).  Saving model ...
Epoch: 10 cost time: 0.9393229484558105
Epoch: 10, Steps: 8 | Train Loss: 0.261 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 1.2187623977661133
Epoch: 11, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.546 Vali Acc: 0.519 Test Loss: 1.546 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0984461307525635
Epoch: 12, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1162803173065186
Epoch: 13, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.497 Vali Acc: 0.519 Test Loss: 1.497 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0904390811920166
Epoch: 14, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.551 Vali Acc: 0.534 Test Loss: 1.551 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 15 cost time: 1.135787010192871
Epoch: 15, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.561 Vali Acc: 0.542 Test Loss: 1.561 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 16 cost time: 1.1216113567352295
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.560 Vali Acc: 0.550 Test Loss: 1.560 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549603).  Saving model ...
Epoch: 17 cost time: 1.1387534141540527
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.550 Vali Acc: 0.534 Test Loss: 1.550 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9861752986907959
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.564 Vali Acc: 0.534 Test Loss: 1.564 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.094773769378662
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.595 Vali Acc: 0.534 Test Loss: 1.595 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1899235248565674
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.624 Vali Acc: 0.542 Test Loss: 1.624 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3437800407409668
Epoch: 21, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.630 Vali Acc: 0.534 Test Loss: 1.630 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.386469841003418
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.613 Vali Acc: 0.534 Test Loss: 1.613 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1814193725585938
Epoch: 23, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.620 Vali Acc: 0.534 Test Loss: 1.620 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.255972146987915
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.631 Vali Acc: 0.534 Test Loss: 1.631 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1728076934814453
Epoch: 25, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.643 Vali Acc: 0.534 Test Loss: 1.643 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1670987606048584
Epoch: 26, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.652 Vali Acc: 0.534 Test Loss: 1.652 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 51717
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0175206661224365
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.707 Vali Acc: 0.244 Test Loss: 1.707 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.0889670848846436
Epoch: 2, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.690 Vali Acc: 0.366 Test Loss: 1.690 Test Acc: 0.366
Validation loss decreased (-0.244258 --> -0.366395).  Saving model ...
Epoch: 3 cost time: 1.134899616241455
Epoch: 3, Steps: 8 | Train Loss: 1.441 Vali Loss: 1.715 Vali Acc: 0.412 Test Loss: 1.715 Test Acc: 0.412
Validation loss decreased (-0.366395 --> -0.412197).  Saving model ...
Epoch: 4 cost time: 1.1713688373565674
Epoch: 4, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.721 Vali Acc: 0.420 Test Loss: 1.721 Test Acc: 0.420
Validation loss decreased (-0.412197 --> -0.419830).  Saving model ...
Epoch: 5 cost time: 1.1197776794433594
Epoch: 5, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.691 Vali Acc: 0.420 Test Loss: 1.691 Test Acc: 0.420
Validation loss decreased (-0.419830 --> -0.419830).  Saving model ...
Epoch: 6 cost time: 1.2049307823181152
Epoch: 6, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.642 Vali Acc: 0.443 Test Loss: 1.642 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442732).  Saving model ...
Epoch: 7 cost time: 1.1538724899291992
Epoch: 7, Steps: 8 | Train Loss: 0.912 Vali Loss: 1.627 Vali Acc: 0.450 Test Loss: 1.627 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450365).  Saving model ...
Epoch: 8 cost time: 1.3050551414489746
Epoch: 8, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.622 Vali Acc: 0.466 Test Loss: 1.622 Test Acc: 0.466
Validation loss decreased (-0.450365 --> -0.465633).  Saving model ...
Epoch: 9 cost time: 1.198322057723999
Epoch: 9, Steps: 8 | Train Loss: 0.641 Vali Loss: 1.589 Vali Acc: 0.496 Test Loss: 1.589 Test Acc: 0.496
Validation loss decreased (-0.465633 --> -0.496167).  Saving model ...
Epoch: 10 cost time: 1.2569010257720947
Epoch: 10, Steps: 8 | Train Loss: 0.519 Vali Loss: 1.549 Vali Acc: 0.496 Test Loss: 1.549 Test Acc: 0.496
Validation loss decreased (-0.496167 --> -0.496168).  Saving model ...
Epoch: 11 cost time: 1.1304302215576172
Epoch: 11, Steps: 8 | Train Loss: 0.415 Vali Loss: 1.528 Vali Acc: 0.504 Test Loss: 1.528 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 1.140667200088501
Epoch: 12, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.514 Vali Acc: 0.511 Test Loss: 1.514 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 13 cost time: 1.107781171798706
Epoch: 13, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 14 cost time: 1.1830544471740723
Epoch: 14, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1427087783813477
Epoch: 15, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519069).  Saving model ...
Epoch: 16 cost time: 1.1539850234985352
Epoch: 16, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.514 Vali Acc: 0.527 Test Loss: 1.514 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 17 cost time: 1.130272626876831
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.486 Vali Acc: 0.534 Test Loss: 1.486 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534336).  Saving model ...
Epoch: 18 cost time: 0.9728491306304932
Epoch: 18, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.497 Vali Acc: 0.534 Test Loss: 1.497 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0840582847595215
Epoch: 19, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.500 Vali Acc: 0.519 Test Loss: 1.500 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.214245319366455
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1843698024749756
Epoch: 21, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1720619201660156
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1148674488067627
Epoch: 23, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1740574836730957
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.597 Vali Acc: 0.519 Test Loss: 1.597 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2159621715545654
Epoch: 25, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.584 Vali Acc: 0.511 Test Loss: 1.584 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0313143730163574
Epoch: 26, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.581 Vali Acc: 0.511 Test Loss: 1.581 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0481691360473633
Epoch: 27, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.577 Vali Acc: 0.504 Test Loss: 1.577 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 39717
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.905107021331787
Epoch: 1, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.635 Vali Acc: 0.244 Test Loss: 1.635 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.1746349334716797
Epoch: 2, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.597 Vali Acc: 0.351 Test Loss: 1.597 Test Acc: 0.351
Validation loss decreased (-0.244258 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.2341294288635254
Epoch: 3, Steps: 8 | Train Loss: 1.444 Vali Loss: 1.570 Vali Acc: 0.389 Test Loss: 1.570 Test Acc: 0.389
Validation loss decreased (-0.351129 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.0934553146362305
Epoch: 4, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.568 Vali Acc: 0.389 Test Loss: 1.568 Test Acc: 0.389
Validation loss decreased (-0.389297 --> -0.389297).  Saving model ...
Epoch: 5 cost time: 1.1987755298614502
Epoch: 5, Steps: 8 | Train Loss: 1.156 Vali Loss: 1.553 Vali Acc: 0.412 Test Loss: 1.553 Test Acc: 0.412
Validation loss decreased (-0.389297 --> -0.412198).  Saving model ...
Epoch: 6 cost time: 1.0015859603881836
Epoch: 6, Steps: 8 | Train Loss: 1.074 Vali Loss: 1.524 Vali Acc: 0.443 Test Loss: 1.524 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.074836254119873
Epoch: 7, Steps: 8 | Train Loss: 0.950 Vali Loss: 1.489 Vali Acc: 0.466 Test Loss: 1.489 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.1193809509277344
Epoch: 8, Steps: 8 | Train Loss: 0.810 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.0430421829223633
Epoch: 9, Steps: 8 | Train Loss: 0.744 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 10 cost time: 1.0875422954559326
Epoch: 10, Steps: 8 | Train Loss: 0.601 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526704).  Saving model ...
Epoch: 11 cost time: 1.119680643081665
Epoch: 11, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
Validation loss decreased (-0.526704 --> -0.526704).  Saving model ...
Epoch: 12 cost time: 1.0632808208465576
Epoch: 12, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.15604829788208
Epoch: 13, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.347 Vali Acc: 0.496 Test Loss: 1.347 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2602362632751465
Epoch: 14, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.348 Vali Acc: 0.519 Test Loss: 1.348 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3127374649047852
Epoch: 15, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.345 Vali Acc: 0.496 Test Loss: 1.345 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.200371503829956
Epoch: 16, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.331 Vali Acc: 0.481 Test Loss: 1.331 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1153841018676758
Epoch: 17, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.344 Vali Acc: 0.473 Test Loss: 1.344 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1445236206054688
Epoch: 18, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.345 Vali Acc: 0.481 Test Loss: 1.345 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0818963050842285
Epoch: 19, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.377 Vali Acc: 0.489 Test Loss: 1.377 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1679027080535889
Epoch: 20, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.376 Vali Acc: 0.489 Test Loss: 1.376 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2545044422149658
Epoch: 21, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.378 Vali Acc: 0.489 Test Loss: 1.378 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 40661
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.307161331176758
Epoch: 1, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.644 Vali Acc: 0.252 Test Loss: 1.644 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.2319235801696777
Epoch: 2, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.585 Vali Acc: 0.290 Test Loss: 1.585 Test Acc: 0.290
Validation loss decreased (-0.251892 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 1.186091661453247
Epoch: 3, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.531 Vali Acc: 0.405 Test Loss: 1.531 Test Acc: 0.405
Validation loss decreased (-0.290060 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.0882225036621094
Epoch: 4, Steps: 8 | Train Loss: 1.360 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
Validation loss decreased (-0.404565 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.1383030414581299
Epoch: 5, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.485 Vali Acc: 0.443 Test Loss: 1.485 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 1.0728256702423096
Epoch: 6, Steps: 8 | Train Loss: 1.034 Vali Loss: 1.465 Vali Acc: 0.443 Test Loss: 1.465 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.0125033855438232
Epoch: 7, Steps: 8 | Train Loss: 0.951 Vali Loss: 1.444 Vali Acc: 0.481 Test Loss: 1.444 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 8 cost time: 1.2836604118347168
Epoch: 8, Steps: 8 | Train Loss: 0.814 Vali Loss: 1.416 Vali Acc: 0.458 Test Loss: 1.416 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1453688144683838
Epoch: 9, Steps: 8 | Train Loss: 0.715 Vali Loss: 1.408 Vali Acc: 0.466 Test Loss: 1.408 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.054992914199829
Epoch: 10, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.394 Vali Acc: 0.466 Test Loss: 1.394 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1740233898162842
Epoch: 11, Steps: 8 | Train Loss: 0.549 Vali Loss: 1.386 Vali Acc: 0.458 Test Loss: 1.386 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.238443374633789
Epoch: 12, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.362 Vali Acc: 0.466 Test Loss: 1.362 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1114871501922607
Epoch: 13, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.351 Vali Acc: 0.481 Test Loss: 1.351 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480903).  Saving model ...
Epoch: 14 cost time: 1.114715576171875
Epoch: 14, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.357 Vali Acc: 0.489 Test Loss: 1.357 Test Acc: 0.489
Validation loss decreased (-0.480903 --> -0.488536).  Saving model ...
Epoch: 15 cost time: 1.2195310592651367
Epoch: 15, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.358 Vali Acc: 0.473 Test Loss: 1.358 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.156132459640503
Epoch: 16, Steps: 8 | Train Loss: 0.205 Vali Loss: 1.354 Vali Acc: 0.473 Test Loss: 1.354 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.06675386428833
Epoch: 17, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.355 Vali Acc: 0.450 Test Loss: 1.355 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0906383991241455
Epoch: 18, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.363 Vali Acc: 0.450 Test Loss: 1.363 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9546782970428467
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.370 Vali Acc: 0.489 Test Loss: 1.370 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1880967617034912
Epoch: 20, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.364 Vali Acc: 0.473 Test Loss: 1.364 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1074771881103516
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.357 Vali Acc: 0.473 Test Loss: 1.357 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0400457382202148
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.351 Vali Acc: 0.496 Test Loss: 1.351 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 23 cost time: 1.2692582607269287
Epoch: 23, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.361 Vali Acc: 0.504 Test Loss: 1.361 Test Acc: 0.504
Validation loss decreased (-0.496170 --> -0.503803).  Saving model ...
Epoch: 24 cost time: 1.1835196018218994
Epoch: 24, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.375 Vali Acc: 0.489 Test Loss: 1.375 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2106120586395264
Epoch: 25, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.377 Vali Acc: 0.466 Test Loss: 1.377 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1847121715545654
Epoch: 26, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.370 Vali Acc: 0.496 Test Loss: 1.370 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1202623844146729
Epoch: 27, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.372 Vali Acc: 0.481 Test Loss: 1.372 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1348240375518799
Epoch: 28, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.383 Vali Acc: 0.489 Test Loss: 1.383 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1607739925384521
Epoch: 29, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.387 Vali Acc: 0.496 Test Loss: 1.387 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.22184419631958
Epoch: 30, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.390 Vali Acc: 0.489 Test Loss: 1.390 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.137765884399414
Epoch: 31, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.391 Vali Acc: 0.489 Test Loss: 1.391 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2081515789031982
Epoch: 32, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.385 Vali Acc: 0.496 Test Loss: 1.385 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1647436618804932
Epoch: 33, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.391 Vali Acc: 0.504 Test Loss: 1.391 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 44501
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.871528148651123
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.641 Vali Acc: 0.214 Test Loss: 1.641 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 1.0359082221984863
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.617 Vali Acc: 0.321 Test Loss: 1.617 Test Acc: 0.321
Validation loss decreased (-0.213724 --> -0.320595).  Saving model ...
Epoch: 3 cost time: 1.0721766948699951
Epoch: 3, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.594 Vali Acc: 0.328 Test Loss: 1.594 Test Acc: 0.328
Validation loss decreased (-0.320595 --> -0.328228).  Saving model ...
Epoch: 4 cost time: 1.1319928169250488
Epoch: 4, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.580 Vali Acc: 0.382 Test Loss: 1.580 Test Acc: 0.382
Validation loss decreased (-0.328228 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.1036410331726074
Epoch: 5, Steps: 8 | Train Loss: 1.061 Vali Loss: 1.578 Vali Acc: 0.405 Test Loss: 1.578 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404564).  Saving model ...
Epoch: 6 cost time: 1.1263296604156494
Epoch: 6, Steps: 8 | Train Loss: 0.936 Vali Loss: 1.576 Vali Acc: 0.412 Test Loss: 1.576 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412198).  Saving model ...
Epoch: 7 cost time: 0.9950087070465088
Epoch: 7, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.567 Vali Acc: 0.443 Test Loss: 1.567 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442732).  Saving model ...
Epoch: 8 cost time: 1.1919724941253662
Epoch: 8, Steps: 8 | Train Loss: 0.728 Vali Loss: 1.552 Vali Acc: 0.450 Test Loss: 1.552 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450366).  Saving model ...
Epoch: 9 cost time: 1.069638967514038
Epoch: 9, Steps: 8 | Train Loss: 0.649 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450366).  Saving model ...
Epoch: 10 cost time: 1.0709071159362793
Epoch: 10, Steps: 8 | Train Loss: 0.554 Vali Loss: 1.566 Vali Acc: 0.473 Test Loss: 1.566 Test Acc: 0.473
Validation loss decreased (-0.450366 --> -0.473267).  Saving model ...
Epoch: 11 cost time: 0.9615790843963623
Epoch: 11, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.554 Vali Acc: 0.496 Test Loss: 1.554 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 12 cost time: 1.1422629356384277
Epoch: 12, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.527 Vali Acc: 0.496 Test Loss: 1.527 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496168).  Saving model ...
Epoch: 13 cost time: 1.214590311050415
Epoch: 13, Steps: 8 | Train Loss: 0.352 Vali Loss: 1.520 Vali Acc: 0.496 Test Loss: 1.520 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496168).  Saving model ...
Epoch: 14 cost time: 1.1090929508209229
Epoch: 14, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.530 Vali Acc: 0.504 Test Loss: 1.530 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 15 cost time: 1.252225399017334
Epoch: 15, Steps: 8 | Train Loss: 0.247 Vali Loss: 1.527 Vali Acc: 0.511 Test Loss: 1.527 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511435).  Saving model ...
Epoch: 16 cost time: 1.1820778846740723
Epoch: 16, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.537 Vali Acc: 0.481 Test Loss: 1.537 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1128337383270264
Epoch: 17, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.551 Vali Acc: 0.504 Test Loss: 1.551 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0949153900146484
Epoch: 18, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.578 Vali Acc: 0.511 Test Loss: 1.578 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2022993564605713
Epoch: 19, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.569 Vali Acc: 0.496 Test Loss: 1.569 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.280435562133789
Epoch: 20, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.578 Vali Acc: 0.519 Test Loss: 1.578 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519068).  Saving model ...
Epoch: 21 cost time: 1.1732869148254395
Epoch: 21, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.560 Vali Acc: 0.511 Test Loss: 1.560 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1481153964996338
Epoch: 22, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.561 Vali Acc: 0.504 Test Loss: 1.561 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1010663509368896
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.582 Vali Acc: 0.504 Test Loss: 1.582 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1576757431030273
Epoch: 24, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.591 Vali Acc: 0.489 Test Loss: 1.591 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1007168292999268
Epoch: 25, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.602 Vali Acc: 0.489 Test Loss: 1.602 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.236760139465332
Epoch: 26, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.597 Vali Acc: 0.504 Test Loss: 1.597 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1799359321594238
Epoch: 27, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.601 Vali Acc: 0.504 Test Loss: 1.601 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0962505340576172
Epoch: 28, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.617 Vali Acc: 0.496 Test Loss: 1.617 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.242737054824829
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.629 Vali Acc: 0.519 Test Loss: 1.629 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2281765937805176
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.636 Vali Acc: 0.519 Test Loss: 1.636 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 56005
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8908472061157227
Epoch: 1, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.700 Vali Acc: 0.153 Test Loss: 1.700 Test Acc: 0.153
Validation loss decreased (inf --> -0.152655).  Saving model ...
Epoch: 2 cost time: 1.1122710704803467
Epoch: 2, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.667 Vali Acc: 0.191 Test Loss: 1.667 Test Acc: 0.191
Validation loss decreased (-0.152655 --> -0.190823).  Saving model ...
Epoch: 3 cost time: 1.073399543762207
Epoch: 3, Steps: 8 | Train Loss: 1.418 Vali Loss: 1.649 Vali Acc: 0.221 Test Loss: 1.649 Test Acc: 0.221
Validation loss decreased (-0.190823 --> -0.221358).  Saving model ...
Epoch: 4 cost time: 1.1867554187774658
Epoch: 4, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.637 Vali Acc: 0.267 Test Loss: 1.637 Test Acc: 0.267
Validation loss decreased (-0.221358 --> -0.267159).  Saving model ...
Epoch: 5 cost time: 1.0966053009033203
Epoch: 5, Steps: 8 | Train Loss: 1.009 Vali Loss: 1.621 Vali Acc: 0.313 Test Loss: 1.621 Test Acc: 0.313
Validation loss decreased (-0.267159 --> -0.312961).  Saving model ...
Epoch: 6 cost time: 1.111224889755249
Epoch: 6, Steps: 8 | Train Loss: 0.883 Vali Loss: 1.591 Vali Acc: 0.374 Test Loss: 1.591 Test Acc: 0.374
Validation loss decreased (-0.312961 --> -0.374030).  Saving model ...
Epoch: 7 cost time: 1.1954655647277832
Epoch: 7, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.568 Vali Acc: 0.382 Test Loss: 1.568 Test Acc: 0.382
Validation loss decreased (-0.374030 --> -0.381664).  Saving model ...
Epoch: 8 cost time: 1.1983983516693115
Epoch: 8, Steps: 8 | Train Loss: 0.606 Vali Loss: 1.548 Vali Acc: 0.397 Test Loss: 1.548 Test Acc: 0.397
Validation loss decreased (-0.381664 --> -0.396931).  Saving model ...
Epoch: 9 cost time: 1.1658244132995605
Epoch: 9, Steps: 8 | Train Loss: 0.547 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (-0.396931 --> -0.419832).  Saving model ...
Epoch: 10 cost time: 1.2127342224121094
Epoch: 10, Steps: 8 | Train Loss: 0.464 Vali Loss: 1.530 Vali Acc: 0.458 Test Loss: 1.530 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 11 cost time: 1.1261775493621826
Epoch: 11, Steps: 8 | Train Loss: 0.430 Vali Loss: 1.537 Vali Acc: 0.450 Test Loss: 1.537 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1310555934906006
Epoch: 12, Steps: 8 | Train Loss: 0.332 Vali Loss: 1.555 Vali Acc: 0.443 Test Loss: 1.555 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1172478199005127
Epoch: 13, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.557 Vali Acc: 0.450 Test Loss: 1.557 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0731961727142334
Epoch: 14, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.558 Vali Acc: 0.435 Test Loss: 1.558 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2276465892791748
Epoch: 15, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.563 Vali Acc: 0.435 Test Loss: 1.563 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9992914199829102
Epoch: 16, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.563 Vali Acc: 0.443 Test Loss: 1.563 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3079571723937988
Epoch: 17, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.573 Vali Acc: 0.450 Test Loss: 1.573 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2071521282196045
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.572 Vali Acc: 0.450 Test Loss: 1.572 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2115912437438965
Epoch: 19, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3331644535064697
Epoch: 20, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.601 Vali Acc: 0.443 Test Loss: 1.601 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 68469
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.736637592315674
Epoch: 1, Steps: 8 | Train Loss: 1.851 Vali Loss: 1.685 Vali Acc: 0.198 Test Loss: 1.685 Test Acc: 0.198
Validation loss decreased (inf --> -0.198456).  Saving model ...
Epoch: 2 cost time: 1.1450045108795166
Epoch: 2, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.688 Vali Acc: 0.237 Test Loss: 1.688 Test Acc: 0.237
Validation loss decreased (-0.198456 --> -0.236624).  Saving model ...
Epoch: 3 cost time: 1.0773870944976807
Epoch: 3, Steps: 8 | Train Loss: 1.497 Vali Loss: 1.664 Vali Acc: 0.282 Test Loss: 1.664 Test Acc: 0.282
Validation loss decreased (-0.236624 --> -0.282426).  Saving model ...
Epoch: 4 cost time: 1.0938105583190918
Epoch: 4, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.627 Vali Acc: 0.321 Test Loss: 1.627 Test Acc: 0.321
Validation loss decreased (-0.282426 --> -0.320594).  Saving model ...
Epoch: 5 cost time: 1.1284005641937256
Epoch: 5, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.597 Vali Acc: 0.344 Test Loss: 1.597 Test Acc: 0.344
Validation loss decreased (-0.320594 --> -0.343495).  Saving model ...
Epoch: 6 cost time: 1.3160297870635986
Epoch: 6, Steps: 8 | Train Loss: 0.856 Vali Loss: 1.572 Vali Acc: 0.374 Test Loss: 1.572 Test Acc: 0.374
Validation loss decreased (-0.343495 --> -0.374030).  Saving model ...
Epoch: 7 cost time: 1.2740893363952637
Epoch: 7, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.519 Vali Acc: 0.458 Test Loss: 1.519 Test Acc: 0.458
Validation loss decreased (-0.374030 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.1409108638763428
Epoch: 8, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.497 Vali Acc: 0.443 Test Loss: 1.497 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.165320873260498
Epoch: 9, Steps: 8 | Train Loss: 0.493 Vali Loss: 1.465 Vali Acc: 0.443 Test Loss: 1.465 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1390042304992676
Epoch: 10, Steps: 8 | Train Loss: 0.424 Vali Loss: 1.457 Vali Acc: 0.435 Test Loss: 1.457 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0809249877929688
Epoch: 11, Steps: 8 | Train Loss: 0.353 Vali Loss: 1.459 Vali Acc: 0.405 Test Loss: 1.459 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1421160697937012
Epoch: 12, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.437 Vali Acc: 0.450 Test Loss: 1.437 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0634891986846924
Epoch: 13, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.434 Vali Acc: 0.435 Test Loss: 1.434 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1335937976837158
Epoch: 14, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.440 Vali Acc: 0.450 Test Loss: 1.440 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1388592720031738
Epoch: 15, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.444 Vali Acc: 0.473 Test Loss: 1.444 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 16 cost time: 1.1212892532348633
Epoch: 16, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0342283248901367
Epoch: 17, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.469 Vali Acc: 0.420 Test Loss: 1.469 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2432515621185303
Epoch: 18, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.462 Vali Acc: 0.450 Test Loss: 1.462 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.231945276260376
Epoch: 19, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.471 Vali Acc: 0.443 Test Loss: 1.471 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1044199466705322
Epoch: 20, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.483 Vali Acc: 0.435 Test Loss: 1.483 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.181098461151123
Epoch: 21, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0477876663208008
Epoch: 22, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.490 Vali Acc: 0.443 Test Loss: 1.490 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2009954452514648
Epoch: 23, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.497 Vali Acc: 0.450 Test Loss: 1.497 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.194587230682373
Epoch: 24, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.502 Vali Acc: 0.458 Test Loss: 1.502 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1200101375579834
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.497 Vali Acc: 0.427 Test Loss: 1.497 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el2_dm16_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 82373
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9597816467285156
Epoch: 1, Steps: 8 | Train Loss: 1.602 Vali Loss: 1.777 Vali Acc: 0.420 Test Loss: 1.777 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.40090012550354
Epoch: 2, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.551 Vali Acc: 0.328 Test Loss: 1.551 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.353079080581665
Epoch: 3, Steps: 8 | Train Loss: 0.516 Vali Loss: 1.576 Vali Acc: 0.427 Test Loss: 1.576 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.235713005065918
Epoch: 4, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.685 Vali Acc: 0.511 Test Loss: 1.685 Test Acc: 0.511
Validation loss decreased (-0.427465 --> -0.511434).  Saving model ...
Epoch: 5 cost time: 1.269618272781372
Epoch: 5, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.732 Vali Acc: 0.504 Test Loss: 1.732 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.384385108947754
Epoch: 6, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.866 Vali Acc: 0.534 Test Loss: 1.866 Test Acc: 0.534
Validation loss decreased (-0.511434 --> -0.534332).  Saving model ...
Epoch: 7 cost time: 1.243600845336914
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.989 Vali Acc: 0.504 Test Loss: 1.989 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3968234062194824
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.569 Vali Acc: 0.519 Test Loss: 2.569 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4097075462341309
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.503 Vali Acc: 0.534 Test Loss: 2.503 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3973305225372314
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.239 Vali Acc: 0.519 Test Loss: 2.239 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2637286186218262
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.511 Test Loss: 2.124 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4284663200378418
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.511 Test Loss: 2.136 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3630685806274414
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.527 Test Loss: 2.191 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4904367923736572
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.240 Vali Acc: 0.527 Test Loss: 2.240 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3494517803192139
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.542 Test Loss: 2.275 Test Acc: 0.542
Validation loss decreased (-0.534332 --> -0.541962).  Saving model ...
Epoch: 16 cost time: 1.2492706775665283
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.542 Test Loss: 2.284 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3854565620422363
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.542 Test Loss: 2.275 Test Acc: 0.542
Validation loss decreased (-0.541962 --> -0.541962).  Saving model ...
Epoch: 18 cost time: 1.3695478439331055
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.271 Vali Acc: 0.542 Test Loss: 2.271 Test Acc: 0.542
Validation loss decreased (-0.541962 --> -0.541962).  Saving model ...
Epoch: 19 cost time: 1.198413610458374
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.542 Test Loss: 2.276 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2315034866333008
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.542 Test Loss: 2.291 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.521561622619629
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.297 Vali Acc: 0.542 Test Loss: 2.297 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2618672847747803
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.288 Vali Acc: 0.542 Test Loss: 2.288 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1137735843658447
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.299 Vali Acc: 0.542 Test Loss: 2.299 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2864196300506592
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.302 Vali Acc: 0.542 Test Loss: 2.302 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.389446496963501
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.315 Vali Acc: 0.542 Test Loss: 2.315 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3131325244903564
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.542 Test Loss: 2.328 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3532395362854004
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.542 Test Loss: 2.330 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4121325016021729
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.338 Vali Acc: 0.542 Test Loss: 2.338 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 493701
model size : 10.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.815770149230957
Epoch: 1, Steps: 8 | Train Loss: 1.570 Vali Loss: 1.727 Vali Acc: 0.420 Test Loss: 1.727 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.1228528022766113
Epoch: 2, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.680 Vali Acc: 0.435 Test Loss: 1.680 Test Acc: 0.435
Validation loss decreased (-0.419830 --> -0.435098).  Saving model ...
Epoch: 3 cost time: 1.1188585758209229
Epoch: 3, Steps: 8 | Train Loss: 0.813 Vali Loss: 1.549 Vali Acc: 0.481 Test Loss: 1.549 Test Acc: 0.481
Validation loss decreased (-0.435098 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.1355438232421875
Epoch: 4, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.521 Vali Acc: 0.511 Test Loss: 1.521 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 1.1790978908538818
Epoch: 5, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.506 Vali Acc: 0.489 Test Loss: 1.506 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2172887325286865
Epoch: 6, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.660 Vali Acc: 0.511 Test Loss: 1.660 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1329734325408936
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.629 Vali Acc: 0.511 Test Loss: 1.629 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1701200008392334
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.669 Vali Acc: 0.519 Test Loss: 1.669 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519067).  Saving model ...
Epoch: 9 cost time: 1.0801098346710205
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.740 Vali Acc: 0.511 Test Loss: 1.740 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.050877571105957
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.511 Test Loss: 1.782 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0930578708648682
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.511 Test Loss: 1.808 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0087330341339111
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.511 Test Loss: 1.827 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1213762760162354
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.504 Test Loss: 1.814 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1306028366088867
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.504 Test Loss: 1.821 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2514214515686035
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.504 Test Loss: 1.834 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1605820655822754
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.504 Test Loss: 1.828 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.032257318496704
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.504 Test Loss: 1.831 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1146326065063477
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.504 Test Loss: 1.843 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 397701
model size : 10.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.933521270751953
Epoch: 1, Steps: 8 | Train Loss: 1.702 Vali Loss: 1.628 Vali Acc: 0.344 Test Loss: 1.628 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 1.1263823509216309
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.739 Vali Acc: 0.420 Test Loss: 1.739 Test Acc: 0.420
Validation loss decreased (-0.343495 --> -0.419830).  Saving model ...
Epoch: 3 cost time: 1.2065327167510986
Epoch: 3, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.562 Vali Acc: 0.397 Test Loss: 1.562 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1732017993927002
Epoch: 4, Steps: 8 | Train Loss: 0.566 Vali Loss: 1.505 Vali Acc: 0.473 Test Loss: 1.505 Test Acc: 0.473
Validation loss decreased (-0.419830 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.2054948806762695
Epoch: 5, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.580 Vali Acc: 0.511 Test Loss: 1.580 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511435).  Saving model ...
Epoch: 6 cost time: 1.166487216949463
Epoch: 6, Steps: 8 | Train Loss: 0.106 Vali Loss: 1.550 Vali Acc: 0.511 Test Loss: 1.550 Test Acc: 0.511
Validation loss decreased (-0.511435 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.1411185264587402
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.745 Vali Acc: 0.527 Test Loss: 1.745 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526700).  Saving model ...
Epoch: 8 cost time: 1.2964966297149658
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.704 Vali Acc: 0.534 Test Loss: 1.704 Test Acc: 0.534
Validation loss decreased (-0.526700 --> -0.534334).  Saving model ...
Epoch: 9 cost time: 1.2327046394348145
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.777 Vali Acc: 0.534 Test Loss: 1.777 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2162203788757324
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.854 Vali Acc: 0.527 Test Loss: 1.854 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0704517364501953
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.850 Vali Acc: 0.519 Test Loss: 1.850 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.146890640258789
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.841 Vali Acc: 0.511 Test Loss: 1.841 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.408719539642334
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.856 Vali Acc: 0.511 Test Loss: 1.856 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.202819585800171
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.519 Test Loss: 1.867 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2227191925048828
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.878 Vali Acc: 0.519 Test Loss: 1.878 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3396341800689697
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.894 Vali Acc: 0.519 Test Loss: 1.894 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.155085802078247
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.904 Vali Acc: 0.519 Test Loss: 1.904 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1712977886199951
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.519 Test Loss: 1.917 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 405253
model size : 10.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.930326461791992
Epoch: 1, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.606 Vali Acc: 0.344 Test Loss: 1.606 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 1.1077992916107178
Epoch: 2, Steps: 8 | Train Loss: 1.346 Vali Loss: 1.658 Vali Acc: 0.412 Test Loss: 1.658 Test Acc: 0.412
Validation loss decreased (-0.343495 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.0439131259918213
Epoch: 3, Steps: 8 | Train Loss: 0.962 Vali Loss: 1.550 Vali Acc: 0.473 Test Loss: 1.550 Test Acc: 0.473
Validation loss decreased (-0.412197 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.1466143131256104
Epoch: 4, Steps: 8 | Train Loss: 0.532 Vali Loss: 1.466 Vali Acc: 0.466 Test Loss: 1.466 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1403520107269287
Epoch: 5, Steps: 8 | Train Loss: 0.276 Vali Loss: 1.465 Vali Acc: 0.489 Test Loss: 1.465 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 0.9951655864715576
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.456 Vali Acc: 0.489 Test Loss: 1.456 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.430957555770874
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.532 Vali Acc: 0.489 Test Loss: 1.532 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2708768844604492
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.540 Vali Acc: 0.511 Test Loss: 1.540 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.1036548614501953
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.593 Vali Acc: 0.511 Test Loss: 1.593 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2024025917053223
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.619 Vali Acc: 0.511 Test Loss: 1.619 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.214454174041748
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.653 Vali Acc: 0.511 Test Loss: 1.653 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4129722118377686
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.680 Vali Acc: 0.519 Test Loss: 1.680 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519067).  Saving model ...
Epoch: 13 cost time: 1.0803236961364746
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.519 Test Loss: 1.682 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3223719596862793
Epoch: 14, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1860685348510742
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.687 Vali Acc: 0.519 Test Loss: 1.687 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2431206703186035
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.692 Vali Acc: 0.519 Test Loss: 1.692 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.278456449508667
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.697 Vali Acc: 0.519 Test Loss: 1.697 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.210815668106079
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.519 Test Loss: 1.706 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.30198335647583
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.519 Test Loss: 1.713 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3237199783325195
Epoch: 20, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.717 Vali Acc: 0.519 Test Loss: 1.717 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2306065559387207
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.711 Vali Acc: 0.511 Test Loss: 1.711 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2506556510925293
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.511 Test Loss: 1.722 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 435973
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0749247074127197
Epoch: 1, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.541 Vali Acc: 0.374 Test Loss: 1.541 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.343888759613037
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.513 Vali Acc: 0.405 Test Loss: 1.513 Test Acc: 0.405
Validation loss decreased (-0.374030 --> -0.404565).  Saving model ...
Epoch: 3 cost time: 1.3216092586517334
Epoch: 3, Steps: 8 | Train Loss: 0.923 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
Validation loss decreased (-0.404565 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.4906296730041504
Epoch: 4, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.3968071937561035
Epoch: 5, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.409 Vali Acc: 0.489 Test Loss: 1.409 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.414923906326294
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.468 Vali Acc: 0.504 Test Loss: 1.468 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.4209024906158447
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.496 Vali Acc: 0.504 Test Loss: 1.496 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.306281566619873
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.1214041709899902
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.554 Vali Acc: 0.519 Test Loss: 1.554 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519068).  Saving model ...
Epoch: 10 cost time: 1.2019479274749756
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.568 Vali Acc: 0.519 Test Loss: 1.568 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.202723503112793
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2074470520019531
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.616 Vali Acc: 0.527 Test Loss: 1.616 Test Acc: 0.527
Validation loss decreased (-0.519068 --> -0.526701).  Saving model ...
Epoch: 13 cost time: 1.3039987087249756
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.640 Vali Acc: 0.519 Test Loss: 1.640 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.661956548690796
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.44974684715271
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2267744541168213
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2200489044189453
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.680 Vali Acc: 0.519 Test Loss: 1.680 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3745996952056885
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.519 Test Loss: 1.689 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3363511562347412
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.699 Vali Acc: 0.519 Test Loss: 1.699 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.354943037033081
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.709 Vali Acc: 0.519 Test Loss: 1.709 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3745191097259521
Epoch: 21, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.717 Vali Acc: 0.519 Test Loss: 1.717 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2268455028533936
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.725 Vali Acc: 0.519 Test Loss: 1.725 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 528005
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.902555227279663
Epoch: 1, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.544 Vali Acc: 0.298 Test Loss: 1.544 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.2682170867919922
Epoch: 2, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.496 Vali Acc: 0.374 Test Loss: 1.496 Test Acc: 0.374
Validation loss decreased (-0.297694 --> -0.374031).  Saving model ...
Epoch: 3 cost time: 0.9612572193145752
Epoch: 3, Steps: 8 | Train Loss: 0.822 Vali Loss: 1.454 Vali Acc: 0.481 Test Loss: 1.454 Test Acc: 0.481
Validation loss decreased (-0.374031 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.1398615837097168
Epoch: 4, Steps: 8 | Train Loss: 0.478 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.0557947158813477
Epoch: 5, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.200547218322754
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.417 Vali Acc: 0.527 Test Loss: 1.417 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.146775484085083
Epoch: 7, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.447 Vali Acc: 0.542 Test Loss: 1.447 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 8 cost time: 1.1141064167022705
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1952886581420898
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1857702732086182
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0471110343933105
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9605510234832764
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0253939628601074
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0633165836334229
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.600 Vali Acc: 0.511 Test Loss: 1.600 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0911304950714111
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.605 Vali Acc: 0.511 Test Loss: 1.605 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1025898456573486
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.609 Vali Acc: 0.504 Test Loss: 1.609 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0756800174713135
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.619 Vali Acc: 0.504 Test Loss: 1.619 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 627717
model size : 11.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8546993732452393
Epoch: 1, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.670 Vali Acc: 0.206 Test Loss: 1.670 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 0.984891414642334
Epoch: 2, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.578 Vali Acc: 0.275 Test Loss: 1.578 Test Acc: 0.275
Validation loss decreased (-0.206090 --> -0.274793).  Saving model ...
Epoch: 3 cost time: 1.0498933792114258
Epoch: 3, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.527 Vali Acc: 0.359 Test Loss: 1.527 Test Acc: 0.359
Validation loss decreased (-0.274793 --> -0.358763).  Saving model ...
Epoch: 4 cost time: 1.1495182514190674
Epoch: 4, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.526 Vali Acc: 0.405 Test Loss: 1.526 Test Acc: 0.405
Validation loss decreased (-0.358763 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 1.062962293624878
Epoch: 5, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.534 Vali Acc: 0.420 Test Loss: 1.534 Test Acc: 0.420
Validation loss decreased (-0.404565 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 1.1206653118133545
Epoch: 6, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.551 Vali Acc: 0.450 Test Loss: 1.551 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 1.0472331047058105
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.605 Vali Acc: 0.458 Test Loss: 1.605 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.457999).  Saving model ...
Epoch: 8 cost time: 0.9638698101043701
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.629 Vali Acc: 0.450 Test Loss: 1.629 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0632870197296143
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.641 Vali Acc: 0.466 Test Loss: 1.641 Test Acc: 0.466
Validation loss decreased (-0.457999 --> -0.465632).  Saving model ...
Epoch: 10 cost time: 1.0492675304412842
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.657 Vali Acc: 0.473 Test Loss: 1.657 Test Acc: 0.473
Validation loss decreased (-0.465632 --> -0.473266).  Saving model ...
Epoch: 11 cost time: 1.1319713592529297
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.670 Vali Acc: 0.473 Test Loss: 1.670 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0158705711364746
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.473 Test Loss: 1.687 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1552906036376953
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.695 Vali Acc: 0.473 Test Loss: 1.695 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0197012424468994
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.704 Vali Acc: 0.466 Test Loss: 1.704 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.06742262840271
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.466 Test Loss: 1.713 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0598435401916504
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.466 Test Loss: 1.728 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.975691556930542
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.740 Vali Acc: 0.466 Test Loss: 1.740 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0482420921325684
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.748 Vali Acc: 0.466 Test Loss: 1.748 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1481668949127197
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.758 Vali Acc: 0.466 Test Loss: 1.758 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1002421379089355
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.768 Vali Acc: 0.466 Test Loss: 1.768 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 738949
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1731138229370117
Epoch: 1, Steps: 8 | Train Loss: 1.658 Vali Loss: 1.761 Vali Acc: 0.412 Test Loss: 1.761 Test Acc: 0.412
Validation loss decreased (inf --> -0.412196).  Saving model ...
Epoch: 2 cost time: 1.2792508602142334
Epoch: 2, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.520 Vali Acc: 0.450 Test Loss: 1.520 Test Acc: 0.450
Validation loss decreased (-0.412196 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.3386967182159424
Epoch: 3, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.563 Vali Acc: 0.511 Test Loss: 1.563 Test Acc: 0.511
Validation loss decreased (-0.450366 --> -0.511435).  Saving model ...
Epoch: 4 cost time: 1.3307487964630127
Epoch: 4, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.899 Vali Acc: 0.534 Test Loss: 1.899 Test Acc: 0.534
Validation loss decreased (-0.511435 --> -0.534332).  Saving model ...
Epoch: 5 cost time: 1.2177469730377197
Epoch: 5, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.676 Vali Acc: 0.382 Test Loss: 1.676 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3142969608306885
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 2.152 Vali Acc: 0.511 Test Loss: 2.152 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3852198123931885
Epoch: 7, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.892 Vali Acc: 0.473 Test Loss: 1.892 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.168041706085205
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.274 Vali Acc: 0.511 Test Loss: 2.274 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2610571384429932
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.741 Vali Acc: 0.527 Test Loss: 2.741 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.315309762954712
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.531 Vali Acc: 0.527 Test Loss: 2.531 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3003852367401123
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.542 Test Loss: 2.413 Test Acc: 0.542
Validation loss decreased (-0.534332 --> -0.541961).  Saving model ...
Epoch: 12 cost time: 1.3428900241851807
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.542 Test Loss: 2.381 Test Acc: 0.542
Validation loss decreased (-0.541961 --> -0.541961).  Saving model ...
Epoch: 13 cost time: 1.1341564655303955
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.424 Vali Acc: 0.542 Test Loss: 2.424 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3193473815917969
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.478 Vali Acc: 0.534 Test Loss: 2.478 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.371666669845581
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.527 Test Loss: 2.510 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5159752368927002
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.527 Test Loss: 2.513 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4051332473754883
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.492 Vali Acc: 0.527 Test Loss: 2.492 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3254518508911133
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.479 Vali Acc: 0.519 Test Loss: 2.479 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3603153228759766
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.459 Vali Acc: 0.519 Test Loss: 2.459 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3910915851593018
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.444 Vali Acc: 0.519 Test Loss: 2.444 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4706342220306396
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.450 Vali Acc: 0.519 Test Loss: 2.450 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3774325847625732
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.519 Test Loss: 2.471 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 460805
model size : 10.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9964027404785156
Epoch: 1, Steps: 8 | Train Loss: 1.693 Vali Loss: 1.685 Vali Acc: 0.427 Test Loss: 1.685 Test Acc: 0.427
Validation loss decreased (inf --> -0.427464).  Saving model ...
Epoch: 2 cost time: 1.095372200012207
Epoch: 2, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.627 Vali Acc: 0.458 Test Loss: 1.627 Test Acc: 0.458
Validation loss decreased (-0.427464 --> -0.457999).  Saving model ...
Epoch: 3 cost time: 1.3597221374511719
Epoch: 3, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.466 Vali Acc: 0.489 Test Loss: 1.466 Test Acc: 0.489
Validation loss decreased (-0.457999 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.3193340301513672
Epoch: 4, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.482 Vali Acc: 0.496 Test Loss: 1.482 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.1458356380462646
Epoch: 5, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.570 Vali Acc: 0.504 Test Loss: 1.570 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.1239328384399414
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
Validation loss decreased (-0.503801 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 1.0915439128875732
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.720 Vali Acc: 0.511 Test Loss: 1.720 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2565820217132568
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.644 Vali Acc: 0.534 Test Loss: 1.644 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 1.271089792251587
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.712 Vali Acc: 0.527 Test Loss: 1.712 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.275930643081665
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.519 Test Loss: 1.822 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3154644966125488
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.902 Vali Acc: 0.511 Test Loss: 1.902 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2427351474761963
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.511 Test Loss: 1.879 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3204925060272217
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.511 Test Loss: 1.860 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5050067901611328
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.511 Test Loss: 1.860 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3973515033721924
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.511 Test Loss: 1.864 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2063839435577393
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.872 Vali Acc: 0.511 Test Loss: 1.872 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2579693794250488
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.519 Test Loss: 1.881 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2404868602752686
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.519 Test Loss: 1.900 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 364805
model size : 10.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.147878408432007
Epoch: 1, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.602 Vali Acc: 0.389 Test Loss: 1.602 Test Acc: 0.389
Validation loss decreased (inf --> -0.389297).  Saving model ...
Epoch: 2 cost time: 1.2506005764007568
Epoch: 2, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.611 Vali Acc: 0.443 Test Loss: 1.611 Test Acc: 0.443
Validation loss decreased (-0.389297 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.3746235370635986
Epoch: 3, Steps: 8 | Train Loss: 0.915 Vali Loss: 1.485 Vali Acc: 0.466 Test Loss: 1.485 Test Acc: 0.466
Validation loss decreased (-0.442732 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.2347404956817627
Epoch: 4, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.411 Vali Acc: 0.504 Test Loss: 1.411 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.3722600936889648
Epoch: 5, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.324744701385498
Epoch: 6, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.485 Vali Acc: 0.519 Test Loss: 1.485 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.2645008563995361
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526701).  Saving model ...
Epoch: 8 cost time: 1.2104265689849854
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.611 Vali Acc: 0.519 Test Loss: 1.611 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.412781000137329
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.643 Vali Acc: 0.527 Test Loss: 1.643 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2050137519836426
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.746 Vali Acc: 0.527 Test Loss: 1.746 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.328507900238037
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.801 Vali Acc: 0.534 Test Loss: 1.801 Test Acc: 0.534
Validation loss decreased (-0.526701 --> -0.534333).  Saving model ...
Epoch: 12 cost time: 1.3028032779693604
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.801 Vali Acc: 0.527 Test Loss: 1.801 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5591297149658203
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.782 Vali Acc: 0.519 Test Loss: 1.782 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2551836967468262
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.768 Vali Acc: 0.519 Test Loss: 1.768 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3201384544372559
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.519 Test Loss: 1.793 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.337137222290039
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.801 Vali Acc: 0.519 Test Loss: 1.801 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2655749320983887
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.806 Vali Acc: 0.519 Test Loss: 1.806 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.429286241531372
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.817 Vali Acc: 0.519 Test Loss: 1.817 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2920582294464111
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.827 Vali Acc: 0.519 Test Loss: 1.827 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.272446632385254
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.519 Test Loss: 1.849 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3346073627471924
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.519 Test Loss: 1.857 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 372357
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3435981273651123
Epoch: 1, Steps: 8 | Train Loss: 1.665 Vali Loss: 1.630 Vali Acc: 0.344 Test Loss: 1.630 Test Acc: 0.344
Validation loss decreased (inf --> -0.343495).  Saving model ...
Epoch: 2 cost time: 1.2721598148345947
Epoch: 2, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.664 Vali Acc: 0.412 Test Loss: 1.664 Test Acc: 0.412
Validation loss decreased (-0.343495 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.2803418636322021
Epoch: 3, Steps: 8 | Train Loss: 0.931 Vali Loss: 1.545 Vali Acc: 0.466 Test Loss: 1.545 Test Acc: 0.466
Validation loss decreased (-0.412197 --> -0.465633).  Saving model ...
Epoch: 4 cost time: 1.2015354633331299
Epoch: 4, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.471 Vali Acc: 0.504 Test Loss: 1.471 Test Acc: 0.504
Validation loss decreased (-0.465633 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 1.2169537544250488
Epoch: 5, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.488 Vali Acc: 0.534 Test Loss: 1.488 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534336).  Saving model ...
Epoch: 6 cost time: 1.4018988609313965
Epoch: 6, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.483 Vali Acc: 0.534 Test Loss: 1.483 Test Acc: 0.534
Validation loss decreased (-0.534336 --> -0.534336).  Saving model ...
Epoch: 7 cost time: 1.1023459434509277
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.549 Vali Acc: 0.534 Test Loss: 1.549 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2970185279846191
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.602 Vali Acc: 0.542 Test Loss: 1.602 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 9 cost time: 1.3220906257629395
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.632 Vali Acc: 0.550 Test Loss: 1.632 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.4640803337097168
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.648 Vali Acc: 0.542 Test Loss: 1.648 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3737890720367432
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.681 Vali Acc: 0.542 Test Loss: 1.681 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4778177738189697
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.705 Vali Acc: 0.542 Test Loss: 1.705 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3458116054534912
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.710 Vali Acc: 0.542 Test Loss: 1.710 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2700612545013428
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.727 Vali Acc: 0.542 Test Loss: 1.727 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4028949737548828
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.734 Vali Acc: 0.542 Test Loss: 1.734 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3807950019836426
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.741 Vali Acc: 0.542 Test Loss: 1.741 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.249488115310669
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.754 Vali Acc: 0.534 Test Loss: 1.754 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.254913330078125
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.778 Vali Acc: 0.534 Test Loss: 1.778 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.318631887435913
Epoch: 19, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.534 Test Loss: 1.789 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 403077
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0182065963745117
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.543 Vali Acc: 0.336 Test Loss: 1.543 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 1.4524221420288086
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.450 Vali Acc: 0.435 Test Loss: 1.450 Test Acc: 0.435
Validation loss decreased (-0.335862 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.2184202671051025
Epoch: 3, Steps: 8 | Train Loss: 0.920 Vali Loss: 1.408 Vali Acc: 0.458 Test Loss: 1.408 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.5254559516906738
Epoch: 4, Steps: 8 | Train Loss: 0.546 Vali Loss: 1.346 Vali Acc: 0.511 Test Loss: 1.346 Test Acc: 0.511
Validation loss decreased (-0.458001 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.4639091491699219
Epoch: 5, Steps: 8 | Train Loss: 0.280 Vali Loss: 1.357 Vali Acc: 0.496 Test Loss: 1.357 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2852585315704346
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.406 Vali Acc: 0.519 Test Loss: 1.406 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.4775197505950928
Epoch: 7, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.437 Vali Acc: 0.527 Test Loss: 1.437 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.3540098667144775
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.444 Vali Acc: 0.557 Test Loss: 1.444 Test Acc: 0.557
Validation loss decreased (-0.526703 --> -0.557237).  Saving model ...
Epoch: 9 cost time: 1.4425058364868164
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.453 Vali Acc: 0.542 Test Loss: 1.453 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3970072269439697
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3542492389678955
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.507 Vali Acc: 0.527 Test Loss: 1.507 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2456023693084717
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.527 Vali Acc: 0.527 Test Loss: 1.527 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4455125331878662
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.533 Vali Acc: 0.527 Test Loss: 1.533 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5219917297363281
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.527 Test Loss: 1.539 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4916472434997559
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3102898597717285
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.569 Vali Acc: 0.527 Test Loss: 1.569 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3177156448364258
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.591 Vali Acc: 0.527 Test Loss: 1.591 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2779674530029297
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 495109
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1350433826446533
Epoch: 1, Steps: 8 | Train Loss: 1.743 Vali Loss: 1.733 Vali Acc: 0.244 Test Loss: 1.733 Test Acc: 0.244
Validation loss decreased (inf --> -0.244257).  Saving model ...
Epoch: 2 cost time: 1.0163977146148682
Epoch: 2, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.621 Vali Acc: 0.359 Test Loss: 1.621 Test Acc: 0.359
Validation loss decreased (-0.244257 --> -0.358762).  Saving model ...
Epoch: 3 cost time: 0.9479641914367676
Epoch: 3, Steps: 8 | Train Loss: 0.955 Vali Loss: 1.552 Vali Acc: 0.427 Test Loss: 1.552 Test Acc: 0.427
Validation loss decreased (-0.358762 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.0738458633422852
Epoch: 4, Steps: 8 | Train Loss: 0.487 Vali Loss: 1.494 Vali Acc: 0.466 Test Loss: 1.494 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.0444207191467285
Epoch: 5, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.468 Vali Acc: 0.481 Test Loss: 1.468 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.0267953872680664
Epoch: 6, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.491 Vali Acc: 0.527 Test Loss: 1.491 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 0.9929535388946533
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.534 Vali Acc: 0.519 Test Loss: 1.534 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0982813835144043
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.560 Vali Acc: 0.519 Test Loss: 1.560 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0046820640563965
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.583 Vali Acc: 0.511 Test Loss: 1.583 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1163206100463867
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.593 Vali Acc: 0.504 Test Loss: 1.593 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1334710121154785
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.599 Vali Acc: 0.504 Test Loss: 1.599 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1018507480621338
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.607 Vali Acc: 0.519 Test Loss: 1.607 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2885112762451172
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.615 Vali Acc: 0.504 Test Loss: 1.615 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.058953046798706
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.620 Vali Acc: 0.504 Test Loss: 1.620 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9816012382507324
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.628 Vali Acc: 0.504 Test Loss: 1.628 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9994335174560547
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.636 Vali Acc: 0.504 Test Loss: 1.636 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 594821
model size : 11.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.489475727081299
Epoch: 1, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.548 Vali Acc: 0.351 Test Loss: 1.548 Test Acc: 0.351
Validation loss decreased (inf --> -0.351130).  Saving model ...
Epoch: 2 cost time: 1.031022310256958
Epoch: 2, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.462 Vali Acc: 0.382 Test Loss: 1.462 Test Acc: 0.382
Validation loss decreased (-0.351130 --> -0.381665).  Saving model ...
Epoch: 3 cost time: 0.9714734554290771
Epoch: 3, Steps: 8 | Train Loss: 0.841 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
Validation loss decreased (-0.381665 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.9034764766693115
Epoch: 4, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.423 Vali Acc: 0.473 Test Loss: 1.423 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.00126314163208
Epoch: 5, Steps: 8 | Train Loss: 0.178 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9862825870513916
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1639573574066162
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.512 Vali Acc: 0.473 Test Loss: 1.512 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9880609512329102
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.539 Vali Acc: 0.481 Test Loss: 1.539 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 1.0194728374481201
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.562 Vali Acc: 0.489 Test Loss: 1.562 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488534).  Saving model ...
Epoch: 10 cost time: 0.9966683387756348
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.585 Vali Acc: 0.489 Test Loss: 1.585 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1122345924377441
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.602 Vali Acc: 0.496 Test Loss: 1.602 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496167).  Saving model ...
Epoch: 12 cost time: 0.9834682941436768
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.614 Vali Acc: 0.504 Test Loss: 1.614 Test Acc: 0.504
Validation loss decreased (-0.496167 --> -0.503801).  Saving model ...
Epoch: 13 cost time: 1.071699619293213
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.619 Vali Acc: 0.504 Test Loss: 1.619 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.059027910232544
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.626 Vali Acc: 0.489 Test Loss: 1.626 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9999756813049316
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.637 Vali Acc: 0.489 Test Loss: 1.637 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9947500228881836
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.650 Vali Acc: 0.489 Test Loss: 1.650 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9662277698516846
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.661 Vali Acc: 0.489 Test Loss: 1.661 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0835621356964111
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.666 Vali Acc: 0.489 Test Loss: 1.666 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.194476842880249
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.504 Test Loss: 1.671 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1740784645080566
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.682 Vali Acc: 0.504 Test Loss: 1.682 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1043932437896729
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.688 Vali Acc: 0.504 Test Loss: 1.688 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.061081886291504
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.504 Test Loss: 1.696 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 706053
model size : 11.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8454580307006836
Epoch: 1, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.669 Vali Acc: 0.412 Test Loss: 1.669 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 1.0939483642578125
Epoch: 2, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.470 Vali Acc: 0.458 Test Loss: 1.470 Test Acc: 0.458
Validation loss decreased (-0.412197 --> -0.458001).  Saving model ...
Epoch: 3 cost time: 1.2742278575897217
Epoch: 3, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.478 Vali Acc: 0.481 Test Loss: 1.478 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.186631202697754
Epoch: 4, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.611 Vali Acc: 0.473 Test Loss: 1.611 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.195451021194458
Epoch: 5, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.827 Vali Acc: 0.519 Test Loss: 1.827 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519066).  Saving model ...
Epoch: 6 cost time: 1.2231154441833496
Epoch: 6, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.834 Vali Acc: 0.511 Test Loss: 1.834 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2220962047576904
Epoch: 7, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.029 Vali Acc: 0.519 Test Loss: 2.029 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2091965675354004
Epoch: 8, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.155 Vali Acc: 0.527 Test Loss: 2.155 Test Acc: 0.527
Validation loss decreased (-0.519066 --> -0.526696).  Saving model ...
Epoch: 9 cost time: 1.3431973457336426
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.221 Vali Acc: 0.527 Test Loss: 2.221 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.242774486541748
Epoch: 10, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.211 Vali Acc: 0.527 Test Loss: 2.211 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.178313970565796
Epoch: 11, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.527 Test Loss: 2.190 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1270568370819092
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.519 Test Loss: 2.152 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0804624557495117
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.162 Vali Acc: 0.519 Test Loss: 2.162 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2825889587402344
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.179 Vali Acc: 0.519 Test Loss: 2.179 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1927893161773682
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.193 Vali Acc: 0.527 Test Loss: 2.193 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2460236549377441
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.205 Vali Acc: 0.527 Test Loss: 2.205 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3493733406066895
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.527 Test Loss: 2.206 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2123305797576904
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.527 Test Loss: 2.206 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 444357
model size : 10.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8165194988250732
Epoch: 1, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.641 Vali Acc: 0.382 Test Loss: 1.641 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 1.3482036590576172
Epoch: 2, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.689 Vali Acc: 0.420 Test Loss: 1.689 Test Acc: 0.420
Validation loss decreased (-0.381663 --> -0.419830).  Saving model ...
Epoch: 3 cost time: 1.2896888256072998
Epoch: 3, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.492 Vali Acc: 0.443 Test Loss: 1.492 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.2783756256103516
Epoch: 4, Steps: 8 | Train Loss: 0.399 Vali Loss: 1.486 Vali Acc: 0.489 Test Loss: 1.486 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.2990703582763672
Epoch: 5, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.488 Vali Acc: 0.473 Test Loss: 1.488 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2048702239990234
Epoch: 6, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.549 Vali Acc: 0.519 Test Loss: 1.549 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519068).  Saving model ...
Epoch: 7 cost time: 1.1889798641204834
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.544 Vali Acc: 0.511 Test Loss: 1.544 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2501657009124756
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.780 Vali Acc: 0.534 Test Loss: 1.780 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534333).  Saving model ...
Epoch: 9 cost time: 1.2576072216033936
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.534 Test Loss: 1.773 Test Acc: 0.534
Validation loss decreased (-0.534333 --> -0.534333).  Saving model ...
Epoch: 10 cost time: 1.37330961227417
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.731 Vali Acc: 0.534 Test Loss: 1.731 Test Acc: 0.534
Validation loss decreased (-0.534333 --> -0.534334).  Saving model ...
Epoch: 11 cost time: 1.3718221187591553
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.534 Test Loss: 1.710 Test Acc: 0.534
Validation loss decreased (-0.534334 --> -0.534334).  Saving model ...
Epoch: 12 cost time: 1.1564478874206543
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.534 Test Loss: 1.763 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1633579730987549
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.820 Vali Acc: 0.534 Test Loss: 1.820 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2809042930603027
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.534 Test Loss: 1.841 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2805073261260986
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.534 Test Loss: 1.850 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3257362842559814
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.534 Test Loss: 1.848 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.282376766204834
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.534 Test Loss: 1.837 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2565040588378906
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.534 Test Loss: 1.828 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.335904598236084
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.534 Test Loss: 1.843 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3070461750030518
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.534 Test Loss: 1.867 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3280961513519287
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.542 Test Loss: 1.874 Test Acc: 0.542
Validation loss decreased (-0.534334 --> -0.541966).  Saving model ...
Epoch: 22 cost time: 1.329444169998169
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.542 Test Loss: 1.877 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.247126579284668
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.534 Test Loss: 1.866 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1023590564727783
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.542 Test Loss: 1.868 Test Acc: 0.542
Validation loss decreased (-0.541966 --> -0.541966).  Saving model ...
Epoch: 25 cost time: 1.2806859016418457
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.542 Test Loss: 1.874 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1360855102539062
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.542 Test Loss: 1.896 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1719467639923096
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.542 Test Loss: 1.910 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.204592227935791
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.542 Test Loss: 1.913 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1975200176239014
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.921 Vali Acc: 0.542 Test Loss: 1.921 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2809455394744873
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.542 Test Loss: 1.928 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2423114776611328
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.542 Test Loss: 1.937 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.324688196182251
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.542 Test Loss: 1.945 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3387274742126465
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.542 Test Loss: 1.945 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2373278141021729
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.542 Test Loss: 1.938 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 348357
model size : 10.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.680544376373291
Epoch: 1, Steps: 8 | Train Loss: 1.630 Vali Loss: 1.634 Vali Acc: 0.206 Test Loss: 1.634 Test Acc: 0.206
Validation loss decreased (inf --> -0.206091).  Saving model ...
Epoch: 2 cost time: 1.1988682746887207
Epoch: 2, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.604 Vali Acc: 0.427 Test Loss: 1.604 Test Acc: 0.427
Validation loss decreased (-0.206091 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1831581592559814
Epoch: 3, Steps: 8 | Train Loss: 0.909 Vali Loss: 1.486 Vali Acc: 0.405 Test Loss: 1.486 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.235443353652954
Epoch: 4, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.428 Vali Acc: 0.473 Test Loss: 1.428 Test Acc: 0.473
Validation loss decreased (-0.427465 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.1956496238708496
Epoch: 5, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.468 Vali Acc: 0.511 Test Loss: 1.468 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.2419638633728027
Epoch: 6, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.471 Vali Acc: 0.496 Test Loss: 1.471 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1902234554290771
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.687 Vali Acc: 0.519 Test Loss: 1.687 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519067).  Saving model ...
Epoch: 8 cost time: 1.0265367031097412
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.640 Vali Acc: 0.519 Test Loss: 1.640 Test Acc: 0.519
Validation loss decreased (-0.519067 --> -0.519068).  Saving model ...
Epoch: 9 cost time: 1.157909870147705
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.631 Vali Acc: 0.511 Test Loss: 1.631 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.334465503692627
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.687 Vali Acc: 0.504 Test Loss: 1.687 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.237907886505127
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.504 Test Loss: 1.728 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2042655944824219
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.738 Vali Acc: 0.511 Test Loss: 1.738 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2912001609802246
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.754 Vali Acc: 0.511 Test Loss: 1.754 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2413220405578613
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.511 Test Loss: 1.753 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3474349975585938
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.764 Vali Acc: 0.511 Test Loss: 1.764 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3581182956695557
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.771 Vali Acc: 0.511 Test Loss: 1.771 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3506278991699219
Epoch: 17, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.792 Vali Acc: 0.511 Test Loss: 1.792 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4393508434295654
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.519 Test Loss: 1.806 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 355909
model size : 10.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1563727855682373
Epoch: 1, Steps: 8 | Train Loss: 1.793 Vali Loss: 1.495 Vali Acc: 0.313 Test Loss: 1.495 Test Acc: 0.313
Validation loss decreased (inf --> -0.312962).  Saving model ...
Epoch: 2 cost time: 1.3525903224945068
Epoch: 2, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
Validation loss decreased (-0.312962 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1405072212219238
Epoch: 3, Steps: 8 | Train Loss: 0.987 Vali Loss: 1.469 Vali Acc: 0.458 Test Loss: 1.469 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.2272863388061523
Epoch: 4, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.336 Vali Acc: 0.473 Test Loss: 1.336 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473269).  Saving model ...
Epoch: 5 cost time: 1.167858362197876
Epoch: 5, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
Validation loss decreased (-0.473269 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 1.2977266311645508
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.373 Vali Acc: 0.557 Test Loss: 1.373 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557238).  Saving model ...
Epoch: 7 cost time: 1.4418716430664062
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.369 Vali Acc: 0.527 Test Loss: 1.369 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.336991548538208
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.508 Vali Acc: 0.542 Test Loss: 1.508 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2602972984313965
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.572 Vali Acc: 0.519 Test Loss: 1.572 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4260456562042236
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.537 Vali Acc: 0.534 Test Loss: 1.537 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2782728672027588
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.525 Vali Acc: 0.534 Test Loss: 1.525 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3982584476470947
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.544 Vali Acc: 0.534 Test Loss: 1.544 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3295807838439941
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.563 Vali Acc: 0.534 Test Loss: 1.563 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.396073818206787
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.584 Vali Acc: 0.534 Test Loss: 1.584 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2686195373535156
Epoch: 15, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.602 Vali Acc: 0.534 Test Loss: 1.602 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3518109321594238
Epoch: 16, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.625 Vali Acc: 0.534 Test Loss: 1.625 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 386629
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1880152225494385
Epoch: 1, Steps: 8 | Train Loss: 1.772 Vali Loss: 1.619 Vali Acc: 0.298 Test Loss: 1.619 Test Acc: 0.298
Validation loss decreased (inf --> -0.297694).  Saving model ...
Epoch: 2 cost time: 1.3706965446472168
Epoch: 2, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.597 Vali Acc: 0.427 Test Loss: 1.597 Test Acc: 0.427
Validation loss decreased (-0.297694 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.3119621276855469
Epoch: 3, Steps: 8 | Train Loss: 0.956 Vali Loss: 1.591 Vali Acc: 0.481 Test Loss: 1.591 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480900).  Saving model ...
Epoch: 4 cost time: 1.3542981147766113
Epoch: 4, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.507 Vali Acc: 0.504 Test Loss: 1.507 Test Acc: 0.504
Validation loss decreased (-0.480900 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 1.2749371528625488
Epoch: 5, Steps: 8 | Train Loss: 0.278 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 1.4383032321929932
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.522 Vali Acc: 0.542 Test Loss: 1.522 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541970).  Saving model ...
Epoch: 7 cost time: 1.36860990524292
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.543 Vali Acc: 0.550 Test Loss: 1.543 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549603).  Saving model ...
Epoch: 8 cost time: 1.4500722885131836
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.577 Vali Acc: 0.557 Test Loss: 1.577 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557236).  Saving model ...
Epoch: 9 cost time: 1.3823728561401367
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.416379690170288
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.658 Vali Acc: 0.542 Test Loss: 1.658 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3904540538787842
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.678 Vali Acc: 0.542 Test Loss: 1.678 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.381718635559082
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.701 Vali Acc: 0.542 Test Loss: 1.701 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2654898166656494
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.714 Vali Acc: 0.542 Test Loss: 1.714 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3671104907989502
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.727 Vali Acc: 0.542 Test Loss: 1.727 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.308539628982544
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.740 Vali Acc: 0.542 Test Loss: 1.740 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3038623332977295
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.755 Vali Acc: 0.542 Test Loss: 1.755 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4308149814605713
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.765 Vali Acc: 0.542 Test Loss: 1.765 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3910129070281982
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.767 Vali Acc: 0.542 Test Loss: 1.767 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 478661
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.69985294342041
Epoch: 1, Steps: 8 | Train Loss: 1.814 Vali Loss: 1.660 Vali Acc: 0.252 Test Loss: 1.660 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 1.0138192176818848
Epoch: 2, Steps: 8 | Train Loss: 1.473 Vali Loss: 1.524 Vali Acc: 0.382 Test Loss: 1.524 Test Acc: 0.382
Validation loss decreased (-0.251892 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.0737755298614502
Epoch: 3, Steps: 8 | Train Loss: 0.953 Vali Loss: 1.459 Vali Acc: 0.443 Test Loss: 1.459 Test Acc: 0.443
Validation loss decreased (-0.381664 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 1.0239768028259277
Epoch: 4, Steps: 8 | Train Loss: 0.510 Vali Loss: 1.430 Vali Acc: 0.489 Test Loss: 1.430 Test Acc: 0.489
Validation loss decreased (-0.442734 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 0.9927647113800049
Epoch: 5, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.421 Vali Acc: 0.504 Test Loss: 1.421 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.1054744720458984
Epoch: 6, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.425 Vali Acc: 0.481 Test Loss: 1.425 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9390890598297119
Epoch: 7, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.450 Vali Acc: 0.496 Test Loss: 1.450 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0355958938598633
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.481 Vali Acc: 0.519 Test Loss: 1.481 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519069).  Saving model ...
Epoch: 9 cost time: 1.0186622142791748
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0616655349731445
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.531 Vali Acc: 0.527 Test Loss: 1.531 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 11 cost time: 1.1415162086486816
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.545 Vali Acc: 0.542 Test Loss: 1.545 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541969).  Saving model ...
Epoch: 12 cost time: 0.9961485862731934
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.554 Vali Acc: 0.542 Test Loss: 1.554 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8847568035125732
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.564 Vali Acc: 0.542 Test Loss: 1.564 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0317070484161377
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.581 Vali Acc: 0.534 Test Loss: 1.581 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0165379047393799
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.594 Vali Acc: 0.534 Test Loss: 1.594 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0791211128234863
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.608 Vali Acc: 0.534 Test Loss: 1.608 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1952731609344482
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.620 Vali Acc: 0.534 Test Loss: 1.620 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.022261619567871
Epoch: 18, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.633 Vali Acc: 0.534 Test Loss: 1.633 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0070242881774902
Epoch: 19, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.641 Vali Acc: 0.534 Test Loss: 1.641 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1118197441101074
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.647 Vali Acc: 0.542 Test Loss: 1.647 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0315887928009033
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.658 Vali Acc: 0.542 Test Loss: 1.658 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 578373
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.544886350631714
Epoch: 1, Steps: 8 | Train Loss: 1.858 Vali Loss: 1.659 Vali Acc: 0.244 Test Loss: 1.659 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.0155107975006104
Epoch: 2, Steps: 8 | Train Loss: 1.396 Vali Loss: 1.577 Vali Acc: 0.344 Test Loss: 1.577 Test Acc: 0.344
Validation loss decreased (-0.244258 --> -0.343496).  Saving model ...
Epoch: 3 cost time: 0.9478757381439209
Epoch: 3, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.550 Vali Acc: 0.389 Test Loss: 1.550 Test Acc: 0.389
Validation loss decreased (-0.343496 --> -0.389297).  Saving model ...
Epoch: 4 cost time: 1.005434513092041
Epoch: 4, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 0.993323802947998
Epoch: 5, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 0.9567608833312988
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.515 Vali Acc: 0.427 Test Loss: 1.515 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 0.9798150062561035
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.549 Vali Acc: 0.458 Test Loss: 1.549 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 1.1373562812805176
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.577 Vali Acc: 0.489 Test Loss: 1.577 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 9 cost time: 0.9543397426605225
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.598 Vali Acc: 0.504 Test Loss: 1.598 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 10 cost time: 1.0548443794250488
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.621 Vali Acc: 0.489 Test Loss: 1.621 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.097961664199829
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.641 Vali Acc: 0.466 Test Loss: 1.641 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.025768756866455
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.651 Vali Acc: 0.489 Test Loss: 1.651 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9516124725341797
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.666 Vali Acc: 0.489 Test Loss: 1.666 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9462699890136719
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.678 Vali Acc: 0.496 Test Loss: 1.678 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0619521141052246
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.690 Vali Acc: 0.489 Test Loss: 1.690 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0250201225280762
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.702 Vali Acc: 0.489 Test Loss: 1.702 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0274298191070557
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.713 Vali Acc: 0.496 Test Loss: 1.713 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9466383457183838
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.724 Vali Acc: 0.489 Test Loss: 1.724 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0752944946289062
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.734 Vali Acc: 0.489 Test Loss: 1.734 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm128_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 689605
model size : 11.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0539259910583496
Epoch: 1, Steps: 8 | Train Loss: 1.718 Vali Loss: 1.643 Vali Acc: 0.412 Test Loss: 1.643 Test Acc: 0.412
Validation loss decreased (inf --> -0.412197).  Saving model ...
Epoch: 2 cost time: 1.3103628158569336
Epoch: 2, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.577 Vali Acc: 0.427 Test Loss: 1.577 Test Acc: 0.427
Validation loss decreased (-0.412197 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.3727056980133057
Epoch: 3, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.446 Vali Acc: 0.458 Test Loss: 1.446 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.2725841999053955
Epoch: 4, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.1990482807159424
Epoch: 5, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.652 Vali Acc: 0.511 Test Loss: 1.652 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511434).  Saving model ...
Epoch: 6 cost time: 1.3051486015319824
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.446 Vali Acc: 0.511 Test Loss: 1.446 Test Acc: 0.511
Validation loss decreased (-0.511434 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.337433099746704
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.789 Vali Acc: 0.511 Test Loss: 1.789 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3230628967285156
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526702).  Saving model ...
Epoch: 9 cost time: 1.3960695266723633
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.777 Vali Acc: 0.519 Test Loss: 1.777 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3881440162658691
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.923 Vali Acc: 0.519 Test Loss: 1.923 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3164749145507812
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.874 Vali Acc: 0.519 Test Loss: 1.874 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1906163692474365
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.519 Test Loss: 1.873 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3087832927703857
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.902 Vali Acc: 0.519 Test Loss: 1.902 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2893176078796387
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.519 Test Loss: 1.908 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3039627075195312
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.519 Test Loss: 1.914 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2793049812316895
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.519 Test Loss: 1.917 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3720817565917969
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.519 Test Loss: 1.917 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3912768363952637
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.933 Vali Acc: 0.519 Test Loss: 1.933 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 230597
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.196037769317627
Epoch: 1, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.630 Vali Acc: 0.275 Test Loss: 1.630 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 1.3741333484649658
Epoch: 2, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.645 Vali Acc: 0.412 Test Loss: 1.645 Test Acc: 0.412
Validation loss decreased (-0.274793 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.2241771221160889
Epoch: 3, Steps: 8 | Train Loss: 1.114 Vali Loss: 1.541 Vali Acc: 0.420 Test Loss: 1.541 Test Acc: 0.420
Validation loss decreased (-0.412197 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.1402201652526855
Epoch: 4, Steps: 8 | Train Loss: 0.806 Vali Loss: 1.479 Vali Acc: 0.389 Test Loss: 1.479 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.266573190689087
Epoch: 5, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.467 Vali Acc: 0.504 Test Loss: 1.467 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.0487010478973389
Epoch: 6, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.433 Vali Acc: 0.496 Test Loss: 1.433 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0125758647918701
Epoch: 7, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.434 Vali Acc: 0.557 Test Loss: 1.434 Test Acc: 0.557
Validation loss decreased (-0.503802 --> -0.557238).  Saving model ...
Epoch: 8 cost time: 1.2556719779968262
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.513 Vali Acc: 0.534 Test Loss: 1.513 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3269765377044678
Epoch: 9, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2262794971466064
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.522 Vali Acc: 0.534 Test Loss: 1.522 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1958298683166504
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.568 Vali Acc: 0.542 Test Loss: 1.568 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2943768501281738
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.610 Vali Acc: 0.542 Test Loss: 1.610 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3755805492401123
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.622 Vali Acc: 0.542 Test Loss: 1.622 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.22745943069458
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.623 Vali Acc: 0.519 Test Loss: 1.623 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3436646461486816
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.633 Vali Acc: 0.519 Test Loss: 1.633 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2452788352966309
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.660 Vali Acc: 0.527 Test Loss: 1.660 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3261549472808838
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 182597
model size : 5.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9755055904388428
Epoch: 1, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.539 Vali Acc: 0.351 Test Loss: 1.539 Test Acc: 0.351
Validation loss decreased (inf --> -0.351130).  Saving model ...
Epoch: 2 cost time: 1.219499111175537
Epoch: 2, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.539 Vali Acc: 0.458 Test Loss: 1.539 Test Acc: 0.458
Validation loss decreased (-0.351130 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.435547113418579
Epoch: 3, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.3427824974060059
Epoch: 4, Steps: 8 | Train Loss: 0.825 Vali Loss: 1.486 Vali Acc: 0.496 Test Loss: 1.486 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.3854427337646484
Epoch: 5, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.431 Vali Acc: 0.519 Test Loss: 1.431 Test Acc: 0.519
Validation loss decreased (-0.496168 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.2693219184875488
Epoch: 6, Steps: 8 | Train Loss: 0.381 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2435898780822754
Epoch: 7, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.473 Vali Acc: 0.496 Test Loss: 1.473 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1719131469726562
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.504 Vali Acc: 0.504 Test Loss: 1.504 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0095407962799072
Epoch: 9, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.584 Vali Acc: 0.504 Test Loss: 1.584 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1368186473846436
Epoch: 10, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.627 Vali Acc: 0.511 Test Loss: 1.627 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.274512767791748
Epoch: 11, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.638 Vali Acc: 0.504 Test Loss: 1.638 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2159996032714844
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.670 Vali Acc: 0.504 Test Loss: 1.670 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2840709686279297
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.716 Vali Acc: 0.496 Test Loss: 1.716 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.263808012008667
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.729 Vali Acc: 0.511 Test Loss: 1.729 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2771120071411133
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.723 Vali Acc: 0.511 Test Loss: 1.723 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 186373
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7113239765167236
Epoch: 1, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.568 Vali Acc: 0.344 Test Loss: 1.568 Test Acc: 0.344
Validation loss decreased (inf --> -0.343496).  Saving model ...
Epoch: 2 cost time: 1.0219430923461914
Epoch: 2, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.565 Vali Acc: 0.412 Test Loss: 1.565 Test Acc: 0.412
Validation loss decreased (-0.343496 --> -0.412198).  Saving model ...
Epoch: 3 cost time: 1.2619051933288574
Epoch: 3, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.0585331916809082
Epoch: 4, Steps: 8 | Train Loss: 0.884 Vali Loss: 1.515 Vali Acc: 0.443 Test Loss: 1.515 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.1432404518127441
Epoch: 5, Steps: 8 | Train Loss: 0.591 Vali Loss: 1.468 Vali Acc: 0.450 Test Loss: 1.468 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.0354104042053223
Epoch: 6, Steps: 8 | Train Loss: 0.414 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
Validation loss decreased (-0.450367 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.0273847579956055
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.421 Vali Acc: 0.519 Test Loss: 1.421 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.0925920009613037
Epoch: 8, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 9 cost time: 1.0222570896148682
Epoch: 9, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.115645408630371
Epoch: 10, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 11 cost time: 1.0493872165679932
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0591800212860107
Epoch: 12, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.474 Vali Acc: 0.519 Test Loss: 1.474 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1434624195098877
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0788578987121582
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.483 Vali Acc: 0.519 Test Loss: 1.483 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2614459991455078
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.489 Vali Acc: 0.519 Test Loss: 1.489 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0750997066497803
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1015236377716064
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.505 Vali Acc: 0.519 Test Loss: 1.505 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.133039951324463
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.510 Vali Acc: 0.519 Test Loss: 1.510 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1397409439086914
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.520 Vali Acc: 0.519 Test Loss: 1.520 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1912505626678467
Epoch: 20, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.527 Vali Acc: 0.519 Test Loss: 1.527 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 201733
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.414546251296997
Epoch: 1, Steps: 8 | Train Loss: 1.689 Vali Loss: 1.696 Vali Acc: 0.198 Test Loss: 1.696 Test Acc: 0.198
Validation loss decreased (inf --> -0.198456).  Saving model ...
Epoch: 2 cost time: 1.1706516742706299
Epoch: 2, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.600 Vali Acc: 0.336 Test Loss: 1.600 Test Acc: 0.336
Validation loss decreased (-0.198456 --> -0.335862).  Saving model ...
Epoch: 3 cost time: 1.0474283695220947
Epoch: 3, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.558 Vali Acc: 0.405 Test Loss: 1.558 Test Acc: 0.405
Validation loss decreased (-0.335862 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.2008802890777588
Epoch: 4, Steps: 8 | Train Loss: 0.836 Vali Loss: 1.518 Vali Acc: 0.450 Test Loss: 1.518 Test Acc: 0.450
Validation loss decreased (-0.404565 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.051081895828247
Epoch: 5, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.489 Vali Acc: 0.458 Test Loss: 1.489 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.0269277095794678
Epoch: 6, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.473 Vali Acc: 0.489 Test Loss: 1.473 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.0166552066802979
Epoch: 7, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.1305804252624512
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.484 Vali Acc: 0.527 Test Loss: 1.484 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.2090494632720947
Epoch: 9, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.524 Vali Acc: 0.542 Test Loss: 1.524 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541969).  Saving model ...
Epoch: 10 cost time: 1.1679203510284424
Epoch: 10, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.558 Vali Acc: 0.519 Test Loss: 1.558 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0815434455871582
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0991778373718262
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0226876735687256
Epoch: 13, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.606 Vali Acc: 0.519 Test Loss: 1.606 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.120011329650879
Epoch: 14, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.615 Vali Acc: 0.496 Test Loss: 1.615 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0010623931884766
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.617 Vali Acc: 0.504 Test Loss: 1.617 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8499171733856201
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.636 Vali Acc: 0.504 Test Loss: 1.636 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0495741367340088
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.656 Vali Acc: 0.504 Test Loss: 1.656 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0040228366851807
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.666 Vali Acc: 0.504 Test Loss: 1.666 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0724680423736572
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.674 Vali Acc: 0.504 Test Loss: 1.674 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 247749
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.665614128112793
Epoch: 1, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.660 Vali Acc: 0.298 Test Loss: 1.660 Test Acc: 0.298
Validation loss decreased (inf --> -0.297693).  Saving model ...
Epoch: 2 cost time: 0.8838756084442139
Epoch: 2, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.627 Vali Acc: 0.328 Test Loss: 1.627 Test Acc: 0.328
Validation loss decreased (-0.297693 --> -0.328228).  Saving model ...
Epoch: 3 cost time: 1.0532636642456055
Epoch: 3, Steps: 8 | Train Loss: 1.098 Vali Loss: 1.571 Vali Acc: 0.397 Test Loss: 1.571 Test Acc: 0.397
Validation loss decreased (-0.328228 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 0.9647355079650879
Epoch: 4, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.532 Vali Acc: 0.397 Test Loss: 1.532 Test Acc: 0.397
Validation loss decreased (-0.396931 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 0.9958341121673584
Epoch: 5, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.503 Vali Acc: 0.435 Test Loss: 1.503 Test Acc: 0.435
Validation loss decreased (-0.396931 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 0.9886019229888916
Epoch: 6, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.488 Vali Acc: 0.443 Test Loss: 1.488 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 1.198852300643921
Epoch: 7, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.479 Vali Acc: 0.450 Test Loss: 1.479 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 1.1636028289794922
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.492 Vali Acc: 0.466 Test Loss: 1.492 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.0722918510437012
Epoch: 9, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.511 Vali Acc: 0.466 Test Loss: 1.511 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0574746131896973
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.535 Vali Acc: 0.466 Test Loss: 1.535 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.097022294998169
Epoch: 11, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.549 Vali Acc: 0.466 Test Loss: 1.549 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9864702224731445
Epoch: 12, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.555 Vali Acc: 0.473 Test Loss: 1.555 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 13 cost time: 1.0791316032409668
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.569 Vali Acc: 0.466 Test Loss: 1.569 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0634369850158691
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.583 Vali Acc: 0.466 Test Loss: 1.583 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0213751792907715
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.596 Vali Acc: 0.473 Test Loss: 1.596 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0177416801452637
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.608 Vali Acc: 0.473 Test Loss: 1.608 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0286433696746826
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.618 Vali Acc: 0.473 Test Loss: 1.618 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.013648271560669
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.627 Vali Acc: 0.466 Test Loss: 1.627 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0324933528900146
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.639 Vali Acc: 0.473 Test Loss: 1.639 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0045430660247803
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.653 Vali Acc: 0.473 Test Loss: 1.653 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9906325340270996
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.662 Vali Acc: 0.466 Test Loss: 1.662 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9982571601867676
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.671 Vali Acc: 0.466 Test Loss: 1.671 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 297605
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7054266929626465
Epoch: 1, Steps: 8 | Train Loss: 1.705 Vali Loss: 1.708 Vali Acc: 0.214 Test Loss: 1.708 Test Acc: 0.214
Validation loss decreased (inf --> -0.213723).  Saving model ...
Epoch: 2 cost time: 1.162809133529663
Epoch: 2, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.622 Vali Acc: 0.313 Test Loss: 1.622 Test Acc: 0.313
Validation loss decreased (-0.213723 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 1.0673112869262695
Epoch: 3, Steps: 8 | Train Loss: 1.030 Vali Loss: 1.551 Vali Acc: 0.405 Test Loss: 1.551 Test Acc: 0.405
Validation loss decreased (-0.312961 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.1567301750183105
Epoch: 4, Steps: 8 | Train Loss: 0.725 Vali Loss: 1.489 Vali Acc: 0.443 Test Loss: 1.489 Test Acc: 0.443
Validation loss decreased (-0.404565 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.090090036392212
Epoch: 5, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.454 Vali Acc: 0.481 Test Loss: 1.454 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.0935742855072021
Epoch: 6, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.450 Vali Acc: 0.466 Test Loss: 1.450 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1732640266418457
Epoch: 7, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.473 Vali Acc: 0.466 Test Loss: 1.473 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.028304100036621
Epoch: 8, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.501 Vali Acc: 0.496 Test Loss: 1.501 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 9 cost time: 1.0293867588043213
Epoch: 9, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526703).  Saving model ...
Epoch: 10 cost time: 1.0787153244018555
Epoch: 10, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.540 Vali Acc: 0.504 Test Loss: 1.540 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1228795051574707
Epoch: 11, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.572 Vali Acc: 0.511 Test Loss: 1.572 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9734432697296143
Epoch: 12, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.569 Vali Acc: 0.489 Test Loss: 1.569 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0972604751586914
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.572 Vali Acc: 0.496 Test Loss: 1.572 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2055857181549072
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.581 Vali Acc: 0.511 Test Loss: 1.581 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0595993995666504
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1855733394622803
Epoch: 16, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.618 Vali Acc: 0.527 Test Loss: 1.618 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1163825988769531
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.632 Vali Acc: 0.519 Test Loss: 1.632 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0954601764678955
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.635 Vali Acc: 0.527 Test Loss: 1.635 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.010981559753418
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.629 Vali Acc: 0.527 Test Loss: 1.629 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 353221
model size : 5.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2638657093048096
Epoch: 1, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.729 Vali Acc: 0.427 Test Loss: 1.729 Test Acc: 0.427
Validation loss decreased (inf --> -0.427464).  Saving model ...
Epoch: 2 cost time: 1.253610610961914
Epoch: 2, Steps: 8 | Train Loss: 1.380 Vali Loss: 1.581 Vali Acc: 0.412 Test Loss: 1.581 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2703828811645508
Epoch: 3, Steps: 8 | Train Loss: 0.864 Vali Loss: 1.500 Vali Acc: 0.466 Test Loss: 1.500 Test Acc: 0.466
Validation loss decreased (-0.427464 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.3603489398956299
Epoch: 4, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.453 Vali Acc: 0.458 Test Loss: 1.453 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1986725330352783
Epoch: 5, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.542 Vali Acc: 0.519 Test Loss: 1.542 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.2546532154083252
Epoch: 6, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.613 Vali Acc: 0.527 Test Loss: 1.613 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526701).  Saving model ...
Epoch: 7 cost time: 1.1838879585266113
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.506 Vali Acc: 0.511 Test Loss: 1.506 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3467504978179932
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.624 Vali Acc: 0.511 Test Loss: 1.624 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3712000846862793
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.774 Vali Acc: 0.511 Test Loss: 1.774 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3448622226715088
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.757 Vali Acc: 0.511 Test Loss: 1.757 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.29774808883667
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.750 Vali Acc: 0.511 Test Loss: 1.750 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2411177158355713
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.511 Test Loss: 1.762 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2773504257202148
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.783 Vali Acc: 0.519 Test Loss: 1.783 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.305016279220581
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.519 Test Loss: 1.815 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2021491527557373
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.519 Test Loss: 1.833 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2539913654327393
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.519 Test Loss: 1.834 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 214085
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9878334999084473
Epoch: 1, Steps: 8 | Train Loss: 1.719 Vali Loss: 1.658 Vali Acc: 0.267 Test Loss: 1.658 Test Acc: 0.267
Validation loss decreased (inf --> -0.267159).  Saving model ...
Epoch: 2 cost time: 1.3160500526428223
Epoch: 2, Steps: 8 | Train Loss: 1.438 Vali Loss: 1.594 Vali Acc: 0.405 Test Loss: 1.594 Test Acc: 0.405
Validation loss decreased (-0.267159 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 1.2957675457000732
Epoch: 3, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.522 Vali Acc: 0.366 Test Loss: 1.522 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2770256996154785
Epoch: 4, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.455 Vali Acc: 0.427 Test Loss: 1.455 Test Acc: 0.427
Validation loss decreased (-0.404564 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.2348787784576416
Epoch: 5, Steps: 8 | Train Loss: 0.492 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
Validation loss decreased (-0.427466 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.2074518203735352
Epoch: 6, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.410 Vali Acc: 0.527 Test Loss: 1.410 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.1980807781219482
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3434925079345703
Epoch: 8, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.466 Vali Acc: 0.534 Test Loss: 1.466 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 9 cost time: 1.206864833831787
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.572 Vali Acc: 0.527 Test Loss: 1.572 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3179616928100586
Epoch: 10, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3178532123565674
Epoch: 11, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.570 Vali Acc: 0.519 Test Loss: 1.570 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1931862831115723
Epoch: 12, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.618 Vali Acc: 0.519 Test Loss: 1.618 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0213429927825928
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.666 Vali Acc: 0.519 Test Loss: 1.666 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.186065435409546
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.664 Vali Acc: 0.519 Test Loss: 1.664 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1738710403442383
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.656 Vali Acc: 0.519 Test Loss: 1.656 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1458189487457275
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.658 Vali Acc: 0.519 Test Loss: 1.658 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.121408224105835
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.670 Vali Acc: 0.519 Test Loss: 1.670 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2051308155059814
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.681 Vali Acc: 0.519 Test Loss: 1.681 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 166085
model size : 5.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.08683705329895
Epoch: 1, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.635 Vali Acc: 0.229 Test Loss: 1.635 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.4697508811950684
Epoch: 2, Steps: 8 | Train Loss: 1.382 Vali Loss: 1.638 Vali Acc: 0.351 Test Loss: 1.638 Test Acc: 0.351
Validation loss decreased (-0.228991 --> -0.351129).  Saving model ...
Epoch: 3 cost time: 1.337003231048584
Epoch: 3, Steps: 8 | Train Loss: 1.129 Vali Loss: 1.652 Vali Acc: 0.382 Test Loss: 1.652 Test Acc: 0.382
Validation loss decreased (-0.351129 --> -0.381663).  Saving model ...
Epoch: 4 cost time: 1.3789501190185547
Epoch: 4, Steps: 8 | Train Loss: 0.843 Vali Loss: 1.578 Vali Acc: 0.374 Test Loss: 1.578 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3941216468811035
Epoch: 5, Steps: 8 | Train Loss: 0.593 Vali Loss: 1.544 Vali Acc: 0.458 Test Loss: 1.544 Test Acc: 0.458
Validation loss decreased (-0.381663 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.0354139804840088
Epoch: 6, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.545 Vali Acc: 0.458 Test Loss: 1.545 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3524184226989746
Epoch: 7, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.553 Vali Acc: 0.496 Test Loss: 1.553 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 1.2890055179595947
Epoch: 8, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.604 Vali Acc: 0.481 Test Loss: 1.604 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2869811058044434
Epoch: 9, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.599 Vali Acc: 0.481 Test Loss: 1.599 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.289412498474121
Epoch: 10, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.669 Vali Acc: 0.504 Test Loss: 1.669 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503800).  Saving model ...
Epoch: 11 cost time: 1.2021043300628662
Epoch: 11, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.721 Vali Acc: 0.504 Test Loss: 1.721 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.291999340057373
Epoch: 12, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.737 Vali Acc: 0.504 Test Loss: 1.737 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2242882251739502
Epoch: 13, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.742 Vali Acc: 0.504 Test Loss: 1.742 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.176706075668335
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.765 Vali Acc: 0.504 Test Loss: 1.765 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2403686046600342
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.782 Vali Acc: 0.504 Test Loss: 1.782 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2512946128845215
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.809 Vali Acc: 0.504 Test Loss: 1.809 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3868272304534912
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.824 Vali Acc: 0.504 Test Loss: 1.824 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3937666416168213
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.839 Vali Acc: 0.504 Test Loss: 1.839 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2029235363006592
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.844 Vali Acc: 0.504 Test Loss: 1.844 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2789382934570312
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.849 Vali Acc: 0.504 Test Loss: 1.849 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 169861
model size : 5.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5826528072357178
Epoch: 1, Steps: 8 | Train Loss: 1.727 Vali Loss: 1.672 Vali Acc: 0.214 Test Loss: 1.672 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 0.9319276809692383
Epoch: 2, Steps: 8 | Train Loss: 1.464 Vali Loss: 1.557 Vali Acc: 0.397 Test Loss: 1.557 Test Acc: 0.397
Validation loss decreased (-0.213724 --> -0.396931).  Saving model ...
Epoch: 3 cost time: 0.9705874919891357
Epoch: 3, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.551 Vali Acc: 0.427 Test Loss: 1.551 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.0131890773773193
Epoch: 4, Steps: 8 | Train Loss: 0.865 Vali Loss: 1.491 Vali Acc: 0.473 Test Loss: 1.491 Test Acc: 0.473
Validation loss decreased (-0.427465 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 0.9998774528503418
Epoch: 5, Steps: 8 | Train Loss: 0.587 Vali Loss: 1.447 Vali Acc: 0.435 Test Loss: 1.447 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0055723190307617
Epoch: 6, Steps: 8 | Train Loss: 0.416 Vali Loss: 1.424 Vali Acc: 0.473 Test Loss: 1.424 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 0.9325010776519775
Epoch: 7, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.428 Vali Acc: 0.489 Test Loss: 1.428 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 0.9705302715301514
Epoch: 8, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.436 Vali Acc: 0.489 Test Loss: 1.436 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0552830696105957
Epoch: 9, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 1.1195566654205322
Epoch: 10, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.497 Vali Acc: 0.504 Test Loss: 1.497 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0829010009765625
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.513 Vali Acc: 0.519 Test Loss: 1.513 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 12 cost time: 1.0735552310943604
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.517 Vali Acc: 0.511 Test Loss: 1.517 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0168607234954834
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.526 Vali Acc: 0.504 Test Loss: 1.526 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0195813179016113
Epoch: 14, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9933874607086182
Epoch: 15, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 16 cost time: 0.932612419128418
Epoch: 16, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.569 Vali Acc: 0.527 Test Loss: 1.569 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9936563968658447
Epoch: 17, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.577 Vali Acc: 0.527 Test Loss: 1.577 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0263283252716064
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.584 Vali Acc: 0.527 Test Loss: 1.584 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9268221855163574
Epoch: 19, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9886066913604736
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.046116590499878
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.612 Vali Acc: 0.527 Test Loss: 1.612 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9867894649505615
Epoch: 22, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0575542449951172
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.632 Vali Acc: 0.527 Test Loss: 1.632 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1802899837493896
Epoch: 24, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.637 Vali Acc: 0.527 Test Loss: 1.637 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9767138957977295
Epoch: 25, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.644 Vali Acc: 0.527 Test Loss: 1.644 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 185221
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7529733180999756
Epoch: 1, Steps: 8 | Train Loss: 1.708 Vali Loss: 1.650 Vali Acc: 0.244 Test Loss: 1.650 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 1.112518310546875
Epoch: 2, Steps: 8 | Train Loss: 1.460 Vali Loss: 1.568 Vali Acc: 0.305 Test Loss: 1.568 Test Acc: 0.305
Validation loss decreased (-0.244258 --> -0.305328).  Saving model ...
Epoch: 3 cost time: 1.0836076736450195
Epoch: 3, Steps: 8 | Train Loss: 1.111 Vali Loss: 1.506 Vali Acc: 0.344 Test Loss: 1.506 Test Acc: 0.344
Validation loss decreased (-0.305328 --> -0.343496).  Saving model ...
Epoch: 4 cost time: 1.1631872653961182
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 1.477 Vali Acc: 0.427 Test Loss: 1.477 Test Acc: 0.427
Validation loss decreased (-0.343496 --> -0.427466).  Saving model ...
Epoch: 5 cost time: 1.2745943069458008
Epoch: 5, Steps: 8 | Train Loss: 0.532 Vali Loss: 1.460 Vali Acc: 0.450 Test Loss: 1.460 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.1947221755981445
Epoch: 6, Steps: 8 | Train Loss: 0.367 Vali Loss: 1.428 Vali Acc: 0.443 Test Loss: 1.428 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0864841938018799
Epoch: 7, Steps: 8 | Train Loss: 0.227 Vali Loss: 1.420 Vali Acc: 0.504 Test Loss: 1.420 Test Acc: 0.504
Validation loss decreased (-0.450367 --> -0.503803).  Saving model ...
Epoch: 8 cost time: 1.0823309421539307
Epoch: 8, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0495753288269043
Epoch: 9, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.440 Vali Acc: 0.473 Test Loss: 1.440 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1580967903137207
Epoch: 10, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.458 Vali Acc: 0.489 Test Loss: 1.458 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1348085403442383
Epoch: 11, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.469 Vali Acc: 0.496 Test Loss: 1.469 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0004198551177979
Epoch: 12, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.476 Vali Acc: 0.496 Test Loss: 1.476 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.260897159576416
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.495 Vali Acc: 0.511 Test Loss: 1.495 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511435).  Saving model ...
Epoch: 14 cost time: 1.0165283679962158
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.504 Vali Acc: 0.504 Test Loss: 1.504 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.105095386505127
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.516 Vali Acc: 0.504 Test Loss: 1.516 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0962402820587158
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.527 Vali Acc: 0.504 Test Loss: 1.527 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1482901573181152
Epoch: 17, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.543 Vali Acc: 0.504 Test Loss: 1.543 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1596205234527588
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.551 Vali Acc: 0.504 Test Loss: 1.551 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1550395488739014
Epoch: 19, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.555 Vali Acc: 0.511 Test Loss: 1.555 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2347004413604736
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.557 Vali Acc: 0.511 Test Loss: 1.557 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.068420648574829
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.568 Vali Acc: 0.511 Test Loss: 1.568 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2537822723388672
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.576 Vali Acc: 0.511 Test Loss: 1.576 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.08201003074646
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.587 Vali Acc: 0.504 Test Loss: 1.587 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 231237
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9973626136779785
Epoch: 1, Steps: 8 | Train Loss: 1.783 Vali Loss: 1.768 Vali Acc: 0.153 Test Loss: 1.768 Test Acc: 0.153
Validation loss decreased (inf --> -0.152654).  Saving model ...
Epoch: 2 cost time: 1.0969233512878418
Epoch: 2, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.677 Vali Acc: 0.198 Test Loss: 1.677 Test Acc: 0.198
Validation loss decreased (-0.152654 --> -0.198457).  Saving model ...
Epoch: 3 cost time: 1.1797900199890137
Epoch: 3, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.594 Vali Acc: 0.298 Test Loss: 1.594 Test Acc: 0.298
Validation loss decreased (-0.198457 --> -0.297694).  Saving model ...
Epoch: 4 cost time: 1.1822147369384766
Epoch: 4, Steps: 8 | Train Loss: 0.871 Vali Loss: 1.549 Vali Acc: 0.382 Test Loss: 1.549 Test Acc: 0.382
Validation loss decreased (-0.297694 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 1.1960630416870117
Epoch: 5, Steps: 8 | Train Loss: 0.573 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.381664 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 1.0587327480316162
Epoch: 6, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.481 Vali Acc: 0.450 Test Loss: 1.481 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.1191363334655762
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.479 Vali Acc: 0.473 Test Loss: 1.479 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.1856796741485596
Epoch: 8, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.489 Vali Acc: 0.489 Test Loss: 1.489 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 1.103053331375122
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.504 Vali Acc: 0.473 Test Loss: 1.504 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3509016036987305
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.521 Vali Acc: 0.496 Test Loss: 1.521 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 11 cost time: 1.0281076431274414
Epoch: 11, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.537 Vali Acc: 0.489 Test Loss: 1.537 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0667731761932373
Epoch: 12, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.544 Vali Acc: 0.481 Test Loss: 1.544 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1170730590820312
Epoch: 13, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.554 Vali Acc: 0.481 Test Loss: 1.554 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1238996982574463
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1364004611968994
Epoch: 15, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.563 Vali Acc: 0.481 Test Loss: 1.563 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1063034534454346
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.571 Vali Acc: 0.473 Test Loss: 1.571 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0534064769744873
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.580 Vali Acc: 0.481 Test Loss: 1.580 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.14725923538208
Epoch: 18, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.583 Vali Acc: 0.481 Test Loss: 1.583 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.07016921043396
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.585 Vali Acc: 0.481 Test Loss: 1.585 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.098219871520996
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.594 Vali Acc: 0.489 Test Loss: 1.594 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 281093
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5457711219787598
Epoch: 1, Steps: 8 | Train Loss: 1.643 Vali Loss: 1.653 Vali Acc: 0.305 Test Loss: 1.653 Test Acc: 0.305
Validation loss decreased (inf --> -0.305327).  Saving model ...
Epoch: 2 cost time: 1.0428264141082764
Epoch: 2, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.585 Vali Acc: 0.374 Test Loss: 1.585 Test Acc: 0.374
Validation loss decreased (-0.305327 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 1.0059537887573242
Epoch: 3, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.522 Vali Acc: 0.397 Test Loss: 1.522 Test Acc: 0.397
Validation loss decreased (-0.374030 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.029266357421875
Epoch: 4, Steps: 8 | Train Loss: 0.654 Vali Loss: 1.481 Vali Acc: 0.443 Test Loss: 1.481 Test Acc: 0.443
Validation loss decreased (-0.396931 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 0.9149563312530518
Epoch: 5, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.449 Vali Acc: 0.458 Test Loss: 1.449 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 6 cost time: 0.9682092666625977
Epoch: 6, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.443 Vali Acc: 0.496 Test Loss: 1.443 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.0392613410949707
Epoch: 7, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.471 Vali Acc: 0.496 Test Loss: 1.471 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0741147994995117
Epoch: 8, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.060178279876709
Epoch: 9, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.495 Vali Acc: 0.489 Test Loss: 1.495 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1009764671325684
Epoch: 10, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.497 Vali Acc: 0.489 Test Loss: 1.497 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.000206708908081
Epoch: 11, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.515 Vali Acc: 0.489 Test Loss: 1.515 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.062363862991333
Epoch: 12, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.527 Vali Acc: 0.504 Test Loss: 1.527 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 1.0896506309509277
Epoch: 13, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.540 Vali Acc: 0.504 Test Loss: 1.540 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9912755489349365
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.547 Vali Acc: 0.504 Test Loss: 1.547 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0266916751861572
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.549 Vali Acc: 0.496 Test Loss: 1.549 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.037177324295044
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1246819496154785
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.561 Vali Acc: 0.511 Test Loss: 1.561 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 18 cost time: 0.946375846862793
Epoch: 18, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.567 Vali Acc: 0.511 Test Loss: 1.567 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9932656288146973
Epoch: 19, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.576 Vali Acc: 0.511 Test Loss: 1.576 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0919139385223389
Epoch: 20, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.582 Vali Acc: 0.511 Test Loss: 1.582 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9428999423980713
Epoch: 21, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.589 Vali Acc: 0.519 Test Loss: 1.589 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519068).  Saving model ...
Epoch: 22 cost time: 1.1057000160217285
Epoch: 22, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.598 Vali Acc: 0.519 Test Loss: 1.598 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0208978652954102
Epoch: 23, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
Validation loss decreased (-0.519068 --> -0.526702).  Saving model ...
Epoch: 24 cost time: 0.9151697158813477
Epoch: 24, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 25 cost time: 1.065068006515503
Epoch: 25, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.603 Vali Acc: 0.519 Test Loss: 1.603 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1675524711608887
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.609 Vali Acc: 0.527 Test Loss: 1.609 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0450432300567627
Epoch: 27, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.619 Vali Acc: 0.527 Test Loss: 1.619 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1015393733978271
Epoch: 28, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.631 Vali Acc: 0.534 Test Loss: 1.631 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 29 cost time: 0.9691603183746338
Epoch: 29, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.534 Test Loss: 1.641 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0012140274047852
Epoch: 30, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.519 Test Loss: 1.651 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2418415546417236
Epoch: 31, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.656 Vali Acc: 0.519 Test Loss: 1.656 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9764771461486816
Epoch: 32, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.655 Vali Acc: 0.519 Test Loss: 1.655 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9807212352752686
Epoch: 33, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.654 Vali Acc: 0.519 Test Loss: 1.654 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0958495140075684
Epoch: 34, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.661 Vali Acc: 0.519 Test Loss: 1.661 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1946015357971191
Epoch: 35, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.519 Test Loss: 1.669 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8743059635162354
Epoch: 36, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.674 Vali Acc: 0.519 Test Loss: 1.674 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9595863819122314
Epoch: 37, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.675 Vali Acc: 0.519 Test Loss: 1.675 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9518430233001709
Epoch: 38, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.534 Test Loss: 1.671 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 336709
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8941802978515625
Epoch: 1, Steps: 8 | Train Loss: 1.548 Vali Loss: 1.591 Vali Acc: 0.397 Test Loss: 1.591 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 1.3498449325561523
Epoch: 2, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.612 Vali Acc: 0.389 Test Loss: 1.612 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3318238258361816
Epoch: 3, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.416 Vali Acc: 0.466 Test Loss: 1.416 Test Acc: 0.466
Validation loss decreased (-0.396931 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.313965082168579
Epoch: 4, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.315093755722046
Epoch: 5, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.450 Vali Acc: 0.519 Test Loss: 1.450 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.2590115070343018
Epoch: 6, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.547 Vali Acc: 0.511 Test Loss: 1.547 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2746999263763428
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.620 Vali Acc: 0.504 Test Loss: 1.620 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3648285865783691
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.633 Vali Acc: 0.496 Test Loss: 1.633 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2729766368865967
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.782 Vali Acc: 0.527 Test Loss: 1.782 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526700).  Saving model ...
Epoch: 10 cost time: 1.2590422630310059
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.773 Vali Acc: 0.511 Test Loss: 1.773 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.33073091506958
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.786 Vali Acc: 0.511 Test Loss: 1.786 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2996153831481934
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.816 Vali Acc: 0.511 Test Loss: 1.816 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3807373046875
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.835 Vali Acc: 0.511 Test Loss: 1.835 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2949426174163818
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.511 Test Loss: 1.857 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3606116771697998
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.511 Test Loss: 1.853 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3773527145385742
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.511 Test Loss: 1.844 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3983547687530518
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.511 Test Loss: 1.852 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3112361431121826
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.511 Test Loss: 1.854 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.297253131866455
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.886 Vali Acc: 0.511 Test Loss: 1.886 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 205829
model size : 5.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0160880088806152
Epoch: 1, Steps: 8 | Train Loss: 1.717 Vali Loss: 1.605 Vali Acc: 0.382 Test Loss: 1.605 Test Acc: 0.382
Validation loss decreased (inf --> -0.381663).  Saving model ...
Epoch: 2 cost time: 1.1631977558135986
Epoch: 2, Steps: 8 | Train Loss: 1.431 Vali Loss: 1.659 Vali Acc: 0.412 Test Loss: 1.659 Test Acc: 0.412
Validation loss decreased (-0.381663 --> -0.412197).  Saving model ...
Epoch: 3 cost time: 1.2995595932006836
Epoch: 3, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.543 Vali Acc: 0.450 Test Loss: 1.543 Test Acc: 0.450
Validation loss decreased (-0.412197 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.2618896961212158
Epoch: 4, Steps: 8 | Train Loss: 0.790 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450367).  Saving model ...
Epoch: 5 cost time: 1.229581594467163
Epoch: 5, Steps: 8 | Train Loss: 0.484 Vali Loss: 1.467 Vali Acc: 0.511 Test Loss: 1.467 Test Acc: 0.511
Validation loss decreased (-0.450367 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.3314337730407715
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.458 Vali Acc: 0.519 Test Loss: 1.458 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.251004695892334
Epoch: 7, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.474 Vali Acc: 0.534 Test Loss: 1.474 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 1.215036153793335
Epoch: 8, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.503 Vali Acc: 0.519 Test Loss: 1.503 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3500301837921143
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.607 Vali Acc: 0.519 Test Loss: 1.607 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2098546028137207
Epoch: 10, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.629 Vali Acc: 0.511 Test Loss: 1.629 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3222413063049316
Epoch: 11, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.577 Vali Acc: 0.504 Test Loss: 1.577 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2464404106140137
Epoch: 12, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.604 Vali Acc: 0.504 Test Loss: 1.604 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.230994701385498
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.664 Vali Acc: 0.504 Test Loss: 1.664 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2770514488220215
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.672 Vali Acc: 0.511 Test Loss: 1.672 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1741561889648438
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.667 Vali Acc: 0.504 Test Loss: 1.667 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1532237529754639
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.688 Vali Acc: 0.496 Test Loss: 1.688 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1568286418914795
Epoch: 17, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.717 Vali Acc: 0.527 Test Loss: 1.717 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 157829
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.642306327819824
Epoch: 1, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.538 Vali Acc: 0.282 Test Loss: 1.538 Test Acc: 0.282
Validation loss decreased (inf --> -0.282427).  Saving model ...
Epoch: 2 cost time: 1.1248235702514648
Epoch: 2, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.282427 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1016716957092285
Epoch: 3, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.569 Vali Acc: 0.435 Test Loss: 1.569 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.2254161834716797
Epoch: 4, Steps: 8 | Train Loss: 0.885 Vali Loss: 1.455 Vali Acc: 0.458 Test Loss: 1.455 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.1574180126190186
Epoch: 5, Steps: 8 | Train Loss: 0.578 Vali Loss: 1.403 Vali Acc: 0.489 Test Loss: 1.403 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 1.201770544052124
Epoch: 6, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.388 Vali Acc: 0.496 Test Loss: 1.388 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.1718401908874512
Epoch: 7, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.0884552001953125
Epoch: 8, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.453 Vali Acc: 0.496 Test Loss: 1.453 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1839733123779297
Epoch: 9, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 10 cost time: 1.0143964290618896
Epoch: 10, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.602 Vali Acc: 0.527 Test Loss: 1.602 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0995187759399414
Epoch: 11, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.563 Vali Acc: 0.534 Test Loss: 1.563 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534336).  Saving model ...
Epoch: 12 cost time: 1.0579524040222168
Epoch: 12, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.578 Vali Acc: 0.542 Test Loss: 1.578 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 13 cost time: 1.0546185970306396
Epoch: 13, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.614 Vali Acc: 0.542 Test Loss: 1.614 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0815415382385254
Epoch: 14, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.679 Vali Acc: 0.542 Test Loss: 1.679 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.106419324874878
Epoch: 15, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.696 Vali Acc: 0.534 Test Loss: 1.696 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1565279960632324
Epoch: 16, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.680 Vali Acc: 0.534 Test Loss: 1.680 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1488640308380127
Epoch: 17, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.690 Vali Acc: 0.534 Test Loss: 1.690 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0850539207458496
Epoch: 18, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.713 Vali Acc: 0.534 Test Loss: 1.713 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1672828197479248
Epoch: 19, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.735 Vali Acc: 0.534 Test Loss: 1.735 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2340586185455322
Epoch: 20, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.753 Vali Acc: 0.534 Test Loss: 1.753 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.163496971130371
Epoch: 21, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.766 Vali Acc: 0.534 Test Loss: 1.766 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.204087495803833
Epoch: 22, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.771 Vali Acc: 0.534 Test Loss: 1.771 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 161605
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.602060556411743
Epoch: 1, Steps: 8 | Train Loss: 1.827 Vali Loss: 1.657 Vali Acc: 0.229 Test Loss: 1.657 Test Acc: 0.229
Validation loss decreased (inf --> -0.228991).  Saving model ...
Epoch: 2 cost time: 1.0257399082183838
Epoch: 2, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.598 Vali Acc: 0.336 Test Loss: 1.598 Test Acc: 0.336
Validation loss decreased (-0.228991 --> -0.335862).  Saving model ...
Epoch: 3 cost time: 0.9778263568878174
Epoch: 3, Steps: 8 | Train Loss: 1.239 Vali Loss: 1.606 Vali Acc: 0.412 Test Loss: 1.606 Test Acc: 0.412
Validation loss decreased (-0.335862 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.017137050628662
Epoch: 4, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 5 cost time: 0.9862158298492432
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.509 Vali Acc: 0.435 Test Loss: 1.509 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 0.9177675247192383
Epoch: 6, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.474 Vali Acc: 0.466 Test Loss: 1.474 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.9634976387023926
Epoch: 7, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 1.030541181564331
Epoch: 8, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511436).  Saving model ...
Epoch: 9 cost time: 0.8252360820770264
Epoch: 9, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.501 Vali Acc: 0.511 Test Loss: 1.501 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.928377628326416
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.526 Vali Acc: 0.519 Test Loss: 1.526 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 1.0683794021606445
Epoch: 11, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.575 Vali Acc: 0.542 Test Loss: 1.575 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541969).  Saving model ...
Epoch: 12 cost time: 0.9626140594482422
Epoch: 12, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549602).  Saving model ...
Epoch: 13 cost time: 0.9873340129852295
Epoch: 13, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.614 Vali Acc: 0.550 Test Loss: 1.614 Test Acc: 0.550
Validation loss decreased (-0.549602 --> -0.549602).  Saving model ...
Epoch: 14 cost time: 0.9898166656494141
Epoch: 14, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.602 Vali Acc: 0.542 Test Loss: 1.602 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8840224742889404
Epoch: 15, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.611 Vali Acc: 0.534 Test Loss: 1.611 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9314265251159668
Epoch: 16, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.635 Vali Acc: 0.534 Test Loss: 1.635 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9713780879974365
Epoch: 17, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.648 Vali Acc: 0.534 Test Loss: 1.648 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0588350296020508
Epoch: 18, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.652 Vali Acc: 0.534 Test Loss: 1.652 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9374537467956543
Epoch: 19, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.662 Vali Acc: 0.542 Test Loss: 1.662 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.050278663635254
Epoch: 20, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.676 Vali Acc: 0.550 Test Loss: 1.676 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0117928981781006
Epoch: 21, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.683 Vali Acc: 0.550 Test Loss: 1.683 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9719431400299072
Epoch: 22, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.692 Vali Acc: 0.550 Test Loss: 1.692 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.044691801071167
Epoch: 23, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.550 Test Loss: 1.702 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 176965
model size : 5.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.426279067993164
Epoch: 1, Steps: 8 | Train Loss: 1.795 Vali Loss: 1.587 Vali Acc: 0.336 Test Loss: 1.587 Test Acc: 0.336
Validation loss decreased (inf --> -0.335862).  Saving model ...
Epoch: 2 cost time: 0.8889334201812744
Epoch: 2, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.493 Vali Acc: 0.412 Test Loss: 1.493 Test Acc: 0.412
Validation loss decreased (-0.335862 --> -0.412199).  Saving model ...
Epoch: 3 cost time: 1.0012538433074951
Epoch: 3, Steps: 8 | Train Loss: 1.176 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
Validation loss decreased (-0.412199 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.9598727226257324
Epoch: 4, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.394 Vali Acc: 0.466 Test Loss: 1.394 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 1.0182771682739258
Epoch: 5, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.362 Vali Acc: 0.489 Test Loss: 1.362 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 0.8545126914978027
Epoch: 6, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.343 Vali Acc: 0.496 Test Loss: 1.343 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 7 cost time: 0.9170238971710205
Epoch: 7, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.348 Vali Acc: 0.473 Test Loss: 1.348 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.901555061340332
Epoch: 8, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.367 Vali Acc: 0.473 Test Loss: 1.367 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.937401294708252
Epoch: 9, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.388 Vali Acc: 0.496 Test Loss: 1.388 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8807172775268555
Epoch: 10, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.397 Vali Acc: 0.473 Test Loss: 1.397 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0161828994750977
Epoch: 11, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.406 Vali Acc: 0.473 Test Loss: 1.406 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0017542839050293
Epoch: 12, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.413 Vali Acc: 0.473 Test Loss: 1.413 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.901623010635376
Epoch: 13, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.436 Vali Acc: 0.473 Test Loss: 1.436 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9524304866790771
Epoch: 14, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.453 Vali Acc: 0.489 Test Loss: 1.453 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.992293119430542
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.464 Vali Acc: 0.489 Test Loss: 1.464 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0748448371887207
Epoch: 16, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 222981
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6997859477996826
Epoch: 1, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.707 Vali Acc: 0.237 Test Loss: 1.707 Test Acc: 0.237
Validation loss decreased (inf --> -0.236624).  Saving model ...
Epoch: 2 cost time: 0.9276893138885498
Epoch: 2, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.665 Vali Acc: 0.237 Test Loss: 1.665 Test Acc: 0.237
Validation loss decreased (-0.236624 --> -0.236625).  Saving model ...
Epoch: 3 cost time: 0.9972827434539795
Epoch: 3, Steps: 8 | Train Loss: 1.110 Vali Loss: 1.631 Vali Acc: 0.336 Test Loss: 1.631 Test Acc: 0.336
Validation loss decreased (-0.236625 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 0.9884192943572998
Epoch: 4, Steps: 8 | Train Loss: 0.748 Vali Loss: 1.608 Vali Acc: 0.405 Test Loss: 1.608 Test Acc: 0.405
Validation loss decreased (-0.335862 --> -0.404564).  Saving model ...
Epoch: 5 cost time: 0.8744635581970215
Epoch: 5, Steps: 8 | Train Loss: 0.486 Vali Loss: 1.572 Vali Acc: 0.420 Test Loss: 1.572 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 0.9480164051055908
Epoch: 6, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.553 Vali Acc: 0.443 Test Loss: 1.553 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 0.9219105243682861
Epoch: 7, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.554 Vali Acc: 0.458 Test Loss: 1.554 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 0.9151914119720459
Epoch: 8, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.567 Vali Acc: 0.466 Test Loss: 1.567 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 9 cost time: 0.9557430744171143
Epoch: 9, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.593 Vali Acc: 0.473 Test Loss: 1.593 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473267).  Saving model ...
Epoch: 10 cost time: 1.0837769508361816
Epoch: 10, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.605 Vali Acc: 0.481 Test Loss: 1.605 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480900).  Saving model ...
Epoch: 11 cost time: 1.0802276134490967
Epoch: 11, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.627 Vali Acc: 0.473 Test Loss: 1.627 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0625386238098145
Epoch: 12, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.644 Vali Acc: 0.473 Test Loss: 1.644 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.101773738861084
Epoch: 13, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.667 Vali Acc: 0.473 Test Loss: 1.667 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0046827793121338
Epoch: 14, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.689 Vali Acc: 0.473 Test Loss: 1.689 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0026147365570068
Epoch: 15, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.706 Vali Acc: 0.473 Test Loss: 1.706 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9630205631256104
Epoch: 16, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.715 Vali Acc: 0.466 Test Loss: 1.715 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1314051151275635
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.728 Vali Acc: 0.458 Test Loss: 1.728 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0308754444122314
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.729 Vali Acc: 0.458 Test Loss: 1.729 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0527291297912598
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.733 Vali Acc: 0.458 Test Loss: 1.733 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1271896362304688
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.740 Vali Acc: 0.450 Test Loss: 1.740 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 272837
model size : 5.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7589099407196045
Epoch: 1, Steps: 8 | Train Loss: 1.709 Vali Loss: 1.662 Vali Acc: 0.183 Test Loss: 1.662 Test Acc: 0.183
Validation loss decreased (inf --> -0.183189).  Saving model ...
Epoch: 2 cost time: 0.9132366180419922
Epoch: 2, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.622 Vali Acc: 0.321 Test Loss: 1.622 Test Acc: 0.321
Validation loss decreased (-0.183189 --> -0.320594).  Saving model ...
Epoch: 3 cost time: 0.9651048183441162
Epoch: 3, Steps: 8 | Train Loss: 1.077 Vali Loss: 1.564 Vali Acc: 0.382 Test Loss: 1.564 Test Acc: 0.382
Validation loss decreased (-0.320594 --> -0.381664).  Saving model ...
Epoch: 4 cost time: 0.9931137561798096
Epoch: 4, Steps: 8 | Train Loss: 0.674 Vali Loss: 1.516 Vali Acc: 0.412 Test Loss: 1.516 Test Acc: 0.412
Validation loss decreased (-0.381664 --> -0.412199).  Saving model ...
Epoch: 5 cost time: 1.0381481647491455
Epoch: 5, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.478 Vali Acc: 0.450 Test Loss: 1.478 Test Acc: 0.450
Validation loss decreased (-0.412199 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 1.0765371322631836
Epoch: 6, Steps: 8 | Train Loss: 0.271 Vali Loss: 1.474 Vali Acc: 0.435 Test Loss: 1.474 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0244009494781494
Epoch: 7, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.484 Vali Acc: 0.412 Test Loss: 1.484 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0974533557891846
Epoch: 8, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 1.0314834117889404
Epoch: 9, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.524 Vali Acc: 0.435 Test Loss: 1.524 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0033926963806152
Epoch: 10, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.534 Vali Acc: 0.405 Test Loss: 1.534 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0142638683319092
Epoch: 11, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.539 Vali Acc: 0.450 Test Loss: 1.539 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9774937629699707
Epoch: 12, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.561 Vali Acc: 0.450 Test Loss: 1.561 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0235013961791992
Epoch: 13, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.578 Vali Acc: 0.450 Test Loss: 1.578 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9759173393249512
Epoch: 14, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.594 Vali Acc: 0.450 Test Loss: 1.594 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.116931438446045
Epoch: 15, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.603 Vali Acc: 0.443 Test Loss: 1.603 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9671540260314941
Epoch: 16, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.621 Vali Acc: 0.458 Test Loss: 1.621 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9475760459899902
Epoch: 17, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.632 Vali Acc: 0.443 Test Loss: 1.632 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0216693878173828
Epoch: 18, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.641 Vali Acc: 0.435 Test Loss: 1.641 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm64_nh16_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 328453
model size : 5.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9459402561187744
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.668 Vali Acc: 0.389 Test Loss: 1.668 Test Acc: 0.389
Validation loss decreased (inf --> -0.389296).  Saving model ...
Epoch: 2 cost time: 1.1388630867004395
Epoch: 2, Steps: 8 | Train Loss: 1.458 Vali Loss: 1.740 Vali Acc: 0.435 Test Loss: 1.740 Test Acc: 0.435
Validation loss decreased (-0.389296 --> -0.435097).  Saving model ...
Epoch: 3 cost time: 1.1183452606201172
Epoch: 3, Steps: 8 | Train Loss: 1.158 Vali Loss: 1.615 Vali Acc: 0.435 Test Loss: 1.615 Test Acc: 0.435
Validation loss decreased (-0.435097 --> -0.435098).  Saving model ...
Epoch: 4 cost time: 1.1590723991394043
Epoch: 4, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.534 Vali Acc: 0.450 Test Loss: 1.534 Test Acc: 0.450
Validation loss decreased (-0.435098 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 1.2717902660369873
Epoch: 5, Steps: 8 | Train Loss: 0.621 Vali Loss: 1.570 Vali Acc: 0.489 Test Loss: 1.570 Test Acc: 0.489
Validation loss decreased (-0.450366 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.129040002822876
Epoch: 6, Steps: 8 | Train Loss: 0.387 Vali Loss: 1.476 Vali Acc: 0.519 Test Loss: 1.476 Test Acc: 0.519
Validation loss decreased (-0.488534 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.228837490081787
Epoch: 7, Steps: 8 | Train Loss: 0.207 Vali Loss: 1.542 Vali Acc: 0.511 Test Loss: 1.542 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1267132759094238
Epoch: 8, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.505 Vali Acc: 0.511 Test Loss: 1.505 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1754629611968994
Epoch: 9, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.610 Vali Acc: 0.527 Test Loss: 1.610 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526701).  Saving model ...
Epoch: 10 cost time: 1.0472826957702637
Epoch: 10, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.694 Vali Acc: 0.527 Test Loss: 1.694 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0213444232940674
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.603 Vali Acc: 0.504 Test Loss: 1.603 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.172971487045288
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.648 Vali Acc: 0.504 Test Loss: 1.648 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1913025379180908
Epoch: 13, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.754 Vali Acc: 0.527 Test Loss: 1.754 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.121589183807373
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.797 Vali Acc: 0.534 Test Loss: 1.797 Test Acc: 0.534
Validation loss decreased (-0.526701 --> -0.534333).  Saving model ...
Epoch: 15 cost time: 0.9985687732696533
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.775 Vali Acc: 0.527 Test Loss: 1.775 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0236706733703613
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.755 Vali Acc: 0.519 Test Loss: 1.755 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.114339828491211
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.758 Vali Acc: 0.511 Test Loss: 1.758 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2538549900054932
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.775 Vali Acc: 0.519 Test Loss: 1.775 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2407488822937012
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.796 Vali Acc: 0.519 Test Loss: 1.796 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1354846954345703
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.800 Vali Acc: 0.519 Test Loss: 1.800 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2288391590118408
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.817 Vali Acc: 0.519 Test Loss: 1.817 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1330432891845703
Epoch: 22, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.818 Vali Acc: 0.519 Test Loss: 1.818 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.148085355758667
Epoch: 23, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.519 Test Loss: 1.827 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1753201484680176
Epoch: 24, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.828 Vali Acc: 0.519 Test Loss: 1.828 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 111333
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6587955951690674
Epoch: 1, Steps: 8 | Train Loss: 1.662 Vali Loss: 1.646 Vali Acc: 0.267 Test Loss: 1.646 Test Acc: 0.267
Validation loss decreased (inf --> -0.267159).  Saving model ...
Epoch: 2 cost time: 1.089120864868164
Epoch: 2, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.573 Vali Acc: 0.427 Test Loss: 1.573 Test Acc: 0.427
Validation loss decreased (-0.267159 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 0.8999691009521484
Epoch: 3, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.567 Vali Acc: 0.435 Test Loss: 1.567 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.064182996749878
Epoch: 4, Steps: 8 | Train Loss: 1.114 Vali Loss: 1.501 Vali Acc: 0.458 Test Loss: 1.501 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.0376231670379639
Epoch: 5, Steps: 8 | Train Loss: 0.869 Vali Loss: 1.450 Vali Acc: 0.489 Test Loss: 1.450 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488535).  Saving model ...
Epoch: 6 cost time: 1.0719377994537354
Epoch: 6, Steps: 8 | Train Loss: 0.640 Vali Loss: 1.425 Vali Acc: 0.504 Test Loss: 1.425 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.0124163627624512
Epoch: 7, Steps: 8 | Train Loss: 0.478 Vali Loss: 1.367 Vali Acc: 0.511 Test Loss: 1.367 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 8 cost time: 1.1195416450500488
Epoch: 8, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.367 Vali Acc: 0.496 Test Loss: 1.367 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0796034336090088
Epoch: 9, Steps: 8 | Train Loss: 0.203 Vali Loss: 1.427 Vali Acc: 0.519 Test Loss: 1.427 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 0.9952542781829834
Epoch: 10, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.341 Vali Acc: 0.534 Test Loss: 1.341 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534338).  Saving model ...
Epoch: 11 cost time: 1.089900016784668
Epoch: 11, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.357 Vali Acc: 0.534 Test Loss: 1.357 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0369184017181396
Epoch: 12, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.404 Vali Acc: 0.534 Test Loss: 1.404 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0059990882873535
Epoch: 13, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.444 Vali Acc: 0.534 Test Loss: 1.444 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1062393188476562
Epoch: 14, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.443 Vali Acc: 0.534 Test Loss: 1.443 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.056565761566162
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0329523086547852
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.468 Vali Acc: 0.534 Test Loss: 1.468 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8975322246551514
Epoch: 17, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.485 Vali Acc: 0.542 Test Loss: 1.485 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541970).  Saving model ...
Epoch: 18 cost time: 0.9469401836395264
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.486 Vali Acc: 0.534 Test Loss: 1.486 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0009796619415283
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.496 Vali Acc: 0.527 Test Loss: 1.496 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9676716327667236
Epoch: 20, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.490 Vali Acc: 0.527 Test Loss: 1.490 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8647527694702148
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.491 Vali Acc: 0.519 Test Loss: 1.491 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0620532035827637
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.498 Vali Acc: 0.527 Test Loss: 1.498 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.110119342803955
Epoch: 23, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0563077926635742
Epoch: 24, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.524 Vali Acc: 0.527 Test Loss: 1.524 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9858815670013428
Epoch: 25, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.537 Vali Acc: 0.527 Test Loss: 1.537 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0170018672943115
Epoch: 26, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9880926609039307
Epoch: 27, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 87333
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7787363529205322
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.649 Vali Acc: 0.359 Test Loss: 1.649 Test Acc: 0.359
Validation loss decreased (inf --> -0.358762).  Saving model ...
Epoch: 2 cost time: 1.0331110954284668
Epoch: 2, Steps: 8 | Train Loss: 1.421 Vali Loss: 1.653 Vali Acc: 0.382 Test Loss: 1.653 Test Acc: 0.382
Validation loss decreased (-0.358762 --> -0.381663).  Saving model ...
Epoch: 3 cost time: 0.961341381072998
Epoch: 3, Steps: 8 | Train Loss: 1.288 Vali Loss: 1.649 Vali Acc: 0.397 Test Loss: 1.649 Test Acc: 0.397
Validation loss decreased (-0.381663 --> -0.396930).  Saving model ...
Epoch: 4 cost time: 0.9202706813812256
Epoch: 4, Steps: 8 | Train Loss: 1.069 Vali Loss: 1.596 Vali Acc: 0.405 Test Loss: 1.596 Test Acc: 0.405
Validation loss decreased (-0.396930 --> -0.404564).  Saving model ...
Epoch: 5 cost time: 0.9889757633209229
Epoch: 5, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (-0.404564 --> -0.419832).  Saving model ...
Epoch: 6 cost time: 0.8737471103668213
Epoch: 6, Steps: 8 | Train Loss: 0.711 Vali Loss: 1.478 Vali Acc: 0.473 Test Loss: 1.478 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 0.9218437671661377
Epoch: 7, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.451 Vali Acc: 0.511 Test Loss: 1.451 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 0.8662147521972656
Epoch: 8, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0885827541351318
Epoch: 9, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.375 Vali Acc: 0.534 Test Loss: 1.375 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534337).  Saving model ...
Epoch: 10 cost time: 1.0279300212860107
Epoch: 10, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.397 Vali Acc: 0.534 Test Loss: 1.397 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9994549751281738
Epoch: 11, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.407 Vali Acc: 0.550 Test Loss: 1.407 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549604).  Saving model ...
Epoch: 12 cost time: 0.9175064563751221
Epoch: 12, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.390 Vali Acc: 0.542 Test Loss: 1.390 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1403586864471436
Epoch: 13, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.984368085861206
Epoch: 14, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0210680961608887
Epoch: 15, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.475 Vali Acc: 0.542 Test Loss: 1.475 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8987216949462891
Epoch: 16, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.486 Vali Acc: 0.542 Test Loss: 1.486 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9955804347991943
Epoch: 17, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.459 Vali Acc: 0.542 Test Loss: 1.459 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9520959854125977
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.443 Vali Acc: 0.542 Test Loss: 1.443 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8828938007354736
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.450 Vali Acc: 0.542 Test Loss: 1.450 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9585306644439697
Epoch: 20, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.469 Vali Acc: 0.534 Test Loss: 1.469 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9957962036132812
Epoch: 21, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 89221
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5811572074890137
Epoch: 1, Steps: 8 | Train Loss: 1.678 Vali Loss: 1.639 Vali Acc: 0.321 Test Loss: 1.639 Test Acc: 0.321
Validation loss decreased (inf --> -0.320594).  Saving model ...
Epoch: 2 cost time: 0.9057998657226562
Epoch: 2, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.615 Vali Acc: 0.359 Test Loss: 1.615 Test Acc: 0.359
Validation loss decreased (-0.320594 --> -0.358762).  Saving model ...
Epoch: 3 cost time: 0.9987888336181641
Epoch: 3, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.591 Vali Acc: 0.412 Test Loss: 1.591 Test Acc: 0.412
Validation loss decreased (-0.358762 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 0.9758203029632568
Epoch: 4, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.550 Vali Acc: 0.427 Test Loss: 1.550 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 0.9817695617675781
Epoch: 5, Steps: 8 | Train Loss: 0.939 Vali Loss: 1.502 Vali Acc: 0.458 Test Loss: 1.502 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 1.095278024673462
Epoch: 6, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.459 Vali Acc: 0.466 Test Loss: 1.459 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 1.109987497329712
Epoch: 7, Steps: 8 | Train Loss: 0.604 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 1.0191679000854492
Epoch: 8, Steps: 8 | Train Loss: 0.466 Vali Loss: 1.431 Vali Acc: 0.466 Test Loss: 1.431 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0289344787597656
Epoch: 9, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.426 Vali Acc: 0.481 Test Loss: 1.426 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 1.0569171905517578
Epoch: 10, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.422 Vali Acc: 0.473 Test Loss: 1.422 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.096527338027954
Epoch: 11, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.434 Vali Acc: 0.473 Test Loss: 1.434 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.935197114944458
Epoch: 12, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 0.9263207912445068
Epoch: 13, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.455 Vali Acc: 0.496 Test Loss: 1.455 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 14 cost time: 0.9730665683746338
Epoch: 14, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.464 Vali Acc: 0.504 Test Loss: 1.464 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 15 cost time: 1.1194090843200684
Epoch: 15, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.483 Vali Acc: 0.511 Test Loss: 1.483 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 16 cost time: 0.881295919418335
Epoch: 16, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9702515602111816
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.511 Vali Acc: 0.519 Test Loss: 1.511 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 18 cost time: 0.9861071109771729
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.511 Vali Acc: 0.511 Test Loss: 1.511 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0233476161956787
Epoch: 19, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9596121311187744
Epoch: 20, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9827442169189453
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.544 Vali Acc: 0.511 Test Loss: 1.544 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0627167224884033
Epoch: 22, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.551 Vali Acc: 0.511 Test Loss: 1.551 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.022386074066162
Epoch: 23, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.552 Vali Acc: 0.511 Test Loss: 1.552 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0139214992523193
Epoch: 24, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.550 Vali Acc: 0.511 Test Loss: 1.550 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0271854400634766
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.551 Vali Acc: 0.504 Test Loss: 1.551 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.112757682800293
Epoch: 26, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.562 Vali Acc: 0.504 Test Loss: 1.562 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1173601150512695
Epoch: 27, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.569 Vali Acc: 0.504 Test Loss: 1.569 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 96901
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6725194454193115
Epoch: 1, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.624 Vali Acc: 0.214 Test Loss: 1.624 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 0.9978907108306885
Epoch: 2, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.578 Vali Acc: 0.282 Test Loss: 1.578 Test Acc: 0.282
Validation loss decreased (-0.213724 --> -0.282427).  Saving model ...
Epoch: 3 cost time: 0.9316701889038086
Epoch: 3, Steps: 8 | Train Loss: 1.278 Vali Loss: 1.539 Vali Acc: 0.382 Test Loss: 1.539 Test Acc: 0.382
Validation loss decreased (-0.282427 --> -0.381664).  Saving model ...
Epoch: 4 cost time: 0.9455039501190186
Epoch: 4, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
Validation loss decreased (-0.381664 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.1051838397979736
Epoch: 5, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.503 Vali Acc: 0.481 Test Loss: 1.503 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.0948512554168701
Epoch: 6, Steps: 8 | Train Loss: 0.687 Vali Loss: 1.488 Vali Acc: 0.466 Test Loss: 1.488 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9610111713409424
Epoch: 7, Steps: 8 | Train Loss: 0.509 Vali Loss: 1.471 Vali Acc: 0.527 Test Loss: 1.471 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 0.879406213760376
Epoch: 8, Steps: 8 | Train Loss: 0.418 Vali Loss: 1.460 Vali Acc: 0.496 Test Loss: 1.460 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0214214324951172
Epoch: 9, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0641255378723145
Epoch: 10, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8935415744781494
Epoch: 11, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9234588146209717
Epoch: 12, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.488 Vali Acc: 0.496 Test Loss: 1.488 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0521082878112793
Epoch: 13, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.488 Vali Acc: 0.511 Test Loss: 1.488 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8811192512512207
Epoch: 14, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9479680061340332
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.527 Vali Acc: 0.504 Test Loss: 1.527 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9147157669067383
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.538 Vali Acc: 0.504 Test Loss: 1.538 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0644259452819824
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.549 Vali Acc: 0.496 Test Loss: 1.549 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 119909
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.446732759475708
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.585 Vali Acc: 0.252 Test Loss: 1.585 Test Acc: 0.252
Validation loss decreased (inf --> -0.251893).  Saving model ...
Epoch: 2 cost time: 0.9287726879119873
Epoch: 2, Steps: 8 | Train Loss: 1.581 Vali Loss: 1.567 Vali Acc: 0.298 Test Loss: 1.567 Test Acc: 0.298
Validation loss decreased (-0.251893 --> -0.297694).  Saving model ...
Epoch: 3 cost time: 0.9549286365509033
Epoch: 3, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.539 Vali Acc: 0.336 Test Loss: 1.539 Test Acc: 0.336
Validation loss decreased (-0.297694 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 0.8870258331298828
Epoch: 4, Steps: 8 | Train Loss: 1.042 Vali Loss: 1.516 Vali Acc: 0.382 Test Loss: 1.516 Test Acc: 0.382
Validation loss decreased (-0.335862 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 0.8515808582305908
Epoch: 5, Steps: 8 | Train Loss: 0.842 Vali Loss: 1.506 Vali Acc: 0.435 Test Loss: 1.506 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 0.8989217281341553
Epoch: 6, Steps: 8 | Train Loss: 0.605 Vali Loss: 1.490 Vali Acc: 0.450 Test Loss: 1.490 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.0103092193603516
Epoch: 7, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.484 Vali Acc: 0.473 Test Loss: 1.484 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 0.9301755428314209
Epoch: 8, Steps: 8 | Train Loss: 0.335 Vali Loss: 1.476 Vali Acc: 0.473 Test Loss: 1.476 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 0.9892430305480957
Epoch: 9, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.473 Vali Acc: 0.489 Test Loss: 1.473 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 0.9396209716796875
Epoch: 10, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.98931884765625
Epoch: 11, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.479 Vali Acc: 0.496 Test Loss: 1.479 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 12 cost time: 0.9571645259857178
Epoch: 12, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.986163854598999
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.489 Vali Acc: 0.504 Test Loss: 1.489 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 14 cost time: 0.8693563938140869
Epoch: 14, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 0.907907247543335
Epoch: 15, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.497 Vali Acc: 0.527 Test Loss: 1.497 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 16 cost time: 0.8925409317016602
Epoch: 16, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9044592380523682
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.537 Vali Acc: 0.519 Test Loss: 1.537 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8971619606018066
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.545 Vali Acc: 0.511 Test Loss: 1.545 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9348163604736328
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.556 Vali Acc: 0.519 Test Loss: 1.556 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.98464035987854
Epoch: 20, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.571 Vali Acc: 0.504 Test Loss: 1.571 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7452192306518555
Epoch: 21, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.580 Vali Acc: 0.489 Test Loss: 1.580 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7978909015655518
Epoch: 22, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.581 Vali Acc: 0.504 Test Loss: 1.581 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9015636444091797
Epoch: 23, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.580 Vali Acc: 0.511 Test Loss: 1.580 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7604827880859375
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.587 Vali Acc: 0.496 Test Loss: 1.587 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7992229461669922
Epoch: 25, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.593 Vali Acc: 0.489 Test Loss: 1.593 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 144837
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.628412961959839
Epoch: 1, Steps: 8 | Train Loss: 1.704 Vali Loss: 1.743 Vali Acc: 0.137 Test Loss: 1.743 Test Acc: 0.137
Validation loss decreased (inf --> -0.137387).  Saving model ...
Epoch: 2 cost time: 1.0423643589019775
Epoch: 2, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.698 Vali Acc: 0.237 Test Loss: 1.698 Test Acc: 0.237
Validation loss decreased (-0.137387 --> -0.236624).  Saving model ...
Epoch: 3 cost time: 0.8861823081970215
Epoch: 3, Steps: 8 | Train Loss: 1.228 Vali Loss: 1.652 Vali Acc: 0.298 Test Loss: 1.652 Test Acc: 0.298
Validation loss decreased (-0.236624 --> -0.297693).  Saving model ...
Epoch: 4 cost time: 0.9172835350036621
Epoch: 4, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.607 Vali Acc: 0.359 Test Loss: 1.607 Test Acc: 0.359
Validation loss decreased (-0.297693 --> -0.358763).  Saving model ...
Epoch: 5 cost time: 0.9287490844726562
Epoch: 5, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.552 Vali Acc: 0.405 Test Loss: 1.552 Test Acc: 0.405
Validation loss decreased (-0.358763 --> -0.404565).  Saving model ...
Epoch: 6 cost time: 0.9756245613098145
Epoch: 6, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.404565 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 0.9510905742645264
Epoch: 7, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.518 Vali Acc: 0.412 Test Loss: 1.518 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.897702693939209
Epoch: 8, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.503 Vali Acc: 0.450 Test Loss: 1.503 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 0.8763594627380371
Epoch: 9, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.494 Vali Acc: 0.473 Test Loss: 1.494 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473267).  Saving model ...
Epoch: 10 cost time: 0.9211833477020264
Epoch: 10, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.480 Vali Acc: 0.443 Test Loss: 1.480 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9258337020874023
Epoch: 11, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.478 Vali Acc: 0.458 Test Loss: 1.478 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9246711730957031
Epoch: 12, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.488 Vali Acc: 0.473 Test Loss: 1.488 Test Acc: 0.473
Validation loss decreased (-0.473267 --> -0.473268).  Saving model ...
Epoch: 13 cost time: 0.8891122341156006
Epoch: 13, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.491 Vali Acc: 0.466 Test Loss: 1.491 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9858269691467285
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.499 Vali Acc: 0.466 Test Loss: 1.499 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8730385303497314
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.510 Vali Acc: 0.473 Test Loss: 1.510 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9354257583618164
Epoch: 16, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.496 Vali Acc: 0.466 Test Loss: 1.496 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9784755706787109
Epoch: 17, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 18 cost time: 0.9362552165985107
Epoch: 18, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.515 Vali Acc: 0.481 Test Loss: 1.515 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9548811912536621
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.531 Vali Acc: 0.458 Test Loss: 1.531 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9201602935791016
Epoch: 20, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.539 Vali Acc: 0.458 Test Loss: 1.539 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9134564399719238
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0078892707824707
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.558 Vali Acc: 0.473 Test Loss: 1.558 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8877012729644775
Epoch: 23, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9238805770874023
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.557 Vali Acc: 0.473 Test Loss: 1.557 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9251852035522461
Epoch: 25, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.560 Vali Acc: 0.473 Test Loss: 1.560 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8739056587219238
Epoch: 26, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.571 Vali Acc: 0.450 Test Loss: 1.571 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9753522872924805
Epoch: 27, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.575 Vali Acc: 0.450 Test Loss: 1.575 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 172645
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.784679412841797
Epoch: 1, Steps: 8 | Train Loss: 1.730 Vali Loss: 1.608 Vali Acc: 0.420 Test Loss: 1.608 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2239406108856201
Epoch: 2, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.648 Vali Acc: 0.420 Test Loss: 1.648 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0946907997131348
Epoch: 3, Steps: 8 | Train Loss: 1.276 Vali Loss: 1.574 Vali Acc: 0.420 Test Loss: 1.574 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.137117624282837
Epoch: 4, Steps: 8 | Train Loss: 0.944 Vali Loss: 1.448 Vali Acc: 0.466 Test Loss: 1.448 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.1602752208709717
Epoch: 5, Steps: 8 | Train Loss: 0.643 Vali Loss: 1.410 Vali Acc: 0.511 Test Loss: 1.410 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.0961201190948486
Epoch: 6, Steps: 8 | Train Loss: 0.365 Vali Loss: 1.429 Vali Acc: 0.473 Test Loss: 1.429 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1810612678527832
Epoch: 7, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.423 Vali Acc: 0.527 Test Loss: 1.423 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.1204915046691895
Epoch: 8, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0859014987945557
Epoch: 9, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.553 Vali Acc: 0.504 Test Loss: 1.553 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1043529510498047
Epoch: 10, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.533 Vali Acc: 0.519 Test Loss: 1.533 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0464951992034912
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.519 Vali Acc: 0.519 Test Loss: 1.519 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1093614101409912
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.570 Vali Acc: 0.527 Test Loss: 1.570 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2225127220153809
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.633 Vali Acc: 0.527 Test Loss: 1.633 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1086430549621582
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.643 Vali Acc: 0.527 Test Loss: 1.643 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9570822715759277
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9759588241577148
Epoch: 16, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.527 Test Loss: 1.675 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0690436363220215
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.527 Test Loss: 1.682 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 103013
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.522029399871826
Epoch: 1, Steps: 8 | Train Loss: 1.590 Vali Loss: 1.599 Vali Acc: 0.412 Test Loss: 1.599 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 0.8516461849212646
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.632 Vali Acc: 0.427 Test Loss: 1.632 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 0.9648008346557617
Epoch: 3, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.617 Vali Acc: 0.412 Test Loss: 1.617 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0330085754394531
Epoch: 4, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.568 Vali Acc: 0.458 Test Loss: 1.568 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 0.9491121768951416
Epoch: 5, Steps: 8 | Train Loss: 0.790 Vali Loss: 1.539 Vali Acc: 0.489 Test Loss: 1.539 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 0.9036200046539307
Epoch: 6, Steps: 8 | Train Loss: 0.620 Vali Loss: 1.539 Vali Acc: 0.466 Test Loss: 1.539 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8104939460754395
Epoch: 7, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.495 Vali Acc: 0.519 Test Loss: 1.495 Test Acc: 0.519
Validation loss decreased (-0.488534 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.0013298988342285
Epoch: 8, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.473 Vali Acc: 0.519 Test Loss: 1.473 Test Acc: 0.519
Validation loss decreased (-0.519069 --> -0.519069).  Saving model ...
Epoch: 9 cost time: 0.9166829586029053
Epoch: 9, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.487 Vali Acc: 0.511 Test Loss: 1.487 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9772944450378418
Epoch: 10, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.480 Vali Acc: 0.519 Test Loss: 1.480 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8837366104125977
Epoch: 11, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.526 Vali Acc: 0.534 Test Loss: 1.526 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534336).  Saving model ...
Epoch: 12 cost time: 0.9042534828186035
Epoch: 12, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.017202615737915
Epoch: 13, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.553 Vali Acc: 0.519 Test Loss: 1.553 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9676733016967773
Epoch: 14, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.560 Vali Acc: 0.519 Test Loss: 1.560 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9698324203491211
Epoch: 15, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9192831516265869
Epoch: 16, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.598 Vali Acc: 0.527 Test Loss: 1.598 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9503488540649414
Epoch: 17, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9745171070098877
Epoch: 18, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.617 Vali Acc: 0.519 Test Loss: 1.617 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.958308219909668
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.611 Vali Acc: 0.519 Test Loss: 1.611 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0037164688110352
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.592 Vali Acc: 0.527 Test Loss: 1.592 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9136555194854736
Epoch: 21, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.607 Vali Acc: 0.527 Test Loss: 1.607 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 79013
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.497332811355591
Epoch: 1, Steps: 8 | Train Loss: 1.618 Vali Loss: 1.648 Vali Acc: 0.374 Test Loss: 1.648 Test Acc: 0.374
Validation loss decreased (inf --> -0.374029).  Saving model ...
Epoch: 2 cost time: 0.9409525394439697
Epoch: 2, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.616 Vali Acc: 0.389 Test Loss: 1.616 Test Acc: 0.389
Validation loss decreased (-0.374029 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 0.9636015892028809
Epoch: 3, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.609 Vali Acc: 0.420 Test Loss: 1.609 Test Acc: 0.420
Validation loss decreased (-0.389297 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 0.9105908870697021
Epoch: 4, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.570 Vali Acc: 0.412 Test Loss: 1.570 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9363205432891846
Epoch: 5, Steps: 8 | Train Loss: 0.954 Vali Loss: 1.536 Vali Acc: 0.450 Test Loss: 1.536 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 6 cost time: 0.9872794151306152
Epoch: 6, Steps: 8 | Train Loss: 0.750 Vali Loss: 1.525 Vali Acc: 0.458 Test Loss: 1.525 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 0.9744563102722168
Epoch: 7, Steps: 8 | Train Loss: 0.567 Vali Loss: 1.516 Vali Acc: 0.496 Test Loss: 1.516 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 0.9261734485626221
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9327926635742188
Epoch: 9, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.454 Vali Acc: 0.481 Test Loss: 1.454 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8633899688720703
Epoch: 10, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.455 Vali Acc: 0.481 Test Loss: 1.455 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8830351829528809
Epoch: 11, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.483 Vali Acc: 0.504 Test Loss: 1.483 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 12 cost time: 0.932147741317749
Epoch: 12, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.481 Vali Acc: 0.496 Test Loss: 1.481 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8612537384033203
Epoch: 13, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.474 Vali Acc: 0.481 Test Loss: 1.474 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9178886413574219
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.508 Vali Acc: 0.481 Test Loss: 1.508 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8777282238006592
Epoch: 15, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.536 Vali Acc: 0.481 Test Loss: 1.536 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8940961360931396
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.539 Vali Acc: 0.481 Test Loss: 1.539 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.029545545578003
Epoch: 17, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.538 Vali Acc: 0.481 Test Loss: 1.538 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8661751747131348
Epoch: 18, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.550 Vali Acc: 0.489 Test Loss: 1.550 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9817180633544922
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.554 Vali Acc: 0.481 Test Loss: 1.554 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8751506805419922
Epoch: 20, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.561 Vali Acc: 0.481 Test Loss: 1.561 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0638952255249023
Epoch: 21, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.567 Vali Acc: 0.481 Test Loss: 1.567 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 80901
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.510505199432373
Epoch: 1, Steps: 8 | Train Loss: 1.644 Vali Loss: 1.660 Vali Acc: 0.298 Test Loss: 1.660 Test Acc: 0.298
Validation loss decreased (inf --> -0.297693).  Saving model ...
Epoch: 2 cost time: 0.8762764930725098
Epoch: 2, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.597 Vali Acc: 0.359 Test Loss: 1.597 Test Acc: 0.359
Validation loss decreased (-0.297693 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 0.910792350769043
Epoch: 3, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.572 Vali Acc: 0.366 Test Loss: 1.572 Test Acc: 0.366
Validation loss decreased (-0.358763 --> -0.366396).  Saving model ...
Epoch: 4 cost time: 0.7763779163360596
Epoch: 4, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.566 Vali Acc: 0.412 Test Loss: 1.566 Test Acc: 0.412
Validation loss decreased (-0.366396 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 0.8697950839996338
Epoch: 5, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.537 Vali Acc: 0.458 Test Loss: 1.537 Test Acc: 0.458
Validation loss decreased (-0.412198 --> -0.458000).  Saving model ...
Epoch: 6 cost time: 0.7793455123901367
Epoch: 6, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.499 Vali Acc: 0.458 Test Loss: 1.499 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 7 cost time: 0.9095025062561035
Epoch: 7, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.469 Vali Acc: 0.473 Test Loss: 1.469 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 8 cost time: 0.795551061630249
Epoch: 8, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.467 Vali Acc: 0.489 Test Loss: 1.467 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 0.8936977386474609
Epoch: 9, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.444 Vali Acc: 0.496 Test Loss: 1.444 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 10 cost time: 0.8477048873901367
Epoch: 10, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.914109468460083
Epoch: 11, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.455 Vali Acc: 0.496 Test Loss: 1.455 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8157913684844971
Epoch: 12, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8761107921600342
Epoch: 13, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.489 Vali Acc: 0.496 Test Loss: 1.489 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8359506130218506
Epoch: 14, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.510 Vali Acc: 0.489 Test Loss: 1.510 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8072850704193115
Epoch: 15, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.500 Vali Acc: 0.511 Test Loss: 1.500 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511435).  Saving model ...
Epoch: 16 cost time: 0.8747818470001221
Epoch: 16, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.011500358581543
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.524 Vali Acc: 0.504 Test Loss: 1.524 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9568452835083008
Epoch: 18, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.541 Vali Acc: 0.511 Test Loss: 1.541 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.920299768447876
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.550 Vali Acc: 0.504 Test Loss: 1.550 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9049015045166016
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.568 Vali Acc: 0.504 Test Loss: 1.568 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8731322288513184
Epoch: 21, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.578 Vali Acc: 0.511 Test Loss: 1.578 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8017776012420654
Epoch: 22, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.586 Vali Acc: 0.504 Test Loss: 1.586 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8560051918029785
Epoch: 23, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.585 Vali Acc: 0.504 Test Loss: 1.585 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8474185466766357
Epoch: 24, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.586 Vali Acc: 0.504 Test Loss: 1.586 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8800294399261475
Epoch: 25, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.594 Vali Acc: 0.504 Test Loss: 1.594 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 88581
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5141332149505615
Epoch: 1, Steps: 8 | Train Loss: 1.758 Vali Loss: 1.842 Vali Acc: 0.145 Test Loss: 1.842 Test Acc: 0.145
Validation loss decreased (inf --> -0.145020).  Saving model ...
Epoch: 2 cost time: 0.951138973236084
Epoch: 2, Steps: 8 | Train Loss: 1.614 Vali Loss: 1.740 Vali Acc: 0.198 Test Loss: 1.740 Test Acc: 0.198
Validation loss decreased (-0.145020 --> -0.198456).  Saving model ...
Epoch: 3 cost time: 0.9702768325805664
Epoch: 3, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.640 Vali Acc: 0.290 Test Loss: 1.640 Test Acc: 0.290
Validation loss decreased (-0.198456 --> -0.290060).  Saving model ...
Epoch: 4 cost time: 0.9168360233306885
Epoch: 4, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.570 Vali Acc: 0.389 Test Loss: 1.570 Test Acc: 0.389
Validation loss decreased (-0.290060 --> -0.389297).  Saving model ...
Epoch: 5 cost time: 0.8872020244598389
Epoch: 5, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.540 Vali Acc: 0.427 Test Loss: 1.540 Test Acc: 0.427
Validation loss decreased (-0.389297 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 0.9427592754364014
Epoch: 6, Steps: 8 | Train Loss: 0.683 Vali Loss: 1.505 Vali Acc: 0.443 Test Loss: 1.505 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 0.9350173473358154
Epoch: 7, Steps: 8 | Train Loss: 0.541 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 0.9146163463592529
Epoch: 8, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.468 Vali Acc: 0.450 Test Loss: 1.468 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 0.8970882892608643
Epoch: 9, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8130302429199219
Epoch: 10, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.466 Vali Acc: 0.481 Test Loss: 1.466 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 11 cost time: 0.8737313747406006
Epoch: 11, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.446 Vali Acc: 0.481 Test Loss: 1.446 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 0.7900710105895996
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.450 Vali Acc: 0.489 Test Loss: 1.450 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 13 cost time: 0.7984082698822021
Epoch: 13, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.827263355255127
Epoch: 14, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.473 Vali Acc: 0.481 Test Loss: 1.473 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.840768575668335
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.864600658416748
Epoch: 16, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7648587226867676
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.519 Vali Acc: 0.496 Test Loss: 1.519 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 18 cost time: 0.8877522945404053
Epoch: 18, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.545 Vali Acc: 0.496 Test Loss: 1.545 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8463153839111328
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.554 Vali Acc: 0.496 Test Loss: 1.554 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8906068801879883
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.566 Vali Acc: 0.496 Test Loss: 1.566 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9103286266326904
Epoch: 21, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.559 Vali Acc: 0.504 Test Loss: 1.559 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 22 cost time: 1.0161902904510498
Epoch: 22, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.546 Vali Acc: 0.504 Test Loss: 1.546 Test Acc: 0.504
Validation loss decreased (-0.503801 --> -0.503801).  Saving model ...
Epoch: 23 cost time: 0.8791592121124268
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.570 Vali Acc: 0.504 Test Loss: 1.570 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9370660781860352
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.587 Vali Acc: 0.496 Test Loss: 1.587 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8930559158325195
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.597 Vali Acc: 0.519 Test Loss: 1.597 Test Acc: 0.519
Validation loss decreased (-0.503801 --> -0.519068).  Saving model ...
Epoch: 26 cost time: 1.165930986404419
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.590 Vali Acc: 0.511 Test Loss: 1.590 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8670039176940918
Epoch: 27, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8649749755859375
Epoch: 28, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.613 Vali Acc: 0.511 Test Loss: 1.613 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8286643028259277
Epoch: 29, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.606 Vali Acc: 0.511 Test Loss: 1.606 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9176840782165527
Epoch: 30, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.622 Vali Acc: 0.511 Test Loss: 1.622 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8643271923065186
Epoch: 31, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.634 Vali Acc: 0.511 Test Loss: 1.634 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9095344543457031
Epoch: 32, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.631 Vali Acc: 0.511 Test Loss: 1.631 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8261196613311768
Epoch: 33, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.640 Vali Acc: 0.511 Test Loss: 1.640 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.959444522857666
Epoch: 34, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.651 Vali Acc: 0.511 Test Loss: 1.651 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8715312480926514
Epoch: 35, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.655 Vali Acc: 0.511 Test Loss: 1.655 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 111589
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6698873043060303
Epoch: 1, Steps: 8 | Train Loss: 1.797 Vali Loss: 1.834 Vali Acc: 0.183 Test Loss: 1.834 Test Acc: 0.183
Validation loss decreased (inf --> -0.183188).  Saving model ...
Epoch: 2 cost time: 0.9676222801208496
Epoch: 2, Steps: 8 | Train Loss: 1.663 Vali Loss: 1.728 Vali Acc: 0.198 Test Loss: 1.728 Test Acc: 0.198
Validation loss decreased (-0.183188 --> -0.198456).  Saving model ...
Epoch: 3 cost time: 0.9946577548980713
Epoch: 3, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.654 Vali Acc: 0.252 Test Loss: 1.654 Test Acc: 0.252
Validation loss decreased (-0.198456 --> -0.251892).  Saving model ...
Epoch: 4 cost time: 0.9965686798095703
Epoch: 4, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.590 Vali Acc: 0.336 Test Loss: 1.590 Test Acc: 0.336
Validation loss decreased (-0.251892 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 0.8990283012390137
Epoch: 5, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.557 Vali Acc: 0.366 Test Loss: 1.557 Test Acc: 0.366
Validation loss decreased (-0.335862 --> -0.366397).  Saving model ...
Epoch: 6 cost time: 0.9802584648132324
Epoch: 6, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.542 Vali Acc: 0.405 Test Loss: 1.542 Test Acc: 0.405
Validation loss decreased (-0.366397 --> -0.404565).  Saving model ...
Epoch: 7 cost time: 0.8398668766021729
Epoch: 7, Steps: 8 | Train Loss: 0.483 Vali Loss: 1.540 Vali Acc: 0.389 Test Loss: 1.540 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8351442813873291
Epoch: 8, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.551 Vali Acc: 0.366 Test Loss: 1.551 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9260985851287842
Epoch: 9, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.538 Vali Acc: 0.382 Test Loss: 1.538 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8609445095062256
Epoch: 10, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.543 Vali Acc: 0.389 Test Loss: 1.543 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9894022941589355
Epoch: 11, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.544 Vali Acc: 0.405 Test Loss: 1.544 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9821774959564209
Epoch: 12, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.560 Vali Acc: 0.405 Test Loss: 1.560 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9176652431488037
Epoch: 13, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.579 Vali Acc: 0.427 Test Loss: 1.579 Test Acc: 0.427
Validation loss decreased (-0.404565 --> -0.427465).  Saving model ...
Epoch: 14 cost time: 1.0374386310577393
Epoch: 14, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.588 Vali Acc: 0.443 Test Loss: 1.588 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442732).  Saving model ...
Epoch: 15 cost time: 1.010972023010254
Epoch: 15, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.599 Vali Acc: 0.443 Test Loss: 1.599 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.006197452545166
Epoch: 16, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
Validation loss decreased (-0.442732 --> -0.457999).  Saving model ...
Epoch: 17 cost time: 0.8402554988861084
Epoch: 17, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.606 Vali Acc: 0.466 Test Loss: 1.606 Test Acc: 0.466
Validation loss decreased (-0.457999 --> -0.465633).  Saving model ...
Epoch: 18 cost time: 0.9304449558258057
Epoch: 18, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9566998481750488
Epoch: 19, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.627 Vali Acc: 0.450 Test Loss: 1.627 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.929718017578125
Epoch: 20, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.639 Vali Acc: 0.450 Test Loss: 1.639 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.040661334991455
Epoch: 21, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.644 Vali Acc: 0.443 Test Loss: 1.644 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9067893028259277
Epoch: 22, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.651 Vali Acc: 0.443 Test Loss: 1.651 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.826932430267334
Epoch: 23, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.652 Vali Acc: 0.450 Test Loss: 1.652 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9552538394927979
Epoch: 24, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.660 Vali Acc: 0.450 Test Loss: 1.660 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.864741325378418
Epoch: 25, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.665 Vali Acc: 0.450 Test Loss: 1.665 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9182584285736084
Epoch: 26, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.677 Vali Acc: 0.450 Test Loss: 1.677 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8357367515563965
Epoch: 27, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.681 Vali Acc: 0.450 Test Loss: 1.681 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 136517
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.723747968673706
Epoch: 1, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.603 Vali Acc: 0.321 Test Loss: 1.603 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 0.9306015968322754
Epoch: 2, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.567 Vali Acc: 0.359 Test Loss: 1.567 Test Acc: 0.359
Validation loss decreased (-0.320595 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 0.9234411716461182
Epoch: 3, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.549 Vali Acc: 0.374 Test Loss: 1.549 Test Acc: 0.374
Validation loss decreased (-0.358763 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 0.9309930801391602
Epoch: 4, Steps: 8 | Train Loss: 0.959 Vali Loss: 1.534 Vali Acc: 0.412 Test Loss: 1.534 Test Acc: 0.412
Validation loss decreased (-0.374030 --> -0.412198).  Saving model ...
Epoch: 5 cost time: 0.8928713798522949
Epoch: 5, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.512 Vali Acc: 0.450 Test Loss: 1.512 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 0.890108585357666
Epoch: 6, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.481 Vali Acc: 0.473 Test Loss: 1.481 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 7 cost time: 0.9055049419403076
Epoch: 7, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.475 Vali Acc: 0.481 Test Loss: 1.475 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 0.8244178295135498
Epoch: 8, Steps: 8 | Train Loss: 0.286 Vali Loss: 1.461 Vali Acc: 0.481 Test Loss: 1.461 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 9 cost time: 0.8265955448150635
Epoch: 9, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.440 Vali Acc: 0.489 Test Loss: 1.440 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 0.9920880794525146
Epoch: 10, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9316763877868652
Epoch: 11, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.467 Vali Acc: 0.496 Test Loss: 1.467 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 0.9104142189025879
Epoch: 12, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.477 Vali Acc: 0.489 Test Loss: 1.477 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8988537788391113
Epoch: 13, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0207698345184326
Epoch: 14, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.520 Vali Acc: 0.489 Test Loss: 1.520 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.964836835861206
Epoch: 15, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.518 Vali Acc: 0.481 Test Loss: 1.518 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8623456954956055
Epoch: 16, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.514 Vali Acc: 0.481 Test Loss: 1.514 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8372373580932617
Epoch: 17, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.536 Vali Acc: 0.481 Test Loss: 1.536 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9773709774017334
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.528 Vali Acc: 0.489 Test Loss: 1.528 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9100401401519775
Epoch: 19, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0377438068389893
Epoch: 20, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.536 Vali Acc: 0.496 Test Loss: 1.536 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.026338815689087
Epoch: 21, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.560 Vali Acc: 0.473 Test Loss: 1.560 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 164325
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8466238975524902
Epoch: 1, Steps: 8 | Train Loss: 1.711 Vali Loss: 1.603 Vali Acc: 0.374 Test Loss: 1.603 Test Acc: 0.374
Validation loss decreased (inf --> -0.374030).  Saving model ...
Epoch: 2 cost time: 1.1628444194793701
Epoch: 2, Steps: 8 | Train Loss: 1.452 Vali Loss: 1.580 Vali Acc: 0.382 Test Loss: 1.580 Test Acc: 0.382
Validation loss decreased (-0.374030 --> -0.381664).  Saving model ...
Epoch: 3 cost time: 1.1765155792236328
Epoch: 3, Steps: 8 | Train Loss: 1.188 Vali Loss: 1.505 Vali Acc: 0.405 Test Loss: 1.505 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404565).  Saving model ...
Epoch: 4 cost time: 1.1975791454315186
Epoch: 4, Steps: 8 | Train Loss: 0.907 Vali Loss: 1.523 Vali Acc: 0.443 Test Loss: 1.523 Test Acc: 0.443
Validation loss decreased (-0.404565 --> -0.442733).  Saving model ...
Epoch: 5 cost time: 1.1968417167663574
Epoch: 5, Steps: 8 | Train Loss: 0.618 Vali Loss: 1.451 Vali Acc: 0.496 Test Loss: 1.451 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.171903371810913
Epoch: 6, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.430 Vali Acc: 0.519 Test Loss: 1.430 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.1491880416870117
Epoch: 7, Steps: 8 | Train Loss: 0.210 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.196155071258545
Epoch: 8, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.518 Vali Acc: 0.527 Test Loss: 1.518 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.162968635559082
Epoch: 9, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.571 Vali Acc: 0.527 Test Loss: 1.571 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.259591817855835
Epoch: 10, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.531 Vali Acc: 0.473 Test Loss: 1.531 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1696069240570068
Epoch: 11, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.705 Vali Acc: 0.542 Test Loss: 1.705 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541968).  Saving model ...
Epoch: 12 cost time: 1.1812477111816406
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.752 Vali Acc: 0.542 Test Loss: 1.752 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1675124168395996
Epoch: 13, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.703 Vali Acc: 0.534 Test Loss: 1.703 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1783537864685059
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1317415237426758
Epoch: 15, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.534 Test Loss: 1.702 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.079030990600586
Epoch: 16, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.764 Vali Acc: 0.534 Test Loss: 1.764 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2314221858978271
Epoch: 17, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.772 Vali Acc: 0.534 Test Loss: 1.772 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0865890979766846
Epoch: 18, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.786 Vali Acc: 0.534 Test Loss: 1.786 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.15065336227417
Epoch: 19, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.774 Vali Acc: 0.534 Test Loss: 1.774 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2104079723358154
Epoch: 20, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.777 Vali Acc: 0.534 Test Loss: 1.777 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3141779899597168
Epoch: 21, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.534 Test Loss: 1.785 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 98853
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.661442995071411
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.679 Vali Acc: 0.176 Test Loss: 1.679 Test Acc: 0.176
Validation loss decreased (inf --> -0.175556).  Saving model ...
Epoch: 2 cost time: 1.0241618156433105
Epoch: 2, Steps: 8 | Train Loss: 1.494 Vali Loss: 1.547 Vali Acc: 0.336 Test Loss: 1.547 Test Acc: 0.336
Validation loss decreased (-0.175556 --> -0.335862).  Saving model ...
Epoch: 3 cost time: 0.9971132278442383
Epoch: 3, Steps: 8 | Train Loss: 1.291 Vali Loss: 1.534 Vali Acc: 0.389 Test Loss: 1.534 Test Acc: 0.389
Validation loss decreased (-0.335862 --> -0.389298).  Saving model ...
Epoch: 4 cost time: 0.9486513137817383
Epoch: 4, Steps: 8 | Train Loss: 1.093 Vali Loss: 1.520 Vali Acc: 0.359 Test Loss: 1.520 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9532461166381836
Epoch: 5, Steps: 8 | Train Loss: 0.863 Vali Loss: 1.468 Vali Acc: 0.374 Test Loss: 1.468 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9487924575805664
Epoch: 6, Steps: 8 | Train Loss: 0.659 Vali Loss: 1.434 Vali Acc: 0.450 Test Loss: 1.434 Test Acc: 0.450
Validation loss decreased (-0.389298 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 0.9923317432403564
Epoch: 7, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.424 Vali Acc: 0.458 Test Loss: 1.424 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 0.9753475189208984
Epoch: 8, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.431 Vali Acc: 0.481 Test Loss: 1.431 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 0.9161641597747803
Epoch: 9, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 1.002868413925171
Epoch: 10, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.427 Vali Acc: 0.489 Test Loss: 1.427 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9496359825134277
Epoch: 11, Steps: 8 | Train Loss: 0.083 Vali Loss: 1.457 Vali Acc: 0.511 Test Loss: 1.457 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.064422607421875
Epoch: 12, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0343780517578125
Epoch: 13, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.514 Vali Acc: 0.527 Test Loss: 1.514 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526702).  Saving model ...
Epoch: 14 cost time: 0.8875284194946289
Epoch: 14, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.526 Vali Acc: 0.519 Test Loss: 1.526 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9909501075744629
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0933618545532227
Epoch: 16, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.530 Vali Acc: 0.519 Test Loss: 1.530 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0813121795654297
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.547 Vali Acc: 0.511 Test Loss: 1.547 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0061688423156738
Epoch: 18, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.571 Vali Acc: 0.519 Test Loss: 1.571 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9561243057250977
Epoch: 19, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.575 Vali Acc: 0.527 Test Loss: 1.575 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1088697910308838
Epoch: 20, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0109577178955078
Epoch: 21, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.037031888961792
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9190983772277832
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.622 Vali Acc: 0.527 Test Loss: 1.622 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 74853
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.532790422439575
Epoch: 1, Steps: 8 | Train Loss: 1.671 Vali Loss: 1.704 Vali Acc: 0.244 Test Loss: 1.704 Test Acc: 0.244
Validation loss decreased (inf --> -0.244258).  Saving model ...
Epoch: 2 cost time: 0.8824512958526611
Epoch: 2, Steps: 8 | Train Loss: 1.578 Vali Loss: 1.654 Vali Acc: 0.351 Test Loss: 1.654 Test Acc: 0.351
Validation loss decreased (-0.244258 --> -0.351128).  Saving model ...
Epoch: 3 cost time: 0.8376727104187012
Epoch: 3, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.664 Vali Acc: 0.389 Test Loss: 1.664 Test Acc: 0.389
Validation loss decreased (-0.351128 --> -0.389296).  Saving model ...
Epoch: 4 cost time: 1.008005142211914
Epoch: 4, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.636 Vali Acc: 0.427 Test Loss: 1.636 Test Acc: 0.427
Validation loss decreased (-0.389296 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 0.8800721168518066
Epoch: 5, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.582 Vali Acc: 0.481 Test Loss: 1.582 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480900).  Saving model ...
Epoch: 6 cost time: 0.8760733604431152
Epoch: 6, Steps: 8 | Train Loss: 0.726 Vali Loss: 1.529 Vali Acc: 0.489 Test Loss: 1.529 Test Acc: 0.489
Validation loss decreased (-0.480900 --> -0.488534).  Saving model ...
Epoch: 7 cost time: 0.9522008895874023
Epoch: 7, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.507 Vali Acc: 0.496 Test Loss: 1.507 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 0.8795948028564453
Epoch: 8, Steps: 8 | Train Loss: 0.469 Vali Loss: 1.461 Vali Acc: 0.496 Test Loss: 1.461 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496169).  Saving model ...
Epoch: 9 cost time: 0.8499453067779541
Epoch: 9, Steps: 8 | Train Loss: 0.330 Vali Loss: 1.459 Vali Acc: 0.504 Test Loss: 1.459 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 0.8810329437255859
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9150426387786865
Epoch: 11, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9798722267150879
Epoch: 12, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.466 Vali Acc: 0.489 Test Loss: 1.466 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9374310970306396
Epoch: 13, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.486 Vali Acc: 0.504 Test Loss: 1.486 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8057878017425537
Epoch: 14, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9956731796264648
Epoch: 15, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.500 Vali Acc: 0.511 Test Loss: 1.500 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511435).  Saving model ...
Epoch: 16 cost time: 0.9538836479187012
Epoch: 16, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.526 Vali Acc: 0.511 Test Loss: 1.526 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8737936019897461
Epoch: 17, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8910305500030518
Epoch: 18, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0128388404846191
Epoch: 19, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.540 Vali Acc: 0.511 Test Loss: 1.540 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.821014404296875
Epoch: 20, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.555 Vali Acc: 0.511 Test Loss: 1.555 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9647486209869385
Epoch: 21, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.565 Vali Acc: 0.511 Test Loss: 1.565 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9371776580810547
Epoch: 22, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1216537952423096
Epoch: 23, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.574 Vali Acc: 0.511 Test Loss: 1.574 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9124743938446045
Epoch: 24, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.585 Vali Acc: 0.511 Test Loss: 1.585 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8802027702331543
Epoch: 25, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.600 Vali Acc: 0.511 Test Loss: 1.600 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 76741
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.513922691345215
Epoch: 1, Steps: 8 | Train Loss: 1.810 Vali Loss: 1.696 Vali Acc: 0.145 Test Loss: 1.696 Test Acc: 0.145
Validation loss decreased (inf --> -0.145021).  Saving model ...
Epoch: 2 cost time: 0.8616182804107666
Epoch: 2, Steps: 8 | Train Loss: 1.637 Vali Loss: 1.618 Vali Acc: 0.275 Test Loss: 1.618 Test Acc: 0.275
Validation loss decreased (-0.145021 --> -0.274793).  Saving model ...
Epoch: 3 cost time: 1.030900478363037
Epoch: 3, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.588 Vali Acc: 0.397 Test Loss: 1.588 Test Acc: 0.397
Validation loss decreased (-0.274793 --> -0.396931).  Saving model ...
Epoch: 4 cost time: 1.0452511310577393
Epoch: 4, Steps: 8 | Train Loss: 1.144 Vali Loss: 1.587 Vali Acc: 0.427 Test Loss: 1.587 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427465).  Saving model ...
Epoch: 5 cost time: 0.9672331809997559
Epoch: 5, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.562 Vali Acc: 0.435 Test Loss: 1.562 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 0.9743785858154297
Epoch: 6, Steps: 8 | Train Loss: 0.783 Vali Loss: 1.520 Vali Acc: 0.466 Test Loss: 1.520 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.9239938259124756
Epoch: 7, Steps: 8 | Train Loss: 0.621 Vali Loss: 1.485 Vali Acc: 0.496 Test Loss: 1.485 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 0.9871747493743896
Epoch: 8, Steps: 8 | Train Loss: 0.479 Vali Loss: 1.472 Vali Acc: 0.481 Test Loss: 1.472 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8971648216247559
Epoch: 9, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.473 Vali Acc: 0.504 Test Loss: 1.473 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 10 cost time: 0.8990311622619629
Epoch: 10, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.463 Vali Acc: 0.504 Test Loss: 1.463 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 11 cost time: 0.9128260612487793
Epoch: 11, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.440 Vali Acc: 0.511 Test Loss: 1.440 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 12 cost time: 1.0835559368133545
Epoch: 12, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.461 Vali Acc: 0.489 Test Loss: 1.461 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8954014778137207
Epoch: 13, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.501 Vali Acc: 0.496 Test Loss: 1.501 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9438929557800293
Epoch: 14, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.517 Vali Acc: 0.496 Test Loss: 1.517 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8974018096923828
Epoch: 15, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.516 Vali Acc: 0.496 Test Loss: 1.516 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9939532279968262
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.500 Vali Acc: 0.489 Test Loss: 1.500 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9562573432922363
Epoch: 17, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9065201282501221
Epoch: 18, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.534 Vali Acc: 0.489 Test Loss: 1.534 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8952221870422363
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.013890027999878
Epoch: 20, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.562 Vali Acc: 0.496 Test Loss: 1.562 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9145901203155518
Epoch: 21, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.560 Vali Acc: 0.496 Test Loss: 1.560 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 84421
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7158703804016113
Epoch: 1, Steps: 8 | Train Loss: 1.834 Vali Loss: 1.695 Vali Acc: 0.221 Test Loss: 1.695 Test Acc: 0.221
Validation loss decreased (inf --> -0.221357).  Saving model ...
Epoch: 2 cost time: 0.9888980388641357
Epoch: 2, Steps: 8 | Train Loss: 1.733 Vali Loss: 1.607 Vali Acc: 0.221 Test Loss: 1.607 Test Acc: 0.221
Validation loss decreased (-0.221357 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 0.9177262783050537
Epoch: 3, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.518 Vali Acc: 0.313 Test Loss: 1.518 Test Acc: 0.313
Validation loss decreased (-0.221358 --> -0.312962).  Saving model ...
Epoch: 4 cost time: 1.024923324584961
Epoch: 4, Steps: 8 | Train Loss: 1.107 Vali Loss: 1.459 Vali Acc: 0.382 Test Loss: 1.459 Test Acc: 0.382
Validation loss decreased (-0.312962 --> -0.381665).  Saving model ...
Epoch: 5 cost time: 0.9331698417663574
Epoch: 5, Steps: 8 | Train Loss: 0.947 Vali Loss: 1.445 Vali Acc: 0.420 Test Loss: 1.445 Test Acc: 0.420
Validation loss decreased (-0.381665 --> -0.419833).  Saving model ...
Epoch: 6 cost time: 1.0437850952148438
Epoch: 6, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.436 Vali Acc: 0.412 Test Loss: 1.436 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9794578552246094
Epoch: 7, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.420 Vali Acc: 0.458 Test Loss: 1.420 Test Acc: 0.458
Validation loss decreased (-0.419833 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 1.0119686126708984
Epoch: 8, Steps: 8 | Train Loss: 0.443 Vali Loss: 1.415 Vali Acc: 0.458 Test Loss: 1.415 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 1.0370385646820068
Epoch: 9, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.414 Vali Acc: 0.450 Test Loss: 1.414 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0109024047851562
Epoch: 10, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.412 Vali Acc: 0.481 Test Loss: 1.412 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 11 cost time: 0.9487369060516357
Epoch: 11, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.430 Vali Acc: 0.473 Test Loss: 1.430 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9443359375
Epoch: 12, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.435 Vali Acc: 0.450 Test Loss: 1.435 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8583040237426758
Epoch: 13, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.447 Vali Acc: 0.473 Test Loss: 1.447 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.920799732208252
Epoch: 14, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.456 Vali Acc: 0.466 Test Loss: 1.456 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9977822303771973
Epoch: 15, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.473 Vali Acc: 0.458 Test Loss: 1.473 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9249923229217529
Epoch: 16, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.483 Vali Acc: 0.466 Test Loss: 1.483 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.932283878326416
Epoch: 17, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.486 Vali Acc: 0.481 Test Loss: 1.486 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0434393882751465
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.965437650680542
Epoch: 19, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.511 Vali Acc: 0.481 Test Loss: 1.511 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9012281894683838
Epoch: 20, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 107429
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.44411563873291
Epoch: 1, Steps: 8 | Train Loss: 1.754 Vali Loss: 1.693 Vali Acc: 0.214 Test Loss: 1.693 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 0.9858076572418213
Epoch: 2, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.646 Vali Acc: 0.290 Test Loss: 1.646 Test Acc: 0.290
Validation loss decreased (-0.213724 --> -0.290060).  Saving model ...
Epoch: 3 cost time: 0.8082666397094727
Epoch: 3, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.611 Vali Acc: 0.313 Test Loss: 1.611 Test Acc: 0.313
Validation loss decreased (-0.290060 --> -0.312961).  Saving model ...
Epoch: 4 cost time: 0.8812310695648193
Epoch: 4, Steps: 8 | Train Loss: 1.070 Vali Loss: 1.571 Vali Acc: 0.336 Test Loss: 1.571 Test Acc: 0.336
Validation loss decreased (-0.312961 --> -0.335862).  Saving model ...
Epoch: 5 cost time: 0.8141136169433594
Epoch: 5, Steps: 8 | Train Loss: 0.775 Vali Loss: 1.536 Vali Acc: 0.397 Test Loss: 1.536 Test Acc: 0.397
Validation loss decreased (-0.335862 --> -0.396931).  Saving model ...
Epoch: 6 cost time: 0.9383392333984375
Epoch: 6, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.512 Vali Acc: 0.427 Test Loss: 1.512 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427466).  Saving model ...
Epoch: 7 cost time: 0.924475908279419
Epoch: 7, Steps: 8 | Train Loss: 0.446 Vali Loss: 1.498 Vali Acc: 0.458 Test Loss: 1.498 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 0.8855612277984619
Epoch: 8, Steps: 8 | Train Loss: 0.327 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 9 cost time: 0.8694000244140625
Epoch: 9, Steps: 8 | Train Loss: 0.253 Vali Loss: 1.515 Vali Acc: 0.473 Test Loss: 1.515 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 10 cost time: 0.9431490898132324
Epoch: 10, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.529 Vali Acc: 0.466 Test Loss: 1.529 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8128693103790283
Epoch: 11, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.548 Vali Acc: 0.466 Test Loss: 1.548 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8676486015319824
Epoch: 12, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.570 Vali Acc: 0.458 Test Loss: 1.570 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7420756816864014
Epoch: 13, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.566 Vali Acc: 0.458 Test Loss: 1.566 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.816199779510498
Epoch: 14, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.571 Vali Acc: 0.458 Test Loss: 1.571 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9281375408172607
Epoch: 15, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.560 Vali Acc: 0.450 Test Loss: 1.560 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8493797779083252
Epoch: 16, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.584 Vali Acc: 0.450 Test Loss: 1.584 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8935818672180176
Epoch: 17, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.599 Vali Acc: 0.450 Test Loss: 1.599 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7465851306915283
Epoch: 18, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.609 Vali Acc: 0.443 Test Loss: 1.609 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8732531070709229
Epoch: 19, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.619 Vali Acc: 0.458 Test Loss: 1.619 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 132357
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.493530750274658
Epoch: 1, Steps: 8 | Train Loss: 1.627 Vali Loss: 1.593 Vali Acc: 0.321 Test Loss: 1.593 Test Acc: 0.321
Validation loss decreased (inf --> -0.320595).  Saving model ...
Epoch: 2 cost time: 0.8657290935516357
Epoch: 2, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.592 Vali Acc: 0.313 Test Loss: 1.592 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7990357875823975
Epoch: 3, Steps: 8 | Train Loss: 1.199 Vali Loss: 1.567 Vali Acc: 0.344 Test Loss: 1.567 Test Acc: 0.344
Validation loss decreased (-0.320595 --> -0.343496).  Saving model ...
Epoch: 4 cost time: 0.8865516185760498
Epoch: 4, Steps: 8 | Train Loss: 0.928 Vali Loss: 1.541 Vali Acc: 0.351 Test Loss: 1.541 Test Acc: 0.351
Validation loss decreased (-0.343496 --> -0.351130).  Saving model ...
Epoch: 5 cost time: 0.8854053020477295
Epoch: 5, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.503 Vali Acc: 0.366 Test Loss: 1.503 Test Acc: 0.366
Validation loss decreased (-0.351130 --> -0.366397).  Saving model ...
Epoch: 6 cost time: 0.7005655765533447
Epoch: 6, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.474 Vali Acc: 0.382 Test Loss: 1.474 Test Acc: 0.382
Validation loss decreased (-0.366397 --> -0.381665).  Saving model ...
Epoch: 7 cost time: 0.781883716583252
Epoch: 7, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.457 Vali Acc: 0.397 Test Loss: 1.457 Test Acc: 0.397
Validation loss decreased (-0.381665 --> -0.396932).  Saving model ...
Epoch: 8 cost time: 0.9202826023101807
Epoch: 8, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.458 Vali Acc: 0.405 Test Loss: 1.458 Test Acc: 0.405
Validation loss decreased (-0.396932 --> -0.404566).  Saving model ...
Epoch: 9 cost time: 0.8563511371612549
Epoch: 9, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.459 Vali Acc: 0.397 Test Loss: 1.459 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7859344482421875
Epoch: 10, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.464 Vali Acc: 0.382 Test Loss: 1.464 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9173896312713623
Epoch: 11, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.453 Vali Acc: 0.389 Test Loss: 1.453 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8863730430603027
Epoch: 12, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.480 Vali Acc: 0.443 Test Loss: 1.480 Test Acc: 0.443
Validation loss decreased (-0.404566 --> -0.442733).  Saving model ...
Epoch: 13 cost time: 0.8601319789886475
Epoch: 13, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.490 Vali Acc: 0.435 Test Loss: 1.490 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8446183204650879
Epoch: 14, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.511 Vali Acc: 0.443 Test Loss: 1.511 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8111307621002197
Epoch: 15, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.520 Vali Acc: 0.450 Test Loss: 1.520 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450366).  Saving model ...
Epoch: 16 cost time: 0.8909151554107666
Epoch: 16, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9077568054199219
Epoch: 17, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.527 Vali Acc: 0.435 Test Loss: 1.527 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7731328010559082
Epoch: 18, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.543 Vali Acc: 0.435 Test Loss: 1.543 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7812881469726562
Epoch: 19, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.549 Vali Acc: 0.458 Test Loss: 1.549 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 20 cost time: 0.8070130348205566
Epoch: 20, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.560 Vali Acc: 0.458 Test Loss: 1.560 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8838088512420654
Epoch: 21, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.555 Vali Acc: 0.458 Test Loss: 1.555 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9756395816802979
Epoch: 22, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.560 Vali Acc: 0.466 Test Loss: 1.560 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 23 cost time: 0.8876476287841797
Epoch: 23, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.560 Vali Acc: 0.458 Test Loss: 1.560 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9630284309387207
Epoch: 24, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.568 Vali Acc: 0.458 Test Loss: 1.568 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.800628662109375
Epoch: 25, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.580 Vali Acc: 0.458 Test Loss: 1.580 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8413186073303223
Epoch: 26, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.589 Vali Acc: 0.466 Test Loss: 1.589 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7896175384521484
Epoch: 27, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.597 Vali Acc: 0.466 Test Loss: 1.597 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7986719608306885
Epoch: 28, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.604 Vali Acc: 0.466 Test Loss: 1.604 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9009966850280762
Epoch: 29, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.606 Vali Acc: 0.473 Test Loss: 1.606 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473266).  Saving model ...
Epoch: 30 cost time: 0.7776317596435547
Epoch: 30, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.619 Vali Acc: 0.466 Test Loss: 1.619 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8058938980102539
Epoch: 31, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.622 Vali Acc: 0.473 Test Loss: 1.622 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7936053276062012
Epoch: 32, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.627 Vali Acc: 0.473 Test Loss: 1.627 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8534731864929199
Epoch: 33, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.637 Vali Acc: 0.473 Test Loss: 1.637 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9692378044128418
Epoch: 34, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.644 Vali Acc: 0.473 Test Loss: 1.644 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8559169769287109
Epoch: 35, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.650 Vali Acc: 0.466 Test Loss: 1.650 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8810775279998779
Epoch: 36, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.653 Vali Acc: 0.450 Test Loss: 1.653 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8707907199859619
Epoch: 37, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.667 Vali Acc: 0.450 Test Loss: 1.667 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8620381355285645
Epoch: 38, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.681 Vali Acc: 0.458 Test Loss: 1.681 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9425268173217773
Epoch: 39, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.685 Vali Acc: 0.450 Test Loss: 1.685 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm32_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 160165
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.331308603286743
Epoch: 1, Steps: 8 | Train Loss: 1.785 Vali Loss: 1.642 Vali Acc: 0.252 Test Loss: 1.642 Test Acc: 0.252
Validation loss decreased (inf --> -0.251892).  Saving model ...
Epoch: 2 cost time: 0.7492220401763916
Epoch: 2, Steps: 8 | Train Loss: 1.485 Vali Loss: 1.641 Vali Acc: 0.405 Test Loss: 1.641 Test Acc: 0.405
Validation loss decreased (-0.251892 --> -0.404564).  Saving model ...
Epoch: 3 cost time: 0.7881925106048584
Epoch: 3, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.682 Vali Acc: 0.412 Test Loss: 1.682 Test Acc: 0.412
Validation loss decreased (-0.404564 --> -0.412197).  Saving model ...
Epoch: 4 cost time: 0.8630807399749756
Epoch: 4, Steps: 8 | Train Loss: 1.175 Vali Loss: 1.567 Vali Acc: 0.382 Test Loss: 1.567 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8801732063293457
Epoch: 5, Steps: 8 | Train Loss: 1.043 Vali Loss: 1.529 Vali Acc: 0.427 Test Loss: 1.529 Test Acc: 0.427
Validation loss decreased (-0.412197 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 0.8029048442840576
Epoch: 6, Steps: 8 | Train Loss: 0.846 Vali Loss: 1.512 Vali Acc: 0.473 Test Loss: 1.512 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 0.7952475547790527
Epoch: 7, Steps: 8 | Train Loss: 0.654 Vali Loss: 1.486 Vali Acc: 0.489 Test Loss: 1.486 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 0.8648903369903564
Epoch: 8, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.472 Vali Acc: 0.504 Test Loss: 1.472 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 9 cost time: 0.9173154830932617
Epoch: 9, Steps: 8 | Train Loss: 0.334 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8768467903137207
Epoch: 10, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.474 Vali Acc: 0.489 Test Loss: 1.474 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8872127532958984
Epoch: 11, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.530 Vali Acc: 0.504 Test Loss: 1.530 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8624510765075684
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.494 Vali Acc: 0.504 Test Loss: 1.494 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0656092166900635
Epoch: 13, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.543 Vali Acc: 0.504 Test Loss: 1.543 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8651909828186035
Epoch: 14, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511434).  Saving model ...
Epoch: 15 cost time: 0.95798659324646
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.627 Vali Acc: 0.511 Test Loss: 1.627 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.915696382522583
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.615 Vali Acc: 0.504 Test Loss: 1.615 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8938853740692139
Epoch: 17, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.638 Vali Acc: 0.504 Test Loss: 1.638 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8174855709075928
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.653 Vali Acc: 0.504 Test Loss: 1.653 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8914334774017334
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.665 Vali Acc: 0.504 Test Loss: 1.665 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8201932907104492
Epoch: 20, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.656 Vali Acc: 0.504 Test Loss: 1.656 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0165464878082275
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.667 Vali Acc: 0.504 Test Loss: 1.667 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8503775596618652
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.674 Vali Acc: 0.504 Test Loss: 1.674 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9506371021270752
Epoch: 23, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.705 Vali Acc: 0.504 Test Loss: 1.705 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8681819438934326
Epoch: 24, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.731 Vali Acc: 0.504 Test Loss: 1.731 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 54773
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5625054836273193
Epoch: 1, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.581 Vali Acc: 0.305 Test Loss: 1.581 Test Acc: 0.305
Validation loss decreased (inf --> -0.305328).  Saving model ...
Epoch: 2 cost time: 0.9204938411712646
Epoch: 2, Steps: 8 | Train Loss: 1.493 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (-0.305328 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9064900875091553
Epoch: 3, Steps: 8 | Train Loss: 1.402 Vali Loss: 1.589 Vali Acc: 0.412 Test Loss: 1.589 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8261730670928955
Epoch: 4, Steps: 8 | Train Loss: 1.272 Vali Loss: 1.575 Vali Acc: 0.405 Test Loss: 1.575 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7609825134277344
Epoch: 5, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.542 Vali Acc: 0.412 Test Loss: 1.542 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.801624059677124
Epoch: 6, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.503 Vali Acc: 0.420 Test Loss: 1.503 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 0.8903632164001465
Epoch: 7, Steps: 8 | Train Loss: 0.834 Vali Loss: 1.454 Vali Acc: 0.450 Test Loss: 1.454 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 0.8325808048248291
Epoch: 8, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.440 Vali Acc: 0.481 Test Loss: 1.440 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480902).  Saving model ...
Epoch: 9 cost time: 0.8878452777862549
Epoch: 9, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.404 Vali Acc: 0.473 Test Loss: 1.404 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9010021686553955
Epoch: 10, Steps: 8 | Train Loss: 0.481 Vali Loss: 1.383 Vali Acc: 0.489 Test Loss: 1.383 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 11 cost time: 0.9360647201538086
Epoch: 11, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.384 Vali Acc: 0.481 Test Loss: 1.384 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0453174114227295
Epoch: 12, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.363 Vali Acc: 0.496 Test Loss: 1.363 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 13 cost time: 0.94061279296875
Epoch: 13, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.353 Vali Acc: 0.511 Test Loss: 1.353 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511437).  Saving model ...
Epoch: 14 cost time: 0.8594911098480225
Epoch: 14, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.366 Vali Acc: 0.511 Test Loss: 1.366 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9405086040496826
Epoch: 15, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 0.98134446144104
Epoch: 16, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.387 Vali Acc: 0.511 Test Loss: 1.387 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8955013751983643
Epoch: 17, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.384 Vali Acc: 0.511 Test Loss: 1.384 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8836030960083008
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.381 Vali Acc: 0.511 Test Loss: 1.381 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9520723819732666
Epoch: 19, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9486064910888672
Epoch: 20, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.407 Vali Acc: 0.511 Test Loss: 1.407 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8582046031951904
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.422 Vali Acc: 0.511 Test Loss: 1.422 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9431178569793701
Epoch: 22, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.426 Vali Acc: 0.511 Test Loss: 1.426 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8144128322601318
Epoch: 23, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8322720527648926
Epoch: 24, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8728141784667969
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.438 Vali Acc: 0.511 Test Loss: 1.438 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 42773
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.442338705062866
Epoch: 1, Steps: 8 | Train Loss: 1.728 Vali Loss: 1.789 Vali Acc: 0.153 Test Loss: 1.789 Test Acc: 0.153
Validation loss decreased (inf --> -0.152654).  Saving model ...
Epoch: 2 cost time: 0.8108382225036621
Epoch: 2, Steps: 8 | Train Loss: 1.623 Vali Loss: 1.650 Vali Acc: 0.183 Test Loss: 1.650 Test Acc: 0.183
Validation loss decreased (-0.152654 --> -0.183190).  Saving model ...
Epoch: 3 cost time: 0.8617293834686279
Epoch: 3, Steps: 8 | Train Loss: 1.426 Vali Loss: 1.557 Vali Acc: 0.313 Test Loss: 1.557 Test Acc: 0.313
Validation loss decreased (-0.183190 --> -0.312962).  Saving model ...
Epoch: 4 cost time: 0.9319484233856201
Epoch: 4, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.515 Vali Acc: 0.397 Test Loss: 1.515 Test Acc: 0.397
Validation loss decreased (-0.312962 --> -0.396931).  Saving model ...
Epoch: 5 cost time: 0.8122060298919678
Epoch: 5, Steps: 8 | Train Loss: 1.200 Vali Loss: 1.485 Vali Acc: 0.427 Test Loss: 1.485 Test Acc: 0.427
Validation loss decreased (-0.396931 --> -0.427466).  Saving model ...
Epoch: 6 cost time: 0.8661284446716309
Epoch: 6, Steps: 8 | Train Loss: 1.062 Vali Loss: 1.453 Vali Acc: 0.466 Test Loss: 1.453 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.9155170917510986
Epoch: 7, Steps: 8 | Train Loss: 0.906 Vali Loss: 1.428 Vali Acc: 0.489 Test Loss: 1.428 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 8 cost time: 0.8782262802124023
Epoch: 8, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.413 Vali Acc: 0.481 Test Loss: 1.413 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8874192237854004
Epoch: 9, Steps: 8 | Train Loss: 0.662 Vali Loss: 1.381 Vali Acc: 0.519 Test Loss: 1.381 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 10 cost time: 0.8372316360473633
Epoch: 10, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.829310417175293
Epoch: 11, Steps: 8 | Train Loss: 0.511 Vali Loss: 1.363 Vali Acc: 0.496 Test Loss: 1.363 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8359041213989258
Epoch: 12, Steps: 8 | Train Loss: 0.408 Vali Loss: 1.359 Vali Acc: 0.489 Test Loss: 1.359 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8058304786682129
Epoch: 13, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.351 Vali Acc: 0.511 Test Loss: 1.351 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7087080478668213
Epoch: 14, Steps: 8 | Train Loss: 0.254 Vali Loss: 1.362 Vali Acc: 0.527 Test Loss: 1.362 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 15 cost time: 0.8058245182037354
Epoch: 15, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.355 Vali Acc: 0.534 Test Loss: 1.355 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 16 cost time: 0.740473747253418
Epoch: 16, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549605).  Saving model ...
Epoch: 17 cost time: 0.8247716426849365
Epoch: 17, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.358 Vali Acc: 0.565 Test Loss: 1.358 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564872).  Saving model ...
Epoch: 18 cost time: 0.852240800857544
Epoch: 18, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.369 Vali Acc: 0.557 Test Loss: 1.369 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0303905010223389
Epoch: 19, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.373 Vali Acc: 0.550 Test Loss: 1.373 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9382040500640869
Epoch: 20, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.385 Vali Acc: 0.550 Test Loss: 1.385 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8607127666473389
Epoch: 21, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.394 Vali Acc: 0.542 Test Loss: 1.394 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8204472064971924
Epoch: 22, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.403 Vali Acc: 0.542 Test Loss: 1.403 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.945946455001831
Epoch: 23, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.416 Vali Acc: 0.542 Test Loss: 1.416 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7911550998687744
Epoch: 24, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.429 Vali Acc: 0.534 Test Loss: 1.429 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8380818367004395
Epoch: 25, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8257577419281006
Epoch: 26, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.444 Vali Acc: 0.534 Test Loss: 1.444 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8743345737457275
Epoch: 27, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 43717
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3729963302612305
Epoch: 1, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.737 Vali Acc: 0.206 Test Loss: 1.737 Test Acc: 0.206
Validation loss decreased (inf --> -0.206090).  Saving model ...
Epoch: 2 cost time: 0.8939812183380127
Epoch: 2, Steps: 8 | Train Loss: 1.636 Vali Loss: 1.672 Vali Acc: 0.298 Test Loss: 1.672 Test Acc: 0.298
Validation loss decreased (-0.206090 --> -0.297693).  Saving model ...
Epoch: 3 cost time: 0.8063914775848389
Epoch: 3, Steps: 8 | Train Loss: 1.475 Vali Loss: 1.627 Vali Acc: 0.374 Test Loss: 1.627 Test Acc: 0.374
Validation loss decreased (-0.297693 --> -0.374030).  Saving model ...
Epoch: 4 cost time: 0.8215022087097168
Epoch: 4, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.620 Vali Acc: 0.443 Test Loss: 1.620 Test Acc: 0.443
Validation loss decreased (-0.374030 --> -0.442732).  Saving model ...
Epoch: 5 cost time: 0.8166420459747314
Epoch: 5, Steps: 8 | Train Loss: 1.167 Vali Loss: 1.607 Vali Acc: 0.427 Test Loss: 1.607 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.787494421005249
Epoch: 6, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.596 Vali Acc: 0.450 Test Loss: 1.596 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450366).  Saving model ...
Epoch: 7 cost time: 0.8196163177490234
Epoch: 7, Steps: 8 | Train Loss: 0.916 Vali Loss: 1.569 Vali Acc: 0.458 Test Loss: 1.569 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458000).  Saving model ...
Epoch: 8 cost time: 0.8212184906005859
Epoch: 8, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.557 Vali Acc: 0.450 Test Loss: 1.557 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8062934875488281
Epoch: 9, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.548 Vali Acc: 0.443 Test Loss: 1.548 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8647089004516602
Epoch: 10, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.538 Vali Acc: 0.450 Test Loss: 1.538 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8118729591369629
Epoch: 11, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.523 Vali Acc: 0.489 Test Loss: 1.523 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 12 cost time: 0.7568466663360596
Epoch: 12, Steps: 8 | Train Loss: 0.438 Vali Loss: 1.519 Vali Acc: 0.481 Test Loss: 1.519 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8532454967498779
Epoch: 13, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.514 Vali Acc: 0.458 Test Loss: 1.514 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7842576503753662
Epoch: 14, Steps: 8 | Train Loss: 0.317 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9425454139709473
Epoch: 15, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.496 Vali Acc: 0.443 Test Loss: 1.496 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7821478843688965
Epoch: 16, Steps: 8 | Train Loss: 0.213 Vali Loss: 1.499 Vali Acc: 0.435 Test Loss: 1.499 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7806475162506104
Epoch: 17, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.515 Vali Acc: 0.466 Test Loss: 1.515 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8603010177612305
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.525 Vali Acc: 0.466 Test Loss: 1.525 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9708130359649658
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.522 Vali Acc: 0.466 Test Loss: 1.522 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8844006061553955
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.533 Vali Acc: 0.466 Test Loss: 1.533 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8625838756561279
Epoch: 21, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.548 Vali Acc: 0.473 Test Loss: 1.548 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 47557
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.487706422805786
Epoch: 1, Steps: 8 | Train Loss: 1.792 Vali Loss: 1.713 Vali Acc: 0.214 Test Loss: 1.713 Test Acc: 0.214
Validation loss decreased (inf --> -0.213723).  Saving model ...
Epoch: 2 cost time: 0.8901352882385254
Epoch: 2, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.659 Vali Acc: 0.221 Test Loss: 1.659 Test Acc: 0.221
Validation loss decreased (-0.213723 --> -0.221357).  Saving model ...
Epoch: 3 cost time: 0.877892255783081
Epoch: 3, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.610 Vali Acc: 0.336 Test Loss: 1.610 Test Acc: 0.336
Validation loss decreased (-0.221357 --> -0.335862).  Saving model ...
Epoch: 4 cost time: 0.9675416946411133
Epoch: 4, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.566 Vali Acc: 0.321 Test Loss: 1.566 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8622124195098877
Epoch: 5, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.537 Vali Acc: 0.382 Test Loss: 1.537 Test Acc: 0.382
Validation loss decreased (-0.335862 --> -0.381664).  Saving model ...
Epoch: 6 cost time: 0.8569083213806152
Epoch: 6, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.526 Vali Acc: 0.435 Test Loss: 1.526 Test Acc: 0.435
Validation loss decreased (-0.381664 --> -0.435099).  Saving model ...
Epoch: 7 cost time: 0.8958151340484619
Epoch: 7, Steps: 8 | Train Loss: 0.809 Vali Loss: 1.515 Vali Acc: 0.466 Test Loss: 1.515 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 0.871314287185669
Epoch: 8, Steps: 8 | Train Loss: 0.734 Vali Loss: 1.502 Vali Acc: 0.458 Test Loss: 1.502 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8828830718994141
Epoch: 9, Steps: 8 | Train Loss: 0.611 Vali Loss: 1.503 Vali Acc: 0.458 Test Loss: 1.503 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9999415874481201
Epoch: 10, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9144282341003418
Epoch: 11, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.495 Vali Acc: 0.458 Test Loss: 1.495 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9420528411865234
Epoch: 12, Steps: 8 | Train Loss: 0.405 Vali Loss: 1.495 Vali Acc: 0.481 Test Loss: 1.495 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 13 cost time: 0.9407050609588623
Epoch: 13, Steps: 8 | Train Loss: 0.345 Vali Loss: 1.499 Vali Acc: 0.473 Test Loss: 1.499 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7997207641601562
Epoch: 14, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.498 Vali Acc: 0.466 Test Loss: 1.498 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9639320373535156
Epoch: 15, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 16 cost time: 0.9729213714599609
Epoch: 16, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.504 Vali Acc: 0.473 Test Loss: 1.504 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9019577503204346
Epoch: 17, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.495 Vali Acc: 0.496 Test Loss: 1.495 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496168).  Saving model ...
Epoch: 18 cost time: 0.8664424419403076
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.489 Vali Acc: 0.496 Test Loss: 1.489 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496168).  Saving model ...
Epoch: 19 cost time: 0.9367091655731201
Epoch: 19, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9097583293914795
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.525 Vali Acc: 0.473 Test Loss: 1.525 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9267125129699707
Epoch: 21, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8566005229949951
Epoch: 22, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.531 Vali Acc: 0.496 Test Loss: 1.531 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9230673313140869
Epoch: 23, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.528 Vali Acc: 0.489 Test Loss: 1.528 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9876735210418701
Epoch: 24, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.546 Vali Acc: 0.473 Test Loss: 1.546 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0011460781097412
Epoch: 25, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.559 Vali Acc: 0.466 Test Loss: 1.559 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9740626811981201
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.567 Vali Acc: 0.473 Test Loss: 1.567 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9699406623840332
Epoch: 27, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.569 Vali Acc: 0.481 Test Loss: 1.569 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9320342540740967
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.574 Vali Acc: 0.481 Test Loss: 1.574 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 59061
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4149556159973145
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.575 Vali Acc: 0.359 Test Loss: 1.575 Test Acc: 0.359
Validation loss decreased (inf --> -0.358763).  Saving model ...
Epoch: 2 cost time: 0.818028450012207
Epoch: 2, Steps: 8 | Train Loss: 1.453 Vali Loss: 1.547 Vali Acc: 0.359 Test Loss: 1.547 Test Acc: 0.359
Validation loss decreased (-0.358763 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 0.9598824977874756
Epoch: 3, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.521 Vali Acc: 0.389 Test Loss: 1.521 Test Acc: 0.389
Validation loss decreased (-0.358763 --> -0.389298).  Saving model ...
Epoch: 4 cost time: 0.9044592380523682
Epoch: 4, Steps: 8 | Train Loss: 1.151 Vali Loss: 1.496 Vali Acc: 0.405 Test Loss: 1.496 Test Acc: 0.405
Validation loss decreased (-0.389298 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 0.8985123634338379
Epoch: 5, Steps: 8 | Train Loss: 1.026 Vali Loss: 1.481 Vali Acc: 0.435 Test Loss: 1.481 Test Acc: 0.435
Validation loss decreased (-0.404565 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 0.8829605579376221
Epoch: 6, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.459 Vali Acc: 0.443 Test Loss: 1.459 Test Acc: 0.443
Validation loss decreased (-0.435100 --> -0.442734).  Saving model ...
Epoch: 7 cost time: 1.050673484802246
Epoch: 7, Steps: 8 | Train Loss: 0.730 Vali Loss: 1.440 Vali Acc: 0.458 Test Loss: 1.440 Test Acc: 0.458
Validation loss decreased (-0.442734 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 0.8950045108795166
Epoch: 8, Steps: 8 | Train Loss: 0.614 Vali Loss: 1.431 Vali Acc: 0.458 Test Loss: 1.431 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 9 cost time: 0.9411544799804688
Epoch: 9, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.427 Vali Acc: 0.458 Test Loss: 1.427 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 0.9832050800323486
Epoch: 10, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.424 Vali Acc: 0.458 Test Loss: 1.424 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 11 cost time: 1.0053081512451172
Epoch: 11, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.438 Vali Acc: 0.466 Test Loss: 1.438 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 12 cost time: 0.9671454429626465
Epoch: 12, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.443 Vali Acc: 0.458 Test Loss: 1.443 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8943688869476318
Epoch: 13, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.450 Vali Acc: 0.489 Test Loss: 1.450 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 14 cost time: 1.0043399333953857
Epoch: 14, Steps: 8 | Train Loss: 0.230 Vali Loss: 1.467 Vali Acc: 0.473 Test Loss: 1.467 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9202601909637451
Epoch: 15, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.445 Vali Acc: 0.473 Test Loss: 1.445 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9008066654205322
Epoch: 16, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9009881019592285
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.457 Vali Acc: 0.473 Test Loss: 1.457 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8643217086791992
Epoch: 18, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.438 Vali Acc: 0.481 Test Loss: 1.438 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0376510620117188
Epoch: 19, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.451 Vali Acc: 0.466 Test Loss: 1.451 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9295670986175537
Epoch: 20, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8664686679840088
Epoch: 21, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.477 Vali Acc: 0.466 Test Loss: 1.477 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.862217903137207
Epoch: 22, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.477 Vali Acc: 0.458 Test Loss: 1.477 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8222291469573975
Epoch: 23, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.506 Vali Acc: 0.450 Test Loss: 1.506 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 71525
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.298360586166382
Epoch: 1, Steps: 8 | Train Loss: 1.823 Vali Loss: 1.751 Vali Acc: 0.176 Test Loss: 1.751 Test Acc: 0.176
Validation loss decreased (inf --> -0.175555).  Saving model ...
Epoch: 2 cost time: 0.8713855743408203
Epoch: 2, Steps: 8 | Train Loss: 1.672 Vali Loss: 1.704 Vali Acc: 0.237 Test Loss: 1.704 Test Acc: 0.237
Validation loss decreased (-0.175555 --> -0.236624).  Saving model ...
Epoch: 3 cost time: 0.840357780456543
Epoch: 3, Steps: 8 | Train Loss: 1.484 Vali Loss: 1.656 Vali Acc: 0.298 Test Loss: 1.656 Test Acc: 0.298
Validation loss decreased (-0.236624 --> -0.297693).  Saving model ...
Epoch: 4 cost time: 0.935924768447876
Epoch: 4, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.613 Vali Acc: 0.313 Test Loss: 1.613 Test Acc: 0.313
Validation loss decreased (-0.297693 --> -0.312961).  Saving model ...
Epoch: 5 cost time: 0.9609620571136475
Epoch: 5, Steps: 8 | Train Loss: 1.021 Vali Loss: 1.578 Vali Acc: 0.344 Test Loss: 1.578 Test Acc: 0.344
Validation loss decreased (-0.312961 --> -0.343496).  Saving model ...
Epoch: 6 cost time: 0.9531753063201904
Epoch: 6, Steps: 8 | Train Loss: 0.885 Vali Loss: 1.555 Vali Acc: 0.359 Test Loss: 1.555 Test Acc: 0.359
Validation loss decreased (-0.343496 --> -0.358763).  Saving model ...
Epoch: 7 cost time: 0.9356884956359863
Epoch: 7, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.546 Vali Acc: 0.382 Test Loss: 1.546 Test Acc: 0.382
Validation loss decreased (-0.358763 --> -0.381664).  Saving model ...
Epoch: 8 cost time: 0.8181126117706299
Epoch: 8, Steps: 8 | Train Loss: 0.601 Vali Loss: 1.531 Vali Acc: 0.382 Test Loss: 1.531 Test Acc: 0.382
Validation loss decreased (-0.381664 --> -0.381664).  Saving model ...
Epoch: 9 cost time: 0.8093955516815186
Epoch: 9, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.510 Vali Acc: 0.389 Test Loss: 1.510 Test Acc: 0.389
Validation loss decreased (-0.381664 --> -0.389298).  Saving model ...
Epoch: 10 cost time: 0.9124622344970703
Epoch: 10, Steps: 8 | Train Loss: 0.435 Vali Loss: 1.511 Vali Acc: 0.412 Test Loss: 1.511 Test Acc: 0.412
Validation loss decreased (-0.389298 --> -0.412199).  Saving model ...
Epoch: 11 cost time: 0.814399003982544
Epoch: 11, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.501 Vali Acc: 0.427 Test Loss: 1.501 Test Acc: 0.427
Validation loss decreased (-0.412199 --> -0.427466).  Saving model ...
Epoch: 12 cost time: 0.8114457130432129
Epoch: 12, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.506 Vali Acc: 0.427 Test Loss: 1.506 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7713363170623779
Epoch: 13, Steps: 8 | Train Loss: 0.269 Vali Loss: 1.518 Vali Acc: 0.427 Test Loss: 1.518 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8989887237548828
Epoch: 14, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.505 Vali Acc: 0.382 Test Loss: 1.505 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8891892433166504
Epoch: 15, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.508 Vali Acc: 0.374 Test Loss: 1.508 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9993274211883545
Epoch: 16, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.510 Vali Acc: 0.397 Test Loss: 1.510 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9471554756164551
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.504 Vali Acc: 0.389 Test Loss: 1.504 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.828702449798584
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.522 Vali Acc: 0.412 Test Loss: 1.522 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9020419120788574
Epoch: 19, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.539 Vali Acc: 0.405 Test Loss: 1.539 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9491016864776611
Epoch: 20, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.549 Vali Acc: 0.382 Test Loss: 1.549 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.80190110206604
Epoch: 21, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.549 Vali Acc: 0.382 Test Loss: 1.549 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df256_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 85429
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.44744610786438
Epoch: 1, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.670 Vali Acc: 0.214 Test Loss: 1.670 Test Acc: 0.214
Validation loss decreased (inf --> -0.213724).  Saving model ...
Epoch: 2 cost time: 0.8809680938720703
Epoch: 2, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.685 Vali Acc: 0.427 Test Loss: 1.685 Test Acc: 0.427
Validation loss decreased (-0.213724 --> -0.427464).  Saving model ...
Epoch: 3 cost time: 0.7999522686004639
Epoch: 3, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.707 Vali Acc: 0.427 Test Loss: 1.707 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8348491191864014
Epoch: 4, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.682 Vali Acc: 0.412 Test Loss: 1.682 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8794255256652832
Epoch: 5, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.598 Vali Acc: 0.435 Test Loss: 1.598 Test Acc: 0.435
Validation loss decreased (-0.427464 --> -0.435099).  Saving model ...
Epoch: 6 cost time: 0.773465633392334
Epoch: 6, Steps: 8 | Train Loss: 0.766 Vali Loss: 1.589 Vali Acc: 0.466 Test Loss: 1.589 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465633).  Saving model ...
Epoch: 7 cost time: 0.9537405967712402
Epoch: 7, Steps: 8 | Train Loss: 0.617 Vali Loss: 1.573 Vali Acc: 0.481 Test Loss: 1.573 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480900).  Saving model ...
Epoch: 8 cost time: 0.8907809257507324
Epoch: 8, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.551 Vali Acc: 0.504 Test Loss: 1.551 Test Acc: 0.504
Validation loss decreased (-0.480900 --> -0.503801).  Saving model ...
Epoch: 9 cost time: 0.8974318504333496
Epoch: 9, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.599 Vali Acc: 0.489 Test Loss: 1.599 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.831162691116333
Epoch: 10, Steps: 8 | Train Loss: 0.204 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
Validation loss decreased (-0.503801 --> -0.519068).  Saving model ...
Epoch: 11 cost time: 0.8206741809844971
Epoch: 11, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8945200443267822
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.614 Vali Acc: 0.527 Test Loss: 1.614 Test Acc: 0.527
Validation loss decreased (-0.519068 --> -0.526701).  Saving model ...
Epoch: 13 cost time: 0.8717749118804932
Epoch: 13, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.638 Vali Acc: 0.511 Test Loss: 1.638 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8626706600189209
Epoch: 14, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.637 Vali Acc: 0.489 Test Loss: 1.637 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8560223579406738
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.664 Vali Acc: 0.511 Test Loss: 1.664 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9130194187164307
Epoch: 16, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.683 Vali Acc: 0.504 Test Loss: 1.683 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8603088855743408
Epoch: 17, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.700 Vali Acc: 0.519 Test Loss: 1.700 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8285632133483887
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.723 Vali Acc: 0.527 Test Loss: 1.723 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8631546497344971
Epoch: 19, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.732 Vali Acc: 0.527 Test Loss: 1.732 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8361351490020752
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.734 Vali Acc: 0.511 Test Loss: 1.734 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9064981937408447
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.737 Vali Acc: 0.511 Test Loss: 1.737 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9769232273101807
Epoch: 22, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.748 Vali Acc: 0.511 Test Loss: 1.748 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 50549
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.748985528945923
Epoch: 1, Steps: 8 | Train Loss: 1.788 Vali Loss: 1.647 Vali Acc: 0.221 Test Loss: 1.647 Test Acc: 0.221
Validation loss decreased (inf --> -0.221358).  Saving model ...
Epoch: 2 cost time: 0.8960561752319336
Epoch: 2, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.588 Vali Acc: 0.389 Test Loss: 1.588 Test Acc: 0.389
Validation loss decreased (-0.221358 --> -0.389297).  Saving model ...
Epoch: 3 cost time: 0.8662171363830566
Epoch: 3, Steps: 8 | Train Loss: 1.442 Vali Loss: 1.592 Vali Acc: 0.412 Test Loss: 1.592 Test Acc: 0.412
Validation loss decreased (-0.389297 --> -0.412198).  Saving model ...
Epoch: 4 cost time: 1.07405686378479
Epoch: 4, Steps: 8 | Train Loss: 1.262 Vali Loss: 1.604 Vali Acc: 0.412 Test Loss: 1.604 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.918806791305542
Epoch: 5, Steps: 8 | Train Loss: 1.165 Vali Loss: 1.570 Vali Acc: 0.405 Test Loss: 1.570 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8589997291564941
Epoch: 6, Steps: 8 | Train Loss: 0.981 Vali Loss: 1.527 Vali Acc: 0.443 Test Loss: 1.527 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442733).  Saving model ...
Epoch: 7 cost time: 0.9303839206695557
Epoch: 7, Steps: 8 | Train Loss: 0.828 Vali Loss: 1.495 Vali Acc: 0.466 Test Loss: 1.495 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 8 cost time: 1.1449463367462158
Epoch: 8, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 0.9471888542175293
Epoch: 9, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.452 Vali Acc: 0.481 Test Loss: 1.452 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 10 cost time: 0.9868636131286621
Epoch: 10, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.445 Vali Acc: 0.496 Test Loss: 1.445 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 11 cost time: 0.8365044593811035
Epoch: 11, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.438 Vali Acc: 0.496 Test Loss: 1.438 Test Acc: 0.496
Validation loss decreased (-0.496169 --> -0.496169).  Saving model ...
Epoch: 12 cost time: 0.9263584613800049
Epoch: 12, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.446 Vali Acc: 0.519 Test Loss: 1.446 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519070).  Saving model ...
Epoch: 13 cost time: 0.9990463256835938
Epoch: 13, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.435 Vali Acc: 0.527 Test Loss: 1.435 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526703).  Saving model ...
Epoch: 14 cost time: 0.897819995880127
Epoch: 14, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.449 Vali Acc: 0.534 Test Loss: 1.449 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534337).  Saving model ...
Epoch: 15 cost time: 0.9367997646331787
Epoch: 15, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.455 Vali Acc: 0.542 Test Loss: 1.455 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 16 cost time: 1.0393118858337402
Epoch: 16, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.469 Vali Acc: 0.542 Test Loss: 1.469 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9042801856994629
Epoch: 17, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.479 Vali Acc: 0.534 Test Loss: 1.479 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9277188777923584
Epoch: 18, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.507 Vali Acc: 0.519 Test Loss: 1.507 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0391194820404053
Epoch: 19, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.531 Vali Acc: 0.534 Test Loss: 1.531 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0361919403076172
Epoch: 20, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.543 Vali Acc: 0.542 Test Loss: 1.543 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0134220123291016
Epoch: 21, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9513776302337646
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9944143295288086
Epoch: 23, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.552 Vali Acc: 0.527 Test Loss: 1.552 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9884426593780518
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.559 Vali Acc: 0.527 Test Loss: 1.559 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9780774116516113
Epoch: 25, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.563 Vali Acc: 0.527 Test Loss: 1.563 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 38549
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.478689670562744
Epoch: 1, Steps: 8 | Train Loss: 1.725 Vali Loss: 1.651 Vali Acc: 0.153 Test Loss: 1.651 Test Acc: 0.153
Validation loss decreased (inf --> -0.152655).  Saving model ...
Epoch: 2 cost time: 0.8850619792938232
Epoch: 2, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.564 Vali Acc: 0.290 Test Loss: 1.564 Test Acc: 0.290
Validation loss decreased (-0.152655 --> -0.290061).  Saving model ...
Epoch: 3 cost time: 0.8840711116790771
Epoch: 3, Steps: 8 | Train Loss: 1.407 Vali Loss: 1.508 Vali Acc: 0.389 Test Loss: 1.508 Test Acc: 0.389
Validation loss decreased (-0.290061 --> -0.389298).  Saving model ...
Epoch: 4 cost time: 0.9132318496704102
Epoch: 4, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.496 Vali Acc: 0.405 Test Loss: 1.496 Test Acc: 0.405
Validation loss decreased (-0.389298 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 0.9096992015838623
Epoch: 5, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.478 Vali Acc: 0.412 Test Loss: 1.478 Test Acc: 0.412
Validation loss decreased (-0.404565 --> -0.412199).  Saving model ...
Epoch: 6 cost time: 1.0170238018035889
Epoch: 6, Steps: 8 | Train Loss: 1.027 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
Validation loss decreased (-0.412199 --> -0.450367).  Saving model ...
Epoch: 7 cost time: 1.1558818817138672
Epoch: 7, Steps: 8 | Train Loss: 0.908 Vali Loss: 1.435 Vali Acc: 0.458 Test Loss: 1.435 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 8 cost time: 0.9340269565582275
Epoch: 8, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.420 Vali Acc: 0.473 Test Loss: 1.420 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473268).  Saving model ...
Epoch: 9 cost time: 0.9391727447509766
Epoch: 9, Steps: 8 | Train Loss: 0.687 Vali Loss: 1.407 Vali Acc: 0.473 Test Loss: 1.407 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 10 cost time: 0.9030163288116455
Epoch: 10, Steps: 8 | Train Loss: 0.576 Vali Loss: 1.398 Vali Acc: 0.458 Test Loss: 1.398 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8597626686096191
Epoch: 11, Steps: 8 | Train Loss: 0.479 Vali Loss: 1.403 Vali Acc: 0.481 Test Loss: 1.403 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 12 cost time: 0.8113768100738525
Epoch: 12, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.396 Vali Acc: 0.504 Test Loss: 1.396 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 13 cost time: 0.9950497150421143
Epoch: 13, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 0.9432964324951172
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.373 Vali Acc: 0.504 Test Loss: 1.373 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9111087322235107
Epoch: 15, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.370 Vali Acc: 0.504 Test Loss: 1.370 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8731870651245117
Epoch: 16, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.378 Vali Acc: 0.519 Test Loss: 1.378 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 17 cost time: 0.8723509311676025
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.380 Vali Acc: 0.511 Test Loss: 1.380 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8562633991241455
Epoch: 18, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8710362911224365
Epoch: 19, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0155863761901855
Epoch: 20, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.415 Vali Acc: 0.519 Test Loss: 1.415 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9009294509887695
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.425 Vali Acc: 0.511 Test Loss: 1.425 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.934394359588623
Epoch: 22, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.440 Vali Acc: 0.504 Test Loss: 1.440 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8700244426727295
Epoch: 23, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9423267841339111
Epoch: 24, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.461 Vali Acc: 0.511 Test Loss: 1.461 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.979536771774292
Epoch: 25, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.474 Vali Acc: 0.511 Test Loss: 1.474 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8357706069946289
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.477 Vali Acc: 0.511 Test Loss: 1.477 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 39493
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3853306770324707
Epoch: 1, Steps: 8 | Train Loss: 1.720 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (inf --> -0.259526).  Saving model ...
Epoch: 2 cost time: 0.8682408332824707
Epoch: 2, Steps: 8 | Train Loss: 1.599 Vali Loss: 1.614 Vali Acc: 0.267 Test Loss: 1.614 Test Acc: 0.267
Validation loss decreased (-0.259526 --> -0.267159).  Saving model ...
Epoch: 3 cost time: 0.8401963710784912
Epoch: 3, Steps: 8 | Train Loss: 1.490 Vali Loss: 1.580 Vali Acc: 0.366 Test Loss: 1.580 Test Acc: 0.366
Validation loss decreased (-0.267159 --> -0.366396).  Saving model ...
Epoch: 4 cost time: 0.8464195728302002
Epoch: 4, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.569 Vali Acc: 0.382 Test Loss: 1.569 Test Acc: 0.382
Validation loss decreased (-0.366396 --> -0.381664).  Saving model ...
Epoch: 5 cost time: 0.9094860553741455
Epoch: 5, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.564 Vali Acc: 0.412 Test Loss: 1.564 Test Acc: 0.412
Validation loss decreased (-0.381664 --> -0.412198).  Saving model ...
Epoch: 6 cost time: 0.8913822174072266
Epoch: 6, Steps: 8 | Train Loss: 1.040 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (-0.412198 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 0.7818467617034912
Epoch: 7, Steps: 8 | Train Loss: 0.953 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 8 cost time: 0.8059382438659668
Epoch: 8, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.533 Vali Acc: 0.458 Test Loss: 1.533 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 9 cost time: 0.839848518371582
Epoch: 9, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.524 Vali Acc: 0.458 Test Loss: 1.524 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 10 cost time: 0.8633334636688232
Epoch: 10, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8549408912658691
Epoch: 11, Steps: 8 | Train Loss: 0.520 Vali Loss: 1.510 Vali Acc: 0.458 Test Loss: 1.510 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 0.9240143299102783
Epoch: 12, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.502 Vali Acc: 0.496 Test Loss: 1.502 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 13 cost time: 0.8360412120819092
Epoch: 13, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.502 Vali Acc: 0.489 Test Loss: 1.502 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8575515747070312
Epoch: 14, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9480445384979248
Epoch: 15, Steps: 8 | Train Loss: 0.236 Vali Loss: 1.490 Vali Acc: 0.481 Test Loss: 1.490 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9483850002288818
Epoch: 16, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.498 Vali Acc: 0.489 Test Loss: 1.498 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0097951889038086
Epoch: 17, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.486 Vali Acc: 0.473 Test Loss: 1.486 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8051683902740479
Epoch: 18, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.490 Vali Acc: 0.473 Test Loss: 1.490 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9266767501831055
Epoch: 19, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.501 Vali Acc: 0.481 Test Loss: 1.501 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0000901222229004
Epoch: 20, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8862049579620361
Epoch: 21, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8805701732635498
Epoch: 22, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 43333
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4622013568878174
Epoch: 1, Steps: 8 | Train Loss: 1.620 Vali Loss: 1.720 Vali Acc: 0.168 Test Loss: 1.720 Test Acc: 0.168
Validation loss decreased (inf --> -0.167922).  Saving model ...
Epoch: 2 cost time: 0.8045659065246582
Epoch: 2, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.674 Vali Acc: 0.229 Test Loss: 1.674 Test Acc: 0.229
Validation loss decreased (-0.167922 --> -0.228991).  Saving model ...
Epoch: 3 cost time: 0.8124699592590332
Epoch: 3, Steps: 8 | Train Loss: 1.371 Vali Loss: 1.625 Vali Acc: 0.282 Test Loss: 1.625 Test Acc: 0.282
Validation loss decreased (-0.228991 --> -0.282426).  Saving model ...
Epoch: 4 cost time: 0.7513110637664795
Epoch: 4, Steps: 8 | Train Loss: 1.204 Vali Loss: 1.582 Vali Acc: 0.351 Test Loss: 1.582 Test Acc: 0.351
Validation loss decreased (-0.282426 --> -0.351129).  Saving model ...
Epoch: 5 cost time: 0.8402392864227295
Epoch: 5, Steps: 8 | Train Loss: 1.064 Vali Loss: 1.556 Vali Acc: 0.374 Test Loss: 1.556 Test Acc: 0.374
Validation loss decreased (-0.351129 --> -0.374030).  Saving model ...
Epoch: 6 cost time: 0.7353789806365967
Epoch: 6, Steps: 8 | Train Loss: 0.936 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.374030 --> -0.419832).  Saving model ...
Epoch: 7 cost time: 0.8236024379730225
Epoch: 7, Steps: 8 | Train Loss: 0.775 Vali Loss: 1.510 Vali Acc: 0.427 Test Loss: 1.510 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 8 cost time: 0.8131332397460938
Epoch: 8, Steps: 8 | Train Loss: 0.735 Vali Loss: 1.488 Vali Acc: 0.450 Test Loss: 1.488 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 0.7342283725738525
Epoch: 9, Steps: 8 | Train Loss: 0.596 Vali Loss: 1.450 Vali Acc: 0.458 Test Loss: 1.450 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 0.8112266063690186
Epoch: 10, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.438 Vali Acc: 0.466 Test Loss: 1.438 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 11 cost time: 0.8656661510467529
Epoch: 11, Steps: 8 | Train Loss: 0.444 Vali Loss: 1.447 Vali Acc: 0.466 Test Loss: 1.447 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9146637916564941
Epoch: 12, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.445 Vali Acc: 0.450 Test Loss: 1.445 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7932350635528564
Epoch: 13, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.433 Vali Acc: 0.473 Test Loss: 1.433 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 14 cost time: 0.8686778545379639
Epoch: 14, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.420 Vali Acc: 0.466 Test Loss: 1.420 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8013231754302979
Epoch: 15, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.418 Vali Acc: 0.458 Test Loss: 1.418 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8043229579925537
Epoch: 16, Steps: 8 | Train Loss: 0.195 Vali Loss: 1.434 Vali Acc: 0.466 Test Loss: 1.434 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8655815124511719
Epoch: 17, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.440 Vali Acc: 0.458 Test Loss: 1.440 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8050599098205566
Epoch: 18, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.437 Vali Acc: 0.435 Test Loss: 1.437 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8771939277648926
Epoch: 19, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.434 Vali Acc: 0.435 Test Loss: 1.434 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8768975734710693
Epoch: 20, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7625701427459717
Epoch: 21, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.462 Vali Acc: 0.473 Test Loss: 1.462 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8006141185760498
Epoch: 22, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.468 Vali Acc: 0.481 Test Loss: 1.468 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 23 cost time: 0.8425474166870117
Epoch: 23, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.489 Vali Acc: 0.466 Test Loss: 1.489 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8483495712280273
Epoch: 24, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.504 Vali Acc: 0.466 Test Loss: 1.504 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8151147365570068
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.521 Vali Acc: 0.466 Test Loss: 1.521 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8710904121398926
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.512 Vali Acc: 0.466 Test Loss: 1.512 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8556125164031982
Epoch: 27, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.510 Vali Acc: 0.458 Test Loss: 1.510 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8961682319641113
Epoch: 28, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.529 Vali Acc: 0.466 Test Loss: 1.529 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7936160564422607
Epoch: 29, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.533 Vali Acc: 0.458 Test Loss: 1.533 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7580268383026123
Epoch: 30, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.545 Vali Acc: 0.473 Test Loss: 1.545 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8326070308685303
Epoch: 31, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.552 Vali Acc: 0.458 Test Loss: 1.552 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8840715885162354
Epoch: 32, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.561 Vali Acc: 0.458 Test Loss: 1.561 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 54837
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.492889642715454
Epoch: 1, Steps: 8 | Train Loss: 1.766 Vali Loss: 1.711 Vali Acc: 0.160 Test Loss: 1.711 Test Acc: 0.160
Validation loss decreased (inf --> -0.160288).  Saving model ...
Epoch: 2 cost time: 0.8447690010070801
Epoch: 2, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.702 Vali Acc: 0.160 Test Loss: 1.702 Test Acc: 0.160
Validation loss decreased (-0.160288 --> -0.160288).  Saving model ...
Epoch: 3 cost time: 0.851585865020752
Epoch: 3, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.684 Vali Acc: 0.191 Test Loss: 1.684 Test Acc: 0.191
Validation loss decreased (-0.160288 --> -0.190823).  Saving model ...
Epoch: 4 cost time: 0.7836401462554932
Epoch: 4, Steps: 8 | Train Loss: 1.302 Vali Loss: 1.668 Vali Acc: 0.252 Test Loss: 1.668 Test Acc: 0.252
Validation loss decreased (-0.190823 --> -0.251892).  Saving model ...
Epoch: 5 cost time: 0.9208643436431885
Epoch: 5, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.646 Vali Acc: 0.336 Test Loss: 1.646 Test Acc: 0.336
Validation loss decreased (-0.251892 --> -0.335861).  Saving model ...
Epoch: 6 cost time: 0.8318421840667725
Epoch: 6, Steps: 8 | Train Loss: 0.954 Vali Loss: 1.621 Vali Acc: 0.382 Test Loss: 1.621 Test Acc: 0.382
Validation loss decreased (-0.335861 --> -0.381663).  Saving model ...
Epoch: 7 cost time: 0.9223928451538086
Epoch: 7, Steps: 8 | Train Loss: 0.778 Vali Loss: 1.613 Vali Acc: 0.405 Test Loss: 1.613 Test Acc: 0.405
Validation loss decreased (-0.381663 --> -0.404564).  Saving model ...
Epoch: 8 cost time: 0.8008468151092529
Epoch: 8, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.614 Vali Acc: 0.427 Test Loss: 1.614 Test Acc: 0.427
Validation loss decreased (-0.404564 --> -0.427465).  Saving model ...
Epoch: 9 cost time: 0.9606256484985352
Epoch: 9, Steps: 8 | Train Loss: 0.591 Vali Loss: 1.611 Vali Acc: 0.450 Test Loss: 1.611 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450366).  Saving model ...
Epoch: 10 cost time: 0.795757532119751
Epoch: 10, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.606 Vali Acc: 0.458 Test Loss: 1.606 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.457999).  Saving model ...
Epoch: 11 cost time: 0.802325963973999
Epoch: 11, Steps: 8 | Train Loss: 0.420 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8407461643218994
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.613 Vali Acc: 0.450 Test Loss: 1.613 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.939671516418457
Epoch: 13, Steps: 8 | Train Loss: 0.318 Vali Loss: 1.606 Vali Acc: 0.450 Test Loss: 1.606 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8051793575286865
Epoch: 14, Steps: 8 | Train Loss: 0.284 Vali Loss: 1.633 Vali Acc: 0.435 Test Loss: 1.633 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8441967964172363
Epoch: 15, Steps: 8 | Train Loss: 0.232 Vali Loss: 1.654 Vali Acc: 0.427 Test Loss: 1.654 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0275373458862305
Epoch: 16, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.667 Vali Acc: 0.427 Test Loss: 1.667 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8094825744628906
Epoch: 17, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.655 Vali Acc: 0.443 Test Loss: 1.655 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9195654392242432
Epoch: 18, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.658 Vali Acc: 0.420 Test Loss: 1.658 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8928132057189941
Epoch: 19, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.671 Vali Acc: 0.427 Test Loss: 1.671 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8297405242919922
Epoch: 20, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.681 Vali Acc: 0.412 Test Loss: 1.681 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 67301
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5908451080322266
Epoch: 1, Steps: 8 | Train Loss: 1.673 Vali Loss: 1.638 Vali Acc: 0.275 Test Loss: 1.638 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 0.8779525756835938
Epoch: 2, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.638 Vali Acc: 0.313 Test Loss: 1.638 Test Acc: 0.313
Validation loss decreased (-0.274793 --> -0.312961).  Saving model ...
Epoch: 3 cost time: 0.8123507499694824
Epoch: 3, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.622 Vali Acc: 0.305 Test Loss: 1.622 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7648341655731201
Epoch: 4, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.588 Vali Acc: 0.344 Test Loss: 1.588 Test Acc: 0.344
Validation loss decreased (-0.312961 --> -0.343496).  Saving model ...
Epoch: 5 cost time: 0.7070662975311279
Epoch: 5, Steps: 8 | Train Loss: 0.973 Vali Loss: 1.570 Vali Acc: 0.374 Test Loss: 1.570 Test Acc: 0.374
Validation loss decreased (-0.343496 --> -0.374030).  Saving model ...
Epoch: 6 cost time: 0.8047225475311279
Epoch: 6, Steps: 8 | Train Loss: 0.807 Vali Loss: 1.546 Vali Acc: 0.382 Test Loss: 1.546 Test Acc: 0.382
Validation loss decreased (-0.374030 --> -0.381664).  Saving model ...
Epoch: 7 cost time: 0.7766754627227783
Epoch: 7, Steps: 8 | Train Loss: 0.694 Vali Loss: 1.536 Vali Acc: 0.405 Test Loss: 1.536 Test Acc: 0.405
Validation loss decreased (-0.381664 --> -0.404565).  Saving model ...
Epoch: 8 cost time: 0.7505135536193848
Epoch: 8, Steps: 8 | Train Loss: 0.568 Vali Loss: 1.547 Vali Acc: 0.412 Test Loss: 1.547 Test Acc: 0.412
Validation loss decreased (-0.404565 --> -0.412198).  Saving model ...
Epoch: 9 cost time: 0.8587386608123779
Epoch: 9, Steps: 8 | Train Loss: 0.511 Vali Loss: 1.562 Vali Acc: 0.427 Test Loss: 1.562 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 10 cost time: 0.7531588077545166
Epoch: 10, Steps: 8 | Train Loss: 0.434 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450366).  Saving model ...
Epoch: 11 cost time: 0.8576865196228027
Epoch: 11, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.543 Vali Acc: 0.443 Test Loss: 1.543 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9075045585632324
Epoch: 12, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.567 Vali Acc: 0.435 Test Loss: 1.567 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.92905592918396
Epoch: 13, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.551 Vali Acc: 0.435 Test Loss: 1.551 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8042788505554199
Epoch: 14, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.564 Vali Acc: 0.427 Test Loss: 1.564 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8045229911804199
Epoch: 15, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.605 Vali Acc: 0.435 Test Loss: 1.605 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8930833339691162
Epoch: 16, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.619 Vali Acc: 0.435 Test Loss: 1.619 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9195477962493896
Epoch: 17, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.594 Vali Acc: 0.450 Test Loss: 1.594 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7264163494110107
Epoch: 18, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.615 Vali Acc: 0.435 Test Loss: 1.615 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8124570846557617
Epoch: 19, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.611 Vali Acc: 0.435 Test Loss: 1.611 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.821425199508667
Epoch: 20, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.647 Vali Acc: 0.427 Test Loss: 1.647 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df128_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 81205
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3180224895477295
Epoch: 1, Steps: 8 | Train Loss: 1.663 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.8281707763671875
Epoch: 2, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.643 Vali Acc: 0.405 Test Loss: 1.643 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8419690132141113
Epoch: 3, Steps: 8 | Train Loss: 1.385 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 0.7665383815765381
Epoch: 4, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.531 Vali Acc: 0.450 Test Loss: 1.531 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 5 cost time: 0.7845304012298584
Epoch: 5, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.500 Vali Acc: 0.450 Test Loss: 1.500 Test Acc: 0.450
Validation loss decreased (-0.450366 --> -0.450367).  Saving model ...
Epoch: 6 cost time: 0.812187671661377
Epoch: 6, Steps: 8 | Train Loss: 0.794 Vali Loss: 1.468 Vali Acc: 0.466 Test Loss: 1.468 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.8618428707122803
Epoch: 7, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.442 Vali Acc: 0.511 Test Loss: 1.442 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 0.8986787796020508
Epoch: 8, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.507 Vali Acc: 0.496 Test Loss: 1.507 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8487451076507568
Epoch: 9, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.421 Vali Acc: 0.496 Test Loss: 1.421 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9048938751220703
Epoch: 10, Steps: 8 | Train Loss: 0.201 Vali Loss: 1.456 Vali Acc: 0.519 Test Loss: 1.456 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 0.8735806941986084
Epoch: 11, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.474 Vali Acc: 0.511 Test Loss: 1.474 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9649882316589355
Epoch: 12, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.467 Vali Acc: 0.527 Test Loss: 1.467 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 13 cost time: 0.9244651794433594
Epoch: 13, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.534 Vali Acc: 0.519 Test Loss: 1.534 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1402809619903564
Epoch: 14, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.543 Vali Acc: 0.511 Test Loss: 1.543 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8293712139129639
Epoch: 15, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8778111934661865
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7637560367584229
Epoch: 17, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.583 Vali Acc: 0.511 Test Loss: 1.583 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8535287380218506
Epoch: 18, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.592 Vali Acc: 0.504 Test Loss: 1.592 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8281755447387695
Epoch: 19, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.625 Vali Acc: 0.511 Test Loss: 1.625 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8918662071228027
Epoch: 20, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.844933032989502
Epoch: 21, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.632 Vali Acc: 0.511 Test Loss: 1.632 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8706274032592773
Epoch: 22, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.632 Vali Acc: 0.511 Test Loss: 1.632 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 48437
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4621405601501465
Epoch: 1, Steps: 8 | Train Loss: 1.761 Vali Loss: 1.621 Vali Acc: 0.290 Test Loss: 1.621 Test Acc: 0.290
Validation loss decreased (inf --> -0.290060).  Saving model ...
Epoch: 2 cost time: 0.9652602672576904
Epoch: 2, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.593 Vali Acc: 0.374 Test Loss: 1.593 Test Acc: 0.374
Validation loss decreased (-0.290060 --> -0.374030).  Saving model ...
Epoch: 3 cost time: 0.8668413162231445
Epoch: 3, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.590 Vali Acc: 0.435 Test Loss: 1.590 Test Acc: 0.435
Validation loss decreased (-0.374030 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 0.8758339881896973
Epoch: 4, Steps: 8 | Train Loss: 1.321 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8419797420501709
Epoch: 5, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.550 Vali Acc: 0.443 Test Loss: 1.550 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 6 cost time: 0.8964142799377441
Epoch: 6, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8343851566314697
Epoch: 7, Steps: 8 | Train Loss: 0.882 Vali Loss: 1.503 Vali Acc: 0.443 Test Loss: 1.503 Test Acc: 0.443
Validation loss decreased (-0.442733 --> -0.442733).  Saving model ...
Epoch: 8 cost time: 0.9372756481170654
Epoch: 8, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.503 Vali Acc: 0.489 Test Loss: 1.503 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488535).  Saving model ...
Epoch: 9 cost time: 0.9547145366668701
Epoch: 9, Steps: 8 | Train Loss: 0.636 Vali Loss: 1.457 Vali Acc: 0.443 Test Loss: 1.457 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8709836006164551
Epoch: 10, Steps: 8 | Train Loss: 0.505 Vali Loss: 1.445 Vali Acc: 0.466 Test Loss: 1.445 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8900444507598877
Epoch: 11, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.426 Vali Acc: 0.473 Test Loss: 1.426 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8820092678070068
Epoch: 12, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.414 Vali Acc: 0.481 Test Loss: 1.414 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9045624732971191
Epoch: 13, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.419 Vali Acc: 0.481 Test Loss: 1.419 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8481519222259521
Epoch: 14, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 15 cost time: 0.879340410232544
Epoch: 15, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.414 Vali Acc: 0.519 Test Loss: 1.414 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 16 cost time: 0.915968656539917
Epoch: 16, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.425 Vali Acc: 0.511 Test Loss: 1.425 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9172570705413818
Epoch: 17, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.438 Vali Acc: 0.519 Test Loss: 1.438 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9138984680175781
Epoch: 18, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 19 cost time: 0.9808754920959473
Epoch: 19, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.460 Vali Acc: 0.542 Test Loss: 1.460 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 20 cost time: 0.8707830905914307
Epoch: 20, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.470 Vali Acc: 0.542 Test Loss: 1.470 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.917865514755249
Epoch: 21, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.463 Vali Acc: 0.542 Test Loss: 1.463 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9564111232757568
Epoch: 22, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.474 Vali Acc: 0.534 Test Loss: 1.474 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9013259410858154
Epoch: 23, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.473 Vali Acc: 0.534 Test Loss: 1.473 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8281161785125732
Epoch: 24, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.494 Vali Acc: 0.534 Test Loss: 1.494 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9451661109924316
Epoch: 25, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.499 Vali Acc: 0.534 Test Loss: 1.499 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8901164531707764
Epoch: 26, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.499 Vali Acc: 0.527 Test Loss: 1.499 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9253153800964355
Epoch: 27, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.499 Vali Acc: 0.534 Test Loss: 1.499 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8900465965270996
Epoch: 28, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.511 Vali Acc: 0.527 Test Loss: 1.511 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9292442798614502
Epoch: 29, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.527 Vali Acc: 0.534 Test Loss: 1.527 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 36437
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps1349_str675_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4947609901428223
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.640 Vali Acc: 0.336 Test Loss: 1.640 Test Acc: 0.336
Validation loss decreased (inf --> -0.335861).  Saving model ...
Epoch: 2 cost time: 0.9675426483154297
Epoch: 2, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.617 Vali Acc: 0.366 Test Loss: 1.617 Test Acc: 0.366
Validation loss decreased (-0.335861 --> -0.366396).  Saving model ...
Epoch: 3 cost time: 0.976161003112793
Epoch: 3, Steps: 8 | Train Loss: 1.394 Vali Loss: 1.608 Vali Acc: 0.382 Test Loss: 1.608 Test Acc: 0.382
Validation loss decreased (-0.366396 --> -0.381663).  Saving model ...
Epoch: 4 cost time: 0.9130117893218994
Epoch: 4, Steps: 8 | Train Loss: 1.359 Vali Loss: 1.608 Vali Acc: 0.397 Test Loss: 1.608 Test Acc: 0.397
Validation loss decreased (-0.381663 --> -0.396930).  Saving model ...
Epoch: 5 cost time: 0.8937897682189941
Epoch: 5, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.602 Vali Acc: 0.389 Test Loss: 1.602 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9519281387329102
Epoch: 6, Steps: 8 | Train Loss: 1.032 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (-0.396930 --> -0.419831).  Saving model ...
Epoch: 7 cost time: 0.9422447681427002
Epoch: 7, Steps: 8 | Train Loss: 0.917 Vali Loss: 1.570 Vali Acc: 0.397 Test Loss: 1.570 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.827913761138916
Epoch: 8, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.540 Vali Acc: 0.405 Test Loss: 1.540 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9066765308380127
Epoch: 9, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.524 Vali Acc: 0.435 Test Loss: 1.524 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 10 cost time: 0.873105525970459
Epoch: 10, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.503 Vali Acc: 0.450 Test Loss: 1.503 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 11 cost time: 0.9128923416137695
Epoch: 11, Steps: 8 | Train Loss: 0.500 Vali Loss: 1.492 Vali Acc: 0.458 Test Loss: 1.492 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458000).  Saving model ...
Epoch: 12 cost time: 0.8883461952209473
Epoch: 12, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473267).  Saving model ...
Epoch: 13 cost time: 0.8075480461120605
Epoch: 13, Steps: 8 | Train Loss: 0.310 Vali Loss: 1.484 Vali Acc: 0.458 Test Loss: 1.484 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8731634616851807
Epoch: 14, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.480 Vali Acc: 0.466 Test Loss: 1.480 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9857184886932373
Epoch: 15, Steps: 8 | Train Loss: 0.192 Vali Loss: 1.507 Vali Acc: 0.504 Test Loss: 1.507 Test Acc: 0.504
Validation loss decreased (-0.473267 --> -0.503802).  Saving model ...
Epoch: 16 cost time: 0.8317394256591797
Epoch: 16, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.533 Vali Acc: 0.504 Test Loss: 1.533 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9060132503509521
Epoch: 17, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.525 Vali Acc: 0.496 Test Loss: 1.525 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9027421474456787
Epoch: 18, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.525 Vali Acc: 0.496 Test Loss: 1.525 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9282815456390381
Epoch: 19, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.513 Vali Acc: 0.489 Test Loss: 1.513 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9057691097259521
Epoch: 20, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.503 Vali Acc: 0.496 Test Loss: 1.503 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8139829635620117
Epoch: 21, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.502 Vali Acc: 0.504 Test Loss: 1.502 Test Acc: 0.504
Validation loss decreased (-0.503802 --> -0.503802).  Saving model ...
Epoch: 22 cost time: 0.8682990074157715
Epoch: 22, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.513 Vali Acc: 0.504 Test Loss: 1.513 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.839519739151001
Epoch: 23, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7775282859802246
Epoch: 24, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.579 Vali Acc: 0.504 Test Loss: 1.579 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8791589736938477
Epoch: 25, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.574 Vali Acc: 0.504 Test Loss: 1.574 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8872883319854736
Epoch: 26, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.580 Vali Acc: 0.504 Test Loss: 1.580 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.00252366065979
Epoch: 27, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.579 Vali Acc: 0.504 Test Loss: 1.579 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8393216133117676
Epoch: 28, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.602 Vali Acc: 0.504 Test Loss: 1.602 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8533017635345459
Epoch: 29, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.605 Vali Acc: 0.504 Test Loss: 1.605 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8837697505950928
Epoch: 30, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.608 Vali Acc: 0.511 Test Loss: 1.608 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511434).  Saving model ...
Epoch: 31 cost time: 0.9542992115020752
Epoch: 31, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.599 Vali Acc: 0.527 Test Loss: 1.599 Test Acc: 0.527
Validation loss decreased (-0.511434 --> -0.526702).  Saving model ...
Epoch: 32 cost time: 0.9356379508972168
Epoch: 32, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 33 cost time: 0.8855292797088623
Epoch: 33, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.600 Vali Acc: 0.527 Test Loss: 1.600 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.966681718826294
Epoch: 34, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.609 Vali Acc: 0.527 Test Loss: 1.609 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9300198554992676
Epoch: 35, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.612 Vali Acc: 0.527 Test Loss: 1.612 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9637370109558105
Epoch: 36, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.638 Vali Acc: 0.527 Test Loss: 1.638 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8720686435699463
Epoch: 37, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8577268123626709
Epoch: 38, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.645 Vali Acc: 0.527 Test Loss: 1.645 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8113062381744385
Epoch: 39, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8788242340087891
Epoch: 40, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.657 Vali Acc: 0.527 Test Loss: 1.657 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7737491130828857
Epoch: 41, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9298205375671387
Epoch: 42, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.665 Vali Acc: 0.527 Test Loss: 1.665 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps1349_str675_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 37381
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3666906356811523
Epoch: 1, Steps: 8 | Train Loss: 1.765 Vali Loss: 1.655 Vali Acc: 0.198 Test Loss: 1.655 Test Acc: 0.198
Validation loss decreased (inf --> -0.198457).  Saving model ...
Epoch: 2 cost time: 0.9332747459411621
Epoch: 2, Steps: 8 | Train Loss: 1.597 Vali Loss: 1.593 Vali Acc: 0.221 Test Loss: 1.593 Test Acc: 0.221
Validation loss decreased (-0.198457 --> -0.221358).  Saving model ...
Epoch: 3 cost time: 0.8173806667327881
Epoch: 3, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.549 Vali Acc: 0.305 Test Loss: 1.549 Test Acc: 0.305
Validation loss decreased (-0.221358 --> -0.305328).  Saving model ...
Epoch: 4 cost time: 0.8659553527832031
Epoch: 4, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.532 Vali Acc: 0.405 Test Loss: 1.532 Test Acc: 0.405
Validation loss decreased (-0.305328 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 0.833521842956543
Epoch: 5, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.528 Vali Acc: 0.466 Test Loss: 1.528 Test Acc: 0.466
Validation loss decreased (-0.404565 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 0.872556209564209
Epoch: 6, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.525 Vali Acc: 0.466 Test Loss: 1.525 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 7 cost time: 0.8413474559783936
Epoch: 7, Steps: 8 | Train Loss: 0.909 Vali Loss: 1.511 Vali Acc: 0.481 Test Loss: 1.511 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 8 cost time: 0.8911595344543457
Epoch: 8, Steps: 8 | Train Loss: 0.788 Vali Loss: 1.488 Vali Acc: 0.450 Test Loss: 1.488 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7969233989715576
Epoch: 9, Steps: 8 | Train Loss: 0.697 Vali Loss: 1.468 Vali Acc: 0.489 Test Loss: 1.468 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 10 cost time: 0.942267656326294
Epoch: 10, Steps: 8 | Train Loss: 0.622 Vali Loss: 1.478 Vali Acc: 0.489 Test Loss: 1.478 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.827904462814331
Epoch: 11, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.918604850769043
Epoch: 12, Steps: 8 | Train Loss: 0.452 Vali Loss: 1.466 Vali Acc: 0.504 Test Loss: 1.466 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503802).  Saving model ...
Epoch: 13 cost time: 0.9304153919219971
Epoch: 13, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 14 cost time: 0.8466911315917969
Epoch: 14, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.450 Vali Acc: 0.496 Test Loss: 1.450 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9321024417877197
Epoch: 15, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 16 cost time: 0.917701244354248
Epoch: 16, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.460 Vali Acc: 0.527 Test Loss: 1.460 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 17 cost time: 0.8291795253753662
Epoch: 17, Steps: 8 | Train Loss: 0.180 Vali Loss: 1.464 Vali Acc: 0.527 Test Loss: 1.464 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8051304817199707
Epoch: 18, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 19 cost time: 0.8520646095275879
Epoch: 19, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.788923978805542
Epoch: 20, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.477 Vali Acc: 0.527 Test Loss: 1.477 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8475611209869385
Epoch: 21, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.489 Vali Acc: 0.527 Test Loss: 1.489 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9311120510101318
Epoch: 22, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.495 Vali Acc: 0.534 Test Loss: 1.495 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 23 cost time: 0.787844181060791
Epoch: 23, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.494 Vali Acc: 0.527 Test Loss: 1.494 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9218435287475586
Epoch: 24, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.500 Vali Acc: 0.527 Test Loss: 1.500 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8744730949401855
Epoch: 25, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9960989952087402
Epoch: 26, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.512 Vali Acc: 0.542 Test Loss: 1.512 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541970).  Saving model ...
Epoch: 27 cost time: 0.7678835391998291
Epoch: 27, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7854211330413818
Epoch: 28, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.521 Vali Acc: 0.534 Test Loss: 1.521 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8698155879974365
Epoch: 29, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.531 Vali Acc: 0.534 Test Loss: 1.531 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.836369514465332
Epoch: 30, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.523 Vali Acc: 0.534 Test Loss: 1.523 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9083466529846191
Epoch: 31, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.526 Vali Acc: 0.542 Test Loss: 1.526 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8472237586975098
Epoch: 32, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.533 Vali Acc: 0.542 Test Loss: 1.533 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9530019760131836
Epoch: 33, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.551 Vali Acc: 0.527 Test Loss: 1.551 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8484141826629639
Epoch: 34, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.566 Vali Acc: 0.534 Test Loss: 1.566 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9052073955535889
Epoch: 35, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.578 Vali Acc: 0.534 Test Loss: 1.578 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8557207584381104
Epoch: 36, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.584 Vali Acc: 0.534 Test Loss: 1.584 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 41221
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps2698_str1349_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3530805110931396
Epoch: 1, Steps: 8 | Train Loss: 1.698 Vali Loss: 1.614 Vali Acc: 0.275 Test Loss: 1.614 Test Acc: 0.275
Validation loss decreased (inf --> -0.274793).  Saving model ...
Epoch: 2 cost time: 0.9633510112762451
Epoch: 2, Steps: 8 | Train Loss: 1.669 Vali Loss: 1.571 Vali Acc: 0.359 Test Loss: 1.571 Test Acc: 0.359
Validation loss decreased (-0.274793 --> -0.358763).  Saving model ...
Epoch: 3 cost time: 0.9326884746551514
Epoch: 3, Steps: 8 | Train Loss: 1.463 Vali Loss: 1.537 Vali Acc: 0.389 Test Loss: 1.537 Test Acc: 0.389
Validation loss decreased (-0.358763 --> -0.389298).  Saving model ...
Epoch: 4 cost time: 0.9836986064910889
Epoch: 4, Steps: 8 | Train Loss: 1.288 Vali Loss: 1.507 Vali Acc: 0.405 Test Loss: 1.507 Test Acc: 0.405
Validation loss decreased (-0.389298 --> -0.404565).  Saving model ...
Epoch: 5 cost time: 0.9617893695831299
Epoch: 5, Steps: 8 | Train Loss: 1.159 Vali Loss: 1.498 Vali Acc: 0.435 Test Loss: 1.498 Test Acc: 0.435
Validation loss decreased (-0.404565 --> -0.435100).  Saving model ...
Epoch: 6 cost time: 0.9265873432159424
Epoch: 6, Steps: 8 | Train Loss: 0.984 Vali Loss: 1.484 Vali Acc: 0.435 Test Loss: 1.484 Test Acc: 0.435
Validation loss decreased (-0.435100 --> -0.435100).  Saving model ...
Epoch: 7 cost time: 0.9040014743804932
Epoch: 7, Steps: 8 | Train Loss: 0.828 Vali Loss: 1.465 Vali Acc: 0.450 Test Loss: 1.465 Test Acc: 0.450
Validation loss decreased (-0.435100 --> -0.450367).  Saving model ...
Epoch: 8 cost time: 0.9834794998168945
Epoch: 8, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.452 Vali Acc: 0.450 Test Loss: 1.452 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450367).  Saving model ...
Epoch: 9 cost time: 0.8679077625274658
Epoch: 9, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.441 Vali Acc: 0.458 Test Loss: 1.441 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 10 cost time: 0.9216439723968506
Epoch: 10, Steps: 8 | Train Loss: 0.550 Vali Loss: 1.427 Vali Acc: 0.466 Test Loss: 1.427 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465635).  Saving model ...
Epoch: 11 cost time: 1.005934476852417
Epoch: 11, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.423 Vali Acc: 0.466 Test Loss: 1.423 Test Acc: 0.466
Validation loss decreased (-0.465635 --> -0.465635).  Saving model ...
Epoch: 12 cost time: 0.8961060047149658
Epoch: 12, Steps: 8 | Train Loss: 0.412 Vali Loss: 1.419 Vali Acc: 0.481 Test Loss: 1.419 Test Acc: 0.481
Validation loss decreased (-0.465635 --> -0.480902).  Saving model ...
Epoch: 13 cost time: 0.9010715484619141
Epoch: 13, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.412 Vali Acc: 0.458 Test Loss: 1.412 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9972121715545654
Epoch: 14, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9585855007171631
Epoch: 15, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.433 Vali Acc: 0.481 Test Loss: 1.433 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0242578983306885
Epoch: 16, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.444 Vali Acc: 0.466 Test Loss: 1.444 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9213318824768066
Epoch: 17, Steps: 8 | Train Loss: 0.170 Vali Loss: 1.453 Vali Acc: 0.466 Test Loss: 1.453 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9236702919006348
Epoch: 18, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9640343189239502
Epoch: 19, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.456 Vali Acc: 0.450 Test Loss: 1.456 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8823537826538086
Epoch: 20, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.468 Vali Acc: 0.473 Test Loss: 1.468 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9875330924987793
Epoch: 21, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.471 Vali Acc: 0.473 Test Loss: 1.471 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9943552017211914
Epoch: 22, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps2698_str1349_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 52725
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.515350341796875
Epoch: 1, Steps: 8 | Train Loss: 1.682 Vali Loss: 1.732 Vali Acc: 0.176 Test Loss: 1.732 Test Acc: 0.176
Validation loss decreased (inf --> -0.175555).  Saving model ...
Epoch: 2 cost time: 0.8742916584014893
Epoch: 2, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.680 Vali Acc: 0.229 Test Loss: 1.680 Test Acc: 0.229
Validation loss decreased (-0.175555 --> -0.228991).  Saving model ...
Epoch: 3 cost time: 0.9275228977203369
Epoch: 3, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.628 Vali Acc: 0.229 Test Loss: 1.628 Test Acc: 0.229
Validation loss decreased (-0.228991 --> -0.228991).  Saving model ...
Epoch: 4 cost time: 0.8591318130493164
Epoch: 4, Steps: 8 | Train Loss: 1.214 Vali Loss: 1.573 Vali Acc: 0.275 Test Loss: 1.573 Test Acc: 0.275
Validation loss decreased (-0.228991 --> -0.274793).  Saving model ...
Epoch: 5 cost time: 0.9767360687255859
Epoch: 5, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.527 Vali Acc: 0.290 Test Loss: 1.527 Test Acc: 0.290
Validation loss decreased (-0.274793 --> -0.290061).  Saving model ...
Epoch: 6 cost time: 0.8117165565490723
Epoch: 6, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.483 Vali Acc: 0.336 Test Loss: 1.483 Test Acc: 0.336
Validation loss decreased (-0.290061 --> -0.335863).  Saving model ...
Epoch: 7 cost time: 0.923992395401001
Epoch: 7, Steps: 8 | Train Loss: 0.732 Vali Loss: 1.458 Vali Acc: 0.397 Test Loss: 1.458 Test Acc: 0.397
Validation loss decreased (-0.335863 --> -0.396932).  Saving model ...
Epoch: 8 cost time: 0.9093761444091797
Epoch: 8, Steps: 8 | Train Loss: 0.651 Vali Loss: 1.447 Vali Acc: 0.397 Test Loss: 1.447 Test Acc: 0.397
Validation loss decreased (-0.396932 --> -0.396932).  Saving model ...
Epoch: 9 cost time: 0.977957010269165
Epoch: 9, Steps: 8 | Train Loss: 0.572 Vali Loss: 1.436 Vali Acc: 0.405 Test Loss: 1.436 Test Acc: 0.405
Validation loss decreased (-0.396932 --> -0.404566).  Saving model ...
Epoch: 10 cost time: 0.9260637760162354
Epoch: 10, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.418 Vali Acc: 0.420 Test Loss: 1.418 Test Acc: 0.420
Validation loss decreased (-0.404566 --> -0.419833).  Saving model ...
Epoch: 11 cost time: 0.856177568435669
Epoch: 11, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.402 Vali Acc: 0.427 Test Loss: 1.402 Test Acc: 0.427
Validation loss decreased (-0.419833 --> -0.427467).  Saving model ...
Epoch: 12 cost time: 0.977349042892456
Epoch: 12, Steps: 8 | Train Loss: 0.375 Vali Loss: 1.401 Vali Acc: 0.412 Test Loss: 1.401 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9984021186828613
Epoch: 13, Steps: 8 | Train Loss: 0.309 Vali Loss: 1.400 Vali Acc: 0.420 Test Loss: 1.400 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9150736331939697
Epoch: 14, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.401 Vali Acc: 0.458 Test Loss: 1.401 Test Acc: 0.458
Validation loss decreased (-0.427467 --> -0.458001).  Saving model ...
Epoch: 15 cost time: 0.7937905788421631
Epoch: 15, Steps: 8 | Train Loss: 0.212 Vali Loss: 1.390 Vali Acc: 0.450 Test Loss: 1.390 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8765809535980225
Epoch: 16, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.387 Vali Acc: 0.443 Test Loss: 1.387 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.97216796875
Epoch: 17, Steps: 8 | Train Loss: 0.165 Vali Loss: 1.380 Vali Acc: 0.458 Test Loss: 1.380 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 18 cost time: 0.837343692779541
Epoch: 18, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.387 Vali Acc: 0.496 Test Loss: 1.387 Test Acc: 0.496
Validation loss decreased (-0.458001 --> -0.496169).  Saving model ...
Epoch: 19 cost time: 0.817047119140625
Epoch: 19, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.418 Vali Acc: 0.443 Test Loss: 1.418 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8198354244232178
Epoch: 20, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.436 Vali Acc: 0.458 Test Loss: 1.436 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9526164531707764
Epoch: 21, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.435 Vali Acc: 0.443 Test Loss: 1.435 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0312347412109375
Epoch: 22, Steps: 8 | Train Loss: 0.082 Vali Loss: 1.451 Vali Acc: 0.435 Test Loss: 1.451 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9869973659515381
Epoch: 23, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.468 Vali Acc: 0.466 Test Loss: 1.468 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9310727119445801
Epoch: 24, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.464 Vali Acc: 0.466 Test Loss: 1.464 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8981096744537354
Epoch: 25, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.448 Vali Acc: 0.481 Test Loss: 1.448 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9277265071868896
Epoch: 26, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.460 Vali Acc: 0.504 Test Loss: 1.460 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 27 cost time: 0.8317689895629883
Epoch: 27, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.472 Vali Acc: 0.473 Test Loss: 1.472 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9516291618347168
Epoch: 28, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.474 Vali Acc: 0.458 Test Loss: 1.474 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9254610538482666
Epoch: 29, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.483 Vali Acc: 0.443 Test Loss: 1.483 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8085048198699951
Epoch: 30, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.499 Vali Acc: 0.450 Test Loss: 1.499 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8671085834503174
Epoch: 31, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.516 Vali Acc: 0.458 Test Loss: 1.516 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8934171199798584
Epoch: 32, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.526 Vali Acc: 0.450 Test Loss: 1.526 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9389247894287109
Epoch: 33, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.509 Vali Acc: 0.443 Test Loss: 1.509 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8711347579956055
Epoch: 34, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.516 Vali Acc: 0.458 Test Loss: 1.516 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9679522514343262
Epoch: 35, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.539 Vali Acc: 0.450 Test Loss: 1.539 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.024017572402954
Epoch: 36, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.555 Vali Acc: 0.450 Test Loss: 1.555 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 65189
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps4496_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2402589321136475
Epoch: 1, Steps: 8 | Train Loss: 1.778 Vali Loss: 1.716 Vali Acc: 0.191 Test Loss: 1.716 Test Acc: 0.191
Validation loss decreased (inf --> -0.190823).  Saving model ...
Epoch: 2 cost time: 0.75356125831604
Epoch: 2, Steps: 8 | Train Loss: 1.600 Vali Loss: 1.687 Vali Acc: 0.214 Test Loss: 1.687 Test Acc: 0.214
Validation loss decreased (-0.190823 --> -0.213724).  Saving model ...
Epoch: 3 cost time: 0.9316694736480713
Epoch: 3, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.638 Vali Acc: 0.282 Test Loss: 1.638 Test Acc: 0.282
Validation loss decreased (-0.213724 --> -0.282426).  Saving model ...
Epoch: 4 cost time: 0.9698224067687988
Epoch: 4, Steps: 8 | Train Loss: 1.217 Vali Loss: 1.583 Vali Acc: 0.313 Test Loss: 1.583 Test Acc: 0.313
Validation loss decreased (-0.282426 --> -0.312961).  Saving model ...
Epoch: 5 cost time: 0.9189951419830322
Epoch: 5, Steps: 8 | Train Loss: 1.055 Vali Loss: 1.536 Vali Acc: 0.359 Test Loss: 1.536 Test Acc: 0.359
Validation loss decreased (-0.312961 --> -0.358763).  Saving model ...
Epoch: 6 cost time: 0.907031774520874
Epoch: 6, Steps: 8 | Train Loss: 0.833 Vali Loss: 1.501 Vali Acc: 0.382 Test Loss: 1.501 Test Acc: 0.382
Validation loss decreased (-0.358763 --> -0.381664).  Saving model ...
Epoch: 7 cost time: 0.9044704437255859
Epoch: 7, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.467 Vali Acc: 0.412 Test Loss: 1.467 Test Acc: 0.412
Validation loss decreased (-0.381664 --> -0.412199).  Saving model ...
Epoch: 8 cost time: 0.9460372924804688
Epoch: 8, Steps: 8 | Train Loss: 0.619 Vali Loss: 1.436 Vali Acc: 0.412 Test Loss: 1.436 Test Acc: 0.412
Validation loss decreased (-0.412199 --> -0.412199).  Saving model ...
Epoch: 9 cost time: 0.8781754970550537
Epoch: 9, Steps: 8 | Train Loss: 0.501 Vali Loss: 1.460 Vali Acc: 0.420 Test Loss: 1.460 Test Acc: 0.420
Validation loss decreased (-0.412199 --> -0.419833).  Saving model ...
Epoch: 10 cost time: 0.9721636772155762
Epoch: 10, Steps: 8 | Train Loss: 0.428 Vali Loss: 1.459 Vali Acc: 0.427 Test Loss: 1.459 Test Acc: 0.427
Validation loss decreased (-0.419833 --> -0.427466).  Saving model ...
Epoch: 11 cost time: 0.9624722003936768
Epoch: 11, Steps: 8 | Train Loss: 0.383 Vali Loss: 1.428 Vali Acc: 0.427 Test Loss: 1.428 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427467).  Saving model ...
Epoch: 12 cost time: 0.9091324806213379
Epoch: 12, Steps: 8 | Train Loss: 0.307 Vali Loss: 1.437 Vali Acc: 0.412 Test Loss: 1.437 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.984694242477417
Epoch: 13, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.436 Vali Acc: 0.420 Test Loss: 1.436 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.964836597442627
Epoch: 14, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.450 Vali Acc: 0.427 Test Loss: 1.450 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0191576480865479
Epoch: 15, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.419 Vali Acc: 0.427 Test Loss: 1.419 Test Acc: 0.427
Validation loss decreased (-0.427467 --> -0.427467).  Saving model ...
Epoch: 16 cost time: 0.9735326766967773
Epoch: 16, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.426 Vali Acc: 0.427 Test Loss: 1.426 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0974664688110352
Epoch: 17, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.462 Vali Acc: 0.427 Test Loss: 1.462 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.021317720413208
Epoch: 18, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.479 Vali Acc: 0.412 Test Loss: 1.479 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9524288177490234
Epoch: 19, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.501 Vali Acc: 0.405 Test Loss: 1.501 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9321401119232178
Epoch: 20, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0532917976379395
Epoch: 21, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.482 Vali Acc: 0.405 Test Loss: 1.482 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9231986999511719
Epoch: 22, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.503 Vali Acc: 0.405 Test Loss: 1.503 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9679224491119385
Epoch: 23, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.509 Vali Acc: 0.427 Test Loss: 1.509 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0259816646575928
Epoch: 24, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.529 Vali Acc: 0.427 Test Loss: 1.529 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9281735420227051
Epoch: 25, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.513 Vali Acc: 0.427 Test Loss: 1.513 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_PatchTST_UEA_ftM_sl17984_ll0_pl0_el1_dm16_nh4_df64_ps4496_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 79093
model size : 1.41MB
