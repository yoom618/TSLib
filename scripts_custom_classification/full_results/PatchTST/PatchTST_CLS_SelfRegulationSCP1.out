Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.296778678894043
Epoch: 1, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.468 Vali Acc: 0.802 Test Loss: 0.468 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 2.816330909729004
Epoch: 2, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.521 Vali Acc: 0.816 Test Loss: 0.521 Test Acc: 0.816
Validation loss decreased (-0.802043 --> -0.815694).  Saving model ...
Epoch: 3 cost time: 2.568289041519165
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.663 Vali Acc: 0.785 Test Loss: 0.663 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4632880687713623
Epoch: 4, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.512 Vali Acc: 0.853 Test Loss: 0.512 Test Acc: 0.853
Validation loss decreased (-0.815694 --> -0.853237).  Saving model ...
Epoch: 5 cost time: 2.605402946472168
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.913 Vali Acc: 0.771 Test Loss: 0.913 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7809126377105713
Epoch: 6, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.819 Vali Acc: 0.816 Test Loss: 0.819 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1987380981445312
Epoch: 7, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.997 Vali Acc: 0.809 Test Loss: 0.997 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.828827381134033
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.943 Vali Acc: 0.809 Test Loss: 0.943 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5659778118133545
Epoch: 9, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.276 Vali Acc: 0.771 Test Loss: 1.276 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.961801052093506
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.454 Vali Acc: 0.758 Test Loss: 1.454 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.437333106994629
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.447 Vali Acc: 0.771 Test Loss: 1.447 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8362390995025635
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.493 Vali Acc: 0.799 Test Loss: 1.493 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0812010765075684
Epoch: 13, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.757 Vali Acc: 0.765 Test Loss: 1.757 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6572659015655518
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.773 Vali Acc: 0.778 Test Loss: 1.773 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 514306
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.944829225540161
Epoch: 1, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.432 Vali Acc: 0.795 Test Loss: 0.432 Test Acc: 0.795
Validation loss decreased (inf --> -0.795218).  Saving model ...
Epoch: 2 cost time: 2.6058483123779297
Epoch: 2, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.594 Vali Acc: 0.744 Test Loss: 0.594 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.040067672729492
Epoch: 3, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.554 Vali Acc: 0.785 Test Loss: 0.554 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.381843328475952
Epoch: 4, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.546 Vali Acc: 0.795 Test Loss: 0.546 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8192708492279053
Epoch: 5, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.815 Vali Acc: 0.720 Test Loss: 0.815 Test Acc: 0.720
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.328139543533325
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.657 Vali Acc: 0.819 Test Loss: 0.657 Test Acc: 0.819
Validation loss decreased (-0.795218 --> -0.819106).  Saving model ...
Epoch: 7 cost time: 3.2189862728118896
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.401 Vali Acc: 0.710 Test Loss: 1.401 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.870037317276001
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.667 Vali Acc: 0.857 Test Loss: 0.667 Test Acc: 0.857
Validation loss decreased (-0.819106 --> -0.856649).  Saving model ...
Epoch: 9 cost time: 3.159179210662842
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.743 Vali Acc: 0.710 Test Loss: 1.743 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.482480525970459
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.258 Vali Acc: 0.768 Test Loss: 1.258 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2499265670776367
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.555 Vali Acc: 0.747 Test Loss: 1.555 Test Acc: 0.747
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.997955322265625
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.237 Vali Acc: 0.792 Test Loss: 1.237 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.470466136932373
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.690 Vali Acc: 0.771 Test Loss: 1.690 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.83516788482666
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.348 Vali Acc: 0.805 Test Loss: 1.348 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.492264986038208
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.289 Vali Acc: 0.809 Test Loss: 1.289 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.691535711288452
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.665 Vali Acc: 0.795 Test Loss: 1.665 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1877992153167725
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.873 Vali Acc: 0.775 Test Loss: 1.873 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.0171573162078857
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.384 Vali Acc: 0.823 Test Loss: 1.384 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 463362
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.352468013763428
Epoch: 1, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.402 Vali Acc: 0.850 Test Loss: 0.402 Test Acc: 0.850
Validation loss decreased (inf --> -0.849825).  Saving model ...
Epoch: 2 cost time: 2.0931501388549805
Epoch: 2, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.461 Vali Acc: 0.823 Test Loss: 0.461 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0223047733306885
Epoch: 3, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.641 Vali Acc: 0.724 Test Loss: 0.641 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8892455101013184
Epoch: 4, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.433 Vali Acc: 0.829 Test Loss: 0.433 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9015164375305176
Epoch: 5, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.456 Vali Acc: 0.843 Test Loss: 0.456 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.087195873260498
Epoch: 6, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.630 Vali Acc: 0.802 Test Loss: 0.630 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5902764797210693
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0919322967529297
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.713 Vali Acc: 0.799 Test Loss: 0.713 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6311960220336914
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.558 Vali Acc: 0.860 Test Loss: 0.558 Test Acc: 0.860
Validation loss decreased (-0.849825 --> -0.860063).  Saving model ...
Epoch: 10 cost time: 2.778841733932495
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.872 Vali Acc: 0.782 Test Loss: 0.872 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.241677761077881
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.742 Vali Acc: 0.829 Test Loss: 0.742 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8387138843536377
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.056 Vali Acc: 0.775 Test Loss: 1.056 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5981123447418213
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.775 Vali Acc: 0.846 Test Loss: 0.775 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.02546763420105
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.521 Vali Acc: 0.741 Test Loss: 1.521 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.616011142730713
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.816 Vali Acc: 0.836 Test Loss: 0.816 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0275375843048096
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.232 Vali Acc: 0.775 Test Loss: 1.232 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.442690134048462
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.943 Vali Acc: 0.840 Test Loss: 0.943 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1255979537963867
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.151 Vali Acc: 0.799 Test Loss: 1.151 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.503152847290039
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.111 Vali Acc: 0.819 Test Loss: 1.111 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 446338
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.637807130813599
Epoch: 1, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 2.343064785003662
Epoch: 2, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.893615961074829
Epoch: 3, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1339399814605713
Epoch: 4, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.433 Vali Acc: 0.816 Test Loss: 0.433 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0252163410186768
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9858622550964355
Epoch: 6, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.484 Vali Acc: 0.840 Test Loss: 0.484 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 7 cost time: 2.0542352199554443
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8729801177978516
Epoch: 8, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.654 Vali Acc: 0.795 Test Loss: 0.654 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9786655902862549
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.595 Vali Acc: 0.826 Test Loss: 0.595 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8888885974884033
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.747 Vali Acc: 0.778 Test Loss: 0.747 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9289400577545166
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8553593158721924
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.717 Vali Acc: 0.819 Test Loss: 0.717 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.037647247314453
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.907 Vali Acc: 0.782 Test Loss: 0.907 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9572458267211914
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.949 Vali Acc: 0.782 Test Loss: 0.949 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8049917221069336
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1321449279785156
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.230 Vali Acc: 0.775 Test Loss: 1.230 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 438402
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.43326735496521
Epoch: 1, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.447 Vali Acc: 0.809 Test Loss: 0.447 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.8593599796295166
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.452 Vali Acc: 0.823 Test Loss: 0.452 Test Acc: 0.823
Validation loss decreased (-0.808869 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.672032356262207
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.431 Vali Acc: 0.812 Test Loss: 0.431 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.919870138168335
Epoch: 4, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.518 Vali Acc: 0.775 Test Loss: 0.518 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9565534591674805
Epoch: 5, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.448 Vali Acc: 0.823 Test Loss: 0.448 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822521).  Saving model ...
Epoch: 6 cost time: 1.6914699077606201
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
Validation loss decreased (-0.822521 --> -0.829347).  Saving model ...
Epoch: 7 cost time: 1.6989920139312744
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.535 Vali Acc: 0.826 Test Loss: 0.535 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0994021892547607
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7296712398529053
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.599 Vali Acc: 0.812 Test Loss: 0.599 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.130025625228882
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.693 Vali Acc: 0.802 Test Loss: 0.693 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7791564464569092
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.642 Vali Acc: 0.833 Test Loss: 0.642 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832758).  Saving model ...
Epoch: 12 cost time: 1.6942119598388672
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.065720558166504
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.606 Vali Acc: 0.853 Test Loss: 0.606 Test Acc: 0.853
Validation loss decreased (-0.832758 --> -0.853236).  Saving model ...
Epoch: 14 cost time: 1.5948638916015625
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.885 Vali Acc: 0.809 Test Loss: 0.885 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.068847179412842
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.745 Vali Acc: 0.826 Test Loss: 0.745 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.745633602142334
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.900 Vali Acc: 0.819 Test Loss: 0.900 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.735774517059326
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.726 Vali Acc: 0.840 Test Loss: 0.726 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9191081523895264
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.985 Vali Acc: 0.812 Test Loss: 0.985 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.303405284881592
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.780 Vali Acc: 0.833 Test Loss: 0.780 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0457513332366943
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.527303457260132
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.900 Vali Acc: 0.812 Test Loss: 0.900 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4914865493774414
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.131242513656616
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 434946
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.486358642578125
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 1.4221069812774658
Epoch: 2, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
Validation loss decreased (-0.836173 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 1.6831514835357666
Epoch: 3, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.402 Vali Acc: 0.816 Test Loss: 0.402 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.658940076828003
Epoch: 4, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.384 Vali Acc: 0.843 Test Loss: 0.384 Test Acc: 0.843
Validation loss decreased (-0.836174 --> -0.843000).  Saving model ...
Epoch: 5 cost time: 1.8465774059295654
Epoch: 5, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4696121215820312
Epoch: 6, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.401 Vali Acc: 0.860 Test Loss: 0.401 Test Acc: 0.860
Validation loss decreased (-0.843000 --> -0.860064).  Saving model ...
Epoch: 7 cost time: 1.7786946296691895
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.416 Vali Acc: 0.860 Test Loss: 0.416 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.466675043106079
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.448 Vali Acc: 0.836 Test Loss: 0.448 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7960903644561768
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9259541034698486
Epoch: 10, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.833 Test Loss: 0.572 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8050053119659424
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.530 Vali Acc: 0.853 Test Loss: 0.530 Test Acc: 0.853
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4856841564178467
Epoch: 12, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.806 Vali Acc: 0.788 Test Loss: 0.806 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.76064133644104
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.602 Vali Acc: 0.836 Test Loss: 0.602 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8925933837890625
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6221094131469727
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.575 Vali Acc: 0.857 Test Loss: 0.575 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9177212715148926
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.661 Vali Acc: 0.840 Test Loss: 0.661 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 434562
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.554711103439331
Epoch: 1, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
Validation loss decreased (inf --> -0.836173).  Saving model ...
Epoch: 2 cost time: 1.4566349983215332
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.431 Vali Acc: 0.809 Test Loss: 0.431 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.024160861968994
Epoch: 3, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.397 Vali Acc: 0.826 Test Loss: 0.397 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.201918840408325
Epoch: 4, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.458 Vali Acc: 0.795 Test Loss: 0.458 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.272674083709717
Epoch: 5, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.369 Vali Acc: 0.853 Test Loss: 0.369 Test Acc: 0.853
Validation loss decreased (-0.836173 --> -0.853239).  Saving model ...
Epoch: 6 cost time: 1.6417348384857178
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.488 Vali Acc: 0.805 Test Loss: 0.488 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0495526790618896
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.115203380584717
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.480 Vali Acc: 0.843 Test Loss: 0.480 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9700689315795898
Epoch: 9, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7630510330200195
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.117605686187744
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.632 Vali Acc: 0.805 Test Loss: 0.632 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.120039224624634
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.758 Vali Acc: 0.792 Test Loss: 0.758 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5809729099273682
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.644 Vali Acc: 0.823 Test Loss: 0.644 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6053712368011475
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.641 Vali Acc: 0.812 Test Loss: 0.641 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9213781356811523
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.756 Vali Acc: 0.805 Test Loss: 0.756 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 438658
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.9143218994140625
Epoch: 1, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 2.3670005798339844
Epoch: 2, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
Validation loss decreased (-0.726957 --> -0.808868).  Saving model ...
Epoch: 3 cost time: 2.1744561195373535
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3479840755462646
Epoch: 4, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.629 Vali Acc: 0.816 Test Loss: 0.629 Test Acc: 0.816
Validation loss decreased (-0.808868 --> -0.815693).  Saving model ...
Epoch: 5 cost time: 2.2625136375427246
Epoch: 5, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.698 Vali Acc: 0.823 Test Loss: 0.698 Test Acc: 0.823
Validation loss decreased (-0.815693 --> -0.822519).  Saving model ...
Epoch: 6 cost time: 2.6958634853363037
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.084 Vali Acc: 0.761 Test Loss: 1.084 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7955379486083984
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.791 Vali Acc: 0.853 Test Loss: 0.791 Test Acc: 0.853
Validation loss decreased (-0.822519 --> -0.853234).  Saving model ...
Epoch: 8 cost time: 2.784686803817749
Epoch: 8, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.615 Vali Acc: 0.768 Test Loss: 1.615 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4986696243286133
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.927 Vali Acc: 0.829 Test Loss: 0.927 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.230661153793335
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.533 Vali Acc: 0.788 Test Loss: 1.533 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.546539783477783
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.750 Vali Acc: 0.799 Test Loss: 1.750 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.691009521484375
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.598 Vali Acc: 0.819 Test Loss: 1.598 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2374541759490967
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.524 Vali Acc: 0.802 Test Loss: 1.524 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7695014476776123
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.662 Vali Acc: 0.799 Test Loss: 1.662 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.41451096534729
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.009 Vali Acc: 0.775 Test Loss: 2.009 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7184488773345947
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.761 Vali Acc: 0.809 Test Loss: 1.761 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.416569471359253
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.949 Vali Acc: 0.788 Test Loss: 1.949 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 415618
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.453226566314697
Epoch: 1, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.441 Vali Acc: 0.816 Test Loss: 0.441 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 2.2786753177642822
Epoch: 2, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.484 Vali Acc: 0.792 Test Loss: 0.484 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9840400218963623
Epoch: 3, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.395 Vali Acc: 0.843 Test Loss: 0.395 Test Acc: 0.843
Validation loss decreased (-0.815695 --> -0.842999).  Saving model ...
Epoch: 4 cost time: 1.9547414779663086
Epoch: 4, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6590559482574463
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.635 Vali Acc: 0.829 Test Loss: 0.635 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.486715793609619
Epoch: 6, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.995 Vali Acc: 0.730 Test Loss: 0.995 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3727457523345947
Epoch: 7, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.837 Vali Acc: 0.778 Test Loss: 0.837 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7599828243255615
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7844786643981934
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.916 Vali Acc: 0.802 Test Loss: 0.916 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.250041961669922
Epoch: 10, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.875 Vali Acc: 0.812 Test Loss: 0.875 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2204980850219727
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.986 Vali Acc: 0.809 Test Loss: 0.986 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.062347412109375
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.228 Vali Acc: 0.778 Test Loss: 1.228 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.905409097671509
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.076 Vali Acc: 0.805 Test Loss: 1.076 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 364674
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.251892805099487
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.418 Vali Acc: 0.805 Test Loss: 0.418 Test Acc: 0.805
Validation loss decreased (inf --> -0.805457).  Saving model ...
Epoch: 2 cost time: 2.202141046524048
Epoch: 2, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.906930446624756
Epoch: 3, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.512 Vali Acc: 0.802 Test Loss: 0.512 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9736430644989014
Epoch: 4, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.701 Vali Acc: 0.734 Test Loss: 0.701 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0889391899108887
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
Validation loss decreased (-0.805457 --> -0.819108).  Saving model ...
Epoch: 6 cost time: 2.5707855224609375
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.730 Vali Acc: 0.771 Test Loss: 0.730 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7456512451171875
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7123899459838867
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.796 Vali Acc: 0.778 Test Loss: 0.796 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.556347131729126
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.654 Vali Acc: 0.819 Test Loss: 0.654 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.604264974594116
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.999 Vali Acc: 0.775 Test Loss: 0.999 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.262615442276001
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.693 Vali Acc: 0.833 Test Loss: 0.693 Test Acc: 0.833
Validation loss decreased (-0.819108 --> -0.832758).  Saving model ...
Epoch: 12 cost time: 2.0743021965026855
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.948 Vali Acc: 0.792 Test Loss: 0.948 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.509627342224121
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.992 Vali Acc: 0.805 Test Loss: 0.992 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4538650512695312
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.957 Vali Acc: 0.809 Test Loss: 0.957 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2331011295318604
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.805 Vali Acc: 0.840 Test Loss: 0.805 Test Acc: 0.840
Validation loss decreased (-0.832758 --> -0.839582).  Saving model ...
Epoch: 16 cost time: 2.2178635597229004
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.148 Vali Acc: 0.792 Test Loss: 1.148 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.64798641204834
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.126 Vali Acc: 0.792 Test Loss: 1.126 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.352588415145874
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.197 Vali Acc: 0.795 Test Loss: 1.197 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1411221027374268
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.266 Vali Acc: 0.788 Test Loss: 1.266 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.896709680557251
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.114 Vali Acc: 0.833 Test Loss: 1.114 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3069708347320557
Epoch: 21, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.512 Vali Acc: 0.788 Test Loss: 1.512 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.603059768676758
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.530 Vali Acc: 0.809 Test Loss: 1.530 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.021787643432617
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.256 Vali Acc: 0.812 Test Loss: 1.256 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.8327181339263916
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.349 Vali Acc: 0.795 Test Loss: 1.349 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.936163902282715
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.382 Vali Acc: 0.795 Test Loss: 1.382 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 347650
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.9500837326049805
Epoch: 1, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.459 Vali Acc: 0.799 Test Loss: 0.459 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 3.145565986633301
Epoch: 2, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.492 Vali Acc: 0.771 Test Loss: 0.492 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6861493587493896
Epoch: 3, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.478 Vali Acc: 0.826 Test Loss: 0.478 Test Acc: 0.826
Validation loss decreased (-0.798630 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 2.878941297531128
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.370 Vali Acc: 0.863 Test Loss: 0.370 Test Acc: 0.863
Validation loss decreased (-0.825934 --> -0.863478).  Saving model ...
Epoch: 5 cost time: 2.796853542327881
Epoch: 5, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.279503583908081
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.455 Vali Acc: 0.840 Test Loss: 0.455 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.989544630050659
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.488 Vali Acc: 0.843 Test Loss: 0.488 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1746366024017334
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.664 Vali Acc: 0.826 Test Loss: 0.664 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3596763610839844
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4609882831573486
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.328233480453491
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.744 Vali Acc: 0.799 Test Loss: 0.744 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7914912700653076
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.772 Vali Acc: 0.792 Test Loss: 0.772 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8588743209838867
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.4011664390563965
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.852 Vali Acc: 0.799 Test Loss: 0.852 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 339714
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.703113555908203
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.454878330230713
Epoch: 2, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.537 Vali Acc: 0.727 Test Loss: 0.537 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1293232440948486
Epoch: 3, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.429 Vali Acc: 0.805 Test Loss: 0.429 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7712042331695557
Epoch: 4, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.404 Vali Acc: 0.860 Test Loss: 0.404 Test Acc: 0.860
Validation loss decreased (-0.825934 --> -0.860064).  Saving model ...
Epoch: 5 cost time: 2.9207944869995117
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.447 Vali Acc: 0.812 Test Loss: 0.447 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.162692070007324
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.460 Vali Acc: 0.816 Test Loss: 0.460 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8541924953460693
Epoch: 7, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.476 Vali Acc: 0.826 Test Loss: 0.476 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7179431915283203
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.587 Vali Acc: 0.799 Test Loss: 0.587 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8228206634521484
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.700 Vali Acc: 0.785 Test Loss: 0.700 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7248423099517822
Epoch: 10, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8213276863098145
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.824 Vali Acc: 0.771 Test Loss: 0.824 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6799111366271973
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.692 Vali Acc: 0.829 Test Loss: 0.692 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.1749448776245117
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.835 Vali Acc: 0.792 Test Loss: 0.835 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.978954553604126
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.828 Vali Acc: 0.805 Test Loss: 0.828 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 336258
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.084301233291626
Epoch: 1, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.6858015060424805
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.411 Vali Acc: 0.816 Test Loss: 0.411 Test Acc: 0.816
Validation loss decreased (-0.812282 --> -0.815696).  Saving model ...
Epoch: 3 cost time: 1.6641700267791748
Epoch: 3, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.465 Vali Acc: 0.792 Test Loss: 0.465 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8372762203216553
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.372 Vali Acc: 0.860 Test Loss: 0.372 Test Acc: 0.860
Validation loss decreased (-0.815696 --> -0.860065).  Saving model ...
Epoch: 5 cost time: 2.237982749938965
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.461 Vali Acc: 0.819 Test Loss: 0.461 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2286505699157715
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.436 Vali Acc: 0.823 Test Loss: 0.436 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9997515678405762
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.602 Vali Acc: 0.785 Test Loss: 0.602 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.26243257522583
Epoch: 8, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.465 Vali Acc: 0.840 Test Loss: 0.465 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9069163799285889
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.666 Vali Acc: 0.754 Test Loss: 0.666 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8322343826293945
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9498846530914307
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.510 Vali Acc: 0.829 Test Loss: 0.510 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7004344463348389
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.634 Vali Acc: 0.799 Test Loss: 0.634 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8511650562286377
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.78122878074646
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.760 Vali Acc: 0.792 Test Loss: 0.760 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 335874
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.9294066429138184
Epoch: 1, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 1.7985212802886963
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.440 Vali Acc: 0.802 Test Loss: 0.440 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8927032947540283
Epoch: 3, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.441 Vali Acc: 0.805 Test Loss: 0.441 Test Acc: 0.805
Validation loss decreased (-0.805456 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.9287207126617432
Epoch: 4, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.383 Vali Acc: 0.833 Test Loss: 0.383 Test Acc: 0.833
Validation loss decreased (-0.805456 --> -0.832761).  Saving model ...
Epoch: 5 cost time: 1.7997372150421143
Epoch: 5, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6855497360229492
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6502625942230225
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.483 Vali Acc: 0.812 Test Loss: 0.483 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.605510950088501
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6503322124481201
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.452 Vali Acc: 0.840 Test Loss: 0.452 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.9327678680419922
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.746 Vali Acc: 0.741 Test Loss: 0.746 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8294775485992432
Epoch: 11, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.489 Vali Acc: 0.846 Test Loss: 0.489 Test Acc: 0.846
Validation loss decreased (-0.839586 --> -0.846411).  Saving model ...
Epoch: 12 cost time: 1.8871216773986816
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.582 Vali Acc: 0.799 Test Loss: 0.582 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7013578414916992
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.679 Vali Acc: 0.795 Test Loss: 0.679 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7575552463531494
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.648 Vali Acc: 0.805 Test Loss: 0.648 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6420197486877441
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.601954460144043
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.643 Vali Acc: 0.812 Test Loss: 0.643 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6742520332336426
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0372095108032227
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.836 Vali Acc: 0.785 Test Loss: 0.836 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.886824131011963
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.732 Vali Acc: 0.823 Test Loss: 0.732 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6712703704833984
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.864 Vali Acc: 0.795 Test Loss: 0.864 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.65861177444458
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.728 Vali Acc: 0.819 Test Loss: 0.728 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 339970
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.6919214725494385
Epoch: 1, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.411 Vali Acc: 0.823 Test Loss: 0.411 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.770855188369751
Epoch: 2, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.464 Vali Acc: 0.805 Test Loss: 0.464 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7777926921844482
Epoch: 3, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.367 Vali Acc: 0.867 Test Loss: 0.367 Test Acc: 0.867
Validation loss decreased (-0.822521 --> -0.866891).  Saving model ...
Epoch: 4 cost time: 2.8038628101348877
Epoch: 4, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.576 Vali Acc: 0.802 Test Loss: 0.576 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.774092197418213
Epoch: 5, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0102899074554443
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.721 Vali Acc: 0.795 Test Loss: 0.721 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3777430057525635
Epoch: 7, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.767 Vali Acc: 0.843 Test Loss: 0.767 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9213638305664062
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.127 Vali Acc: 0.795 Test Loss: 1.127 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.859616994857788
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.097 Vali Acc: 0.805 Test Loss: 1.097 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.093846321105957
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.359 Vali Acc: 0.802 Test Loss: 1.359 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.678696393966675
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.931 Vali Acc: 0.843 Test Loss: 0.931 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.485002040863037
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.912 Vali Acc: 0.758 Test Loss: 1.912 Test Acc: 0.758
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.56262469291687
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.934 Vali Acc: 0.799 Test Loss: 1.934 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 366274
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.565313816070557
Epoch: 1, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.366 Vali Acc: 0.853 Test Loss: 0.366 Test Acc: 0.853
Validation loss decreased (inf --> -0.853239).  Saving model ...
Epoch: 2 cost time: 2.9278581142425537
Epoch: 2, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5646660327911377
Epoch: 3, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.639216661453247
Epoch: 4, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.634 Vali Acc: 0.775 Test Loss: 0.634 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7067956924438477
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.757 Vali Acc: 0.737 Test Loss: 0.757 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6510660648345947
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.027055501937866
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.07182240486145
Epoch: 8, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.794 Vali Acc: 0.812 Test Loss: 0.794 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0553994178771973
Epoch: 9, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.110 Vali Acc: 0.761 Test Loss: 1.110 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.233222484588623
Epoch: 10, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.865 Vali Acc: 0.816 Test Loss: 0.865 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.801720380783081
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.439 Vali Acc: 0.754 Test Loss: 1.439 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 315330
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.776775121688843
Epoch: 1, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.463 Vali Acc: 0.792 Test Loss: 0.463 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 2.937756061553955
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
Validation loss decreased (-0.791804 --> -0.849825).  Saving model ...
Epoch: 3 cost time: 2.9340648651123047
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.454 Vali Acc: 0.795 Test Loss: 0.454 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.082653045654297
Epoch: 4, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.600 Vali Acc: 0.778 Test Loss: 0.600 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.359807014465332
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.919872283935547
Epoch: 6, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.678 Vali Acc: 0.771 Test Loss: 0.678 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5343589782714844
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.161602020263672
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.752 Vali Acc: 0.782 Test Loss: 0.752 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2157227993011475
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8416543006896973
Epoch: 10, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.034 Vali Acc: 0.761 Test Loss: 1.034 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.794006109237671
Epoch: 11, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.796 Vali Acc: 0.819 Test Loss: 0.796 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.664659023284912
Epoch: 12, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.031 Vali Acc: 0.799 Test Loss: 1.031 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 298306
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.271581649780273
Epoch: 1, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
Validation loss decreased (inf --> -0.819109).  Saving model ...
Epoch: 2 cost time: 2.687534809112549
Epoch: 2, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.402 Vali Acc: 0.840 Test Loss: 0.402 Test Acc: 0.840
Validation loss decreased (-0.819109 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.7013869285583496
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6454503536224365
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9048712253570557
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.667 Vali Acc: 0.744 Test Loss: 0.667 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.551158905029297
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.476 Vali Acc: 0.840 Test Loss: 0.476 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3580665588378906
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.540 Vali Acc: 0.802 Test Loss: 0.540 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7355263233184814
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.687 Vali Acc: 0.768 Test Loss: 0.687 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7882437705993652
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.568 Vali Acc: 0.829 Test Loss: 0.568 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0412704944610596
Epoch: 10, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.582 Vali Acc: 0.829 Test Loss: 0.582 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3749265670776367
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.795 Vali Acc: 0.785 Test Loss: 0.795 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.623884916305542
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.677 Vali Acc: 0.802 Test Loss: 0.677 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 290370
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.4213478565216064
Epoch: 1, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.438 Vali Acc: 0.799 Test Loss: 0.438 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.8588893413543701
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.409 Vali Acc: 0.805 Test Loss: 0.409 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805457).  Saving model ...
Epoch: 3 cost time: 2.3958022594451904
Epoch: 3, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.392 Vali Acc: 0.826 Test Loss: 0.392 Test Acc: 0.826
Validation loss decreased (-0.805457 --> -0.825935).  Saving model ...
Epoch: 4 cost time: 2.3493776321411133
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.351 Vali Acc: 0.857 Test Loss: 0.351 Test Acc: 0.857
Validation loss decreased (-0.825935 --> -0.856652).  Saving model ...
Epoch: 5 cost time: 2.738560199737549
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.534 Vali Acc: 0.768 Test Loss: 0.534 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9888319969177246
Epoch: 6, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7292182445526123
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.493 Vali Acc: 0.829 Test Loss: 0.493 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2586567401885986
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.451 Vali Acc: 0.853 Test Loss: 0.451 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0192863941192627
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.569 Vali Acc: 0.833 Test Loss: 0.569 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.193890333175659
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.595 Vali Acc: 0.829 Test Loss: 0.595 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.83931303024292
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.617 Vali Acc: 0.843 Test Loss: 0.617 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.036055564880371
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.765 Vali Acc: 0.799 Test Loss: 0.765 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2836270332336426
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.706 Vali Acc: 0.826 Test Loss: 0.706 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2849342823028564
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.734 Vali Acc: 0.819 Test Loss: 0.734 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 286914
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.96338677406311
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.497 Vali Acc: 0.775 Test Loss: 0.497 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.6191349029541016
Epoch: 2, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.427 Vali Acc: 0.809 Test Loss: 0.427 Test Acc: 0.809
Validation loss decreased (-0.774739 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.8269412517547607
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.404 Vali Acc: 0.846 Test Loss: 0.404 Test Acc: 0.846
Validation loss decreased (-0.808869 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 1.9297454357147217
Epoch: 4, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.428 Vali Acc: 0.823 Test Loss: 0.428 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8524315357208252
Epoch: 5, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.478 Vali Acc: 0.823 Test Loss: 0.478 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.071697950363159
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.388 Vali Acc: 0.853 Test Loss: 0.388 Test Acc: 0.853
Validation loss decreased (-0.846412 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.8842041492462158
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0636258125305176
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8659954071044922
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.850 Test Loss: 0.436 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6485514640808105
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.458 Vali Acc: 0.843 Test Loss: 0.458 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2598493099212646
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.717 Vali Acc: 0.785 Test Loss: 0.717 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2351818084716797
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.637 Vali Acc: 0.799 Test Loss: 0.637 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7640407085418701
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.844574213027954
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.696 Vali Acc: 0.812 Test Loss: 0.696 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3573129177093506
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.902 Vali Acc: 0.799 Test Loss: 0.902 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8950326442718506
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.876 Vali Acc: 0.778 Test Loss: 0.876 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 286530
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.587929725646973
Epoch: 1, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.413 Vali Acc: 0.840 Test Loss: 0.413 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 1.8483777046203613
Epoch: 2, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.409 Vali Acc: 0.805 Test Loss: 0.409 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.925692081451416
Epoch: 3, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.372 Vali Acc: 0.843 Test Loss: 0.372 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.843000).  Saving model ...
Epoch: 4 cost time: 1.490391731262207
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.377 Vali Acc: 0.843 Test Loss: 0.377 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.019340991973877
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.391 Vali Acc: 0.840 Test Loss: 0.391 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.778212070465088
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.407 Vali Acc: 0.826 Test Loss: 0.407 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8172192573547363
Epoch: 7, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.432 Vali Acc: 0.840 Test Loss: 0.432 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8331100940704346
Epoch: 8, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.485 Vali Acc: 0.843 Test Loss: 0.485 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.847353219985962
Epoch: 9, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.486 Vali Acc: 0.840 Test Loss: 0.486 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8965089321136475
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.587 Vali Acc: 0.795 Test Loss: 0.587 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8426604270935059
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.109729766845703
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.549 Vali Acc: 0.823 Test Loss: 0.549 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8883764743804932
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.558 Vali Acc: 0.846 Test Loss: 0.558 Test Acc: 0.846
Validation loss decreased (-0.843000 --> -0.846411).  Saving model ...
Epoch: 14 cost time: 1.753765344619751
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9439036846160889
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.632 Vali Acc: 0.833 Test Loss: 0.632 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8174333572387695
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5359563827514648
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.780 Vali Acc: 0.805 Test Loss: 0.780 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7302067279815674
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.784 Vali Acc: 0.816 Test Loss: 0.784 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7783987522125244
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.730 Vali Acc: 0.840 Test Loss: 0.730 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.794206142425537
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.833 Test Loss: 0.737 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.888643741607666
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.843 Test Loss: 0.762 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9152677059173584
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.832 Vali Acc: 0.829 Test Loss: 0.832 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7841651439666748
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm128_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 290626
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.711609840393066
Epoch: 1, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.534 Vali Acc: 0.785 Test Loss: 0.534 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 2.8366787433624268
Epoch: 2, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.441 Vali Acc: 0.823 Test Loss: 0.441 Test Acc: 0.823
Validation loss decreased (-0.784978 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 3.0775465965270996
Epoch: 3, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.584 Vali Acc: 0.744 Test Loss: 0.584 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9667716026306152
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.513 Vali Acc: 0.795 Test Loss: 0.513 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.561937093734741
Epoch: 5, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1519601345062256
Epoch: 6, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.853330612182617
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.993 Vali Acc: 0.713 Test Loss: 0.993 Test Acc: 0.713
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.254037857055664
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.595 Vali Acc: 0.853 Test Loss: 0.595 Test Acc: 0.853
Validation loss decreased (-0.822521 --> -0.853236).  Saving model ...
Epoch: 9 cost time: 3.016535997390747
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.031 Vali Acc: 0.744 Test Loss: 1.031 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.169424533843994
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.001 Vali Acc: 0.785 Test Loss: 1.001 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9321107864379883
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.979 Vali Acc: 0.805 Test Loss: 0.979 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0596137046813965
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.076 Vali Acc: 0.782 Test Loss: 1.076 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.871959686279297
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.965 Vali Acc: 0.826 Test Loss: 0.965 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8751423358917236
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.287 Vali Acc: 0.799 Test Loss: 1.287 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1932523250579834
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.159 Vali Acc: 0.826 Test Loss: 1.159 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.0012898445129395
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.205 Vali Acc: 0.799 Test Loss: 1.205 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.954859495162964
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.322 Vali Acc: 0.785 Test Loss: 1.322 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6854631900787354
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.308 Vali Acc: 0.802 Test Loss: 1.308 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 208386
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.746752977371216
Epoch: 1, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.812389612197876
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.503 Vali Acc: 0.829 Test Loss: 0.503 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8760876655578613
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.414 Vali Acc: 0.846 Test Loss: 0.414 Test Acc: 0.846
Validation loss decreased (-0.829347 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 2.6954524517059326
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.421 Vali Acc: 0.843 Test Loss: 0.421 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5934958457946777
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.528542995452881
Epoch: 6, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.592 Vali Acc: 0.802 Test Loss: 0.592 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6256136894226074
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.478 Vali Acc: 0.846 Test Loss: 0.478 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.928969383239746
Epoch: 8, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8618218898773193
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.675 Vali Acc: 0.812 Test Loss: 0.675 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1565513610839844
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.663 Vali Acc: 0.812 Test Loss: 0.663 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.576775312423706
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.639 Vali Acc: 0.840 Test Loss: 0.639 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2222800254821777
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.956 Vali Acc: 0.792 Test Loss: 0.956 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.026494026184082
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.793 Vali Acc: 0.826 Test Loss: 0.793 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 182914
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.604414939880371
Epoch: 1, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.538 Vali Acc: 0.727 Test Loss: 0.538 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 1.8423612117767334
Epoch: 2, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
Validation loss decreased (-0.726957 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 2.6106202602386475
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.452 Vali Acc: 0.805 Test Loss: 0.452 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.541095018386841
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.404 Vali Acc: 0.840 Test Loss: 0.404 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 5 cost time: 2.0552141666412354
Epoch: 5, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.412 Vali Acc: 0.836 Test Loss: 0.412 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7277843952178955
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.462 Vali Acc: 0.843 Test Loss: 0.462 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842999).  Saving model ...
Epoch: 7 cost time: 2.348548412322998
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.519 Vali Acc: 0.805 Test Loss: 0.519 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5731194019317627
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4445738792419434
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3999640941619873
Epoch: 10, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.577 Vali Acc: 0.819 Test Loss: 0.577 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.441392183303833
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.641 Vali Acc: 0.823 Test Loss: 0.641 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.018749952316284
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.609 Vali Acc: 0.829 Test Loss: 0.609 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5550127029418945
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.304657459259033
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2245190143585205
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.936 Vali Acc: 0.771 Test Loss: 0.936 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.999274492263794
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.721 Vali Acc: 0.812 Test Loss: 0.721 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 174402
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.7824788093566895
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.467 Vali Acc: 0.816 Test Loss: 0.467 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.666327953338623
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.474 Vali Acc: 0.778 Test Loss: 0.474 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4985461235046387
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.446 Vali Acc: 0.795 Test Loss: 0.446 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6071600914001465
Epoch: 4, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.411 Vali Acc: 0.823 Test Loss: 0.411 Test Acc: 0.823
Validation loss decreased (-0.815695 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.6371879577636719
Epoch: 5, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.494 Vali Acc: 0.788 Test Loss: 0.494 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8592474460601807
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.543 Vali Acc: 0.792 Test Loss: 0.543 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.93963623046875
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.606736183166504
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9853780269622803
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.552 Vali Acc: 0.805 Test Loss: 0.552 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0615487098693848
Epoch: 10, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.478 Vali Acc: 0.843 Test Loss: 0.478 Test Acc: 0.843
Validation loss decreased (-0.822521 --> -0.842999).  Saving model ...
Epoch: 11 cost time: 1.7538785934448242
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.602 Vali Acc: 0.792 Test Loss: 0.602 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.180713653564453
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4779088497161865
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.814281940460205
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.698 Vali Acc: 0.788 Test Loss: 0.698 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.786377191543579
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.719 Vali Acc: 0.785 Test Loss: 0.719 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7171764373779297
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.777 Vali Acc: 0.795 Test Loss: 0.777 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.947629451751709
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8852405548095703
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.853 Vali Acc: 0.778 Test Loss: 0.853 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9291489124298096
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0482354164123535
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.854 Vali Acc: 0.799 Test Loss: 0.854 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 170434
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.610195159912109
Epoch: 1, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.463 Vali Acc: 0.826 Test Loss: 0.463 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.1287841796875
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.442 Vali Acc: 0.823 Test Loss: 0.442 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.620605230331421
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836174).  Saving model ...
Epoch: 4 cost time: 2.0343856811523438
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.411 Vali Acc: 0.823 Test Loss: 0.411 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.582707166671753
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.384 Vali Acc: 0.843 Test Loss: 0.384 Test Acc: 0.843
Validation loss decreased (-0.836174 --> -0.843000).  Saving model ...
Epoch: 6 cost time: 1.602931261062622
Epoch: 6, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.402 Vali Acc: 0.843 Test Loss: 0.402 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7505528926849365
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6648519039154053
Epoch: 8, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.535 Vali Acc: 0.809 Test Loss: 0.535 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6326918601989746
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.431 Vali Acc: 0.846 Test Loss: 0.431 Test Acc: 0.846
Validation loss decreased (-0.843000 --> -0.846412).  Saving model ...
Epoch: 10 cost time: 1.9834413528442383
Epoch: 10, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7741563320159912
Epoch: 11, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.530 Vali Acc: 0.812 Test Loss: 0.530 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6557049751281738
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6746103763580322
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.540 Vali Acc: 0.826 Test Loss: 0.540 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.70766282081604
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.628 Vali Acc: 0.795 Test Loss: 0.628 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.440361499786377
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.517519474029541
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.633 Vali Acc: 0.812 Test Loss: 0.633 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7370142936706543
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.677 Vali Acc: 0.812 Test Loss: 0.677 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7560076713562012
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.700 Vali Acc: 0.816 Test Loss: 0.700 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7209701538085938
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.729 Vali Acc: 0.799 Test Loss: 0.729 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 168706
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.378774642944336
Epoch: 1, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.483 Vali Acc: 0.795 Test Loss: 0.483 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 1.7947766780853271
Epoch: 2, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.454 Vali Acc: 0.802 Test Loss: 0.454 Test Acc: 0.802
Validation loss decreased (-0.795217 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.67128324508667
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.431 Vali Acc: 0.802 Test Loss: 0.431 Test Acc: 0.802
Validation loss decreased (-0.802043 --> -0.802043).  Saving model ...
Epoch: 4 cost time: 1.6875624656677246
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.491 Vali Acc: 0.765 Test Loss: 0.491 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.509828805923462
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.476 Vali Acc: 0.778 Test Loss: 0.476 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7403349876403809
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
Validation loss decreased (-0.802043 --> -0.812282).  Saving model ...
Epoch: 7 cost time: 1.72465181350708
Epoch: 7, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.380 Vali Acc: 0.860 Test Loss: 0.380 Test Acc: 0.860
Validation loss decreased (-0.812282 --> -0.860064).  Saving model ...
Epoch: 8 cost time: 1.6564326286315918
Epoch: 8, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.426 Vali Acc: 0.823 Test Loss: 0.426 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.773252248764038
Epoch: 9, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.476 Vali Acc: 0.799 Test Loss: 0.476 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.938497543334961
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8408911228179932
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.422 Vali Acc: 0.840 Test Loss: 0.422 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7896573543548584
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6957118511199951
Epoch: 13, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.424 Vali Acc: 0.853 Test Loss: 0.424 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.536752462387085
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.578 Vali Acc: 0.785 Test Loss: 0.578 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8788459300994873
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.938922643661499
Epoch: 16, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.646 Vali Acc: 0.788 Test Loss: 0.646 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.88200044631958
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.469 Vali Acc: 0.863 Test Loss: 0.469 Test Acc: 0.863
Validation loss decreased (-0.860064 --> -0.863477).  Saving model ...
Epoch: 18 cost time: 1.7096889019012451
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.537 Vali Acc: 0.840 Test Loss: 0.537 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.876086711883545
Epoch: 19, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.739 Vali Acc: 0.785 Test Loss: 0.739 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6917228698730469
Epoch: 20, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7337541580200195
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.570 Vali Acc: 0.836 Test Loss: 0.570 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.019386053085327
Epoch: 22, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.613 Vali Acc: 0.805 Test Loss: 0.613 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.047473907470703
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.769 Vali Acc: 0.799 Test Loss: 0.769 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7249736785888672
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6759986877441406
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.768582820892334
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.671 Vali Acc: 0.816 Test Loss: 0.671 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7821950912475586
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.645 Vali Acc: 0.853 Test Loss: 0.645 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 168514
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.201037645339966
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.556 Vali Acc: 0.734 Test Loss: 0.556 Test Acc: 0.734
Validation loss decreased (inf --> -0.733783).  Saving model ...
Epoch: 2 cost time: 2.1002578735351562
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.455 Vali Acc: 0.785 Test Loss: 0.455 Test Acc: 0.785
Validation loss decreased (-0.733783 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 1.8338899612426758
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.417 Vali Acc: 0.812 Test Loss: 0.417 Test Acc: 0.812
Validation loss decreased (-0.784978 --> -0.812283).  Saving model ...
Epoch: 4 cost time: 1.6211652755737305
Epoch: 4, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
Validation loss decreased (-0.812283 --> -0.849826).  Saving model ...
Epoch: 5 cost time: 1.7069475650787354
Epoch: 5, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.456 Vali Acc: 0.805 Test Loss: 0.456 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9183576107025146
Epoch: 6, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.384 Vali Acc: 0.833 Test Loss: 0.384 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9455115795135498
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.470 Vali Acc: 0.799 Test Loss: 0.470 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3071398735046387
Epoch: 8, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.368 Vali Acc: 0.840 Test Loss: 0.368 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9944617748260498
Epoch: 9, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.536 Vali Acc: 0.771 Test Loss: 0.536 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9929955005645752
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.378 Vali Acc: 0.857 Test Loss: 0.378 Test Acc: 0.857
Validation loss decreased (-0.849826 --> -0.856652).  Saving model ...
Epoch: 11 cost time: 1.5254905223846436
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.499 Vali Acc: 0.812 Test Loss: 0.499 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.217419385910034
Epoch: 12, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.518 Vali Acc: 0.819 Test Loss: 0.518 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7192044258117676
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9772255420684814
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.487 Vali Acc: 0.829 Test Loss: 0.487 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.691979169845581
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.598 Vali Acc: 0.802 Test Loss: 0.598 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3606445789337158
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.615 Vali Acc: 0.805 Test Loss: 0.615 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4668269157409668
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.573 Vali Acc: 0.812 Test Loss: 0.573 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6793837547302246
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.591 Vali Acc: 0.826 Test Loss: 0.591 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.064976930618286
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.601 Vali Acc: 0.812 Test Loss: 0.601 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0574138164520264
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.680 Vali Acc: 0.812 Test Loss: 0.680 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 170562
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.816885709762573
Epoch: 1, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.425 Vali Acc: 0.799 Test Loss: 0.425 Test Acc: 0.799
Validation loss decreased (inf --> -0.798631).  Saving model ...
Epoch: 2 cost time: 1.916736364364624
Epoch: 2, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.658 Vali Acc: 0.683 Test Loss: 0.658 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7187988758087158
Epoch: 3, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.531 Vali Acc: 0.782 Test Loss: 0.531 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2786004543304443
Epoch: 4, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
Validation loss decreased (-0.798631 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.0223090648651123
Epoch: 5, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.632 Vali Acc: 0.765 Test Loss: 0.632 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9297802448272705
Epoch: 6, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.591 Vali Acc: 0.829 Test Loss: 0.591 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829346).  Saving model ...
Epoch: 7 cost time: 1.8098034858703613
Epoch: 7, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.928 Vali Acc: 0.741 Test Loss: 0.928 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9470739364624023
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.923 Vali Acc: 0.771 Test Loss: 0.923 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.238652467727661
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.837 Vali Acc: 0.809 Test Loss: 0.837 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3460123538970947
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.999 Vali Acc: 0.785 Test Loss: 0.999 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1641345024108887
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.876 Vali Acc: 0.826 Test Loss: 0.876 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2973597049713135
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.269 Vali Acc: 0.768 Test Loss: 1.269 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.208829641342163
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.327 Vali Acc: 0.765 Test Loss: 1.327 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5095958709716797
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.268 Vali Acc: 0.778 Test Loss: 1.268 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.326559066772461
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.582 Vali Acc: 0.795 Test Loss: 1.582 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.548161745071411
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.590 Vali Acc: 0.761 Test Loss: 1.590 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 158850
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.828824758529663
Epoch: 1, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.456 Vali Acc: 0.792 Test Loss: 0.456 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 2.386399030685425
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.424 Vali Acc: 0.792 Test Loss: 0.424 Test Acc: 0.792
Validation loss decreased (-0.791804 --> -0.791805).  Saving model ...
Epoch: 3 cost time: 3.342334270477295
Epoch: 3, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.518 Vali Acc: 0.768 Test Loss: 0.518 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.885103702545166
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
Validation loss decreased (-0.791805 --> -0.815695).  Saving model ...
Epoch: 5 cost time: 2.7755255699157715
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.464 Vali Acc: 0.823 Test Loss: 0.464 Test Acc: 0.823
Validation loss decreased (-0.815695 --> -0.822521).  Saving model ...
Epoch: 6 cost time: 2.348660707473755
Epoch: 6, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.548 Vali Acc: 0.792 Test Loss: 0.548 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2589948177337646
Epoch: 7, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.534 Vali Acc: 0.805 Test Loss: 0.534 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.155249834060669
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3406271934509277
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.656 Vali Acc: 0.792 Test Loss: 0.656 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.419923782348633
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.679 Vali Acc: 0.802 Test Loss: 0.679 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.496356964111328
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.756 Vali Acc: 0.795 Test Loss: 0.756 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3453259468078613
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.816 Vali Acc: 0.799 Test Loss: 0.816 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3850975036621094
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.815 Vali Acc: 0.819 Test Loss: 0.815 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.472553014755249
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.869 Vali Acc: 0.812 Test Loss: 0.869 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3220374584198
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.102 Vali Acc: 0.775 Test Loss: 1.102 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8225255972696246
model parameter : 133378
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.148768186569214
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.459 Vali Acc: 0.795 Test Loss: 0.459 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 2.6353564262390137
Epoch: 2, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.386 Vali Acc: 0.840 Test Loss: 0.386 Test Acc: 0.840
Validation loss decreased (-0.795217 --> -0.839587).  Saving model ...
Epoch: 3 cost time: 2.683795213699341
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.391 Vali Acc: 0.843 Test Loss: 0.391 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.843000).  Saving model ...
Epoch: 4 cost time: 3.014533758163452
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.400 Vali Acc: 0.819 Test Loss: 0.400 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3044166564941406
Epoch: 5, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.420 Vali Acc: 0.850 Test Loss: 0.420 Test Acc: 0.850
Validation loss decreased (-0.843000 --> -0.849825).  Saving model ...
Epoch: 6 cost time: 2.678133726119995
Epoch: 6, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.495 Vali Acc: 0.795 Test Loss: 0.495 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.441744804382324
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.570 Vali Acc: 0.785 Test Loss: 0.570 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.75399112701416
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8499813079833984
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.563 Vali Acc: 0.799 Test Loss: 0.563 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6203982830047607
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.639 Vali Acc: 0.792 Test Loss: 0.639 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.798647165298462
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.922330379486084
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6502561569213867
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.626 Vali Acc: 0.823 Test Loss: 0.626 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6805005073547363
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.736 Vali Acc: 0.785 Test Loss: 0.736 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.624384641647339
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.768 Vali Acc: 0.792 Test Loss: 0.768 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 124866
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.8271613121032715
Epoch: 1, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.498 Vali Acc: 0.758 Test Loss: 0.498 Test Acc: 0.758
Validation loss decreased (inf --> -0.757674).  Saving model ...
Epoch: 2 cost time: 1.9196221828460693
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.428 Vali Acc: 0.823 Test Loss: 0.428 Test Acc: 0.823
Validation loss decreased (-0.757674 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 2.3104424476623535
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.448 Vali Acc: 0.792 Test Loss: 0.448 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7909674644470215
Epoch: 4, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.406 Vali Acc: 0.823 Test Loss: 0.406 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822522).  Saving model ...
Epoch: 5 cost time: 1.5097761154174805
Epoch: 5, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.506 Vali Acc: 0.788 Test Loss: 0.506 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8178901672363281
Epoch: 6, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4936482906341553
Epoch: 7, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.541 Vali Acc: 0.799 Test Loss: 0.541 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.823972225189209
Epoch: 8, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0147056579589844
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.477 Vali Acc: 0.840 Test Loss: 0.477 Test Acc: 0.840
Validation loss decreased (-0.822522 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.7313363552093506
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.651 Vali Acc: 0.768 Test Loss: 0.651 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9367632865905762
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.606 Vali Acc: 0.795 Test Loss: 0.606 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7888462543487549
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.628 Vali Acc: 0.812 Test Loss: 0.628 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6623108386993408
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.612 Vali Acc: 0.795 Test Loss: 0.612 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4123549461364746
Epoch: 14, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.716 Vali Acc: 0.802 Test Loss: 0.716 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2073006629943848
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1032018661499023
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.875 Vali Acc: 0.765 Test Loss: 0.875 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9577820301055908
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.673 Vali Acc: 0.816 Test Loss: 0.673 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9541003704071045
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.884 Vali Acc: 0.775 Test Loss: 0.884 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.607849359512329
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.697 Vali Acc: 0.819 Test Loss: 0.697 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 120898
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.763441324234009
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.465 Vali Acc: 0.816 Test Loss: 0.465 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.6867938041687012
Epoch: 2, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.443 Vali Acc: 0.792 Test Loss: 0.443 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7886378765106201
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.496 Vali Acc: 0.771 Test Loss: 0.496 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7461352348327637
Epoch: 4, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.363 Vali Acc: 0.833 Test Loss: 0.363 Test Acc: 0.833
Validation loss decreased (-0.815695 --> -0.832761).  Saving model ...
Epoch: 5 cost time: 1.6824889183044434
Epoch: 5, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.413 Vali Acc: 0.812 Test Loss: 0.413 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8834757804870605
Epoch: 6, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.413 Vali Acc: 0.812 Test Loss: 0.413 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.078263521194458
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.412 Vali Acc: 0.836 Test Loss: 0.412 Test Acc: 0.836
Validation loss decreased (-0.832761 --> -0.836173).  Saving model ...
Epoch: 8 cost time: 1.8718669414520264
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.497 Vali Acc: 0.809 Test Loss: 0.497 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8027431964874268
Epoch: 9, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.510 Vali Acc: 0.812 Test Loss: 0.510 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.202524423599243
Epoch: 10, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.545 Vali Acc: 0.799 Test Loss: 0.545 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.837838888168335
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.79091215133667
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.779933214187622
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7805960178375244
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.650 Vali Acc: 0.795 Test Loss: 0.650 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0126452445983887
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.643 Vali Acc: 0.795 Test Loss: 0.643 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8174960613250732
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.626 Vali Acc: 0.799 Test Loss: 0.626 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.042654275894165
Epoch: 17, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.712 Vali Acc: 0.788 Test Loss: 0.712 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 119170
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.628925085067749
Epoch: 1, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.520 Vali Acc: 0.761 Test Loss: 0.520 Test Acc: 0.761
Validation loss decreased (inf --> -0.761087).  Saving model ...
Epoch: 2 cost time: 1.9206676483154297
Epoch: 2, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
Validation loss decreased (-0.761087 --> -0.832761).  Saving model ...
Epoch: 3 cost time: 1.578930139541626
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.459 Vali Acc: 0.785 Test Loss: 0.459 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8241076469421387
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7370965480804443
Epoch: 5, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.398 Vali Acc: 0.826 Test Loss: 0.398 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.896604061126709
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.378 Vali Acc: 0.843 Test Loss: 0.378 Test Acc: 0.843
Validation loss decreased (-0.832761 --> -0.843000).  Saving model ...
Epoch: 7 cost time: 1.713871955871582
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.757399559020996
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.386 Vali Acc: 0.857 Test Loss: 0.386 Test Acc: 0.857
Validation loss decreased (-0.843000 --> -0.856651).  Saving model ...
Epoch: 9 cost time: 1.6687390804290771
Epoch: 9, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8408584594726562
Epoch: 10, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.519 Vali Acc: 0.802 Test Loss: 0.519 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9250707626342773
Epoch: 11, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.447 Vali Acc: 0.846 Test Loss: 0.447 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7824430465698242
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.428 Vali Acc: 0.846 Test Loss: 0.428 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6490235328674316
Epoch: 13, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.505 Vali Acc: 0.843 Test Loss: 0.505 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6221404075622559
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.450 Vali Acc: 0.860 Test Loss: 0.450 Test Acc: 0.860
Validation loss decreased (-0.856651 --> -0.860064).  Saving model ...
Epoch: 15 cost time: 1.6805593967437744
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.541 Vali Acc: 0.812 Test Loss: 0.541 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5280201435089111
Epoch: 16, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.633 Vali Acc: 0.788 Test Loss: 0.633 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6591932773590088
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.759 Vali Acc: 0.761 Test Loss: 0.759 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9132530689239502
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.046090602874756
Epoch: 19, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.542 Vali Acc: 0.823 Test Loss: 0.542 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9609260559082031
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.721 Vali Acc: 0.768 Test Loss: 0.721 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1264162063598633
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.533 Vali Acc: 0.840 Test Loss: 0.533 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6540350914001465
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.601 Vali Acc: 0.823 Test Loss: 0.601 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6494355201721191
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.639 Vali Acc: 0.805 Test Loss: 0.639 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0253822803497314
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.829 Test Loss: 0.575 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 118978
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.6222333908081055
Epoch: 1, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.464 Vali Acc: 0.805 Test Loss: 0.464 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 1.6195721626281738
Epoch: 2, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.430 Vali Acc: 0.799 Test Loss: 0.430 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7007861137390137
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.401 Vali Acc: 0.809 Test Loss: 0.401 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808870).  Saving model ...
Epoch: 4 cost time: 1.6424684524536133
Epoch: 4, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.459 Vali Acc: 0.792 Test Loss: 0.459 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.625532865524292
Epoch: 5, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.424 Vali Acc: 0.819 Test Loss: 0.424 Test Acc: 0.819
Validation loss decreased (-0.808870 --> -0.819108).  Saving model ...
Epoch: 6 cost time: 1.8010995388031006
Epoch: 6, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.413 Vali Acc: 0.843 Test Loss: 0.413 Test Acc: 0.843
Validation loss decreased (-0.819108 --> -0.842999).  Saving model ...
Epoch: 7 cost time: 1.7158176898956299
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.522 Vali Acc: 0.771 Test Loss: 0.522 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8629355430603027
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.380 Vali Acc: 0.860 Test Loss: 0.380 Test Acc: 0.860
Validation loss decreased (-0.842999 --> -0.860064).  Saving model ...
Epoch: 9 cost time: 1.5620698928833008
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.552 Vali Acc: 0.771 Test Loss: 0.552 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8657004833221436
Epoch: 10, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.422 Vali Acc: 0.846 Test Loss: 0.422 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7706000804901123
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.475 Vali Acc: 0.826 Test Loss: 0.475 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.704369306564331
Epoch: 12, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.503 Vali Acc: 0.799 Test Loss: 0.503 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4638051986694336
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.540 Vali Acc: 0.799 Test Loss: 0.540 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4084093570709229
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5716087818145752
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.630 Vali Acc: 0.782 Test Loss: 0.630 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6490581035614014
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.603 Vali Acc: 0.785 Test Loss: 0.603 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4027702808380127
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.539 Vali Acc: 0.823 Test Loss: 0.539 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4667186737060547
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.724 Vali Acc: 0.768 Test Loss: 0.724 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 121026
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.763183832168579
Epoch: 1, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
Validation loss decreased (inf --> -0.812283).  Saving model ...
Epoch: 2 cost time: 2.2621965408325195
Epoch: 2, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1079838275909424
Epoch: 3, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.461 Vali Acc: 0.802 Test Loss: 0.461 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9734382629394531
Epoch: 4, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.518 Vali Acc: 0.823 Test Loss: 0.518 Test Acc: 0.823
Validation loss decreased (-0.812283 --> -0.822520).  Saving model ...
Epoch: 5 cost time: 2.0484256744384766
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.717 Vali Acc: 0.758 Test Loss: 0.717 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9223675727844238
Epoch: 6, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.626 Vali Acc: 0.805 Test Loss: 0.626 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.36265230178833
Epoch: 7, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.801 Vali Acc: 0.778 Test Loss: 0.801 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.406914472579956
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.650 Vali Acc: 0.843 Test Loss: 0.650 Test Acc: 0.843
Validation loss decreased (-0.822520 --> -0.842997).  Saving model ...
Epoch: 9 cost time: 2.2176785469055176
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.223 Vali Acc: 0.741 Test Loss: 1.223 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.609870195388794
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.112 Vali Acc: 0.765 Test Loss: 1.112 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8369548320770264
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.044 Vali Acc: 0.775 Test Loss: 1.044 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9070188999176025
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.207 Vali Acc: 0.765 Test Loss: 1.207 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.156266450881958
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.038 Vali Acc: 0.805 Test Loss: 1.038 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.024655818939209
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.189 Vali Acc: 0.778 Test Loss: 1.189 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.131798028945923
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.391 Vali Acc: 0.792 Test Loss: 1.391 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4447522163391113
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.186 Vali Acc: 0.802 Test Loss: 1.186 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.142733335494995
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.207 Vali Acc: 0.802 Test Loss: 1.207 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6403465270996094
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.156 Vali Acc: 0.816 Test Loss: 1.156 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 134082
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.756900787353516
Epoch: 1, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.9767513275146484
Epoch: 2, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.373 Vali Acc: 0.863 Test Loss: 0.373 Test Acc: 0.863
Validation loss decreased (-0.815695 --> -0.863478).  Saving model ...
Epoch: 3 cost time: 2.057620048522949
Epoch: 3, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.379 Vali Acc: 0.836 Test Loss: 0.379 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6863250732421875
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.71490478515625
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7165908813476562
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.534 Vali Acc: 0.802 Test Loss: 0.534 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0787460803985596
Epoch: 7, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.471 Vali Acc: 0.843 Test Loss: 0.471 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9487881660461426
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.706 Vali Acc: 0.751 Test Loss: 0.706 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0484654903411865
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.574 Vali Acc: 0.833 Test Loss: 0.574 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8062043190002441
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.727 Vali Acc: 0.819 Test Loss: 0.727 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.75935697555542
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.725 Vali Acc: 0.805 Test Loss: 0.725 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1105973720550537
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.851 Vali Acc: 0.782 Test Loss: 0.851 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 108610
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.341681241989136
Epoch: 1, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.464 Vali Acc: 0.785 Test Loss: 0.464 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 2.0707144737243652
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.425 Vali Acc: 0.802 Test Loss: 0.425 Test Acc: 0.802
Validation loss decreased (-0.784978 --> -0.802044).  Saving model ...
Epoch: 3 cost time: 1.9727628231048584
Epoch: 3, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.483 Vali Acc: 0.778 Test Loss: 0.483 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.231105327606201
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
Validation loss decreased (-0.802044 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.4606740474700928
Epoch: 5, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.442 Vali Acc: 0.829 Test Loss: 0.442 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829347).  Saving model ...
Epoch: 6 cost time: 2.3374979496002197
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.442 Vali Acc: 0.840 Test Loss: 0.442 Test Acc: 0.840
Validation loss decreased (-0.829347 --> -0.839586).  Saving model ...
Epoch: 7 cost time: 2.278503179550171
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.554 Vali Acc: 0.788 Test Loss: 0.554 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.462045907974243
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.525 Vali Acc: 0.802 Test Loss: 0.525 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2601659297943115
Epoch: 9, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0636672973632812
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.608 Vali Acc: 0.788 Test Loss: 0.608 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2049074172973633
Epoch: 11, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.609 Vali Acc: 0.805 Test Loss: 0.609 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4461236000061035
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.664 Vali Acc: 0.795 Test Loss: 0.664 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.321118116378784
Epoch: 13, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.636 Vali Acc: 0.795 Test Loss: 0.636 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2227892875671387
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.651 Vali Acc: 0.805 Test Loss: 0.651 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1963677406311035
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.844 Vali Acc: 0.768 Test Loss: 0.844 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.2726988792419434
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.719 Vali Acc: 0.816 Test Loss: 0.719 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 100098
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.429555892944336
Epoch: 1, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.435 Vali Acc: 0.826 Test Loss: 0.435 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 1.7909789085388184
Epoch: 2, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.439 Vali Acc: 0.792 Test Loss: 0.439 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.060420036315918
Epoch: 3, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.022855281829834
Epoch: 4, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.413 Vali Acc: 0.819 Test Loss: 0.413 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7612760066986084
Epoch: 5, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.440 Vali Acc: 0.809 Test Loss: 0.440 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8837292194366455
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.496 Vali Acc: 0.795 Test Loss: 0.496 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7390387058258057
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.451 Vali Acc: 0.833 Test Loss: 0.451 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 8 cost time: 1.7349612712860107
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.528 Vali Acc: 0.805 Test Loss: 0.528 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9837932586669922
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.479 Vali Acc: 0.840 Test Loss: 0.479 Test Acc: 0.840
Validation loss decreased (-0.832760 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.6620068550109863
Epoch: 10, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.586 Vali Acc: 0.799 Test Loss: 0.586 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.740678071975708
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.641 Vali Acc: 0.775 Test Loss: 0.641 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4984018802642822
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1661746501922607
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.611 Vali Acc: 0.805 Test Loss: 0.611 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.949974536895752
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.645 Vali Acc: 0.802 Test Loss: 0.645 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0849668979644775
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.651 Vali Acc: 0.816 Test Loss: 0.651 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.482522487640381
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.744 Vali Acc: 0.785 Test Loss: 0.744 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.105534315109253
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.742 Vali Acc: 0.802 Test Loss: 0.742 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.69911527633667
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.846 Vali Acc: 0.771 Test Loss: 0.846 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7115137577056885
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 96130
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.526305437088013
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.531 Vali Acc: 0.771 Test Loss: 0.531 Test Acc: 0.771
Validation loss decreased (inf --> -0.771326).  Saving model ...
Epoch: 2 cost time: 1.6706089973449707
Epoch: 2, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.427 Vali Acc: 0.809 Test Loss: 0.427 Test Acc: 0.809
Validation loss decreased (-0.771326 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.5911424160003662
Epoch: 3, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.411 Vali Acc: 0.805 Test Loss: 0.411 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7801682949066162
Epoch: 4, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
Validation loss decreased (-0.808869 --> -0.825935).  Saving model ...
Epoch: 5 cost time: 1.6095709800720215
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.411 Vali Acc: 0.802 Test Loss: 0.411 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8614602088928223
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.377 Vali Acc: 0.850 Test Loss: 0.377 Test Acc: 0.850
Validation loss decreased (-0.825935 --> -0.849826).  Saving model ...
Epoch: 7 cost time: 1.5776028633117676
Epoch: 7, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.479 Vali Acc: 0.788 Test Loss: 0.479 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5519750118255615
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5512042045593262
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.447 Vali Acc: 0.819 Test Loss: 0.447 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7385928630828857
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.500 Vali Acc: 0.819 Test Loss: 0.500 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5981884002685547
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.504 Vali Acc: 0.823 Test Loss: 0.504 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.137721300125122
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.567 Vali Acc: 0.799 Test Loss: 0.567 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6074206829071045
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6345326900482178
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.569 Vali Acc: 0.829 Test Loss: 0.569 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6354126930236816
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.665 Vali Acc: 0.795 Test Loss: 0.665 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.766901969909668
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.571 Vali Acc: 0.826 Test Loss: 0.571 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 94402
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.975608825683594
Epoch: 1, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.518 Vali Acc: 0.768 Test Loss: 0.518 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.8101208209991455
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
Validation loss decreased (-0.767913 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 1.9368352890014648
Epoch: 3, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.461 Vali Acc: 0.792 Test Loss: 0.461 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.037548065185547
Epoch: 4, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.364 Vali Acc: 0.846 Test Loss: 0.364 Test Acc: 0.846
Validation loss decreased (-0.825934 --> -0.846413).  Saving model ...
Epoch: 5 cost time: 2.056652069091797
Epoch: 5, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.375 Vali Acc: 0.836 Test Loss: 0.375 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0614633560180664
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.469 Vali Acc: 0.795 Test Loss: 0.469 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2888307571411133
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.341 Vali Acc: 0.867 Test Loss: 0.341 Test Acc: 0.867
Validation loss decreased (-0.846413 --> -0.866891).  Saving model ...
Epoch: 8 cost time: 1.9827663898468018
Epoch: 8, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.349149703979492
Epoch: 9, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.433 Vali Acc: 0.816 Test Loss: 0.433 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9618949890136719
Epoch: 10, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.396 Vali Acc: 0.857 Test Loss: 0.396 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9313302040100098
Epoch: 11, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.004199743270874
Epoch: 12, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.573 Vali Acc: 0.792 Test Loss: 0.573 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.201587677001953
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.523 Vali Acc: 0.819 Test Loss: 0.523 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.972714900970459
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9954545497894287
Epoch: 15, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.714 Vali Acc: 0.761 Test Loss: 0.714 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9670367240905762
Epoch: 16, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3112359046936035
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.580 Vali Acc: 0.805 Test Loss: 0.580 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 94210
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.424369812011719
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.606 Vali Acc: 0.662 Test Loss: 0.606 Test Acc: 0.662
Validation loss decreased (inf --> -0.662110).  Saving model ...
Epoch: 2 cost time: 1.7912580966949463
Epoch: 2, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.416 Vali Acc: 0.809 Test Loss: 0.416 Test Acc: 0.809
Validation loss decreased (-0.662110 --> -0.808870).  Saving model ...
Epoch: 3 cost time: 2.198831796646118
Epoch: 3, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.423 Vali Acc: 0.792 Test Loss: 0.423 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0167174339294434
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.418 Vali Acc: 0.802 Test Loss: 0.418 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7680225372314453
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.383 Vali Acc: 0.826 Test Loss: 0.383 Test Acc: 0.826
Validation loss decreased (-0.808870 --> -0.825935).  Saving model ...
Epoch: 6 cost time: 1.7192113399505615
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.425 Vali Acc: 0.805 Test Loss: 0.425 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.791628360748291
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
Validation loss decreased (-0.825935 --> -0.836174).  Saving model ...
Epoch: 8 cost time: 1.9157743453979492
Epoch: 8, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.411 Vali Acc: 0.819 Test Loss: 0.411 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7634179592132568
Epoch: 9, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0241384506225586
Epoch: 10, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9061129093170166
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.062535524368286
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.689493179321289
Epoch: 13, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.469 Vali Acc: 0.826 Test Loss: 0.469 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6879017353057861
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.458 Vali Acc: 0.836 Test Loss: 0.458 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6117832660675049
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0341732501983643
Epoch: 16, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.613 Vali Acc: 0.788 Test Loss: 0.613 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8732318878173828
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.476 Vali Acc: 0.833 Test Loss: 0.476 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm64_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 96258
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.1205830574035645
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.467 Vali Acc: 0.795 Test Loss: 0.467 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 1.9707436561584473
Epoch: 2, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.384 Vali Acc: 0.812 Test Loss: 0.384 Test Acc: 0.812
Validation loss decreased (-0.795217 --> -0.812283).  Saving model ...
Epoch: 3 cost time: 2.539611339569092
Epoch: 3, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.402 Vali Acc: 0.809 Test Loss: 0.402 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4099669456481934
Epoch: 4, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.595 Vali Acc: 0.747 Test Loss: 0.595 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1214828491210938
Epoch: 5, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.474 Vali Acc: 0.816 Test Loss: 0.474 Test Acc: 0.816
Validation loss decreased (-0.812283 --> -0.815695).  Saving model ...
Epoch: 6 cost time: 2.177380323410034
Epoch: 6, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.509 Vali Acc: 0.792 Test Loss: 0.509 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.248835802078247
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.580 Vali Acc: 0.782 Test Loss: 0.580 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.093261957168579
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.535 Vali Acc: 0.823 Test Loss: 0.535 Test Acc: 0.823
Validation loss decreased (-0.815695 --> -0.822520).  Saving model ...
Epoch: 9 cost time: 2.624739408493042
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.645 Vali Acc: 0.799 Test Loss: 0.645 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3590023517608643
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.652 Vali Acc: 0.792 Test Loss: 0.652 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.952648878097534
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5751302242279053
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.823 Vali Acc: 0.778 Test Loss: 0.823 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7765395641326904
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.813 Vali Acc: 0.785 Test Loss: 0.813 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.552725076675415
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.623835802078247
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.943 Vali Acc: 0.771 Test Loss: 0.943 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.512650966644287
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.810 Vali Acc: 0.819 Test Loss: 0.810 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4493908882141113
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.062 Vali Acc: 0.754 Test Loss: 1.062 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4415018558502197
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.836 Vali Acc: 0.826 Test Loss: 0.836 Test Acc: 0.826
Validation loss decreased (-0.822520 --> -0.825930).  Saving model ...
Epoch: 19 cost time: 2.570753335952759
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.969 Vali Acc: 0.802 Test Loss: 0.969 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.037876844406128
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.036 Vali Acc: 0.788 Test Loss: 1.036 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.53572416305542
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.334 Vali Acc: 0.754 Test Loss: 1.334 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2977285385131836
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.132 Vali Acc: 0.785 Test Loss: 1.132 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4844839572906494
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.018 Vali Acc: 0.792 Test Loss: 1.018 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3230347633361816
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.312 Vali Acc: 0.771 Test Loss: 1.312 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.154146909713745
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.247 Vali Acc: 0.775 Test Loss: 1.247 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.429781913757324
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.087 Vali Acc: 0.782 Test Loss: 1.087 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.4764926433563232
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.765 Test Loss: 1.221 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.055907726287842
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.337 Vali Acc: 0.758 Test Loss: 1.337 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 92290
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.83346962928772
Epoch: 1, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.575 Vali Acc: 0.734 Test Loss: 0.575 Test Acc: 0.734
Validation loss decreased (inf --> -0.733783).  Saving model ...
Epoch: 2 cost time: 1.833463191986084
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.440 Vali Acc: 0.768 Test Loss: 0.440 Test Acc: 0.768
Validation loss decreased (-0.733783 --> -0.767914).  Saving model ...
Epoch: 3 cost time: 1.796262502670288
Epoch: 3, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
Validation loss decreased (-0.767914 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 2.101426124572754
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.419 Vali Acc: 0.823 Test Loss: 0.419 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3567240238189697
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.077493667602539
Epoch: 6, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.410 Vali Acc: 0.812 Test Loss: 0.410 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6586427688598633
Epoch: 7, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.434 Vali Acc: 0.826 Test Loss: 0.434 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825934).  Saving model ...
Epoch: 8 cost time: 1.5950486660003662
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.042731761932373
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.443 Vali Acc: 0.819 Test Loss: 0.443 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1738076210021973
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8928937911987305
Epoch: 11, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.495 Vali Acc: 0.812 Test Loss: 0.495 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0174968242645264
Epoch: 12, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.562 Vali Acc: 0.809 Test Loss: 0.562 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0946125984191895
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.159058094024658
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.625 Vali Acc: 0.816 Test Loss: 0.625 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6064739227294922
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.694 Vali Acc: 0.782 Test Loss: 0.694 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9250006675720215
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.612 Vali Acc: 0.829 Test Loss: 0.612 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829345).  Saving model ...
Epoch: 17 cost time: 1.7007596492767334
Epoch: 17, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.795 Vali Acc: 0.802 Test Loss: 0.795 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8590078353881836
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6804454326629639
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.717 Vali Acc: 0.816 Test Loss: 0.717 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5789225101470947
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.863 Vali Acc: 0.788 Test Loss: 0.863 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7521045207977295
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.836 Vali Acc: 0.795 Test Loss: 0.836 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7191483974456787
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.832 Vali Acc: 0.795 Test Loss: 0.832 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.620589017868042
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.840 Vali Acc: 0.805 Test Loss: 0.840 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9109294414520264
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.856 Vali Acc: 0.805 Test Loss: 0.856 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8886942863464355
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.823 Test Loss: 0.802 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7299933433532715
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.028 Vali Acc: 0.768 Test Loss: 1.028 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 79554
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.612845182418823
Epoch: 1, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.519 Vali Acc: 0.768 Test Loss: 0.519 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.9535260200500488
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
Validation loss decreased (-0.767913 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 2.137356996536255
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.444 Vali Acc: 0.799 Test Loss: 0.444 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5722637176513672
Epoch: 4, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.730522871017456
Epoch: 5, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.423 Vali Acc: 0.816 Test Loss: 0.423 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.577895164489746
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.419 Vali Acc: 0.816 Test Loss: 0.419 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1069211959838867
Epoch: 7, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.449 Vali Acc: 0.795 Test Loss: 0.449 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.019623279571533
Epoch: 8, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.497 Vali Acc: 0.778 Test Loss: 0.497 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9731550216674805
Epoch: 9, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.477 Vali Acc: 0.795 Test Loss: 0.477 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.971588134765625
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.756608247756958
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.492 Vali Acc: 0.799 Test Loss: 0.492 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.405552625656128
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.471 Vali Acc: 0.823 Test Loss: 0.471 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 75298
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.582420587539673
Epoch: 1, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.644 Vali Acc: 0.631 Test Loss: 0.644 Test Acc: 0.631
Validation loss decreased (inf --> -0.631393).  Saving model ...
Epoch: 2 cost time: 1.6942546367645264
Epoch: 2, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.467 Vali Acc: 0.795 Test Loss: 0.467 Test Acc: 0.795
Validation loss decreased (-0.631393 --> -0.795217).  Saving model ...
Epoch: 3 cost time: 2.1606924533843994
Epoch: 3, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
Validation loss decreased (-0.795217 --> -0.829347).  Saving model ...
Epoch: 4 cost time: 1.791581153869629
Epoch: 4, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.443 Vali Acc: 0.799 Test Loss: 0.443 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8838269710540771
Epoch: 5, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.404 Vali Acc: 0.805 Test Loss: 0.404 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7840328216552734
Epoch: 6, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7992663383483887
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.446 Vali Acc: 0.812 Test Loss: 0.446 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.800586223602295
Epoch: 8, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.449 Vali Acc: 0.812 Test Loss: 0.449 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8172295093536377
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.478 Vali Acc: 0.816 Test Loss: 0.478 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.13101863861084
Epoch: 10, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832760).  Saving model ...
Epoch: 11 cost time: 1.7458198070526123
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.438 Vali Acc: 0.850 Test Loss: 0.438 Test Acc: 0.850
Validation loss decreased (-0.832760 --> -0.849825).  Saving model ...
Epoch: 12 cost time: 1.800553321838379
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.484 Vali Acc: 0.836 Test Loss: 0.484 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7587285041809082
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.483 Vali Acc: 0.829 Test Loss: 0.483 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6064505577087402
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6222102642059326
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.510 Vali Acc: 0.826 Test Loss: 0.510 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7321221828460693
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.559 Vali Acc: 0.823 Test Loss: 0.559 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7259211540222168
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.506 Vali Acc: 0.829 Test Loss: 0.506 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9040062427520752
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7245304584503174
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.563 Vali Acc: 0.805 Test Loss: 0.563 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7644917964935303
Epoch: 20, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.560 Vali Acc: 0.816 Test Loss: 0.560 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8440592288970947
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.578 Vali Acc: 0.823 Test Loss: 0.578 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 73314
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.72380805015564
Epoch: 1, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.589 Vali Acc: 0.693 Test Loss: 0.589 Test Acc: 0.693
Validation loss decreased (inf --> -0.692827).  Saving model ...
Epoch: 2 cost time: 1.9173994064331055
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
Validation loss decreased (-0.692827 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 2.1572351455688477
Epoch: 3, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.358 Vali Acc: 0.850 Test Loss: 0.358 Test Acc: 0.850
Validation loss decreased (-0.808869 --> -0.849826).  Saving model ...
Epoch: 4 cost time: 2.0712616443634033
Epoch: 4, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.440 Vali Acc: 0.785 Test Loss: 0.440 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8372466564178467
Epoch: 5, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.424 Vali Acc: 0.792 Test Loss: 0.424 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.310194492340088
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.376 Vali Acc: 0.840 Test Loss: 0.376 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8911621570587158
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.428 Vali Acc: 0.812 Test Loss: 0.428 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1147687435150146
Epoch: 8, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.388 Vali Acc: 0.840 Test Loss: 0.388 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0099236965179443
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.378 Vali Acc: 0.840 Test Loss: 0.378 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.982344150543213
Epoch: 10, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.400 Vali Acc: 0.836 Test Loss: 0.400 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.977259635925293
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.396 Vali Acc: 0.843 Test Loss: 0.396 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.155743360519409
Epoch: 12, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.490 Vali Acc: 0.816 Test Loss: 0.490 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.113696336746216
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.412 Vali Acc: 0.867 Test Loss: 0.412 Test Acc: 0.867
Validation loss decreased (-0.849826 --> -0.866890).  Saving model ...
Epoch: 14 cost time: 1.9753029346466064
Epoch: 14, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.406 Vali Acc: 0.853 Test Loss: 0.406 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1166775226593018
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.599 Vali Acc: 0.778 Test Loss: 0.599 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9860095977783203
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.423 Vali Acc: 0.853 Test Loss: 0.423 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1002490520477295
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.604 Vali Acc: 0.799 Test Loss: 0.604 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8278923034667969
Epoch: 18, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.512 Vali Acc: 0.829 Test Loss: 0.512 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0679304599761963
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.454 Vali Acc: 0.846 Test Loss: 0.454 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1659061908721924
Epoch: 20, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.826 Test Loss: 0.525 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8722317218780518
Epoch: 21, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.479 Vali Acc: 0.850 Test Loss: 0.479 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0342750549316406
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.587 Vali Acc: 0.805 Test Loss: 0.587 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0786640644073486
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.535 Vali Acc: 0.833 Test Loss: 0.535 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 72450
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.17608118057251
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 2.226407289505005
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.434 Vali Acc: 0.819 Test Loss: 0.434 Test Acc: 0.819
Validation loss decreased (-0.812282 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.4010076522827148
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.421 Vali Acc: 0.792 Test Loss: 0.421 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7167937755584717
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.398 Vali Acc: 0.812 Test Loss: 0.398 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1515305042266846
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.418 Vali Acc: 0.805 Test Loss: 0.418 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0267701148986816
Epoch: 6, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.359 Vali Acc: 0.826 Test Loss: 0.359 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 1.61814284324646
Epoch: 7, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.463 Vali Acc: 0.775 Test Loss: 0.463 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8361318111419678
Epoch: 8, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.359 Vali Acc: 0.840 Test Loss: 0.359 Test Acc: 0.840
Validation loss decreased (-0.825935 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.918802261352539
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.469 Vali Acc: 0.785 Test Loss: 0.469 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7451317310333252
Epoch: 10, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.400 Vali Acc: 0.840 Test Loss: 0.400 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6025454998016357
Epoch: 11, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.341 Vali Acc: 0.881 Test Loss: 0.341 Test Acc: 0.881
Validation loss decreased (-0.839587 --> -0.880543).  Saving model ...
Epoch: 12 cost time: 1.6285324096679688
Epoch: 12, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.531 Vali Acc: 0.782 Test Loss: 0.531 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.976334810256958
Epoch: 13, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.394 Vali Acc: 0.840 Test Loss: 0.394 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.515038251876831
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.443 Vali Acc: 0.823 Test Loss: 0.443 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6087465286254883
Epoch: 15, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.387 Vali Acc: 0.850 Test Loss: 0.387 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9755220413208008
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.389 Vali Acc: 0.867 Test Loss: 0.389 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7872645854949951
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.433 Vali Acc: 0.840 Test Loss: 0.433 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.005232334136963
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.511 Vali Acc: 0.795 Test Loss: 0.511 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8833284378051758
Epoch: 19, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.400 Vali Acc: 0.850 Test Loss: 0.400 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0730886459350586
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.428 Vali Acc: 0.846 Test Loss: 0.428 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1518871784210205
Epoch: 21, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.431 Vali Acc: 0.840 Test Loss: 0.431 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 72354
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.030234098434448
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.634 Vali Acc: 0.672 Test Loss: 0.634 Test Acc: 0.672
Validation loss decreased (inf --> -0.672349).  Saving model ...
Epoch: 2 cost time: 2.0589680671691895
Epoch: 2, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.492 Vali Acc: 0.778 Test Loss: 0.492 Test Acc: 0.778
Validation loss decreased (-0.672349 --> -0.778152).  Saving model ...
Epoch: 3 cost time: 1.8322606086730957
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.428 Vali Acc: 0.833 Test Loss: 0.428 Test Acc: 0.833
Validation loss decreased (-0.778152 --> -0.832760).  Saving model ...
Epoch: 4 cost time: 1.8040485382080078
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.420 Vali Acc: 0.812 Test Loss: 0.420 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6002418994903564
Epoch: 5, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.395 Vali Acc: 0.829 Test Loss: 0.395 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6655349731445312
Epoch: 6, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.461 Vali Acc: 0.758 Test Loss: 0.461 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7666356563568115
Epoch: 7, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.396 Vali Acc: 0.826 Test Loss: 0.396 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1034746170043945
Epoch: 8, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.478 Vali Acc: 0.761 Test Loss: 0.478 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6726865768432617
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.417 Vali Acc: 0.809 Test Loss: 0.417 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8758087158203125
Epoch: 10, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.370 Vali Acc: 0.836 Test Loss: 0.370 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836174).  Saving model ...
Epoch: 11 cost time: 2.1685903072357178
Epoch: 11, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.517 Vali Acc: 0.761 Test Loss: 0.517 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8170647621154785
Epoch: 12, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.358 Vali Acc: 0.863 Test Loss: 0.358 Test Acc: 0.863
Validation loss decreased (-0.836174 --> -0.863478).  Saving model ...
Epoch: 13 cost time: 1.8963258266448975
Epoch: 13, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.462 Vali Acc: 0.802 Test Loss: 0.462 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.959289312362671
Epoch: 14, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.477 Vali Acc: 0.819 Test Loss: 0.477 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8291904926300049
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.433 Vali Acc: 0.843 Test Loss: 0.433 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7697038650512695
Epoch: 16, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
Validation loss decreased (-0.863478 --> -0.866890).  Saving model ...
Epoch: 17 cost time: 1.914729118347168
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.539 Vali Acc: 0.795 Test Loss: 0.539 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8302929401397705
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.467 Vali Acc: 0.823 Test Loss: 0.467 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9865188598632812
Epoch: 19, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.433 Vali Acc: 0.853 Test Loss: 0.433 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7681822776794434
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7233963012695312
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.485 Vali Acc: 0.833 Test Loss: 0.485 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2650835514068604
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.631 Vali Acc: 0.785 Test Loss: 0.631 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9269542694091797
Epoch: 23, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2433900833129883
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8563477993011475
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8200087547302246
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.606 Vali Acc: 0.802 Test Loss: 0.606 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 73378
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.025213241577148
Epoch: 1, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.460 Vali Acc: 0.833 Test Loss: 0.460 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.72869873046875
Epoch: 2, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.400 Vali Acc: 0.846 Test Loss: 0.400 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 3 cost time: 1.7499771118164062
Epoch: 3, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.429 Vali Acc: 0.826 Test Loss: 0.429 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9349799156188965
Epoch: 4, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.456 Vali Acc: 0.799 Test Loss: 0.456 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4373364448547363
Epoch: 5, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.620 Vali Acc: 0.751 Test Loss: 0.620 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1184380054473877
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.431 Vali Acc: 0.826 Test Loss: 0.431 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.061934471130371
Epoch: 7, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.440 Vali Acc: 0.840 Test Loss: 0.440 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.452254056930542
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.376490592956543
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.531 Vali Acc: 0.836 Test Loss: 0.531 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8667678833007812
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.879 Vali Acc: 0.734 Test Loss: 0.879 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9187984466552734
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.691 Vali Acc: 0.785 Test Loss: 0.691 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1199469566345215
Epoch: 12, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.678 Vali Acc: 0.788 Test Loss: 0.678 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 67330
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.365631341934204
Epoch: 1, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.578 Vali Acc: 0.693 Test Loss: 0.578 Test Acc: 0.693
Validation loss decreased (inf --> -0.692827).  Saving model ...
Epoch: 2 cost time: 1.941786766052246
Epoch: 2, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
Validation loss decreased (-0.692827 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.836125135421753
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.465 Vali Acc: 0.792 Test Loss: 0.465 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.96290922164917
Epoch: 4, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.457 Vali Acc: 0.799 Test Loss: 0.457 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9752748012542725
Epoch: 5, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.422 Vali Acc: 0.805 Test Loss: 0.422 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.922314167022705
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.406 Vali Acc: 0.816 Test Loss: 0.406 Test Acc: 0.816
Validation loss decreased (-0.808869 --> -0.815696).  Saving model ...
Epoch: 7 cost time: 1.5726261138916016
Epoch: 7, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.466 Vali Acc: 0.819 Test Loss: 0.466 Test Acc: 0.819
Validation loss decreased (-0.815696 --> -0.819108).  Saving model ...
Epoch: 8 cost time: 1.5434536933898926
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.485 Vali Acc: 0.802 Test Loss: 0.485 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.95115327835083
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8443222045898438
Epoch: 10, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.511 Vali Acc: 0.826 Test Loss: 0.511 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825933).  Saving model ...
Epoch: 11 cost time: 2.1861462593078613
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.648 Vali Acc: 0.775 Test Loss: 0.648 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0192394256591797
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.636 Vali Acc: 0.795 Test Loss: 0.636 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8738222122192383
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8421695232391357
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.640 Vali Acc: 0.805 Test Loss: 0.640 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6966259479522705
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.624 Vali Acc: 0.819 Test Loss: 0.624 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.595212697982788
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.701 Vali Acc: 0.802 Test Loss: 0.701 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.710207223892212
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.709 Vali Acc: 0.805 Test Loss: 0.709 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5236029624938965
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.733842134475708
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.718 Vali Acc: 0.812 Test Loss: 0.718 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8855834007263184
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.799 Vali Acc: 0.805 Test Loss: 0.799 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 54594
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.004928827285767
Epoch: 1, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.533 Vali Acc: 0.771 Test Loss: 0.533 Test Acc: 0.771
Validation loss decreased (inf --> -0.771326).  Saving model ...
Epoch: 2 cost time: 1.788128137588501
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
Validation loss decreased (-0.771326 --> -0.808869).  Saving model ...
Epoch: 3 cost time: 1.576613426208496
Epoch: 3, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.445 Vali Acc: 0.805 Test Loss: 0.445 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6997613906860352
Epoch: 4, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.371 Vali Acc: 0.846 Test Loss: 0.371 Test Acc: 0.846
Validation loss decreased (-0.808869 --> -0.846413).  Saving model ...
Epoch: 5 cost time: 1.594170093536377
Epoch: 5, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8592901229858398
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.808030605316162
Epoch: 7, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8496177196502686
Epoch: 8, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.464 Vali Acc: 0.812 Test Loss: 0.464 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7132246494293213
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.517 Vali Acc: 0.792 Test Loss: 0.517 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.789027214050293
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.486 Vali Acc: 0.799 Test Loss: 0.486 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5923738479614258
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.510 Vali Acc: 0.799 Test Loss: 0.510 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5272819995880127
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.532 Vali Acc: 0.802 Test Loss: 0.532 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.540884256362915
Epoch: 13, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.486 Vali Acc: 0.833 Test Loss: 0.486 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6083877086639404
Epoch: 14, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.576 Vali Acc: 0.785 Test Loss: 0.576 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 50338
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.090728282928467
Epoch: 1, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.509 Vali Acc: 0.754 Test Loss: 0.509 Test Acc: 0.754
Validation loss decreased (inf --> -0.754261).  Saving model ...
Epoch: 2 cost time: 1.627821922302246
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.441 Vali Acc: 0.788 Test Loss: 0.441 Test Acc: 0.788
Validation loss decreased (-0.754261 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 1.7541205883026123
Epoch: 3, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.433 Vali Acc: 0.802 Test Loss: 0.433 Test Acc: 0.802
Validation loss decreased (-0.788391 --> -0.802043).  Saving model ...
Epoch: 4 cost time: 1.6570756435394287
Epoch: 4, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.429 Vali Acc: 0.792 Test Loss: 0.429 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6408443450927734
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.389 Vali Acc: 0.812 Test Loss: 0.389 Test Acc: 0.812
Validation loss decreased (-0.802043 --> -0.812283).  Saving model ...
Epoch: 6 cost time: 1.863194465637207
Epoch: 6, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.409 Vali Acc: 0.819 Test Loss: 0.409 Test Acc: 0.819
Validation loss decreased (-0.812283 --> -0.819109).  Saving model ...
Epoch: 7 cost time: 1.4788768291473389
Epoch: 7, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.433 Vali Acc: 0.799 Test Loss: 0.433 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5663378238677979
Epoch: 8, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.419 Vali Acc: 0.823 Test Loss: 0.419 Test Acc: 0.823
Validation loss decreased (-0.819109 --> -0.822521).  Saving model ...
Epoch: 9 cost time: 1.9634346961975098
Epoch: 9, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.415 Vali Acc: 0.812 Test Loss: 0.415 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8094873428344727
Epoch: 10, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.454 Vali Acc: 0.805 Test Loss: 0.454 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6704180240631104
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.513 Vali Acc: 0.788 Test Loss: 0.513 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9498846530914307
Epoch: 12, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0171875953674316
Epoch: 13, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.505 Vali Acc: 0.792 Test Loss: 0.505 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0158004760742188
Epoch: 14, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.545 Vali Acc: 0.792 Test Loss: 0.545 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9278309345245361
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825934).  Saving model ...
Epoch: 16 cost time: 1.7960619926452637
Epoch: 16, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.545 Vali Acc: 0.805 Test Loss: 0.545 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7065253257751465
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.566 Vali Acc: 0.805 Test Loss: 0.566 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6400022506713867
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.816 Test Loss: 0.572 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7715346813201904
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.684 Vali Acc: 0.778 Test Loss: 0.684 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6287946701049805
Epoch: 20, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6969695091247559
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.627 Vali Acc: 0.812 Test Loss: 0.627 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6117043495178223
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.713 Vali Acc: 0.788 Test Loss: 0.713 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6321349143981934
Epoch: 23, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.605 Vali Acc: 0.823 Test Loss: 0.605 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6745555400848389
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6349997520446777
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.723 Vali Acc: 0.782 Test Loss: 0.723 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 48354
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.021666049957275
Epoch: 1, Steps: 17 | Train Loss: 0.679 Vali Loss: 0.518 Vali Acc: 0.778 Test Loss: 0.518 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 1.7966399192810059
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.426 Vali Acc: 0.823 Test Loss: 0.426 Test Acc: 0.823
Validation loss decreased (-0.778152 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.894866943359375
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.396 Vali Acc: 0.826 Test Loss: 0.396 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825935).  Saving model ...
Epoch: 4 cost time: 1.6814343929290771
Epoch: 4, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.434 Vali Acc: 0.792 Test Loss: 0.434 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6679024696350098
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.356 Vali Acc: 0.836 Test Loss: 0.356 Test Acc: 0.836
Validation loss decreased (-0.825935 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 1.8225622177124023
Epoch: 6, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.401 Vali Acc: 0.819 Test Loss: 0.401 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9353907108306885
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.417 Vali Acc: 0.816 Test Loss: 0.417 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.744398593902588
Epoch: 8, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.369 Vali Acc: 0.836 Test Loss: 0.369 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0399210453033447
Epoch: 9, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.413 Vali Acc: 0.819 Test Loss: 0.413 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0776162147521973
Epoch: 10, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.432 Vali Acc: 0.805 Test Loss: 0.432 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0360031127929688
Epoch: 11, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.424 Vali Acc: 0.823 Test Loss: 0.424 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.554743528366089
Epoch: 12, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.404 Vali Acc: 0.829 Test Loss: 0.404 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9417695999145508
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.417 Vali Acc: 0.826 Test Loss: 0.417 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9104645252227783
Epoch: 14, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.245023012161255
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 47490
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.549691438674927
Epoch: 1, Steps: 17 | Train Loss: 0.653 Vali Loss: 0.503 Vali Acc: 0.816 Test Loss: 0.503 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.8741967678070068
Epoch: 2, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.422 Vali Acc: 0.812 Test Loss: 0.422 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6647028923034668
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.399 Vali Acc: 0.816 Test Loss: 0.399 Test Acc: 0.816
Validation loss decreased (-0.815695 --> -0.815696).  Saving model ...
Epoch: 4 cost time: 1.7248258590698242
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.393 Vali Acc: 0.816 Test Loss: 0.393 Test Acc: 0.816
Validation loss decreased (-0.815696 --> -0.815696).  Saving model ...
Epoch: 5 cost time: 1.6777863502502441
Epoch: 5, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.380 Vali Acc: 0.836 Test Loss: 0.380 Test Acc: 0.836
Validation loss decreased (-0.815696 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 2.095898151397705
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.836174 --> -0.849826).  Saving model ...
Epoch: 7 cost time: 1.5363802909851074
Epoch: 7, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.382 Vali Acc: 0.853 Test Loss: 0.382 Test Acc: 0.853
Validation loss decreased (-0.849826 --> -0.853239).  Saving model ...
Epoch: 8 cost time: 2.1018526554107666
Epoch: 8, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.335 Vali Acc: 0.884 Test Loss: 0.335 Test Acc: 0.884
Validation loss decreased (-0.853239 --> -0.883956).  Saving model ...
Epoch: 9 cost time: 1.8990564346313477
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.411 Vali Acc: 0.812 Test Loss: 0.411 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.662278413772583
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9282801151275635
Epoch: 11, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.344 Vali Acc: 0.881 Test Loss: 0.344 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.519840955734253
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.427 Vali Acc: 0.819 Test Loss: 0.427 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9621493816375732
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.347 Vali Acc: 0.877 Test Loss: 0.347 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8531486988067627
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.354 Vali Acc: 0.881 Test Loss: 0.354 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8034443855285645
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8978540897369385
Epoch: 16, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.416 Vali Acc: 0.843 Test Loss: 0.416 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4812579154968262
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.393 Vali Acc: 0.857 Test Loss: 0.393 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6842288970947266
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 47394
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.892606258392334
Epoch: 1, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.572 Vali Acc: 0.720 Test Loss: 0.572 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 2.3596718311309814
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.507 Vali Acc: 0.730 Test Loss: 0.507 Test Acc: 0.730
Validation loss decreased (-0.720131 --> -0.730370).  Saving model ...
Epoch: 3 cost time: 2.166154384613037
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.443 Vali Acc: 0.785 Test Loss: 0.443 Test Acc: 0.785
Validation loss decreased (-0.730370 --> -0.784979).  Saving model ...
Epoch: 4 cost time: 1.7762277126312256
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.420 Vali Acc: 0.792 Test Loss: 0.420 Test Acc: 0.792
Validation loss decreased (-0.784979 --> -0.791805).  Saving model ...
Epoch: 5 cost time: 1.892592191696167
Epoch: 5, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.407 Vali Acc: 0.799 Test Loss: 0.407 Test Acc: 0.799
Validation loss decreased (-0.791805 --> -0.798631).  Saving model ...
Epoch: 6 cost time: 1.839245319366455
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.390 Vali Acc: 0.823 Test Loss: 0.390 Test Acc: 0.823
Validation loss decreased (-0.798631 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 1.9179115295410156
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.432 Vali Acc: 0.782 Test Loss: 0.432 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7177495956420898
Epoch: 8, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.440 Vali Acc: 0.802 Test Loss: 0.440 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7144241333007812
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.384 Vali Acc: 0.843 Test Loss: 0.384 Test Acc: 0.843
Validation loss decreased (-0.822522 --> -0.843000).  Saving model ...
Epoch: 10 cost time: 1.9243495464324951
Epoch: 10, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9274792671203613
Epoch: 11, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.444 Vali Acc: 0.823 Test Loss: 0.444 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4442641735076904
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.400 Vali Acc: 0.846 Test Loss: 0.400 Test Acc: 0.846
Validation loss decreased (-0.843000 --> -0.846412).  Saving model ...
Epoch: 13 cost time: 2.018951892852783
Epoch: 13, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.467 Vali Acc: 0.805 Test Loss: 0.467 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0043652057647705
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.472 Vali Acc: 0.802 Test Loss: 0.472 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8461203575134277
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.495 Vali Acc: 0.799 Test Loss: 0.495 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.939802646636963
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.457 Vali Acc: 0.826 Test Loss: 0.457 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.658715009689331
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.568 Vali Acc: 0.782 Test Loss: 0.568 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5776066780090332
Epoch: 18, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.523 Vali Acc: 0.799 Test Loss: 0.523 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8299016952514648
Epoch: 19, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.502 Vali Acc: 0.816 Test Loss: 0.502 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9031751155853271
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.626 Vali Acc: 0.768 Test Loss: 0.626 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.898205280303955
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7402493953704834
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.535 Vali Acc: 0.802 Test Loss: 0.535 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 48418
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.910905599594116
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.513 Vali Acc: 0.747 Test Loss: 0.513 Test Acc: 0.747
Validation loss decreased (inf --> -0.747435).  Saving model ...
Epoch: 2 cost time: 1.8980669975280762
Epoch: 2, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.451 Vali Acc: 0.805 Test Loss: 0.451 Test Acc: 0.805
Validation loss decreased (-0.747435 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.0837600231170654
Epoch: 3, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.576 Vali Acc: 0.792 Test Loss: 0.576 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.177668571472168
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.377 Vali Acc: 0.860 Test Loss: 0.377 Test Acc: 0.860
Validation loss decreased (-0.805456 --> -0.860064).  Saving model ...
Epoch: 5 cost time: 1.7734925746917725
Epoch: 5, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.486 Vali Acc: 0.795 Test Loss: 0.486 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2759907245635986
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.522 Vali Acc: 0.785 Test Loss: 0.522 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5537145137786865
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.504 Vali Acc: 0.805 Test Loss: 0.504 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.300318956375122
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.515 Vali Acc: 0.826 Test Loss: 0.515 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.114758253097534
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.630 Vali Acc: 0.795 Test Loss: 0.630 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4029524326324463
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.549 Vali Acc: 0.833 Test Loss: 0.549 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.181525707244873
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.659 Vali Acc: 0.816 Test Loss: 0.659 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3095860481262207
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9953267574310303
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.585 Vali Acc: 0.826 Test Loss: 0.585 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3137271404266357
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.834 Vali Acc: 0.782 Test Loss: 0.834 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 54850
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.910759449005127
Epoch: 1, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.538 Vali Acc: 0.792 Test Loss: 0.538 Test Acc: 0.792
Validation loss decreased (inf --> -0.791803).  Saving model ...
Epoch: 2 cost time: 1.8414530754089355
Epoch: 2, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.449 Vali Acc: 0.823 Test Loss: 0.449 Test Acc: 0.823
Validation loss decreased (-0.791803 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.470348596572876
Epoch: 3, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.452 Vali Acc: 0.799 Test Loss: 0.452 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6029891967773438
Epoch: 4, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.432 Vali Acc: 0.812 Test Loss: 0.432 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.522634506225586
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.472 Vali Acc: 0.782 Test Loss: 0.472 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.698042631149292
Epoch: 6, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.915377140045166
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.433 Vali Acc: 0.816 Test Loss: 0.433 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6246249675750732
Epoch: 8, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.517 Vali Acc: 0.778 Test Loss: 0.517 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2911086082458496
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.528 Vali Acc: 0.788 Test Loss: 0.528 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8752501010894775
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.512 Vali Acc: 0.805 Test Loss: 0.512 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.009892463684082
Epoch: 11, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.562 Vali Acc: 0.799 Test Loss: 0.562 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7828376293182373
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.595 Vali Acc: 0.792 Test Loss: 0.595 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8225255972696246
model parameter : 42114
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.129499435424805
Epoch: 1, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.602 Vali Acc: 0.696 Test Loss: 0.602 Test Acc: 0.696
Validation loss decreased (inf --> -0.696240).  Saving model ...
Epoch: 2 cost time: 1.8367314338684082
Epoch: 2, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.417 Vali Acc: 0.829 Test Loss: 0.417 Test Acc: 0.829
Validation loss decreased (-0.696240 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 1.8711457252502441
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.432 Vali Acc: 0.799 Test Loss: 0.432 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3467023372650146
Epoch: 4, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.149944543838501
Epoch: 5, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.429 Vali Acc: 0.785 Test Loss: 0.429 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.411180257797241
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.467 Vali Acc: 0.768 Test Loss: 0.467 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1444528102874756
Epoch: 7, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.443 Vali Acc: 0.795 Test Loss: 0.443 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3697550296783447
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0870001316070557
Epoch: 9, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.466 Vali Acc: 0.805 Test Loss: 0.466 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0405662059783936
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.516 Vali Acc: 0.778 Test Loss: 0.516 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1327807903289795
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2536580562591553
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.551 Vali Acc: 0.799 Test Loss: 0.551 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 37858
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.097687482833862
Epoch: 1, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.616 Vali Acc: 0.686 Test Loss: 0.616 Test Acc: 0.686
Validation loss decreased (inf --> -0.686001).  Saving model ...
Epoch: 2 cost time: 1.938788652420044
Epoch: 2, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.452 Vali Acc: 0.816 Test Loss: 0.452 Test Acc: 0.816
Validation loss decreased (-0.686001 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 1.7611558437347412
Epoch: 3, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.424 Vali Acc: 0.809 Test Loss: 0.424 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.623396635055542
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0216376781463623
Epoch: 5, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.443 Vali Acc: 0.812 Test Loss: 0.443 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.878706932067871
Epoch: 6, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.397 Vali Acc: 0.819 Test Loss: 0.397 Test Acc: 0.819
Validation loss decreased (-0.815695 --> -0.819109).  Saving model ...
Epoch: 7 cost time: 2.2933692932128906
Epoch: 7, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7587859630584717
Epoch: 8, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.466 Vali Acc: 0.795 Test Loss: 0.466 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.945056438446045
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.418 Vali Acc: 0.816 Test Loss: 0.418 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8935275077819824
Epoch: 10, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.422 Vali Acc: 0.809 Test Loss: 0.422 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6796796321868896
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.435 Vali Acc: 0.812 Test Loss: 0.435 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8720932006835938
Epoch: 12, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7420856952667236
Epoch: 13, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.562 Vali Acc: 0.761 Test Loss: 0.562 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6624114513397217
Epoch: 14, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.536 Vali Acc: 0.788 Test Loss: 0.536 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9696881771087646
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1966748237609863
Epoch: 16, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.559 Vali Acc: 0.805 Test Loss: 0.559 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8191126279863481
model parameter : 35874
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.44853663444519
Epoch: 1, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.578 Vali Acc: 0.713 Test Loss: 0.578 Test Acc: 0.713
Validation loss decreased (inf --> -0.713305).  Saving model ...
Epoch: 2 cost time: 1.5632319450378418
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.481 Vali Acc: 0.771 Test Loss: 0.481 Test Acc: 0.771
Validation loss decreased (-0.713305 --> -0.771326).  Saving model ...
Epoch: 3 cost time: 1.8157997131347656
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.415 Vali Acc: 0.809 Test Loss: 0.415 Test Acc: 0.809
Validation loss decreased (-0.771326 --> -0.808870).  Saving model ...
Epoch: 4 cost time: 1.7958784103393555
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.416 Vali Acc: 0.823 Test Loss: 0.416 Test Acc: 0.823
Validation loss decreased (-0.808870 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.9485774040222168
Epoch: 5, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1082305908203125
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 2.177297592163086
Epoch: 7, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.429 Vali Acc: 0.795 Test Loss: 0.429 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4022445678710938
Epoch: 8, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
Validation loss decreased (-0.822522 --> -0.832761).  Saving model ...
Epoch: 9 cost time: 1.7180569171905518
Epoch: 9, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.753394365310669
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.425 Vali Acc: 0.850 Test Loss: 0.425 Test Acc: 0.850
Validation loss decreased (-0.832761 --> -0.849825).  Saving model ...
Epoch: 11 cost time: 1.6224796772003174
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.849825 --> -0.849825).  Saving model ...
Epoch: 12 cost time: 1.6951313018798828
Epoch: 12, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.444 Vali Acc: 0.816 Test Loss: 0.444 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.750805139541626
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.391 Vali Acc: 0.863 Test Loss: 0.391 Test Acc: 0.863
Validation loss decreased (-0.849825 --> -0.863477).  Saving model ...
Epoch: 14 cost time: 1.6662468910217285
Epoch: 14, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.522 Vali Acc: 0.802 Test Loss: 0.522 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.704636573791504
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.403 Vali Acc: 0.857 Test Loss: 0.403 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7221431732177734
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.459 Vali Acc: 0.843 Test Loss: 0.459 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1204235553741455
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.474 Vali Acc: 0.829 Test Loss: 0.474 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6606595516204834
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.482 Vali Acc: 0.840 Test Loss: 0.482 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8658421039581299
Epoch: 19, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.735835313796997
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.460 Vali Acc: 0.853 Test Loss: 0.460 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5120704174041748
Epoch: 21, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6370413303375244
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.502 Vali Acc: 0.840 Test Loss: 0.502 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5939123630523682
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.537 Vali Acc: 0.833 Test Loss: 0.537 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 35010
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.800266265869141
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.617 Vali Acc: 0.594 Test Loss: 0.617 Test Acc: 0.594
Validation loss decreased (inf --> -0.593850).  Saving model ...
Epoch: 2 cost time: 1.545039415359497
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.460 Vali Acc: 0.823 Test Loss: 0.460 Test Acc: 0.823
Validation loss decreased (-0.593850 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 2.062778949737549
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.408 Vali Acc: 0.829 Test Loss: 0.408 Test Acc: 0.829
Validation loss decreased (-0.822521 --> -0.829347).  Saving model ...
Epoch: 4 cost time: 2.198359489440918
Epoch: 4, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.354 Vali Acc: 0.863 Test Loss: 0.354 Test Acc: 0.863
Validation loss decreased (-0.829347 --> -0.863478).  Saving model ...
Epoch: 5 cost time: 2.075188636779785
Epoch: 5, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.202401876449585
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.377 Vali Acc: 0.846 Test Loss: 0.377 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0331172943115234
Epoch: 7, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.351 Vali Acc: 0.863 Test Loss: 0.351 Test Acc: 0.863
Validation loss decreased (-0.863478 --> -0.863478).  Saving model ...
Epoch: 8 cost time: 1.9134156703948975
Epoch: 8, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.370 Vali Acc: 0.833 Test Loss: 0.370 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0110902786254883
Epoch: 9, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.326 Vali Acc: 0.877 Test Loss: 0.326 Test Acc: 0.877
Validation loss decreased (-0.863478 --> -0.877130).  Saving model ...
Epoch: 10 cost time: 1.8997156620025635
Epoch: 10, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.367 Vali Acc: 0.840 Test Loss: 0.367 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6631250381469727
Epoch: 11, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.350 Vali Acc: 0.857 Test Loss: 0.350 Test Acc: 0.857
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9185011386871338
Epoch: 12, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.344 Vali Acc: 0.870 Test Loss: 0.344 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7484819889068604
Epoch: 13, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.365 Vali Acc: 0.863 Test Loss: 0.365 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9896836280822754
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.357 Vali Acc: 0.867 Test Loss: 0.357 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.001371145248413
Epoch: 15, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.373 Vali Acc: 0.857 Test Loss: 0.373 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.210292339324951
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.127267360687256
Epoch: 17, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8223376274108887
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.413 Vali Acc: 0.840 Test Loss: 0.413 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9540836811065674
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.424 Vali Acc: 0.843 Test Loss: 0.424 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 34914
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.9815452098846436
Epoch: 1, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.552 Vali Acc: 0.765 Test Loss: 0.552 Test Acc: 0.765
Validation loss decreased (inf --> -0.764500).  Saving model ...
Epoch: 2 cost time: 1.6042773723602295
Epoch: 2, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
Validation loss decreased (-0.764500 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.6374554634094238
Epoch: 3, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.368 Vali Acc: 0.823 Test Loss: 0.368 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8643016815185547
Epoch: 4, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.359 Vali Acc: 0.816 Test Loss: 0.359 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8847277164459229
Epoch: 5, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.389 Vali Acc: 0.826 Test Loss: 0.389 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.263394594192505
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.363 Vali Acc: 0.836 Test Loss: 0.363 Test Acc: 0.836
Validation loss decreased (-0.836173 --> -0.836174).  Saving model ...
Epoch: 7 cost time: 1.895733118057251
Epoch: 7, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.355 Vali Acc: 0.853 Test Loss: 0.355 Test Acc: 0.853
Validation loss decreased (-0.836174 --> -0.853239).  Saving model ...
Epoch: 8 cost time: 1.588179588317871
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.402 Vali Acc: 0.823 Test Loss: 0.402 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9322288036346436
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.371 Vali Acc: 0.836 Test Loss: 0.371 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5692989826202393
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.383 Vali Acc: 0.843 Test Loss: 0.383 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.70052170753479
Epoch: 11, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.367 Vali Acc: 0.846 Test Loss: 0.367 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5067617893218994
Epoch: 12, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.402 Vali Acc: 0.840 Test Loss: 0.402 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0677876472473145
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.404 Vali Acc: 0.846 Test Loss: 0.404 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8140387535095215
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.372 Vali Acc: 0.860 Test Loss: 0.372 Test Acc: 0.860
Validation loss decreased (-0.853239 --> -0.860065).  Saving model ...
Epoch: 15 cost time: 1.7381553649902344
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.411 Vali Acc: 0.840 Test Loss: 0.411 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6674613952636719
Epoch: 16, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.431 Vali Acc: 0.843 Test Loss: 0.431 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9730703830718994
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.410 Vali Acc: 0.857 Test Loss: 0.410 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6235980987548828
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.473 Vali Acc: 0.823 Test Loss: 0.473 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9152412414550781
Epoch: 19, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.399 Vali Acc: 0.857 Test Loss: 0.399 Test Acc: 0.857
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8248991966247559
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.10923433303833
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.393 Vali Acc: 0.870 Test Loss: 0.393 Test Acc: 0.870
Validation loss decreased (-0.860065 --> -0.870303).  Saving model ...
Epoch: 22 cost time: 1.8324663639068604
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6693439483642578
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.452 Vali Acc: 0.843 Test Loss: 0.452 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7330305576324463
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.516 Vali Acc: 0.840 Test Loss: 0.516 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7739348411560059
Epoch: 25, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8547327518463135
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.508 Vali Acc: 0.836 Test Loss: 0.508 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.880415439605713
Epoch: 27, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.585 Vali Acc: 0.823 Test Loss: 0.585 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1563363075256348
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.526 Vali Acc: 0.836 Test Loss: 0.526 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9707911014556885
Epoch: 29, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.800830364227295
Epoch: 30, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.491 Vali Acc: 0.846 Test Loss: 0.491 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7190277576446533
Epoch: 31, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.620 Vali Acc: 0.802 Test Loss: 0.620 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm32_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 35938
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.183894634246826
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.523 Vali Acc: 0.775 Test Loss: 0.523 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.8329057693481445
Epoch: 2, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.450 Vali Acc: 0.782 Test Loss: 0.450 Test Acc: 0.782
Validation loss decreased (-0.774739 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 1.9906606674194336
Epoch: 3, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
Validation loss decreased (-0.781565 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 1.9201831817626953
Epoch: 4, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.391 Vali Acc: 0.823 Test Loss: 0.391 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0547399520874023
Epoch: 5, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.406 Vali Acc: 0.812 Test Loss: 0.406 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.365955114364624
Epoch: 6, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.472 Vali Acc: 0.778 Test Loss: 0.472 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0333261489868164
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.407 Vali Acc: 0.816 Test Loss: 0.407 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4314262866973877
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.490 Vali Acc: 0.795 Test Loss: 0.490 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.978651523590088
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.522 Vali Acc: 0.771 Test Loss: 0.522 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8214447498321533
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.572 Vali Acc: 0.782 Test Loss: 0.572 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9341979026794434
Epoch: 11, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.537 Vali Acc: 0.819 Test Loss: 0.537 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3825457096099854
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.626 Vali Acc: 0.795 Test Loss: 0.626 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.229400634765625
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.673 Vali Acc: 0.768 Test Loss: 0.673 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 43458
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.587455749511719
Epoch: 1, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
Validation loss decreased (inf --> -0.750848).  Saving model ...
Epoch: 2 cost time: 1.7526965141296387
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.453 Vali Acc: 0.775 Test Loss: 0.453 Test Acc: 0.775
Validation loss decreased (-0.750848 --> -0.774739).  Saving model ...
Epoch: 3 cost time: 2.147987127304077
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
Validation loss decreased (-0.774739 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.4972469806671143
Epoch: 4, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.431 Vali Acc: 0.802 Test Loss: 0.431 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9487299919128418
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.498 Vali Acc: 0.768 Test Loss: 0.498 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8047833442687988
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.369 Vali Acc: 0.836 Test Loss: 0.369 Test Acc: 0.836
Validation loss decreased (-0.822521 --> -0.836174).  Saving model ...
Epoch: 7 cost time: 1.554792881011963
Epoch: 7, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.388 Vali Acc: 0.829 Test Loss: 0.388 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.801788330078125
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.434 Vali Acc: 0.802 Test Loss: 0.434 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9040861129760742
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.408 Vali Acc: 0.816 Test Loss: 0.408 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9409472942352295
Epoch: 10, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.429 Vali Acc: 0.802 Test Loss: 0.429 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.006981372833252
Epoch: 11, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.408 Vali Acc: 0.833 Test Loss: 0.408 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.879044771194458
Epoch: 12, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.451 Vali Acc: 0.812 Test Loss: 0.451 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.174032688140869
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.440 Vali Acc: 0.823 Test Loss: 0.440 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0466368198394775
Epoch: 14, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0671746730804443
Epoch: 15, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7270829677581787
Epoch: 16, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.487 Vali Acc: 0.819 Test Loss: 0.487 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 37090
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.447479486465454
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.524 Vali Acc: 0.799 Test Loss: 0.524 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.816779613494873
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.424 Vali Acc: 0.833 Test Loss: 0.424 Test Acc: 0.833
Validation loss decreased (-0.798630 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.9009900093078613
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8701741695404053
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
Validation loss decreased (-0.832760 --> -0.832760).  Saving model ...
Epoch: 5 cost time: 1.9674110412597656
Epoch: 5, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.411 Vali Acc: 0.812 Test Loss: 0.411 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0776352882385254
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.428 Vali Acc: 0.809 Test Loss: 0.428 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9798834323883057
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.352 Vali Acc: 0.860 Test Loss: 0.352 Test Acc: 0.860
Validation loss decreased (-0.832760 --> -0.860065).  Saving model ...
Epoch: 8 cost time: 1.9792108535766602
Epoch: 8, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0708775520324707
Epoch: 9, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.418 Vali Acc: 0.812 Test Loss: 0.418 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.28281569480896
Epoch: 10, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.385 Vali Acc: 0.843 Test Loss: 0.385 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0026450157165527
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8814644813537598
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.433 Vali Acc: 0.819 Test Loss: 0.433 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.924687147140503
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1705281734466553
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.514 Vali Acc: 0.792 Test Loss: 0.514 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9613118171691895
Epoch: 15, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.446 Vali Acc: 0.829 Test Loss: 0.446 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9548323154449463
Epoch: 16, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.482 Vali Acc: 0.805 Test Loss: 0.482 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1174094676971436
Epoch: 17, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.470 Vali Acc: 0.823 Test Loss: 0.470 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 34962
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.5091302394866943
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.672 Vali Acc: 0.567 Test Loss: 0.672 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 1.8638744354248047
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.491 Vali Acc: 0.741 Test Loss: 0.491 Test Acc: 0.741
Validation loss decreased (-0.566546 --> -0.740609).  Saving model ...
Epoch: 3 cost time: 1.9944987297058105
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.413 Vali Acc: 0.799 Test Loss: 0.413 Test Acc: 0.799
Validation loss decreased (-0.740609 --> -0.798631).  Saving model ...
Epoch: 4 cost time: 1.8938627243041992
Epoch: 4, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.386 Vali Acc: 0.823 Test Loss: 0.386 Test Acc: 0.823
Validation loss decreased (-0.798631 --> -0.822522).  Saving model ...
Epoch: 5 cost time: 2.21048903465271
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.406 Vali Acc: 0.792 Test Loss: 0.406 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.12142014503479
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.400 Vali Acc: 0.812 Test Loss: 0.400 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.016188383102417
Epoch: 7, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.363 Vali Acc: 0.843 Test Loss: 0.363 Test Acc: 0.843
Validation loss decreased (-0.822522 --> -0.843000).  Saving model ...
Epoch: 8 cost time: 1.7350177764892578
Epoch: 8, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9099276065826416
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.390 Vali Acc: 0.829 Test Loss: 0.390 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7456951141357422
Epoch: 10, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.359 Vali Acc: 0.853 Test Loss: 0.359 Test Acc: 0.853
Validation loss decreased (-0.843000 --> -0.853239).  Saving model ...
Epoch: 11 cost time: 1.7369072437286377
Epoch: 11, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.390 Vali Acc: 0.833 Test Loss: 0.390 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0607481002807617
Epoch: 12, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.406 Vali Acc: 0.826 Test Loss: 0.406 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7761244773864746
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.430 Vali Acc: 0.823 Test Loss: 0.430 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8101470470428467
Epoch: 14, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.415 Vali Acc: 0.836 Test Loss: 0.415 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8377344608306885
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.431 Vali Acc: 0.826 Test Loss: 0.431 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9891259670257568
Epoch: 16, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.409 Vali Acc: 0.836 Test Loss: 0.409 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0078907012939453
Epoch: 17, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.441 Vali Acc: 0.846 Test Loss: 0.441 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1177854537963867
Epoch: 18, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8489086627960205
Epoch: 19, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.414 Vali Acc: 0.840 Test Loss: 0.414 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9889674186706543
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.479 Vali Acc: 0.812 Test Loss: 0.479 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 33970
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.543972015380859
Epoch: 1, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.551 Vali Acc: 0.758 Test Loss: 0.551 Test Acc: 0.758
Validation loss decreased (inf --> -0.757674).  Saving model ...
Epoch: 2 cost time: 1.9075911045074463
Epoch: 2, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.478 Vali Acc: 0.799 Test Loss: 0.478 Test Acc: 0.799
Validation loss decreased (-0.757674 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 1.924734354019165
Epoch: 3, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.444 Vali Acc: 0.805 Test Loss: 0.444 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 2.05548357963562
Epoch: 4, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
Validation loss decreased (-0.805456 --> -0.832760).  Saving model ...
Epoch: 5 cost time: 1.838484764099121
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.414 Vali Acc: 0.823 Test Loss: 0.414 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8695509433746338
Epoch: 6, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
Validation loss decreased (-0.832760 --> -0.839587).  Saving model ...
Epoch: 7 cost time: 1.8099918365478516
Epoch: 7, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.384 Vali Acc: 0.840 Test Loss: 0.384 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.329127550125122
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.390 Vali Acc: 0.823 Test Loss: 0.390 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9557301998138428
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.404 Vali Acc: 0.802 Test Loss: 0.404 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7543022632598877
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.383 Vali Acc: 0.819 Test Loss: 0.383 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9255249500274658
Epoch: 11, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.381 Vali Acc: 0.823 Test Loss: 0.381 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8665573596954346
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.374 Vali Acc: 0.843 Test Loss: 0.374 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.843000).  Saving model ...
Epoch: 13 cost time: 2.1392760276794434
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.404 Vali Acc: 0.819 Test Loss: 0.404 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0117526054382324
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.843000 --> -0.866890).  Saving model ...
Epoch: 15 cost time: 1.7965145111083984
Epoch: 15, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.427 Vali Acc: 0.809 Test Loss: 0.427 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9768931865692139
Epoch: 16, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.404 Vali Acc: 0.836 Test Loss: 0.404 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2031309604644775
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.468 Vali Acc: 0.785 Test Loss: 0.468 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.268256425857544
Epoch: 18, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.419 Vali Acc: 0.836 Test Loss: 0.419 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8474090099334717
Epoch: 19, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.408 Vali Acc: 0.846 Test Loss: 0.408 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8284194469451904
Epoch: 20, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.403 Vali Acc: 0.843 Test Loss: 0.403 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7289187908172607
Epoch: 21, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.455 Vali Acc: 0.812 Test Loss: 0.455 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9198241233825684
Epoch: 22, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.436 Vali Acc: 0.819 Test Loss: 0.436 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1041464805603027
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.398 Vali Acc: 0.857 Test Loss: 0.398 Test Acc: 0.857
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3027915954589844
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.504 Vali Acc: 0.802 Test Loss: 0.504 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 33538
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.5294623374938965
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.634 Vali Acc: 0.669 Test Loss: 0.634 Test Acc: 0.669
Validation loss decreased (inf --> -0.668936).  Saving model ...
Epoch: 2 cost time: 1.8183379173278809
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.508 Vali Acc: 0.788 Test Loss: 0.508 Test Acc: 0.788
Validation loss decreased (-0.668936 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 1.7479848861694336
Epoch: 3, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.459 Vali Acc: 0.802 Test Loss: 0.459 Test Acc: 0.802
Validation loss decreased (-0.788391 --> -0.802043).  Saving model ...
Epoch: 4 cost time: 1.642057180404663
Epoch: 4, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
Validation loss decreased (-0.802043 --> -0.802044).  Saving model ...
Epoch: 5 cost time: 1.677231788635254
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.450 Vali Acc: 0.792 Test Loss: 0.450 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1658036708831787
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.437 Vali Acc: 0.799 Test Loss: 0.437 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7901780605316162
Epoch: 7, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.440 Vali Acc: 0.792 Test Loss: 0.440 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8695499897003174
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.426 Vali Acc: 0.792 Test Loss: 0.426 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.053628921508789
Epoch: 9, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.389 Vali Acc: 0.823 Test Loss: 0.389 Test Acc: 0.823
Validation loss decreased (-0.802044 --> -0.822522).  Saving model ...
Epoch: 10 cost time: 2.56911301612854
Epoch: 10, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
Validation loss decreased (-0.822522 --> -0.832761).  Saving model ...
Epoch: 11 cost time: 1.8477144241333008
Epoch: 11, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.405 Vali Acc: 0.823 Test Loss: 0.405 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8554692268371582
Epoch: 12, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.354 Vali Acc: 0.840 Test Loss: 0.354 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839587).  Saving model ...
Epoch: 13 cost time: 1.7274365425109863
Epoch: 13, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.367 Vali Acc: 0.836 Test Loss: 0.367 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9082081317901611
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.370 Vali Acc: 0.836 Test Loss: 0.370 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9202063083648682
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.359 Vali Acc: 0.840 Test Loss: 0.359 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8996024131774902
Epoch: 16, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.362 Vali Acc: 0.843 Test Loss: 0.362 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.843000).  Saving model ...
Epoch: 17 cost time: 1.5212533473968506
Epoch: 17, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.344 Vali Acc: 0.867 Test Loss: 0.344 Test Acc: 0.867
Validation loss decreased (-0.843000 --> -0.866891).  Saving model ...
Epoch: 18 cost time: 1.736476182937622
Epoch: 18, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.350 Vali Acc: 0.860 Test Loss: 0.350 Test Acc: 0.860
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9110655784606934
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.371 Vali Acc: 0.846 Test Loss: 0.371 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.985868215560913
Epoch: 20, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.866891 --> -0.877130).  Saving model ...
Epoch: 21 cost time: 1.736147165298462
Epoch: 21, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7940847873687744
Epoch: 22, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.412 Vali Acc: 0.829 Test Loss: 0.412 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.671522617340088
Epoch: 23, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.468 Vali Acc: 0.802 Test Loss: 0.468 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.766087293624878
Epoch: 24, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.338 Vali Acc: 0.884 Test Loss: 0.338 Test Acc: 0.884
Validation loss decreased (-0.877130 --> -0.883956).  Saving model ...
Epoch: 25 cost time: 2.0426580905914307
Epoch: 25, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.461 Vali Acc: 0.802 Test Loss: 0.461 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0817408561706543
Epoch: 26, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.352 Vali Acc: 0.877 Test Loss: 0.352 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8011157512664795
Epoch: 27, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.400 Vali Acc: 0.853 Test Loss: 0.400 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7393980026245117
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.349 Vali Acc: 0.874 Test Loss: 0.349 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8346283435821533
Epoch: 29, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.369 Vali Acc: 0.867 Test Loss: 0.369 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7562825679779053
Epoch: 30, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.518 Vali Acc: 0.788 Test Loss: 0.518 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6790032386779785
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.355 Vali Acc: 0.877 Test Loss: 0.355 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.276322841644287
Epoch: 32, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.357 Vali Acc: 0.863 Test Loss: 0.357 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.7657876014709473
Epoch: 33, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.449 Vali Acc: 0.819 Test Loss: 0.449 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.024905204772949
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.457 Vali Acc: 0.833 Test Loss: 0.457 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8839590443686007
model parameter : 33490
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.281425476074219
Epoch: 1, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.581 Vali Acc: 0.720 Test Loss: 0.581 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 1.8762493133544922
Epoch: 2, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.503 Vali Acc: 0.785 Test Loss: 0.503 Test Acc: 0.785
Validation loss decreased (-0.720131 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 2.4815151691436768
Epoch: 3, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.453 Vali Acc: 0.795 Test Loss: 0.453 Test Acc: 0.795
Validation loss decreased (-0.784978 --> -0.795217).  Saving model ...
Epoch: 4 cost time: 1.830711841583252
Epoch: 4, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.423 Vali Acc: 0.792 Test Loss: 0.423 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.996912956237793
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.427 Vali Acc: 0.795 Test Loss: 0.427 Test Acc: 0.795
Validation loss decreased (-0.795217 --> -0.795218).  Saving model ...
Epoch: 6 cost time: 2.137761116027832
Epoch: 6, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
Validation loss decreased (-0.795218 --> -0.832761).  Saving model ...
Epoch: 7 cost time: 1.7271063327789307
Epoch: 7, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.388 Vali Acc: 0.836 Test Loss: 0.388 Test Acc: 0.836
Validation loss decreased (-0.832761 --> -0.836174).  Saving model ...
Epoch: 8 cost time: 1.7258381843566895
Epoch: 8, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.384 Vali Acc: 0.840 Test Loss: 0.384 Test Acc: 0.840
Validation loss decreased (-0.836174 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.9349877834320068
Epoch: 9, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.403 Vali Acc: 0.802 Test Loss: 0.403 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0479190349578857
Epoch: 10, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.357 Vali Acc: 0.853 Test Loss: 0.357 Test Acc: 0.853
Validation loss decreased (-0.839587 --> -0.853239).  Saving model ...
Epoch: 11 cost time: 2.2252120971679688
Epoch: 11, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.393 Vali Acc: 0.816 Test Loss: 0.393 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.171797037124634
Epoch: 12, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.383 Vali Acc: 0.846 Test Loss: 0.383 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0428194999694824
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.17618989944458
Epoch: 14, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.371 Vali Acc: 0.846 Test Loss: 0.371 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0110440254211426
Epoch: 15, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.363 Vali Acc: 0.850 Test Loss: 0.363 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9219253063201904
Epoch: 16, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.394 Vali Acc: 0.843 Test Loss: 0.394 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8082683086395264
Epoch: 17, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
Validation loss decreased (-0.853239 --> -0.866891).  Saving model ...
Epoch: 18 cost time: 2.3651788234710693
Epoch: 18, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.462 Vali Acc: 0.809 Test Loss: 0.462 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0889811515808105
Epoch: 19, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1756720542907715
Epoch: 20, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9582014083862305
Epoch: 21, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.364 Vali Acc: 0.863 Test Loss: 0.364 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1147563457489014
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.415 Vali Acc: 0.829 Test Loss: 0.415 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6773669719696045
Epoch: 23, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.397 Vali Acc: 0.857 Test Loss: 0.397 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.926377773284912
Epoch: 24, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.383 Vali Acc: 0.853 Test Loss: 0.383 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7947537899017334
Epoch: 25, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.112217664718628
Epoch: 26, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.349 Vali Acc: 0.877 Test Loss: 0.349 Test Acc: 0.877
Validation loss decreased (-0.866891 --> -0.877130).  Saving model ...
Epoch: 27 cost time: 1.986698865890503
Epoch: 27, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.477 Vali Acc: 0.833 Test Loss: 0.477 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7617824077606201
Epoch: 28, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.017559289932251
Epoch: 29, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.426 Vali Acc: 0.850 Test Loss: 0.426 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3778038024902344
Epoch: 30, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.467 Vali Acc: 0.826 Test Loss: 0.467 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5733880996704102
Epoch: 31, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.428 Vali Acc: 0.840 Test Loss: 0.428 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8480918407440186
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.436 Vali Acc: 0.840 Test Loss: 0.436 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.883781909942627
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.373 Vali Acc: 0.877 Test Loss: 0.373 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.097240924835205
Epoch: 34, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.489 Vali Acc: 0.823 Test Loss: 0.489 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6466143131256104
Epoch: 35, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.469 Vali Acc: 0.846 Test Loss: 0.469 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.8596246242523193
Epoch: 36, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 34002
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.881116628646851
Epoch: 1, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.459 Vali Acc: 0.853 Test Loss: 0.459 Test Acc: 0.853
Validation loss decreased (inf --> -0.853238).  Saving model ...
Epoch: 2 cost time: 2.0540294647216797
Epoch: 2, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.405 Vali Acc: 0.840 Test Loss: 0.405 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1254961490631104
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9943814277648926
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.405 Vali Acc: 0.840 Test Loss: 0.405 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8777520656585693
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0121054649353027
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.445 Vali Acc: 0.802 Test Loss: 0.445 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7466282844543457
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.408 Vali Acc: 0.836 Test Loss: 0.408 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0229084491729736
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.523 Vali Acc: 0.802 Test Loss: 0.523 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.463667869567871
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.433 Vali Acc: 0.829 Test Loss: 0.433 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9726848602294922
Epoch: 10, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.513 Vali Acc: 0.799 Test Loss: 0.513 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.084848165512085
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.431 Vali Acc: 0.857 Test Loss: 0.431 Test Acc: 0.857
Validation loss decreased (-0.853238 --> -0.856651).  Saving model ...
Epoch: 12 cost time: 1.8041348457336426
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.597 Vali Acc: 0.788 Test Loss: 0.597 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5895237922668457
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.593 Vali Acc: 0.799 Test Loss: 0.593 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.217064619064331
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.617 Vali Acc: 0.792 Test Loss: 0.617 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.712357521057129
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.692 Vali Acc: 0.782 Test Loss: 0.692 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6003127098083496
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.708 Vali Acc: 0.778 Test Loss: 0.708 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.283273935317993
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.712 Vali Acc: 0.799 Test Loss: 0.712 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9493227005004883
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.772 Vali Acc: 0.795 Test Loss: 0.772 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.960449457168579
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.819 Vali Acc: 0.775 Test Loss: 0.819 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8084867000579834
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.155668020248413
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.794 Vali Acc: 0.785 Test Loss: 0.794 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 30786
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.077715158462524
Epoch: 1, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 2.4743728637695312
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.471 Vali Acc: 0.799 Test Loss: 0.471 Test Acc: 0.799
Validation loss decreased (-0.726957 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 1.9306137561798096
Epoch: 3, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.450 Vali Acc: 0.809 Test Loss: 0.450 Test Acc: 0.809
Validation loss decreased (-0.798630 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 1.9697957038879395
Epoch: 4, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.450 Vali Acc: 0.805 Test Loss: 0.450 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6790473461151123
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
Validation loss decreased (-0.808869 --> -0.808869).  Saving model ...
Epoch: 6 cost time: 1.8279829025268555
Epoch: 6, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.465 Vali Acc: 0.788 Test Loss: 0.465 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1707699298858643
Epoch: 7, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
Validation loss decreased (-0.808869 --> -0.832761).  Saving model ...
Epoch: 8 cost time: 2.0846292972564697
Epoch: 8, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.01874041557312
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.439 Vali Acc: 0.816 Test Loss: 0.439 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8007757663726807
Epoch: 10, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.456 Vali Acc: 0.802 Test Loss: 0.456 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8219232559204102
Epoch: 11, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1398086547851562
Epoch: 12, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.468 Vali Acc: 0.805 Test Loss: 0.468 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.53262996673584
Epoch: 13, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.521 Vali Acc: 0.782 Test Loss: 0.521 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.18753719329834
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.019392728805542
Epoch: 15, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9211304187774658
Epoch: 16, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.514 Vali Acc: 0.805 Test Loss: 0.514 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8417298793792725
Epoch: 17, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.583 Vali Acc: 0.778 Test Loss: 0.583 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 24418
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.8207080364227295
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.611 Vali Acc: 0.648 Test Loss: 0.611 Test Acc: 0.648
Validation loss decreased (inf --> -0.648458).  Saving model ...
Epoch: 2 cost time: 1.8221824169158936
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.528 Vali Acc: 0.693 Test Loss: 0.528 Test Acc: 0.693
Validation loss decreased (-0.648458 --> -0.692827).  Saving model ...
Epoch: 3 cost time: 2.1174535751342773
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.436 Vali Acc: 0.795 Test Loss: 0.436 Test Acc: 0.795
Validation loss decreased (-0.692827 --> -0.795217).  Saving model ...
Epoch: 4 cost time: 2.0390772819519043
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.446 Vali Acc: 0.765 Test Loss: 0.446 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8532013893127441
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.423 Vali Acc: 0.823 Test Loss: 0.423 Test Acc: 0.823
Validation loss decreased (-0.795217 --> -0.822521).  Saving model ...
Epoch: 6 cost time: 2.119802236557007
Epoch: 6, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.382 Vali Acc: 0.826 Test Loss: 0.382 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 2.064345359802246
Epoch: 7, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.344 Vali Acc: 0.860 Test Loss: 0.344 Test Acc: 0.860
Validation loss decreased (-0.825935 --> -0.860065).  Saving model ...
Epoch: 8 cost time: 1.9097990989685059
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.392 Vali Acc: 0.819 Test Loss: 0.392 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.721465826034546
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9767296314239502
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.394 Vali Acc: 0.829 Test Loss: 0.394 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.241129159927368
Epoch: 11, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.387 Vali Acc: 0.843 Test Loss: 0.387 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7189838886260986
Epoch: 12, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7809031009674072
Epoch: 13, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.405 Vali Acc: 0.829 Test Loss: 0.405 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.018871784210205
Epoch: 14, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4460675716400146
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.013437509536743
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.491 Vali Acc: 0.816 Test Loss: 0.491 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0990495681762695
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.437 Vali Acc: 0.829 Test Loss: 0.437 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 22290
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.264347791671753
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.688 Vali Acc: 0.577 Test Loss: 0.688 Test Acc: 0.577
Validation loss decreased (inf --> -0.576785).  Saving model ...
Epoch: 2 cost time: 1.880887508392334
Epoch: 2, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.535 Vali Acc: 0.768 Test Loss: 0.535 Test Acc: 0.768
Validation loss decreased (-0.576785 --> -0.767913).  Saving model ...
Epoch: 3 cost time: 1.8376843929290771
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.483 Vali Acc: 0.761 Test Loss: 0.483 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7375216484069824
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.454 Vali Acc: 0.785 Test Loss: 0.454 Test Acc: 0.785
Validation loss decreased (-0.767913 --> -0.784978).  Saving model ...
Epoch: 5 cost time: 1.7105045318603516
Epoch: 5, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.418 Vali Acc: 0.795 Test Loss: 0.418 Test Acc: 0.795
Validation loss decreased (-0.784978 --> -0.795218).  Saving model ...
Epoch: 6 cost time: 1.993333339691162
Epoch: 6, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.421 Vali Acc: 0.802 Test Loss: 0.421 Test Acc: 0.802
Validation loss decreased (-0.795218 --> -0.802044).  Saving model ...
Epoch: 7 cost time: 1.9178872108459473
Epoch: 7, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.446 Vali Acc: 0.802 Test Loss: 0.446 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8643252849578857
Epoch: 8, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
Validation loss decreased (-0.802044 --> -0.808869).  Saving model ...
Epoch: 9 cost time: 1.840083122253418
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.390 Vali Acc: 0.833 Test Loss: 0.390 Test Acc: 0.833
Validation loss decreased (-0.808869 --> -0.832761).  Saving model ...
Epoch: 10 cost time: 1.7947757244110107
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8478894233703613
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.402 Vali Acc: 0.809 Test Loss: 0.402 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7287569046020508
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.384 Vali Acc: 0.829 Test Loss: 0.384 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.495471715927124
Epoch: 13, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.405 Vali Acc: 0.816 Test Loss: 0.405 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0785789489746094
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.469 Vali Acc: 0.785 Test Loss: 0.469 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.812021255493164
Epoch: 15, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.046570062637329
Epoch: 16, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.388 Vali Acc: 0.833 Test Loss: 0.388 Test Acc: 0.833
Validation loss decreased (-0.832761 --> -0.832761).  Saving model ...
Epoch: 17 cost time: 1.541013240814209
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.415 Vali Acc: 0.823 Test Loss: 0.415 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.46681547164917
Epoch: 18, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0051214694976807
Epoch: 19, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.378 Vali Acc: 0.857 Test Loss: 0.378 Test Acc: 0.857
Validation loss decreased (-0.832761 --> -0.856652).  Saving model ...
Epoch: 20 cost time: 2.398590087890625
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.480 Vali Acc: 0.805 Test Loss: 0.480 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.059189558029175
Epoch: 21, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.435 Vali Acc: 0.833 Test Loss: 0.435 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9199585914611816
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8166053295135498
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.498 Vali Acc: 0.809 Test Loss: 0.498 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.036595344543457
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8718042373657227
Epoch: 25, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9032816886901855
Epoch: 26, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.458 Vali Acc: 0.826 Test Loss: 0.458 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.124338388442993
Epoch: 27, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8432631492614746
Epoch: 28, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.637 Vali Acc: 0.795 Test Loss: 0.637 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0357680320739746
Epoch: 29, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.823 Test Loss: 0.521 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 21298
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.841153383255005
Epoch: 1, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.700 Vali Acc: 0.543 Test Loss: 0.700 Test Acc: 0.543
Validation loss decreased (inf --> -0.542655).  Saving model ...
Epoch: 2 cost time: 1.819263219833374
Epoch: 2, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.515 Vali Acc: 0.782 Test Loss: 0.515 Test Acc: 0.782
Validation loss decreased (-0.542655 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 2.46266770362854
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.438 Vali Acc: 0.823 Test Loss: 0.438 Test Acc: 0.823
Validation loss decreased (-0.781565 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.874316692352295
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.443 Vali Acc: 0.788 Test Loss: 0.443 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.881300687789917
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.388 Vali Acc: 0.846 Test Loss: 0.388 Test Acc: 0.846
Validation loss decreased (-0.822521 --> -0.846413).  Saving model ...
Epoch: 6 cost time: 1.584336280822754
Epoch: 6, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.846413 --> -0.849826).  Saving model ...
Epoch: 7 cost time: 1.874685525894165
Epoch: 7, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.369 Vali Acc: 0.843 Test Loss: 0.369 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.153069257736206
Epoch: 8, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.395 Vali Acc: 0.823 Test Loss: 0.395 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6951136589050293
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0274856090545654
Epoch: 10, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.377 Vali Acc: 0.846 Test Loss: 0.377 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9498610496520996
Epoch: 11, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.346 Vali Acc: 0.870 Test Loss: 0.346 Test Acc: 0.870
Validation loss decreased (-0.849826 --> -0.870304).  Saving model ...
Epoch: 12 cost time: 2.450376033782959
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.383 Vali Acc: 0.846 Test Loss: 0.383 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1142592430114746
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
Validation loss decreased (-0.870304 --> -0.870304).  Saving model ...
Epoch: 14 cost time: 1.7800498008728027
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.362 Vali Acc: 0.863 Test Loss: 0.362 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8431851863861084
Epoch: 15, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.353 Vali Acc: 0.874 Test Loss: 0.353 Test Acc: 0.874
Validation loss decreased (-0.870304 --> -0.873717).  Saving model ...
Epoch: 16 cost time: 1.9717788696289062
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.353 Vali Acc: 0.874 Test Loss: 0.353 Test Acc: 0.874
Validation loss decreased (-0.873717 --> -0.873717).  Saving model ...
Epoch: 17 cost time: 1.8085029125213623
Epoch: 17, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.361 Vali Acc: 0.863 Test Loss: 0.361 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.852842092514038
Epoch: 18, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9839966297149658
Epoch: 19, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.380 Vali Acc: 0.850 Test Loss: 0.380 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.098867416381836
Epoch: 20, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.356 Vali Acc: 0.874 Test Loss: 0.356 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.066833019256592
Epoch: 21, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.387 Vali Acc: 0.846 Test Loss: 0.387 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0197911262512207
Epoch: 22, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.402 Vali Acc: 0.843 Test Loss: 0.402 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.589216947555542
Epoch: 23, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.386 Vali Acc: 0.846 Test Loss: 0.386 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.181204319000244
Epoch: 24, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.417 Vali Acc: 0.843 Test Loss: 0.417 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7888517379760742
Epoch: 25, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7495417594909668
Epoch: 26, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.417 Vali Acc: 0.840 Test Loss: 0.417 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 20866
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.571166038513184
Epoch: 1, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.658 Vali Acc: 0.662 Test Loss: 0.658 Test Acc: 0.662
Validation loss decreased (inf --> -0.662109).  Saving model ...
Epoch: 2 cost time: 2.0841143131256104
Epoch: 2, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.529 Vali Acc: 0.785 Test Loss: 0.529 Test Acc: 0.785
Validation loss decreased (-0.662109 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 1.8959288597106934
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.457 Vali Acc: 0.816 Test Loss: 0.457 Test Acc: 0.816
Validation loss decreased (-0.784978 --> -0.815695).  Saving model ...
Epoch: 4 cost time: 1.8264389038085938
Epoch: 4, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.475 Vali Acc: 0.775 Test Loss: 0.475 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.166865825653076
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.422 Vali Acc: 0.795 Test Loss: 0.422 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1386871337890625
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.436 Vali Acc: 0.788 Test Loss: 0.436 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1546132564544678
Epoch: 7, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.420 Vali Acc: 0.795 Test Loss: 0.420 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2699544429779053
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.405 Vali Acc: 0.812 Test Loss: 0.405 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0239064693450928
Epoch: 9, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.388 Vali Acc: 0.819 Test Loss: 0.388 Test Acc: 0.819
Validation loss decreased (-0.815695 --> -0.819109).  Saving model ...
Epoch: 10 cost time: 2.0818777084350586
Epoch: 10, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.404 Vali Acc: 0.802 Test Loss: 0.404 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7027580738067627
Epoch: 11, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.374 Vali Acc: 0.843 Test Loss: 0.374 Test Acc: 0.843
Validation loss decreased (-0.819109 --> -0.843000).  Saving model ...
Epoch: 12 cost time: 1.7605514526367188
Epoch: 12, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.356 Vali Acc: 0.853 Test Loss: 0.356 Test Acc: 0.853
Validation loss decreased (-0.843000 --> -0.853239).  Saving model ...
Epoch: 13 cost time: 1.9919555187225342
Epoch: 13, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.377 Vali Acc: 0.836 Test Loss: 0.377 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2237966060638428
Epoch: 14, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.370 Vali Acc: 0.846 Test Loss: 0.370 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7574512958526611
Epoch: 15, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.369 Vali Acc: 0.853 Test Loss: 0.369 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0949149131774902
Epoch: 16, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.364 Vali Acc: 0.860 Test Loss: 0.364 Test Acc: 0.860
Validation loss decreased (-0.853239 --> -0.860065).  Saving model ...
Epoch: 17 cost time: 1.8439056873321533
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
Validation loss decreased (-0.860065 --> -0.880543).  Saving model ...
Epoch: 18 cost time: 2.3083372116088867
Epoch: 18, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.943880558013916
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.333 Vali Acc: 0.891 Test Loss: 0.333 Test Acc: 0.891
Validation loss decreased (-0.880543 --> -0.890782).  Saving model ...
Epoch: 20 cost time: 2.2139101028442383
Epoch: 20, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.389 Vali Acc: 0.846 Test Loss: 0.389 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9017293453216553
Epoch: 21, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.135596752166748
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.391 Vali Acc: 0.853 Test Loss: 0.391 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2677536010742188
Epoch: 23, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.376 Vali Acc: 0.860 Test Loss: 0.376 Test Acc: 0.860
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0249531269073486
Epoch: 24, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.371 Vali Acc: 0.874 Test Loss: 0.371 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2973287105560303
Epoch: 25, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.387 Vali Acc: 0.860 Test Loss: 0.387 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3418331146240234
Epoch: 26, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.418 Vali Acc: 0.850 Test Loss: 0.418 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1373112201690674
Epoch: 27, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.434 Vali Acc: 0.846 Test Loss: 0.434 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3208141326904297
Epoch: 28, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.399 Vali Acc: 0.867 Test Loss: 0.399 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.5340628623962402
Epoch: 29, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8907849829351536
model parameter : 20818
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.7512288093566895
Epoch: 1, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.684 Vali Acc: 0.567 Test Loss: 0.684 Test Acc: 0.567
Validation loss decreased (inf --> -0.566546).  Saving model ...
Epoch: 2 cost time: 1.5883862972259521
Epoch: 2, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.586 Vali Acc: 0.734 Test Loss: 0.586 Test Acc: 0.734
Validation loss decreased (-0.566546 --> -0.733783).  Saving model ...
Epoch: 3 cost time: 1.5148699283599854
Epoch: 3, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.498 Vali Acc: 0.775 Test Loss: 0.498 Test Acc: 0.775
Validation loss decreased (-0.733783 --> -0.774739).  Saving model ...
Epoch: 4 cost time: 1.8403010368347168
Epoch: 4, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.469 Vali Acc: 0.778 Test Loss: 0.469 Test Acc: 0.778
Validation loss decreased (-0.774739 --> -0.778152).  Saving model ...
Epoch: 5 cost time: 1.7790701389312744
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.434 Vali Acc: 0.795 Test Loss: 0.434 Test Acc: 0.795
Validation loss decreased (-0.778152 --> -0.795218).  Saving model ...
Epoch: 6 cost time: 1.8862330913543701
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.400 Vali Acc: 0.805 Test Loss: 0.400 Test Acc: 0.805
Validation loss decreased (-0.795218 --> -0.805457).  Saving model ...
Epoch: 7 cost time: 2.1111958026885986
Epoch: 7, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.371 Vali Acc: 0.836 Test Loss: 0.371 Test Acc: 0.836
Validation loss decreased (-0.805457 --> -0.836174).  Saving model ...
Epoch: 8 cost time: 1.9990646839141846
Epoch: 8, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.394 Vali Acc: 0.823 Test Loss: 0.394 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8543643951416016
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.408 Vali Acc: 0.819 Test Loss: 0.408 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7898082733154297
Epoch: 10, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.215897798538208
Epoch: 11, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.414 Vali Acc: 0.795 Test Loss: 0.414 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1639792919158936
Epoch: 12, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.349 Vali Acc: 0.846 Test Loss: 0.349 Test Acc: 0.846
Validation loss decreased (-0.836174 --> -0.846413).  Saving model ...
Epoch: 13 cost time: 1.8751487731933594
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.402 Vali Acc: 0.809 Test Loss: 0.402 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8216667175292969
Epoch: 14, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.386 Vali Acc: 0.826 Test Loss: 0.386 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8678491115570068
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.332 Vali Acc: 0.850 Test Loss: 0.332 Test Acc: 0.850
Validation loss decreased (-0.846413 --> -0.849826).  Saving model ...
Epoch: 16 cost time: 2.145488739013672
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.365 Vali Acc: 0.843 Test Loss: 0.365 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7065117359161377
Epoch: 17, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.358 Vali Acc: 0.846 Test Loss: 0.358 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7840559482574463
Epoch: 18, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.398 Vali Acc: 0.829 Test Loss: 0.398 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0320680141448975
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.381 Vali Acc: 0.843 Test Loss: 0.381 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9188120365142822
Epoch: 20, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.386 Vali Acc: 0.836 Test Loss: 0.386 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1138477325439453
Epoch: 21, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.366 Vali Acc: 0.840 Test Loss: 0.366 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7452278137207031
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.414 Vali Acc: 0.823 Test Loss: 0.414 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7626311779022217
Epoch: 23, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.400 Vali Acc: 0.826 Test Loss: 0.400 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7117283344268799
Epoch: 24, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.422 Vali Acc: 0.823 Test Loss: 0.422 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0923750400543213
Epoch: 25, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 21330
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.997893810272217
Epoch: 1, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.527 Vali Acc: 0.703 Test Loss: 0.527 Test Acc: 0.703
Validation loss decreased (inf --> -0.703066).  Saving model ...
Epoch: 2 cost time: 1.6391170024871826
Epoch: 2, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.425 Vali Acc: 0.788 Test Loss: 0.425 Test Acc: 0.788
Validation loss decreased (-0.703066 --> -0.788392).  Saving model ...
Epoch: 3 cost time: 1.9937143325805664
Epoch: 3, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.421 Vali Acc: 0.823 Test Loss: 0.421 Test Acc: 0.823
Validation loss decreased (-0.788392 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.865236759185791
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.423 Vali Acc: 0.805 Test Loss: 0.423 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4311957359313965
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9523026943206787
Epoch: 6, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.425 Vali Acc: 0.819 Test Loss: 0.425 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2255470752716064
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.822521 --> -0.849825).  Saving model ...
Epoch: 8 cost time: 2.097028970718384
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.471 Vali Acc: 0.802 Test Loss: 0.471 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.965712547302246
Epoch: 9, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.472 Vali Acc: 0.819 Test Loss: 0.472 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9389615058898926
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.533 Vali Acc: 0.792 Test Loss: 0.533 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.862097978591919
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.479 Vali Acc: 0.826 Test Loss: 0.479 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.007167339324951
Epoch: 12, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.510 Vali Acc: 0.819 Test Loss: 0.510 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.034552812576294
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.585 Vali Acc: 0.792 Test Loss: 0.585 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2797446250915527
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.567 Vali Acc: 0.805 Test Loss: 0.567 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.206566333770752
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.636 Vali Acc: 0.816 Test Loss: 0.636 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1850903034210205
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0016767978668213
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.693 Vali Acc: 0.792 Test Loss: 0.693 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 24450
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.312796115875244
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.584 Vali Acc: 0.727 Test Loss: 0.584 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 2.1110594272613525
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.456 Vali Acc: 0.782 Test Loss: 0.456 Test Acc: 0.782
Validation loss decreased (-0.726957 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 2.4167466163635254
Epoch: 3, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.419 Vali Acc: 0.809 Test Loss: 0.419 Test Acc: 0.809
Validation loss decreased (-0.781565 --> -0.808870).  Saving model ...
Epoch: 4 cost time: 1.5967090129852295
Epoch: 4, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.439 Vali Acc: 0.802 Test Loss: 0.439 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3076956272125244
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.401 Vali Acc: 0.816 Test Loss: 0.401 Test Acc: 0.816
Validation loss decreased (-0.808870 --> -0.815696).  Saving model ...
Epoch: 6 cost time: 1.7760450839996338
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.422 Vali Acc: 0.795 Test Loss: 0.422 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6021168231964111
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.426 Vali Acc: 0.802 Test Loss: 0.426 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8966186046600342
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.401 Vali Acc: 0.805 Test Loss: 0.401 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9734470844268799
Epoch: 9, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.421 Vali Acc: 0.805 Test Loss: 0.421 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.145918846130371
Epoch: 10, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.423 Vali Acc: 0.809 Test Loss: 0.423 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8148338794708252
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
Validation loss decreased (-0.815696 --> -0.819108).  Saving model ...
Epoch: 12 cost time: 2.1684982776641846
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.444 Vali Acc: 0.802 Test Loss: 0.444 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9302537441253662
Epoch: 13, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.494 Vali Acc: 0.792 Test Loss: 0.494 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.351191759109497
Epoch: 14, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6196074485778809
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829347).  Saving model ...
Epoch: 16 cost time: 1.6552436351776123
Epoch: 16, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.527 Vali Acc: 0.812 Test Loss: 0.527 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0701959133148193
Epoch: 17, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.545 Vali Acc: 0.788 Test Loss: 0.545 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.939664602279663
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.249969482421875
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.335204601287842
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.572 Vali Acc: 0.795 Test Loss: 0.572 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.297912359237671
Epoch: 21, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9524357318878174
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.631 Vali Acc: 0.799 Test Loss: 0.631 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0660462379455566
Epoch: 23, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.599 Vali Acc: 0.799 Test Loss: 0.599 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9983899593353271
Epoch: 24, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.662 Vali Acc: 0.805 Test Loss: 0.662 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8992083072662354
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.635 Vali Acc: 0.805 Test Loss: 0.635 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 18082
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.59883189201355
Epoch: 1, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.529 Vali Acc: 0.792 Test Loss: 0.529 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.6921956539154053
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
Validation loss decreased (-0.791804 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 1.7546722888946533
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.825934 --> -0.849825).  Saving model ...
Epoch: 4 cost time: 2.0587117671966553
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.807765007019043
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.405 Vali Acc: 0.826 Test Loss: 0.405 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5549333095550537
Epoch: 6, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.411 Vali Acc: 0.812 Test Loss: 0.411 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8288328647613525
Epoch: 7, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.364 Vali Acc: 0.840 Test Loss: 0.364 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.130542516708374
Epoch: 8, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.376 Vali Acc: 0.846 Test Loss: 0.376 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6823391914367676
Epoch: 9, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.413 Vali Acc: 0.805 Test Loss: 0.413 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7353911399841309
Epoch: 10, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.429 Vali Acc: 0.809 Test Loss: 0.429 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6200623512268066
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.411 Vali Acc: 0.819 Test Loss: 0.411 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7415850162506104
Epoch: 12, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.432 Vali Acc: 0.802 Test Loss: 0.432 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6596455574035645
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.441 Vali Acc: 0.816 Test Loss: 0.441 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 15954
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.508613109588623
Epoch: 1, Steps: 17 | Train Loss: 0.735 Vali Loss: 0.601 Vali Acc: 0.666 Test Loss: 0.601 Test Acc: 0.666
Validation loss decreased (inf --> -0.665523).  Saving model ...
Epoch: 2 cost time: 1.6993229389190674
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.477 Vali Acc: 0.795 Test Loss: 0.477 Test Acc: 0.795
Validation loss decreased (-0.665523 --> -0.795217).  Saving model ...
Epoch: 3 cost time: 1.9154036045074463
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.393 Vali Acc: 0.846 Test Loss: 0.393 Test Acc: 0.846
Validation loss decreased (-0.795217 --> -0.846412).  Saving model ...
Epoch: 4 cost time: 1.5311579704284668
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.408 Vali Acc: 0.809 Test Loss: 0.408 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7947351932525635
Epoch: 5, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7041938304901123
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.387 Vali Acc: 0.823 Test Loss: 0.387 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6762652397155762
Epoch: 7, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.367 Vali Acc: 0.846 Test Loss: 0.367 Test Acc: 0.846
Validation loss decreased (-0.846412 --> -0.846413).  Saving model ...
Epoch: 8 cost time: 1.7842223644256592
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.374 Vali Acc: 0.829 Test Loss: 0.374 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8567566871643066
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.388 Vali Acc: 0.829 Test Loss: 0.388 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7490713596343994
Epoch: 10, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.378 Vali Acc: 0.829 Test Loss: 0.378 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7990686893463135
Epoch: 11, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.390 Vali Acc: 0.823 Test Loss: 0.390 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7663664817810059
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.405 Vali Acc: 0.812 Test Loss: 0.405 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7845675945281982
Epoch: 13, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7080469131469727
Epoch: 14, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8410158157348633
Epoch: 15, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7401070594787598
Epoch: 16, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.416 Vali Acc: 0.829 Test Loss: 0.416 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6451137065887451
Epoch: 17, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.485 Vali Acc: 0.799 Test Loss: 0.485 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 14962
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.912600040435791
Epoch: 1, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.602 Vali Acc: 0.706 Test Loss: 0.602 Test Acc: 0.706
Validation loss decreased (inf --> -0.706479).  Saving model ...
Epoch: 2 cost time: 1.7133283615112305
Epoch: 2, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.485 Vali Acc: 0.812 Test Loss: 0.485 Test Acc: 0.812
Validation loss decreased (-0.706479 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.6537141799926758
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
Validation loss decreased (-0.812282 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 2.152224540710449
Epoch: 4, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
Validation loss decreased (-0.825934 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.1913065910339355
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 6 cost time: 2.003715753555298
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.403 Vali Acc: 0.846 Test Loss: 0.403 Test Acc: 0.846
Validation loss decreased (-0.832760 --> -0.846412).  Saving model ...
Epoch: 7 cost time: 1.6586377620697021
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.445 Vali Acc: 0.795 Test Loss: 0.445 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8062703609466553
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4339087009429932
Epoch: 9, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.401 Vali Acc: 0.843 Test Loss: 0.401 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5328843593597412
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6573338508605957
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.386 Vali Acc: 0.846 Test Loss: 0.386 Test Acc: 0.846
Validation loss decreased (-0.846412 --> -0.846413).  Saving model ...
Epoch: 12 cost time: 1.8469769954681396
Epoch: 12, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.398 Vali Acc: 0.853 Test Loss: 0.398 Test Acc: 0.853
Validation loss decreased (-0.846413 --> -0.853238).  Saving model ...
Epoch: 13 cost time: 1.5065817832946777
Epoch: 13, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.338573932647705
Epoch: 14, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9016072750091553
Epoch: 15, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.413 Vali Acc: 0.819 Test Loss: 0.413 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.872467041015625
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.399 Vali Acc: 0.829 Test Loss: 0.399 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8312788009643555
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.371 Vali Acc: 0.853 Test Loss: 0.371 Test Acc: 0.853
Validation loss decreased (-0.853238 --> -0.853239).  Saving model ...
Epoch: 18 cost time: 1.6934611797332764
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.411 Vali Acc: 0.840 Test Loss: 0.411 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.826145887374878
Epoch: 19, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7920050621032715
Epoch: 20, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6240489482879639
Epoch: 21, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.461 Vali Acc: 0.812 Test Loss: 0.461 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.802128553390503
Epoch: 22, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.420 Vali Acc: 0.836 Test Loss: 0.420 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8072733879089355
Epoch: 23, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9186034202575684
Epoch: 24, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.421 Vali Acc: 0.840 Test Loss: 0.421 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8544721603393555
Epoch: 25, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.444 Vali Acc: 0.829 Test Loss: 0.444 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.000924587249756
Epoch: 26, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.471 Vali Acc: 0.802 Test Loss: 0.471 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.192415714263916
Epoch: 27, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.434 Vali Acc: 0.843 Test Loss: 0.434 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 14530
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.707283973693848
Epoch: 1, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.716718).  Saving model ...
Epoch: 2 cost time: 1.5389442443847656
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.511 Vali Acc: 0.751 Test Loss: 0.511 Test Acc: 0.751
Validation loss decreased (-0.716718 --> -0.750848).  Saving model ...
Epoch: 3 cost time: 1.6048827171325684
Epoch: 3, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.465 Vali Acc: 0.768 Test Loss: 0.465 Test Acc: 0.768
Validation loss decreased (-0.750848 --> -0.767913).  Saving model ...
Epoch: 4 cost time: 1.9981303215026855
Epoch: 4, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.439 Vali Acc: 0.782 Test Loss: 0.439 Test Acc: 0.782
Validation loss decreased (-0.767913 --> -0.781566).  Saving model ...
Epoch: 5 cost time: 1.9861619472503662
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.422 Vali Acc: 0.795 Test Loss: 0.422 Test Acc: 0.795
Validation loss decreased (-0.781566 --> -0.795218).  Saving model ...
Epoch: 6 cost time: 2.2333412170410156
Epoch: 6, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.405 Vali Acc: 0.809 Test Loss: 0.405 Test Acc: 0.809
Validation loss decreased (-0.795218 --> -0.808870).  Saving model ...
Epoch: 7 cost time: 2.619002342224121
Epoch: 7, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.421 Vali Acc: 0.805 Test Loss: 0.421 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9885976314544678
Epoch: 8, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.402 Vali Acc: 0.809 Test Loss: 0.402 Test Acc: 0.809
Validation loss decreased (-0.808870 --> -0.808870).  Saving model ...
Epoch: 9 cost time: 1.9432330131530762
Epoch: 9, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.375 Vali Acc: 0.833 Test Loss: 0.375 Test Acc: 0.833
Validation loss decreased (-0.808870 --> -0.832761).  Saving model ...
Epoch: 10 cost time: 1.9725663661956787
Epoch: 10, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.370 Vali Acc: 0.840 Test Loss: 0.370 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839587).  Saving model ...
Epoch: 11 cost time: 2.2263972759246826
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.352 Vali Acc: 0.846 Test Loss: 0.352 Test Acc: 0.846
Validation loss decreased (-0.839587 --> -0.846413).  Saving model ...
Epoch: 12 cost time: 2.2256128787994385
Epoch: 12, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.362 Vali Acc: 0.846 Test Loss: 0.362 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.04482364654541
Epoch: 13, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.376 Vali Acc: 0.840 Test Loss: 0.376 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5493063926696777
Epoch: 14, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.846413 --> -0.849826).  Saving model ...
Epoch: 15 cost time: 2.406259536743164
Epoch: 15, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.364 Vali Acc: 0.857 Test Loss: 0.364 Test Acc: 0.857
Validation loss decreased (-0.849826 --> -0.856652).  Saving model ...
Epoch: 16 cost time: 2.027263879776001
Epoch: 16, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.296826124191284
Epoch: 17, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.331 Vali Acc: 0.870 Test Loss: 0.331 Test Acc: 0.870
Validation loss decreased (-0.856652 --> -0.870304).  Saving model ...
Epoch: 18 cost time: 2.3391330242156982
Epoch: 18, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.381 Vali Acc: 0.843 Test Loss: 0.381 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4888343811035156
Epoch: 19, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.400 Vali Acc: 0.833 Test Loss: 0.400 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.12357759475708
Epoch: 20, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.374 Vali Acc: 0.860 Test Loss: 0.374 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.952077865600586
Epoch: 21, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.351 Vali Acc: 0.870 Test Loss: 0.351 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8875973224639893
Epoch: 22, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.390 Vali Acc: 0.846 Test Loss: 0.390 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1444649696350098
Epoch: 23, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.867 Test Loss: 0.358 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.133103370666504
Epoch: 24, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1063032150268555
Epoch: 25, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.399 Vali Acc: 0.843 Test Loss: 0.399 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.753835678100586
Epoch: 26, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.412 Vali Acc: 0.843 Test Loss: 0.412 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8362116813659668
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.407 Vali Acc: 0.846 Test Loss: 0.407 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 14482
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.117304563522339
Epoch: 1, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.712 Vali Acc: 0.502 Test Loss: 0.712 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 2.2705047130584717
Epoch: 2, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.609 Vali Acc: 0.672 Test Loss: 0.609 Test Acc: 0.672
Validation loss decreased (-0.501699 --> -0.672349).  Saving model ...
Epoch: 3 cost time: 1.833742618560791
Epoch: 3, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.502 Vali Acc: 0.768 Test Loss: 0.502 Test Acc: 0.768
Validation loss decreased (-0.672349 --> -0.767913).  Saving model ...
Epoch: 4 cost time: 2.1204590797424316
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.440 Vali Acc: 0.799 Test Loss: 0.440 Test Acc: 0.799
Validation loss decreased (-0.767913 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 1.4644951820373535
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.442 Vali Acc: 0.788 Test Loss: 0.442 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0908546447753906
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.398 Vali Acc: 0.826 Test Loss: 0.398 Test Acc: 0.826
Validation loss decreased (-0.798630 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 2.15596342086792
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.417 Vali Acc: 0.795 Test Loss: 0.417 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8031957149505615
Epoch: 8, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.390 Vali Acc: 0.816 Test Loss: 0.390 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8438034057617188
Epoch: 9, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.382 Vali Acc: 0.816 Test Loss: 0.382 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0317325592041016
Epoch: 10, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.394 Vali Acc: 0.816 Test Loss: 0.394 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9374315738677979
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
Validation loss decreased (-0.825935 --> -0.832761).  Saving model ...
Epoch: 12 cost time: 2.2237114906311035
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.407 Vali Acc: 0.802 Test Loss: 0.407 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.176645517349243
Epoch: 13, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.385 Vali Acc: 0.823 Test Loss: 0.385 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8777506351470947
Epoch: 14, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.367 Vali Acc: 0.840 Test Loss: 0.367 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839587).  Saving model ...
Epoch: 15 cost time: 1.7259907722473145
Epoch: 15, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.375 Vali Acc: 0.836 Test Loss: 0.375 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8683602809906006
Epoch: 16, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.371 Vali Acc: 0.840 Test Loss: 0.371 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.771730661392212
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.340 Vali Acc: 0.850 Test Loss: 0.340 Test Acc: 0.850
Validation loss decreased (-0.839587 --> -0.849826).  Saving model ...
Epoch: 18 cost time: 2.0844454765319824
Epoch: 18, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.352 Vali Acc: 0.846 Test Loss: 0.352 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9634900093078613
Epoch: 19, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.372 Vali Acc: 0.846 Test Loss: 0.372 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7472076416015625
Epoch: 20, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.361 Vali Acc: 0.850 Test Loss: 0.361 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1817920207977295
Epoch: 21, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.394 Vali Acc: 0.840 Test Loss: 0.394 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2732958793640137
Epoch: 22, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.352 Vali Acc: 0.857 Test Loss: 0.352 Test Acc: 0.857
Validation loss decreased (-0.849826 --> -0.856652).  Saving model ...
Epoch: 23 cost time: 1.87196946144104
Epoch: 23, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.422 Vali Acc: 0.836 Test Loss: 0.422 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9382247924804688
Epoch: 24, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.385 Vali Acc: 0.850 Test Loss: 0.385 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6248657703399658
Epoch: 25, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.398 Vali Acc: 0.843 Test Loss: 0.398 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8998520374298096
Epoch: 26, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.387 Vali Acc: 0.843 Test Loss: 0.387 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6744012832641602
Epoch: 27, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.466 Vali Acc: 0.823 Test Loss: 0.466 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9486596584320068
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.422 Vali Acc: 0.823 Test Loss: 0.422 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5086264610290527
Epoch: 29, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.439 Vali Acc: 0.829 Test Loss: 0.439 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9258315563201904
Epoch: 30, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.429 Vali Acc: 0.833 Test Loss: 0.429 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.231529474258423
Epoch: 31, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.0420684814453125
Epoch: 32, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.475 Vali Acc: 0.823 Test Loss: 0.475 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el3_dm16_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 14994
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.380270719528198
Epoch: 1, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.1533565521240234
Epoch: 2, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9446337223052979
Epoch: 3, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.577 Vali Acc: 0.795 Test Loss: 0.577 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.401005983352661
Epoch: 4, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.735 Vali Acc: 0.795 Test Loss: 0.735 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.058591365814209
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.846 Vali Acc: 0.785 Test Loss: 0.846 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4651567935943604
Epoch: 6, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832757).  Saving model ...
Epoch: 7 cost time: 2.7002475261688232
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.408 Vali Acc: 0.751 Test Loss: 1.408 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.361295461654663
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.941 Vali Acc: 0.840 Test Loss: 0.941 Test Acc: 0.840
Validation loss decreased (-0.832757 --> -0.839581).  Saving model ...
Epoch: 9 cost time: 2.145366907119751
Epoch: 9, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.161 Vali Acc: 0.805 Test Loss: 1.161 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2193877696990967
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.240 Vali Acc: 0.785 Test Loss: 1.240 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2685394287109375
Epoch: 11, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.381 Vali Acc: 0.795 Test Loss: 1.381 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.158756732940674
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.983 Vali Acc: 0.768 Test Loss: 1.983 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2832658290863037
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.421 Vali Acc: 0.819 Test Loss: 1.421 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7588768005371094
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.891 Vali Acc: 0.785 Test Loss: 1.891 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8509156703948975
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.515 Vali Acc: 0.741 Test Loss: 2.515 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.923140048980713
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.905 Vali Acc: 0.802 Test Loss: 1.905 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.151341438293457
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.461 Vali Acc: 0.747 Test Loss: 2.461 Test Acc: 0.747
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.709317922592163
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.666 Vali Acc: 0.744 Test Loss: 2.666 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 381826
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.13431191444397
Epoch: 1, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.458 Vali Acc: 0.805 Test Loss: 0.458 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 1.937147617340088
Epoch: 2, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.430 Vali Acc: 0.795 Test Loss: 0.430 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8369038105010986
Epoch: 3, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.466 Vali Acc: 0.829 Test Loss: 0.466 Test Acc: 0.829
Validation loss decreased (-0.805456 --> -0.829347).  Saving model ...
Epoch: 4 cost time: 1.6854419708251953
Epoch: 4, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7936317920684814
Epoch: 5, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.738 Vali Acc: 0.754 Test Loss: 0.738 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3876876831054688
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.771 Vali Acc: 0.768 Test Loss: 0.771 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8389177322387695
Epoch: 7, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.951 Vali Acc: 0.761 Test Loss: 0.951 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8604230880737305
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.686 Vali Acc: 0.840 Test Loss: 0.686 Test Acc: 0.840
Validation loss decreased (-0.829347 --> -0.839584).  Saving model ...
Epoch: 9 cost time: 1.6028401851654053
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.220 Vali Acc: 0.727 Test Loss: 1.220 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.45094633102417
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.803 Vali Acc: 0.836 Test Loss: 0.803 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9219608306884766
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.326 Vali Acc: 0.741 Test Loss: 1.326 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3906562328338623
Epoch: 12, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.150 Vali Acc: 0.819 Test Loss: 1.150 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.182533025741577
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.567 Vali Acc: 0.751 Test Loss: 1.567 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6533405780792236
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.220 Vali Acc: 0.816 Test Loss: 1.220 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1604766845703125
Epoch: 15, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.660 Vali Acc: 0.751 Test Loss: 1.660 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.003145456314087
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.312 Vali Acc: 0.805 Test Loss: 1.312 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5881285667419434
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.518 Vali Acc: 0.792 Test Loss: 1.518 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.006150960922241
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.582 Vali Acc: 0.792 Test Loss: 1.582 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 330882
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.980008840560913
Epoch: 1, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.463 Vali Acc: 0.785 Test Loss: 0.463 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 2.148632526397705
Epoch: 2, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.692 Vali Acc: 0.713 Test Loss: 0.692 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3090546131134033
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.496 Vali Acc: 0.805 Test Loss: 0.496 Test Acc: 0.805
Validation loss decreased (-0.784978 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.4645326137542725
Epoch: 4, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 5 cost time: 1.3282420635223389
Epoch: 5, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0209364891052246
Epoch: 6, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.720 Vali Acc: 0.754 Test Loss: 0.720 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0697596073150635
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.687 Vali Acc: 0.799 Test Loss: 0.687 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1637938022613525
Epoch: 8, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
Validation loss decreased (-0.819108 --> -0.832758).  Saving model ...
Epoch: 9 cost time: 2.0250535011291504
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.843 Vali Acc: 0.782 Test Loss: 0.843 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.874967098236084
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.713 Vali Acc: 0.840 Test Loss: 0.713 Test Acc: 0.840
Validation loss decreased (-0.832758 --> -0.839583).  Saving model ...
Epoch: 11 cost time: 2.0483579635620117
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.837 Vali Acc: 0.788 Test Loss: 0.837 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.142291307449341
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.901 Vali Acc: 0.802 Test Loss: 0.901 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9248547554016113
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.952 Vali Acc: 0.802 Test Loss: 0.952 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.857365369796753
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.955 Vali Acc: 0.805 Test Loss: 0.955 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.403308153152466
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.028 Vali Acc: 0.812 Test Loss: 1.028 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.264298439025879
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.206 Vali Acc: 0.782 Test Loss: 1.206 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1476781368255615
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.926 Vali Acc: 0.846 Test Loss: 0.926 Test Acc: 0.846
Validation loss decreased (-0.839583 --> -0.846407).  Saving model ...
Epoch: 18 cost time: 2.1031363010406494
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.135 Vali Acc: 0.805 Test Loss: 1.135 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9369182586669922
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.157 Vali Acc: 0.819 Test Loss: 1.157 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.600966215133667
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.130 Vali Acc: 0.836 Test Loss: 1.130 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3599801063537598
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.234 Vali Acc: 0.809 Test Loss: 1.234 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.189636707305908
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.298 Vali Acc: 0.819 Test Loss: 1.298 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.0582046508789062
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.672 Vali Acc: 0.765 Test Loss: 1.672 Test Acc: 0.765
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.092550754547119
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.270 Vali Acc: 0.816 Test Loss: 1.270 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.917879581451416
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.301 Vali Acc: 0.836 Test Loss: 1.301 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9587733745574951
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.615 Vali Acc: 0.788 Test Loss: 1.615 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.965301275253296
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.448 Vali Acc: 0.816 Test Loss: 1.448 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 313858
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.381052732467651
Epoch: 1, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.478 Vali Acc: 0.747 Test Loss: 0.478 Test Acc: 0.747
Validation loss decreased (inf --> -0.747435).  Saving model ...
Epoch: 2 cost time: 2.3604795932769775
Epoch: 2, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.457 Vali Acc: 0.785 Test Loss: 0.457 Test Acc: 0.785
Validation loss decreased (-0.747435 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 2.141070604324341
Epoch: 3, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
Validation loss decreased (-0.784978 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.7416613101959229
Epoch: 4, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
Validation loss decreased (-0.805456 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.0837113857269287
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.630 Vali Acc: 0.771 Test Loss: 0.630 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.335423469543457
Epoch: 6, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.559 Vali Acc: 0.805 Test Loss: 0.559 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0637359619140625
Epoch: 7, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3679988384246826
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.588 Vali Acc: 0.795 Test Loss: 0.588 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.031464099884033
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.647 Vali Acc: 0.805 Test Loss: 0.647 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.446809768676758
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8952174186706543
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.714 Vali Acc: 0.823 Test Loss: 0.714 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.02413010597229
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.681 Vali Acc: 0.819 Test Loss: 0.681 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8842132091522217
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.816 Vali Acc: 0.802 Test Loss: 0.816 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.869173288345337
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.841 Vali Acc: 0.788 Test Loss: 0.841 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 305922
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.916562557220459
Epoch: 1, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.450 Vali Acc: 0.795 Test Loss: 0.450 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 1.7254204750061035
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
Validation loss decreased (-0.795217 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.6989798545837402
Epoch: 3, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
Validation loss decreased (-0.819108 --> -0.866891).  Saving model ...
Epoch: 4 cost time: 1.232161283493042
Epoch: 4, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.784898281097412
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.418 Vali Acc: 0.846 Test Loss: 0.418 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.668835163116455
Epoch: 6, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.501 Vali Acc: 0.805 Test Loss: 0.501 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5578386783599854
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.460 Vali Acc: 0.843 Test Loss: 0.460 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4996302127838135
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.730 Vali Acc: 0.765 Test Loss: 0.730 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7477726936340332
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.540 Vali Acc: 0.829 Test Loss: 0.540 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.620307445526123
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.738 Vali Acc: 0.788 Test Loss: 0.738 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6914503574371338
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.585 Vali Acc: 0.829 Test Loss: 0.585 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.390761375427246
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.568 Vali Acc: 0.846 Test Loss: 0.568 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8856956958770752
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.782 Vali Acc: 0.792 Test Loss: 0.782 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 302466
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.847245216369629
Epoch: 1, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.5549020767211914
Epoch: 2, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.455 Vali Acc: 0.799 Test Loss: 0.455 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6571063995361328
Epoch: 3, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.440 Vali Acc: 0.802 Test Loss: 0.440 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3512072563171387
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
Validation loss decreased (-0.832760 --> -0.832761).  Saving model ...
Epoch: 5 cost time: 1.6883256435394287
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.401 Vali Acc: 0.843 Test Loss: 0.401 Test Acc: 0.843
Validation loss decreased (-0.832761 --> -0.842999).  Saving model ...
Epoch: 6 cost time: 1.9050655364990234
Epoch: 6, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.497 Vali Acc: 0.805 Test Loss: 0.497 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8265407085418701
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.435 Vali Acc: 0.840 Test Loss: 0.435 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6640136241912842
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.484 Vali Acc: 0.843 Test Loss: 0.484 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6946096420288086
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4403901100158691
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.655 Vali Acc: 0.771 Test Loss: 0.655 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.544905185699463
Epoch: 11, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.556 Vali Acc: 0.819 Test Loss: 0.556 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.604299783706665
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8110880851745605
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.637 Vali Acc: 0.823 Test Loss: 0.637 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6335070133209229
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.696 Vali Acc: 0.805 Test Loss: 0.696 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6457500457763672
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.770 Vali Acc: 0.795 Test Loss: 0.770 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 302082
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.5469725131988525
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.471 Vali Acc: 0.775 Test Loss: 0.471 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.6075642108917236
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.441 Vali Acc: 0.795 Test Loss: 0.441 Test Acc: 0.795
Validation loss decreased (-0.774739 --> -0.795217).  Saving model ...
Epoch: 3 cost time: 1.6547620296478271
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
Validation loss decreased (-0.795217 --> -0.836173).  Saving model ...
Epoch: 4 cost time: 1.8881728649139404
Epoch: 4, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.519 Vali Acc: 0.792 Test Loss: 0.519 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8351969718933105
Epoch: 5, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.480 Vali Acc: 0.795 Test Loss: 0.480 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.290813684463501
Epoch: 6, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.487 Vali Acc: 0.795 Test Loss: 0.487 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6037042140960693
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1478474140167236
Epoch: 8, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.536 Vali Acc: 0.785 Test Loss: 0.536 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5724687576293945
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.577 Vali Acc: 0.805 Test Loss: 0.577 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.323007345199585
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3778691291809082
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.627 Vali Acc: 0.805 Test Loss: 0.627 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.523179054260254
Epoch: 12, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.665 Vali Acc: 0.799 Test Loss: 0.665 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.267876148223877
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 306178
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.740931749343872
Epoch: 1, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.397 Vali Acc: 0.863 Test Loss: 0.397 Test Acc: 0.863
Validation loss decreased (inf --> -0.863477).  Saving model ...
Epoch: 2 cost time: 1.971163272857666
Epoch: 2, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.555 Vali Acc: 0.788 Test Loss: 0.555 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.080048084259033
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.678 Vali Acc: 0.747 Test Loss: 0.678 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.230377197265625
Epoch: 4, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2483303546905518
Epoch: 5, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.816 Vali Acc: 0.802 Test Loss: 0.816 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.313107967376709
Epoch: 6, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.268 Vali Acc: 0.720 Test Loss: 1.268 Test Acc: 0.720
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.946937084197998
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.236 Vali Acc: 0.782 Test Loss: 1.236 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.148386001586914
Epoch: 8, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.756 Vali Acc: 0.867 Test Loss: 0.756 Test Acc: 0.867
Validation loss decreased (-0.863477 --> -0.866887).  Saving model ...
Epoch: 9 cost time: 1.8340799808502197
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.924 Vali Acc: 0.734 Test Loss: 1.924 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.149909734725952
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.056 Vali Acc: 0.823 Test Loss: 1.056 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3647074699401855
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.346 Vali Acc: 0.724 Test Loss: 2.346 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1959891319274902
Epoch: 12, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.636 Vali Acc: 0.802 Test Loss: 1.636 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2059435844421387
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.788 Vali Acc: 0.788 Test Loss: 1.788 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0067880153656006
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.665 Vali Acc: 0.816 Test Loss: 1.665 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.088413953781128
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.845 Vali Acc: 0.778 Test Loss: 1.845 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.181159019470215
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.637 Vali Acc: 0.833 Test Loss: 1.637 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3499391078948975
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.952 Vali Acc: 0.795 Test Loss: 1.952 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.395134925842285
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.918 Vali Acc: 0.782 Test Loss: 1.918 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 316034
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.929506540298462
Epoch: 1, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.462 Vali Acc: 0.782 Test Loss: 0.462 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 1.7175536155700684
Epoch: 2, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.434 Vali Acc: 0.843 Test Loss: 0.434 Test Acc: 0.843
Validation loss decreased (-0.781565 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 1.8012356758117676
Epoch: 3, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.583 Vali Acc: 0.768 Test Loss: 0.583 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0946428775787354
Epoch: 4, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.123443126678467
Epoch: 5, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.632 Vali Acc: 0.795 Test Loss: 0.632 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.467165470123291
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7381203174591064
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.032 Vali Acc: 0.741 Test Loss: 1.032 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1116836071014404
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.746 Vali Acc: 0.799 Test Loss: 0.746 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4570376873016357
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.079 Vali Acc: 0.765 Test Loss: 1.079 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.535796880722046
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.887 Vali Acc: 0.805 Test Loss: 0.887 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.581155300140381
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.049 Vali Acc: 0.802 Test Loss: 1.049 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8549423217773438
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.464 Vali Acc: 0.771 Test Loss: 1.464 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 265090
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.838645935058594
Epoch: 1, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.465 Vali Acc: 0.775 Test Loss: 0.465 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 2.5904297828674316
Epoch: 2, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.545 Vali Acc: 0.765 Test Loss: 0.545 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5594518184661865
Epoch: 3, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.434 Vali Acc: 0.812 Test Loss: 0.434 Test Acc: 0.812
Validation loss decreased (-0.774739 --> -0.812282).  Saving model ...
Epoch: 4 cost time: 2.2280635833740234
Epoch: 4, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.497 Vali Acc: 0.802 Test Loss: 0.497 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.733597755432129
Epoch: 5, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.555 Vali Acc: 0.829 Test Loss: 0.555 Test Acc: 0.829
Validation loss decreased (-0.812282 --> -0.829346).  Saving model ...
Epoch: 6 cost time: 2.3576788902282715
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.647 Vali Acc: 0.795 Test Loss: 0.647 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5090818405151367
Epoch: 7, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.504 Vali Acc: 0.846 Test Loss: 0.504 Test Acc: 0.846
Validation loss decreased (-0.829346 --> -0.846411).  Saving model ...
Epoch: 8 cost time: 1.89070725440979
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.863 Vali Acc: 0.751 Test Loss: 0.863 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3133509159088135
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.694 Vali Acc: 0.809 Test Loss: 0.694 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.254199981689453
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.905 Vali Acc: 0.782 Test Loss: 0.905 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4663374423980713
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.752 Vali Acc: 0.829 Test Loss: 0.752 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.025092363357544
Epoch: 12, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.969 Vali Acc: 0.788 Test Loss: 0.969 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.2026467323303223
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.915 Vali Acc: 0.809 Test Loss: 0.915 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1539852619171143
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.902 Vali Acc: 0.823 Test Loss: 0.902 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3493003845214844
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.196 Vali Acc: 0.771 Test Loss: 1.196 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.906959056854248
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.088 Vali Acc: 0.795 Test Loss: 1.088 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2896008491516113
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.045 Vali Acc: 0.812 Test Loss: 1.045 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 248066
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.457841396331787
Epoch: 1, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.435 Vali Acc: 0.829 Test Loss: 0.435 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.130427837371826
Epoch: 2, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.382 Vali Acc: 0.846 Test Loss: 0.382 Test Acc: 0.846
Validation loss decreased (-0.829347 --> -0.846413).  Saving model ...
Epoch: 3 cost time: 2.283057928085327
Epoch: 3, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3172664642333984
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.528933048248291
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.484 Vali Acc: 0.809 Test Loss: 0.484 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.113060474395752
Epoch: 6, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.510 Vali Acc: 0.823 Test Loss: 0.510 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.75529146194458
Epoch: 7, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.498 Vali Acc: 0.829 Test Loss: 0.498 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5817978382110596
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.703 Vali Acc: 0.788 Test Loss: 0.703 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.440458059310913
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.676 Vali Acc: 0.816 Test Loss: 0.676 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6126046180725098
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.644 Vali Acc: 0.823 Test Loss: 0.644 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.301469087600708
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.716 Vali Acc: 0.802 Test Loss: 0.716 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.916332721710205
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.713 Vali Acc: 0.805 Test Loss: 0.713 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 240130
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.5515296459198
Epoch: 1, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.492 Vali Acc: 0.744 Test Loss: 0.492 Test Acc: 0.744
Validation loss decreased (inf --> -0.744022).  Saving model ...
Epoch: 2 cost time: 2.238596200942993
Epoch: 2, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.455 Vali Acc: 0.785 Test Loss: 0.455 Test Acc: 0.785
Validation loss decreased (-0.744022 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 1.916520357131958
Epoch: 3, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.447 Vali Acc: 0.799 Test Loss: 0.447 Test Acc: 0.799
Validation loss decreased (-0.784978 --> -0.798630).  Saving model ...
Epoch: 4 cost time: 1.8544292449951172
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
Validation loss decreased (-0.798630 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.8610398769378662
Epoch: 5, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.492 Vali Acc: 0.802 Test Loss: 0.492 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6815531253814697
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.422 Vali Acc: 0.840 Test Loss: 0.422 Test Acc: 0.840
Validation loss decreased (-0.822521 --> -0.839586).  Saving model ...
Epoch: 7 cost time: 1.552293300628662
Epoch: 7, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.497 Vali Acc: 0.836 Test Loss: 0.497 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6509623527526855
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.570 Vali Acc: 0.802 Test Loss: 0.570 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.151968479156494
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.562 Vali Acc: 0.823 Test Loss: 0.562 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0781474113464355
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.709 Vali Acc: 0.802 Test Loss: 0.709 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9476771354675293
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.619 Vali Acc: 0.816 Test Loss: 0.619 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.534987211227417
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.068591356277466
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.624 Vali Acc: 0.836 Test Loss: 0.624 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6703081130981445
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.073 Vali Acc: 0.754 Test Loss: 1.073 Test Acc: 0.754
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.096571922302246
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.758 Vali Acc: 0.816 Test Loss: 0.758 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7604634761810303
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.882 Vali Acc: 0.795 Test Loss: 0.882 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 236674
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.917519807815552
Epoch: 1, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.435 Vali Acc: 0.785 Test Loss: 0.435 Test Acc: 0.785
Validation loss decreased (inf --> -0.784979).  Saving model ...
Epoch: 2 cost time: 1.6695613861083984
Epoch: 2, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.411 Vali Acc: 0.802 Test Loss: 0.411 Test Acc: 0.802
Validation loss decreased (-0.784979 --> -0.802044).  Saving model ...
Epoch: 3 cost time: 1.4986588954925537
Epoch: 3, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.441 Vali Acc: 0.792 Test Loss: 0.441 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.091463088989258
Epoch: 4, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.429 Vali Acc: 0.819 Test Loss: 0.429 Test Acc: 0.819
Validation loss decreased (-0.802044 --> -0.819108).  Saving model ...
Epoch: 5 cost time: 1.6560311317443848
Epoch: 5, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.524 Vali Acc: 0.775 Test Loss: 0.524 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6677954196929932
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.408 Vali Acc: 0.853 Test Loss: 0.408 Test Acc: 0.853
Validation loss decreased (-0.819108 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.5233640670776367
Epoch: 7, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6787433624267578
Epoch: 8, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.474 Vali Acc: 0.843 Test Loss: 0.474 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8987996578216553
Epoch: 9, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.505 Vali Acc: 0.833 Test Loss: 0.505 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6753461360931396
Epoch: 10, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9491024017333984
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.695 Vali Acc: 0.782 Test Loss: 0.695 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8625168800354004
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6628003120422363
Epoch: 13, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.660 Vali Acc: 0.805 Test Loss: 0.660 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6913762092590332
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.648 Vali Acc: 0.823 Test Loss: 0.648 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8025169372558594
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.767 Vali Acc: 0.805 Test Loss: 0.767 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.840799331665039
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.603 Vali Acc: 0.853 Test Loss: 0.603 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 236290
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.499667406082153
Epoch: 1, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.483 Vali Acc: 0.775 Test Loss: 0.483 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.5333807468414307
Epoch: 2, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.442 Vali Acc: 0.785 Test Loss: 0.442 Test Acc: 0.785
Validation loss decreased (-0.774739 --> -0.784979).  Saving model ...
Epoch: 3 cost time: 1.3776006698608398
Epoch: 3, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.450 Vali Acc: 0.792 Test Loss: 0.450 Test Acc: 0.792
Validation loss decreased (-0.784979 --> -0.791804).  Saving model ...
Epoch: 4 cost time: 1.6899850368499756
Epoch: 4, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.819 Test Loss: 0.400 Test Acc: 0.819
Validation loss decreased (-0.791804 --> -0.819109).  Saving model ...
Epoch: 5 cost time: 1.3864223957061768
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.432 Vali Acc: 0.802 Test Loss: 0.432 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.664541244506836
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.415 Vali Acc: 0.826 Test Loss: 0.415 Test Acc: 0.826
Validation loss decreased (-0.819109 --> -0.825934).  Saving model ...
Epoch: 7 cost time: 1.5104644298553467
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.492 Vali Acc: 0.802 Test Loss: 0.492 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.020113229751587
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.498 Vali Acc: 0.805 Test Loss: 0.498 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.607086181640625
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.518 Vali Acc: 0.805 Test Loss: 0.518 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5812768936157227
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.549 Vali Acc: 0.802 Test Loss: 0.549 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8821759223937988
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.630 Vali Acc: 0.799 Test Loss: 0.630 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.702728509902954
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.437958002090454
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5658113956451416
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6402907371520996
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8305678367614746
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.673 Vali Acc: 0.823 Test Loss: 0.673 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 240386
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.370484828948975
Epoch: 1, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.515 Vali Acc: 0.761 Test Loss: 0.515 Test Acc: 0.761
Validation loss decreased (inf --> -0.761087).  Saving model ...
Epoch: 2 cost time: 1.9106829166412354
Epoch: 2, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.435 Vali Acc: 0.860 Test Loss: 0.435 Test Acc: 0.860
Validation loss decreased (-0.761087 --> -0.860064).  Saving model ...
Epoch: 3 cost time: 2.3385047912597656
Epoch: 3, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.699 Vali Acc: 0.805 Test Loss: 0.699 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1199352741241455
Epoch: 4, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.993 Vali Acc: 0.747 Test Loss: 0.993 Test Acc: 0.747
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.968688726425171
Epoch: 5, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.149 Vali Acc: 0.741 Test Loss: 1.149 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.969038963317871
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.007 Vali Acc: 0.792 Test Loss: 1.007 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8845884799957275
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.503 Vali Acc: 0.727 Test Loss: 1.503 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.255094528198242
Epoch: 8, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.057 Vali Acc: 0.809 Test Loss: 1.057 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9395091533660889
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.729 Vali Acc: 0.778 Test Loss: 1.729 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.100217580795288
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.443 Vali Acc: 0.826 Test Loss: 1.443 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.191253662109375
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.272 Vali Acc: 0.816 Test Loss: 1.272 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.296753406524658
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.939 Vali Acc: 0.771 Test Loss: 1.939 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 283138
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.4977686405181885
Epoch: 1, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.473 Vali Acc: 0.785 Test Loss: 0.473 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 1.530017614364624
Epoch: 2, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.525 Vali Acc: 0.782 Test Loss: 0.525 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8283848762512207
Epoch: 3, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.548 Vali Acc: 0.782 Test Loss: 0.548 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.794022798538208
Epoch: 4, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.536 Vali Acc: 0.812 Test Loss: 0.536 Test Acc: 0.812
Validation loss decreased (-0.784978 --> -0.812281).  Saving model ...
Epoch: 5 cost time: 2.097649574279785
Epoch: 5, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.532 Vali Acc: 0.846 Test Loss: 0.532 Test Acc: 0.846
Validation loss decreased (-0.812281 --> -0.846411).  Saving model ...
Epoch: 6 cost time: 1.7309746742248535
Epoch: 6, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.659 Vali Acc: 0.788 Test Loss: 0.659 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6841371059417725
Epoch: 7, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.956 Vali Acc: 0.782 Test Loss: 0.956 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.829284429550171
Epoch: 8, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.862 Vali Acc: 0.771 Test Loss: 0.862 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.698763132095337
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.879 Vali Acc: 0.826 Test Loss: 0.879 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.893583059310913
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.897 Vali Acc: 0.812 Test Loss: 0.897 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6803131103515625
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.216 Vali Acc: 0.768 Test Loss: 1.216 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0404744148254395
Epoch: 12, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.908 Vali Acc: 0.829 Test Loss: 0.908 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9203529357910156
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.176 Vali Acc: 0.802 Test Loss: 1.176 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.656867265701294
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.232 Vali Acc: 0.795 Test Loss: 1.232 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8126826286315918
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.173 Vali Acc: 0.819 Test Loss: 1.173 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 232194
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.082418441772461
Epoch: 1, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.399 Vali Acc: 0.826 Test Loss: 0.399 Test Acc: 0.826
Validation loss decreased (inf --> -0.825935).  Saving model ...
Epoch: 2 cost time: 1.9797587394714355
Epoch: 2, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
Validation loss decreased (-0.825935 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 2.0342066287994385
Epoch: 3, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.412 Vali Acc: 0.829 Test Loss: 0.412 Test Acc: 0.829
Validation loss decreased (-0.829347 --> -0.829347).  Saving model ...
Epoch: 4 cost time: 1.9397461414337158
Epoch: 4, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8527276515960693
Epoch: 5, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.676 Vali Acc: 0.775 Test Loss: 0.676 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6978633403778076
Epoch: 6, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7584855556488037
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.636 Vali Acc: 0.805 Test Loss: 0.636 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.056828737258911
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.888 Vali Acc: 0.754 Test Loss: 0.888 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9996140003204346
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.571 Vali Acc: 0.833 Test Loss: 0.571 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832759).  Saving model ...
Epoch: 10 cost time: 1.9263856410980225
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.173 Vali Acc: 0.751 Test Loss: 1.173 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.889091968536377
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.810 Vali Acc: 0.802 Test Loss: 0.810 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0602071285247803
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.989 Vali Acc: 0.778 Test Loss: 0.989 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8104605674743652
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.114 Vali Acc: 0.775 Test Loss: 1.114 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.526622772216797
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.992 Vali Acc: 0.809 Test Loss: 0.992 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7547049522399902
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.205 Vali Acc: 0.788 Test Loss: 1.205 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.804215908050537
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.019 Vali Acc: 0.809 Test Loss: 1.019 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.793198585510254
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.280 Vali Acc: 0.782 Test Loss: 1.280 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.41827130317688
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.170 Vali Acc: 0.799 Test Loss: 1.170 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2372524738311768
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.288 Vali Acc: 0.785 Test Loss: 1.288 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 215170
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.536287546157837
Epoch: 1, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.485 Vali Acc: 0.785 Test Loss: 0.485 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 1.8887860774993896
Epoch: 2, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.488 Vali Acc: 0.788 Test Loss: 0.488 Test Acc: 0.788
Validation loss decreased (-0.784978 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 2.273700714111328
Epoch: 3, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
Validation loss decreased (-0.788391 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.8835093975067139
Epoch: 4, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.363 Vali Acc: 0.867 Test Loss: 0.363 Test Acc: 0.867
Validation loss decreased (-0.819108 --> -0.866891).  Saving model ...
Epoch: 5 cost time: 1.6794545650482178
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.478 Vali Acc: 0.805 Test Loss: 0.478 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1392104625701904
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.456 Vali Acc: 0.833 Test Loss: 0.456 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9391217231750488
Epoch: 7, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8266675472259521
Epoch: 8, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.600 Vali Acc: 0.826 Test Loss: 0.600 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8957645893096924
Epoch: 9, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.678 Vali Acc: 0.792 Test Loss: 0.678 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5718789100646973
Epoch: 10, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.627 Vali Acc: 0.826 Test Loss: 0.627 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.66778564453125
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.896 Vali Acc: 0.771 Test Loss: 0.896 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7139718532562256
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.840 Vali Acc: 0.799 Test Loss: 0.840 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8271028995513916
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.818 Vali Acc: 0.809 Test Loss: 0.818 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6689097881317139
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.723 Vali Acc: 0.829 Test Loss: 0.723 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 207234
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.770735740661621
Epoch: 1, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.427 Vali Acc: 0.829 Test Loss: 0.427 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 2.3141651153564453
Epoch: 2, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.484 Vali Acc: 0.768 Test Loss: 0.484 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9538216590881348
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
Validation loss decreased (-0.829347 --> -0.866891).  Saving model ...
Epoch: 4 cost time: 2.2607133388519287
Epoch: 4, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.500 Vali Acc: 0.788 Test Loss: 0.500 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6173229217529297
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2931134700775146
Epoch: 6, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.441 Vali Acc: 0.829 Test Loss: 0.441 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9980628490447998
Epoch: 7, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.519 Vali Acc: 0.802 Test Loss: 0.519 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.13299298286438
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.598 Vali Acc: 0.788 Test Loss: 0.598 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2925071716308594
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.591 Vali Acc: 0.802 Test Loss: 0.591 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2317042350769043
Epoch: 10, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.600 Vali Acc: 0.833 Test Loss: 0.600 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1573610305786133
Epoch: 11, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.614 Vali Acc: 0.819 Test Loss: 0.614 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1877026557922363
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.709 Vali Acc: 0.812 Test Loss: 0.709 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0614821910858154
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.681 Vali Acc: 0.823 Test Loss: 0.681 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 203778
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.241219997406006
Epoch: 1, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.496 Vali Acc: 0.737 Test Loss: 0.496 Test Acc: 0.737
Validation loss decreased (inf --> -0.737196).  Saving model ...
Epoch: 2 cost time: 1.930466651916504
Epoch: 2, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.413 Vali Acc: 0.826 Test Loss: 0.413 Test Acc: 0.826
Validation loss decreased (-0.737196 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 1.569580316543579
Epoch: 3, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.488 Vali Acc: 0.768 Test Loss: 0.488 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5482125282287598
Epoch: 4, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.475 Vali Acc: 0.788 Test Loss: 0.475 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4559838771820068
Epoch: 5, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.566230058670044
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.386 Vali Acc: 0.853 Test Loss: 0.386 Test Acc: 0.853
Validation loss decreased (-0.825934 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.8114690780639648
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.577 Vali Acc: 0.795 Test Loss: 0.577 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.735391616821289
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.517 Vali Acc: 0.819 Test Loss: 0.517 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4330878257751465
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.541 Vali Acc: 0.829 Test Loss: 0.541 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4531357288360596
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.485 Vali Acc: 0.843 Test Loss: 0.485 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5780715942382812
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.643 Vali Acc: 0.795 Test Loss: 0.643 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5550003051757812
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.595 Vali Acc: 0.812 Test Loss: 0.595 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7719144821166992
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7076590061187744
Epoch: 14, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9311504364013672
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.743 Vali Acc: 0.799 Test Loss: 0.743 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6016404628753662
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 203394
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.853480100631714
Epoch: 1, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.451 Vali Acc: 0.778 Test Loss: 0.451 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 1.6631124019622803
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.354 Vali Acc: 0.836 Test Loss: 0.354 Test Acc: 0.836
Validation loss decreased (-0.778152 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 1.9369127750396729
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.443 Vali Acc: 0.799 Test Loss: 0.443 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.034907817840576
Epoch: 4, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.453 Vali Acc: 0.799 Test Loss: 0.453 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.715742588043213
Epoch: 5, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.027691125869751
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.471 Vali Acc: 0.805 Test Loss: 0.471 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0956571102142334
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.489 Vali Acc: 0.795 Test Loss: 0.489 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.073040008544922
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.517 Vali Acc: 0.799 Test Loss: 0.517 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.727663516998291
Epoch: 9, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.587 Vali Acc: 0.788 Test Loss: 0.587 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9856808185577393
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.480 Vali Acc: 0.833 Test Loss: 0.480 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0325262546539307
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.694 Vali Acc: 0.771 Test Loss: 0.694 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.133058547973633
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.648 Vali Acc: 0.812 Test Loss: 0.648 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm128_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 207490
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.7940309047698975
Epoch: 1, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.359 Vali Acc: 0.881 Test Loss: 0.359 Test Acc: 0.881
Validation loss decreased (inf --> -0.880542).  Saving model ...
Epoch: 2 cost time: 2.188263416290283
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.455 Vali Acc: 0.792 Test Loss: 0.455 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3407068252563477
Epoch: 3, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8844399452209473
Epoch: 4, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0590128898620605
Epoch: 5, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.501 Vali Acc: 0.853 Test Loss: 0.501 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9178383350372314
Epoch: 6, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.605 Vali Acc: 0.778 Test Loss: 0.605 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9208478927612305
Epoch: 7, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.900000810623169
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.831 Vali Acc: 0.771 Test Loss: 0.831 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2048158645629883
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.927 Vali Acc: 0.771 Test Loss: 0.927 Test Acc: 0.771
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.036562442779541
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.851 Vali Acc: 0.819 Test Loss: 0.851 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.28371262550354
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.860 Vali Acc: 0.809 Test Loss: 0.860 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 158402
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.646496295928955
Epoch: 1, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
Validation loss decreased (inf --> -0.829348).  Saving model ...
Epoch: 2 cost time: 1.4972193241119385
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
Validation loss decreased (-0.829348 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.6781728267669678
Epoch: 3, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.404 Vali Acc: 0.840 Test Loss: 0.404 Test Acc: 0.840
Validation loss decreased (-0.832760 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.7626848220825195
Epoch: 4, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.420 Vali Acc: 0.816 Test Loss: 0.420 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.045769214630127
Epoch: 5, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8897466659545898
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.578 Vali Acc: 0.758 Test Loss: 0.578 Test Acc: 0.758
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1908042430877686
Epoch: 7, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9470651149749756
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0134122371673584
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6782441139221191
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.755 Vali Acc: 0.782 Test Loss: 0.755 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1285386085510254
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.813 Vali Acc: 0.778 Test Loss: 0.813 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.7309772968292236
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7810068130493164
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.084 Vali Acc: 0.754 Test Loss: 1.084 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 132930
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.670509338378906
Epoch: 1, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.440 Vali Acc: 0.805 Test Loss: 0.440 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 2.221163272857666
Epoch: 2, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.432 Vali Acc: 0.799 Test Loss: 0.432 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.399109363555908
Epoch: 3, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.396 Vali Acc: 0.836 Test Loss: 0.396 Test Acc: 0.836
Validation loss decreased (-0.805456 --> -0.836174).  Saving model ...
Epoch: 4 cost time: 2.050926446914673
Epoch: 4, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.413 Vali Acc: 0.819 Test Loss: 0.413 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4177329540252686
Epoch: 5, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.093427896499634
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.483 Vali Acc: 0.823 Test Loss: 0.483 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5213513374328613
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1232547760009766
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.475 Vali Acc: 0.833 Test Loss: 0.475 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9597797393798828
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.566 Vali Acc: 0.836 Test Loss: 0.566 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8858177661895752
Epoch: 10, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.575 Vali Acc: 0.805 Test Loss: 0.575 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.365743398666382
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3839657306671143
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.717 Vali Acc: 0.799 Test Loss: 0.717 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4589760303497314
Epoch: 13, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.736 Vali Acc: 0.782 Test Loss: 0.736 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 124418
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.20012640953064
Epoch: 1, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.517 Vali Acc: 0.775 Test Loss: 0.517 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 2.0189478397369385
Epoch: 2, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.435 Vali Acc: 0.802 Test Loss: 0.435 Test Acc: 0.802
Validation loss decreased (-0.774739 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.6834757328033447
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.438 Vali Acc: 0.805 Test Loss: 0.438 Test Acc: 0.805
Validation loss decreased (-0.802043 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.513542652130127
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.414 Vali Acc: 0.805 Test Loss: 0.414 Test Acc: 0.805
Validation loss decreased (-0.805456 --> -0.805457).  Saving model ...
Epoch: 5 cost time: 1.7502846717834473
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
Validation loss decreased (-0.805457 --> -0.812283).  Saving model ...
Epoch: 6 cost time: 1.7061944007873535
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.482 Vali Acc: 0.802 Test Loss: 0.482 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3513002395629883
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.478 Vali Acc: 0.788 Test Loss: 0.478 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.93233323097229
Epoch: 8, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.544 Vali Acc: 0.795 Test Loss: 0.544 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8086378574371338
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.452 Vali Acc: 0.829 Test Loss: 0.452 Test Acc: 0.829
Validation loss decreased (-0.812283 --> -0.829347).  Saving model ...
Epoch: 10 cost time: 1.8755404949188232
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.581 Vali Acc: 0.785 Test Loss: 0.581 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2187156677246094
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.598 Vali Acc: 0.792 Test Loss: 0.598 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9232008457183838
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.570 Vali Acc: 0.833 Test Loss: 0.570 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832759).  Saving model ...
Epoch: 13 cost time: 1.5334439277648926
Epoch: 13, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.628 Vali Acc: 0.802 Test Loss: 0.628 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7750370502471924
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.635 Vali Acc: 0.805 Test Loss: 0.635 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8431940078735352
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.737 Vali Acc: 0.778 Test Loss: 0.737 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6728367805480957
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.669 Vali Acc: 0.816 Test Loss: 0.669 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6018390655517578
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.822 Vali Acc: 0.775 Test Loss: 0.822 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9894311428070068
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.800 Vali Acc: 0.788 Test Loss: 0.800 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1946020126342773
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.779 Vali Acc: 0.792 Test Loss: 0.779 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6375491619110107
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.810 Vali Acc: 0.812 Test Loss: 0.810 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6607656478881836
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.933 Vali Acc: 0.782 Test Loss: 0.933 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5922040939331055
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.844 Vali Acc: 0.795 Test Loss: 0.844 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 120450
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.710970401763916
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.466 Vali Acc: 0.816 Test Loss: 0.466 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.4683046340942383
Epoch: 2, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.426 Vali Acc: 0.816 Test Loss: 0.426 Test Acc: 0.816
Validation loss decreased (-0.815695 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 1.8159496784210205
Epoch: 3, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.436 Vali Acc: 0.792 Test Loss: 0.436 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9909605979919434
Epoch: 4, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.403 Vali Acc: 0.840 Test Loss: 0.403 Test Acc: 0.840
Validation loss decreased (-0.815695 --> -0.839586).  Saving model ...
Epoch: 5 cost time: 1.7220473289489746
Epoch: 5, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.381 Vali Acc: 0.853 Test Loss: 0.381 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853239).  Saving model ...
Epoch: 6 cost time: 1.9713923931121826
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.392 Vali Acc: 0.846 Test Loss: 0.392 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9440867900848389
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.455 Vali Acc: 0.819 Test Loss: 0.455 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1128814220428467
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.424 Vali Acc: 0.850 Test Loss: 0.424 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8229656219482422
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.440 Vali Acc: 0.836 Test Loss: 0.440 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.985868215560913
Epoch: 10, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6179282665252686
Epoch: 11, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9603443145751953
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.478 Vali Acc: 0.836 Test Loss: 0.478 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7396667003631592
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.555 Vali Acc: 0.819 Test Loss: 0.555 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9504153728485107
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6668157577514648
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.585 Vali Acc: 0.805 Test Loss: 0.585 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 118722
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.07191276550293
Epoch: 1, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.485 Vali Acc: 0.826 Test Loss: 0.485 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 2.1603307723999023
Epoch: 2, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.421 Vali Acc: 0.816 Test Loss: 0.421 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8100216388702393
Epoch: 3, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832761).  Saving model ...
Epoch: 4 cost time: 1.6939353942871094
Epoch: 4, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.404 Vali Acc: 0.840 Test Loss: 0.404 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839586).  Saving model ...
Epoch: 5 cost time: 1.987623691558838
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.058058023452759
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9935545921325684
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.414 Vali Acc: 0.843 Test Loss: 0.414 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.842999).  Saving model ...
Epoch: 8 cost time: 1.7816672325134277
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.411 Vali Acc: 0.853 Test Loss: 0.411 Test Acc: 0.853
Validation loss decreased (-0.842999 --> -0.853238).  Saving model ...
Epoch: 9 cost time: 2.6352522373199463
Epoch: 9, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.417 Vali Acc: 0.843 Test Loss: 0.417 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.425795793533325
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.402 Vali Acc: 0.860 Test Loss: 0.402 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860064).  Saving model ...
Epoch: 11 cost time: 2.2664644718170166
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.474 Vali Acc: 0.819 Test Loss: 0.474 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3625824451446533
Epoch: 12, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.428 Vali Acc: 0.863 Test Loss: 0.428 Test Acc: 0.863
Validation loss decreased (-0.860064 --> -0.863477).  Saving model ...
Epoch: 13 cost time: 2.0881879329681396
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.666 Vali Acc: 0.765 Test Loss: 0.666 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3284151554107666
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.491 Vali Acc: 0.836 Test Loss: 0.491 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.214507818222046
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.546 Vali Acc: 0.823 Test Loss: 0.546 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.221752405166626
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.480 Vali Acc: 0.850 Test Loss: 0.480 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4253768920898438
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.602 Vali Acc: 0.802 Test Loss: 0.602 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8813397884368896
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0644242763519287
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.577 Vali Acc: 0.829 Test Loss: 0.577 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6755783557891846
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.634 Vali Acc: 0.805 Test Loss: 0.634 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4924538135528564
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.609 Vali Acc: 0.819 Test Loss: 0.609 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4403891563415527
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.692 Vali Acc: 0.799 Test Loss: 0.692 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 118530
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.8845038414001465
Epoch: 1, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.485 Vali Acc: 0.823 Test Loss: 0.485 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.7318506240844727
Epoch: 2, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9517881870269775
Epoch: 3, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.409 Vali Acc: 0.809 Test Loss: 0.409 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.799159288406372
Epoch: 4, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8979127407073975
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.400 Vali Acc: 0.823 Test Loss: 0.400 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822522).  Saving model ...
Epoch: 6 cost time: 1.8391273021697998
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.380 Vali Acc: 0.843 Test Loss: 0.380 Test Acc: 0.843
Validation loss decreased (-0.822522 --> -0.843000).  Saving model ...
Epoch: 7 cost time: 2.460832118988037
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.364 Vali Acc: 0.843 Test Loss: 0.364 Test Acc: 0.843
Validation loss decreased (-0.843000 --> -0.843000).  Saving model ...
Epoch: 8 cost time: 2.1964709758758545
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.426 Vali Acc: 0.819 Test Loss: 0.426 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7116646766662598
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.460 Vali Acc: 0.823 Test Loss: 0.460 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5013277530670166
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.439 Vali Acc: 0.836 Test Loss: 0.439 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3581902980804443
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.374887704849243
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.520 Vali Acc: 0.802 Test Loss: 0.520 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.385857582092285
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.519 Vali Acc: 0.823 Test Loss: 0.519 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.216970920562744
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.532 Vali Acc: 0.823 Test Loss: 0.532 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.150515079498291
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.607 Vali Acc: 0.788 Test Loss: 0.607 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3159215450286865
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.562 Vali Acc: 0.823 Test Loss: 0.562 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1473968029022217
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.557 Vali Acc: 0.823 Test Loss: 0.557 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 120578
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.091041564941406
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.446 Vali Acc: 0.805 Test Loss: 0.446 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 2.763929843902588
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.459 Vali Acc: 0.799 Test Loss: 0.459 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3091461658477783
Epoch: 3, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.476 Vali Acc: 0.788 Test Loss: 0.476 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.948434829711914
Epoch: 4, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.534 Vali Acc: 0.805 Test Loss: 0.534 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2855029106140137
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.564 Vali Acc: 0.799 Test Loss: 0.564 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.846837282180786
Epoch: 6, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.689 Vali Acc: 0.788 Test Loss: 0.689 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8370256423950195
Epoch: 7, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2039852142333984
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.713 Vali Acc: 0.826 Test Loss: 0.713 Test Acc: 0.826
Validation loss decreased (-0.805456 --> -0.825931).  Saving model ...
Epoch: 9 cost time: 2.026492118835449
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.929 Vali Acc: 0.754 Test Loss: 0.929 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2828497886657715
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.910 Vali Acc: 0.785 Test Loss: 0.910 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8181653022766113
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.836 Test Loss: 0.742 Test Acc: 0.836
Validation loss decreased (-0.825931 --> -0.836170).  Saving model ...
Epoch: 12 cost time: 2.836599111557007
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.340 Vali Acc: 0.737 Test Loss: 1.340 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7790756225585938
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.951 Vali Acc: 0.805 Test Loss: 0.951 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0209290981292725
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.484 Vali Acc: 0.744 Test Loss: 1.484 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.146746873855591
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.072 Vali Acc: 0.805 Test Loss: 1.072 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1577680110931396
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.421 Vali Acc: 0.765 Test Loss: 1.421 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.721550703048706
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.317 Vali Acc: 0.795 Test Loss: 1.317 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1256349086761475
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.305 Vali Acc: 0.799 Test Loss: 1.305 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.1598901748657227
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.913 Vali Acc: 0.727 Test Loss: 1.913 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4636218547821045
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.309 Vali Acc: 0.799 Test Loss: 1.309 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6212353706359863
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.695 Vali Acc: 0.785 Test Loss: 1.695 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 125378
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.704456806182861
Epoch: 1, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.465 Vali Acc: 0.778 Test Loss: 0.465 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 3.1929917335510254
Epoch: 2, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.426 Vali Acc: 0.840 Test Loss: 0.426 Test Acc: 0.840
Validation loss decreased (-0.778152 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.5580716133117676
Epoch: 3, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.461 Vali Acc: 0.799 Test Loss: 0.461 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.436511278152466
Epoch: 4, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.458 Vali Acc: 0.805 Test Loss: 0.458 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4049487113952637
Epoch: 5, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.514 Vali Acc: 0.795 Test Loss: 0.514 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0875909328460693
Epoch: 6, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.450 Vali Acc: 0.853 Test Loss: 0.450 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853238).  Saving model ...
Epoch: 7 cost time: 1.7165465354919434
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.672 Vali Acc: 0.771 Test Loss: 0.672 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.999499797821045
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.565 Vali Acc: 0.826 Test Loss: 0.565 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.617556571960449
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.747 Vali Acc: 0.765 Test Loss: 0.747 Test Acc: 0.765
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1065120697021484
Epoch: 10, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.814 Vali Acc: 0.765 Test Loss: 0.814 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7756755352020264
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.751 Vali Acc: 0.812 Test Loss: 0.751 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.939396619796753
Epoch: 12, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.844 Vali Acc: 0.785 Test Loss: 0.844 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.866347551345825
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.851 Vali Acc: 0.795 Test Loss: 0.851 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.290239095687866
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.858 Vali Acc: 0.812 Test Loss: 0.858 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0767662525177
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.888 Vali Acc: 0.816 Test Loss: 0.888 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.361865520477295
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.158 Vali Acc: 0.778 Test Loss: 1.158 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 99906
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.079646348953247
Epoch: 1, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.464 Vali Acc: 0.785 Test Loss: 0.464 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 2.775724411010742
Epoch: 2, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.446 Vali Acc: 0.782 Test Loss: 0.446 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.135226011276245
Epoch: 3, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.434 Vali Acc: 0.799 Test Loss: 0.434 Test Acc: 0.799
Validation loss decreased (-0.784978 --> -0.798630).  Saving model ...
Epoch: 4 cost time: 3.3719563484191895
Epoch: 4, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.459 Vali Acc: 0.792 Test Loss: 0.459 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.285051107406616
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
Validation loss decreased (-0.798630 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 2.742579936981201
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.470 Vali Acc: 0.829 Test Loss: 0.470 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8641116619110107
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.016289234161377
Epoch: 8, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.573 Vali Acc: 0.802 Test Loss: 0.573 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4843170642852783
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3034727573394775
Epoch: 10, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.610 Vali Acc: 0.799 Test Loss: 0.610 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5605685710906982
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.577 Vali Acc: 0.823 Test Loss: 0.577 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3269715309143066
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.593 Vali Acc: 0.812 Test Loss: 0.593 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4434640407562256
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.682 Vali Acc: 0.792 Test Loss: 0.682 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9165685176849365
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.701 Vali Acc: 0.816 Test Loss: 0.701 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.695373296737671
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.680 Vali Acc: 0.812 Test Loss: 0.680 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 91394
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.977017641067505
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.466 Vali Acc: 0.802 Test Loss: 0.466 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 2.295041084289551
Epoch: 2, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.397 Vali Acc: 0.823 Test Loss: 0.397 Test Acc: 0.823
Validation loss decreased (-0.802043 --> -0.822522).  Saving model ...
Epoch: 3 cost time: 2.1559581756591797
Epoch: 3, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.507 Vali Acc: 0.761 Test Loss: 0.507 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4605348110198975
Epoch: 4, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.417 Vali Acc: 0.823 Test Loss: 0.417 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.163541078567505
Epoch: 5, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
Validation loss decreased (-0.822522 --> -0.849825).  Saving model ...
Epoch: 6 cost time: 2.03328537940979
Epoch: 6, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.520 Vali Acc: 0.802 Test Loss: 0.520 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2708208560943604
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0904381275177
Epoch: 8, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.464 Vali Acc: 0.819 Test Loss: 0.464 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7153587341308594
Epoch: 9, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6252837181091309
Epoch: 10, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.528 Vali Acc: 0.816 Test Loss: 0.528 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.925947904586792
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.185168504714966
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.161386728286743
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.607 Vali Acc: 0.795 Test Loss: 0.607 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4730281829833984
Epoch: 14, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.696 Vali Acc: 0.788 Test Loss: 0.696 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.282193183898926
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.736 Vali Acc: 0.782 Test Loss: 0.736 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 87426
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.081390857696533
Epoch: 1, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.491 Vali Acc: 0.775 Test Loss: 0.491 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 2.1714725494384766
Epoch: 2, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
Validation loss decreased (-0.774739 --> -0.822522).  Saving model ...
Epoch: 3 cost time: 2.1176815032958984
Epoch: 3, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
Validation loss decreased (-0.822522 --> -0.832761).  Saving model ...
Epoch: 4 cost time: 2.2230844497680664
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.391632556915283
Epoch: 5, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.395 Vali Acc: 0.843 Test Loss: 0.395 Test Acc: 0.843
Validation loss decreased (-0.832761 --> -0.842999).  Saving model ...
Epoch: 6 cost time: 2.4194722175598145
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.466 Vali Acc: 0.809 Test Loss: 0.466 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0408918857574463
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.424 Vali Acc: 0.819 Test Loss: 0.424 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8662171363830566
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5576517581939697
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.481 Vali Acc: 0.799 Test Loss: 0.481 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.776637554168701
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0945847034454346
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.511 Vali Acc: 0.805 Test Loss: 0.511 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9850785732269287
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.522 Vali Acc: 0.812 Test Loss: 0.522 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.269273042678833
Epoch: 13, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.582 Vali Acc: 0.788 Test Loss: 0.582 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4341678619384766
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.551 Vali Acc: 0.805 Test Loss: 0.551 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.036362409591675
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 85698
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.88991379737854
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 1.6864690780639648
Epoch: 2, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
Validation loss decreased (-0.726957 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 1.8181273937225342
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.409 Vali Acc: 0.833 Test Loss: 0.409 Test Acc: 0.833
Validation loss decreased (-0.815695 --> -0.832760).  Saving model ...
Epoch: 4 cost time: 2.0407931804656982
Epoch: 4, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.372 Vali Acc: 0.853 Test Loss: 0.372 Test Acc: 0.853
Validation loss decreased (-0.832760 --> -0.853239).  Saving model ...
Epoch: 5 cost time: 2.4222419261932373
Epoch: 5, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.407 Vali Acc: 0.833 Test Loss: 0.407 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1837291717529297
Epoch: 6, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.380 Vali Acc: 0.853 Test Loss: 0.380 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.950129747390747
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.452 Vali Acc: 0.826 Test Loss: 0.452 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6228771209716797
Epoch: 8, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.407 Vali Acc: 0.840 Test Loss: 0.407 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.873356580734253
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.494 Vali Acc: 0.795 Test Loss: 0.494 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5273818969726562
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.437 Vali Acc: 0.840 Test Loss: 0.437 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.400519609451294
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
Validation loss decreased (-0.853239 --> -0.870303).  Saving model ...
Epoch: 12 cost time: 2.1433229446411133
Epoch: 12, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4646542072296143
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.527 Vali Acc: 0.799 Test Loss: 0.527 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8033878803253174
Epoch: 14, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.559 Vali Acc: 0.788 Test Loss: 0.559 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0151891708374023
Epoch: 15, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8791630268096924
Epoch: 16, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4066641330718994
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.622 Vali Acc: 0.788 Test Loss: 0.622 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0616672039031982
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.664 Vali Acc: 0.792 Test Loss: 0.664 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1527037620544434
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0739266872406006
Epoch: 20, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.690 Vali Acc: 0.785 Test Loss: 0.690 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2504026889801025
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.622 Vali Acc: 0.805 Test Loss: 0.622 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 85506
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.795771837234497
Epoch: 1, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.644 Vali Acc: 0.618 Test Loss: 0.644 Test Acc: 0.618
Validation loss decreased (inf --> -0.617741).  Saving model ...
Epoch: 2 cost time: 1.8450524806976318
Epoch: 2, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.421 Vali Acc: 0.788 Test Loss: 0.421 Test Acc: 0.788
Validation loss decreased (-0.617741 --> -0.788392).  Saving model ...
Epoch: 3 cost time: 2.3099429607391357
Epoch: 3, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.469 Vali Acc: 0.799 Test Loss: 0.469 Test Acc: 0.799
Validation loss decreased (-0.788392 --> -0.798630).  Saving model ...
Epoch: 4 cost time: 1.3549768924713135
Epoch: 4, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.410 Vali Acc: 0.819 Test Loss: 0.410 Test Acc: 0.819
Validation loss decreased (-0.798630 --> -0.819109).  Saving model ...
Epoch: 5 cost time: 2.6224424839019775
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
Validation loss decreased (-0.819109 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 2.1889495849609375
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.366 Vali Acc: 0.850 Test Loss: 0.366 Test Acc: 0.850
Validation loss decreased (-0.836174 --> -0.849826).  Saving model ...
Epoch: 7 cost time: 1.947645902633667
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.442 Vali Acc: 0.816 Test Loss: 0.442 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9465217590332031
Epoch: 8, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.421 Vali Acc: 0.829 Test Loss: 0.421 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.05336594581604
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.422 Vali Acc: 0.816 Test Loss: 0.422 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9866385459899902
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.455 Vali Acc: 0.836 Test Loss: 0.455 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4905712604522705
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0475142002105713
Epoch: 12, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.540 Vali Acc: 0.795 Test Loss: 0.540 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2942004203796387
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.405 Vali Acc: 0.850 Test Loss: 0.405 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5691916942596436
Epoch: 14, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.624 Vali Acc: 0.778 Test Loss: 0.624 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.568972587585449
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3653626441955566
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.577 Vali Acc: 0.795 Test Loss: 0.577 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 87554
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.937669038772583
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.410 Vali Acc: 0.812 Test Loss: 0.410 Test Acc: 0.812
Validation loss decreased (inf --> -0.812283).  Saving model ...
Epoch: 2 cost time: 2.951892375946045
Epoch: 2, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.512 Vali Acc: 0.754 Test Loss: 0.512 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6707606315612793
Epoch: 3, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.513 Vali Acc: 0.792 Test Loss: 0.513 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.858240842819214
Epoch: 4, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.659 Vali Acc: 0.792 Test Loss: 0.659 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1085147857666016
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.562 Vali Acc: 0.823 Test Loss: 0.562 Test Acc: 0.823
Validation loss decreased (-0.812283 --> -0.822520).  Saving model ...
Epoch: 6 cost time: 3.4384663105010986
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.645 Vali Acc: 0.802 Test Loss: 0.645 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.979559898376465
Epoch: 7, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.534 Vali Acc: 0.826 Test Loss: 0.534 Test Acc: 0.826
Validation loss decreased (-0.822520 --> -0.825933).  Saving model ...
Epoch: 8 cost time: 3.184767723083496
Epoch: 8, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.968 Vali Acc: 0.754 Test Loss: 0.968 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1129651069641113
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.725 Vali Acc: 0.819 Test Loss: 0.725 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.826470375061035
Epoch: 10, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.813 Vali Acc: 0.816 Test Loss: 0.813 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.981074094772339
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.153 Vali Acc: 0.758 Test Loss: 1.153 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1394052505493164
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.966 Vali Acc: 0.816 Test Loss: 0.966 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0841128826141357
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.431 Vali Acc: 0.734 Test Loss: 1.431 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.73264741897583
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.160 Vali Acc: 0.799 Test Loss: 1.160 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9227542877197266
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.317 Vali Acc: 0.765 Test Loss: 1.317 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7516467571258545
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.217 Vali Acc: 0.778 Test Loss: 1.217 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.079162120819092
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.373 Vali Acc: 0.782 Test Loss: 1.373 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 108866
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.529331922531128
Epoch: 1, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.477 Vali Acc: 0.758 Test Loss: 0.477 Test Acc: 0.758
Validation loss decreased (inf --> -0.757674).  Saving model ...
Epoch: 2 cost time: 2.799530506134033
Epoch: 2, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
Validation loss decreased (-0.757674 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.318922758102417
Epoch: 3, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808868).  Saving model ...
Epoch: 4 cost time: 2.659642219543457
Epoch: 4, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.530 Vali Acc: 0.792 Test Loss: 0.530 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5961625576019287
Epoch: 5, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.812 Test Loss: 0.481 Test Acc: 0.812
Validation loss decreased (-0.808868 --> -0.812282).  Saving model ...
Epoch: 6 cost time: 2.4554924964904785
Epoch: 6, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4545271396636963
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.545 Vali Acc: 0.819 Test Loss: 0.545 Test Acc: 0.819
Validation loss decreased (-0.812282 --> -0.819107).  Saving model ...
Epoch: 8 cost time: 1.7827873229980469
Epoch: 8, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.870 Vali Acc: 0.724 Test Loss: 0.870 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1583633422851562
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.822 Vali Acc: 0.761 Test Loss: 0.822 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3863139152526855
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.832 Vali Acc: 0.771 Test Loss: 0.832 Test Acc: 0.771
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7276618480682373
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.781 Vali Acc: 0.795 Test Loss: 0.781 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4720122814178467
Epoch: 12, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1146585941314697
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.869 Vali Acc: 0.788 Test Loss: 0.869 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4426372051239014
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.921 Vali Acc: 0.792 Test Loss: 0.921 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3436391353607178
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.951 Vali Acc: 0.802 Test Loss: 0.951 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2564358711242676
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.971 Vali Acc: 0.782 Test Loss: 0.971 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2438151836395264
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.085 Vali Acc: 0.788 Test Loss: 1.085 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8191126279863481
model parameter : 83394
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.061026573181152
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 2.294050455093384
Epoch: 2, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.439 Vali Acc: 0.795 Test Loss: 0.439 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.079935312271118
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.438 Vali Acc: 0.802 Test Loss: 0.438 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.289811611175537
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.480 Vali Acc: 0.802 Test Loss: 0.480 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5374326705932617
Epoch: 5, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
Validation loss decreased (-0.819108 --> -0.832760).  Saving model ...
Epoch: 6 cost time: 2.945160388946533
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.458 Vali Acc: 0.819 Test Loss: 0.458 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3583879470825195
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.428 Vali Acc: 0.836 Test Loss: 0.428 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 8 cost time: 2.332645893096924
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.558 Vali Acc: 0.778 Test Loss: 0.558 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8353173732757568
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.560 Vali Acc: 0.802 Test Loss: 0.560 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.151373863220215
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6863329410552979
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.584 Vali Acc: 0.805 Test Loss: 0.584 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.023451805114746
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.616 Vali Acc: 0.788 Test Loss: 0.616 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8202869892120361
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.759 Vali Acc: 0.785 Test Loss: 0.759 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2107486724853516
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1986913681030273
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.834 Vali Acc: 0.788 Test Loss: 0.834 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2624282836914062
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.836 Vali Acc: 0.788 Test Loss: 0.836 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.321044445037842
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.888 Vali Acc: 0.782 Test Loss: 0.888 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 74882
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.332024097442627
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.481 Vali Acc: 0.805 Test Loss: 0.481 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 2.290214776992798
Epoch: 2, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.383 Vali Acc: 0.836 Test Loss: 0.383 Test Acc: 0.836
Validation loss decreased (-0.805456 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 1.8819735050201416
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.423 Vali Acc: 0.812 Test Loss: 0.423 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.008089303970337
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.414 Vali Acc: 0.809 Test Loss: 0.414 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.262089729309082
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.402 Vali Acc: 0.836 Test Loss: 0.402 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.163670063018799
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9541609287261963
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.617 Vali Acc: 0.758 Test Loss: 0.617 Test Acc: 0.758
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2898263931274414
Epoch: 8, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.461 Vali Acc: 0.829 Test Loss: 0.461 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.188807964324951
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0266778469085693
Epoch: 10, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.572 Vali Acc: 0.805 Test Loss: 0.572 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8096165657043457
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.535 Vali Acc: 0.823 Test Loss: 0.535 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7351582050323486
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.625 Vali Acc: 0.805 Test Loss: 0.625 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 70914
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.170383930206299
Epoch: 1, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.488 Vali Acc: 0.792 Test Loss: 0.488 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.6163628101348877
Epoch: 2, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.433 Vali Acc: 0.792 Test Loss: 0.433 Test Acc: 0.792
Validation loss decreased (-0.791804 --> -0.791805).  Saving model ...
Epoch: 3 cost time: 1.7465860843658447
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.425 Vali Acc: 0.805 Test Loss: 0.425 Test Acc: 0.805
Validation loss decreased (-0.791805 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.9173054695129395
Epoch: 4, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
Validation loss decreased (-0.805456 --> -0.829348).  Saving model ...
Epoch: 5 cost time: 2.077976703643799
Epoch: 5, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.397 Vali Acc: 0.840 Test Loss: 0.397 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 2.1168200969696045
Epoch: 6, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9519047737121582
Epoch: 7, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.277806282043457
Epoch: 8, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.507 Vali Acc: 0.802 Test Loss: 0.507 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.989619255065918
Epoch: 9, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1203436851501465
Epoch: 10, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1499860286712646
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.469 Vali Acc: 0.819 Test Loss: 0.469 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.937906265258789
Epoch: 12, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.520 Vali Acc: 0.836 Test Loss: 0.520 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.159102439880371
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.599 Vali Acc: 0.819 Test Loss: 0.599 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8546085357666016
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.560 Vali Acc: 0.823 Test Loss: 0.560 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6273090839385986
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.553 Vali Acc: 0.833 Test Loss: 0.553 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 69186
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.396784067153931
Epoch: 1, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.474 Vali Acc: 0.823 Test Loss: 0.474 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 1.6230003833770752
Epoch: 2, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8229758739471436
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.435 Vali Acc: 0.795 Test Loss: 0.435 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9645874500274658
Epoch: 4, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.373 Vali Acc: 0.840 Test Loss: 0.373 Test Acc: 0.840
Validation loss decreased (-0.822521 --> -0.839587).  Saving model ...
Epoch: 5 cost time: 2.0794036388397217
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.461 Vali Acc: 0.799 Test Loss: 0.461 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.810229778289795
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.380 Vali Acc: 0.836 Test Loss: 0.380 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7872037887573242
Epoch: 7, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.410 Vali Acc: 0.819 Test Loss: 0.410 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.949202060699463
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.381 Vali Acc: 0.843 Test Loss: 0.381 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.843000).  Saving model ...
Epoch: 9 cost time: 1.548198938369751
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
Validation loss decreased (-0.843000 --> -0.849826).  Saving model ...
Epoch: 10 cost time: 1.8511853218078613
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.538 Vali Acc: 0.765 Test Loss: 0.538 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8303470611572266
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.418 Vali Acc: 0.846 Test Loss: 0.418 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1883463859558105
Epoch: 12, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.504 Vali Acc: 0.788 Test Loss: 0.504 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3418259620666504
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.050626754760742
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.496 Vali Acc: 0.805 Test Loss: 0.496 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8061563968658447
Epoch: 15, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.532 Vali Acc: 0.795 Test Loss: 0.532 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7675530910491943
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.641 Vali Acc: 0.771 Test Loss: 0.641 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.168612241744995
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7006125450134277
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7697372436523438
Epoch: 19, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.581 Vali Acc: 0.802 Test Loss: 0.581 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 68994
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.687370300292969
Epoch: 1, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.581 Vali Acc: 0.706 Test Loss: 0.581 Test Acc: 0.706
Validation loss decreased (inf --> -0.706479).  Saving model ...
Epoch: 2 cost time: 2.1382124423980713
Epoch: 2, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.457 Vali Acc: 0.761 Test Loss: 0.457 Test Acc: 0.761
Validation loss decreased (-0.706479 --> -0.761088).  Saving model ...
Epoch: 3 cost time: 2.248349666595459
Epoch: 3, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.462 Vali Acc: 0.778 Test Loss: 0.462 Test Acc: 0.778
Validation loss decreased (-0.761088 --> -0.778152).  Saving model ...
Epoch: 4 cost time: 2.37687087059021
Epoch: 4, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.466 Vali Acc: 0.758 Test Loss: 0.466 Test Acc: 0.758
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4372875690460205
Epoch: 5, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.433 Vali Acc: 0.805 Test Loss: 0.433 Test Acc: 0.805
Validation loss decreased (-0.778152 --> -0.805456).  Saving model ...
Epoch: 6 cost time: 2.0450286865234375
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.439 Vali Acc: 0.819 Test Loss: 0.439 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 7 cost time: 2.598313570022583
Epoch: 7, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.174778938293457
Epoch: 8, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
Validation loss decreased (-0.819108 --> -0.819109).  Saving model ...
Epoch: 9 cost time: 2.9547958374023438
Epoch: 9, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.524 Vali Acc: 0.799 Test Loss: 0.524 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5584805011749268
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
Validation loss decreased (-0.819109 --> -0.822521).  Saving model ...
Epoch: 11 cost time: 2.195702314376831
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.499 Vali Acc: 0.805 Test Loss: 0.499 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.950383186340332
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.531 Vali Acc: 0.795 Test Loss: 0.531 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9057552814483643
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
Validation loss decreased (-0.822521 --> -0.829347).  Saving model ...
Epoch: 14 cost time: 2.1205825805664062
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.707 Vali Acc: 0.747 Test Loss: 0.707 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.790832042694092
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.529 Vali Acc: 0.819 Test Loss: 0.529 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8145604133605957
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.556 Vali Acc: 0.792 Test Loss: 0.556 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.338043212890625
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.621 Vali Acc: 0.778 Test Loss: 0.621 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0717051029205322
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.683 Vali Acc: 0.782 Test Loss: 0.683 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8391695022583008
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.603 Vali Acc: 0.812 Test Loss: 0.603 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5112481117248535
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.628 Vali Acc: 0.799 Test Loss: 0.628 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9330451488494873
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.668 Vali Acc: 0.792 Test Loss: 0.668 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.487299919128418
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.15796160697937
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.631 Vali Acc: 0.823 Test Loss: 0.631 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm64_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 71042
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.4741528034210205
Epoch: 1, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.505 Vali Acc: 0.720 Test Loss: 0.505 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 2.312932252883911
Epoch: 2, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.426 Vali Acc: 0.819 Test Loss: 0.426 Test Acc: 0.819
Validation loss decreased (-0.720131 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 2.512298345565796
Epoch: 3, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.413 Vali Acc: 0.812 Test Loss: 0.413 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.125770092010498
Epoch: 4, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.365 Vali Acc: 0.857 Test Loss: 0.365 Test Acc: 0.857
Validation loss decreased (-0.819108 --> -0.856652).  Saving model ...
Epoch: 5 cost time: 2.698211193084717
Epoch: 5, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.494 Vali Acc: 0.799 Test Loss: 0.494 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.604079484939575
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.433 Vali Acc: 0.840 Test Loss: 0.433 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.184011936187744
Epoch: 7, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.531 Vali Acc: 0.805 Test Loss: 0.531 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6148622035980225
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.494 Vali Acc: 0.829 Test Loss: 0.494 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.232968807220459
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.632 Vali Acc: 0.802 Test Loss: 0.632 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1092135906219482
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.594 Vali Acc: 0.819 Test Loss: 0.594 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6479384899139404
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.786 Vali Acc: 0.771 Test Loss: 0.786 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.472790241241455
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.688 Vali Acc: 0.805 Test Loss: 0.688 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0215721130371094
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.829 Vali Acc: 0.788 Test Loss: 0.829 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.972937822341919
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.859 Vali Acc: 0.795 Test Loss: 0.859 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 71266
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.127557039260864
Epoch: 1, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.576 Vali Acc: 0.724 Test Loss: 0.576 Test Acc: 0.724
Validation loss decreased (inf --> -0.723544).  Saving model ...
Epoch: 2 cost time: 1.9568424224853516
Epoch: 2, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
Validation loss decreased (-0.723544 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.768010139465332
Epoch: 3, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.427 Vali Acc: 0.799 Test Loss: 0.427 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2756717205047607
Epoch: 4, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.494 Vali Acc: 0.792 Test Loss: 0.494 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9686744213104248
Epoch: 5, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.367 Vali Acc: 0.846 Test Loss: 0.367 Test Acc: 0.846
Validation loss decreased (-0.836173 --> -0.846413).  Saving model ...
Epoch: 6 cost time: 1.6127898693084717
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.434 Vali Acc: 0.816 Test Loss: 0.434 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9083251953125
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9234578609466553
Epoch: 8, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7628483772277832
Epoch: 9, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.468 Vali Acc: 0.819 Test Loss: 0.468 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8909366130828857
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.584 Vali Acc: 0.785 Test Loss: 0.584 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0681698322296143
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.553 Vali Acc: 0.805 Test Loss: 0.553 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.844088077545166
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.711 Vali Acc: 0.771 Test Loss: 0.711 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7238178253173828
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.638 Vali Acc: 0.788 Test Loss: 0.638 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0401523113250732
Epoch: 14, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.676 Vali Acc: 0.785 Test Loss: 0.676 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.247572183609009
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.720 Vali Acc: 0.805 Test Loss: 0.720 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 58530
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.686209440231323
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.495 Vali Acc: 0.823 Test Loss: 0.495 Test Acc: 0.823
Validation loss decreased (inf --> -0.822521).  Saving model ...
Epoch: 2 cost time: 2.102731943130493
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.401 Vali Acc: 0.809 Test Loss: 0.401 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9435985088348389
Epoch: 3, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.427 Vali Acc: 0.819 Test Loss: 0.427 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8821351528167725
Epoch: 4, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.366 Vali Acc: 0.857 Test Loss: 0.366 Test Acc: 0.857
Validation loss decreased (-0.822521 --> -0.856652).  Saving model ...
Epoch: 5 cost time: 2.2115564346313477
Epoch: 5, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.472 Vali Acc: 0.775 Test Loss: 0.472 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2179298400878906
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.439 Vali Acc: 0.812 Test Loss: 0.439 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.303579807281494
Epoch: 7, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.401 Vali Acc: 0.833 Test Loss: 0.401 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.246286153793335
Epoch: 8, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.418 Vali Acc: 0.809 Test Loss: 0.418 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4118709564208984
Epoch: 9, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.438 Vali Acc: 0.823 Test Loss: 0.438 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0137901306152344
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.515 Vali Acc: 0.805 Test Loss: 0.515 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0026466846466064
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.455 Vali Acc: 0.816 Test Loss: 0.455 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3334226608276367
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.535 Vali Acc: 0.799 Test Loss: 0.535 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2513413429260254
Epoch: 13, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.462 Vali Acc: 0.826 Test Loss: 0.462 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1017167568206787
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.567 Vali Acc: 0.795 Test Loss: 0.567 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 54274
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.656142711639404
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.605 Vali Acc: 0.693 Test Loss: 0.605 Test Acc: 0.693
Validation loss decreased (inf --> -0.692827).  Saving model ...
Epoch: 2 cost time: 1.6366283893585205
Epoch: 2, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.471 Vali Acc: 0.775 Test Loss: 0.471 Test Acc: 0.775
Validation loss decreased (-0.692827 --> -0.774739).  Saving model ...
Epoch: 3 cost time: 1.572896957397461
Epoch: 3, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
Validation loss decreased (-0.774739 --> -0.819109).  Saving model ...
Epoch: 4 cost time: 1.8693161010742188
Epoch: 4, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.507 Vali Acc: 0.747 Test Loss: 0.507 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.868610143661499
Epoch: 5, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.452 Vali Acc: 0.795 Test Loss: 0.452 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7422056198120117
Epoch: 6, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.425 Vali Acc: 0.826 Test Loss: 0.425 Test Acc: 0.826
Validation loss decreased (-0.819109 --> -0.825934).  Saving model ...
Epoch: 7 cost time: 1.6045575141906738
Epoch: 7, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.472 Vali Acc: 0.792 Test Loss: 0.472 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.080770492553711
Epoch: 8, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.474 Vali Acc: 0.802 Test Loss: 0.474 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8690147399902344
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 10 cost time: 1.9257664680480957
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.513 Vali Acc: 0.795 Test Loss: 0.513 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8790974617004395
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.518 Vali Acc: 0.805 Test Loss: 0.518 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8932068347930908
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.508 Vali Acc: 0.819 Test Loss: 0.508 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8893828392028809
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.526 Vali Acc: 0.805 Test Loss: 0.526 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8692796230316162
Epoch: 14, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.845937728881836
Epoch: 15, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6817307472229004
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9495916366577148
Epoch: 17, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.532 Vali Acc: 0.823 Test Loss: 0.532 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8176510334014893
Epoch: 18, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0633738040924072
Epoch: 19, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.659 Vali Acc: 0.788 Test Loss: 0.659 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 52290
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.327907085418701
Epoch: 1, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.534 Vali Acc: 0.778 Test Loss: 0.534 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 2.067549467086792
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.464 Vali Acc: 0.799 Test Loss: 0.464 Test Acc: 0.799
Validation loss decreased (-0.778152 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 2.2532825469970703
Epoch: 3, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.401 Vali Acc: 0.816 Test Loss: 0.401 Test Acc: 0.816
Validation loss decreased (-0.798630 --> -0.815696).  Saving model ...
Epoch: 4 cost time: 2.3970110416412354
Epoch: 4, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.420 Vali Acc: 0.809 Test Loss: 0.420 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.983518362045288
Epoch: 5, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.398 Vali Acc: 0.812 Test Loss: 0.398 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1412465572357178
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.362 Vali Acc: 0.823 Test Loss: 0.362 Test Acc: 0.823
Validation loss decreased (-0.815696 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 1.9912025928497314
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.418 Vali Acc: 0.802 Test Loss: 0.418 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.61147141456604
Epoch: 8, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.371 Vali Acc: 0.840 Test Loss: 0.371 Test Acc: 0.840
Validation loss decreased (-0.822522 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.739231824874878
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.380 Vali Acc: 0.826 Test Loss: 0.380 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2139482498168945
Epoch: 10, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.381 Vali Acc: 0.857 Test Loss: 0.381 Test Acc: 0.857
Validation loss decreased (-0.839587 --> -0.856651).  Saving model ...
Epoch: 11 cost time: 2.3683481216430664
Epoch: 11, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.440 Vali Acc: 0.812 Test Loss: 0.440 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9012939929962158
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6335256099700928
Epoch: 13, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.441 Vali Acc: 0.812 Test Loss: 0.441 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1279757022857666
Epoch: 14, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.371 Vali Acc: 0.863 Test Loss: 0.371 Test Acc: 0.863
Validation loss decreased (-0.856651 --> -0.863478).  Saving model ...
Epoch: 15 cost time: 1.9920063018798828
Epoch: 15, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.462 Vali Acc: 0.833 Test Loss: 0.462 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.454840898513794
Epoch: 16, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.495 Vali Acc: 0.833 Test Loss: 0.495 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.078226327896118
Epoch: 17, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.548 Vali Acc: 0.802 Test Loss: 0.548 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.941890001296997
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.468 Vali Acc: 0.833 Test Loss: 0.468 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.3405563831329346
Epoch: 19, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.459 Vali Acc: 0.840 Test Loss: 0.459 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.909259557723999
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.479 Vali Acc: 0.836 Test Loss: 0.479 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9014892578125
Epoch: 21, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.794463872909546
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.576 Vali Acc: 0.812 Test Loss: 0.576 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.266045093536377
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.529 Vali Acc: 0.833 Test Loss: 0.529 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3947668075561523
Epoch: 24, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.559 Vali Acc: 0.826 Test Loss: 0.559 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 51426
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.42785906791687
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.511 Vali Acc: 0.771 Test Loss: 0.511 Test Acc: 0.771
Validation loss decreased (inf --> -0.771326).  Saving model ...
Epoch: 2 cost time: 1.59566330909729
Epoch: 2, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.428 Vali Acc: 0.816 Test Loss: 0.428 Test Acc: 0.816
Validation loss decreased (-0.771326 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 1.5610835552215576
Epoch: 3, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.387 Vali Acc: 0.843 Test Loss: 0.387 Test Acc: 0.843
Validation loss decreased (-0.815695 --> -0.843000).  Saving model ...
Epoch: 4 cost time: 1.531113624572754
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.385 Vali Acc: 0.840 Test Loss: 0.385 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5007870197296143
Epoch: 5, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8939857482910156
Epoch: 6, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.406 Vali Acc: 0.823 Test Loss: 0.406 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.867933750152588
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.843000 --> -0.849826).  Saving model ...
Epoch: 8 cost time: 1.8827815055847168
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.387 Vali Acc: 0.829 Test Loss: 0.387 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9304702281951904
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.368 Vali Acc: 0.843 Test Loss: 0.368 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9066798686981201
Epoch: 10, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.380 Vali Acc: 0.819 Test Loss: 0.380 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8721935749053955
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.414 Vali Acc: 0.809 Test Loss: 0.414 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7740373611450195
Epoch: 12, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
Validation loss decreased (-0.849826 --> -0.870304).  Saving model ...
Epoch: 13 cost time: 1.8021879196166992
Epoch: 13, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.373 Vali Acc: 0.857 Test Loss: 0.373 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6882202625274658
Epoch: 14, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.405 Vali Acc: 0.840 Test Loss: 0.405 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9271705150604248
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.363 Vali Acc: 0.860 Test Loss: 0.363 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9346444606781006
Epoch: 16, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.420 Vali Acc: 0.843 Test Loss: 0.420 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8429605960845947
Epoch: 17, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.399 Vali Acc: 0.846 Test Loss: 0.399 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4427900314331055
Epoch: 18, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.428 Vali Acc: 0.829 Test Loss: 0.428 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6850626468658447
Epoch: 19, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.729435682296753
Epoch: 20, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.407 Vali Acc: 0.846 Test Loss: 0.407 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.949960470199585
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8413112163543701
Epoch: 22, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.409 Vali Acc: 0.863 Test Loss: 0.409 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 51330
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0353593826293945
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.645 Vali Acc: 0.642 Test Loss: 0.645 Test Acc: 0.642
Validation loss decreased (inf --> -0.641632).  Saving model ...
Epoch: 2 cost time: 1.79136061668396
Epoch: 2, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.491 Vali Acc: 0.768 Test Loss: 0.491 Test Acc: 0.768
Validation loss decreased (-0.641632 --> -0.767913).  Saving model ...
Epoch: 3 cost time: 1.664721965789795
Epoch: 3, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.432 Vali Acc: 0.812 Test Loss: 0.432 Test Acc: 0.812
Validation loss decreased (-0.767913 --> -0.812282).  Saving model ...
Epoch: 4 cost time: 1.8605127334594727
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.441 Vali Acc: 0.785 Test Loss: 0.441 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1575512886047363
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.373 Vali Acc: 0.846 Test Loss: 0.373 Test Acc: 0.846
Validation loss decreased (-0.812282 --> -0.846413).  Saving model ...
Epoch: 6 cost time: 1.741783857345581
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.374 Vali Acc: 0.843 Test Loss: 0.374 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.507458448410034
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.388 Vali Acc: 0.826 Test Loss: 0.388 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0553462505340576
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.344 Vali Acc: 0.853 Test Loss: 0.344 Test Acc: 0.853
Validation loss decreased (-0.846413 --> -0.853239).  Saving model ...
Epoch: 9 cost time: 1.6541707515716553
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.398 Vali Acc: 0.826 Test Loss: 0.398 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9171569347381592
Epoch: 10, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.350 Vali Acc: 0.853 Test Loss: 0.350 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1165292263031006
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.466 Vali Acc: 0.788 Test Loss: 0.466 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8816008567810059
Epoch: 12, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.393 Vali Acc: 0.846 Test Loss: 0.393 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.882720947265625
Epoch: 13, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.378 Vali Acc: 0.850 Test Loss: 0.378 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9114141464233398
Epoch: 14, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.411 Vali Acc: 0.843 Test Loss: 0.411 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1433486938476562
Epoch: 15, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.413 Vali Acc: 0.850 Test Loss: 0.413 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.86940336227417
Epoch: 16, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.08504056930542
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7526109218597412
Epoch: 18, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.416 Vali Acc: 0.853 Test Loss: 0.416 Test Acc: 0.853
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 52354
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.185683012008667
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.479 Vali Acc: 0.788 Test Loss: 0.479 Test Acc: 0.788
Validation loss decreased (inf --> -0.788391).  Saving model ...
Epoch: 2 cost time: 2.0580976009368896
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.419 Vali Acc: 0.843 Test Loss: 0.419 Test Acc: 0.843
Validation loss decreased (-0.788391 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 2.223022699356079
Epoch: 3, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.132521390914917
Epoch: 4, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.941023826599121
Epoch: 5, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.477 Vali Acc: 0.812 Test Loss: 0.477 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.750600814819336
Epoch: 6, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0755252838134766
Epoch: 7, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.527 Vali Acc: 0.799 Test Loss: 0.527 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.326176643371582
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.475 Vali Acc: 0.829 Test Loss: 0.475 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7994670867919922
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.764 Vali Acc: 0.775 Test Loss: 0.764 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4452717304229736
Epoch: 10, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.650 Vali Acc: 0.812 Test Loss: 0.650 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9014744758605957
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.607 Vali Acc: 0.840 Test Loss: 0.607 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0463151931762695
Epoch: 12, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.840 Vali Acc: 0.768 Test Loss: 0.840 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 54626
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.567720413208008
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.485 Vali Acc: 0.785 Test Loss: 0.485 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 1.9548406600952148
Epoch: 2, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.433 Vali Acc: 0.802 Test Loss: 0.433 Test Acc: 0.802
Validation loss decreased (-0.784978 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.8657691478729248
Epoch: 3, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.391610622406006
Epoch: 4, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.440 Vali Acc: 0.802 Test Loss: 0.440 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2189128398895264
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.487 Vali Acc: 0.782 Test Loss: 0.487 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2641353607177734
Epoch: 6, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.458 Vali Acc: 0.805 Test Loss: 0.458 Test Acc: 0.805
Validation loss decreased (-0.802043 --> -0.805456).  Saving model ...
Epoch: 7 cost time: 1.8209333419799805
Epoch: 7, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.475 Vali Acc: 0.809 Test Loss: 0.475 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808869).  Saving model ...
Epoch: 8 cost time: 2.3140721321105957
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.568 Vali Acc: 0.788 Test Loss: 0.568 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.649371862411499
Epoch: 9, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.516 Vali Acc: 0.799 Test Loss: 0.516 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8036346435546875
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
Validation loss decreased (-0.808869 --> -0.819108).  Saving model ...
Epoch: 11 cost time: 2.0971720218658447
Epoch: 11, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.529 Vali Acc: 0.802 Test Loss: 0.529 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.881990671157837
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.617 Vali Acc: 0.768 Test Loss: 0.617 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.320727586746216
Epoch: 13, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.576 Vali Acc: 0.805 Test Loss: 0.576 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7877144813537598
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5342319011688232
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.682 Vali Acc: 0.782 Test Loss: 0.682 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.685596227645874
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.740 Vali Acc: 0.775 Test Loss: 0.740 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.170088291168213
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.606 Vali Acc: 0.829 Test Loss: 0.606 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829345).  Saving model ...
Epoch: 18 cost time: 1.910299301147461
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.814 Vali Acc: 0.775 Test Loss: 0.814 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.007039785385132
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.723 Vali Acc: 0.812 Test Loss: 0.723 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8957419395446777
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.880 Vali Acc: 0.768 Test Loss: 0.880 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.234727621078491
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.840 Vali Acc: 0.795 Test Loss: 0.840 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1465775966644287
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.767 Vali Acc: 0.812 Test Loss: 0.767 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8663079738616943
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.906 Vali Acc: 0.795 Test Loss: 0.906 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9404523372650146
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.831 Vali Acc: 0.816 Test Loss: 0.831 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.847273588180542
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.894 Vali Acc: 0.809 Test Loss: 0.894 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9023044109344482
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.987 Vali Acc: 0.788 Test Loss: 0.987 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.235185146331787
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.002 Vali Acc: 0.795 Test Loss: 1.002 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 41890
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.987835645675659
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.492 Vali Acc: 0.816 Test Loss: 0.492 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 1.8129174709320068
Epoch: 2, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
Validation loss decreased (-0.815695 --> -0.832760).  Saving model ...
Epoch: 3 cost time: 1.863626480102539
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.433 Vali Acc: 0.805 Test Loss: 0.433 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.544309377670288
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.409 Vali Acc: 0.819 Test Loss: 0.409 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8241617679595947
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.382 Vali Acc: 0.836 Test Loss: 0.382 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 1.8216772079467773
Epoch: 6, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.528552770614624
Epoch: 7, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.464 Vali Acc: 0.795 Test Loss: 0.464 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6446301937103271
Epoch: 8, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8445637226104736
Epoch: 9, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.731137752532959
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.446 Vali Acc: 0.819 Test Loss: 0.446 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.393218994140625
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.506 Vali Acc: 0.792 Test Loss: 0.506 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.165781021118164
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.304304361343384
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.532 Vali Acc: 0.788 Test Loss: 0.532 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6530959606170654
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.549 Vali Acc: 0.802 Test Loss: 0.549 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7070369720458984
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.588 Vali Acc: 0.795 Test Loss: 0.588 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 37634
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.542634725570679
Epoch: 1, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
Validation loss decreased (inf --> -0.740609).  Saving model ...
Epoch: 2 cost time: 2.3324310779571533
Epoch: 2, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.456 Vali Acc: 0.775 Test Loss: 0.456 Test Acc: 0.775
Validation loss decreased (-0.740609 --> -0.774739).  Saving model ...
Epoch: 3 cost time: 1.881714105606079
Epoch: 3, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.466 Vali Acc: 0.771 Test Loss: 0.466 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.163393020629883
Epoch: 4, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
Validation loss decreased (-0.774739 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 2.1179535388946533
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.478 Vali Acc: 0.771 Test Loss: 0.478 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.459789514541626
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.408 Vali Acc: 0.850 Test Loss: 0.408 Test Acc: 0.850
Validation loss decreased (-0.822521 --> -0.849825).  Saving model ...
Epoch: 7 cost time: 2.787245273590088
Epoch: 7, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.447 Vali Acc: 0.799 Test Loss: 0.447 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3887288570404053
Epoch: 8, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.484 Vali Acc: 0.795 Test Loss: 0.484 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1482577323913574
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1761116981506348
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1967546939849854
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.505 Vali Acc: 0.795 Test Loss: 0.505 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2810516357421875
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.455 Vali Acc: 0.816 Test Loss: 0.455 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.066065549850464
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.538 Vali Acc: 0.799 Test Loss: 0.538 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.169443368911743
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0448484420776367
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.488 Vali Acc: 0.823 Test Loss: 0.488 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.120126485824585
Epoch: 16, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.538 Vali Acc: 0.816 Test Loss: 0.538 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 35650
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.253248929977417
Epoch: 1, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.603 Vali Acc: 0.666 Test Loss: 0.603 Test Acc: 0.666
Validation loss decreased (inf --> -0.665523).  Saving model ...
Epoch: 2 cost time: 1.9437336921691895
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.444 Vali Acc: 0.785 Test Loss: 0.444 Test Acc: 0.785
Validation loss decreased (-0.665523 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 2.1993157863616943
Epoch: 3, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.465 Vali Acc: 0.778 Test Loss: 0.465 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2895405292510986
Epoch: 4, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.422 Vali Acc: 0.819 Test Loss: 0.422 Test Acc: 0.819
Validation loss decreased (-0.784978 --> -0.819108).  Saving model ...
Epoch: 5 cost time: 2.0250792503356934
Epoch: 5, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.468 Vali Acc: 0.795 Test Loss: 0.468 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7600069046020508
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.423 Vali Acc: 0.802 Test Loss: 0.423 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0729615688323975
Epoch: 7, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.390 Vali Acc: 0.826 Test Loss: 0.390 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825935).  Saving model ...
Epoch: 8 cost time: 2.1083242893218994
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.423 Vali Acc: 0.809 Test Loss: 0.423 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.801865577697754
Epoch: 9, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.371 Vali Acc: 0.874 Test Loss: 0.371 Test Acc: 0.874
Validation loss decreased (-0.825935 --> -0.873716).  Saving model ...
Epoch: 10 cost time: 1.9569940567016602
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.407 Vali Acc: 0.816 Test Loss: 0.407 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.008023977279663
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.370 Vali Acc: 0.863 Test Loss: 0.370 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1657488346099854
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.374 Vali Acc: 0.860 Test Loss: 0.374 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9665446281433105
Epoch: 13, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.309357166290283
Epoch: 14, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3903112411499023
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.410 Vali Acc: 0.846 Test Loss: 0.410 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.261577606201172
Epoch: 16, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.405 Vali Acc: 0.843 Test Loss: 0.405 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.2871344089508057
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.449 Vali Acc: 0.833 Test Loss: 0.449 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1806468963623047
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.506 Vali Acc: 0.799 Test Loss: 0.506 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.398118019104004
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.470 Vali Acc: 0.840 Test Loss: 0.470 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8737201365187713
model parameter : 34786
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.6783246994018555
Epoch: 1, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.882 Vali Acc: 0.321 Test Loss: 0.882 Test Acc: 0.321
Validation loss decreased (inf --> -0.320810).  Saving model ...
Epoch: 2 cost time: 2.211421489715576
Epoch: 2, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.523 Vali Acc: 0.751 Test Loss: 0.523 Test Acc: 0.751
Validation loss decreased (-0.320810 --> -0.750848).  Saving model ...
Epoch: 3 cost time: 2.284074068069458
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.423 Vali Acc: 0.816 Test Loss: 0.423 Test Acc: 0.816
Validation loss decreased (-0.750848 --> -0.815695).  Saving model ...
Epoch: 4 cost time: 2.37336802482605
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.393 Vali Acc: 0.799 Test Loss: 0.393 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.93997859954834
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.390 Vali Acc: 0.805 Test Loss: 0.390 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2915213108062744
Epoch: 6, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.359 Vali Acc: 0.826 Test Loss: 0.359 Test Acc: 0.826
Validation loss decreased (-0.815695 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 2.397261619567871
Epoch: 7, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.374 Vali Acc: 0.829 Test Loss: 0.374 Test Acc: 0.829
Validation loss decreased (-0.825935 --> -0.829348).  Saving model ...
Epoch: 8 cost time: 2.1992926597595215
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.400 Vali Acc: 0.823 Test Loss: 0.400 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4076988697052
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1469733715057373
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.356 Vali Acc: 0.860 Test Loss: 0.356 Test Acc: 0.860
Validation loss decreased (-0.829348 --> -0.860065).  Saving model ...
Epoch: 11 cost time: 2.3196516036987305
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.387 Vali Acc: 0.846 Test Loss: 0.387 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7784841060638428
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.374 Vali Acc: 0.853 Test Loss: 0.374 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1289241313934326
Epoch: 13, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.435 Vali Acc: 0.823 Test Loss: 0.435 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.629734754562378
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.739642858505249
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.462 Vali Acc: 0.812 Test Loss: 0.462 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6140573024749756
Epoch: 16, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.423 Vali Acc: 0.836 Test Loss: 0.423 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1125142574310303
Epoch: 17, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0875117778778076
Epoch: 18, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.466 Vali Acc: 0.833 Test Loss: 0.466 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9842150211334229
Epoch: 19, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.430 Vali Acc: 0.836 Test Loss: 0.430 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6382429599761963
Epoch: 20, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.606 Vali Acc: 0.765 Test Loss: 0.606 Test Acc: 0.765
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 34690
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.055665493011475
Epoch: 1, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.477 Vali Acc: 0.826 Test Loss: 0.477 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 1.5651872158050537
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.416 Vali Acc: 0.829 Test Loss: 0.416 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 1.673213005065918
Epoch: 3, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.416 Vali Acc: 0.809 Test Loss: 0.416 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4076366424560547
Epoch: 4, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.410 Vali Acc: 0.809 Test Loss: 0.410 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7870886325836182
Epoch: 5, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.411 Vali Acc: 0.812 Test Loss: 0.411 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8381400108337402
Epoch: 6, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.400 Vali Acc: 0.823 Test Loss: 0.400 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9974544048309326
Epoch: 7, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.406 Vali Acc: 0.805 Test Loss: 0.406 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1081349849700928
Epoch: 8, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.406 Vali Acc: 0.833 Test Loss: 0.406 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832760).  Saving model ...
Epoch: 9 cost time: 1.597884178161621
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6519451141357422
Epoch: 10, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836174).  Saving model ...
Epoch: 11 cost time: 1.7862696647644043
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.419 Vali Acc: 0.826 Test Loss: 0.419 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6162478923797607
Epoch: 12, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.439 Vali Acc: 0.819 Test Loss: 0.439 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7534432411193848
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7598755359649658
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.428 Vali Acc: 0.812 Test Loss: 0.428 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0297746658325195
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.424 Vali Acc: 0.843 Test Loss: 0.424 Test Acc: 0.843
Validation loss decreased (-0.836174 --> -0.842999).  Saving model ...
Epoch: 16 cost time: 2.1144216060638428
Epoch: 16, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.492 Vali Acc: 0.805 Test Loss: 0.492 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8369140625
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.504 Vali Acc: 0.805 Test Loss: 0.504 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.271782159805298
Epoch: 18, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.454585075378418
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.501 Vali Acc: 0.812 Test Loss: 0.501 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8133509159088135
Epoch: 20, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.451 Vali Acc: 0.840 Test Loss: 0.451 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8731210231781006
Epoch: 21, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.578 Vali Acc: 0.785 Test Loss: 0.578 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.96826171875
Epoch: 22, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.493 Vali Acc: 0.829 Test Loss: 0.493 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9195959568023682
Epoch: 23, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.432 Vali Acc: 0.853 Test Loss: 0.432 Test Acc: 0.853
Validation loss decreased (-0.842999 --> -0.853238).  Saving model ...
Epoch: 24 cost time: 1.5504724979400635
Epoch: 24, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.542 Vali Acc: 0.812 Test Loss: 0.542 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.661792516708374
Epoch: 25, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.477 Vali Acc: 0.840 Test Loss: 0.477 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.003063917160034
Epoch: 26, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9567978382110596
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.823 Test Loss: 0.570 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7083284854888916
Epoch: 28, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.503 Vali Acc: 0.836 Test Loss: 0.503 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.299990653991699
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7591552734375
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.182145833969116
Epoch: 31, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.843 Test Loss: 0.507 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.165872812271118
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.611 Vali Acc: 0.805 Test Loss: 0.611 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.356424570083618
Epoch: 33, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.481 Vali Acc: 0.860 Test Loss: 0.481 Test Acc: 0.860
Validation loss decreased (-0.853238 --> -0.860063).  Saving model ...
Epoch: 34 cost time: 2.063425064086914
Epoch: 34, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.579 Vali Acc: 0.829 Test Loss: 0.579 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8050384521484375
Epoch: 35, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.634 Vali Acc: 0.812 Test Loss: 0.634 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8975179195404053
Epoch: 36, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.513 Vali Acc: 0.857 Test Loss: 0.513 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7641682624816895
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.711 Vali Acc: 0.792 Test Loss: 0.711 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.1212141513824463
Epoch: 38, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.570 Vali Acc: 0.829 Test Loss: 0.570 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.184359312057495
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.823 Test Loss: 0.621 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.123549699783325
Epoch: 40, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.626 Vali Acc: 0.826 Test Loss: 0.626 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.9626421928405762
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.639 Vali Acc: 0.812 Test Loss: 0.639 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.433009147644043
Epoch: 42, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.644 Vali Acc: 0.819 Test Loss: 0.644 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.3017160892486572
Epoch: 43, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.823 Test Loss: 0.668 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 35714
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.529458045959473
Epoch: 1, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.523 Vali Acc: 0.724 Test Loss: 0.523 Test Acc: 0.724
Validation loss decreased (inf --> -0.723544).  Saving model ...
Epoch: 2 cost time: 3.514167070388794
Epoch: 2, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.431 Vali Acc: 0.805 Test Loss: 0.431 Test Acc: 0.805
Validation loss decreased (-0.723544 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 3.51566743850708
Epoch: 3, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.405 Vali Acc: 0.843 Test Loss: 0.405 Test Acc: 0.843
Validation loss decreased (-0.805456 --> -0.842999).  Saving model ...
Epoch: 4 cost time: 2.963242530822754
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.436 Vali Acc: 0.805 Test Loss: 0.436 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.56394362449646
Epoch: 5, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.0740015506744385
Epoch: 6, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.720660448074341
Epoch: 7, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.555 Vali Acc: 0.788 Test Loss: 0.555 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7570133209228516
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.763 Vali Acc: 0.754 Test Loss: 0.763 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.395601749420166
Epoch: 9, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6302976608276367
Epoch: 10, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.559 Vali Acc: 0.819 Test Loss: 0.559 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.336638927459717
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.691 Vali Acc: 0.792 Test Loss: 0.691 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9637222290039062
Epoch: 12, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6599411964416504
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.816 Vali Acc: 0.771 Test Loss: 0.816 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 46306
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.019587278366089
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.498 Vali Acc: 0.792 Test Loss: 0.498 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 2.360241413116455
Epoch: 2, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.416 Vali Acc: 0.823 Test Loss: 0.416 Test Acc: 0.823
Validation loss decreased (-0.791804 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 2.160597324371338
Epoch: 3, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.368 Vali Acc: 0.857 Test Loss: 0.368 Test Acc: 0.857
Validation loss decreased (-0.822521 --> -0.856652).  Saving model ...
Epoch: 4 cost time: 2.243844985961914
Epoch: 4, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.414 Vali Acc: 0.819 Test Loss: 0.414 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0268657207489014
Epoch: 5, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.379 Vali Acc: 0.843 Test Loss: 0.379 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.539915084838867
Epoch: 6, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.413 Vali Acc: 0.816 Test Loss: 0.413 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.282228708267212
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.452 Vali Acc: 0.802 Test Loss: 0.452 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1394214630126953
Epoch: 8, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.431 Vali Acc: 0.823 Test Loss: 0.431 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6896812915802002
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.472 Vali Acc: 0.833 Test Loss: 0.472 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2066407203674316
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.475 Vali Acc: 0.836 Test Loss: 0.475 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.778074026107788
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.579 Vali Acc: 0.802 Test Loss: 0.579 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0966432094573975
Epoch: 12, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.512 Vali Acc: 0.836 Test Loss: 0.512 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0979552268981934
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.592 Vali Acc: 0.805 Test Loss: 0.592 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 33570
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.088382244110107
Epoch: 1, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.624 Vali Acc: 0.666 Test Loss: 0.624 Test Acc: 0.666
Validation loss decreased (inf --> -0.665523).  Saving model ...
Epoch: 2 cost time: 1.6810481548309326
Epoch: 2, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.463 Vali Acc: 0.782 Test Loss: 0.463 Test Acc: 0.782
Validation loss decreased (-0.665523 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 1.7376508712768555
Epoch: 3, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.428 Vali Acc: 0.799 Test Loss: 0.428 Test Acc: 0.799
Validation loss decreased (-0.781565 --> -0.798631).  Saving model ...
Epoch: 4 cost time: 1.6220927238464355
Epoch: 4, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.454 Vali Acc: 0.795 Test Loss: 0.454 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.488632917404175
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.388 Vali Acc: 0.826 Test Loss: 0.388 Test Acc: 0.826
Validation loss decreased (-0.798631 --> -0.825935).  Saving model ...
Epoch: 6 cost time: 2.3965933322906494
Epoch: 6, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.457 Vali Acc: 0.788 Test Loss: 0.457 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8015084266662598
Epoch: 7, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.439 Vali Acc: 0.802 Test Loss: 0.439 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.288165807723999
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.437 Vali Acc: 0.802 Test Loss: 0.437 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8040893077850342
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.482 Vali Acc: 0.802 Test Loss: 0.482 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.339024066925049
Epoch: 10, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2607357501983643
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.505 Vali Acc: 0.778 Test Loss: 0.505 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8140897750854492
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.576 Vali Acc: 0.788 Test Loss: 0.576 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.198251724243164
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.087123155593872
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.587 Vali Acc: 0.782 Test Loss: 0.587 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0506908893585205
Epoch: 15, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.588 Vali Acc: 0.799 Test Loss: 0.588 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 29314
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.539625406265259
Epoch: 1, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.556 Vali Acc: 0.761 Test Loss: 0.556 Test Acc: 0.761
Validation loss decreased (inf --> -0.761087).  Saving model ...
Epoch: 2 cost time: 2.319854974746704
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.448 Vali Acc: 0.788 Test Loss: 0.448 Test Acc: 0.788
Validation loss decreased (-0.761087 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 2.0405709743499756
Epoch: 3, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.419 Vali Acc: 0.805 Test Loss: 0.419 Test Acc: 0.805
Validation loss decreased (-0.788391 --> -0.805457).  Saving model ...
Epoch: 4 cost time: 1.8525488376617432
Epoch: 4, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.428 Vali Acc: 0.788 Test Loss: 0.428 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3229026794433594
Epoch: 5, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
Validation loss decreased (-0.805457 --> -0.812283).  Saving model ...
Epoch: 6 cost time: 2.2445266246795654
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.485 Vali Acc: 0.778 Test Loss: 0.485 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.196277379989624
Epoch: 7, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.384 Vali Acc: 0.840 Test Loss: 0.384 Test Acc: 0.840
Validation loss decreased (-0.812283 --> -0.839587).  Saving model ...
Epoch: 8 cost time: 2.1063008308410645
Epoch: 8, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.450 Vali Acc: 0.805 Test Loss: 0.450 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.34889817237854
Epoch: 9, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.541 Vali Acc: 0.765 Test Loss: 0.541 Test Acc: 0.765
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.243091344833374
Epoch: 10, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.489 Vali Acc: 0.802 Test Loss: 0.489 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.309258460998535
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.506 Vali Acc: 0.805 Test Loss: 0.506 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6168155670166016
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.479 Vali Acc: 0.805 Test Loss: 0.479 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6125524044036865
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.520 Vali Acc: 0.819 Test Loss: 0.520 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.189439296722412
Epoch: 14, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.588 Vali Acc: 0.788 Test Loss: 0.588 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7093627452850342
Epoch: 15, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.534 Vali Acc: 0.795 Test Loss: 0.534 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.182082176208496
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.584 Vali Acc: 0.785 Test Loss: 0.584 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7941994667053223
Epoch: 17, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.590 Vali Acc: 0.785 Test Loss: 0.590 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 27330
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.395136833190918
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
Validation loss decreased (inf --> -0.750848).  Saving model ...
Epoch: 2 cost time: 2.122067451477051
Epoch: 2, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.454 Vali Acc: 0.802 Test Loss: 0.454 Test Acc: 0.802
Validation loss decreased (-0.750848 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 2.4621691703796387
Epoch: 3, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.421 Vali Acc: 0.802 Test Loss: 0.421 Test Acc: 0.802
Validation loss decreased (-0.802043 --> -0.802044).  Saving model ...
Epoch: 4 cost time: 2.150118112564087
Epoch: 4, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.399 Vali Acc: 0.826 Test Loss: 0.399 Test Acc: 0.826
Validation loss decreased (-0.802044 --> -0.825935).  Saving model ...
Epoch: 5 cost time: 2.216409921646118
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.437 Vali Acc: 0.795 Test Loss: 0.437 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4663851261138916
Epoch: 6, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.373 Vali Acc: 0.833 Test Loss: 0.373 Test Acc: 0.833
Validation loss decreased (-0.825935 --> -0.832761).  Saving model ...
Epoch: 7 cost time: 2.29775071144104
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.393 Vali Acc: 0.809 Test Loss: 0.393 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.381443738937378
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.372 Vali Acc: 0.840 Test Loss: 0.372 Test Acc: 0.840
Validation loss decreased (-0.832761 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 2.0556440353393555
Epoch: 9, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6313979625701904
Epoch: 10, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.388 Vali Acc: 0.846 Test Loss: 0.388 Test Acc: 0.846
Validation loss decreased (-0.839587 --> -0.846413).  Saving model ...
Epoch: 11 cost time: 2.1082005500793457
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
Validation loss decreased (-0.846413 --> -0.866891).  Saving model ...
Epoch: 12 cost time: 2.0958828926086426
Epoch: 12, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4778337478637695
Epoch: 13, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.408 Vali Acc: 0.840 Test Loss: 0.408 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.330240249633789
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.432 Vali Acc: 0.836 Test Loss: 0.432 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3912110328674316
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.836 Test Loss: 0.433 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4443247318267822
Epoch: 16, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.454 Vali Acc: 0.833 Test Loss: 0.454 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.264667272567749
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.439 Vali Acc: 0.833 Test Loss: 0.439 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2232041358947754
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.439 Vali Acc: 0.840 Test Loss: 0.439 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.483192205429077
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.446 Vali Acc: 0.840 Test Loss: 0.446 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.106409788131714
Epoch: 20, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1238396167755127
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.497 Vali Acc: 0.833 Test Loss: 0.497 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 26466
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.7592151165008545
Epoch: 1, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.692 Vali Acc: 0.604 Test Loss: 0.692 Test Acc: 0.604
Validation loss decreased (inf --> -0.604089).  Saving model ...
Epoch: 2 cost time: 2.549489736557007
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.465 Vali Acc: 0.785 Test Loss: 0.465 Test Acc: 0.785
Validation loss decreased (-0.604089 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 2.619657039642334
Epoch: 3, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.430 Vali Acc: 0.799 Test Loss: 0.430 Test Acc: 0.799
Validation loss decreased (-0.784978 --> -0.798631).  Saving model ...
Epoch: 4 cost time: 1.8011202812194824
Epoch: 4, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.386 Vali Acc: 0.819 Test Loss: 0.386 Test Acc: 0.819
Validation loss decreased (-0.798631 --> -0.819109).  Saving model ...
Epoch: 5 cost time: 2.224241018295288
Epoch: 5, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.412 Vali Acc: 0.802 Test Loss: 0.412 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.394336223602295
Epoch: 6, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.410 Vali Acc: 0.802 Test Loss: 0.410 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.119420051574707
Epoch: 7, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.391 Vali Acc: 0.823 Test Loss: 0.391 Test Acc: 0.823
Validation loss decreased (-0.819109 --> -0.822522).  Saving model ...
Epoch: 8 cost time: 2.306748390197754
Epoch: 8, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.822522 --> -0.832761).  Saving model ...
Epoch: 9 cost time: 2.044553279876709
Epoch: 9, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.390 Vali Acc: 0.829 Test Loss: 0.390 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.968254566192627
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.362 Vali Acc: 0.846 Test Loss: 0.362 Test Acc: 0.846
Validation loss decreased (-0.832761 --> -0.846413).  Saving model ...
Epoch: 11 cost time: 2.271524429321289
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.407 Vali Acc: 0.819 Test Loss: 0.407 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6518256664276123
Epoch: 12, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.390 Vali Acc: 0.843 Test Loss: 0.390 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0265274047851562
Epoch: 13, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.297532796859741
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
Validation loss decreased (-0.846413 --> -0.870304).  Saving model ...
Epoch: 15 cost time: 2.171872854232788
Epoch: 15, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.405 Vali Acc: 0.840 Test Loss: 0.405 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8961069583892822
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.399 Vali Acc: 0.853 Test Loss: 0.399 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1645848751068115
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.460 Vali Acc: 0.812 Test Loss: 0.460 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.205827236175537
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.634634256362915
Epoch: 19, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5657565593719482
Epoch: 20, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.416 Vali Acc: 0.850 Test Loss: 0.416 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7595252990722656
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.551 Vali Acc: 0.792 Test Loss: 0.551 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2291107177734375
Epoch: 22, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.425 Vali Acc: 0.860 Test Loss: 0.425 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.943596363067627
Epoch: 23, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.464 Vali Acc: 0.850 Test Loss: 0.464 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.914829969406128
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.462 Vali Acc: 0.846 Test Loss: 0.462 Test Acc: 0.846
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 26370
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.054201364517212
Epoch: 1, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.520 Vali Acc: 0.758 Test Loss: 0.520 Test Acc: 0.758
Validation loss decreased (inf --> -0.757674).  Saving model ...
Epoch: 2 cost time: 2.5404813289642334
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.434 Vali Acc: 0.826 Test Loss: 0.434 Test Acc: 0.826
Validation loss decreased (-0.757674 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 2.1673431396484375
Epoch: 3, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.439 Vali Acc: 0.788 Test Loss: 0.439 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6939432621002197
Epoch: 4, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.406 Vali Acc: 0.823 Test Loss: 0.406 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5137977600097656
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.609332799911499
Epoch: 6, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.368 Vali Acc: 0.846 Test Loss: 0.368 Test Acc: 0.846
Validation loss decreased (-0.825934 --> -0.846413).  Saving model ...
Epoch: 7 cost time: 2.263115406036377
Epoch: 7, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.405 Vali Acc: 0.840 Test Loss: 0.405 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0309269428253174
Epoch: 8, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.377 Vali Acc: 0.853 Test Loss: 0.377 Test Acc: 0.853
Validation loss decreased (-0.846413 --> -0.853239).  Saving model ...
Epoch: 9 cost time: 2.201089859008789
Epoch: 9, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.418 Vali Acc: 0.826 Test Loss: 0.418 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.277238607406616
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.392 Vali Acc: 0.829 Test Loss: 0.392 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4771952629089355
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.365 Vali Acc: 0.850 Test Loss: 0.365 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.035747528076172
Epoch: 12, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1206424236297607
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.353 Vali Acc: 0.853 Test Loss: 0.353 Test Acc: 0.853
Validation loss decreased (-0.853239 --> -0.853239).  Saving model ...
Epoch: 14 cost time: 1.9044063091278076
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.438 Vali Acc: 0.826 Test Loss: 0.438 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.600529909133911
Epoch: 15, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.387 Vali Acc: 0.846 Test Loss: 0.387 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.032468557357788
Epoch: 16, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.417 Vali Acc: 0.843 Test Loss: 0.417 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9574215412139893
Epoch: 17, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.391 Vali Acc: 0.840 Test Loss: 0.391 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.830268144607544
Epoch: 18, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.450 Vali Acc: 0.819 Test Loss: 0.450 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7163453102111816
Epoch: 19, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.439 Vali Acc: 0.836 Test Loss: 0.439 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0395758152008057
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8043267726898193
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.496 Vali Acc: 0.805 Test Loss: 0.496 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.071563720703125
Epoch: 22, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9553325176239014
Epoch: 23, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.469 Vali Acc: 0.823 Test Loss: 0.469 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm32_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 27394
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.168726682662964
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.511 Vali Acc: 0.782 Test Loss: 0.511 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 2.2750039100646973
Epoch: 2, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.410 Vali Acc: 0.812 Test Loss: 0.410 Test Acc: 0.812
Validation loss decreased (-0.781565 --> -0.812283).  Saving model ...
Epoch: 3 cost time: 1.9775619506835938
Epoch: 3, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5426294803619385
Epoch: 4, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.378 Vali Acc: 0.819 Test Loss: 0.378 Test Acc: 0.819
Validation loss decreased (-0.812283 --> -0.819109).  Saving model ...
Epoch: 5 cost time: 2.280897855758667
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.446 Vali Acc: 0.782 Test Loss: 0.446 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2100675106048584
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.266399383544922
Epoch: 7, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.451 Vali Acc: 0.792 Test Loss: 0.451 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.060012102127075
Epoch: 8, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.375 Vali Acc: 0.836 Test Loss: 0.375 Test Acc: 0.836
Validation loss decreased (-0.819109 --> -0.836174).  Saving model ...
Epoch: 9 cost time: 2.4210548400878906
Epoch: 9, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.482 Vali Acc: 0.805 Test Loss: 0.482 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4589757919311523
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.505 Vali Acc: 0.805 Test Loss: 0.505 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2658636569976807
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.564 Vali Acc: 0.788 Test Loss: 0.564 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.534975290298462
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.585 Vali Acc: 0.795 Test Loss: 0.585 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2660233974456787
Epoch: 13, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.637 Vali Acc: 0.771 Test Loss: 0.637 Test Acc: 0.771
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3558740615844727
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.227360963821411
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.694 Vali Acc: 0.782 Test Loss: 0.694 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.186204195022583
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.683 Vali Acc: 0.782 Test Loss: 0.683 Test Acc: 0.782
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.700348377227783
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.294041633605957
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 33842
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.325513124465942
Epoch: 1, Steps: 17 | Train Loss: 0.753 Vali Loss: 0.622 Vali Acc: 0.683 Test Loss: 0.622 Test Acc: 0.683
Validation loss decreased (inf --> -0.682588).  Saving model ...
Epoch: 2 cost time: 1.8632776737213135
Epoch: 2, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.465 Vali Acc: 0.819 Test Loss: 0.465 Test Acc: 0.819
Validation loss decreased (-0.682588 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.8466854095458984
Epoch: 3, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 2.148730754852295
Epoch: 4, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.399 Vali Acc: 0.836 Test Loss: 0.399 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 2.24772572517395
Epoch: 5, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.016704797744751
Epoch: 6, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.454 Vali Acc: 0.799 Test Loss: 0.454 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7369403839111328
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.376 Vali Acc: 0.843 Test Loss: 0.376 Test Acc: 0.843
Validation loss decreased (-0.836173 --> -0.843000).  Saving model ...
Epoch: 8 cost time: 1.6482489109039307
Epoch: 8, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.432 Vali Acc: 0.792 Test Loss: 0.432 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.890444278717041
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.443 Vali Acc: 0.795 Test Loss: 0.443 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2661352157592773
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9855244159698486
Epoch: 11, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.502 Vali Acc: 0.785 Test Loss: 0.502 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3094184398651123
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.439 Vali Acc: 0.816 Test Loss: 0.439 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.459674596786499
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.528 Vali Acc: 0.788 Test Loss: 0.528 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2423884868621826
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.479 Vali Acc: 0.819 Test Loss: 0.479 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8172590732574463
Epoch: 15, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.536 Vali Acc: 0.799 Test Loss: 0.536 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.792029619216919
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.524 Vali Acc: 0.799 Test Loss: 0.524 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8160059452056885
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.511 Vali Acc: 0.802 Test Loss: 0.511 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 27474
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.867884397506714
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.599 Vali Acc: 0.642 Test Loss: 0.599 Test Acc: 0.642
Validation loss decreased (inf --> -0.641632).  Saving model ...
Epoch: 2 cost time: 2.1562612056732178
Epoch: 2, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.486 Vali Acc: 0.747 Test Loss: 0.486 Test Acc: 0.747
Validation loss decreased (-0.641632 --> -0.747435).  Saving model ...
Epoch: 3 cost time: 2.172145366668701
Epoch: 3, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.492 Vali Acc: 0.747 Test Loss: 0.492 Test Acc: 0.747
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.896672248840332
Epoch: 4, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.483 Vali Acc: 0.765 Test Loss: 0.483 Test Acc: 0.765
Validation loss decreased (-0.747435 --> -0.764500).  Saving model ...
Epoch: 5 cost time: 1.7309041023254395
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.467 Vali Acc: 0.771 Test Loss: 0.467 Test Acc: 0.771
Validation loss decreased (-0.764500 --> -0.771326).  Saving model ...
Epoch: 6 cost time: 2.1950442790985107
Epoch: 6, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.441 Vali Acc: 0.792 Test Loss: 0.441 Test Acc: 0.792
Validation loss decreased (-0.771326 --> -0.791804).  Saving model ...
Epoch: 7 cost time: 1.9790666103363037
Epoch: 7, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.426 Vali Acc: 0.795 Test Loss: 0.426 Test Acc: 0.795
Validation loss decreased (-0.791804 --> -0.795218).  Saving model ...
Epoch: 8 cost time: 2.848456621170044
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.465 Vali Acc: 0.785 Test Loss: 0.465 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.260802984237671
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.440 Vali Acc: 0.782 Test Loss: 0.440 Test Acc: 0.782
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8679182529449463
Epoch: 10, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
Validation loss decreased (-0.795218 --> -0.808869).  Saving model ...
Epoch: 11 cost time: 2.538433313369751
Epoch: 11, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
Validation loss decreased (-0.808869 --> -0.808869).  Saving model ...
Epoch: 12 cost time: 1.83400559425354
Epoch: 12, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.445 Vali Acc: 0.802 Test Loss: 0.445 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0323054790496826
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
Validation loss decreased (-0.808869 --> -0.812282).  Saving model ...
Epoch: 14 cost time: 1.9660162925720215
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.438 Vali Acc: 0.809 Test Loss: 0.438 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2192840576171875
Epoch: 15, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.230565309524536
Epoch: 16, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.462 Vali Acc: 0.795 Test Loss: 0.462 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.731781005859375
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.495 Vali Acc: 0.799 Test Loss: 0.495 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4197027683258057
Epoch: 18, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.551 Vali Acc: 0.768 Test Loss: 0.551 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8954877853393555
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.479 Vali Acc: 0.795 Test Loss: 0.479 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.995154857635498
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.486 Vali Acc: 0.802 Test Loss: 0.486 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7387876510620117
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.552 Vali Acc: 0.775 Test Loss: 0.552 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.287555694580078
Epoch: 22, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
Validation loss decreased (-0.812282 --> -0.815695).  Saving model ...
Epoch: 23 cost time: 2.186750888824463
Epoch: 23, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1586055755615234
Epoch: 24, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.560 Vali Acc: 0.788 Test Loss: 0.560 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1148712635040283
Epoch: 25, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.605 Vali Acc: 0.775 Test Loss: 0.605 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.139711618423462
Epoch: 26, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.585 Vali Acc: 0.782 Test Loss: 0.585 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1374475955963135
Epoch: 27, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8531649112701416
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.651 Vali Acc: 0.768 Test Loss: 0.651 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9130244255065918
Epoch: 29, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.642 Vali Acc: 0.775 Test Loss: 0.642 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1317365169525146
Epoch: 30, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.622 Vali Acc: 0.795 Test Loss: 0.622 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9687087535858154
Epoch: 31, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.663 Vali Acc: 0.788 Test Loss: 0.663 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2468953132629395
Epoch: 32, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.739 Vali Acc: 0.754 Test Loss: 0.739 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8156996587030717
model parameter : 25346
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.1476969718933105
Epoch: 1, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.678 Vali Acc: 0.597 Test Loss: 0.678 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 1.8469264507293701
Epoch: 2, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.549 Vali Acc: 0.710 Test Loss: 0.549 Test Acc: 0.710
Validation loss decreased (-0.597263 --> -0.709892).  Saving model ...
Epoch: 3 cost time: 2.287862539291382
Epoch: 3, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.474 Vali Acc: 0.775 Test Loss: 0.474 Test Acc: 0.775
Validation loss decreased (-0.709892 --> -0.774739).  Saving model ...
Epoch: 4 cost time: 2.241067409515381
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.445 Vali Acc: 0.812 Test Loss: 0.445 Test Acc: 0.812
Validation loss decreased (-0.774739 --> -0.812282).  Saving model ...
Epoch: 5 cost time: 2.3056225776672363
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.437 Vali Acc: 0.792 Test Loss: 0.437 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.295977830886841
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.464 Vali Acc: 0.778 Test Loss: 0.464 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2488248348236084
Epoch: 7, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.419 Vali Acc: 0.819 Test Loss: 0.419 Test Acc: 0.819
Validation loss decreased (-0.812282 --> -0.819108).  Saving model ...
Epoch: 8 cost time: 1.8681933879852295
Epoch: 8, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.422 Vali Acc: 0.809 Test Loss: 0.422 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0609118938446045
Epoch: 9, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.407 Vali Acc: 0.826 Test Loss: 0.407 Test Acc: 0.826
Validation loss decreased (-0.819108 --> -0.825934).  Saving model ...
Epoch: 10 cost time: 2.260584831237793
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.468 Vali Acc: 0.795 Test Loss: 0.468 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0867669582366943
Epoch: 11, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.395 Vali Acc: 0.823 Test Loss: 0.395 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3019609451293945
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.441 Vali Acc: 0.782 Test Loss: 0.441 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1874847412109375
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.400 Vali Acc: 0.823 Test Loss: 0.400 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.28354811668396
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.440 Vali Acc: 0.795 Test Loss: 0.440 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4220011234283447
Epoch: 15, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836173).  Saving model ...
Epoch: 16 cost time: 2.2695493698120117
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.428 Vali Acc: 0.816 Test Loss: 0.428 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2804927825927734
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.426 Vali Acc: 0.826 Test Loss: 0.426 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8635990619659424
Epoch: 18, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.955601692199707
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.455 Vali Acc: 0.812 Test Loss: 0.455 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.419552803039551
Epoch: 20, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3693056106567383
Epoch: 21, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.30584454536438
Epoch: 22, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5433857440948486
Epoch: 23, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.434 Vali Acc: 0.836 Test Loss: 0.434 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3054299354553223
Epoch: 24, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.512 Vali Acc: 0.802 Test Loss: 0.512 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9207165241241455
Epoch: 25, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 24354
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.089568376541138
Epoch: 1, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.728 Vali Acc: 0.502 Test Loss: 0.728 Test Acc: 0.502
Validation loss decreased (inf --> -0.501699).  Saving model ...
Epoch: 2 cost time: 1.8841371536254883
Epoch: 2, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.529 Vali Acc: 0.754 Test Loss: 0.529 Test Acc: 0.754
Validation loss decreased (-0.501699 --> -0.754261).  Saving model ...
Epoch: 3 cost time: 2.2185847759246826
Epoch: 3, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.463 Vali Acc: 0.782 Test Loss: 0.463 Test Acc: 0.782
Validation loss decreased (-0.754261 --> -0.781565).  Saving model ...
Epoch: 4 cost time: 2.4447431564331055
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.445 Vali Acc: 0.785 Test Loss: 0.445 Test Acc: 0.785
Validation loss decreased (-0.781565 --> -0.784978).  Saving model ...
Epoch: 5 cost time: 1.9121928215026855
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.423 Vali Acc: 0.805 Test Loss: 0.423 Test Acc: 0.805
Validation loss decreased (-0.784978 --> -0.805457).  Saving model ...
Epoch: 6 cost time: 2.0989906787872314
Epoch: 6, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
Validation loss decreased (-0.805457 --> -0.819109).  Saving model ...
Epoch: 7 cost time: 1.8953285217285156
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.423 Vali Acc: 0.795 Test Loss: 0.423 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1707923412323
Epoch: 8, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.843 Test Loss: 0.393 Test Acc: 0.843
Validation loss decreased (-0.819109 --> -0.842999).  Saving model ...
Epoch: 9 cost time: 2.465880870819092
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.406 Vali Acc: 0.805 Test Loss: 0.406 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.154710531234741
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.364 Vali Acc: 0.840 Test Loss: 0.364 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9939594268798828
Epoch: 11, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.370 Vali Acc: 0.846 Test Loss: 0.370 Test Acc: 0.846
Validation loss decreased (-0.842999 --> -0.846413).  Saving model ...
Epoch: 12 cost time: 2.476135492324829
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.440 Vali Acc: 0.778 Test Loss: 0.440 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1399359703063965
Epoch: 13, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.402 Vali Acc: 0.826 Test Loss: 0.402 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0041239261627197
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9979267120361328
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2108583450317383
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3590140342712402
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.408 Vali Acc: 0.829 Test Loss: 0.408 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.135915517807007
Epoch: 18, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2697651386260986
Epoch: 19, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.828953742980957
Epoch: 20, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.427 Vali Acc: 0.836 Test Loss: 0.427 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.406994581222534
Epoch: 21, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 23922
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.6737799644470215
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.587 Vali Acc: 0.700 Test Loss: 0.587 Test Acc: 0.700
Validation loss decreased (inf --> -0.699653).  Saving model ...
Epoch: 2 cost time: 1.7881057262420654
Epoch: 2, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.484 Vali Acc: 0.826 Test Loss: 0.484 Test Acc: 0.826
Validation loss decreased (-0.699653 --> -0.825934).  Saving model ...
Epoch: 3 cost time: 2.6692957878112793
Epoch: 3, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.435 Vali Acc: 0.816 Test Loss: 0.435 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5354788303375244
Epoch: 4, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
Validation loss decreased (-0.825934 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.4986989498138428
Epoch: 5, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.403 Vali Acc: 0.819 Test Loss: 0.403 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3414719104766846
Epoch: 6, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.400 Vali Acc: 0.826 Test Loss: 0.400 Test Acc: 0.826
Validation loss decreased (-0.825934 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 2.6113412380218506
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.385 Vali Acc: 0.826 Test Loss: 0.385 Test Acc: 0.826
Validation loss decreased (-0.825935 --> -0.825935).  Saving model ...
Epoch: 8 cost time: 2.1991164684295654
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.380 Vali Acc: 0.843 Test Loss: 0.380 Test Acc: 0.843
Validation loss decreased (-0.825935 --> -0.843000).  Saving model ...
Epoch: 9 cost time: 2.394092082977295
Epoch: 9, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.393 Vali Acc: 0.819 Test Loss: 0.393 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0421717166900635
Epoch: 10, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.380 Vali Acc: 0.836 Test Loss: 0.380 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2996199131011963
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.372 Vali Acc: 0.843 Test Loss: 0.372 Test Acc: 0.843
Validation loss decreased (-0.843000 --> -0.843000).  Saving model ...
Epoch: 12 cost time: 2.8528099060058594
Epoch: 12, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.345 Vali Acc: 0.874 Test Loss: 0.345 Test Acc: 0.874
Validation loss decreased (-0.843000 --> -0.873717).  Saving model ...
Epoch: 13 cost time: 2.587217092514038
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.449 Vali Acc: 0.765 Test Loss: 0.449 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.924060583114624
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
Validation loss decreased (-0.873717 --> -0.880543).  Saving model ...
Epoch: 15 cost time: 2.457254648208618
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.391 Vali Acc: 0.850 Test Loss: 0.391 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4177253246307373
Epoch: 16, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.867 Test Loss: 0.368 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.017317771911621
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.385 Vali Acc: 0.863 Test Loss: 0.385 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9140253067016602
Epoch: 18, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2075085639953613
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.383 Vali Acc: 0.860 Test Loss: 0.383 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.200471878051758
Epoch: 20, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.381 Vali Acc: 0.860 Test Loss: 0.381 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.661245822906494
Epoch: 21, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.407 Vali Acc: 0.829 Test Loss: 0.407 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.534209728240967
Epoch: 22, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.420 Vali Acc: 0.826 Test Loss: 0.420 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2016258239746094
Epoch: 23, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.409 Vali Acc: 0.840 Test Loss: 0.409 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.313737392425537
Epoch: 24, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.430 Vali Acc: 0.826 Test Loss: 0.430 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 23874
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.4886040687561035
Epoch: 1, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.539 Vali Acc: 0.775 Test Loss: 0.539 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 2.1221437454223633
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.498 Vali Acc: 0.805 Test Loss: 0.498 Test Acc: 0.805
Validation loss decreased (-0.774739 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.2962875366210938
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.448 Vali Acc: 0.819 Test Loss: 0.448 Test Acc: 0.819
Validation loss decreased (-0.805456 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 2.774221897125244
Epoch: 4, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.419 Vali Acc: 0.833 Test Loss: 0.419 Test Acc: 0.833
Validation loss decreased (-0.819108 --> -0.832760).  Saving model ...
Epoch: 5 cost time: 2.037496566772461
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.424 Vali Acc: 0.816 Test Loss: 0.424 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.250715970993042
Epoch: 6, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.444 Vali Acc: 0.795 Test Loss: 0.444 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.386674165725708
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.355 Vali Acc: 0.853 Test Loss: 0.355 Test Acc: 0.853
Validation loss decreased (-0.832760 --> -0.853239).  Saving model ...
Epoch: 8 cost time: 1.9428586959838867
Epoch: 8, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.444 Vali Acc: 0.775 Test Loss: 0.444 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6018433570861816
Epoch: 9, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4354758262634277
Epoch: 10, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.425 Vali Acc: 0.792 Test Loss: 0.425 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6351864337921143
Epoch: 11, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.358 Vali Acc: 0.853 Test Loss: 0.358 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1377451419830322
Epoch: 12, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.352 Vali Acc: 0.857 Test Loss: 0.352 Test Acc: 0.857
Validation loss decreased (-0.853239 --> -0.856652).  Saving model ...
Epoch: 13 cost time: 2.201151132583618
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.48492169380188
Epoch: 14, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.397 Vali Acc: 0.846 Test Loss: 0.397 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9096128940582275
Epoch: 15, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.352 Vali Acc: 0.857 Test Loss: 0.352 Test Acc: 0.857
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.228572368621826
Epoch: 16, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.483 Vali Acc: 0.792 Test Loss: 0.483 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.162090301513672
Epoch: 17, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.365 Vali Acc: 0.860 Test Loss: 0.365 Test Acc: 0.860
Validation loss decreased (-0.856652 --> -0.860065).  Saving model ...
Epoch: 18 cost time: 2.228959798812866
Epoch: 18, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.859502077102661
Epoch: 19, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.384 Vali Acc: 0.829 Test Loss: 0.384 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.328150510787964
Epoch: 20, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.401 Vali Acc: 0.846 Test Loss: 0.401 Test Acc: 0.846
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2183945178985596
Epoch: 21, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.463 Vali Acc: 0.802 Test Loss: 0.463 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5244388580322266
Epoch: 22, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.402 Vali Acc: 0.846 Test Loss: 0.402 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4444241523742676
Epoch: 23, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.381 Vali Acc: 0.846 Test Loss: 0.381 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3060741424560547
Epoch: 24, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.418 Vali Acc: 0.843 Test Loss: 0.418 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3989713191986084
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.420 Vali Acc: 0.843 Test Loss: 0.420 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2509827613830566
Epoch: 26, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.438 Vali Acc: 0.823 Test Loss: 0.438 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.28964900970459
Epoch: 27, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.418 Vali Acc: 0.843 Test Loss: 0.418 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 24386
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.614652633666992
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
Validation loss decreased (inf --> -0.761087).  Saving model ...
Epoch: 2 cost time: 1.9300572872161865
Epoch: 2, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.469 Vali Acc: 0.778 Test Loss: 0.469 Test Acc: 0.778
Validation loss decreased (-0.761087 --> -0.778152).  Saving model ...
Epoch: 3 cost time: 2.989187240600586
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
Validation loss decreased (-0.778152 --> -0.819109).  Saving model ...
Epoch: 4 cost time: 2.2874808311462402
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.434 Vali Acc: 0.785 Test Loss: 0.434 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0769498348236084
Epoch: 5, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.404 Vali Acc: 0.816 Test Loss: 0.404 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0266942977905273
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.434 Vali Acc: 0.805 Test Loss: 0.434 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6783244609832764
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.469 Vali Acc: 0.785 Test Loss: 0.469 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6670000553131104
Epoch: 8, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.445 Vali Acc: 0.826 Test Loss: 0.445 Test Acc: 0.826
Validation loss decreased (-0.819109 --> -0.825934).  Saving model ...
Epoch: 9 cost time: 2.0058987140655518
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829347).  Saving model ...
Epoch: 10 cost time: 1.8832988739013672
Epoch: 10, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.509 Vali Acc: 0.802 Test Loss: 0.509 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0068302154541016
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.578 Vali Acc: 0.802 Test Loss: 0.578 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0144402980804443
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.519 Vali Acc: 0.823 Test Loss: 0.519 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5265858173370361
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.596 Vali Acc: 0.792 Test Loss: 0.596 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6970181465148926
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.607 Vali Acc: 0.805 Test Loss: 0.607 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7602713108062744
Epoch: 15, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8302690982818604
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.641 Vali Acc: 0.823 Test Loss: 0.641 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.068307399749756
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.703 Vali Acc: 0.795 Test Loss: 0.703 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9053583145141602
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.710 Vali Acc: 0.802 Test Loss: 0.710 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.906754970550537
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.686 Vali Acc: 0.795 Test Loss: 0.686 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 25394
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.978964328765869
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (inf --> -0.716718).  Saving model ...
Epoch: 2 cost time: 2.7560558319091797
Epoch: 2, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.460 Vali Acc: 0.792 Test Loss: 0.460 Test Acc: 0.792
Validation loss decreased (-0.716718 --> -0.791804).  Saving model ...
Epoch: 3 cost time: 2.692227840423584
Epoch: 3, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.436 Vali Acc: 0.782 Test Loss: 0.436 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.635866165161133
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.407 Vali Acc: 0.809 Test Loss: 0.407 Test Acc: 0.809
Validation loss decreased (-0.791804 --> -0.808870).  Saving model ...
Epoch: 5 cost time: 2.5196945667266846
Epoch: 5, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.457 Vali Acc: 0.799 Test Loss: 0.457 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4023194313049316
Epoch: 6, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.389 Vali Acc: 0.836 Test Loss: 0.389 Test Acc: 0.836
Validation loss decreased (-0.808870 --> -0.836174).  Saving model ...
Epoch: 7 cost time: 1.961442470550537
Epoch: 7, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.396 Vali Acc: 0.819 Test Loss: 0.396 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6145825386047363
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.492 Vali Acc: 0.795 Test Loss: 0.492 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.620143413543701
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.431 Vali Acc: 0.823 Test Loss: 0.431 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5466811656951904
Epoch: 10, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.434 Vali Acc: 0.799 Test Loss: 0.434 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4091532230377197
Epoch: 11, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.459 Vali Acc: 0.799 Test Loss: 0.459 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.511216640472412
Epoch: 12, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.474 Vali Acc: 0.802 Test Loss: 0.474 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.476213216781616
Epoch: 13, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.569 Vali Acc: 0.771 Test Loss: 0.569 Test Acc: 0.771
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3732757568359375
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.506 Vali Acc: 0.799 Test Loss: 0.506 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3894524574279785
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.562 Vali Acc: 0.771 Test Loss: 0.562 Test Acc: 0.771
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1694507598876953
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.482 Vali Acc: 0.823 Test Loss: 0.482 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 19026
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.082545042037964
Epoch: 1, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.817 Vali Acc: 0.410 Test Loss: 0.817 Test Acc: 0.410
Validation loss decreased (inf --> -0.409548).  Saving model ...
Epoch: 2 cost time: 2.1771163940429688
Epoch: 2, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.569 Vali Acc: 0.686 Test Loss: 0.569 Test Acc: 0.686
Validation loss decreased (-0.409548 --> -0.686001).  Saving model ...
Epoch: 3 cost time: 1.8481459617614746
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.443 Vali Acc: 0.809 Test Loss: 0.443 Test Acc: 0.809
Validation loss decreased (-0.686001 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 1.7523372173309326
Epoch: 4, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.402 Vali Acc: 0.846 Test Loss: 0.402 Test Acc: 0.846
Validation loss decreased (-0.808869 --> -0.846412).  Saving model ...
Epoch: 5 cost time: 2.2784955501556396
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.423 Vali Acc: 0.799 Test Loss: 0.423 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.992945671081543
Epoch: 6, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.392 Vali Acc: 0.829 Test Loss: 0.392 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.027130365371704
Epoch: 7, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.456 Vali Acc: 0.788 Test Loss: 0.456 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0984110832214355
Epoch: 8, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.413 Vali Acc: 0.809 Test Loss: 0.413 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7775943279266357
Epoch: 9, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.417 Vali Acc: 0.819 Test Loss: 0.417 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7002816200256348
Epoch: 10, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.426 Vali Acc: 0.795 Test Loss: 0.426 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7801718711853027
Epoch: 11, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.392 Vali Acc: 0.823 Test Loss: 0.392 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.456146717071533
Epoch: 12, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.442 Vali Acc: 0.812 Test Loss: 0.442 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6993348598480225
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.427 Vali Acc: 0.812 Test Loss: 0.427 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8891985416412354
Epoch: 14, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 16898
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.705198049545288
Epoch: 1, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.653 Vali Acc: 0.597 Test Loss: 0.653 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 1.9450738430023193
Epoch: 2, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.536 Vali Acc: 0.741 Test Loss: 0.536 Test Acc: 0.741
Validation loss decreased (-0.597263 --> -0.740609).  Saving model ...
Epoch: 3 cost time: 2.283557415008545
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.472 Vali Acc: 0.775 Test Loss: 0.472 Test Acc: 0.775
Validation loss decreased (-0.740609 --> -0.774739).  Saving model ...
Epoch: 4 cost time: 2.612835645675659
Epoch: 4, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.442 Vali Acc: 0.802 Test Loss: 0.442 Test Acc: 0.802
Validation loss decreased (-0.774739 --> -0.802043).  Saving model ...
Epoch: 5 cost time: 2.7222113609313965
Epoch: 5, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.433 Vali Acc: 0.812 Test Loss: 0.433 Test Acc: 0.812
Validation loss decreased (-0.802043 --> -0.812282).  Saving model ...
Epoch: 6 cost time: 2.400033473968506
Epoch: 6, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.438 Vali Acc: 0.785 Test Loss: 0.438 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1572039127349854
Epoch: 7, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.422 Vali Acc: 0.792 Test Loss: 0.422 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.331355571746826
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.449 Vali Acc: 0.788 Test Loss: 0.449 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.191235065460205
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.430 Vali Acc: 0.788 Test Loss: 0.430 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2243845462799072
Epoch: 10, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.449 Vali Acc: 0.788 Test Loss: 0.449 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.303659200668335
Epoch: 11, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.426 Vali Acc: 0.802 Test Loss: 0.426 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0841329097747803
Epoch: 12, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.405 Vali Acc: 0.829 Test Loss: 0.405 Test Acc: 0.829
Validation loss decreased (-0.812282 --> -0.829347).  Saving model ...
Epoch: 13 cost time: 2.62467622756958
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.829347 --> -0.839587).  Saving model ...
Epoch: 14 cost time: 1.8139894008636475
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.433 Vali Acc: 0.809 Test Loss: 0.433 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.034672737121582
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.430 Vali Acc: 0.840 Test Loss: 0.430 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2698428630828857
Epoch: 16, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.432 Vali Acc: 0.826 Test Loss: 0.432 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8832471370697021
Epoch: 17, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.441 Vali Acc: 0.802 Test Loss: 0.441 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3496506214141846
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3773393630981445
Epoch: 19, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.474 Vali Acc: 0.823 Test Loss: 0.474 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9575436115264893
Epoch: 20, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.362020969390869
Epoch: 21, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.467 Vali Acc: 0.836 Test Loss: 0.467 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4805400371551514
Epoch: 22, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.453 Vali Acc: 0.840 Test Loss: 0.453 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.504302501678467
Epoch: 23, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.490 Vali Acc: 0.819 Test Loss: 0.490 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 15906
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.689214706420898
Epoch: 1, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.712 Vali Acc: 0.539 Test Loss: 0.712 Test Acc: 0.539
Validation loss decreased (inf --> -0.539242).  Saving model ...
Epoch: 2 cost time: 1.7795648574829102
Epoch: 2, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.579 Vali Acc: 0.689 Test Loss: 0.579 Test Acc: 0.689
Validation loss decreased (-0.539242 --> -0.689414).  Saving model ...
Epoch: 3 cost time: 2.294865131378174
Epoch: 3, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.480 Vali Acc: 0.768 Test Loss: 0.480 Test Acc: 0.768
Validation loss decreased (-0.689414 --> -0.767913).  Saving model ...
Epoch: 4 cost time: 1.9364230632781982
Epoch: 4, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.424 Vali Acc: 0.823 Test Loss: 0.424 Test Acc: 0.823
Validation loss decreased (-0.767913 --> -0.822521).  Saving model ...
Epoch: 5 cost time: 1.861665964126587
Epoch: 5, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822522).  Saving model ...
Epoch: 6 cost time: 3.017159938812256
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.427 Vali Acc: 0.812 Test Loss: 0.427 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.815009355545044
Epoch: 7, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.417 Vali Acc: 0.816 Test Loss: 0.417 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.668142557144165
Epoch: 8, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.386 Vali Acc: 0.829 Test Loss: 0.386 Test Acc: 0.829
Validation loss decreased (-0.822522 --> -0.829348).  Saving model ...
Epoch: 9 cost time: 1.9210600852966309
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.376 Vali Acc: 0.823 Test Loss: 0.376 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.246485948562622
Epoch: 10, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839587).  Saving model ...
Epoch: 11 cost time: 2.015352964401245
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.383 Vali Acc: 0.840 Test Loss: 0.383 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4170260429382324
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.403 Vali Acc: 0.812 Test Loss: 0.403 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.163395643234253
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9888393878936768
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.386 Vali Acc: 0.829 Test Loss: 0.386 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.043875217437744
Epoch: 15, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.382 Vali Acc: 0.840 Test Loss: 0.382 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9928655624389648
Epoch: 16, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.415 Vali Acc: 0.819 Test Loss: 0.415 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.200683355331421
Epoch: 17, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.443 Vali Acc: 0.802 Test Loss: 0.443 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2205569744110107
Epoch: 18, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.387 Vali Acc: 0.840 Test Loss: 0.387 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5539798736572266
Epoch: 19, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.430 Vali Acc: 0.819 Test Loss: 0.430 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.091913938522339
Epoch: 20, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.462 Vali Acc: 0.802 Test Loss: 0.462 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 15474
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.429135322570801
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.680 Vali Acc: 0.556 Test Loss: 0.680 Test Acc: 0.556
Validation loss decreased (inf --> -0.556307).  Saving model ...
Epoch: 2 cost time: 2.5203521251678467
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.533 Vali Acc: 0.775 Test Loss: 0.533 Test Acc: 0.775
Validation loss decreased (-0.556307 --> -0.774739).  Saving model ...
Epoch: 3 cost time: 1.8891880512237549
Epoch: 3, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.469 Vali Acc: 0.799 Test Loss: 0.469 Test Acc: 0.799
Validation loss decreased (-0.774739 --> -0.798630).  Saving model ...
Epoch: 4 cost time: 2.535172700881958
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.456 Vali Acc: 0.782 Test Loss: 0.456 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.196078300476074
Epoch: 5, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.430 Vali Acc: 0.805 Test Loss: 0.430 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 6 cost time: 2.364053964614868
Epoch: 6, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.421 Vali Acc: 0.805 Test Loss: 0.421 Test Acc: 0.805
Validation loss decreased (-0.805456 --> -0.805457).  Saving model ...
Epoch: 7 cost time: 2.294553756713867
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.402 Vali Acc: 0.819 Test Loss: 0.402 Test Acc: 0.819
Validation loss decreased (-0.805457 --> -0.819109).  Saving model ...
Epoch: 8 cost time: 2.463953733444214
Epoch: 8, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.432 Vali Acc: 0.795 Test Loss: 0.432 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3763771057128906
Epoch: 9, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.349 Vali Acc: 0.867 Test Loss: 0.349 Test Acc: 0.867
Validation loss decreased (-0.819109 --> -0.866891).  Saving model ...
Epoch: 10 cost time: 2.711522340774536
Epoch: 10, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.390 Vali Acc: 0.836 Test Loss: 0.390 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.149953603744507
Epoch: 11, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6111271381378174
Epoch: 12, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.406 Vali Acc: 0.816 Test Loss: 0.406 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6948726177215576
Epoch: 13, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.346 Vali Acc: 0.867 Test Loss: 0.346 Test Acc: 0.867
Validation loss decreased (-0.866891 --> -0.866891).  Saving model ...
Epoch: 14 cost time: 2.2052783966064453
Epoch: 14, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4592783451080322
Epoch: 15, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.377 Vali Acc: 0.860 Test Loss: 0.377 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4864490032196045
Epoch: 16, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.359 Vali Acc: 0.870 Test Loss: 0.359 Test Acc: 0.870
Validation loss decreased (-0.866891 --> -0.870304).  Saving model ...
Epoch: 17 cost time: 2.268204689025879
Epoch: 17, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.353 Vali Acc: 0.863 Test Loss: 0.353 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9404146671295166
Epoch: 18, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.362 Vali Acc: 0.863 Test Loss: 0.362 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1588199138641357
Epoch: 19, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4646387100219727
Epoch: 20, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
Validation loss decreased (-0.870304 --> -0.870304).  Saving model ...
Epoch: 21 cost time: 2.0386476516723633
Epoch: 21, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.370 Vali Acc: 0.867 Test Loss: 0.370 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4066832065582275
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.434847593307495
Epoch: 23, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.378 Vali Acc: 0.860 Test Loss: 0.378 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.636890411376953
Epoch: 24, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.366 Vali Acc: 0.867 Test Loss: 0.366 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.425337791442871
Epoch: 25, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5981948375701904
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.378 Vali Acc: 0.857 Test Loss: 0.378 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.474381446838379
Epoch: 27, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.386 Vali Acc: 0.853 Test Loss: 0.386 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.6549646854400635
Epoch: 28, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.397 Vali Acc: 0.860 Test Loss: 0.397 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6764869689941406
Epoch: 29, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.368 Vali Acc: 0.863 Test Loss: 0.368 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.588273048400879
Epoch: 30, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 15426
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.574198007583618
Epoch: 1, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.652 Vali Acc: 0.614 Test Loss: 0.652 Test Acc: 0.614
Validation loss decreased (inf --> -0.614328).  Saving model ...
Epoch: 2 cost time: 1.884655475616455
Epoch: 2, Steps: 17 | Train Loss: 0.538 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
Validation loss decreased (-0.614328 --> -0.740609).  Saving model ...
Epoch: 3 cost time: 2.589341878890991
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.486 Vali Acc: 0.768 Test Loss: 0.486 Test Acc: 0.768
Validation loss decreased (-0.740609 --> -0.767913).  Saving model ...
Epoch: 4 cost time: 2.085801839828491
Epoch: 4, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.464 Vali Acc: 0.754 Test Loss: 0.464 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3332760334014893
Epoch: 5, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.412 Vali Acc: 0.819 Test Loss: 0.412 Test Acc: 0.819
Validation loss decreased (-0.767913 --> -0.819109).  Saving model ...
Epoch: 6 cost time: 2.2112467288970947
Epoch: 6, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.429 Vali Acc: 0.799 Test Loss: 0.429 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.209426164627075
Epoch: 7, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.405 Vali Acc: 0.809 Test Loss: 0.405 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.012530565261841
Epoch: 8, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.418 Vali Acc: 0.805 Test Loss: 0.418 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.195838212966919
Epoch: 9, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.374 Vali Acc: 0.826 Test Loss: 0.374 Test Acc: 0.826
Validation loss decreased (-0.819109 --> -0.825935).  Saving model ...
Epoch: 10 cost time: 2.370711326599121
Epoch: 10, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.388 Vali Acc: 0.823 Test Loss: 0.388 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.56062388420105
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.437 Vali Acc: 0.795 Test Loss: 0.437 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8391191959381104
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.407 Vali Acc: 0.816 Test Loss: 0.407 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6411383152008057
Epoch: 13, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.369 Vali Acc: 0.840 Test Loss: 0.369 Test Acc: 0.840
Validation loss decreased (-0.825935 --> -0.839587).  Saving model ...
Epoch: 14 cost time: 2.1844890117645264
Epoch: 14, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.30584716796875
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6929805278778076
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.395 Vali Acc: 0.843 Test Loss: 0.395 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.842999).  Saving model ...
Epoch: 17 cost time: 1.6564278602600098
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.422 Vali Acc: 0.826 Test Loss: 0.422 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3452000617980957
Epoch: 18, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.863635778427124
Epoch: 19, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.431 Vali Acc: 0.833 Test Loss: 0.431 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6365416049957275
Epoch: 20, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8446528911590576
Epoch: 21, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1870126724243164
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.343 Vali Acc: 0.870 Test Loss: 0.343 Test Acc: 0.870
Validation loss decreased (-0.842999 --> -0.870304).  Saving model ...
Epoch: 23 cost time: 2.17805552482605
Epoch: 23, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.443 Vali Acc: 0.829 Test Loss: 0.443 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.123910427093506
Epoch: 24, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.419 Vali Acc: 0.840 Test Loss: 0.419 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0076191425323486
Epoch: 25, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.561697244644165
Epoch: 26, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9206116199493408
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.454 Vali Acc: 0.829 Test Loss: 0.454 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1142914295196533
Epoch: 28, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.401 Vali Acc: 0.853 Test Loss: 0.401 Test Acc: 0.853
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.0776572227478027
Epoch: 29, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8143048286437988
Epoch: 30, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.452 Vali Acc: 0.840 Test Loss: 0.452 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9071109294891357
Epoch: 31, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.438 Vali Acc: 0.836 Test Loss: 0.438 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.5444483757019043
Epoch: 32, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.486 Vali Acc: 0.840 Test Loss: 0.486 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 15938
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.37107515335083
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
Validation loss decreased (inf --> -0.740609).  Saving model ...
Epoch: 2 cost time: 2.415848731994629
Epoch: 2, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.414 Vali Acc: 0.840 Test Loss: 0.414 Test Acc: 0.840
Validation loss decreased (-0.740609 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.200991153717041
Epoch: 3, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.839586 --> -0.839587).  Saving model ...
Epoch: 4 cost time: 2.342078924179077
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0333874225616455
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.394540548324585
Epoch: 6, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.326004981994629
Epoch: 7, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.458 Vali Acc: 0.816 Test Loss: 0.458 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7504875659942627
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.470 Vali Acc: 0.816 Test Loss: 0.470 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.167811632156372
Epoch: 9, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.504 Vali Acc: 0.795 Test Loss: 0.504 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4197120666503906
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3084707260131836
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.506 Vali Acc: 0.805 Test Loss: 0.506 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1221184730529785
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.562 Vali Acc: 0.785 Test Loss: 0.562 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.319049835205078
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.688 Vali Acc: 0.768 Test Loss: 0.688 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 21170
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.420844793319702
Epoch: 1, Steps: 17 | Train Loss: 0.773 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
Validation loss decreased (inf --> -0.767912).  Saving model ...
Epoch: 2 cost time: 1.7859976291656494
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.447 Vali Acc: 0.816 Test Loss: 0.447 Test Acc: 0.816
Validation loss decreased (-0.767912 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 2.2008495330810547
Epoch: 3, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.411 Vali Acc: 0.826 Test Loss: 0.411 Test Acc: 0.826
Validation loss decreased (-0.815695 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 2.168614625930786
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.418 Vali Acc: 0.823 Test Loss: 0.418 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.268101692199707
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.390 Vali Acc: 0.836 Test Loss: 0.390 Test Acc: 0.836
Validation loss decreased (-0.825934 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 1.8551695346832275
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
Validation loss decreased (-0.836174 --> -0.839587).  Saving model ...
Epoch: 7 cost time: 1.9407680034637451
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9647464752197266
Epoch: 8, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0989906787872314
Epoch: 9, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.422 Vali Acc: 0.829 Test Loss: 0.422 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1213772296905518
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.463 Vali Acc: 0.795 Test Loss: 0.463 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8552954196929932
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1540699005126953
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9873569011688232
Epoch: 13, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.078186511993408
Epoch: 14, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3733954429626465
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.504 Vali Acc: 0.805 Test Loss: 0.504 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5351450443267822
Epoch: 16, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 14802
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.594369888305664
Epoch: 1, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.540 Vali Acc: 0.751 Test Loss: 0.540 Test Acc: 0.751
Validation loss decreased (inf --> -0.750848).  Saving model ...
Epoch: 2 cost time: 2.2787318229675293
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.456 Vali Acc: 0.799 Test Loss: 0.456 Test Acc: 0.799
Validation loss decreased (-0.750848 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 2.6302382946014404
Epoch: 3, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.448 Vali Acc: 0.785 Test Loss: 0.448 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9238595962524414
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.440 Vali Acc: 0.795 Test Loss: 0.440 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3849170207977295
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.414 Vali Acc: 0.799 Test Loss: 0.414 Test Acc: 0.799
Validation loss decreased (-0.798630 --> -0.798631).  Saving model ...
Epoch: 6 cost time: 2.000584840774536
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.435 Vali Acc: 0.795 Test Loss: 0.435 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7399978637695312
Epoch: 7, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
Validation loss decreased (-0.798631 --> -0.812282).  Saving model ...
Epoch: 8 cost time: 1.9659314155578613
Epoch: 8, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.387 Vali Acc: 0.812 Test Loss: 0.387 Test Acc: 0.812
Validation loss decreased (-0.812282 --> -0.812283).  Saving model ...
Epoch: 9 cost time: 1.6505815982818604
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.400 Vali Acc: 0.819 Test Loss: 0.400 Test Acc: 0.819
Validation loss decreased (-0.812283 --> -0.819109).  Saving model ...
Epoch: 10 cost time: 2.0104167461395264
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.425 Vali Acc: 0.812 Test Loss: 0.425 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4057133197784424
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.446 Vali Acc: 0.802 Test Loss: 0.446 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5710649490356445
Epoch: 12, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.409 Vali Acc: 0.819 Test Loss: 0.409 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9522178173065186
Epoch: 13, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.444 Vali Acc: 0.809 Test Loss: 0.444 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.963716745376587
Epoch: 14, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.000586986541748
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.471 Vali Acc: 0.809 Test Loss: 0.471 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9566216468811035
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.458 Vali Acc: 0.809 Test Loss: 0.458 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8623950481414795
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.436 Vali Acc: 0.829 Test Loss: 0.436 Test Acc: 0.829
Validation loss decreased (-0.819109 --> -0.829347).  Saving model ...
Epoch: 18 cost time: 1.8457024097442627
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.143223762512207
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.501 Vali Acc: 0.795 Test Loss: 0.501 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.380997657775879
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.505 Vali Acc: 0.805 Test Loss: 0.505 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8802669048309326
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.527 Vali Acc: 0.799 Test Loss: 0.527 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4171886444091797
Epoch: 22, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5793874263763428
Epoch: 23, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.583 Vali Acc: 0.799 Test Loss: 0.583 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.559053659439087
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.531 Vali Acc: 0.805 Test Loss: 0.531 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.2781147956848145
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.560 Vali Acc: 0.805 Test Loss: 0.560 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1414709091186523
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.538 Vali Acc: 0.819 Test Loss: 0.538 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2158420085906982
Epoch: 27, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.614 Vali Acc: 0.795 Test Loss: 0.614 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 12674
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.155229568481445
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.677 Vali Acc: 0.608 Test Loss: 0.677 Test Acc: 0.608
Validation loss decreased (inf --> -0.607502).  Saving model ...
Epoch: 2 cost time: 1.8359239101409912
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.549 Vali Acc: 0.703 Test Loss: 0.549 Test Acc: 0.703
Validation loss decreased (-0.607502 --> -0.703066).  Saving model ...
Epoch: 3 cost time: 1.994659423828125
Epoch: 3, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.460 Vali Acc: 0.792 Test Loss: 0.460 Test Acc: 0.792
Validation loss decreased (-0.703066 --> -0.791804).  Saving model ...
Epoch: 4 cost time: 1.8699455261230469
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.439 Vali Acc: 0.799 Test Loss: 0.439 Test Acc: 0.799
Validation loss decreased (-0.791804 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 2.0121312141418457
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 6 cost time: 2.2277724742889404
Epoch: 6, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.454 Vali Acc: 0.782 Test Loss: 0.454 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9065418243408203
Epoch: 7, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.428 Vali Acc: 0.802 Test Loss: 0.428 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.681849718093872
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.393 Vali Acc: 0.826 Test Loss: 0.393 Test Acc: 0.826
Validation loss decreased (-0.805456 --> -0.825935).  Saving model ...
Epoch: 9 cost time: 2.08703351020813
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.441 Vali Acc: 0.795 Test Loss: 0.441 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.169646739959717
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.419 Vali Acc: 0.816 Test Loss: 0.419 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9302983283996582
Epoch: 11, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.400 Vali Acc: 0.819 Test Loss: 0.400 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.051518440246582
Epoch: 12, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.443 Vali Acc: 0.805 Test Loss: 0.443 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1416826248168945
Epoch: 13, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.442 Vali Acc: 0.816 Test Loss: 0.442 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2985191345214844
Epoch: 14, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.437 Vali Acc: 0.812 Test Loss: 0.437 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.368055820465088
Epoch: 15, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.439 Vali Acc: 0.823 Test Loss: 0.439 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3812451362609863
Epoch: 16, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3352224826812744
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.464 Vali Acc: 0.802 Test Loss: 0.464 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1395370960235596
Epoch: 18, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.465 Vali Acc: 0.802 Test Loss: 0.465 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 11682
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.964021921157837
Epoch: 1, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.701 Vali Acc: 0.536 Test Loss: 0.701 Test Acc: 0.536
Validation loss decreased (inf --> -0.535829).  Saving model ...
Epoch: 2 cost time: 2.1150901317596436
Epoch: 2, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.558 Vali Acc: 0.734 Test Loss: 0.558 Test Acc: 0.734
Validation loss decreased (-0.535829 --> -0.733783).  Saving model ...
Epoch: 3 cost time: 2.146393060684204
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.451 Vali Acc: 0.819 Test Loss: 0.451 Test Acc: 0.819
Validation loss decreased (-0.733783 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.8503291606903076
Epoch: 4, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.437 Vali Acc: 0.795 Test Loss: 0.437 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.266704559326172
Epoch: 5, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.422 Vali Acc: 0.809 Test Loss: 0.422 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.154021978378296
Epoch: 6, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.398 Vali Acc: 0.829 Test Loss: 0.398 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 7 cost time: 2.112398862838745
Epoch: 7, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.829348 --> -0.832761).  Saving model ...
Epoch: 8 cost time: 2.575493812561035
Epoch: 8, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.369 Vali Acc: 0.853 Test Loss: 0.369 Test Acc: 0.853
Validation loss decreased (-0.832761 --> -0.853239).  Saving model ...
Epoch: 9 cost time: 2.213186502456665
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.356 Vali Acc: 0.857 Test Loss: 0.356 Test Acc: 0.857
Validation loss decreased (-0.853239 --> -0.856652).  Saving model ...
Epoch: 10 cost time: 1.8269259929656982
Epoch: 10, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.365 Vali Acc: 0.853 Test Loss: 0.365 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.249854803085327
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.367 Vali Acc: 0.853 Test Loss: 0.367 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.212292194366455
Epoch: 12, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2126851081848145
Epoch: 13, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.387 Vali Acc: 0.840 Test Loss: 0.387 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0487613677978516
Epoch: 14, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.402 Vali Acc: 0.833 Test Loss: 0.402 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4619288444519043
Epoch: 15, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.106660842895508
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.373 Vali Acc: 0.857 Test Loss: 0.373 Test Acc: 0.857
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0013010501861572
Epoch: 17, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.395 Vali Acc: 0.836 Test Loss: 0.395 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.043250799179077
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.784970998764038
Epoch: 19, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.397 Vali Acc: 0.840 Test Loss: 0.397 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 11250
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.941429615020752
Epoch: 1, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.690 Vali Acc: 0.560 Test Loss: 0.690 Test Acc: 0.560
Validation loss decreased (inf --> -0.559720).  Saving model ...
Epoch: 2 cost time: 1.7177748680114746
Epoch: 2, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.561 Vali Acc: 0.747 Test Loss: 0.561 Test Acc: 0.747
Validation loss decreased (-0.559720 --> -0.747435).  Saving model ...
Epoch: 3 cost time: 1.8808040618896484
Epoch: 3, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.489 Vali Acc: 0.771 Test Loss: 0.489 Test Acc: 0.771
Validation loss decreased (-0.747435 --> -0.771326).  Saving model ...
Epoch: 4 cost time: 1.592428207397461
Epoch: 4, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.451 Vali Acc: 0.792 Test Loss: 0.451 Test Acc: 0.792
Validation loss decreased (-0.771326 --> -0.791804).  Saving model ...
Epoch: 5 cost time: 1.8292381763458252
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.415 Vali Acc: 0.802 Test Loss: 0.415 Test Acc: 0.802
Validation loss decreased (-0.791804 --> -0.802044).  Saving model ...
Epoch: 6 cost time: 1.8236675262451172
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.420 Vali Acc: 0.816 Test Loss: 0.420 Test Acc: 0.816
Validation loss decreased (-0.802044 --> -0.815695).  Saving model ...
Epoch: 7 cost time: 1.936110258102417
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.385 Vali Acc: 0.823 Test Loss: 0.385 Test Acc: 0.823
Validation loss decreased (-0.815695 --> -0.822522).  Saving model ...
Epoch: 8 cost time: 2.075815200805664
Epoch: 8, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.401 Vali Acc: 0.812 Test Loss: 0.401 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.170269012451172
Epoch: 9, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.396 Vali Acc: 0.816 Test Loss: 0.396 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.166083574295044
Epoch: 10, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.373 Vali Acc: 0.843 Test Loss: 0.373 Test Acc: 0.843
Validation loss decreased (-0.822522 --> -0.843000).  Saving model ...
Epoch: 11 cost time: 2.084470272064209
Epoch: 11, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.381 Vali Acc: 0.829 Test Loss: 0.381 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9420900344848633
Epoch: 12, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.391 Vali Acc: 0.833 Test Loss: 0.391 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5308632850646973
Epoch: 13, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.386 Vali Acc: 0.826 Test Loss: 0.386 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.149029493331909
Epoch: 14, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.348 Vali Acc: 0.860 Test Loss: 0.348 Test Acc: 0.860
Validation loss decreased (-0.843000 --> -0.860065).  Saving model ...
Epoch: 15 cost time: 1.9757962226867676
Epoch: 15, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.375 Vali Acc: 0.857 Test Loss: 0.375 Test Acc: 0.857
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.72102952003479
Epoch: 16, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.379 Vali Acc: 0.853 Test Loss: 0.379 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8236291408538818
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.365 Vali Acc: 0.863 Test Loss: 0.365 Test Acc: 0.863
Validation loss decreased (-0.860065 --> -0.863478).  Saving model ...
Epoch: 18 cost time: 1.7411675453186035
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.447 Vali Acc: 0.788 Test Loss: 0.447 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0474653244018555
Epoch: 19, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.379 Vali Acc: 0.867 Test Loss: 0.379 Test Acc: 0.867
Validation loss decreased (-0.863478 --> -0.866890).  Saving model ...
Epoch: 20 cost time: 1.7226183414459229
Epoch: 20, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9269328117370605
Epoch: 21, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.392 Vali Acc: 0.836 Test Loss: 0.392 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6227996349334717
Epoch: 22, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.430 Vali Acc: 0.823 Test Loss: 0.430 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.62064790725708
Epoch: 23, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.400 Vali Acc: 0.843 Test Loss: 0.400 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.853508472442627
Epoch: 24, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.451 Vali Acc: 0.809 Test Loss: 0.451 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.917196273803711
Epoch: 25, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1886377334594727
Epoch: 26, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.427 Vali Acc: 0.843 Test Loss: 0.427 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5975046157836914
Epoch: 27, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.421 Vali Acc: 0.836 Test Loss: 0.421 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6888809204101562
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.501 Vali Acc: 0.782 Test Loss: 0.501 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1449084281921387
Epoch: 29, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.453 Vali Acc: 0.826 Test Loss: 0.453 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 11202
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.487765550613403
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.740 Vali Acc: 0.474 Test Loss: 0.740 Test Acc: 0.474
Validation loss decreased (inf --> -0.474395).  Saving model ...
Epoch: 2 cost time: 1.6216773986816406
Epoch: 2, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.602 Vali Acc: 0.655 Test Loss: 0.602 Test Acc: 0.655
Validation loss decreased (-0.474395 --> -0.655284).  Saving model ...
Epoch: 3 cost time: 2.0856165885925293
Epoch: 3, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.467 Vali Acc: 0.809 Test Loss: 0.467 Test Acc: 0.809
Validation loss decreased (-0.655284 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 2.632047414779663
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.413 Vali Acc: 0.826 Test Loss: 0.413 Test Acc: 0.826
Validation loss decreased (-0.808869 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 2.163051128387451
Epoch: 5, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.440 Vali Acc: 0.802 Test Loss: 0.440 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.868706464767456
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.401 Vali Acc: 0.823 Test Loss: 0.401 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2301156520843506
Epoch: 7, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.385 Vali Acc: 0.829 Test Loss: 0.385 Test Acc: 0.829
Validation loss decreased (-0.825934 --> -0.829348).  Saving model ...
Epoch: 8 cost time: 1.7982017993927002
Epoch: 8, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.399 Vali Acc: 0.823 Test Loss: 0.399 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8957037925720215
Epoch: 9, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0307199954986572
Epoch: 10, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.398 Vali Acc: 0.823 Test Loss: 0.398 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5677082538604736
Epoch: 11, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.373 Vali Acc: 0.840 Test Loss: 0.373 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839587).  Saving model ...
Epoch: 12 cost time: 2.21156644821167
Epoch: 12, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.389 Vali Acc: 0.833 Test Loss: 0.389 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8255934715270996
Epoch: 13, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.403 Vali Acc: 0.826 Test Loss: 0.403 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9411396980285645
Epoch: 14, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.368 Vali Acc: 0.843 Test Loss: 0.368 Test Acc: 0.843
Validation loss decreased (-0.839587 --> -0.843000).  Saving model ...
Epoch: 15 cost time: 2.708134889602661
Epoch: 15, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.395 Vali Acc: 0.840 Test Loss: 0.395 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9657111167907715
Epoch: 16, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.223483085632324
Epoch: 17, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.385 Vali Acc: 0.840 Test Loss: 0.385 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7312731742858887
Epoch: 18, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8666996955871582
Epoch: 19, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.357 Vali Acc: 0.860 Test Loss: 0.357 Test Acc: 0.860
Validation loss decreased (-0.843000 --> -0.860065).  Saving model ...
Epoch: 20 cost time: 2.4239017963409424
Epoch: 20, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.392 Vali Acc: 0.843 Test Loss: 0.392 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4659152030944824
Epoch: 21, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.437 Vali Acc: 0.816 Test Loss: 0.437 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6165342330932617
Epoch: 22, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.401 Vali Acc: 0.836 Test Loss: 0.401 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.156134605407715
Epoch: 23, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.372 Vali Acc: 0.853 Test Loss: 0.372 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.416738748550415
Epoch: 24, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.195436954498291
Epoch: 25, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9242608547210693
Epoch: 26, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.453 Vali Acc: 0.823 Test Loss: 0.453 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.149214029312134
Epoch: 27, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2478246688842773
Epoch: 28, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.435 Vali Acc: 0.823 Test Loss: 0.435 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.428600549697876
Epoch: 29, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.487 Vali Acc: 0.812 Test Loss: 0.487 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el2_dm16_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 11714
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.72934627532959
Epoch: 1, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 2.735398054122925
Epoch: 2, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.681 Vali Acc: 0.792 Test Loss: 0.681 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.13269305229187
Epoch: 3, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.613041877746582
Epoch: 4, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.697 Vali Acc: 0.795 Test Loss: 0.697 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8105242252349854
Epoch: 5, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.743 Vali Acc: 0.812 Test Loss: 0.743 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.342679262161255
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.357 Vali Acc: 0.734 Test Loss: 1.357 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0455198287963867
Epoch: 7, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.060 Vali Acc: 0.795 Test Loss: 1.060 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5456645488739014
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.520 Vali Acc: 0.765 Test Loss: 1.520 Test Acc: 0.765
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4473328590393066
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.310 Vali Acc: 0.761 Test Loss: 1.310 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.030203342437744
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.635 Vali Acc: 0.737 Test Loss: 1.635 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.527702569961548
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.792 Vali Acc: 0.758 Test Loss: 1.792 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8191126279863481
model parameter : 249346
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.874284505844116
Epoch: 1, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.417 Vali Acc: 0.809 Test Loss: 0.417 Test Acc: 0.809
Validation loss decreased (inf --> -0.808870).  Saving model ...
Epoch: 2 cost time: 2.3043572902679443
Epoch: 2, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.527 Vali Acc: 0.768 Test Loss: 0.527 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3232500553131104
Epoch: 3, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
Validation loss decreased (-0.808870 --> -0.832760).  Saving model ...
Epoch: 4 cost time: 2.0192525386810303
Epoch: 4, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2357547283172607
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.675 Vali Acc: 0.799 Test Loss: 0.675 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.210782051086426
Epoch: 6, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2729547023773193
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.995 Vali Acc: 0.727 Test Loss: 0.995 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.822295904159546
Epoch: 8, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.811 Vali Acc: 0.826 Test Loss: 0.811 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4278502464294434
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.077 Vali Acc: 0.771 Test Loss: 1.077 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.841827869415283
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.370 Vali Acc: 0.730 Test Loss: 1.370 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7177658081054688
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.926 Vali Acc: 0.823 Test Loss: 0.926 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9419491291046143
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.148 Vali Acc: 0.792 Test Loss: 1.148 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.106172800064087
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.378 Vali Acc: 0.788 Test Loss: 1.378 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 198402
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.160943508148193
Epoch: 1, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.423 Vali Acc: 0.829 Test Loss: 0.423 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.7608637809753418
Epoch: 2, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.421 Vali Acc: 0.843 Test Loss: 0.421 Test Acc: 0.843
Validation loss decreased (-0.829347 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 1.8674156665802002
Epoch: 3, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.459 Vali Acc: 0.805 Test Loss: 0.459 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5291402339935303
Epoch: 4, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.549 Vali Acc: 0.799 Test Loss: 0.549 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5332717895507812
Epoch: 5, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3310587406158447
Epoch: 6, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.693 Vali Acc: 0.768 Test Loss: 0.693 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9855527877807617
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.777681589126587
Epoch: 8, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.709 Vali Acc: 0.795 Test Loss: 0.709 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0129947662353516
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7176451683044434
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.808 Vali Acc: 0.802 Test Loss: 0.808 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0426743030548096
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.078 Vali Acc: 0.778 Test Loss: 1.078 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.050900936126709
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.833 Vali Acc: 0.809 Test Loss: 0.833 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 181378
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.933611631393433
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.466 Vali Acc: 0.802 Test Loss: 0.466 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 2.1401970386505127
Epoch: 2, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.362 Vali Acc: 0.870 Test Loss: 0.362 Test Acc: 0.870
Validation loss decreased (-0.802043 --> -0.870304).  Saving model ...
Epoch: 3 cost time: 1.4344329833984375
Epoch: 3, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.440 Vali Acc: 0.805 Test Loss: 0.440 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5219361782073975
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.112313985824585
Epoch: 5, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.523 Vali Acc: 0.792 Test Loss: 0.523 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0839016437530518
Epoch: 6, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.482 Vali Acc: 0.823 Test Loss: 0.482 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.281219482421875
Epoch: 7, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6137807369232178
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.564 Vali Acc: 0.833 Test Loss: 0.564 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8011610507965088
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.769 Vali Acc: 0.788 Test Loss: 0.769 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8495543003082275
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.661 Vali Acc: 0.826 Test Loss: 0.661 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0439698696136475
Epoch: 11, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.801 Vali Acc: 0.792 Test Loss: 0.801 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0080788135528564
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.748 Vali Acc: 0.812 Test Loss: 0.748 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 173442
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.661756992340088
Epoch: 1, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.429 Vali Acc: 0.829 Test Loss: 0.429 Test Acc: 0.829
Validation loss decreased (inf --> -0.829347).  Saving model ...
Epoch: 2 cost time: 1.8568744659423828
Epoch: 2, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.450 Vali Acc: 0.802 Test Loss: 0.450 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.131108522415161
Epoch: 3, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.829347 --> -0.849826).  Saving model ...
Epoch: 4 cost time: 1.990316390991211
Epoch: 4, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.413 Vali Acc: 0.846 Test Loss: 0.413 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9215731620788574
Epoch: 5, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.462 Vali Acc: 0.819 Test Loss: 0.462 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7873318195343018
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0861477851867676
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.468 Vali Acc: 0.843 Test Loss: 0.468 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.369227647781372
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.595 Vali Acc: 0.823 Test Loss: 0.595 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2005770206451416
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.591 Vali Acc: 0.819 Test Loss: 0.591 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.915529727935791
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.524 Vali Acc: 0.853 Test Loss: 0.524 Test Acc: 0.853
Validation loss decreased (-0.849826 --> -0.853237).  Saving model ...
Epoch: 11 cost time: 1.7558681964874268
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.824704647064209
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.715 Vali Acc: 0.823 Test Loss: 0.715 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8095924854278564
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.669 Vali Acc: 0.823 Test Loss: 0.669 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8548481464385986
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.811 Vali Acc: 0.802 Test Loss: 0.811 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8968279361724854
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.805 Vali Acc: 0.805 Test Loss: 0.805 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.067692995071411
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.828 Vali Acc: 0.816 Test Loss: 0.828 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2609989643096924
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0979480743408203
Epoch: 18, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.879 Vali Acc: 0.819 Test Loss: 0.879 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9482412338256836
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.874 Vali Acc: 0.823 Test Loss: 0.874 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3771424293518066
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.865 Vali Acc: 0.823 Test Loss: 0.865 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 169986
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.711352348327637
Epoch: 1, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.461 Vali Acc: 0.765 Test Loss: 0.461 Test Acc: 0.765
Validation loss decreased (inf --> -0.764501).  Saving model ...
Epoch: 2 cost time: 1.5952918529510498
Epoch: 2, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.413 Vali Acc: 0.809 Test Loss: 0.413 Test Acc: 0.809
Validation loss decreased (-0.764501 --> -0.808870).  Saving model ...
Epoch: 3 cost time: 1.7079124450683594
Epoch: 3, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.483 Vali Acc: 0.775 Test Loss: 0.483 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9111688137054443
Epoch: 4, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.355 Vali Acc: 0.846 Test Loss: 0.355 Test Acc: 0.846
Validation loss decreased (-0.808870 --> -0.846413).  Saving model ...
Epoch: 5 cost time: 1.6807384490966797
Epoch: 5, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.383 Vali Acc: 0.857 Test Loss: 0.383 Test Acc: 0.857
Validation loss decreased (-0.846413 --> -0.856651).  Saving model ...
Epoch: 6 cost time: 1.5360326766967773
Epoch: 6, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.523 Vali Acc: 0.775 Test Loss: 0.523 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6608140468597412
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.410 Vali Acc: 0.843 Test Loss: 0.410 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.510648488998413
Epoch: 8, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.551 Vali Acc: 0.802 Test Loss: 0.551 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6797912120819092
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6562473773956299
Epoch: 10, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.541 Vali Acc: 0.823 Test Loss: 0.541 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7967233657836914
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.496 Vali Acc: 0.843 Test Loss: 0.496 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8001303672790527
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9859199523925781
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.707385540008545
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.643 Vali Acc: 0.819 Test Loss: 0.643 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9446635246276855
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.665 Vali Acc: 0.819 Test Loss: 0.665 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 169602
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.995753765106201
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.458 Vali Acc: 0.788 Test Loss: 0.458 Test Acc: 0.788
Validation loss decreased (inf --> -0.788391).  Saving model ...
Epoch: 2 cost time: 1.7363545894622803
Epoch: 2, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.384 Vali Acc: 0.819 Test Loss: 0.384 Test Acc: 0.819
Validation loss decreased (-0.788391 --> -0.819109).  Saving model ...
Epoch: 3 cost time: 1.5912396907806396
Epoch: 3, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.450 Vali Acc: 0.788 Test Loss: 0.450 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6379520893096924
Epoch: 4, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.343 Vali Acc: 0.860 Test Loss: 0.343 Test Acc: 0.860
Validation loss decreased (-0.819109 --> -0.860065).  Saving model ...
Epoch: 5 cost time: 1.8588716983795166
Epoch: 5, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.414 Vali Acc: 0.823 Test Loss: 0.414 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.745894432067871
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.452 Vali Acc: 0.819 Test Loss: 0.452 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6815505027770996
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.330335855484009
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.450 Vali Acc: 0.840 Test Loss: 0.450 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1103057861328125
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.584 Vali Acc: 0.788 Test Loss: 0.584 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.926095962524414
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.592 Vali Acc: 0.812 Test Loss: 0.592 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7447667121887207
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.511 Vali Acc: 0.836 Test Loss: 0.511 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.798771858215332
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.795 Vali Acc: 0.765 Test Loss: 0.795 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5951793193817139
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.568 Vali Acc: 0.829 Test Loss: 0.568 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.691904067993164
Epoch: 14, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.914 Vali Acc: 0.737 Test Loss: 0.914 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 173698
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.175693511962891
Epoch: 1, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.518 Vali Acc: 0.812 Test Loss: 0.518 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 2.552311658859253
Epoch: 2, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.463 Vali Acc: 0.829 Test Loss: 0.463 Test Acc: 0.829
Validation loss decreased (-0.812282 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 1.4682164192199707
Epoch: 3, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.343719482421875
Epoch: 4, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0474679470062256
Epoch: 5, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.675 Vali Acc: 0.829 Test Loss: 0.675 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0864851474761963
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.266583204269409
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.016 Vali Acc: 0.792 Test Loss: 1.016 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9958577156066895
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.170 Vali Acc: 0.768 Test Loss: 1.170 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0133297443389893
Epoch: 9, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.202 Vali Acc: 0.792 Test Loss: 1.202 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8120145797729492
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.149 Vali Acc: 0.823 Test Loss: 1.149 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.553173303604126
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.618 Vali Acc: 0.778 Test Loss: 1.618 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1013412475585938
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.939 Vali Acc: 0.754 Test Loss: 1.939 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 216450
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.058813810348511
Epoch: 1, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.432 Vali Acc: 0.843 Test Loss: 0.432 Test Acc: 0.843
Validation loss decreased (inf --> -0.842999).  Saving model ...
Epoch: 2 cost time: 2.121373414993286
Epoch: 2, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.500 Vali Acc: 0.782 Test Loss: 0.500 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2758164405822754
Epoch: 3, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.228426218032837
Epoch: 4, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.646 Vali Acc: 0.833 Test Loss: 0.646 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.466081380844116
Epoch: 5, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.721 Vali Acc: 0.788 Test Loss: 0.721 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6063826084136963
Epoch: 6, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9592723846435547
Epoch: 7, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.213 Vali Acc: 0.751 Test Loss: 1.213 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0509088039398193
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.671 Vali Acc: 0.840 Test Loss: 0.671 Test Acc: 0.840
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.04146409034729
Epoch: 9, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.131 Vali Acc: 0.765 Test Loss: 1.131 Test Acc: 0.765
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3682892322540283
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.005 Vali Acc: 0.785 Test Loss: 1.005 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.2634334564208984
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.080 Vali Acc: 0.812 Test Loss: 1.080 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 165506
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.353076219558716
Epoch: 1, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.391 Vali Acc: 0.840 Test Loss: 0.391 Test Acc: 0.840
Validation loss decreased (inf --> -0.839587).  Saving model ...
Epoch: 2 cost time: 2.188535690307617
Epoch: 2, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.569 Vali Acc: 0.730 Test Loss: 0.569 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2965807914733887
Epoch: 3, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.610 Vali Acc: 0.730 Test Loss: 0.610 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.237295389175415
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.528 Vali Acc: 0.788 Test Loss: 0.528 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.350965738296509
Epoch: 5, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.537 Vali Acc: 0.802 Test Loss: 0.537 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4538943767547607
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.535 Vali Acc: 0.819 Test Loss: 0.535 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.149562358856201
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.666 Vali Acc: 0.788 Test Loss: 0.666 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.033798933029175
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1724236011505127
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.713 Vali Acc: 0.812 Test Loss: 0.713 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.318711996078491
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.027 Vali Acc: 0.778 Test Loss: 1.027 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.190807342529297
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.790 Vali Acc: 0.823 Test Loss: 0.790 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 148482
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.457523345947266
Epoch: 1, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.455 Vali Acc: 0.782 Test Loss: 0.455 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 1.6630403995513916
Epoch: 2, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.393 Vali Acc: 0.836 Test Loss: 0.393 Test Acc: 0.836
Validation loss decreased (-0.781565 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 2.7813236713409424
Epoch: 3, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2979369163513184
Epoch: 4, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.362119197845459
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.474 Vali Acc: 0.836 Test Loss: 0.474 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9784889221191406
Epoch: 6, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.468 Vali Acc: 0.840 Test Loss: 0.468 Test Acc: 0.840
Validation loss decreased (-0.836174 --> -0.839586).  Saving model ...
Epoch: 7 cost time: 1.7587559223175049
Epoch: 7, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.239750862121582
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.583 Vali Acc: 0.823 Test Loss: 0.583 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9335675239562988
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.621 Vali Acc: 0.805 Test Loss: 0.621 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4846949577331543
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.832 Vali Acc: 0.785 Test Loss: 0.832 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.5266356468200684
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.620 Vali Acc: 0.853 Test Loss: 0.620 Test Acc: 0.853
Validation loss decreased (-0.839586 --> -0.853236).  Saving model ...
Epoch: 12 cost time: 1.9346003532409668
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.699 Vali Acc: 0.826 Test Loss: 0.699 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2802155017852783
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.771 Vali Acc: 0.802 Test Loss: 0.771 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9138548374176025
Epoch: 14, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.829 Vali Acc: 0.812 Test Loss: 0.829 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.131464719772339
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.838 Vali Acc: 0.823 Test Loss: 0.838 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5214273929595947
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.358504295349121
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.856 Vali Acc: 0.826 Test Loss: 0.856 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.363924264907837
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.068 Vali Acc: 0.788 Test Loss: 1.068 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.247083902359009
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.896 Vali Acc: 0.826 Test Loss: 0.896 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.909487247467041
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.072 Vali Acc: 0.795 Test Loss: 1.072 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0747599601745605
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.066 Vali Acc: 0.812 Test Loss: 1.066 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 140546
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.153486490249634
Epoch: 1, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.453 Vali Acc: 0.792 Test Loss: 0.453 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 1.9791488647460938
Epoch: 2, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.416 Vali Acc: 0.812 Test Loss: 0.416 Test Acc: 0.812
Validation loss decreased (-0.791804 --> -0.812283).  Saving model ...
Epoch: 3 cost time: 1.921809434890747
Epoch: 3, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.436 Vali Acc: 0.788 Test Loss: 0.436 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1417534351348877
Epoch: 4, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.428 Vali Acc: 0.812 Test Loss: 0.428 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9217219352722168
Epoch: 5, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4988644123077393
Epoch: 6, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.491 Vali Acc: 0.812 Test Loss: 0.491 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9779503345489502
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.577 Vali Acc: 0.782 Test Loss: 0.577 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0107717514038086
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3094871044158936
Epoch: 9, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.511 Vali Acc: 0.833 Test Loss: 0.511 Test Acc: 0.833
Validation loss decreased (-0.812283 --> -0.832759).  Saving model ...
Epoch: 10 cost time: 2.43306303024292
Epoch: 10, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.558 Vali Acc: 0.819 Test Loss: 0.558 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.619248390197754
Epoch: 11, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.711 Vali Acc: 0.785 Test Loss: 0.711 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1287589073181152
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.713 Vali Acc: 0.799 Test Loss: 0.713 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.193718671798706
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.738 Vali Acc: 0.795 Test Loss: 0.738 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.264584541320801
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.889 Vali Acc: 0.782 Test Loss: 0.889 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2654120922088623
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.701 Vali Acc: 0.805 Test Loss: 0.701 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7465131282806396
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.893 Vali Acc: 0.792 Test Loss: 0.893 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.734011650085449
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.773 Vali Acc: 0.812 Test Loss: 0.773 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3944201469421387
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.985 Vali Acc: 0.785 Test Loss: 0.985 Test Acc: 0.785
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3236706256866455
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.885 Vali Acc: 0.805 Test Loss: 0.885 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 137090
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.275388956069946
Epoch: 1, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.435 Vali Acc: 0.802 Test Loss: 0.435 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 1.872443437576294
Epoch: 2, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.431 Vali Acc: 0.795 Test Loss: 0.431 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5746779441833496
Epoch: 3, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.802043 --> -0.839587).  Saving model ...
Epoch: 4 cost time: 2.1939547061920166
Epoch: 4, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.415 Vali Acc: 0.812 Test Loss: 0.415 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5904695987701416
Epoch: 5, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.453 Vali Acc: 0.816 Test Loss: 0.453 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.234605073928833
Epoch: 6, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3245315551757812
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.339987277984619
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.450 Vali Acc: 0.823 Test Loss: 0.450 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0368428230285645
Epoch: 9, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.478 Vali Acc: 0.823 Test Loss: 0.478 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0183684825897217
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.617 Vali Acc: 0.799 Test Loss: 0.617 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5027871131896973
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.585 Vali Acc: 0.802 Test Loss: 0.585 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1928293704986572
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.570 Vali Acc: 0.805 Test Loss: 0.570 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.094670295715332
Epoch: 13, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.634 Vali Acc: 0.799 Test Loss: 0.634 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 136706
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.9089038372039795
Epoch: 1, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.429 Vali Acc: 0.812 Test Loss: 0.429 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.7572095394134521
Epoch: 2, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.385 Vali Acc: 0.829 Test Loss: 0.385 Test Acc: 0.829
Validation loss decreased (-0.812282 --> -0.829348).  Saving model ...
Epoch: 3 cost time: 1.8336234092712402
Epoch: 3, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.370 Vali Acc: 0.840 Test Loss: 0.370 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839587).  Saving model ...
Epoch: 4 cost time: 1.2377264499664307
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.431 Vali Acc: 0.823 Test Loss: 0.431 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4296739101409912
Epoch: 5, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.459 Vali Acc: 0.809 Test Loss: 0.459 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5608367919921875
Epoch: 6, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.426 Vali Acc: 0.826 Test Loss: 0.426 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6553397178649902
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.465 Vali Acc: 0.823 Test Loss: 0.465 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4819586277008057
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.509 Vali Acc: 0.799 Test Loss: 0.509 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6415884494781494
Epoch: 9, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.483 Vali Acc: 0.826 Test Loss: 0.483 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.409339189529419
Epoch: 10, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.597 Vali Acc: 0.805 Test Loss: 0.597 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7518668174743652
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.543 Vali Acc: 0.812 Test Loss: 0.543 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4915168285369873
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.637 Vali Acc: 0.799 Test Loss: 0.637 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7028062343597412
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.837 Vali Acc: 0.751 Test Loss: 0.837 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 140802
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.670878887176514
Epoch: 1, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.560 Vali Acc: 0.751 Test Loss: 0.560 Test Acc: 0.751
Validation loss decreased (inf --> -0.750848).  Saving model ...
Epoch: 2 cost time: 2.076159954071045
Epoch: 2, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.513 Vali Acc: 0.823 Test Loss: 0.513 Test Acc: 0.823
Validation loss decreased (-0.750848 --> -0.822520).  Saving model ...
Epoch: 3 cost time: 2.1718802452087402
Epoch: 3, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.711 Vali Acc: 0.765 Test Loss: 0.711 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1677050590515137
Epoch: 4, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.631 Vali Acc: 0.826 Test Loss: 0.631 Test Acc: 0.826
Validation loss decreased (-0.822520 --> -0.825932).  Saving model ...
Epoch: 5 cost time: 2.1078901290893555
Epoch: 5, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.695 Vali Acc: 0.816 Test Loss: 0.695 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2002692222595215
Epoch: 6, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.016 Vali Acc: 0.768 Test Loss: 1.016 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.834205150604248
Epoch: 7, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.870 Vali Acc: 0.836 Test Loss: 0.870 Test Acc: 0.836
Validation loss decreased (-0.825932 --> -0.836169).  Saving model ...
Epoch: 8 cost time: 2.0905914306640625
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.646 Vali Acc: 0.717 Test Loss: 1.646 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.175417900085449
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.363 Vali Acc: 0.754 Test Loss: 1.363 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.313220977783203
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.373 Vali Acc: 0.816 Test Loss: 1.373 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9383010864257812
Epoch: 11, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.827 Vali Acc: 0.758 Test Loss: 1.827 Test Acc: 0.758
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9915275573730469
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.456 Vali Acc: 0.799 Test Loss: 1.456 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4280483722686768
Epoch: 13, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.459 Vali Acc: 0.812 Test Loss: 1.459 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1207292079925537
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.837 Vali Acc: 0.802 Test Loss: 1.837 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0977773666381836
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.880 Vali Acc: 0.802 Test Loss: 1.880 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3022844791412354
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.787 Vali Acc: 0.805 Test Loss: 1.787 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7225356101989746
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.124 Vali Acc: 0.785 Test Loss: 2.124 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 200002
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.93165135383606
Epoch: 1, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.485 Vali Acc: 0.799 Test Loss: 0.485 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.9139769077301025
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.462 Vali Acc: 0.843 Test Loss: 0.462 Test Acc: 0.843
Validation loss decreased (-0.798630 --> -0.842999).  Saving model ...
Epoch: 3 cost time: 2.135624885559082
Epoch: 3, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.518 Vali Acc: 0.802 Test Loss: 0.518 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5393095016479492
Epoch: 4, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.392073392868042
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.979365587234497
Epoch: 6, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.639 Vali Acc: 0.829 Test Loss: 0.639 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.800344467163086
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.743 Vali Acc: 0.805 Test Loss: 0.743 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4676480293273926
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.966 Vali Acc: 0.775 Test Loss: 0.966 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4002387523651123
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.979 Vali Acc: 0.788 Test Loss: 0.979 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.293940305709839
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.879 Vali Acc: 0.840 Test Loss: 0.879 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.92370867729187
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.474 Vali Acc: 0.751 Test Loss: 1.474 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0444629192352295
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.172 Vali Acc: 0.782 Test Loss: 1.172 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 149058
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.697928190231323
Epoch: 1, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.395 Vali Acc: 0.846 Test Loss: 0.395 Test Acc: 0.846
Validation loss decreased (inf --> -0.846412).  Saving model ...
Epoch: 2 cost time: 1.7640495300292969
Epoch: 2, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.406 Vali Acc: 0.843 Test Loss: 0.406 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3639206886291504
Epoch: 3, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9810607433319092
Epoch: 4, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.410 Vali Acc: 0.850 Test Loss: 0.410 Test Acc: 0.850
Validation loss decreased (-0.846412 --> -0.849825).  Saving model ...
Epoch: 5 cost time: 1.902479648590088
Epoch: 5, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.569 Vali Acc: 0.823 Test Loss: 0.569 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7464478015899658
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.438 Vali Acc: 0.857 Test Loss: 0.438 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856651).  Saving model ...
Epoch: 7 cost time: 1.8919479846954346
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.649 Vali Acc: 0.795 Test Loss: 0.649 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8312067985534668
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.922 Vali Acc: 0.771 Test Loss: 0.922 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.208003044128418
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.621 Vali Acc: 0.829 Test Loss: 0.621 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4627182483673096
Epoch: 10, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.886 Vali Acc: 0.771 Test Loss: 0.886 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.010282278060913
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.719 Vali Acc: 0.826 Test Loss: 0.719 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0823779106140137
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.037 Vali Acc: 0.782 Test Loss: 1.037 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.039658784866333
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.776 Vali Acc: 0.823 Test Loss: 0.776 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8458423614501953
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.343 Vali Acc: 0.778 Test Loss: 1.343 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7506232261657715
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.900 Vali Acc: 0.823 Test Loss: 0.900 Test Acc: 0.823
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.058453321456909
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.122 Vali Acc: 0.782 Test Loss: 1.122 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 132034
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.069728851318359
Epoch: 1, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.499 Vali Acc: 0.737 Test Loss: 0.499 Test Acc: 0.737
Validation loss decreased (inf --> -0.737196).  Saving model ...
Epoch: 2 cost time: 2.008699655532837
Epoch: 2, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.491 Vali Acc: 0.782 Test Loss: 0.491 Test Acc: 0.782
Validation loss decreased (-0.737196 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 1.9920096397399902
Epoch: 3, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.395 Vali Acc: 0.840 Test Loss: 0.395 Test Acc: 0.840
Validation loss decreased (-0.781565 --> -0.839586).  Saving model ...
Epoch: 4 cost time: 1.3105828762054443
Epoch: 4, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.477 Vali Acc: 0.816 Test Loss: 0.477 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6582849025726318
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.507 Vali Acc: 0.812 Test Loss: 0.507 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6559679508209229
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.506 Vali Acc: 0.819 Test Loss: 0.506 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7894566059112549
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.707 Vali Acc: 0.778 Test Loss: 0.707 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7365326881408691
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.780 Vali Acc: 0.761 Test Loss: 0.780 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4484200477600098
Epoch: 9, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.610 Vali Acc: 0.816 Test Loss: 0.610 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8746988773345947
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.690 Vali Acc: 0.812 Test Loss: 0.690 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6142475605010986
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.811 Vali Acc: 0.795 Test Loss: 0.811 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6677117347717285
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.736 Vali Acc: 0.799 Test Loss: 0.736 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9918229579925537
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.050 Vali Acc: 0.754 Test Loss: 1.050 Test Acc: 0.754
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 124098
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.708988666534424
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.894979476928711
Epoch: 2, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.421 Vali Acc: 0.812 Test Loss: 0.421 Test Acc: 0.812
Validation loss decreased (-0.808869 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.7149829864501953
Epoch: 3, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.481 Vali Acc: 0.795 Test Loss: 0.481 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5960097312927246
Epoch: 4, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.370 Vali Acc: 0.850 Test Loss: 0.370 Test Acc: 0.850
Validation loss decreased (-0.812282 --> -0.849826).  Saving model ...
Epoch: 5 cost time: 1.8799312114715576
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.468 Vali Acc: 0.819 Test Loss: 0.468 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1762959957122803
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.536 Vali Acc: 0.802 Test Loss: 0.536 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9822993278503418
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.577 Vali Acc: 0.782 Test Loss: 0.577 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8249244689941406
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.483 Vali Acc: 0.843 Test Loss: 0.483 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7952232360839844
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.687 Vali Acc: 0.799 Test Loss: 0.687 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8752996921539307
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4093270301818848
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.656 Vali Acc: 0.819 Test Loss: 0.656 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.712744951248169
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.834 Vali Acc: 0.795 Test Loss: 0.834 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5796360969543457
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.695 Vali Acc: 0.812 Test Loss: 0.695 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7619707584381104
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 120642
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.43691873550415
Epoch: 1, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.515 Vali Acc: 0.720 Test Loss: 0.515 Test Acc: 0.720
Validation loss decreased (inf --> -0.720131).  Saving model ...
Epoch: 2 cost time: 1.5114760398864746
Epoch: 2, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.387 Vali Acc: 0.829 Test Loss: 0.387 Test Acc: 0.829
Validation loss decreased (-0.720131 --> -0.829348).  Saving model ...
Epoch: 3 cost time: 1.6683924198150635
Epoch: 3, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.453 Vali Acc: 0.819 Test Loss: 0.453 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9108555316925049
Epoch: 4, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.438 Vali Acc: 0.819 Test Loss: 0.438 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7601523399353027
Epoch: 5, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7536139488220215
Epoch: 6, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.483 Vali Acc: 0.795 Test Loss: 0.483 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7119581699371338
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6156718730926514
Epoch: 8, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.436 Vali Acc: 0.836 Test Loss: 0.436 Test Acc: 0.836
Validation loss decreased (-0.829348 --> -0.836173).  Saving model ...
Epoch: 9 cost time: 1.5523295402526855
Epoch: 9, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.530 Vali Acc: 0.826 Test Loss: 0.530 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7523932456970215
Epoch: 10, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.501 Vali Acc: 0.829 Test Loss: 0.501 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.008115530014038
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.668 Vali Acc: 0.805 Test Loss: 0.668 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8434360027313232
Epoch: 12, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.625 Vali Acc: 0.812 Test Loss: 0.625 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8738250732421875
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.618 Vali Acc: 0.826 Test Loss: 0.618 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.868173599243164
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.861 Vali Acc: 0.758 Test Loss: 0.861 Test Acc: 0.758
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4463541507720947
Epoch: 15, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.736 Vali Acc: 0.816 Test Loss: 0.736 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6544606685638428
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.828 Vali Acc: 0.785 Test Loss: 0.828 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.431870460510254
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.919 Vali Acc: 0.782 Test Loss: 0.919 Test Acc: 0.782
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6914300918579102
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.893 Vali Acc: 0.799 Test Loss: 0.893 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 120258
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.31904411315918
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 2.128601551055908
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.417 Vali Acc: 0.812 Test Loss: 0.417 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.836360216140747
Epoch: 3, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.394 Vali Acc: 0.812 Test Loss: 0.394 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.735029697418213
Epoch: 4, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.405 Vali Acc: 0.809 Test Loss: 0.405 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0097599029541016
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.426 Vali Acc: 0.816 Test Loss: 0.426 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.651296854019165
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.449 Vali Acc: 0.816 Test Loss: 0.449 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.142382860183716
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.490 Vali Acc: 0.812 Test Loss: 0.490 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.121485710144043
Epoch: 8, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.487 Vali Acc: 0.816 Test Loss: 0.487 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8512663841247559
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.491 Vali Acc: 0.840 Test Loss: 0.491 Test Acc: 0.840
Validation loss decreased (-0.832760 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.7844164371490479
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8833987712860107
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.519 Vali Acc: 0.829 Test Loss: 0.519 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5576536655426025
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.662 Vali Acc: 0.795 Test Loss: 0.662 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.775986671447754
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.663 Vali Acc: 0.819 Test Loss: 0.663 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.480452299118042
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.696 Vali Acc: 0.805 Test Loss: 0.696 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3634145259857178
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.677 Vali Acc: 0.819 Test Loss: 0.677 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7707226276397705
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.713 Vali Acc: 0.816 Test Loss: 0.713 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.215845823287964
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.683 Vali Acc: 0.836 Test Loss: 0.683 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7003757953643799
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.016 Vali Acc: 0.761 Test Loss: 1.016 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9268279075622559
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.723 Vali Acc: 0.823 Test Loss: 0.723 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm128_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 124354
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.5479772090911865
Epoch: 1, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.438 Vali Acc: 0.816 Test Loss: 0.438 Test Acc: 0.816
Validation loss decreased (inf --> -0.815695).  Saving model ...
Epoch: 2 cost time: 2.0029680728912354
Epoch: 2, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
Validation loss decreased (-0.815695 --> -0.866891).  Saving model ...
Epoch: 3 cost time: 2.3681700229644775
Epoch: 3, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.758 Vali Acc: 0.713 Test Loss: 0.758 Test Acc: 0.713
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5229668617248535
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.823 Vali Acc: 0.706 Test Loss: 0.823 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2032666206359863
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.785 Vali Acc: 0.751 Test Loss: 0.785 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.408236265182495
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.800 Vali Acc: 0.751 Test Loss: 0.800 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.537320375442505
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.762 Vali Acc: 0.775 Test Loss: 0.762 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.296355962753296
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.679 Vali Acc: 0.829 Test Loss: 0.679 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.191269874572754
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3328144550323486
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.767 Vali Acc: 0.823 Test Loss: 0.767 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7661831378936768
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.958 Vali Acc: 0.788 Test Loss: 0.958 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1965301036834717
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.147 Vali Acc: 0.758 Test Loss: 1.147 Test Acc: 0.758
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 108418
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.068059206008911
Epoch: 1, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.400 Vali Acc: 0.840 Test Loss: 0.400 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 2.359708070755005
Epoch: 2, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.428 Vali Acc: 0.819 Test Loss: 0.428 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0803515911102295
Epoch: 3, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.486 Vali Acc: 0.788 Test Loss: 0.486 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5612728595733643
Epoch: 4, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.452 Vali Acc: 0.812 Test Loss: 0.452 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6823115348815918
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.536 Vali Acc: 0.782 Test Loss: 0.536 Test Acc: 0.782
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7698662281036377
Epoch: 6, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.512 Vali Acc: 0.812 Test Loss: 0.512 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.12465500831604
Epoch: 7, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.019850969314575
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.789 Vali Acc: 0.744 Test Loss: 0.789 Test Acc: 0.744
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6038920879364014
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.922344446182251
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.884 Vali Acc: 0.765 Test Loss: 0.884 Test Acc: 0.765
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9641973972320557
Epoch: 11, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.712 Vali Acc: 0.799 Test Loss: 0.712 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 82946
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.094040632247925
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.477 Vali Acc: 0.778 Test Loss: 0.477 Test Acc: 0.778
Validation loss decreased (inf --> -0.778152).  Saving model ...
Epoch: 2 cost time: 2.081118583679199
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.415 Vali Acc: 0.840 Test Loss: 0.415 Test Acc: 0.840
Validation loss decreased (-0.778152 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 2.3876535892486572
Epoch: 3, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.383 Vali Acc: 0.840 Test Loss: 0.383 Test Acc: 0.840
Validation loss decreased (-0.839586 --> -0.839587).  Saving model ...
Epoch: 4 cost time: 2.1646714210510254
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.461 Vali Acc: 0.802 Test Loss: 0.461 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.393228054046631
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.412 Vali Acc: 0.846 Test Loss: 0.412 Test Acc: 0.846
Validation loss decreased (-0.839587 --> -0.846412).  Saving model ...
Epoch: 6 cost time: 2.329348087310791
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3304367065429688
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.505 Vali Acc: 0.795 Test Loss: 0.505 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3384511470794678
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.449 Vali Acc: 0.843 Test Loss: 0.449 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6412465572357178
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.632 Vali Acc: 0.768 Test Loss: 0.632 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6690425872802734
Epoch: 10, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.560 Vali Acc: 0.819 Test Loss: 0.560 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8142666816711426
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0720996856689453
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.588 Vali Acc: 0.829 Test Loss: 0.588 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.064791440963745
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.659 Vali Acc: 0.816 Test Loss: 0.659 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6149566173553467
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.709 Vali Acc: 0.805 Test Loss: 0.709 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0468320846557617
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.719 Vali Acc: 0.812 Test Loss: 0.719 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 74434
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.209093809127808
Epoch: 1, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.520 Vali Acc: 0.768 Test Loss: 0.520 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.6529672145843506
Epoch: 2, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.460 Vali Acc: 0.799 Test Loss: 0.460 Test Acc: 0.799
Validation loss decreased (-0.767913 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 2.1104652881622314
Epoch: 3, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.458 Vali Acc: 0.785 Test Loss: 0.458 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.220931053161621
Epoch: 4, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 5 cost time: 2.080127239227295
Epoch: 5, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.351468801498413
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.511 Vali Acc: 0.792 Test Loss: 0.511 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.128157377243042
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.562 Vali Acc: 0.795 Test Loss: 0.562 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9915406703948975
Epoch: 8, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.478 Vali Acc: 0.840 Test Loss: 0.478 Test Acc: 0.840
Validation loss decreased (-0.805456 --> -0.839586).  Saving model ...
Epoch: 9 cost time: 1.5767128467559814
Epoch: 9, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.569 Vali Acc: 0.792 Test Loss: 0.569 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.018310546875
Epoch: 10, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.016180992126465
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.588 Vali Acc: 0.812 Test Loss: 0.588 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0356061458587646
Epoch: 12, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.598 Vali Acc: 0.802 Test Loss: 0.598 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.157092809677124
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.667 Vali Acc: 0.795 Test Loss: 0.667 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9942877292633057
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.670 Vali Acc: 0.799 Test Loss: 0.670 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9165356159210205
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.623 Vali Acc: 0.816 Test Loss: 0.623 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.134413719177246
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.757 Vali Acc: 0.802 Test Loss: 0.757 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7226126194000244
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.738 Vali Acc: 0.805 Test Loss: 0.738 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.722313404083252
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.751 Vali Acc: 0.819 Test Loss: 0.751 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 70466
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.7027366161346436
Epoch: 1, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 1.9170448780059814
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.410 Vali Acc: 0.819 Test Loss: 0.410 Test Acc: 0.819
Validation loss decreased (-0.726957 --> -0.819109).  Saving model ...
Epoch: 3 cost time: 1.6439924240112305
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.495 Vali Acc: 0.765 Test Loss: 0.495 Test Acc: 0.765
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.906496286392212
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
Validation loss decreased (-0.819109 --> -0.829348).  Saving model ...
Epoch: 5 cost time: 2.0634567737579346
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.531 Vali Acc: 0.754 Test Loss: 0.531 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9995219707489014
Epoch: 6, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.434 Vali Acc: 0.792 Test Loss: 0.434 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1431124210357666
Epoch: 7, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.457 Vali Acc: 0.805 Test Loss: 0.457 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7155520915985107
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0734784603118896
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.436 Vali Acc: 0.823 Test Loss: 0.436 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.756847620010376
Epoch: 10, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.553 Vali Acc: 0.775 Test Loss: 0.553 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7884907722473145
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.533 Vali Acc: 0.802 Test Loss: 0.533 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.766211986541748
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.531 Vali Acc: 0.802 Test Loss: 0.531 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.138169050216675
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.608 Vali Acc: 0.788 Test Loss: 0.608 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.0668554306030273
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.517 Vali Acc: 0.812 Test Loss: 0.517 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 68738
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0524773597717285
Epoch: 1, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.494 Vali Acc: 0.833 Test Loss: 0.494 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.8537185192108154
Epoch: 2, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.383 Vali Acc: 0.857 Test Loss: 0.383 Test Acc: 0.857
Validation loss decreased (-0.832760 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 1.716243028640747
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.366 Vali Acc: 0.853 Test Loss: 0.366 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.738358974456787
Epoch: 4, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.416 Vali Acc: 0.812 Test Loss: 0.416 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7169325351715088
Epoch: 5, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5747041702270508
Epoch: 6, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.350 Vali Acc: 0.860 Test Loss: 0.350 Test Acc: 0.860
Validation loss decreased (-0.856651 --> -0.860065).  Saving model ...
Epoch: 7 cost time: 1.2501068115234375
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.426 Vali Acc: 0.816 Test Loss: 0.426 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6659777164459229
Epoch: 8, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.471 Vali Acc: 0.799 Test Loss: 0.471 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3879601955413818
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.427 Vali Acc: 0.840 Test Loss: 0.427 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5757789611816406
Epoch: 10, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.422 Vali Acc: 0.843 Test Loss: 0.422 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.603320598602295
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.559 Vali Acc: 0.785 Test Loss: 0.559 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.176745891571045
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.578 Vali Acc: 0.771 Test Loss: 0.578 Test Acc: 0.771
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.841719627380371
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.429 Vali Acc: 0.846 Test Loss: 0.429 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9109351634979248
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.512 Vali Acc: 0.826 Test Loss: 0.512 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4456353187561035
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7672672271728516
Epoch: 16, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.515 Vali Acc: 0.819 Test Loss: 0.515 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 68546
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.2500128746032715
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.499 Vali Acc: 0.782 Test Loss: 0.499 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 1.4913547039031982
Epoch: 2, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.429 Vali Acc: 0.802 Test Loss: 0.429 Test Acc: 0.802
Validation loss decreased (-0.781565 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 1.4449374675750732
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.442 Vali Acc: 0.802 Test Loss: 0.442 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8156347274780273
Epoch: 4, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.483 Vali Acc: 0.775 Test Loss: 0.483 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6974124908447266
Epoch: 5, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.435 Vali Acc: 0.802 Test Loss: 0.435 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5704634189605713
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.455 Vali Acc: 0.775 Test Loss: 0.455 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.522836446762085
Epoch: 7, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.455 Vali Acc: 0.795 Test Loss: 0.455 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8105530738830566
Epoch: 8, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.449 Vali Acc: 0.809 Test Loss: 0.449 Test Acc: 0.809
Validation loss decreased (-0.802043 --> -0.808869).  Saving model ...
Epoch: 9 cost time: 1.7334706783294678
Epoch: 9, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.462 Vali Acc: 0.805 Test Loss: 0.462 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7137928009033203
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.504 Vali Acc: 0.795 Test Loss: 0.504 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5036776065826416
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.509 Vali Acc: 0.809 Test Loss: 0.509 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7861087322235107
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.544 Vali Acc: 0.788 Test Loss: 0.544 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8702311515808105
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.560 Vali Acc: 0.788 Test Loss: 0.560 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6821181774139404
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.90437912940979
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.656 Vali Acc: 0.782 Test Loss: 0.656 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5293104648590088
Epoch: 16, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.553 Vali Acc: 0.799 Test Loss: 0.553 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8524599075317383
Epoch: 17, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.647 Vali Acc: 0.792 Test Loss: 0.647 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.097587823867798
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.616 Vali Acc: 0.795 Test Loss: 0.616 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8088737201365188
model parameter : 70594
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.834252834320068
Epoch: 1, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.437 Vali Acc: 0.826 Test Loss: 0.437 Test Acc: 0.826
Validation loss decreased (inf --> -0.825934).  Saving model ...
Epoch: 2 cost time: 1.6716935634613037
Epoch: 2, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.501 Vali Acc: 0.778 Test Loss: 0.501 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.220191717147827
Epoch: 3, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.404 Vali Acc: 0.823 Test Loss: 0.404 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5384140014648438
Epoch: 4, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.620 Vali Acc: 0.761 Test Loss: 0.620 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6412231922149658
Epoch: 5, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.569 Vali Acc: 0.823 Test Loss: 0.569 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2960896492004395
Epoch: 6, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.471 Vali Acc: 0.846 Test Loss: 0.471 Test Acc: 0.846
Validation loss decreased (-0.825934 --> -0.846412).  Saving model ...
Epoch: 7 cost time: 2.2413008213043213
Epoch: 7, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.868 Vali Acc: 0.782 Test Loss: 0.868 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9700822830200195
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.860 Vali Acc: 0.785 Test Loss: 0.860 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1022024154663086
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.859 Vali Acc: 0.768 Test Loss: 0.859 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.823563814163208
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.922 Vali Acc: 0.788 Test Loss: 0.922 Test Acc: 0.788
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0029520988464355
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.018 Vali Acc: 0.782 Test Loss: 1.018 Test Acc: 0.782
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.014129161834717
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.352 Vali Acc: 0.782 Test Loss: 1.352 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.928452730178833
Epoch: 13, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.892 Vali Acc: 0.829 Test Loss: 0.892 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0600264072418213
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.318 Vali Acc: 0.768 Test Loss: 1.318 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.439211368560791
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.964 Vali Acc: 0.819 Test Loss: 0.964 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.175132989883423
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.329 Vali Acc: 0.788 Test Loss: 1.329 Test Acc: 0.788
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 91906
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.986378192901611
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.446 Vali Acc: 0.809 Test Loss: 0.446 Test Acc: 0.809
Validation loss decreased (inf --> -0.808869).  Saving model ...
Epoch: 2 cost time: 1.6875078678131104
Epoch: 2, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.416 Vali Acc: 0.819 Test Loss: 0.416 Test Acc: 0.819
Validation loss decreased (-0.808869 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.8671314716339111
Epoch: 3, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.606 Vali Acc: 0.724 Test Loss: 0.606 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8743669986724854
Epoch: 4, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.457 Vali Acc: 0.805 Test Loss: 0.457 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.668949842453003
Epoch: 5, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.470 Vali Acc: 0.812 Test Loss: 0.470 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.457414388656616
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.958848237991333
Epoch: 7, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.505 Vali Acc: 0.819 Test Loss: 0.505 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4457497596740723
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.669 Vali Acc: 0.802 Test Loss: 0.669 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8946294784545898
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.717 Vali Acc: 0.775 Test Loss: 0.717 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.127429723739624
Epoch: 10, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.721 Vali Acc: 0.785 Test Loss: 0.721 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7983651161193848
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.655 Vali Acc: 0.802 Test Loss: 0.655 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8120923042297363
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.910 Vali Acc: 0.792 Test Loss: 0.910 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8191126279863481
model parameter : 66434
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.3497819900512695
Epoch: 1, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.451 Vali Acc: 0.792 Test Loss: 0.451 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 2.068147659301758
Epoch: 2, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.411 Vali Acc: 0.788 Test Loss: 0.411 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9771332740783691
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.429 Vali Acc: 0.819 Test Loss: 0.429 Test Acc: 0.819
Validation loss decreased (-0.791804 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.9484119415283203
Epoch: 4, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.436 Vali Acc: 0.795 Test Loss: 0.436 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.155179738998413
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.399 Vali Acc: 0.846 Test Loss: 0.399 Test Acc: 0.846
Validation loss decreased (-0.819108 --> -0.846412).  Saving model ...
Epoch: 6 cost time: 1.8260114192962646
Epoch: 6, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.439 Vali Acc: 0.836 Test Loss: 0.439 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.455929756164551
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.130359172821045
Epoch: 8, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8618788719177246
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.563 Vali Acc: 0.802 Test Loss: 0.563 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7833447456359863
Epoch: 10, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.605 Vali Acc: 0.792 Test Loss: 0.605 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9545097351074219
Epoch: 11, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.621 Vali Acc: 0.799 Test Loss: 0.621 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5009560585021973
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.669 Vali Acc: 0.802 Test Loss: 0.669 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.742767572402954
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.446286916732788
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.699 Vali Acc: 0.799 Test Loss: 0.699 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.362793207168579
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.702 Vali Acc: 0.819 Test Loss: 0.702 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 57922
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.535818099975586
Epoch: 1, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.490 Vali Acc: 0.802 Test Loss: 0.490 Test Acc: 0.802
Validation loss decreased (inf --> -0.802043).  Saving model ...
Epoch: 2 cost time: 2.153247594833374
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.470 Vali Acc: 0.802 Test Loss: 0.470 Test Acc: 0.802
Validation loss decreased (-0.802043 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 2.225386381149292
Epoch: 3, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.459 Vali Acc: 0.823 Test Loss: 0.459 Test Acc: 0.823
Validation loss decreased (-0.802043 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.3408968448638916
Epoch: 4, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.437 Vali Acc: 0.836 Test Loss: 0.437 Test Acc: 0.836
Validation loss decreased (-0.822521 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 2.422410726547241
Epoch: 5, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.479 Vali Acc: 0.809 Test Loss: 0.479 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3843040466308594
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.447 Vali Acc: 0.819 Test Loss: 0.447 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8335156440734863
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.519 Vali Acc: 0.805 Test Loss: 0.519 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8940892219543457
Epoch: 8, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.526 Vali Acc: 0.795 Test Loss: 0.526 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4433820247650146
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.543 Vali Acc: 0.802 Test Loss: 0.543 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2968530654907227
Epoch: 10, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.593 Vali Acc: 0.795 Test Loss: 0.593 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0209827423095703
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.618 Vali Acc: 0.788 Test Loss: 0.618 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9413301944732666
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4759137630462646
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.623 Vali Acc: 0.812 Test Loss: 0.623 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7589068412780762
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.799 Vali Acc: 0.782 Test Loss: 0.799 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 53954
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.4471352100372314
Epoch: 1, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.482 Vali Acc: 0.812 Test Loss: 0.482 Test Acc: 0.812
Validation loss decreased (inf --> -0.812282).  Saving model ...
Epoch: 2 cost time: 1.8548216819763184
Epoch: 2, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.439 Vali Acc: 0.785 Test Loss: 0.439 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9312596321105957
Epoch: 3, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.423 Vali Acc: 0.826 Test Loss: 0.423 Test Acc: 0.826
Validation loss decreased (-0.812282 --> -0.825934).  Saving model ...
Epoch: 4 cost time: 1.7460668087005615
Epoch: 4, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.465 Vali Acc: 0.802 Test Loss: 0.465 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6393311023712158
Epoch: 5, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.448 Vali Acc: 0.812 Test Loss: 0.448 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0081536769866943
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.412 Vali Acc: 0.826 Test Loss: 0.412 Test Acc: 0.826
Validation loss decreased (-0.825934 --> -0.825934).  Saving model ...
Epoch: 7 cost time: 1.9547638893127441
Epoch: 7, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
Validation loss decreased (-0.825934 --> -0.866890).  Saving model ...
Epoch: 8 cost time: 1.9264733791351318
Epoch: 8, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.451 Vali Acc: 0.829 Test Loss: 0.451 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.529672384262085
Epoch: 9, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.686509370803833
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.486 Vali Acc: 0.819 Test Loss: 0.486 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6915602684020996
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.557 Vali Acc: 0.802 Test Loss: 0.557 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.765348196029663
Epoch: 12, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8296380043029785
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.561 Vali Acc: 0.812 Test Loss: 0.561 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.025538682937622
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.509 Vali Acc: 0.836 Test Loss: 0.509 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7073323726654053
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.664 Vali Acc: 0.792 Test Loss: 0.664 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.852764368057251
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.567 Vali Acc: 0.819 Test Loss: 0.567 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.870096206665039
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.640 Vali Acc: 0.805 Test Loss: 0.640 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 52226
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.182428598403931
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.562 Vali Acc: 0.724 Test Loss: 0.562 Test Acc: 0.724
Validation loss decreased (inf --> -0.723544).  Saving model ...
Epoch: 2 cost time: 1.8611176013946533
Epoch: 2, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
Validation loss decreased (-0.723544 --> -0.815695).  Saving model ...
Epoch: 3 cost time: 2.2287745475769043
Epoch: 3, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.249798536300659
Epoch: 4, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.398 Vali Acc: 0.836 Test Loss: 0.398 Test Acc: 0.836
Validation loss decreased (-0.815695 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 1.7176342010498047
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.515 Vali Acc: 0.744 Test Loss: 0.515 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5120797157287598
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.425 Vali Acc: 0.799 Test Loss: 0.425 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8328113555908203
Epoch: 7, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.414 Vali Acc: 0.826 Test Loss: 0.414 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2802672386169434
Epoch: 8, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.423 Vali Acc: 0.816 Test Loss: 0.423 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8239548206329346
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.407 Vali Acc: 0.840 Test Loss: 0.407 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 10 cost time: 1.9648351669311523
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.477 Vali Acc: 0.799 Test Loss: 0.477 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1711623668670654
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.466 Vali Acc: 0.799 Test Loss: 0.466 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2045881748199463
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.552 Vali Acc: 0.788 Test Loss: 0.552 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.032331943511963
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.575 Vali Acc: 0.768 Test Loss: 0.575 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5008511543273926
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.526 Vali Acc: 0.812 Test Loss: 0.526 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8902621269226074
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.587 Vali Acc: 0.792 Test Loss: 0.587 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.150902271270752
Epoch: 16, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.630 Vali Acc: 0.785 Test Loss: 0.630 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8087823390960693
Epoch: 17, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.642 Vali Acc: 0.775 Test Loss: 0.642 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7776987552642822
Epoch: 18, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.739 Vali Acc: 0.754 Test Loss: 0.739 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.884634256362915
Epoch: 19, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.725 Vali Acc: 0.771 Test Loss: 0.725 Test Acc: 0.771
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 52034
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.859703540802002
Epoch: 1, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.472 Vali Acc: 0.805 Test Loss: 0.472 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 2.520199775695801
Epoch: 2, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.426 Vali Acc: 0.805 Test Loss: 0.426 Test Acc: 0.805
Validation loss decreased (-0.805456 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.0692174434661865
Epoch: 3, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.410 Vali Acc: 0.812 Test Loss: 0.410 Test Acc: 0.812
Validation loss decreased (-0.805456 --> -0.812283).  Saving model ...
Epoch: 4 cost time: 1.9070894718170166
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.429 Vali Acc: 0.799 Test Loss: 0.429 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9108357429504395
Epoch: 5, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.450 Vali Acc: 0.785 Test Loss: 0.450 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8762907981872559
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.378 Vali Acc: 0.836 Test Loss: 0.378 Test Acc: 0.836
Validation loss decreased (-0.812283 --> -0.836174).  Saving model ...
Epoch: 7 cost time: 1.5581097602844238
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.450 Vali Acc: 0.792 Test Loss: 0.450 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9492855072021484
Epoch: 8, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.394 Vali Acc: 0.836 Test Loss: 0.394 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8295879364013672
Epoch: 9, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.504 Vali Acc: 0.785 Test Loss: 0.504 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6877632141113281
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.406 Vali Acc: 0.853 Test Loss: 0.406 Test Acc: 0.853
Validation loss decreased (-0.836174 --> -0.853238).  Saving model ...
Epoch: 11 cost time: 1.8495373725891113
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.480 Vali Acc: 0.829 Test Loss: 0.480 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8879480361938477
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.429 Vali Acc: 0.850 Test Loss: 0.429 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7092602252960205
Epoch: 13, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.566 Vali Acc: 0.785 Test Loss: 0.566 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9395725727081299
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.812 Test Loss: 0.524 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5176751613616943
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.554 Vali Acc: 0.795 Test Loss: 0.554 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.617983102798462
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.579 Vali Acc: 0.802 Test Loss: 0.579 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.047823667526245
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.589 Vali Acc: 0.802 Test Loss: 0.589 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8708665370941162
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8935813903808594
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.688 Vali Acc: 0.799 Test Loss: 0.688 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0102882385253906
Epoch: 20, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.600 Vali Acc: 0.812 Test Loss: 0.600 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 54082
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.206481456756592
Epoch: 1, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.467 Vali Acc: 0.765 Test Loss: 0.467 Test Acc: 0.765
Validation loss decreased (inf --> -0.764500).  Saving model ...
Epoch: 2 cost time: 2.2475967407226562
Epoch: 2, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
Validation loss decreased (-0.764500 --> -0.812282).  Saving model ...
Epoch: 3 cost time: 1.6944544315338135
Epoch: 3, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.508 Vali Acc: 0.778 Test Loss: 0.508 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4637980461120605
Epoch: 4, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.469 Vali Acc: 0.840 Test Loss: 0.469 Test Acc: 0.840
Validation loss decreased (-0.812282 --> -0.839586).  Saving model ...
Epoch: 5 cost time: 2.6067886352539062
Epoch: 5, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.780702590942383
Epoch: 6, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.602 Vali Acc: 0.812 Test Loss: 0.602 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.854257106781006
Epoch: 7, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.752 Vali Acc: 0.785 Test Loss: 0.752 Test Acc: 0.785
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.574922561645508
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.725 Vali Acc: 0.802 Test Loss: 0.725 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.999431848526001
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.076 Vali Acc: 0.765 Test Loss: 1.076 Test Acc: 0.765
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.364739418029785
Epoch: 10, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.783 Vali Acc: 0.816 Test Loss: 0.783 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.506072759628296
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.202 Vali Acc: 0.727 Test Loss: 1.202 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4172863960266113
Epoch: 12, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.016 Vali Acc: 0.829 Test Loss: 1.016 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.005831480026245
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.424 Vali Acc: 0.761 Test Loss: 1.424 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2419040203094482
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.194 Vali Acc: 0.795 Test Loss: 1.194 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 83650
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.451414108276367
Epoch: 1, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.446 Vali Acc: 0.792 Test Loss: 0.446 Test Acc: 0.792
Validation loss decreased (inf --> -0.791804).  Saving model ...
Epoch: 2 cost time: 2.296599864959717
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.451 Vali Acc: 0.805 Test Loss: 0.451 Test Acc: 0.805
Validation loss decreased (-0.791804 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 2.277074098587036
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.452 Vali Acc: 0.802 Test Loss: 0.452 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1941239833831787
Epoch: 4, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.540 Vali Acc: 0.768 Test Loss: 0.540 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6652443408966064
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.795 Test Loss: 0.533 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6514241695404053
Epoch: 6, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.493 Vali Acc: 0.826 Test Loss: 0.493 Test Acc: 0.826
Validation loss decreased (-0.805456 --> -0.825934).  Saving model ...
Epoch: 7 cost time: 1.9058799743652344
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.622 Vali Acc: 0.782 Test Loss: 0.622 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.10406494140625
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0779526233673096
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.694 Vali Acc: 0.792 Test Loss: 0.694 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5596866607666016
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.705 Vali Acc: 0.802 Test Loss: 0.705 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.343153953552246
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.799 Vali Acc: 0.785 Test Loss: 0.799 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3221487998962402
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.882 Vali Acc: 0.785 Test Loss: 0.882 Test Acc: 0.785
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.994654893875122
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.794 Vali Acc: 0.802 Test Loss: 0.794 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8121538162231445
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.952 Vali Acc: 0.792 Test Loss: 0.952 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9769515991210938
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.965 Vali Acc: 0.788 Test Loss: 0.965 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7572908401489258
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.991 Vali Acc: 0.778 Test Loss: 0.991 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 58178
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0697126388549805
Epoch: 1, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.461 Vali Acc: 0.768 Test Loss: 0.461 Test Acc: 0.768
Validation loss decreased (inf --> -0.767913).  Saving model ...
Epoch: 2 cost time: 1.8443145751953125
Epoch: 2, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.439 Vali Acc: 0.802 Test Loss: 0.439 Test Acc: 0.802
Validation loss decreased (-0.767913 --> -0.802043).  Saving model ...
Epoch: 3 cost time: 2.132753610610962
Epoch: 3, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.467 Vali Acc: 0.768 Test Loss: 0.467 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6788406372070312
Epoch: 4, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.418 Vali Acc: 0.826 Test Loss: 0.418 Test Acc: 0.826
Validation loss decreased (-0.802043 --> -0.825934).  Saving model ...
Epoch: 5 cost time: 1.5768108367919922
Epoch: 5, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.459 Vali Acc: 0.795 Test Loss: 0.459 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0424137115478516
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0007266998291016
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.476 Vali Acc: 0.819 Test Loss: 0.476 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2168679237365723
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.708869218826294
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5762579441070557
Epoch: 10, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.685 Vali Acc: 0.775 Test Loss: 0.685 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2896571159362793
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.596 Vali Acc: 0.805 Test Loss: 0.596 Test Acc: 0.805
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2191708087921143
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4454619884490967
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.849 Vali Acc: 0.754 Test Loss: 0.849 Test Acc: 0.754
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9353711605072021
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.709 Vali Acc: 0.802 Test Loss: 0.709 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 49666
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.686382532119751
Epoch: 1, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
Validation loss decreased (inf --> -0.805456).  Saving model ...
Epoch: 2 cost time: 2.3264451026916504
Epoch: 2, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.394 Vali Acc: 0.826 Test Loss: 0.394 Test Acc: 0.826
Validation loss decreased (-0.805456 --> -0.825935).  Saving model ...
Epoch: 3 cost time: 2.152665615081787
Epoch: 3, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.437 Vali Acc: 0.812 Test Loss: 0.437 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.912156105041504
Epoch: 4, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.374 Vali Acc: 0.846 Test Loss: 0.374 Test Acc: 0.846
Validation loss decreased (-0.825935 --> -0.846413).  Saving model ...
Epoch: 5 cost time: 1.8704743385314941
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.451 Vali Acc: 0.805 Test Loss: 0.451 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4695773124694824
Epoch: 6, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.443 Vali Acc: 0.833 Test Loss: 0.443 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8319377899169922
Epoch: 7, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.497 Vali Acc: 0.805 Test Loss: 0.497 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1760284900665283
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.446 Vali Acc: 0.826 Test Loss: 0.446 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.72672700881958
Epoch: 9, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.532 Vali Acc: 0.792 Test Loss: 0.532 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9190633296966553
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.515 Vali Acc: 0.805 Test Loss: 0.515 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.348479747772217
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.559 Vali Acc: 0.823 Test Loss: 0.559 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5450284481048584
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.643 Vali Acc: 0.799 Test Loss: 0.643 Test Acc: 0.799
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1919898986816406
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.632 Vali Acc: 0.812 Test Loss: 0.632 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.089791774749756
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.740 Vali Acc: 0.782 Test Loss: 0.740 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 45698
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.5375893115997314
Epoch: 1, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.539 Vali Acc: 0.761 Test Loss: 0.539 Test Acc: 0.761
Validation loss decreased (inf --> -0.761087).  Saving model ...
Epoch: 2 cost time: 1.6292343139648438
Epoch: 2, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.440 Vali Acc: 0.799 Test Loss: 0.440 Test Acc: 0.799
Validation loss decreased (-0.761087 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 2.2120590209960938
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.430 Vali Acc: 0.805 Test Loss: 0.430 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.8209891319274902
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.412 Vali Acc: 0.809 Test Loss: 0.412 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808870).  Saving model ...
Epoch: 5 cost time: 1.9124236106872559
Epoch: 5, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.395 Vali Acc: 0.840 Test Loss: 0.395 Test Acc: 0.840
Validation loss decreased (-0.808870 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 2.1499998569488525
Epoch: 6, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.453 Vali Acc: 0.812 Test Loss: 0.453 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.711790084838867
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.415 Vali Acc: 0.836 Test Loss: 0.415 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5194334983825684
Epoch: 8, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8018040657043457
Epoch: 9, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.494 Vali Acc: 0.795 Test Loss: 0.494 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5187938213348389
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.479 Vali Acc: 0.816 Test Loss: 0.479 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.637021780014038
Epoch: 11, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.531 Vali Acc: 0.812 Test Loss: 0.531 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7649056911468506
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.563 Vali Acc: 0.799 Test Loss: 0.563 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9861798286437988
Epoch: 13, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.614 Vali Acc: 0.792 Test Loss: 0.614 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0428872108459473
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.556 Vali Acc: 0.795 Test Loss: 0.556 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9089560508728027
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.574 Vali Acc: 0.819 Test Loss: 0.574 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 43970
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.919255018234253
Epoch: 1, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.495 Vali Acc: 0.819 Test Loss: 0.495 Test Acc: 0.819
Validation loss decreased (inf --> -0.819108).  Saving model ...
Epoch: 2 cost time: 1.5869009494781494
Epoch: 2, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 3 cost time: 1.9833166599273682
Epoch: 3, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.480 Vali Acc: 0.778 Test Loss: 0.480 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9453253746032715
Epoch: 4, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.425 Vali Acc: 0.809 Test Loss: 0.425 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.055124282836914
Epoch: 5, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.386 Vali Acc: 0.843 Test Loss: 0.386 Test Acc: 0.843
Validation loss decreased (-0.829348 --> -0.843000).  Saving model ...
Epoch: 6 cost time: 2.211160182952881
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.435 Vali Acc: 0.816 Test Loss: 0.435 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.224947214126587
Epoch: 7, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9811804294586182
Epoch: 8, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.510 Vali Acc: 0.802 Test Loss: 0.510 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9548602104187012
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.387 Vali Acc: 0.857 Test Loss: 0.387 Test Acc: 0.857
Validation loss decreased (-0.843000 --> -0.856651).  Saving model ...
Epoch: 10 cost time: 1.9136967658996582
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.497 Vali Acc: 0.799 Test Loss: 0.497 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5040240287780762
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.432 Vali Acc: 0.840 Test Loss: 0.432 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7156846523284912
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.507 Vali Acc: 0.823 Test Loss: 0.507 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.065218925476074
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.474 Vali Acc: 0.826 Test Loss: 0.474 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1150050163269043
Epoch: 14, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.804218053817749
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.495 Vali Acc: 0.836 Test Loss: 0.495 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.469616651535034
Epoch: 16, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.566 Vali Acc: 0.829 Test Loss: 0.566 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9542083740234375
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.531 Vali Acc: 0.823 Test Loss: 0.531 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0077991485595703
Epoch: 18, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.506 Vali Acc: 0.853 Test Loss: 0.506 Test Acc: 0.853
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0119659900665283
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.571 Vali Acc: 0.812 Test Loss: 0.571 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 43778
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.465744495391846
Epoch: 1, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
Validation loss decreased (inf --> -0.730370).  Saving model ...
Epoch: 2 cost time: 2.025897264480591
Epoch: 2, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.375 Vali Acc: 0.826 Test Loss: 0.375 Test Acc: 0.826
Validation loss decreased (-0.730370 --> -0.825935).  Saving model ...
Epoch: 3 cost time: 2.0343692302703857
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.410 Vali Acc: 0.795 Test Loss: 0.410 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.201451539993286
Epoch: 4, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.387 Vali Acc: 0.816 Test Loss: 0.387 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8533134460449219
Epoch: 5, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.415 Vali Acc: 0.812 Test Loss: 0.415 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1502788066864014
Epoch: 6, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2271783351898193
Epoch: 7, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.379 Vali Acc: 0.833 Test Loss: 0.379 Test Acc: 0.833
Validation loss decreased (-0.825935 --> -0.832761).  Saving model ...
Epoch: 8 cost time: 1.826892614364624
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.430 Vali Acc: 0.805 Test Loss: 0.430 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6219496726989746
Epoch: 9, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.433 Vali Acc: 0.809 Test Loss: 0.433 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7115848064422607
Epoch: 10, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.474 Vali Acc: 0.805 Test Loss: 0.474 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4728460311889648
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.686622142791748
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7057900428771973
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1057732105255127
Epoch: 14, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.553 Vali Acc: 0.799 Test Loss: 0.553 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.786919355392456
Epoch: 15, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.500 Vali Acc: 0.816 Test Loss: 0.500 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2843821048736572
Epoch: 16, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.616 Vali Acc: 0.792 Test Loss: 0.616 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7701990604400635
Epoch: 17, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm64_nh16_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 45826
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.894060373306274
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.465 Vali Acc: 0.782 Test Loss: 0.465 Test Acc: 0.782
Validation loss decreased (inf --> -0.781565).  Saving model ...
Epoch: 2 cost time: 2.0087215900421143
Epoch: 2, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.386 Vali Acc: 0.836 Test Loss: 0.386 Test Acc: 0.836
Validation loss decreased (-0.781565 --> -0.836174).  Saving model ...
Epoch: 3 cost time: 1.6120610237121582
Epoch: 3, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.440 Vali Acc: 0.816 Test Loss: 0.440 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.784172534942627
Epoch: 4, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.465 Vali Acc: 0.795 Test Loss: 0.465 Test Acc: 0.795
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3922202587127686
Epoch: 5, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.458 Vali Acc: 0.819 Test Loss: 0.458 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.091383218765259
Epoch: 6, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.605 Vali Acc: 0.765 Test Loss: 0.605 Test Acc: 0.765
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.05249285697937
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.509 Vali Acc: 0.812 Test Loss: 0.509 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7127609252929688
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.665 Vali Acc: 0.802 Test Loss: 0.665 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2785158157348633
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.723 Vali Acc: 0.758 Test Loss: 0.723 Test Acc: 0.758
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.998948097229004
Epoch: 10, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.703 Vali Acc: 0.795 Test Loss: 0.703 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.940873384475708
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.652 Vali Acc: 0.812 Test Loss: 0.652 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.170915126800537
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.775 Vali Acc: 0.775 Test Loss: 0.775 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 50242
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.732293367385864
Epoch: 1, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.523 Vali Acc: 0.717 Test Loss: 0.523 Test Acc: 0.717
Validation loss decreased (inf --> -0.716718).  Saving model ...
Epoch: 2 cost time: 1.3339183330535889
Epoch: 2, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.398 Vali Acc: 0.816 Test Loss: 0.398 Test Acc: 0.816
Validation loss decreased (-0.716718 --> -0.815696).  Saving model ...
Epoch: 3 cost time: 1.7135601043701172
Epoch: 3, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.440 Vali Acc: 0.805 Test Loss: 0.440 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.374706745147705
Epoch: 4, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.415 Vali Acc: 0.816 Test Loss: 0.415 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.730576753616333
Epoch: 5, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.400 Vali Acc: 0.816 Test Loss: 0.400 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6666123867034912
Epoch: 6, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.417 Vali Acc: 0.819 Test Loss: 0.417 Test Acc: 0.819
Validation loss decreased (-0.815696 --> -0.819108).  Saving model ...
Epoch: 7 cost time: 1.8580126762390137
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.425584077835083
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.454 Vali Acc: 0.819 Test Loss: 0.454 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9259724617004395
Epoch: 9, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.547 Vali Acc: 0.788 Test Loss: 0.547 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0592761039733887
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.979341745376587
Epoch: 11, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.585 Vali Acc: 0.785 Test Loss: 0.585 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.429100751876831
Epoch: 12, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.561 Vali Acc: 0.805 Test Loss: 0.561 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7023015022277832
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.587 Vali Acc: 0.799 Test Loss: 0.587 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6395938396453857
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.604 Vali Acc: 0.788 Test Loss: 0.604 Test Acc: 0.788
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7967960834503174
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.653 Vali Acc: 0.792 Test Loss: 0.653 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7132596969604492
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.713 Vali Acc: 0.792 Test Loss: 0.713 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8191126279863481
model parameter : 37506
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.585536479949951
Epoch: 1, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.616 Vali Acc: 0.700 Test Loss: 0.616 Test Acc: 0.700
Validation loss decreased (inf --> -0.699653).  Saving model ...
Epoch: 2 cost time: 2.3184900283813477
Epoch: 2, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.479 Vali Acc: 0.782 Test Loss: 0.479 Test Acc: 0.782
Validation loss decreased (-0.699653 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 2.204082727432251
Epoch: 3, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.451 Vali Acc: 0.788 Test Loss: 0.451 Test Acc: 0.788
Validation loss decreased (-0.781565 --> -0.788391).  Saving model ...
Epoch: 4 cost time: 2.0770297050476074
Epoch: 4, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.458 Vali Acc: 0.771 Test Loss: 0.458 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0222227573394775
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.413 Vali Acc: 0.802 Test Loss: 0.413 Test Acc: 0.802
Validation loss decreased (-0.788391 --> -0.802044).  Saving model ...
Epoch: 6 cost time: 1.5534324645996094
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.443 Vali Acc: 0.785 Test Loss: 0.443 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.888319969177246
Epoch: 7, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.390 Vali Acc: 0.836 Test Loss: 0.390 Test Acc: 0.836
Validation loss decreased (-0.802044 --> -0.836174).  Saving model ...
Epoch: 8 cost time: 1.936976432800293
Epoch: 8, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.484 Vali Acc: 0.823 Test Loss: 0.484 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3259501457214355
Epoch: 9, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.469 Vali Acc: 0.805 Test Loss: 0.469 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3808913230895996
Epoch: 10, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.497 Vali Acc: 0.802 Test Loss: 0.497 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9210288524627686
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.466 Vali Acc: 0.805 Test Loss: 0.466 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5117554664611816
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.543 Vali Acc: 0.805 Test Loss: 0.543 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9717624187469482
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.522 Vali Acc: 0.792 Test Loss: 0.522 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8411269187927246
Epoch: 14, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6964221000671387
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.561 Vali Acc: 0.805 Test Loss: 0.561 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.956516981124878
Epoch: 16, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.805 Test Loss: 0.548 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3211729526519775
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 33250
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.230598449707031
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.543 Vali Acc: 0.730 Test Loss: 0.543 Test Acc: 0.730
Validation loss decreased (inf --> -0.730370).  Saving model ...
Epoch: 2 cost time: 1.9256081581115723
Epoch: 2, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.420 Vali Acc: 0.802 Test Loss: 0.420 Test Acc: 0.802
Validation loss decreased (-0.730370 --> -0.802044).  Saving model ...
Epoch: 3 cost time: 2.330258846282959
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.453 Vali Acc: 0.782 Test Loss: 0.453 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3563733100891113
Epoch: 4, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.433 Vali Acc: 0.788 Test Loss: 0.433 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.991791009902954
Epoch: 5, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.395 Vali Acc: 0.826 Test Loss: 0.395 Test Acc: 0.826
Validation loss decreased (-0.802044 --> -0.825935).  Saving model ...
Epoch: 6 cost time: 2.659409284591675
Epoch: 6, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.410 Vali Acc: 0.802 Test Loss: 0.410 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4622061252593994
Epoch: 7, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.439 Vali Acc: 0.812 Test Loss: 0.439 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8545138835906982
Epoch: 8, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.467 Vali Acc: 0.788 Test Loss: 0.467 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.098449468612671
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.442 Vali Acc: 0.809 Test Loss: 0.442 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.915471076965332
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.463 Vali Acc: 0.812 Test Loss: 0.463 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0997321605682373
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.482 Vali Acc: 0.802 Test Loss: 0.482 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9175620079040527
Epoch: 12, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.526 Vali Acc: 0.785 Test Loss: 0.526 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.298447608947754
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.709803819656372
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.568 Vali Acc: 0.795 Test Loss: 0.568 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8287742137908936
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.580 Vali Acc: 0.799 Test Loss: 0.580 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 31266
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.561577558517456
Epoch: 1, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.498 Vali Acc: 0.795 Test Loss: 0.498 Test Acc: 0.795
Validation loss decreased (inf --> -0.795217).  Saving model ...
Epoch: 2 cost time: 1.5878186225891113
Epoch: 2, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
Validation loss decreased (-0.795217 --> -0.812283).  Saving model ...
Epoch: 3 cost time: 1.8302562236785889
Epoch: 3, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.398 Vali Acc: 0.819 Test Loss: 0.398 Test Acc: 0.819
Validation loss decreased (-0.812283 --> -0.819109).  Saving model ...
Epoch: 4 cost time: 1.4552638530731201
Epoch: 4, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.404 Vali Acc: 0.812 Test Loss: 0.404 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0957388877868652
Epoch: 5, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.371 Vali Acc: 0.857 Test Loss: 0.371 Test Acc: 0.857
Validation loss decreased (-0.819109 --> -0.856652).  Saving model ...
Epoch: 6 cost time: 1.8376197814941406
Epoch: 6, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.386 Vali Acc: 0.853 Test Loss: 0.386 Test Acc: 0.853
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7153446674346924
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3903932571411133
Epoch: 8, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8132307529449463
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5365321636199951
Epoch: 10, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.386 Vali Acc: 0.850 Test Loss: 0.386 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0764098167419434
Epoch: 11, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7337312698364258
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.412 Vali Acc: 0.853 Test Loss: 0.412 Test Acc: 0.853
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8059532642364502
Epoch: 13, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.484 Vali Acc: 0.819 Test Loss: 0.484 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4701721668243408
Epoch: 14, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.472 Vali Acc: 0.840 Test Loss: 0.472 Test Acc: 0.840
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5602242946624756
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.492 Vali Acc: 0.823 Test Loss: 0.492 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 30402
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.690263032913208
Epoch: 1, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.552 Vali Acc: 0.730 Test Loss: 0.552 Test Acc: 0.730
Validation loss decreased (inf --> -0.730370).  Saving model ...
Epoch: 2 cost time: 2.101565361022949
Epoch: 2, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.453 Vali Acc: 0.785 Test Loss: 0.453 Test Acc: 0.785
Validation loss decreased (-0.730370 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 1.9066927433013916
Epoch: 3, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.391 Vali Acc: 0.819 Test Loss: 0.391 Test Acc: 0.819
Validation loss decreased (-0.784978 --> -0.819109).  Saving model ...
Epoch: 4 cost time: 1.5584743022918701
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.413 Vali Acc: 0.816 Test Loss: 0.413 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8926341533660889
Epoch: 5, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.389 Vali Acc: 0.816 Test Loss: 0.389 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7729740142822266
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.390 Vali Acc: 0.823 Test Loss: 0.390 Test Acc: 0.823
Validation loss decreased (-0.819109 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 1.9040334224700928
Epoch: 7, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.385 Vali Acc: 0.826 Test Loss: 0.385 Test Acc: 0.826
Validation loss decreased (-0.822522 --> -0.825935).  Saving model ...
Epoch: 8 cost time: 1.5663549900054932
Epoch: 8, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.388 Vali Acc: 0.819 Test Loss: 0.388 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.929746389389038
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.378 Vali Acc: 0.846 Test Loss: 0.378 Test Acc: 0.846
Validation loss decreased (-0.825935 --> -0.846413).  Saving model ...
Epoch: 10 cost time: 1.992222785949707
Epoch: 10, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.459 Vali Acc: 0.785 Test Loss: 0.459 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.933546543121338
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.381 Vali Acc: 0.863 Test Loss: 0.381 Test Acc: 0.863
Validation loss decreased (-0.846413 --> -0.863477).  Saving model ...
Epoch: 12 cost time: 1.662062168121338
Epoch: 12, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.432 Vali Acc: 0.819 Test Loss: 0.432 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9005393981933594
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1130285263061523
Epoch: 14, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.398 Vali Acc: 0.850 Test Loss: 0.398 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9167733192443848
Epoch: 15, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.471 Vali Acc: 0.805 Test Loss: 0.471 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9958462715148926
Epoch: 16, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.399 Vali Acc: 0.843 Test Loss: 0.399 Test Acc: 0.843
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8099784851074219
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.443 Vali Acc: 0.826 Test Loss: 0.443 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9505105018615723
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.410 Vali Acc: 0.843 Test Loss: 0.410 Test Acc: 0.843
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7554633617401123
Epoch: 19, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.441 Vali Acc: 0.836 Test Loss: 0.441 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0039660930633545
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.563 Vali Acc: 0.788 Test Loss: 0.563 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6465251445770264
Epoch: 21, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.451 Vali Acc: 0.850 Test Loss: 0.451 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 30306
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.824426651000977
Epoch: 1, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.452 Vali Acc: 0.840 Test Loss: 0.452 Test Acc: 0.840
Validation loss decreased (inf --> -0.839586).  Saving model ...
Epoch: 2 cost time: 1.7493550777435303
Epoch: 2, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.410 Vali Acc: 0.829 Test Loss: 0.410 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5682077407836914
Epoch: 3, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.410 Vali Acc: 0.816 Test Loss: 0.410 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1801633834838867
Epoch: 4, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.409 Vali Acc: 0.809 Test Loss: 0.409 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3631312847137451
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.395 Vali Acc: 0.826 Test Loss: 0.395 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1055948734283447
Epoch: 6, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.362 Vali Acc: 0.836 Test Loss: 0.362 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9510693550109863
Epoch: 7, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.381 Vali Acc: 0.826 Test Loss: 0.381 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0382401943206787
Epoch: 8, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.378 Vali Acc: 0.833 Test Loss: 0.378 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8299000263214111
Epoch: 9, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.365 Vali Acc: 0.846 Test Loss: 0.365 Test Acc: 0.846
Validation loss decreased (-0.839586 --> -0.846413).  Saving model ...
Epoch: 10 cost time: 1.6321799755096436
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.366 Vali Acc: 0.843 Test Loss: 0.366 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.893341064453125
Epoch: 11, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.397 Vali Acc: 0.833 Test Loss: 0.397 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7981011867523193
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.395 Vali Acc: 0.850 Test Loss: 0.395 Test Acc: 0.850
Validation loss decreased (-0.846413 --> -0.849825).  Saving model ...
Epoch: 13 cost time: 1.7249352931976318
Epoch: 13, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.367 Vali Acc: 0.857 Test Loss: 0.367 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856652).  Saving model ...
Epoch: 14 cost time: 1.48799729347229
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.416 Vali Acc: 0.836 Test Loss: 0.416 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.01550030708313
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.420 Vali Acc: 0.840 Test Loss: 0.420 Test Acc: 0.840
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6592886447906494
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.375 Vali Acc: 0.870 Test Loss: 0.375 Test Acc: 0.870
Validation loss decreased (-0.856652 --> -0.870303).  Saving model ...
Epoch: 17 cost time: 2.0846920013427734
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.501 Vali Acc: 0.802 Test Loss: 0.501 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5770812034606934
Epoch: 18, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.441 Vali Acc: 0.843 Test Loss: 0.441 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.240241050720215
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.414 Vali Acc: 0.860 Test Loss: 0.414 Test Acc: 0.860
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7610716819763184
Epoch: 20, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.481 Vali Acc: 0.823 Test Loss: 0.481 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3476850986480713
Epoch: 21, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.473 Vali Acc: 0.833 Test Loss: 0.473 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.738114595413208
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.453 Vali Acc: 0.843 Test Loss: 0.453 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.020968198776245
Epoch: 23, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1634364128112793
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7887427806854248
Epoch: 25, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.517 Vali Acc: 0.829 Test Loss: 0.517 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.2736546993255615
Epoch: 26, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.498 Vali Acc: 0.843 Test Loss: 0.498 Test Acc: 0.843
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 31330
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 7.101046323776245
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.530 Vali Acc: 0.700 Test Loss: 0.530 Test Acc: 0.700
Validation loss decreased (inf --> -0.699653).  Saving model ...
Epoch: 2 cost time: 2.333594560623169
Epoch: 2, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.411 Vali Acc: 0.829 Test Loss: 0.411 Test Acc: 0.829
Validation loss decreased (-0.699653 --> -0.829347).  Saving model ...
Epoch: 3 cost time: 1.940019130706787
Epoch: 3, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.405 Vali Acc: 0.823 Test Loss: 0.405 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.688082218170166
Epoch: 4, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.430 Vali Acc: 0.816 Test Loss: 0.430 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.850281000137329
Epoch: 5, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.392 Vali Acc: 0.836 Test Loss: 0.392 Test Acc: 0.836
Validation loss decreased (-0.829347 --> -0.836174).  Saving model ...
Epoch: 6 cost time: 1.9965274333953857
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.627 Vali Acc: 0.771 Test Loss: 0.627 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.931335687637329
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.651 Vali Acc: 0.788 Test Loss: 0.651 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4533259868621826
Epoch: 8, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.554 Vali Acc: 0.805 Test Loss: 0.554 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.842646837234497
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.501 Vali Acc: 0.840 Test Loss: 0.501 Test Acc: 0.840
Validation loss decreased (-0.836174 --> -0.839585).  Saving model ...
Epoch: 10 cost time: 2.713909864425659
Epoch: 10, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.554 Vali Acc: 0.826 Test Loss: 0.554 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0365984439849854
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.666 Vali Acc: 0.799 Test Loss: 0.666 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9658660888671875
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.857 Vali Acc: 0.761 Test Loss: 0.857 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.457914113998413
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9053747653961182
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.807 Vali Acc: 0.795 Test Loss: 0.807 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5455751419067383
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.855 Vali Acc: 0.788 Test Loss: 0.855 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.356619358062744
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.826 Vali Acc: 0.802 Test Loss: 0.826 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5303268432617188
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.812 Vali Acc: 0.823 Test Loss: 0.812 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.331655502319336
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.964 Vali Acc: 0.799 Test Loss: 0.964 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.675201177597046
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.867 Vali Acc: 0.819 Test Loss: 0.867 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 41922
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.184694528579712
Epoch: 1, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.519 Vali Acc: 0.747 Test Loss: 0.519 Test Acc: 0.747
Validation loss decreased (inf --> -0.747435).  Saving model ...
Epoch: 2 cost time: 1.8512945175170898
Epoch: 2, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.417 Vali Acc: 0.819 Test Loss: 0.417 Test Acc: 0.819
Validation loss decreased (-0.747435 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.5988857746124268
Epoch: 3, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.381 Vali Acc: 0.829 Test Loss: 0.381 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 4 cost time: 1.4303128719329834
Epoch: 4, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.432 Vali Acc: 0.802 Test Loss: 0.432 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3331668376922607
Epoch: 5, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.407 Vali Acc: 0.816 Test Loss: 0.407 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4312760829925537
Epoch: 6, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.425 Vali Acc: 0.823 Test Loss: 0.425 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.420497179031372
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.474 Vali Acc: 0.812 Test Loss: 0.474 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6315691471099854
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.440 Vali Acc: 0.826 Test Loss: 0.440 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4710180759429932
Epoch: 9, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.515 Vali Acc: 0.805 Test Loss: 0.515 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.581726312637329
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.496 Vali Acc: 0.826 Test Loss: 0.496 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2707796096801758
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.554 Vali Acc: 0.805 Test Loss: 0.554 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.406104564666748
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.645 Vali Acc: 0.778 Test Loss: 0.645 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6331734657287598
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.611 Vali Acc: 0.795 Test Loss: 0.611 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 29186
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.056941986083984
Epoch: 1, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
Validation loss decreased (inf --> -0.726957).  Saving model ...
Epoch: 2 cost time: 1.6534316539764404
Epoch: 2, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.405 Vali Acc: 0.836 Test Loss: 0.405 Test Acc: 0.836
Validation loss decreased (-0.726957 --> -0.836173).  Saving model ...
Epoch: 3 cost time: 1.9086558818817139
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.450 Vali Acc: 0.799 Test Loss: 0.450 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.018939733505249
Epoch: 4, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.746539831161499
Epoch: 5, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.404 Vali Acc: 0.840 Test Loss: 0.404 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 1.6684672832489014
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4842379093170166
Epoch: 7, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.423 Vali Acc: 0.823 Test Loss: 0.423 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8389110565185547
Epoch: 8, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.455 Vali Acc: 0.823 Test Loss: 0.455 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.254507064819336
Epoch: 9, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.467 Vali Acc: 0.805 Test Loss: 0.467 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.205383777618408
Epoch: 10, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5621068477630615
Epoch: 11, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.458 Vali Acc: 0.833 Test Loss: 0.458 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.902557611465454
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.517 Vali Acc: 0.809 Test Loss: 0.517 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3847224712371826
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.554 Vali Acc: 0.792 Test Loss: 0.554 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1700031757354736
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.550 Vali Acc: 0.792 Test Loss: 0.550 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6712934970855713
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.636 Vali Acc: 0.785 Test Loss: 0.636 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 24930
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.721892833709717
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.516 Vali Acc: 0.799 Test Loss: 0.516 Test Acc: 0.799
Validation loss decreased (inf --> -0.798630).  Saving model ...
Epoch: 2 cost time: 1.7503459453582764
Epoch: 2, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.440 Vali Acc: 0.819 Test Loss: 0.440 Test Acc: 0.819
Validation loss decreased (-0.798630 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.7731006145477295
Epoch: 3, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.426 Vali Acc: 0.812 Test Loss: 0.426 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8466756343841553
Epoch: 4, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9961752891540527
Epoch: 5, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.466 Vali Acc: 0.788 Test Loss: 0.466 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.833658218383789
Epoch: 6, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.427 Vali Acc: 0.812 Test Loss: 0.427 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7872350215911865
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.471 Vali Acc: 0.788 Test Loss: 0.471 Test Acc: 0.788
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.946485996246338
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.445 Vali Acc: 0.829 Test Loss: 0.445 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829347).  Saving model ...
Epoch: 9 cost time: 2.0603885650634766
Epoch: 9, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.523 Vali Acc: 0.778 Test Loss: 0.523 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.288254737854004
Epoch: 10, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.469 Vali Acc: 0.805 Test Loss: 0.469 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.441964864730835
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.487 Vali Acc: 0.812 Test Loss: 0.487 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.799813985824585
Epoch: 12, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.481 Vali Acc: 0.816 Test Loss: 0.481 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8397598266601562
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.531 Vali Acc: 0.799 Test Loss: 0.531 Test Acc: 0.799
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.995084524154663
Epoch: 14, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.533 Vali Acc: 0.805 Test Loss: 0.533 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9723381996154785
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.520 Vali Acc: 0.829 Test Loss: 0.520 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9473192691802979
Epoch: 16, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.577 Vali Acc: 0.812 Test Loss: 0.577 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.274672508239746
Epoch: 17, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.577 Vali Acc: 0.805 Test Loss: 0.577 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7073769569396973
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.554 Vali Acc: 0.833 Test Loss: 0.554 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832759).  Saving model ...
Epoch: 19 cost time: 2.104559898376465
Epoch: 19, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.184182643890381
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.703 Vali Acc: 0.778 Test Loss: 0.703 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8955583572387695
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.691 Vali Acc: 0.799 Test Loss: 0.691 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6829595565795898
Epoch: 22, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1019914150238037
Epoch: 23, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.677 Vali Acc: 0.802 Test Loss: 0.677 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9247825145721436
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.316192150115967
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.747 Vali Acc: 0.782 Test Loss: 0.747 Test Acc: 0.782
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9034504890441895
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.706 Vali Acc: 0.805 Test Loss: 0.706 Test Acc: 0.805
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0575032234191895
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.757 Vali Acc: 0.788 Test Loss: 0.757 Test Acc: 0.788
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8388328552246094
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.742 Vali Acc: 0.799 Test Loss: 0.742 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 22946
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.073498725891113
Epoch: 1, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.618 Vali Acc: 0.659 Test Loss: 0.618 Test Acc: 0.659
Validation loss decreased (inf --> -0.658697).  Saving model ...
Epoch: 2 cost time: 1.8217487335205078
Epoch: 2, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.463 Vali Acc: 0.792 Test Loss: 0.463 Test Acc: 0.792
Validation loss decreased (-0.658697 --> -0.791804).  Saving model ...
Epoch: 3 cost time: 1.6461544036865234
Epoch: 3, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.406 Vali Acc: 0.809 Test Loss: 0.406 Test Acc: 0.809
Validation loss decreased (-0.791804 --> -0.808870).  Saving model ...
Epoch: 4 cost time: 1.7655529975891113
Epoch: 4, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.432 Vali Acc: 0.795 Test Loss: 0.432 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.253007411956787
Epoch: 5, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.416 Vali Acc: 0.812 Test Loss: 0.416 Test Acc: 0.812
Validation loss decreased (-0.808870 --> -0.812283).  Saving model ...
Epoch: 6 cost time: 1.7312302589416504
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.384 Vali Acc: 0.836 Test Loss: 0.384 Test Acc: 0.836
Validation loss decreased (-0.812283 --> -0.836174).  Saving model ...
Epoch: 7 cost time: 2.0492849349975586
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.402 Vali Acc: 0.812 Test Loss: 0.402 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.588773250579834
Epoch: 8, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.419 Vali Acc: 0.802 Test Loss: 0.419 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.468156099319458
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.378 Vali Acc: 0.836 Test Loss: 0.378 Test Acc: 0.836
Validation loss decreased (-0.836174 --> -0.836174).  Saving model ...
Epoch: 10 cost time: 2.339481830596924
Epoch: 10, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.405 Vali Acc: 0.829 Test Loss: 0.405 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.041691780090332
Epoch: 11, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8751444816589355
Epoch: 12, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.416 Vali Acc: 0.826 Test Loss: 0.416 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9221127033233643
Epoch: 13, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7902781963348389
Epoch: 14, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.503 Vali Acc: 0.792 Test Loss: 0.503 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7375452518463135
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.460 Vali Acc: 0.819 Test Loss: 0.460 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9733233451843262
Epoch: 16, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9907948970794678
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.522 Vali Acc: 0.795 Test Loss: 0.522 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.067051410675049
Epoch: 18, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0430209636688232
Epoch: 19, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.519 Vali Acc: 0.812 Test Loss: 0.519 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 22082
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.201892614364624
Epoch: 1, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.680 Vali Acc: 0.594 Test Loss: 0.680 Test Acc: 0.594
Validation loss decreased (inf --> -0.593850).  Saving model ...
Epoch: 2 cost time: 1.3294334411621094
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.490 Vali Acc: 0.782 Test Loss: 0.490 Test Acc: 0.782
Validation loss decreased (-0.593850 --> -0.781565).  Saving model ...
Epoch: 3 cost time: 1.724745512008667
Epoch: 3, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.432 Vali Acc: 0.802 Test Loss: 0.432 Test Acc: 0.802
Validation loss decreased (-0.781565 --> -0.802043).  Saving model ...
Epoch: 4 cost time: 1.430851936340332
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.403 Vali Acc: 0.823 Test Loss: 0.403 Test Acc: 0.823
Validation loss decreased (-0.802043 --> -0.822522).  Saving model ...
Epoch: 5 cost time: 1.8722577095031738
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.427 Vali Acc: 0.805 Test Loss: 0.427 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6836028099060059
Epoch: 6, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.394 Vali Acc: 0.826 Test Loss: 0.394 Test Acc: 0.826
Validation loss decreased (-0.822522 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 1.4407339096069336
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.385 Vali Acc: 0.829 Test Loss: 0.385 Test Acc: 0.829
Validation loss decreased (-0.825935 --> -0.829348).  Saving model ...
Epoch: 8 cost time: 1.4157023429870605
Epoch: 8, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.374 Vali Acc: 0.840 Test Loss: 0.374 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.344956874847412
Epoch: 9, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.369 Vali Acc: 0.857 Test Loss: 0.369 Test Acc: 0.857
Validation loss decreased (-0.839587 --> -0.856652).  Saving model ...
Epoch: 10 cost time: 1.6602885723114014
Epoch: 10, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.389 Vali Acc: 0.840 Test Loss: 0.389 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1719157695770264
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.365 Vali Acc: 0.863 Test Loss: 0.365 Test Acc: 0.863
Validation loss decreased (-0.856652 --> -0.863478).  Saving model ...
Epoch: 12 cost time: 1.5160105228424072
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.404 Vali Acc: 0.843 Test Loss: 0.404 Test Acc: 0.843
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.610590934753418
Epoch: 13, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.367 Vali Acc: 0.863 Test Loss: 0.367 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7558019161224365
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.407 Vali Acc: 0.843 Test Loss: 0.407 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5689878463745117
Epoch: 15, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.380 Vali Acc: 0.857 Test Loss: 0.380 Test Acc: 0.857
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7403466701507568
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.431 Vali Acc: 0.836 Test Loss: 0.431 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.586245059967041
Epoch: 17, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.418 Vali Acc: 0.836 Test Loss: 0.418 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0979762077331543
Epoch: 18, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.390 Vali Acc: 0.863 Test Loss: 0.390 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.597952127456665
Epoch: 19, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.394 Vali Acc: 0.860 Test Loss: 0.394 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8043107986450195
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.431 Vali Acc: 0.846 Test Loss: 0.431 Test Acc: 0.846
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6185057163238525
Epoch: 21, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.427 Vali Acc: 0.857 Test Loss: 0.427 Test Acc: 0.857
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 21986
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.960393667221069
Epoch: 1, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.610 Vali Acc: 0.662 Test Loss: 0.610 Test Acc: 0.662
Validation loss decreased (inf --> -0.662110).  Saving model ...
Epoch: 2 cost time: 1.7103557586669922
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.461 Vali Acc: 0.805 Test Loss: 0.461 Test Acc: 0.805
Validation loss decreased (-0.662110 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 1.4812190532684326
Epoch: 3, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.426 Vali Acc: 0.809 Test Loss: 0.426 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 2.454000473022461
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.382 Vali Acc: 0.836 Test Loss: 0.382 Test Acc: 0.836
Validation loss decreased (-0.808869 --> -0.836174).  Saving model ...
Epoch: 5 cost time: 1.7447094917297363
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.434 Vali Acc: 0.792 Test Loss: 0.434 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9616506099700928
Epoch: 6, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.405 Vali Acc: 0.819 Test Loss: 0.405 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.553985595703125
Epoch: 7, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.392 Vali Acc: 0.829 Test Loss: 0.392 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.923191785812378
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.410 Vali Acc: 0.819 Test Loss: 0.410 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.524610996246338
Epoch: 9, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.447 Vali Acc: 0.802 Test Loss: 0.447 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7229840755462646
Epoch: 10, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.349 Vali Acc: 0.860 Test Loss: 0.349 Test Acc: 0.860
Validation loss decreased (-0.836174 --> -0.860065).  Saving model ...
Epoch: 11 cost time: 1.990083932876587
Epoch: 11, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.444 Vali Acc: 0.809 Test Loss: 0.444 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8398561477661133
Epoch: 12, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.455 Vali Acc: 0.805 Test Loss: 0.455 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.100555419921875
Epoch: 13, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.439 Vali Acc: 0.809 Test Loss: 0.439 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7239222526550293
Epoch: 14, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6720550060272217
Epoch: 15, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.408 Vali Acc: 0.840 Test Loss: 0.408 Test Acc: 0.840
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9651799201965332
Epoch: 16, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.415 Vali Acc: 0.833 Test Loss: 0.415 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0244925022125244
Epoch: 17, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.442 Vali Acc: 0.829 Test Loss: 0.442 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8147952556610107
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.448 Vali Acc: 0.826 Test Loss: 0.448 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8582046031951904
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.472 Vali Acc: 0.826 Test Loss: 0.472 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.086047410964966
Epoch: 20, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.547 Vali Acc: 0.795 Test Loss: 0.547 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8600682593856656
model parameter : 23010
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.112739324569702
Epoch: 1, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.447 Vali Acc: 0.833 Test Loss: 0.447 Test Acc: 0.833
Validation loss decreased (inf --> -0.832760).  Saving model ...
Epoch: 2 cost time: 1.991380214691162
Epoch: 2, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.449 Vali Acc: 0.826 Test Loss: 0.449 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0395748615264893
Epoch: 3, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.433 Vali Acc: 0.826 Test Loss: 0.433 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.259159564971924
Epoch: 4, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.381 Vali Acc: 0.863 Test Loss: 0.381 Test Acc: 0.863
Validation loss decreased (-0.832760 --> -0.863477).  Saving model ...
Epoch: 5 cost time: 2.0040700435638428
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.458 Vali Acc: 0.805 Test Loss: 0.458 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.21685528755188
Epoch: 6, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.476 Vali Acc: 0.816 Test Loss: 0.476 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7898106575012207
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6927967071533203
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6582658290863037
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.518 Vali Acc: 0.826 Test Loss: 0.518 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.694443941116333
Epoch: 10, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.672 Vali Acc: 0.795 Test Loss: 0.672 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.350278615951538
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.761 Vali Acc: 0.788 Test Loss: 0.761 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6661231517791748
Epoch: 12, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.921 Vali Acc: 0.747 Test Loss: 0.921 Test Acc: 0.747
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6717019081115723
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.600 Vali Acc: 0.836 Test Loss: 0.600 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.216543436050415
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.844 Vali Acc: 0.775 Test Loss: 0.844 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.863481228668942
model parameter : 37762
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.162111759185791
Epoch: 1, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.541 Vali Acc: 0.686 Test Loss: 0.541 Test Acc: 0.686
Validation loss decreased (inf --> -0.686001).  Saving model ...
Epoch: 2 cost time: 1.417750358581543
Epoch: 2, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.395 Vali Acc: 0.809 Test Loss: 0.395 Test Acc: 0.809
Validation loss decreased (-0.686001 --> -0.808870).  Saving model ...
Epoch: 3 cost time: 1.8427560329437256
Epoch: 3, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.395 Vali Acc: 0.819 Test Loss: 0.395 Test Acc: 0.819
Validation loss decreased (-0.808870 --> -0.819109).  Saving model ...
Epoch: 4 cost time: 1.4819340705871582
Epoch: 4, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.394 Vali Acc: 0.840 Test Loss: 0.394 Test Acc: 0.840
Validation loss decreased (-0.819109 --> -0.839587).  Saving model ...
Epoch: 5 cost time: 1.4849884510040283
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.402 Vali Acc: 0.823 Test Loss: 0.402 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7690742015838623
Epoch: 6, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.424 Vali Acc: 0.819 Test Loss: 0.424 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7294700145721436
Epoch: 7, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.428 Vali Acc: 0.819 Test Loss: 0.428 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8838720321655273
Epoch: 8, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.491 Vali Acc: 0.795 Test Loss: 0.491 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9085040092468262
Epoch: 9, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.444 Vali Acc: 0.826 Test Loss: 0.444 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.992654800415039
Epoch: 10, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.513 Vali Acc: 0.799 Test Loss: 0.513 Test Acc: 0.799
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7945854663848877
Epoch: 11, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.627 Vali Acc: 0.778 Test Loss: 0.627 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0447185039520264
Epoch: 12, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.732 Vali Acc: 0.741 Test Loss: 0.732 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3415374755859375
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.534 Vali Acc: 0.812 Test Loss: 0.534 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7978482246398926
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.725 Vali Acc: 0.782 Test Loss: 0.725 Test Acc: 0.782
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 25026
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.332903861999512
Epoch: 1, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.501 Vali Acc: 0.785 Test Loss: 0.501 Test Acc: 0.785
Validation loss decreased (inf --> -0.784978).  Saving model ...
Epoch: 2 cost time: 1.7988226413726807
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.436 Vali Acc: 0.805 Test Loss: 0.436 Test Acc: 0.805
Validation loss decreased (-0.784978 --> -0.805456).  Saving model ...
Epoch: 3 cost time: 1.5272362232208252
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.443 Vali Acc: 0.809 Test Loss: 0.443 Test Acc: 0.809
Validation loss decreased (-0.805456 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 1.7637593746185303
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.476 Vali Acc: 0.785 Test Loss: 0.476 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4417228698730469
Epoch: 5, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.415 Vali Acc: 0.826 Test Loss: 0.415 Test Acc: 0.826
Validation loss decreased (-0.808869 --> -0.825934).  Saving model ...
Epoch: 6 cost time: 1.3889386653900146
Epoch: 6, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.122145652770996
Epoch: 7, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.405 Vali Acc: 0.833 Test Loss: 0.405 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 8 cost time: 1.2659258842468262
Epoch: 8, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.598 Vali Acc: 0.744 Test Loss: 0.598 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6318535804748535
Epoch: 9, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.456 Vali Acc: 0.819 Test Loss: 0.456 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4222617149353027
Epoch: 10, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.460 Vali Acc: 0.829 Test Loss: 0.460 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.571108102798462
Epoch: 11, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.521 Vali Acc: 0.805 Test Loss: 0.521 Test Acc: 0.805
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6551055908203125
Epoch: 12, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.601 Vali Acc: 0.785 Test Loss: 0.601 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5444700717926025
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.515 Vali Acc: 0.823 Test Loss: 0.515 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.57826828956604
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.553 Vali Acc: 0.799 Test Loss: 0.553 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.497908115386963
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.575 Vali Acc: 0.802 Test Loss: 0.575 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6191489696502686
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.610 Vali Acc: 0.802 Test Loss: 0.610 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6252543926239014
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.627 Vali Acc: 0.792 Test Loss: 0.627 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 20770
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.253796339035034
Epoch: 1, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.544 Vali Acc: 0.741 Test Loss: 0.544 Test Acc: 0.741
Validation loss decreased (inf --> -0.740609).  Saving model ...
Epoch: 2 cost time: 1.509458065032959
Epoch: 2, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.440 Vali Acc: 0.823 Test Loss: 0.440 Test Acc: 0.823
Validation loss decreased (-0.740609 --> -0.822521).  Saving model ...
Epoch: 3 cost time: 1.5247130393981934
Epoch: 3, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.4015915393829346
Epoch: 4, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.414 Vali Acc: 0.836 Test Loss: 0.414 Test Acc: 0.836
Validation loss decreased (-0.822521 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 1.8290038108825684
Epoch: 5, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.460 Vali Acc: 0.805 Test Loss: 0.460 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6010444164276123
Epoch: 6, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.423 Vali Acc: 0.812 Test Loss: 0.423 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.619499921798706
Epoch: 7, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.433 Vali Acc: 0.823 Test Loss: 0.433 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3030855655670166
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.478 Vali Acc: 0.802 Test Loss: 0.478 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7616066932678223
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.435 Vali Acc: 0.812 Test Loss: 0.435 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5696229934692383
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.468 Vali Acc: 0.805 Test Loss: 0.468 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2581229209899902
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.462 Vali Acc: 0.823 Test Loss: 0.462 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6275911331176758
Epoch: 12, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.495 Vali Acc: 0.812 Test Loss: 0.495 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4911894798278809
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.527 Vali Acc: 0.795 Test Loss: 0.527 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4614648818969727
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.812 Test Loss: 0.532 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 18786
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.416228771209717
Epoch: 1, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.567 Vali Acc: 0.672 Test Loss: 0.567 Test Acc: 0.672
Validation loss decreased (inf --> -0.672349).  Saving model ...
Epoch: 2 cost time: 1.812847375869751
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.468 Vali Acc: 0.751 Test Loss: 0.468 Test Acc: 0.751
Validation loss decreased (-0.672349 --> -0.750849).  Saving model ...
Epoch: 3 cost time: 1.6725964546203613
Epoch: 3, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.419 Vali Acc: 0.823 Test Loss: 0.419 Test Acc: 0.823
Validation loss decreased (-0.750849 --> -0.822521).  Saving model ...
Epoch: 4 cost time: 1.5053834915161133
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.409 Vali Acc: 0.823 Test Loss: 0.409 Test Acc: 0.823
Validation loss decreased (-0.822521 --> -0.822522).  Saving model ...
Epoch: 5 cost time: 1.9545836448669434
Epoch: 5, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
Validation loss decreased (-0.822522 --> -0.839587).  Saving model ...
Epoch: 6 cost time: 1.6513314247131348
Epoch: 6, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.432 Vali Acc: 0.816 Test Loss: 0.432 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8076136112213135
Epoch: 7, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.839587 --> -0.849825).  Saving model ...
Epoch: 8 cost time: 1.8349506855010986
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.411 Vali Acc: 0.846 Test Loss: 0.411 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2370197772979736
Epoch: 9, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.398 Vali Acc: 0.857 Test Loss: 0.398 Test Acc: 0.857
Validation loss decreased (-0.849825 --> -0.856651).  Saving model ...
Epoch: 10 cost time: 1.4582781791687012
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.439 Vali Acc: 0.826 Test Loss: 0.439 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7984657287597656
Epoch: 11, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.403 Vali Acc: 0.853 Test Loss: 0.403 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6162068843841553
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.409 Vali Acc: 0.850 Test Loss: 0.409 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.880944013595581
Epoch: 13, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.425 Vali Acc: 0.840 Test Loss: 0.425 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7573277950286865
Epoch: 14, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.422 Vali Acc: 0.829 Test Loss: 0.422 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.989875078201294
Epoch: 15, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.430 Vali Acc: 0.850 Test Loss: 0.430 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6875038146972656
Epoch: 16, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.469 Vali Acc: 0.812 Test Loss: 0.469 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4231464862823486
Epoch: 17, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.434 Vali Acc: 0.846 Test Loss: 0.434 Test Acc: 0.846
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5311098098754883
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.007018804550171
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.489 Vali Acc: 0.829 Test Loss: 0.489 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 17922
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.669867515563965
Epoch: 1, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.625 Vali Acc: 0.669 Test Loss: 0.625 Test Acc: 0.669
Validation loss decreased (inf --> -0.668936).  Saving model ...
Epoch: 2 cost time: 1.8706679344177246
Epoch: 2, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.499 Vali Acc: 0.778 Test Loss: 0.499 Test Acc: 0.778
Validation loss decreased (-0.668936 --> -0.778152).  Saving model ...
Epoch: 3 cost time: 1.377851963043213
Epoch: 3, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.444 Vali Acc: 0.812 Test Loss: 0.444 Test Acc: 0.812
Validation loss decreased (-0.778152 --> -0.812282).  Saving model ...
Epoch: 4 cost time: 1.6840314865112305
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.421 Vali Acc: 0.812 Test Loss: 0.421 Test Acc: 0.812
Validation loss decreased (-0.812282 --> -0.812282).  Saving model ...
Epoch: 5 cost time: 1.9050483703613281
Epoch: 5, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.441 Vali Acc: 0.809 Test Loss: 0.441 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5407171249389648
Epoch: 6, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.812282 --> -0.849825).  Saving model ...
Epoch: 7 cost time: 1.6196608543395996
Epoch: 7, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.368 Vali Acc: 0.853 Test Loss: 0.368 Test Acc: 0.853
Validation loss decreased (-0.849825 --> -0.853239).  Saving model ...
Epoch: 8 cost time: 1.4753875732421875
Epoch: 8, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.382 Vali Acc: 0.846 Test Loss: 0.382 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4690213203430176
Epoch: 9, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.397 Vali Acc: 0.850 Test Loss: 0.397 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7778832912445068
Epoch: 10, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.347 Vali Acc: 0.863 Test Loss: 0.347 Test Acc: 0.863
Validation loss decreased (-0.853239 --> -0.863478).  Saving model ...
Epoch: 11 cost time: 2.0889434814453125
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.392 Vali Acc: 0.840 Test Loss: 0.392 Test Acc: 0.840
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8589482307434082
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.381 Vali Acc: 0.846 Test Loss: 0.381 Test Acc: 0.846
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8902533054351807
Epoch: 13, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.393 Vali Acc: 0.829 Test Loss: 0.393 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5098004341125488
Epoch: 14, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.371 Vali Acc: 0.853 Test Loss: 0.371 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7946736812591553
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
Validation loss decreased (-0.863478 --> -0.866890).  Saving model ...
Epoch: 16 cost time: 1.7464702129364014
Epoch: 16, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.422 Vali Acc: 0.833 Test Loss: 0.422 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.629096269607544
Epoch: 17, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.376 Vali Acc: 0.860 Test Loss: 0.376 Test Acc: 0.860
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5976645946502686
Epoch: 18, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.427 Vali Acc: 0.843 Test Loss: 0.427 Test Acc: 0.843
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4350359439849854
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.403 Vali Acc: 0.853 Test Loss: 0.403 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6759898662567139
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.471 Vali Acc: 0.819 Test Loss: 0.471 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.013709306716919
Epoch: 21, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.406 Vali Acc: 0.846 Test Loss: 0.406 Test Acc: 0.846
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.69981050491333
Epoch: 22, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.569 Vali Acc: 0.768 Test Loss: 0.569 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4098122119903564
Epoch: 23, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.466 Vali Acc: 0.823 Test Loss: 0.466 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.532071828842163
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.459 Vali Acc: 0.836 Test Loss: 0.459 Test Acc: 0.836
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8025486469268799
Epoch: 25, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.454 Vali Acc: 0.840 Test Loss: 0.454 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 17826
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.052128791809082
Epoch: 1, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.566 Vali Acc: 0.696 Test Loss: 0.566 Test Acc: 0.696
Validation loss decreased (inf --> -0.696240).  Saving model ...
Epoch: 2 cost time: 1.683912992477417
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.465 Vali Acc: 0.761 Test Loss: 0.465 Test Acc: 0.761
Validation loss decreased (-0.696240 --> -0.761087).  Saving model ...
Epoch: 3 cost time: 1.6082346439361572
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
Validation loss decreased (-0.761087 --> -0.822522).  Saving model ...
Epoch: 4 cost time: 2.043999671936035
Epoch: 4, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.385 Vali Acc: 0.843 Test Loss: 0.385 Test Acc: 0.843
Validation loss decreased (-0.822522 --> -0.843000).  Saving model ...
Epoch: 5 cost time: 1.8289432525634766
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.391 Vali Acc: 0.809 Test Loss: 0.391 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6516430377960205
Epoch: 6, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.378 Vali Acc: 0.826 Test Loss: 0.378 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6221227645874023
Epoch: 7, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.434 Vali Acc: 0.799 Test Loss: 0.434 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3176989555358887
Epoch: 8, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.385 Vali Acc: 0.829 Test Loss: 0.385 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2939379215240479
Epoch: 9, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.486656665802002
Epoch: 10, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2829208374023438
Epoch: 11, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.364 Vali Acc: 0.857 Test Loss: 0.364 Test Acc: 0.857
Validation loss decreased (-0.843000 --> -0.856652).  Saving model ...
Epoch: 12 cost time: 1.1817941665649414
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.802 Test Loss: 0.455 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6634418964385986
Epoch: 13, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.395 Vali Acc: 0.843 Test Loss: 0.395 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6958389282226562
Epoch: 14, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.439 Vali Acc: 0.812 Test Loss: 0.439 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4358863830566406
Epoch: 15, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.412 Vali Acc: 0.840 Test Loss: 0.412 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0397274494171143
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.491 Vali Acc: 0.805 Test Loss: 0.491 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.733616590499878
Epoch: 17, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.414 Vali Acc: 0.857 Test Loss: 0.414 Test Acc: 0.857
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7252449989318848
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9981005191802979
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.424 Vali Acc: 0.843 Test Loss: 0.424 Test Acc: 0.843
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4738032817840576
Epoch: 20, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.566 Vali Acc: 0.805 Test Loss: 0.566 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4687397480010986
Epoch: 21, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.492 Vali Acc: 0.836 Test Loss: 0.492 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm32_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.856655290102389
model parameter : 18850
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.307837724685669
Epoch: 1, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.564 Vali Acc: 0.744 Test Loss: 0.564 Test Acc: 0.744
Validation loss decreased (inf --> -0.744022).  Saving model ...
Epoch: 2 cost time: 1.4468097686767578
Epoch: 2, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.435 Vali Acc: 0.819 Test Loss: 0.435 Test Acc: 0.819
Validation loss decreased (-0.744022 --> -0.819108).  Saving model ...
Epoch: 3 cost time: 1.4835114479064941
Epoch: 3, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.420 Vali Acc: 0.819 Test Loss: 0.420 Test Acc: 0.819
Validation loss decreased (-0.819108 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.4874613285064697
Epoch: 4, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.394 Vali Acc: 0.829 Test Loss: 0.394 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 5 cost time: 1.4948852062225342
Epoch: 5, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.410 Vali Acc: 0.805 Test Loss: 0.410 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.751204490661621
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.564 Vali Acc: 0.734 Test Loss: 0.564 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3841078281402588
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.432 Vali Acc: 0.805 Test Loss: 0.432 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.637930154800415
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.589 Vali Acc: 0.754 Test Loss: 0.589 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.943408727645874
Epoch: 9, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.543 Vali Acc: 0.785 Test Loss: 0.543 Test Acc: 0.785
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.762972116470337
Epoch: 10, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.514 Vali Acc: 0.788 Test Loss: 0.514 Test Acc: 0.788
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.503525733947754
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.546 Vali Acc: 0.792 Test Loss: 0.546 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.647226095199585
Epoch: 12, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.599 Vali Acc: 0.795 Test Loss: 0.599 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4823455810546875
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.566941738128662
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.691 Vali Acc: 0.768 Test Loss: 0.691 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 24226
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.959404945373535
Epoch: 1, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.535 Vali Acc: 0.775 Test Loss: 0.535 Test Acc: 0.775
Validation loss decreased (inf --> -0.774739).  Saving model ...
Epoch: 2 cost time: 1.5944690704345703
Epoch: 2, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.456 Vali Acc: 0.771 Test Loss: 0.456 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.845411777496338
Epoch: 3, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.420 Vali Acc: 0.812 Test Loss: 0.420 Test Acc: 0.812
Validation loss decreased (-0.774739 --> -0.812282).  Saving model ...
Epoch: 4 cost time: 1.717505693435669
Epoch: 4, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.469 Vali Acc: 0.761 Test Loss: 0.469 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8133447170257568
Epoch: 5, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.465 Vali Acc: 0.799 Test Loss: 0.465 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.671041488647461
Epoch: 6, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.457 Vali Acc: 0.795 Test Loss: 0.457 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.895432710647583
Epoch: 7, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.422 Vali Acc: 0.799 Test Loss: 0.422 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.864243507385254
Epoch: 8, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.419 Vali Acc: 0.802 Test Loss: 0.419 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.655909538269043
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.473 Vali Acc: 0.775 Test Loss: 0.473 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.130013942718506
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.436 Vali Acc: 0.795 Test Loss: 0.436 Test Acc: 0.795
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7690050601959229
Epoch: 11, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.415 Vali Acc: 0.826 Test Loss: 0.415 Test Acc: 0.826
Validation loss decreased (-0.812282 --> -0.825934).  Saving model ...
Epoch: 12 cost time: 1.9405572414398193
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.466 Vali Acc: 0.785 Test Loss: 0.466 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.92275071144104
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.451 Vali Acc: 0.812 Test Loss: 0.451 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6760425567626953
Epoch: 14, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9599003791809082
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.564 Vali Acc: 0.761 Test Loss: 0.564 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9389965534210205
Epoch: 16, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.534 Vali Acc: 0.805 Test Loss: 0.534 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.022825241088867
Epoch: 17, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.499 Vali Acc: 0.823 Test Loss: 0.499 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7975614070892334
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.563 Vali Acc: 0.802 Test Loss: 0.563 Test Acc: 0.802
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8467891216278076
Epoch: 19, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.612 Vali Acc: 0.792 Test Loss: 0.612 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0447845458984375
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.609 Vali Acc: 0.792 Test Loss: 0.609 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4814481735229492
Epoch: 21, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.649 Vali Acc: 0.785 Test Loss: 0.649 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.825938566552901
model parameter : 17858
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.541807413101196
Epoch: 1, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.683 Vali Acc: 0.590 Test Loss: 0.683 Test Acc: 0.590
Validation loss decreased (inf --> -0.590437).  Saving model ...
Epoch: 2 cost time: 1.607818603515625
Epoch: 2, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.547 Vali Acc: 0.717 Test Loss: 0.547 Test Acc: 0.717
Validation loss decreased (-0.590437 --> -0.716718).  Saving model ...
Epoch: 3 cost time: 1.5610995292663574
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.509 Vali Acc: 0.744 Test Loss: 0.509 Test Acc: 0.744
Validation loss decreased (-0.716718 --> -0.744022).  Saving model ...
Epoch: 4 cost time: 1.8218088150024414
Epoch: 4, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.471 Vali Acc: 0.771 Test Loss: 0.471 Test Acc: 0.771
Validation loss decreased (-0.744022 --> -0.771326).  Saving model ...
Epoch: 5 cost time: 1.5895752906799316
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.466 Vali Acc: 0.785 Test Loss: 0.466 Test Acc: 0.785
Validation loss decreased (-0.771326 --> -0.784978).  Saving model ...
Epoch: 6 cost time: 1.7030713558197021
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.436 Vali Acc: 0.816 Test Loss: 0.436 Test Acc: 0.816
Validation loss decreased (-0.784978 --> -0.815695).  Saving model ...
Epoch: 7 cost time: 1.8461918830871582
Epoch: 7, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.431 Vali Acc: 0.816 Test Loss: 0.431 Test Acc: 0.816
Validation loss decreased (-0.815695 --> -0.815695).  Saving model ...
Epoch: 8 cost time: 1.3509423732757568
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.435 Vali Acc: 0.795 Test Loss: 0.435 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8051512241363525
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.434 Vali Acc: 0.802 Test Loss: 0.434 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4537348747253418
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.418 Vali Acc: 0.809 Test Loss: 0.418 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4093003273010254
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.454 Vali Acc: 0.799 Test Loss: 0.454 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.558462381362915
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.414 Vali Acc: 0.829 Test Loss: 0.414 Test Acc: 0.829
Validation loss decreased (-0.815695 --> -0.829347).  Saving model ...
Epoch: 13 cost time: 1.841278076171875
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6659653186798096
Epoch: 14, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.502 Vali Acc: 0.799 Test Loss: 0.502 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8163182735443115
Epoch: 15, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.829347 --> -0.832760).  Saving model ...
Epoch: 16 cost time: 1.8597559928894043
Epoch: 16, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.453 Vali Acc: 0.809 Test Loss: 0.453 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.544332504272461
Epoch: 17, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.494 Vali Acc: 0.788 Test Loss: 0.494 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8994429111480713
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.482 Vali Acc: 0.802 Test Loss: 0.482 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6864218711853027
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.572707176208496
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.492 Vali Acc: 0.819 Test Loss: 0.492 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7646327018737793
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.535 Vali Acc: 0.792 Test Loss: 0.535 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6622323989868164
Epoch: 22, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.565 Vali Acc: 0.785 Test Loss: 0.565 Test Acc: 0.785
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5391345024108887
Epoch: 23, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.603 Vali Acc: 0.785 Test Loss: 0.603 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2681922912597656
Epoch: 24, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.598 Vali Acc: 0.795 Test Loss: 0.598 Test Acc: 0.795
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.489485263824463
Epoch: 25, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.594 Vali Acc: 0.802 Test Loss: 0.594 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 15730
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.950988054275513
Epoch: 1, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.608 Vali Acc: 0.696 Test Loss: 0.608 Test Acc: 0.696
Validation loss decreased (inf --> -0.696240).  Saving model ...
Epoch: 2 cost time: 1.8011376857757568
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.486 Vali Acc: 0.778 Test Loss: 0.486 Test Acc: 0.778
Validation loss decreased (-0.696240 --> -0.778152).  Saving model ...
Epoch: 3 cost time: 1.5008985996246338
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.422 Vali Acc: 0.816 Test Loss: 0.422 Test Acc: 0.816
Validation loss decreased (-0.778152 --> -0.815695).  Saving model ...
Epoch: 4 cost time: 2.0425052642822266
Epoch: 4, Steps: 17 | Train Loss: 0.434 Vali Loss: 0.422 Vali Acc: 0.812 Test Loss: 0.422 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8171296119689941
Epoch: 5, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.439 Vali Acc: 0.802 Test Loss: 0.439 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.763857364654541
Epoch: 6, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.425 Vali Acc: 0.805 Test Loss: 0.425 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.944444179534912
Epoch: 7, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.435 Vali Acc: 0.795 Test Loss: 0.435 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0978124141693115
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.408 Vali Acc: 0.819 Test Loss: 0.408 Test Acc: 0.819
Validation loss decreased (-0.815695 --> -0.819109).  Saving model ...
Epoch: 9 cost time: 1.9487254619598389
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.396 Vali Acc: 0.816 Test Loss: 0.396 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0503368377685547
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.409 Vali Acc: 0.809 Test Loss: 0.409 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.97487211227417
Epoch: 11, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.433 Vali Acc: 0.792 Test Loss: 0.433 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.807875633239746
Epoch: 12, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
Validation loss decreased (-0.819109 --> -0.822522).  Saving model ...
Epoch: 13 cost time: 1.812241792678833
Epoch: 13, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.418 Vali Acc: 0.812 Test Loss: 0.418 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.037633180618286
Epoch: 14, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.462 Vali Acc: 0.799 Test Loss: 0.462 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8284661769866943
Epoch: 15, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.414 Vali Acc: 0.833 Test Loss: 0.414 Test Acc: 0.833
Validation loss decreased (-0.822522 --> -0.832760).  Saving model ...
Epoch: 16 cost time: 2.075784206390381
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.468 Vali Acc: 0.799 Test Loss: 0.468 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8718366622924805
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.443 Vali Acc: 0.823 Test Loss: 0.443 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6941564083099365
Epoch: 18, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.442 Vali Acc: 0.826 Test Loss: 0.442 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8973934650421143
Epoch: 19, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.440 Vali Acc: 0.823 Test Loss: 0.440 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9411852359771729
Epoch: 20, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.451 Vali Acc: 0.836 Test Loss: 0.451 Test Acc: 0.836
Validation loss decreased (-0.832760 --> -0.836173).  Saving model ...
Epoch: 21 cost time: 1.8576602935791016
Epoch: 21, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.528 Vali Acc: 0.792 Test Loss: 0.528 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9394972324371338
Epoch: 22, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.503 Vali Acc: 0.812 Test Loss: 0.503 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4707677364349365
Epoch: 23, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.513 Vali Acc: 0.805 Test Loss: 0.513 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7858290672302246
Epoch: 24, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.521 Vali Acc: 0.819 Test Loss: 0.521 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8002026081085205
Epoch: 25, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0978920459747314
Epoch: 26, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.498 Vali Acc: 0.836 Test Loss: 0.498 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7670834064483643
Epoch: 27, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.521 Vali Acc: 0.812 Test Loss: 0.521 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7973041534423828
Epoch: 28, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6507322788238525
Epoch: 29, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8417456150054932
Epoch: 30, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 14738
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.903865337371826
Epoch: 1, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.725 Vali Acc: 0.474 Test Loss: 0.725 Test Acc: 0.474
Validation loss decreased (inf --> -0.474395).  Saving model ...
Epoch: 2 cost time: 1.4781644344329834
Epoch: 2, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.523 Vali Acc: 0.765 Test Loss: 0.523 Test Acc: 0.765
Validation loss decreased (-0.474395 --> -0.764500).  Saving model ...
Epoch: 3 cost time: 1.5505545139312744
Epoch: 3, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
Validation loss decreased (-0.764500 --> -0.808869).  Saving model ...
Epoch: 4 cost time: 1.6164116859436035
Epoch: 4, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.425 Vali Acc: 0.802 Test Loss: 0.425 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.335768699645996
Epoch: 5, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.405 Vali Acc: 0.812 Test Loss: 0.405 Test Acc: 0.812
Validation loss decreased (-0.808869 --> -0.812283).  Saving model ...
Epoch: 6 cost time: 1.3473801612854004
Epoch: 6, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.401 Vali Acc: 0.809 Test Loss: 0.401 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4504811763763428
Epoch: 7, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.450 Vali Acc: 0.771 Test Loss: 0.450 Test Acc: 0.771
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5162365436553955
Epoch: 8, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.399 Vali Acc: 0.812 Test Loss: 0.399 Test Acc: 0.812
Validation loss decreased (-0.812283 --> -0.812283).  Saving model ...
Epoch: 9 cost time: 1.8522474765777588
Epoch: 9, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.388 Vali Acc: 0.816 Test Loss: 0.388 Test Acc: 0.816
Validation loss decreased (-0.812283 --> -0.815696).  Saving model ...
Epoch: 10 cost time: 1.9014275074005127
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.389 Vali Acc: 0.829 Test Loss: 0.389 Test Acc: 0.829
Validation loss decreased (-0.815696 --> -0.829348).  Saving model ...
Epoch: 11 cost time: 1.551870346069336
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.387 Vali Acc: 0.819 Test Loss: 0.387 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0166428089141846
Epoch: 12, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.387 Vali Acc: 0.823 Test Loss: 0.387 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7706842422485352
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.396 Vali Acc: 0.833 Test Loss: 0.396 Test Acc: 0.833
Validation loss decreased (-0.829348 --> -0.832761).  Saving model ...
Epoch: 14 cost time: 1.3783903121948242
Epoch: 14, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.408 Vali Acc: 0.812 Test Loss: 0.408 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8169543743133545
Epoch: 15, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.394 Vali Acc: 0.833 Test Loss: 0.394 Test Acc: 0.833
Validation loss decreased (-0.832761 --> -0.832761).  Saving model ...
Epoch: 16 cost time: 1.3369617462158203
Epoch: 16, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.585421085357666
Epoch: 17, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.403 Vali Acc: 0.829 Test Loss: 0.403 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7585020065307617
Epoch: 18, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.411 Vali Acc: 0.836 Test Loss: 0.411 Test Acc: 0.836
Validation loss decreased (-0.832761 --> -0.836173).  Saving model ...
Epoch: 19 cost time: 1.754106044769287
Epoch: 19, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.425 Vali Acc: 0.829 Test Loss: 0.425 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.077787160873413
Epoch: 20, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.440 Vali Acc: 0.829 Test Loss: 0.440 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7019038200378418
Epoch: 21, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.433 Vali Acc: 0.833 Test Loss: 0.433 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8665921688079834
Epoch: 22, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.439 Vali Acc: 0.819 Test Loss: 0.439 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3233139514923096
Epoch: 23, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.417 Vali Acc: 0.836 Test Loss: 0.417 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.782482624053955
Epoch: 24, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.468 Vali Acc: 0.823 Test Loss: 0.468 Test Acc: 0.823
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9429516792297363
Epoch: 25, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.461 Vali Acc: 0.823 Test Loss: 0.461 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.810499668121338
Epoch: 26, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.92221999168396
Epoch: 27, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9220619201660156
Epoch: 28, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.496 Vali Acc: 0.805 Test Loss: 0.496 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 14306
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.120175361633301
Epoch: 1, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.590 Vali Acc: 0.686 Test Loss: 0.590 Test Acc: 0.686
Validation loss decreased (inf --> -0.686001).  Saving model ...
Epoch: 2 cost time: 2.4696366786956787
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.511 Vali Acc: 0.765 Test Loss: 0.511 Test Acc: 0.765
Validation loss decreased (-0.686001 --> -0.764500).  Saving model ...
Epoch: 3 cost time: 1.504260778427124
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.473 Vali Acc: 0.788 Test Loss: 0.473 Test Acc: 0.788
Validation loss decreased (-0.764500 --> -0.788391).  Saving model ...
Epoch: 4 cost time: 1.5450036525726318
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.443 Vali Acc: 0.799 Test Loss: 0.443 Test Acc: 0.799
Validation loss decreased (-0.788391 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 1.502464771270752
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.434 Vali Acc: 0.809 Test Loss: 0.434 Test Acc: 0.809
Validation loss decreased (-0.798630 --> -0.808869).  Saving model ...
Epoch: 6 cost time: 1.5127601623535156
Epoch: 6, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.424 Vali Acc: 0.802 Test Loss: 0.424 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9471981525421143
Epoch: 7, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.390 Vali Acc: 0.826 Test Loss: 0.390 Test Acc: 0.826
Validation loss decreased (-0.808869 --> -0.825935).  Saving model ...
Epoch: 8 cost time: 2.111180305480957
Epoch: 8, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.384 Vali Acc: 0.840 Test Loss: 0.384 Test Acc: 0.840
Validation loss decreased (-0.825935 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 2.263942241668701
Epoch: 9, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
Validation loss decreased (-0.839587 --> -0.849826).  Saving model ...
Epoch: 10 cost time: 1.7604844570159912
Epoch: 10, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.391 Vali Acc: 0.829 Test Loss: 0.391 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.777350664138794
Epoch: 11, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.380 Vali Acc: 0.843 Test Loss: 0.380 Test Acc: 0.843
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.60672926902771
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.421 Vali Acc: 0.805 Test Loss: 0.421 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.409679651260376
Epoch: 13, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.380 Vali Acc: 0.843 Test Loss: 0.380 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.733459711074829
Epoch: 14, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.368 Vali Acc: 0.846 Test Loss: 0.368 Test Acc: 0.846
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5131583213806152
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.352 Vali Acc: 0.867 Test Loss: 0.352 Test Acc: 0.867
Validation loss decreased (-0.849826 --> -0.866891).  Saving model ...
Epoch: 16 cost time: 1.9079980850219727
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6118392944335938
Epoch: 17, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.372 Vali Acc: 0.853 Test Loss: 0.372 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8399860858917236
Epoch: 18, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.388 Vali Acc: 0.829 Test Loss: 0.388 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9649653434753418
Epoch: 19, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.386 Vali Acc: 0.853 Test Loss: 0.386 Test Acc: 0.853
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8128423690795898
Epoch: 20, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.413 Vali Acc: 0.826 Test Loss: 0.413 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5115008354187012
Epoch: 21, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.383 Vali Acc: 0.843 Test Loss: 0.383 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7333569526672363
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.398 Vali Acc: 0.823 Test Loss: 0.398 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.158311367034912
Epoch: 23, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.421 Vali Acc: 0.819 Test Loss: 0.421 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8781859874725342
Epoch: 24, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.445 Vali Acc: 0.809 Test Loss: 0.445 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4917666912078857
Epoch: 25, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.383 Vali Acc: 0.850 Test Loss: 0.383 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8668941979522184
model parameter : 14258
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.217473983764648
Epoch: 1, Steps: 17 | Train Loss: 0.582 Vali Loss: 0.614 Vali Acc: 0.635 Test Loss: 0.614 Test Acc: 0.635
Validation loss decreased (inf --> -0.634806).  Saving model ...
Epoch: 2 cost time: 1.7726764678955078
Epoch: 2, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.515 Vali Acc: 0.765 Test Loss: 0.515 Test Acc: 0.765
Validation loss decreased (-0.634806 --> -0.764500).  Saving model ...
Epoch: 3 cost time: 1.7538611888885498
Epoch: 3, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.470 Vali Acc: 0.792 Test Loss: 0.470 Test Acc: 0.792
Validation loss decreased (-0.764500 --> -0.791804).  Saving model ...
Epoch: 4 cost time: 1.6561846733093262
Epoch: 4, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.430 Vali Acc: 0.802 Test Loss: 0.430 Test Acc: 0.802
Validation loss decreased (-0.791804 --> -0.802043).  Saving model ...
Epoch: 5 cost time: 1.6609177589416504
Epoch: 5, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.409 Vali Acc: 0.816 Test Loss: 0.409 Test Acc: 0.816
Validation loss decreased (-0.802043 --> -0.815696).  Saving model ...
Epoch: 6 cost time: 1.8161358833312988
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.402 Vali Acc: 0.823 Test Loss: 0.402 Test Acc: 0.823
Validation loss decreased (-0.815696 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 1.795116901397705
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.415 Vali Acc: 0.819 Test Loss: 0.415 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.637284517288208
Epoch: 8, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.398 Vali Acc: 0.819 Test Loss: 0.398 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9239575862884521
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.382 Vali Acc: 0.826 Test Loss: 0.382 Test Acc: 0.826
Validation loss decreased (-0.822522 --> -0.825935).  Saving model ...
Epoch: 10 cost time: 1.6105337142944336
Epoch: 10, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8997151851654053
Epoch: 11, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.375 Vali Acc: 0.846 Test Loss: 0.375 Test Acc: 0.846
Validation loss decreased (-0.825935 --> -0.846413).  Saving model ...
Epoch: 12 cost time: 1.773946762084961
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.403 Vali Acc: 0.836 Test Loss: 0.403 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0565333366394043
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8139801025390625
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.396 Vali Acc: 0.829 Test Loss: 0.396 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.821185827255249
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.384 Vali Acc: 0.843 Test Loss: 0.384 Test Acc: 0.843
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9335315227508545
Epoch: 16, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.412 Vali Acc: 0.833 Test Loss: 0.412 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.801220417022705
Epoch: 17, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5750114917755127
Epoch: 18, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.433 Vali Acc: 0.826 Test Loss: 0.433 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5941646099090576
Epoch: 19, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.399 Vali Acc: 0.840 Test Loss: 0.399 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8349356651306152
Epoch: 20, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3887608051300049
Epoch: 21, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.395 Vali Acc: 0.840 Test Loss: 0.395 Test Acc: 0.840
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df256_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8464163822525598
model parameter : 14770
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.654102563858032
Epoch: 1, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.548 Vali Acc: 0.713 Test Loss: 0.548 Test Acc: 0.713
Validation loss decreased (inf --> -0.713305).  Saving model ...
Epoch: 2 cost time: 1.882035255432129
Epoch: 2, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.403 Vali Acc: 0.840 Test Loss: 0.403 Test Acc: 0.840
Validation loss decreased (-0.713305 --> -0.839586).  Saving model ...
Epoch: 3 cost time: 1.5464632511138916
Epoch: 3, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.404 Vali Acc: 0.816 Test Loss: 0.404 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9146177768707275
Epoch: 4, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.415 Vali Acc: 0.816 Test Loss: 0.415 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7212073802947998
Epoch: 5, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.412 Vali Acc: 0.823 Test Loss: 0.412 Test Acc: 0.823
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.588043451309204
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.423 Vali Acc: 0.819 Test Loss: 0.423 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8525450229644775
Epoch: 7, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.395 Vali Acc: 0.833 Test Loss: 0.395 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.673046350479126
Epoch: 8, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.477 Vali Acc: 0.802 Test Loss: 0.477 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8718557357788086
Epoch: 9, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2474477291107178
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.538 Vali Acc: 0.826 Test Loss: 0.538 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7891747951507568
Epoch: 11, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.560 Vali Acc: 0.802 Test Loss: 0.560 Test Acc: 0.802
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9620442390441895
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 20002
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.462875604629517
Epoch: 1, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.603 Vali Acc: 0.710 Test Loss: 0.603 Test Acc: 0.710
Validation loss decreased (inf --> -0.709892).  Saving model ...
Epoch: 2 cost time: 1.5944812297821045
Epoch: 2, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.474 Vali Acc: 0.792 Test Loss: 0.474 Test Acc: 0.792
Validation loss decreased (-0.709892 --> -0.791804).  Saving model ...
Epoch: 3 cost time: 1.4000589847564697
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.461 Vali Acc: 0.778 Test Loss: 0.461 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7558748722076416
Epoch: 4, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.437 Vali Acc: 0.799 Test Loss: 0.437 Test Acc: 0.799
Validation loss decreased (-0.791804 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 1.7898614406585693
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.419 Vali Acc: 0.812 Test Loss: 0.419 Test Acc: 0.812
Validation loss decreased (-0.798630 --> -0.812282).  Saving model ...
Epoch: 6 cost time: 1.671321153640747
Epoch: 6, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3854296207427979
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.476 Vali Acc: 0.778 Test Loss: 0.476 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7389395236968994
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.400 Vali Acc: 0.829 Test Loss: 0.400 Test Acc: 0.829
Validation loss decreased (-0.812282 --> -0.829348).  Saving model ...
Epoch: 9 cost time: 1.7489218711853027
Epoch: 9, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.423 Vali Acc: 0.799 Test Loss: 0.423 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.866370677947998
Epoch: 10, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.436 Vali Acc: 0.809 Test Loss: 0.436 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0886611938476562
Epoch: 11, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.525 Vali Acc: 0.792 Test Loss: 0.525 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9788386821746826
Epoch: 12, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.441 Vali Acc: 0.819 Test Loss: 0.441 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6415431499481201
Epoch: 13, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.474 Vali Acc: 0.809 Test Loss: 0.474 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.596606731414795
Epoch: 14, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.522 Vali Acc: 0.795 Test Loss: 0.522 Test Acc: 0.795
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9272444248199463
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.513 Vali Acc: 0.799 Test Loss: 0.513 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8172211647033691
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.529 Vali Acc: 0.802 Test Loss: 0.529 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6476821899414062
Epoch: 17, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.546 Vali Acc: 0.799 Test Loss: 0.546 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3104631900787354
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.562 Vali Acc: 0.802 Test Loss: 0.562 Test Acc: 0.802
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 13634
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.429333925247192
Epoch: 1, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
Validation loss decreased (inf --> -0.737195).  Saving model ...
Epoch: 2 cost time: 2.0672597885131836
Epoch: 2, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.465 Vali Acc: 0.799 Test Loss: 0.465 Test Acc: 0.799
Validation loss decreased (-0.737195 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 2.3070790767669678
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.429 Vali Acc: 0.805 Test Loss: 0.429 Test Acc: 0.805
Validation loss decreased (-0.798630 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 1.6811480522155762
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.407 Vali Acc: 0.836 Test Loss: 0.407 Test Acc: 0.836
Validation loss decreased (-0.805456 --> -0.836173).  Saving model ...
Epoch: 5 cost time: 1.89860200881958
Epoch: 5, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.387 Vali Acc: 0.833 Test Loss: 0.387 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5382294654846191
Epoch: 6, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4515531063079834
Epoch: 7, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.394 Vali Acc: 0.819 Test Loss: 0.394 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7336745262145996
Epoch: 8, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.377 Vali Acc: 0.840 Test Loss: 0.377 Test Acc: 0.840
Validation loss decreased (-0.836173 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.7372496128082275
Epoch: 9, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.413 Vali Acc: 0.805 Test Loss: 0.413 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4910295009613037
Epoch: 10, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.400 Vali Acc: 0.812 Test Loss: 0.400 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9759066104888916
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6086311340332031
Epoch: 12, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.410 Vali Acc: 0.795 Test Loss: 0.410 Test Acc: 0.795
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8360204696655273
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.387 Vali Acc: 0.812 Test Loss: 0.387 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6646687984466553
Epoch: 14, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.453 Vali Acc: 0.805 Test Loss: 0.453 Test Acc: 0.805
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7367680072784424
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.442 Vali Acc: 0.799 Test Loss: 0.442 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8287930488586426
Epoch: 16, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.421 Vali Acc: 0.809 Test Loss: 0.421 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7128493785858154
Epoch: 17, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.479 Vali Acc: 0.799 Test Loss: 0.479 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9460885524749756
Epoch: 18, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.461 Vali Acc: 0.805 Test Loss: 0.461 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 11506
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.0393407344818115
Epoch: 1, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.630 Vali Acc: 0.669 Test Loss: 0.630 Test Acc: 0.669
Validation loss decreased (inf --> -0.668936).  Saving model ...
Epoch: 2 cost time: 1.8123042583465576
Epoch: 2, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.502 Vali Acc: 0.788 Test Loss: 0.502 Test Acc: 0.788
Validation loss decreased (-0.668936 --> -0.788391).  Saving model ...
Epoch: 3 cost time: 1.9773874282836914
Epoch: 3, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.440 Vali Acc: 0.805 Test Loss: 0.440 Test Acc: 0.805
Validation loss decreased (-0.788391 --> -0.805456).  Saving model ...
Epoch: 4 cost time: 2.3231186866760254
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.412 Vali Acc: 0.816 Test Loss: 0.412 Test Acc: 0.816
Validation loss decreased (-0.805456 --> -0.815696).  Saving model ...
Epoch: 5 cost time: 1.5450258255004883
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.407 Vali Acc: 0.840 Test Loss: 0.407 Test Acc: 0.840
Validation loss decreased (-0.815696 --> -0.839586).  Saving model ...
Epoch: 6 cost time: 1.7490124702453613
Epoch: 6, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.410 Vali Acc: 0.823 Test Loss: 0.410 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6078929901123047
Epoch: 7, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.398 Vali Acc: 0.833 Test Loss: 0.398 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.587395429611206
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.377 Vali Acc: 0.843 Test Loss: 0.377 Test Acc: 0.843
Validation loss decreased (-0.839586 --> -0.843000).  Saving model ...
Epoch: 9 cost time: 1.5771636962890625
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.426 Vali Acc: 0.802 Test Loss: 0.426 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6366419792175293
Epoch: 10, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.407 Vali Acc: 0.819 Test Loss: 0.407 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.489396333694458
Epoch: 11, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.417 Vali Acc: 0.802 Test Loss: 0.417 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7205142974853516
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.414 Vali Acc: 0.812 Test Loss: 0.414 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7449517250061035
Epoch: 13, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.442 Vali Acc: 0.795 Test Loss: 0.442 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8535654544830322
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.436 Vali Acc: 0.812 Test Loss: 0.436 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8209407329559326
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.430 Vali Acc: 0.829 Test Loss: 0.430 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.668971061706543
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.479 Vali Acc: 0.785 Test Loss: 0.479 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.727909803390503
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.455 Vali Acc: 0.799 Test Loss: 0.455 Test Acc: 0.799
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6026644706726074
Epoch: 18, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.476 Vali Acc: 0.785 Test Loss: 0.476 Test Acc: 0.785
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8430034129692833
model parameter : 10514
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.5045459270477295
Epoch: 1, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.706 Vali Acc: 0.512 Test Loss: 0.706 Test Acc: 0.512
Validation loss decreased (inf --> -0.511938).  Saving model ...
Epoch: 2 cost time: 1.825089931488037
Epoch: 2, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.511938 --> -0.761087).  Saving model ...
Epoch: 3 cost time: 1.607985019683838
Epoch: 3, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.483 Vali Acc: 0.754 Test Loss: 0.483 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.499396562576294
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.430 Vali Acc: 0.809 Test Loss: 0.430 Test Acc: 0.809
Validation loss decreased (-0.761087 --> -0.808869).  Saving model ...
Epoch: 5 cost time: 1.7827982902526855
Epoch: 5, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.408 Vali Acc: 0.816 Test Loss: 0.408 Test Acc: 0.816
Validation loss decreased (-0.808869 --> -0.815696).  Saving model ...
Epoch: 6 cost time: 1.4771063327789307
Epoch: 6, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.442 Vali Acc: 0.795 Test Loss: 0.442 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6924567222595215
Epoch: 7, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.423 Vali Acc: 0.812 Test Loss: 0.423 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.668724536895752
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.426 Vali Acc: 0.809 Test Loss: 0.426 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.81223464012146
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.393 Vali Acc: 0.829 Test Loss: 0.393 Test Acc: 0.829
Validation loss decreased (-0.815696 --> -0.829348).  Saving model ...
Epoch: 10 cost time: 1.8808073997497559
Epoch: 10, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.404 Vali Acc: 0.826 Test Loss: 0.404 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.752788782119751
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.396 Vali Acc: 0.823 Test Loss: 0.396 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5613842010498047
Epoch: 12, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.391 Vali Acc: 0.826 Test Loss: 0.391 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7227592468261719
Epoch: 13, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.380 Vali Acc: 0.840 Test Loss: 0.380 Test Acc: 0.840
Validation loss decreased (-0.829348 --> -0.839587).  Saving model ...
Epoch: 14 cost time: 1.4965012073516846
Epoch: 14, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.437 Vali Acc: 0.799 Test Loss: 0.437 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5871467590332031
Epoch: 15, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.379 Vali Acc: 0.850 Test Loss: 0.379 Test Acc: 0.850
Validation loss decreased (-0.839587 --> -0.849826).  Saving model ...
Epoch: 16 cost time: 2.4127204418182373
Epoch: 16, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.367 Vali Acc: 0.846 Test Loss: 0.367 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6417574882507324
Epoch: 17, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.395 Vali Acc: 0.823 Test Loss: 0.395 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8331098556518555
Epoch: 18, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.431 Vali Acc: 0.809 Test Loss: 0.431 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.67702317237854
Epoch: 19, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.400 Vali Acc: 0.823 Test Loss: 0.400 Test Acc: 0.823
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3395636081695557
Epoch: 20, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4136407375335693
Epoch: 21, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.390 Vali Acc: 0.840 Test Loss: 0.390 Test Acc: 0.840
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6364188194274902
Epoch: 22, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.438 Vali Acc: 0.823 Test Loss: 0.438 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5149755477905273
Epoch: 23, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.409 Vali Acc: 0.840 Test Loss: 0.409 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6325430870056152
Epoch: 24, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.476 Vali Acc: 0.809 Test Loss: 0.476 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7397749423980713
Epoch: 25, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.439 Vali Acc: 0.823 Test Loss: 0.439 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8498293515358362
model parameter : 10082
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.768836736679077
Epoch: 1, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.793 Vali Acc: 0.430 Test Loss: 0.793 Test Acc: 0.430
Validation loss decreased (inf --> -0.430026).  Saving model ...
Epoch: 2 cost time: 2.0891997814178467
Epoch: 2, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.602 Vali Acc: 0.645 Test Loss: 0.602 Test Acc: 0.645
Validation loss decreased (-0.430026 --> -0.645045).  Saving model ...
Epoch: 3 cost time: 1.8774712085723877
Epoch: 3, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.477 Vali Acc: 0.785 Test Loss: 0.477 Test Acc: 0.785
Validation loss decreased (-0.645045 --> -0.784978).  Saving model ...
Epoch: 4 cost time: 1.9925053119659424
Epoch: 4, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.441 Vali Acc: 0.799 Test Loss: 0.441 Test Acc: 0.799
Validation loss decreased (-0.784978 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 2.2803683280944824
Epoch: 5, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.426 Vali Acc: 0.799 Test Loss: 0.426 Test Acc: 0.799
Validation loss decreased (-0.798630 --> -0.798631).  Saving model ...
Epoch: 6 cost time: 1.881932020187378
Epoch: 6, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.430 Vali Acc: 0.788 Test Loss: 0.430 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6817283630371094
Epoch: 7, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.436 Vali Acc: 0.778 Test Loss: 0.436 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9218623638153076
Epoch: 8, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.390 Vali Acc: 0.823 Test Loss: 0.390 Test Acc: 0.823
Validation loss decreased (-0.798631 --> -0.822522).  Saving model ...
Epoch: 9 cost time: 1.560476541519165
Epoch: 9, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.405 Vali Acc: 0.816 Test Loss: 0.405 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.740992784500122
Epoch: 10, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.360 Vali Acc: 0.846 Test Loss: 0.360 Test Acc: 0.846
Validation loss decreased (-0.822522 --> -0.846413).  Saving model ...
Epoch: 11 cost time: 1.5930676460266113
Epoch: 11, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8442256450653076
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7623872756958008
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.353 Vali Acc: 0.860 Test Loss: 0.353 Test Acc: 0.860
Validation loss decreased (-0.846413 --> -0.860065).  Saving model ...
Epoch: 14 cost time: 1.7743866443634033
Epoch: 14, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.400 Vali Acc: 0.819 Test Loss: 0.400 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9434535503387451
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.372 Vali Acc: 0.853 Test Loss: 0.372 Test Acc: 0.853
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9004693031311035
Epoch: 16, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7279725074768066
Epoch: 17, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.402 Vali Acc: 0.829 Test Loss: 0.402 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.865349292755127
Epoch: 18, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
Validation loss decreased (-0.860065 --> -0.870304).  Saving model ...
Epoch: 19 cost time: 1.529374361038208
Epoch: 19, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.818897008895874
Epoch: 20, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.415 Vali Acc: 0.826 Test Loss: 0.415 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.587186336517334
Epoch: 21, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.435 Vali Acc: 0.805 Test Loss: 0.435 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2367300987243652
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.351 Vali Acc: 0.877 Test Loss: 0.351 Test Acc: 0.877
Validation loss decreased (-0.870304 --> -0.877130).  Saving model ...
Epoch: 23 cost time: 1.7590968608856201
Epoch: 23, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.463 Vali Acc: 0.802 Test Loss: 0.463 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7026503086090088
Epoch: 24, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.406 Vali Acc: 0.829 Test Loss: 0.406 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7084009647369385
Epoch: 25, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.424 Vali Acc: 0.826 Test Loss: 0.424 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6848044395446777
Epoch: 26, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.442 Vali Acc: 0.819 Test Loss: 0.442 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.970557689666748
Epoch: 27, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.456 Vali Acc: 0.812 Test Loss: 0.456 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.122105121612549
Epoch: 28, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.414 Vali Acc: 0.860 Test Loss: 0.414 Test Acc: 0.860
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9192378520965576
Epoch: 29, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.451 Vali Acc: 0.823 Test Loss: 0.451 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5959556102752686
Epoch: 30, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.516 Vali Acc: 0.785 Test Loss: 0.516 Test Acc: 0.785
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8577122688293457
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.438 Vali Acc: 0.843 Test Loss: 0.438 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.0256476402282715
Epoch: 32, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8771331058020477
model parameter : 10034
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.51072883605957
Epoch: 1, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.800 Vali Acc: 0.410 Test Loss: 0.800 Test Acc: 0.410
Validation loss decreased (inf --> -0.409548).  Saving model ...
Epoch: 2 cost time: 1.6536328792572021
Epoch: 2, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.629 Vali Acc: 0.652 Test Loss: 0.629 Test Acc: 0.652
Validation loss decreased (-0.409548 --> -0.651871).  Saving model ...
Epoch: 3 cost time: 2.015899419784546
Epoch: 3, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.511 Vali Acc: 0.761 Test Loss: 0.511 Test Acc: 0.761
Validation loss decreased (-0.651871 --> -0.761087).  Saving model ...
Epoch: 4 cost time: 1.4367644786834717
Epoch: 4, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.450 Vali Acc: 0.765 Test Loss: 0.450 Test Acc: 0.765
Validation loss decreased (-0.761087 --> -0.764501).  Saving model ...
Epoch: 5 cost time: 1.7320752143859863
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.422 Vali Acc: 0.782 Test Loss: 0.422 Test Acc: 0.782
Validation loss decreased (-0.764501 --> -0.781566).  Saving model ...
Epoch: 6 cost time: 1.819063425064087
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.416 Vali Acc: 0.785 Test Loss: 0.416 Test Acc: 0.785
Validation loss decreased (-0.781566 --> -0.784979).  Saving model ...
Epoch: 7 cost time: 1.7319157123565674
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.448 Vali Acc: 0.771 Test Loss: 0.448 Test Acc: 0.771
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.253246545791626
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.382 Vali Acc: 0.840 Test Loss: 0.382 Test Acc: 0.840
Validation loss decreased (-0.784979 --> -0.839587).  Saving model ...
Epoch: 9 cost time: 1.8684728145599365
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.424 Vali Acc: 0.795 Test Loss: 0.424 Test Acc: 0.795
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.804520845413208
Epoch: 10, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.389 Vali Acc: 0.823 Test Loss: 0.389 Test Acc: 0.823
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8891875743865967
Epoch: 11, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.402 Vali Acc: 0.812 Test Loss: 0.402 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5469069480895996
Epoch: 12, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.429 Vali Acc: 0.799 Test Loss: 0.429 Test Acc: 0.799
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.778412103652954
Epoch: 13, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.387 Vali Acc: 0.836 Test Loss: 0.387 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5459668636322021
Epoch: 14, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.367 Vali Acc: 0.836 Test Loss: 0.367 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4887831211090088
Epoch: 15, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.457 Vali Acc: 0.788 Test Loss: 0.457 Test Acc: 0.788
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7137877941131592
Epoch: 16, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.400 Vali Acc: 0.836 Test Loss: 0.400 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.013310432434082
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.437 Vali Acc: 0.809 Test Loss: 0.437 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6854174137115479
Epoch: 18, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.436 Vali Acc: 0.805 Test Loss: 0.436 Test Acc: 0.805
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df128_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8395904436860068
model parameter : 10546
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.136147975921631
Epoch: 1, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.534 Vali Acc: 0.823 Test Loss: 0.534 Test Acc: 0.823
Validation loss decreased (inf --> -0.822520).  Saving model ...
Epoch: 2 cost time: 2.0662589073181152
Epoch: 2, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.452 Vali Acc: 0.792 Test Loss: 0.452 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9146642684936523
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.469 Vali Acc: 0.799 Test Loss: 0.469 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5404908657073975
Epoch: 4, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.420 Vali Acc: 0.805 Test Loss: 0.420 Test Acc: 0.805
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.552215576171875
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.440 Vali Acc: 0.785 Test Loss: 0.440 Test Acc: 0.785
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7986423969268799
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.470 Vali Acc: 0.795 Test Loss: 0.470 Test Acc: 0.795
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7690150737762451
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.469 Vali Acc: 0.802 Test Loss: 0.469 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8586094379425049
Epoch: 8, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.498 Vali Acc: 0.812 Test Loss: 0.498 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.15144681930542
Epoch: 9, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.449 Vali Acc: 0.829 Test Loss: 0.449 Test Acc: 0.829
Validation loss decreased (-0.822520 --> -0.829347).  Saving model ...
Epoch: 10 cost time: 1.7831859588623047
Epoch: 10, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.591 Vali Acc: 0.788 Test Loss: 0.591 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.728165626525879
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.561 Vali Acc: 0.802 Test Loss: 0.561 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6429483890533447
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.603 Vali Acc: 0.788 Test Loss: 0.603 Test Acc: 0.788
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6010138988494873
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.539 Vali Acc: 0.819 Test Loss: 0.539 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.396451473236084
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.595 Vali Acc: 0.809 Test Loss: 0.595 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.571082592010498
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.639 Vali Acc: 0.792 Test Loss: 0.639 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5977070331573486
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.655 Vali Acc: 0.799 Test Loss: 0.655 Test Acc: 0.799
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1177055835723877
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.715 Vali Acc: 0.795 Test Loss: 0.715 Test Acc: 0.795
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5006296634674072
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.757 Vali Acc: 0.792 Test Loss: 0.757 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7949213981628418
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8293515358361775
model parameter : 17890
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps45_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.601410627365112
Epoch: 1, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.627 Vali Acc: 0.683 Test Loss: 0.627 Test Acc: 0.683
Validation loss decreased (inf --> -0.682588).  Saving model ...
Epoch: 2 cost time: 1.411834716796875
Epoch: 2, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.470 Vali Acc: 0.785 Test Loss: 0.470 Test Acc: 0.785
Validation loss decreased (-0.682588 --> -0.784978).  Saving model ...
Epoch: 3 cost time: 1.3761212825775146
Epoch: 3, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.415 Vali Acc: 0.816 Test Loss: 0.415 Test Acc: 0.816
Validation loss decreased (-0.784978 --> -0.815696).  Saving model ...
Epoch: 4 cost time: 1.643934965133667
Epoch: 4, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.436 Vali Acc: 0.799 Test Loss: 0.436 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5525531768798828
Epoch: 5, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.441 Vali Acc: 0.812 Test Loss: 0.441 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1898915767669678
Epoch: 6, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.416 Vali Acc: 0.823 Test Loss: 0.416 Test Acc: 0.823
Validation loss decreased (-0.815696 --> -0.822521).  Saving model ...
Epoch: 7 cost time: 1.4490432739257812
Epoch: 7, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.442 Vali Acc: 0.805 Test Loss: 0.442 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2858374118804932
Epoch: 8, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.422 Vali Acc: 0.819 Test Loss: 0.422 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.246788501739502
Epoch: 9, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.464 Vali Acc: 0.782 Test Loss: 0.464 Test Acc: 0.782
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3513092994689941
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.416 Vali Acc: 0.826 Test Loss: 0.416 Test Acc: 0.826
Validation loss decreased (-0.822521 --> -0.825934).  Saving model ...
Epoch: 11 cost time: 1.5803515911102295
Epoch: 11, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (-0.825934 --> -0.832760).  Saving model ...
Epoch: 12 cost time: 1.4774913787841797
Epoch: 12, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.531 Vali Acc: 0.782 Test Loss: 0.531 Test Acc: 0.782
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4865362644195557
Epoch: 13, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.508 Vali Acc: 0.788 Test Loss: 0.508 Test Acc: 0.788
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.382549524307251
Epoch: 14, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.465 Vali Acc: 0.812 Test Loss: 0.465 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.437134027481079
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.487 Vali Acc: 0.812 Test Loss: 0.487 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.608001470565796
Epoch: 16, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.528 Vali Acc: 0.802 Test Loss: 0.528 Test Acc: 0.802
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5312604904174805
Epoch: 17, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.560 Vali Acc: 0.782 Test Loss: 0.560 Test Acc: 0.782
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6492831707000732
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.535 Vali Acc: 0.812 Test Loss: 0.535 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4151031970977783
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.594 Vali Acc: 0.802 Test Loss: 0.594 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.343130111694336
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.574 Vali Acc: 0.792 Test Loss: 0.574 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5229604244232178
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.583 Vali Acc: 0.795 Test Loss: 0.583 Test Acc: 0.795
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps45_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8327645051194539
model parameter : 11522
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps68_str34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 5.080012798309326
Epoch: 1, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.657 Vali Acc: 0.594 Test Loss: 0.657 Test Acc: 0.594
Validation loss decreased (inf --> -0.593850).  Saving model ...
Epoch: 2 cost time: 1.4330682754516602
Epoch: 2, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.473 Vali Acc: 0.799 Test Loss: 0.473 Test Acc: 0.799
Validation loss decreased (-0.593850 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 1.2339236736297607
Epoch: 3, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.423 Vali Acc: 0.819 Test Loss: 0.423 Test Acc: 0.819
Validation loss decreased (-0.798630 --> -0.819108).  Saving model ...
Epoch: 4 cost time: 1.1684703826904297
Epoch: 4, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.395 Vali Acc: 0.829 Test Loss: 0.395 Test Acc: 0.829
Validation loss decreased (-0.819108 --> -0.829348).  Saving model ...
Epoch: 5 cost time: 1.7526888847351074
Epoch: 5, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.419 Vali Acc: 0.816 Test Loss: 0.419 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0504472255706787
Epoch: 6, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.435 Vali Acc: 0.799 Test Loss: 0.435 Test Acc: 0.799
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4570410251617432
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.397 Vali Acc: 0.829 Test Loss: 0.397 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3263216018676758
Epoch: 8, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.378 Vali Acc: 0.836 Test Loss: 0.378 Test Acc: 0.836
Validation loss decreased (-0.829348 --> -0.836174).  Saving model ...
Epoch: 9 cost time: 1.595649242401123
Epoch: 9, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.465078353881836
Epoch: 10, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.428 Vali Acc: 0.812 Test Loss: 0.428 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.26202392578125
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1249566078186035
Epoch: 12, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.441 Vali Acc: 0.802 Test Loss: 0.441 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2687532901763916
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.464 Vali Acc: 0.792 Test Loss: 0.464 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.373946189880371
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.445 Vali Acc: 0.802 Test Loss: 0.445 Test Acc: 0.802
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3146543502807617
Epoch: 15, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.469 Vali Acc: 0.809 Test Loss: 0.469 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.596132755279541
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.466 Vali Acc: 0.802 Test Loss: 0.466 Test Acc: 0.802
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7825400829315186
Epoch: 17, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.452 Vali Acc: 0.805 Test Loss: 0.452 Test Acc: 0.805
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3288195133209229
Epoch: 18, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.509 Vali Acc: 0.799 Test Loss: 0.509 Test Acc: 0.799
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps68_str34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 9394
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps90_str45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.682181119918823
Epoch: 1, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.828 Vali Acc: 0.430 Test Loss: 0.828 Test Acc: 0.430
Validation loss decreased (inf --> -0.430026).  Saving model ...
Epoch: 2 cost time: 1.6066887378692627
Epoch: 2, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.593 Vali Acc: 0.679 Test Loss: 0.593 Test Acc: 0.679
Validation loss decreased (-0.430026 --> -0.679175).  Saving model ...
Epoch: 3 cost time: 1.5350565910339355
Epoch: 3, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.471 Vali Acc: 0.778 Test Loss: 0.471 Test Acc: 0.778
Validation loss decreased (-0.679175 --> -0.778152).  Saving model ...
Epoch: 4 cost time: 1.3551514148712158
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
Validation loss decreased (-0.778152 --> -0.815695).  Saving model ...
Epoch: 5 cost time: 1.7195649147033691
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.433 Vali Acc: 0.802 Test Loss: 0.433 Test Acc: 0.802
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8709337711334229
Epoch: 6, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.421 Vali Acc: 0.802 Test Loss: 0.421 Test Acc: 0.802
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7685143947601318
Epoch: 7, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.450 Vali Acc: 0.799 Test Loss: 0.450 Test Acc: 0.799
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8391945362091064
Epoch: 8, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.418 Vali Acc: 0.812 Test Loss: 0.418 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.206322193145752
Epoch: 9, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.404 Vali Acc: 0.829 Test Loss: 0.404 Test Acc: 0.829
Validation loss decreased (-0.815695 --> -0.829347).  Saving model ...
Epoch: 10 cost time: 1.6369404792785645
Epoch: 10, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.405 Vali Acc: 0.805 Test Loss: 0.405 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6990516185760498
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.401 Vali Acc: 0.829 Test Loss: 0.401 Test Acc: 0.829
Validation loss decreased (-0.829347 --> -0.829348).  Saving model ...
Epoch: 12 cost time: 1.8691904544830322
Epoch: 12, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.415 Vali Acc: 0.805 Test Loss: 0.415 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6091017723083496
Epoch: 13, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.417 Vali Acc: 0.812 Test Loss: 0.417 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5054564476013184
Epoch: 14, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.427 Vali Acc: 0.802 Test Loss: 0.427 Test Acc: 0.802
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6115245819091797
Epoch: 15, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.456 Vali Acc: 0.802 Test Loss: 0.456 Test Acc: 0.802
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.909792184829712
Epoch: 16, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.416 Vali Acc: 0.836 Test Loss: 0.416 Test Acc: 0.836
Validation loss decreased (-0.829348 --> -0.836173).  Saving model ...
Epoch: 17 cost time: 1.6717383861541748
Epoch: 17, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.425 Vali Acc: 0.816 Test Loss: 0.425 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0214335918426514
Epoch: 18, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.439 Vali Acc: 0.812 Test Loss: 0.439 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.630291223526001
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.480 Vali Acc: 0.795 Test Loss: 0.480 Test Acc: 0.795
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4560091495513916
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4754316806793213
Epoch: 21, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.489 Vali Acc: 0.805 Test Loss: 0.489 Test Acc: 0.805
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7303917407989502
Epoch: 22, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.488 Vali Acc: 0.812 Test Loss: 0.488 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.974829912185669
Epoch: 23, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.536 Vali Acc: 0.792 Test Loss: 0.536 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8396828174591064
Epoch: 24, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.478 Vali Acc: 0.809 Test Loss: 0.478 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5382254123687744
Epoch: 25, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.494 Vali Acc: 0.819 Test Loss: 0.494 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4998881816864014
Epoch: 26, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.532 Vali Acc: 0.809 Test Loss: 0.532 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps90_str45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8361774744027304
model parameter : 8402
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps135_str68_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 6.028351068496704
Epoch: 1, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (inf --> -0.740609).  Saving model ...
Epoch: 2 cost time: 1.5660772323608398
Epoch: 2, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.508 Vali Acc: 0.734 Test Loss: 0.508 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5707452297210693
Epoch: 3, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.468 Vali Acc: 0.775 Test Loss: 0.468 Test Acc: 0.775
Validation loss decreased (-0.740609 --> -0.774739).  Saving model ...
Epoch: 4 cost time: 1.653841495513916
Epoch: 4, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.440 Vali Acc: 0.799 Test Loss: 0.440 Test Acc: 0.799
Validation loss decreased (-0.774739 --> -0.798630).  Saving model ...
Epoch: 5 cost time: 1.5319359302520752
Epoch: 5, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.430 Vali Acc: 0.802 Test Loss: 0.430 Test Acc: 0.802
Validation loss decreased (-0.798630 --> -0.802043).  Saving model ...
Epoch: 6 cost time: 1.7698593139648438
Epoch: 6, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.383 Vali Acc: 0.823 Test Loss: 0.383 Test Acc: 0.823
Validation loss decreased (-0.802043 --> -0.822522).  Saving model ...
Epoch: 7 cost time: 1.8260304927825928
Epoch: 7, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.423 Vali Acc: 0.799 Test Loss: 0.423 Test Acc: 0.799
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7372081279754639
Epoch: 8, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.406 Vali Acc: 0.819 Test Loss: 0.406 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7813401222229004
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.399 Vali Acc: 0.816 Test Loss: 0.399 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.02878737449646
Epoch: 10, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.345 Vali Acc: 0.857 Test Loss: 0.345 Test Acc: 0.857
Validation loss decreased (-0.822522 --> -0.856652).  Saving model ...
Epoch: 11 cost time: 1.6951253414154053
Epoch: 11, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.375 Vali Acc: 0.829 Test Loss: 0.375 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6474523544311523
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.347 Vali Acc: 0.870 Test Loss: 0.347 Test Acc: 0.870
Validation loss decreased (-0.856652 --> -0.870304).  Saving model ...
Epoch: 13 cost time: 1.7934627532958984
Epoch: 13, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.407 Vali Acc: 0.819 Test Loss: 0.407 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.859828233718872
Epoch: 14, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.360 Vali Acc: 0.870 Test Loss: 0.360 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9556448459625244
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.853 Test Loss: 0.378 Test Acc: 0.853
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1857261657714844
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.379 Vali Acc: 0.846 Test Loss: 0.379 Test Acc: 0.846
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2010250091552734
Epoch: 17, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.371 Vali Acc: 0.860 Test Loss: 0.371 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6567795276641846
Epoch: 18, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.375 Vali Acc: 0.863 Test Loss: 0.375 Test Acc: 0.863
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.170886516571045
Epoch: 19, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.375 Vali Acc: 0.860 Test Loss: 0.375 Test Acc: 0.860
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5571303367614746
Epoch: 20, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.427 Vali Acc: 0.823 Test Loss: 0.427 Test Acc: 0.823
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.667431354522705
Epoch: 21, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.401 Vali Acc: 0.850 Test Loss: 0.401 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8836326599121094
Epoch: 22, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.392 Vali Acc: 0.850 Test Loss: 0.392 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps135_str68_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8703071672354948
model parameter : 7970
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps180_str90_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 4.068724155426025
Epoch: 1, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
Validation loss decreased (inf --> -0.761086).  Saving model ...
Epoch: 2 cost time: 1.9613335132598877
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.487 Vali Acc: 0.799 Test Loss: 0.487 Test Acc: 0.799
Validation loss decreased (-0.761086 --> -0.798630).  Saving model ...
Epoch: 3 cost time: 1.6441209316253662
Epoch: 3, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.447 Vali Acc: 0.799 Test Loss: 0.447 Test Acc: 0.799
Validation loss decreased (-0.798630 --> -0.798630).  Saving model ...
Epoch: 4 cost time: 1.829294204711914
Epoch: 4, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.418 Vali Acc: 0.816 Test Loss: 0.418 Test Acc: 0.816
Validation loss decreased (-0.798630 --> -0.815695).  Saving model ...
Epoch: 5 cost time: 1.564366340637207
Epoch: 5, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.398 Vali Acc: 0.819 Test Loss: 0.398 Test Acc: 0.819
Validation loss decreased (-0.815695 --> -0.819109).  Saving model ...
Epoch: 6 cost time: 1.692701816558838
Epoch: 6, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.449 Vali Acc: 0.788 Test Loss: 0.449 Test Acc: 0.788
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1767868995666504
Epoch: 7, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.401 Vali Acc: 0.805 Test Loss: 0.401 Test Acc: 0.805
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.837599515914917
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.397 Vali Acc: 0.819 Test Loss: 0.397 Test Acc: 0.819
Validation loss decreased (-0.819109 --> -0.819109).  Saving model ...
Epoch: 9 cost time: 1.9036543369293213
Epoch: 9, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.422 Vali Acc: 0.805 Test Loss: 0.422 Test Acc: 0.805
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9301042556762695
Epoch: 10, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.380 Vali Acc: 0.826 Test Loss: 0.380 Test Acc: 0.826
Validation loss decreased (-0.819109 --> -0.825935).  Saving model ...
Epoch: 11 cost time: 1.8189656734466553
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.379 Vali Acc: 0.826 Test Loss: 0.379 Test Acc: 0.826
Validation loss decreased (-0.825935 --> -0.825935).  Saving model ...
Epoch: 12 cost time: 1.8906683921813965
Epoch: 12, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.361 Vali Acc: 0.846 Test Loss: 0.361 Test Acc: 0.846
Validation loss decreased (-0.825935 --> -0.846413).  Saving model ...
Epoch: 13 cost time: 1.8126003742218018
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.406 Vali Acc: 0.829 Test Loss: 0.406 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9242265224456787
Epoch: 14, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.361 Vali Acc: 0.860 Test Loss: 0.361 Test Acc: 0.860
Validation loss decreased (-0.846413 --> -0.860065).  Saving model ...
Epoch: 15 cost time: 1.676135778427124
Epoch: 15, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9439749717712402
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.346 Vali Acc: 0.881 Test Loss: 0.346 Test Acc: 0.881
Validation loss decreased (-0.860065 --> -0.880543).  Saving model ...
Epoch: 17 cost time: 2.2135207653045654
Epoch: 17, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.374 Vali Acc: 0.836 Test Loss: 0.374 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.252546548843384
Epoch: 18, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.348 Vali Acc: 0.867 Test Loss: 0.348 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.801513433456421
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.406 Vali Acc: 0.840 Test Loss: 0.406 Test Acc: 0.840
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.819911241531372
Epoch: 20, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.356 Vali Acc: 0.863 Test Loss: 0.356 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8361940383911133
Epoch: 21, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.380 Vali Acc: 0.833 Test Loss: 0.380 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.325562000274658
Epoch: 22, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.397 Vali Acc: 0.843 Test Loss: 0.397 Test Acc: 0.843
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.22651743888855
Epoch: 23, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.397 Vali Acc: 0.846 Test Loss: 0.397 Test Acc: 0.846
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.271629571914673
Epoch: 24, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.367 Vali Acc: 0.860 Test Loss: 0.367 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8439607620239258
Epoch: 25, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.370 Vali Acc: 0.863 Test Loss: 0.370 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8869428634643555
Epoch: 26, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.420 Vali Acc: 0.823 Test Loss: 0.420 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps180_str90_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8805460750853242
model parameter : 7922
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SelfRegulationSCP1Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SelfRegulationSCP1/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

268
293
>>>>>>>start training : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps224_str112_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
268
293
293
Epoch: 1 cost time: 3.7953202724456787
Epoch: 1, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.693 Vali Acc: 0.597 Test Loss: 0.693 Test Acc: 0.597
Validation loss decreased (inf --> -0.597263).  Saving model ...
Epoch: 2 cost time: 1.4504590034484863
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.549 Vali Acc: 0.734 Test Loss: 0.549 Test Acc: 0.734
Validation loss decreased (-0.597263 --> -0.733783).  Saving model ...
Epoch: 3 cost time: 1.4619793891906738
Epoch: 3, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.482 Vali Acc: 0.758 Test Loss: 0.482 Test Acc: 0.758
Validation loss decreased (-0.733783 --> -0.757674).  Saving model ...
Epoch: 4 cost time: 1.4958264827728271
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.424 Vali Acc: 0.809 Test Loss: 0.424 Test Acc: 0.809
Validation loss decreased (-0.757674 --> -0.808869).  Saving model ...
Epoch: 5 cost time: 1.3640189170837402
Epoch: 5, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.408 Vali Acc: 0.823 Test Loss: 0.408 Test Acc: 0.823
Validation loss decreased (-0.808869 --> -0.822522).  Saving model ...
Epoch: 6 cost time: 1.3781416416168213
Epoch: 6, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.395 Vali Acc: 0.826 Test Loss: 0.395 Test Acc: 0.826
Validation loss decreased (-0.822522 --> -0.825935).  Saving model ...
Epoch: 7 cost time: 1.2913920879364014
Epoch: 7, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.386 Vali Acc: 0.829 Test Loss: 0.386 Test Acc: 0.829
Validation loss decreased (-0.825935 --> -0.829348).  Saving model ...
Epoch: 8 cost time: 1.1038084030151367
Epoch: 8, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.379 Vali Acc: 0.843 Test Loss: 0.379 Test Acc: 0.843
Validation loss decreased (-0.829348 --> -0.843000).  Saving model ...
Epoch: 9 cost time: 1.1448702812194824
Epoch: 9, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.405 Vali Acc: 0.823 Test Loss: 0.405 Test Acc: 0.823
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5146145820617676
Epoch: 10, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.375 Vali Acc: 0.853 Test Loss: 0.375 Test Acc: 0.853
Validation loss decreased (-0.843000 --> -0.853239).  Saving model ...
Epoch: 11 cost time: 1.2662689685821533
Epoch: 11, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.377 Vali Acc: 0.846 Test Loss: 0.377 Test Acc: 0.846
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5551402568817139
Epoch: 12, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.383 Vali Acc: 0.826 Test Loss: 0.383 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2089784145355225
Epoch: 13, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.577348232269287
Epoch: 14, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.379 Vali Acc: 0.840 Test Loss: 0.379 Test Acc: 0.840
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0591976642608643
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.389 Vali Acc: 0.826 Test Loss: 0.389 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4129564762115479
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.377 Vali Acc: 0.833 Test Loss: 0.377 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.470654010772705
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.407 Vali Acc: 0.823 Test Loss: 0.407 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.159374475479126
Epoch: 18, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.382 Vali Acc: 0.840 Test Loss: 0.382 Test Acc: 0.840
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5542185306549072
Epoch: 19, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.393 Vali Acc: 0.843 Test Loss: 0.393 Test Acc: 0.843
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3356211185455322
Epoch: 20, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.415 Vali Acc: 0.823 Test Loss: 0.415 Test Acc: 0.823
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SelfRegulationSCP1_PatchTST_UEA_ftM_sl896_ll0_pl0_el1_dm16_nh4_df64_ps224_str112_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
293
test shape: torch.Size([293, 2]) torch.Size([293, 1])
accuracy:0.8532423208191127
model parameter : 8434
model size : 0.35MB
