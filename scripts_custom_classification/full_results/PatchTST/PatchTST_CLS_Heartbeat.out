Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 12.558960676193237
Epoch: 1, Steps: 13 | Train Loss: 0.918 Vali Loss: 0.849 Vali Acc: 0.639 Test Loss: 0.849 Test Acc: 0.639
Validation loss decreased (inf --> -0.639016).  Saving model ...
Epoch: 2 cost time: 12.654839754104614
Epoch: 2, Steps: 13 | Train Loss: 0.368 Vali Loss: 1.628 Vali Acc: 0.698 Test Loss: 1.628 Test Acc: 0.698
Validation loss decreased (-0.639016 --> -0.697545).  Saving model ...
Epoch: 3 cost time: 12.302697658538818
Epoch: 3, Steps: 13 | Train Loss: 0.836 Vali Loss: 3.296 Vali Acc: 0.473 Test Loss: 3.296 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.19966721534729
Epoch: 4, Steps: 13 | Train Loss: 0.295 Vali Loss: 3.085 Vali Acc: 0.663 Test Loss: 3.085 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.423007488250732
Epoch: 5, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.683 Vali Acc: 0.605 Test Loss: 3.683 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.236824035644531
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 4.199 Vali Acc: 0.624 Test Loss: 4.199 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.802950859069824
Epoch: 7, Steps: 13 | Train Loss: 0.054 Vali Loss: 4.737 Vali Acc: 0.610 Test Loss: 4.737 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.646368741989136
Epoch: 8, Steps: 13 | Train Loss: 0.197 Vali Loss: 7.937 Vali Acc: 0.698 Test Loss: 7.937 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.100154161453247
Epoch: 9, Steps: 13 | Train Loss: 0.186 Vali Loss: 7.247 Vali Acc: 0.546 Test Loss: 7.247 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.625523090362549
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 12.194 Vali Acc: 0.424 Test Loss: 12.194 Test Acc: 0.424
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.4985990524292
Epoch: 11, Steps: 13 | Train Loss: 0.299 Vali Loss: 8.266 Vali Acc: 0.507 Test Loss: 8.266 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 13.084758520126343
Epoch: 12, Steps: 13 | Train Loss: 0.269 Vali Loss: 8.341 Vali Acc: 0.580 Test Loss: 8.341 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 1445378
model size : 7.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.922696113586426
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 6.974390506744385
Epoch: 2, Steps: 13 | Train Loss: 0.356 Vali Loss: 1.127 Vali Acc: 0.639 Test Loss: 1.127 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.9404919147491455
Epoch: 3, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.495 Vali Acc: 0.659 Test Loss: 1.495 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.252038240432739
Epoch: 4, Steps: 13 | Train Loss: 0.102 Vali Loss: 2.273 Vali Acc: 0.629 Test Loss: 2.273 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.00801682472229
Epoch: 5, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.657 Vali Acc: 0.605 Test Loss: 2.657 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.4986255168914795
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.138 Vali Acc: 0.649 Test Loss: 3.138 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.624109268188477
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 4.065 Vali Acc: 0.698 Test Loss: 4.065 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.714776992797852
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 4.134 Vali Acc: 0.688 Test Loss: 4.134 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.940191030502319
Epoch: 9, Steps: 13 | Train Loss: 0.061 Vali Loss: 4.705 Vali Acc: 0.712 Test Loss: 4.705 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.490602493286133
Epoch: 10, Steps: 13 | Train Loss: 0.060 Vali Loss: 5.773 Vali Acc: 0.688 Test Loss: 5.773 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.067179203033447
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 5.784 Vali Acc: 0.644 Test Loss: 5.784 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 962562
model size : 6.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.685630798339844
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.668 Vali Acc: 0.659 Test Loss: 0.668 Test Acc: 0.659
Validation loss decreased (inf --> -0.658530).  Saving model ...
Epoch: 2 cost time: 4.066731929779053
Epoch: 2, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.216 Vali Acc: 0.541 Test Loss: 1.216 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9601283073425293
Epoch: 3, Steps: 13 | Train Loss: 0.191 Vali Loss: 2.073 Vali Acc: 0.473 Test Loss: 2.073 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.46560263633728
Epoch: 4, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.942 Vali Acc: 0.605 Test Loss: 1.942 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.492727518081665
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 3.012 Vali Acc: 0.702 Test Loss: 3.012 Test Acc: 0.702
Validation loss decreased (-0.658530 --> -0.702409).  Saving model ...
Epoch: 6 cost time: 4.596499681472778
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.800 Vali Acc: 0.629 Test Loss: 2.800 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.536048650741577
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.937 Vali Acc: 0.527 Test Loss: 3.937 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.523558855056763
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.804 Vali Acc: 0.654 Test Loss: 3.804 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.541656494140625
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 3.987 Vali Acc: 0.644 Test Loss: 3.987 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.365117311477661
Epoch: 10, Steps: 13 | Train Loss: 0.032 Vali Loss: 4.603 Vali Acc: 0.663 Test Loss: 4.603 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.326452970504761
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 5.680 Vali Acc: 0.532 Test Loss: 5.680 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.989292860031128
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 5.242 Vali Acc: 0.649 Test Loss: 5.242 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.01275372505188
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 5.102 Vali Acc: 0.605 Test Loss: 5.102 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.283029556274414
Epoch: 14, Steps: 13 | Train Loss: 0.096 Vali Loss: 5.392 Vali Acc: 0.566 Test Loss: 5.392 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.484866142272949
Epoch: 15, Steps: 13 | Train Loss: 0.015 Vali Loss: 5.471 Vali Acc: 0.576 Test Loss: 5.471 Test Acc: 0.576
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 792066
model size : 5.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.5307159423828125
Epoch: 1, Steps: 13 | Train Loss: 0.762 Vali Loss: 0.699 Vali Acc: 0.610 Test Loss: 0.699 Test Acc: 0.610
Validation loss decreased (inf --> -0.609749).  Saving model ...
Epoch: 2 cost time: 3.695756673812866
Epoch: 2, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
Validation loss decreased (-0.609749 --> -0.687796).  Saving model ...
Epoch: 3 cost time: 3.6511383056640625
Epoch: 3, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.356 Vali Acc: 0.688 Test Loss: 1.356 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9055681228637695
Epoch: 4, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.710 Vali Acc: 0.541 Test Loss: 1.710 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.82623291015625
Epoch: 5, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.800 Vali Acc: 0.649 Test Loss: 1.800 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6510515213012695
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.244 Vali Acc: 0.688 Test Loss: 2.244 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7398059368133545
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.394 Vali Acc: 0.678 Test Loss: 2.394 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.572632312774658
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.659 Vali Acc: 0.659 Test Loss: 2.659 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5428683757781982
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.658 Vali Acc: 0.624 Test Loss: 2.658 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5079309940338135
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.680 Vali Acc: 0.634 Test Loss: 2.680 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.5391087532043457
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.716 Vali Acc: 0.634 Test Loss: 2.716 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.0807154178619385
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.710 Vali Acc: 0.634 Test Loss: 2.710 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 699650
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.111822128295898
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.670 Vali Acc: 0.620 Test Loss: 0.670 Test Acc: 0.620
Validation loss decreased (inf --> -0.619505).  Saving model ...
Epoch: 2 cost time: 3.2076478004455566
Epoch: 2, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.971 Vali Acc: 0.566 Test Loss: 0.971 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3370139598846436
Epoch: 3, Steps: 13 | Train Loss: 0.148 Vali Loss: 1.231 Vali Acc: 0.532 Test Loss: 1.231 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.057950258255005
Epoch: 4, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.712 Vali Acc: 0.449 Test Loss: 1.712 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8779802322387695
Epoch: 5, Steps: 13 | Train Loss: 0.134 Vali Loss: 2.444 Vali Acc: 0.454 Test Loss: 2.444 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.894017457962036
Epoch: 6, Steps: 13 | Train Loss: 0.052 Vali Loss: 2.066 Vali Acc: 0.663 Test Loss: 2.066 Test Acc: 0.663
Validation loss decreased (-0.619505 --> -0.663394).  Saving model ...
Epoch: 7 cost time: 3.0015251636505127
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.338 Vali Acc: 0.629 Test Loss: 2.338 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0747854709625244
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.483 Vali Acc: 0.561 Test Loss: 2.483 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9799323081970215
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.586 Vali Acc: 0.668 Test Loss: 2.586 Test Acc: 0.668
Validation loss decreased (-0.663394 --> -0.668267).  Saving model ...
Epoch: 10 cost time: 2.8883612155914307
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.544 Vali Acc: 0.644 Test Loss: 2.544 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8780086040496826
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.583 Vali Acc: 0.644 Test Loss: 2.583 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8691368103027344
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.924 Vali Acc: 0.659 Test Loss: 2.924 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.312986373901367
Epoch: 13, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.178 Vali Acc: 0.620 Test Loss: 3.178 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2368273735046387
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.002 Vali Acc: 0.668 Test Loss: 3.002 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.228553533554077
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.077 Vali Acc: 0.649 Test Loss: 3.077 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.098917245864868
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.190 Vali Acc: 0.629 Test Loss: 3.190 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.186218023300171
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.345 Vali Acc: 0.634 Test Loss: 3.345 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9700329303741455
Epoch: 18, Steps: 13 | Train Loss: 0.009 Vali Loss: 3.959 Vali Acc: 0.654 Test Loss: 3.959 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0696189403533936
Epoch: 19, Steps: 13 | Train Loss: 0.057 Vali Loss: 4.750 Vali Acc: 0.556 Test Loss: 4.750 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6682926829268293
model parameter : 608514
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.414361000061035
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.293581247329712
Epoch: 2, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.782 Vali Acc: 0.620 Test Loss: 0.782 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3376734256744385
Epoch: 3, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.923 Vali Acc: 0.644 Test Loss: 0.923 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4216463565826416
Epoch: 4, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.149 Vali Acc: 0.659 Test Loss: 1.149 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.526071310043335
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.427 Vali Acc: 0.663 Test Loss: 1.427 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3285696506500244
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.530 Vali Acc: 0.634 Test Loss: 1.530 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5567734241485596
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.644 Test Loss: 1.671 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.500324249267578
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.703 Vali Acc: 0.615 Test Loss: 1.703 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5094523429870605
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.755 Vali Acc: 0.620 Test Loss: 1.755 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6135897636413574
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.639 Test Loss: 1.796 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4940505027770996
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.629 Test Loss: 1.815 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 548610
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.307224750518799
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 0.684 Vali Acc: 0.722 Test Loss: 0.684 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.582564115524292
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.701 Vali Acc: 0.624 Test Loss: 0.701 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7733564376831055
Epoch: 3, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.889 Vali Acc: 0.551 Test Loss: 0.889 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.614870071411133
Epoch: 4, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.182 Vali Acc: 0.663 Test Loss: 1.182 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5963099002838135
Epoch: 5, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.363 Vali Acc: 0.620 Test Loss: 1.363 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.736879587173462
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.448 Vali Acc: 0.639 Test Loss: 1.448 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5996601581573486
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.496 Vali Acc: 0.629 Test Loss: 1.496 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.650852918624878
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.630 Vali Acc: 0.654 Test Loss: 1.630 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8657662868499756
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.620 Test Loss: 1.714 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6617043018341064
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.610 Test Loss: 1.770 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5729126930236816
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.629 Test Loss: 1.796 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 520066
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.897457838058472
Epoch: 1, Steps: 13 | Train Loss: 0.953 Vali Loss: 2.515 Vali Acc: 0.288 Test Loss: 2.515 Test Acc: 0.288
Validation loss decreased (inf --> -0.287780).  Saving model ...
Epoch: 2 cost time: 9.872776508331299
Epoch: 2, Steps: 13 | Train Loss: 0.654 Vali Loss: 3.175 Vali Acc: 0.429 Test Loss: 3.175 Test Acc: 0.429
Validation loss decreased (-0.287780 --> -0.429237).  Saving model ...
Epoch: 3 cost time: 9.249675750732422
Epoch: 3, Steps: 13 | Train Loss: 0.621 Vali Loss: 2.494 Vali Acc: 0.702 Test Loss: 2.494 Test Acc: 0.702
Validation loss decreased (-0.429237 --> -0.702414).  Saving model ...
Epoch: 4 cost time: 8.50634503364563
Epoch: 4, Steps: 13 | Train Loss: 0.631 Vali Loss: 3.303 Vali Acc: 0.639 Test Loss: 3.303 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.54498815536499
Epoch: 5, Steps: 13 | Train Loss: 0.260 Vali Loss: 4.096 Vali Acc: 0.556 Test Loss: 4.096 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.801171064376831
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 6.247 Vali Acc: 0.483 Test Loss: 6.247 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.697166919708252
Epoch: 7, Steps: 13 | Train Loss: 0.279 Vali Loss: 6.609 Vali Acc: 0.551 Test Loss: 6.609 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.206103086471558
Epoch: 8, Steps: 13 | Train Loss: 0.497 Vali Loss: 7.309 Vali Acc: 0.532 Test Loss: 7.309 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.322557926177979
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 8.270 Vali Acc: 0.517 Test Loss: 8.270 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.300075054168701
Epoch: 10, Steps: 13 | Train Loss: 0.080 Vali Loss: 10.939 Vali Acc: 0.493 Test Loss: 10.939 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.186746835708618
Epoch: 11, Steps: 13 | Train Loss: 0.145 Vali Loss: 9.191 Vali Acc: 0.639 Test Loss: 9.191 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.64853286743164
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 10.874 Vali Acc: 0.659 Test Loss: 10.874 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 9.207792282104492
Epoch: 13, Steps: 13 | Train Loss: 0.028 Vali Loss: 11.053 Vali Acc: 0.634 Test Loss: 11.053 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 1346690
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.38336443901062
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.781 Vali Acc: 0.707 Test Loss: 0.781 Test Acc: 0.707
Validation loss decreased (inf --> -0.707309).  Saving model ...
Epoch: 2 cost time: 5.2480762004852295
Epoch: 2, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.887 Vali Acc: 0.439 Test Loss: 1.887 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.490959405899048
Epoch: 3, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.748 Vali Acc: 0.654 Test Loss: 1.748 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.290415525436401
Epoch: 4, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.415 Vali Acc: 0.590 Test Loss: 2.415 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.278287887573242
Epoch: 5, Steps: 13 | Train Loss: 0.177 Vali Loss: 3.158 Vali Acc: 0.678 Test Loss: 3.158 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.802488327026367
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 3.329 Vali Acc: 0.654 Test Loss: 3.329 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.012974977493286
Epoch: 7, Steps: 13 | Train Loss: 0.081 Vali Loss: 4.917 Vali Acc: 0.668 Test Loss: 4.917 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.866727352142334
Epoch: 8, Steps: 13 | Train Loss: 0.083 Vali Loss: 4.450 Vali Acc: 0.546 Test Loss: 4.450 Test Acc: 0.546
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.675920724868774
Epoch: 9, Steps: 13 | Train Loss: 0.087 Vali Loss: 5.071 Vali Acc: 0.580 Test Loss: 5.071 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.211365699768066
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 5.183 Vali Acc: 0.615 Test Loss: 5.183 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.1595823764801025
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 5.352 Vali Acc: 0.580 Test Loss: 5.352 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 863874
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0654518604278564
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.718 Vali Acc: 0.620 Test Loss: 0.718 Test Acc: 0.620
Validation loss decreased (inf --> -0.619505).  Saving model ...
Epoch: 2 cost time: 3.462265729904175
Epoch: 2, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.089 Vali Acc: 0.688 Test Loss: 1.089 Test Acc: 0.688
Validation loss decreased (-0.619505 --> -0.687794).  Saving model ...
Epoch: 3 cost time: 3.4127657413482666
Epoch: 3, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.565 Vali Acc: 0.659 Test Loss: 1.565 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7566614151000977
Epoch: 4, Steps: 13 | Train Loss: 0.047 Vali Loss: 2.181 Vali Acc: 0.566 Test Loss: 2.181 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.765564441680908
Epoch: 5, Steps: 13 | Train Loss: 0.031 Vali Loss: 3.050 Vali Acc: 0.449 Test Loss: 3.050 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.566619396209717
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 3.803 Vali Acc: 0.468 Test Loss: 3.803 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5722761154174805
Epoch: 7, Steps: 13 | Train Loss: 0.295 Vali Loss: 3.028 Vali Acc: 0.624 Test Loss: 3.028 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5432684421539307
Epoch: 8, Steps: 13 | Train Loss: 0.209 Vali Loss: 4.279 Vali Acc: 0.673 Test Loss: 4.279 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5537021160125732
Epoch: 9, Steps: 13 | Train Loss: 0.067 Vali Loss: 4.425 Vali Acc: 0.595 Test Loss: 4.425 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.7769196033477783
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.663 Vali Acc: 0.663 Test Loss: 4.663 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.474457025527954
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.511 Vali Acc: 0.615 Test Loss: 4.511 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.66253924369812
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.935 Vali Acc: 0.683 Test Loss: 4.935 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 693378
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.048867464065552
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 3.053239107131958
Epoch: 2, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.902 Vali Acc: 0.683 Test Loss: 0.902 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0068490505218506
Epoch: 3, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.928 Vali Acc: 0.429 Test Loss: 1.928 Test Acc: 0.429
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8528244495391846
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.640 Vali Acc: 0.556 Test Loss: 1.640 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8886148929595947
Epoch: 5, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.811 Vali Acc: 0.659 Test Loss: 1.811 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0199902057647705
Epoch: 6, Steps: 13 | Train Loss: 0.206 Vali Loss: 3.032 Vali Acc: 0.707 Test Loss: 3.032 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9984798431396484
Epoch: 7, Steps: 13 | Train Loss: 0.114 Vali Loss: 2.762 Vali Acc: 0.663 Test Loss: 2.762 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2347638607025146
Epoch: 8, Steps: 13 | Train Loss: 0.027 Vali Loss: 5.300 Vali Acc: 0.415 Test Loss: 5.300 Test Acc: 0.415
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.9005606174468994
Epoch: 9, Steps: 13 | Train Loss: 0.081 Vali Loss: 3.683 Vali Acc: 0.688 Test Loss: 3.683 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.458293914794922
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.269 Vali Acc: 0.629 Test Loss: 3.269 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0924510955810547
Epoch: 11, Steps: 13 | Train Loss: 0.018 Vali Loss: 4.363 Vali Acc: 0.698 Test Loss: 4.363 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 600962
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.550044536590576
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.822 Vali Acc: 0.478 Test Loss: 0.822 Test Acc: 0.478
Validation loss decreased (inf --> -0.478041).  Saving model ...
Epoch: 2 cost time: 2.3155877590179443
Epoch: 2, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.913 Vali Acc: 0.580 Test Loss: 0.913 Test Acc: 0.580
Validation loss decreased (-0.478041 --> -0.580479).  Saving model ...
Epoch: 3 cost time: 2.4185614585876465
Epoch: 3, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.186 Vali Acc: 0.561 Test Loss: 1.186 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.315105676651001
Epoch: 4, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.462 Vali Acc: 0.532 Test Loss: 1.462 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.335840940475464
Epoch: 5, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.494 Vali Acc: 0.629 Test Loss: 1.494 Test Acc: 0.629
Validation loss decreased (-0.580479 --> -0.629253).  Saving model ...
Epoch: 6 cost time: 2.254035711288452
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.706 Vali Acc: 0.600 Test Loss: 1.706 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.428286075592041
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.985 Vali Acc: 0.576 Test Loss: 1.985 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2604451179504395
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.119 Vali Acc: 0.659 Test Loss: 2.119 Test Acc: 0.659
Validation loss decreased (-0.629253 --> -0.658515).  Saving model ...
Epoch: 9 cost time: 2.1364924907684326
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.335 Vali Acc: 0.659 Test Loss: 2.335 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.497079610824585
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.340 Vali Acc: 0.629 Test Loss: 2.340 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3932063579559326
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.354 Vali Acc: 0.639 Test Loss: 2.354 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3981611728668213
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.346 Vali Acc: 0.620 Test Loss: 2.346 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3978469371795654
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.639 Test Loss: 2.369 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.483222246170044
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.365 Vali Acc: 0.620 Test Loss: 2.365 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.450359582901001
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.366 Vali Acc: 0.615 Test Loss: 2.366 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4041481018066406
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.615 Test Loss: 2.370 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4340262413024902
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.386 Vali Acc: 0.634 Test Loss: 2.386 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.510624885559082
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.389 Vali Acc: 0.624 Test Loss: 2.389 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6585365853658537
model parameter : 509826
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.02349066734314
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.2147533893585205
Epoch: 2, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.759 Vali Acc: 0.615 Test Loss: 0.759 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1083977222442627
Epoch: 3, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.930 Vali Acc: 0.649 Test Loss: 0.930 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1876766681671143
Epoch: 4, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.228 Vali Acc: 0.629 Test Loss: 1.228 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1119384765625
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.438 Vali Acc: 0.663 Test Loss: 1.438 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.050431966781616
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.677 Vali Acc: 0.610 Test Loss: 1.677 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2916765213012695
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.772 Vali Acc: 0.615 Test Loss: 1.772 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.064344644546509
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.852 Vali Acc: 0.571 Test Loss: 1.852 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1870200634002686
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.629 Test Loss: 1.854 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.059570789337158
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.890 Vali Acc: 0.649 Test Loss: 1.890 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.157426118850708
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.639 Test Loss: 1.903 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 449922
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5399956703186035
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.8987131118774414
Epoch: 2, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.822 Vali Acc: 0.566 Test Loss: 0.822 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.947131872177124
Epoch: 3, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.843 Vali Acc: 0.639 Test Loss: 0.843 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.921719551086426
Epoch: 4, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.196 Vali Acc: 0.698 Test Loss: 1.196 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9236648082733154
Epoch: 5, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.302 Vali Acc: 0.678 Test Loss: 1.302 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.865367889404297
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.599 Vali Acc: 0.537 Test Loss: 1.599 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.721242904663086
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.613 Vali Acc: 0.683 Test Loss: 1.613 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.761422634124756
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.696 Vali Acc: 0.663 Test Loss: 1.696 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6144564151763916
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.764 Vali Acc: 0.659 Test Loss: 1.764 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8343846797943115
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.891 Vali Acc: 0.649 Test Loss: 1.891 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.679633617401123
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.972 Vali Acc: 0.668 Test Loss: 1.972 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 421378
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.562005043029785
Epoch: 1, Steps: 13 | Train Loss: 0.828 Vali Loss: 0.825 Vali Acc: 0.576 Test Loss: 0.825 Test Acc: 0.576
Validation loss decreased (inf --> -0.575602).  Saving model ...
Epoch: 2 cost time: 10.456339836120605
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 1.589 Vali Acc: 0.663 Test Loss: 1.589 Test Acc: 0.663
Validation loss decreased (-0.575602 --> -0.663399).  Saving model ...
Epoch: 3 cost time: 10.911359310150146
Epoch: 3, Steps: 13 | Train Loss: 0.304 Vali Loss: 2.887 Vali Acc: 0.673 Test Loss: 2.887 Test Acc: 0.673
Validation loss decreased (-0.663399 --> -0.673142).  Saving model ...
Epoch: 4 cost time: 10.580283641815186
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 6.520 Vali Acc: 0.420 Test Loss: 6.520 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.550601243972778
Epoch: 5, Steps: 13 | Train Loss: 0.623 Vali Loss: 4.343 Vali Acc: 0.688 Test Loss: 4.343 Test Acc: 0.688
Validation loss decreased (-0.673142 --> -0.687761).  Saving model ...
Epoch: 6 cost time: 9.329079627990723
Epoch: 6, Steps: 13 | Train Loss: 0.617 Vali Loss: 4.682 Vali Acc: 0.698 Test Loss: 4.682 Test Acc: 0.698
Validation loss decreased (-0.687761 --> -0.697514).  Saving model ...
Epoch: 7 cost time: 9.103140830993652
Epoch: 7, Steps: 13 | Train Loss: 0.137 Vali Loss: 5.541 Vali Acc: 0.615 Test Loss: 5.541 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.632088899612427
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 5.902 Vali Acc: 0.649 Test Loss: 5.902 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.441608667373657
Epoch: 9, Steps: 13 | Train Loss: 0.121 Vali Loss: 7.722 Vali Acc: 0.522 Test Loss: 7.722 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.538809061050415
Epoch: 10, Steps: 13 | Train Loss: 0.230 Vali Loss: 10.022 Vali Acc: 0.454 Test Loss: 10.022 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.482723474502563
Epoch: 11, Steps: 13 | Train Loss: 0.494 Vali Loss: 10.874 Vali Acc: 0.463 Test Loss: 10.874 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.29590129852295
Epoch: 12, Steps: 13 | Train Loss: 0.181 Vali Loss: 9.029 Vali Acc: 0.580 Test Loss: 9.029 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.174480438232422
Epoch: 13, Steps: 13 | Train Loss: 0.396 Vali Loss: 10.971 Vali Acc: 0.507 Test Loss: 10.971 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.158619403839111
Epoch: 14, Steps: 13 | Train Loss: 0.243 Vali Loss: 10.065 Vali Acc: 0.580 Test Loss: 10.065 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.358956098556519
Epoch: 15, Steps: 13 | Train Loss: 0.864 Vali Loss: 11.786 Vali Acc: 0.673 Test Loss: 11.786 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.191187620162964
Epoch: 16, Steps: 13 | Train Loss: 0.137 Vali Loss: 10.913 Vali Acc: 0.615 Test Loss: 10.913 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 1297346
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.886608123779297
Epoch: 1, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.678 Vali Acc: 0.327 Test Loss: 1.678 Test Acc: 0.327
Validation loss decreased (inf --> -0.326812).  Saving model ...
Epoch: 2 cost time: 5.4810850620269775
Epoch: 2, Steps: 13 | Train Loss: 0.975 Vali Loss: 3.285 Vali Acc: 0.327 Test Loss: 3.285 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.661956787109375
Epoch: 3, Steps: 13 | Train Loss: 0.376 Vali Loss: 2.049 Vali Acc: 0.698 Test Loss: 2.049 Test Acc: 0.698
Validation loss decreased (-0.326812 --> -0.697540).  Saving model ...
Epoch: 4 cost time: 5.453405380249023
Epoch: 4, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.115 Vali Acc: 0.566 Test Loss: 2.115 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.1593241691589355
Epoch: 5, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.904 Vali Acc: 0.707 Test Loss: 2.904 Test Acc: 0.707
Validation loss decreased (-0.697540 --> -0.707288).  Saving model ...
Epoch: 6 cost time: 5.354504585266113
Epoch: 6, Steps: 13 | Train Loss: 0.082 Vali Loss: 3.515 Vali Acc: 0.668 Test Loss: 3.515 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.488285303115845
Epoch: 7, Steps: 13 | Train Loss: 0.155 Vali Loss: 4.130 Vali Acc: 0.546 Test Loss: 4.130 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.439484357833862
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 4.075 Vali Acc: 0.649 Test Loss: 4.075 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.245173215866089
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.309 Vali Acc: 0.590 Test Loss: 4.309 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.493270635604858
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 4.641 Vali Acc: 0.605 Test Loss: 4.641 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.7363269329071045
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 4.872 Vali Acc: 0.654 Test Loss: 4.872 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.335451364517212
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 4.849 Vali Acc: 0.615 Test Loss: 4.849 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.866276025772095
Epoch: 13, Steps: 13 | Train Loss: 0.039 Vali Loss: 5.975 Vali Acc: 0.620 Test Loss: 5.975 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.427755117416382
Epoch: 14, Steps: 13 | Train Loss: 0.012 Vali Loss: 6.810 Vali Acc: 0.659 Test Loss: 6.810 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.6283323764801025
Epoch: 15, Steps: 13 | Train Loss: 0.026 Vali Loss: 6.805 Vali Acc: 0.644 Test Loss: 6.805 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 814530
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.686938047409058
Epoch: 1, Steps: 13 | Train Loss: 0.783 Vali Loss: 1.031 Vali Acc: 0.424 Test Loss: 1.031 Test Acc: 0.424
Validation loss decreased (inf --> -0.424380).  Saving model ...
Epoch: 2 cost time: 3.7963809967041016
Epoch: 2, Steps: 13 | Train Loss: 0.353 Vali Loss: 1.358 Vali Acc: 0.702 Test Loss: 1.358 Test Acc: 0.702
Validation loss decreased (-0.424380 --> -0.702425).  Saving model ...
Epoch: 3 cost time: 3.7349162101745605
Epoch: 3, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.888 Vali Acc: 0.698 Test Loss: 1.888 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.761073589324951
Epoch: 4, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.115 Vali Acc: 0.698 Test Loss: 2.115 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.036267042160034
Epoch: 5, Steps: 13 | Train Loss: 0.037 Vali Loss: 2.339 Vali Acc: 0.649 Test Loss: 2.339 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.767779588699341
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.922 Vali Acc: 0.688 Test Loss: 2.922 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.63757586479187
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.655 Vali Acc: 0.620 Test Loss: 2.655 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.668189525604248
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.127 Vali Acc: 0.615 Test Loss: 3.127 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.098217964172363
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.762 Vali Acc: 0.620 Test Loss: 3.762 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9922056198120117
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 3.739 Vali Acc: 0.659 Test Loss: 3.739 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7706069946289062
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 4.070 Vali Acc: 0.605 Test Loss: 4.070 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.92039155960083
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 4.647 Vali Acc: 0.566 Test Loss: 4.647 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 644034
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.980723857879639
Epoch: 1, Steps: 13 | Train Loss: 0.761 Vali Loss: 1.638 Vali Acc: 0.278 Test Loss: 1.638 Test Acc: 0.278
Validation loss decreased (inf --> -0.278032).  Saving model ...
Epoch: 2 cost time: 3.1982741355895996
Epoch: 2, Steps: 13 | Train Loss: 0.617 Vali Loss: 1.449 Vali Acc: 0.444 Test Loss: 1.449 Test Acc: 0.444
Validation loss decreased (-0.278032 --> -0.443888).  Saving model ...
Epoch: 3 cost time: 3.154836893081665
Epoch: 3, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.137 Vali Acc: 0.673 Test Loss: 1.137 Test Acc: 0.673
Validation loss decreased (-0.443888 --> -0.673159).  Saving model ...
Epoch: 4 cost time: 3.1179051399230957
Epoch: 4, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.756 Vali Acc: 0.678 Test Loss: 1.756 Test Acc: 0.678
Validation loss decreased (-0.673159 --> -0.678031).  Saving model ...
Epoch: 5 cost time: 3.0995054244995117
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.046 Vali Acc: 0.693 Test Loss: 2.046 Test Acc: 0.693
Validation loss decreased (-0.678031 --> -0.692662).  Saving model ...
Epoch: 6 cost time: 3.0860395431518555
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.281 Vali Acc: 0.693 Test Loss: 2.281 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4945859909057617
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.806 Vali Acc: 0.688 Test Loss: 2.806 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.302030086517334
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.919 Vali Acc: 0.654 Test Loss: 2.919 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.918625593185425
Epoch: 9, Steps: 13 | Train Loss: 0.025 Vali Loss: 3.249 Vali Acc: 0.654 Test Loss: 3.249 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0334174633026123
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 4.009 Vali Acc: 0.707 Test Loss: 4.009 Test Acc: 0.707
Validation loss decreased (-0.692662 --> -0.707277).  Saving model ...
Epoch: 11 cost time: 3.165295124053955
Epoch: 11, Steps: 13 | Train Loss: 0.024 Vali Loss: 3.362 Vali Acc: 0.654 Test Loss: 3.362 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9156088829040527
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.707 Vali Acc: 0.634 Test Loss: 3.707 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1747915744781494
Epoch: 13, Steps: 13 | Train Loss: 0.009 Vali Loss: 5.269 Vali Acc: 0.468 Test Loss: 5.269 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8999245166778564
Epoch: 14, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.821 Vali Acc: 0.590 Test Loss: 3.821 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.22149920463562
Epoch: 15, Steps: 13 | Train Loss: 0.025 Vali Loss: 3.795 Vali Acc: 0.683 Test Loss: 3.795 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3247387409210205
Epoch: 16, Steps: 13 | Train Loss: 0.079 Vali Loss: 4.132 Vali Acc: 0.610 Test Loss: 4.132 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.64373779296875
Epoch: 17, Steps: 13 | Train Loss: 0.006 Vali Loss: 4.393 Vali Acc: 0.649 Test Loss: 4.393 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2236828804016113
Epoch: 18, Steps: 13 | Train Loss: 0.029 Vali Loss: 6.809 Vali Acc: 0.702 Test Loss: 6.809 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.5335423946380615
Epoch: 19, Steps: 13 | Train Loss: 0.066 Vali Loss: 5.466 Vali Acc: 0.629 Test Loss: 5.466 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.317159414291382
Epoch: 20, Steps: 13 | Train Loss: 0.042 Vali Loss: 6.784 Vali Acc: 0.483 Test Loss: 6.784 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 551618
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.0575830936431885
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.688 Vali Acc: 0.585 Test Loss: 0.688 Test Acc: 0.585
Validation loss decreased (inf --> -0.585359).  Saving model ...
Epoch: 2 cost time: 2.5697364807128906
Epoch: 2, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.788 Vali Acc: 0.673 Test Loss: 0.788 Test Acc: 0.673
Validation loss decreased (-0.585359 --> -0.673163).  Saving model ...
Epoch: 3 cost time: 2.3791890144348145
Epoch: 3, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.139 Vali Acc: 0.556 Test Loss: 1.139 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.319404125213623
Epoch: 4, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.273 Vali Acc: 0.688 Test Loss: 1.273 Test Acc: 0.688
Validation loss decreased (-0.673163 --> -0.687792).  Saving model ...
Epoch: 5 cost time: 2.442570924758911
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.867 Vali Acc: 0.546 Test Loss: 1.867 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.603376865386963
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.236 Vali Acc: 0.512 Test Loss: 2.236 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.913821220397949
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.022 Vali Acc: 0.610 Test Loss: 2.022 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.643099069595337
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.226 Vali Acc: 0.580 Test Loss: 2.226 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.709739923477173
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.518 Vali Acc: 0.649 Test Loss: 2.518 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6100587844848633
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.461 Vali Acc: 0.566 Test Loss: 2.461 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6479008197784424
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.598 Vali Acc: 0.639 Test Loss: 2.598 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6569039821624756
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.605 Vali Acc: 0.556 Test Loss: 2.605 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7197017669677734
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.590 Vali Acc: 0.629 Test Loss: 2.590 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7277474403381348
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.634 Test Loss: 2.639 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 460482
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.349456310272217
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.643 Vali Acc: 0.649 Test Loss: 0.643 Test Acc: 0.649
Validation loss decreased (inf --> -0.648774).  Saving model ...
Epoch: 2 cost time: 2.097778797149658
Epoch: 2, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.842 Vali Acc: 0.556 Test Loss: 0.842 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3326539993286133
Epoch: 3, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.976 Vali Acc: 0.610 Test Loss: 0.976 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3267884254455566
Epoch: 4, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.417 Vali Acc: 0.478 Test Loss: 1.417 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.013993740081787
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.553 Vali Acc: 0.663 Test Loss: 1.553 Test Acc: 0.663
Validation loss decreased (-0.648774 --> -0.663399).  Saving model ...
Epoch: 6 cost time: 2.034879684448242
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.726 Vali Acc: 0.673 Test Loss: 1.726 Test Acc: 0.673
Validation loss decreased (-0.663399 --> -0.673153).  Saving model ...
Epoch: 7 cost time: 2.348710536956787
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.325 Vali Acc: 0.473 Test Loss: 2.325 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.445674419403076
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.136 Vali Acc: 0.649 Test Loss: 2.136 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.271019220352173
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.399 Vali Acc: 0.659 Test Loss: 2.399 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.49373722076416
Epoch: 10, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.442 Vali Acc: 0.537 Test Loss: 2.442 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.390193223953247
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.443 Vali Acc: 0.615 Test Loss: 2.443 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.383936882019043
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.455 Vali Acc: 0.624 Test Loss: 2.455 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6926605701446533
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.472 Vali Acc: 0.629 Test Loss: 2.472 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.338900566101074
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.629 Test Loss: 2.471 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2419373989105225
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.476 Vali Acc: 0.629 Test Loss: 2.476 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.12440824508667
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.629 Test Loss: 2.488 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6731707317073171
model parameter : 400578
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.939713001251221
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.634 Vali Acc: 0.707 Test Loss: 0.634 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.8103525638580322
Epoch: 2, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.745 Vali Acc: 0.668 Test Loss: 0.745 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.749803066253662
Epoch: 3, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.929 Vali Acc: 0.585 Test Loss: 0.929 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3618907928466797
Epoch: 4, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.529231071472168
Epoch: 5, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.439 Vali Acc: 0.668 Test Loss: 1.439 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.27302885055542
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.524 Vali Acc: 0.649 Test Loss: 1.524 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.32926869392395
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.607 Vali Acc: 0.600 Test Loss: 1.607 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.428570032119751
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.743 Vali Acc: 0.610 Test Loss: 1.743 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8476250171661377
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.654 Test Loss: 1.836 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.682952404022217
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.644 Test Loss: 1.850 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.592491865158081
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.615 Test Loss: 1.844 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm128_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 372034
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 11.273042917251587
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.931 Vali Acc: 0.420 Test Loss: 0.931 Test Acc: 0.420
Validation loss decreased (inf --> -0.419503).  Saving model ...
Epoch: 2 cost time: 8.71389126777649
Epoch: 2, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.107 Vali Acc: 0.693 Test Loss: 1.107 Test Acc: 0.693
Validation loss decreased (-0.419503 --> -0.692672).  Saving model ...
Epoch: 3 cost time: 9.35876178741455
Epoch: 3, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.600 Vali Acc: 0.502 Test Loss: 1.600 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.795112133026123
Epoch: 4, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.176 Vali Acc: 0.678 Test Loss: 2.176 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.976284503936768
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 3.565 Vali Acc: 0.434 Test Loss: 3.565 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.069666624069214
Epoch: 6, Steps: 13 | Train Loss: 0.103 Vali Loss: 3.553 Vali Acc: 0.683 Test Loss: 3.553 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.970248222351074
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.603 Vali Acc: 0.668 Test Loss: 3.603 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.036240577697754
Epoch: 8, Steps: 13 | Train Loss: 0.067 Vali Loss: 3.462 Vali Acc: 0.610 Test Loss: 3.462 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.015826225280762
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.592 Vali Acc: 0.654 Test Loss: 3.592 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 8.864896774291992
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.768 Vali Acc: 0.639 Test Loss: 3.768 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 8.39387845993042
Epoch: 11, Steps: 13 | Train Loss: 0.076 Vali Loss: 4.215 Vali Acc: 0.659 Test Loss: 4.215 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.586334466934204
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 5.055 Vali Acc: 0.654 Test Loss: 5.055 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 673922
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.801346302032471
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.639 Vali Acc: 0.683 Test Loss: 0.639 Test Acc: 0.683
Validation loss decreased (inf --> -0.682920).  Saving model ...
Epoch: 2 cost time: 4.846399545669556
Epoch: 2, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.953 Vali Acc: 0.537 Test Loss: 0.953 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.178758382797241
Epoch: 3, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.165 Vali Acc: 0.585 Test Loss: 1.165 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.56132173538208
Epoch: 4, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.751 Vali Acc: 0.702 Test Loss: 1.751 Test Acc: 0.702
Validation loss decreased (-0.682920 --> -0.702422).  Saving model ...
Epoch: 5 cost time: 4.6809608936309814
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.928 Vali Acc: 0.629 Test Loss: 1.928 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.087352514266968
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.024 Vali Acc: 0.580 Test Loss: 2.024 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.977364778518677
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.318 Vali Acc: 0.537 Test Loss: 2.318 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.692593336105347
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.544 Vali Acc: 0.673 Test Loss: 2.544 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.406168460845947
Epoch: 9, Steps: 13 | Train Loss: 0.117 Vali Loss: 2.815 Vali Acc: 0.683 Test Loss: 2.815 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.7371745109558105
Epoch: 10, Steps: 13 | Train Loss: 0.035 Vali Loss: 3.481 Vali Acc: 0.605 Test Loss: 3.481 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.930063486099243
Epoch: 11, Steps: 13 | Train Loss: 0.066 Vali Loss: 3.844 Vali Acc: 0.624 Test Loss: 3.844 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.960887432098389
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 4.158 Vali Acc: 0.659 Test Loss: 4.158 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.975976943969727
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.111 Vali Acc: 0.659 Test Loss: 4.111 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.059612989425659
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.663 Test Loss: 4.146 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 432514
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.38037371635437
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.656 Vali Acc: 0.668 Test Loss: 0.656 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 3.364957332611084
Epoch: 2, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.830 Vali Acc: 0.634 Test Loss: 0.830 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2617223262786865
Epoch: 3, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
Validation loss decreased (-0.668286 --> -0.678037).  Saving model ...
Epoch: 4 cost time: 3.664271593093872
Epoch: 4, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.399 Vali Acc: 0.668 Test Loss: 1.399 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3594107627868652
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.556 Vali Acc: 0.629 Test Loss: 1.556 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.790802240371704
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.866 Vali Acc: 0.668 Test Loss: 1.866 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7558205127716064
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.873 Vali Acc: 0.649 Test Loss: 1.873 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.979337453842163
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.152 Vali Acc: 0.610 Test Loss: 2.152 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.895028829574585
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.227 Vali Acc: 0.654 Test Loss: 2.227 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.082075357437134
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.252 Vali Acc: 0.629 Test Loss: 2.252 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.559551477432251
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.634 Test Loss: 2.256 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.528916835784912
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.255 Vali Acc: 0.639 Test Loss: 2.255 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.6295440196990967
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.634 Test Loss: 2.249 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6780487804878049
model parameter : 347266
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.02303671836853
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 0.613 Vali Acc: 0.702 Test Loss: 0.613 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 3.327584743499756
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.790 Vali Acc: 0.585 Test Loss: 0.790 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3970911502838135
Epoch: 3, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.903 Vali Acc: 0.683 Test Loss: 0.903 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.042736530303955
Epoch: 4, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.241 Vali Acc: 0.546 Test Loss: 1.241 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2895419597625732
Epoch: 5, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.408 Vali Acc: 0.561 Test Loss: 1.408 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.382911443710327
Epoch: 6, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.518 Vali Acc: 0.654 Test Loss: 1.518 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0583150386810303
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.750 Vali Acc: 0.673 Test Loss: 1.750 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.406458854675293
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.767 Vali Acc: 0.629 Test Loss: 1.767 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7481749057769775
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.186 Vali Acc: 0.707 Test Loss: 2.186 Test Acc: 0.707
Validation loss decreased (-0.702433 --> -0.707295).  Saving model ...
Epoch: 10 cost time: 2.959245443344116
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.860 Vali Acc: 0.600 Test Loss: 1.860 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9747583866119385
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.022 Vali Acc: 0.610 Test Loss: 2.022 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1670310497283936
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.160 Vali Acc: 0.673 Test Loss: 2.160 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2099850177764893
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.129 Vali Acc: 0.659 Test Loss: 2.129 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9771602153778076
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.629 Test Loss: 2.106 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.073960781097412
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.624 Test Loss: 2.122 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9191150665283203
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.117 Vali Acc: 0.624 Test Loss: 2.117 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1311254501342773
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.137 Vali Acc: 0.624 Test Loss: 2.137 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1309077739715576
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.624 Test Loss: 2.132 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.937954902648926
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.624 Test Loss: 2.152 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 301058
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.188973426818848
Epoch: 1, Steps: 13 | Train Loss: 0.801 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.476329803466797
Epoch: 2, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.722 Vali Acc: 0.639 Test Loss: 0.722 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5082852840423584
Epoch: 3, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.010 Vali Acc: 0.541 Test Loss: 1.010 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.451805591583252
Epoch: 4, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.051 Vali Acc: 0.556 Test Loss: 1.051 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1996266841888428
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.191 Vali Acc: 0.571 Test Loss: 1.191 Test Acc: 0.571
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4622902870178223
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.425 Vali Acc: 0.663 Test Loss: 1.425 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.53562593460083
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.480 Vali Acc: 0.561 Test Loss: 1.480 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.343325138092041
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.543 Vali Acc: 0.620 Test Loss: 1.543 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.517827272415161
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.670 Vali Acc: 0.639 Test Loss: 1.670 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4257307052612305
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.605 Test Loss: 1.662 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.391920566558838
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.620 Test Loss: 1.690 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 255490
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.789877414703369
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.8865139484405518
Epoch: 2, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.683 Vali Acc: 0.678 Test Loss: 0.683 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9202911853790283
Epoch: 3, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.792 Vali Acc: 0.683 Test Loss: 0.792 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1244969367980957
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.972 Vali Acc: 0.683 Test Loss: 0.972 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0237925052642822
Epoch: 5, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.037 Vali Acc: 0.659 Test Loss: 1.037 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0651326179504395
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.228 Vali Acc: 0.605 Test Loss: 1.228 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0886337757110596
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.362 Vali Acc: 0.639 Test Loss: 1.362 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.204207420349121
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.417 Vali Acc: 0.649 Test Loss: 1.417 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9697506427764893
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.473 Vali Acc: 0.649 Test Loss: 1.473 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1974599361419678
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.577 Vali Acc: 0.654 Test Loss: 1.577 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.095177173614502
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.629 Test Loss: 1.592 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 225538
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.05834436416626
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.7892847061157227
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.670 Vali Acc: 0.702 Test Loss: 0.670 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6612515449523926
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.752 Vali Acc: 0.668 Test Loss: 0.752 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.789797782897949
Epoch: 4, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.836 Vali Acc: 0.600 Test Loss: 0.836 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.798417091369629
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.054 Vali Acc: 0.566 Test Loss: 1.054 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1002018451690674
Epoch: 6, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.123 Vali Acc: 0.629 Test Loss: 1.123 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.16249418258667
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.243 Vali Acc: 0.644 Test Loss: 1.243 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8000407218933105
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.345 Vali Acc: 0.615 Test Loss: 1.345 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7654755115509033
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.442 Vali Acc: 0.620 Test Loss: 1.442 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.692063808441162
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.510 Vali Acc: 0.624 Test Loss: 1.510 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4422976970672607
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.520 Vali Acc: 0.610 Test Loss: 1.520 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 211266
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.030619144439697
Epoch: 1, Steps: 13 | Train Loss: 0.712 Vali Loss: 1.439 Vali Acc: 0.341 Test Loss: 1.439 Test Acc: 0.341
Validation loss decreased (inf --> -0.341449).  Saving model ...
Epoch: 2 cost time: 8.495128393173218
Epoch: 2, Steps: 13 | Train Loss: 0.389 Vali Loss: 1.151 Vali Acc: 0.532 Test Loss: 1.151 Test Acc: 0.532
Validation loss decreased (-0.341449 --> -0.531696).  Saving model ...
Epoch: 3 cost time: 8.417395114898682
Epoch: 3, Steps: 13 | Train Loss: 0.193 Vali Loss: 2.095 Vali Acc: 0.449 Test Loss: 2.095 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.683820724487305
Epoch: 4, Steps: 13 | Train Loss: 0.187 Vali Loss: 3.125 Vali Acc: 0.717 Test Loss: 3.125 Test Acc: 0.717
Validation loss decreased (-0.531696 --> -0.717042).  Saving model ...
Epoch: 5 cost time: 8.189844846725464
Epoch: 5, Steps: 13 | Train Loss: 0.162 Vali Loss: 4.416 Vali Acc: 0.351 Test Loss: 4.416 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.996395587921143
Epoch: 6, Steps: 13 | Train Loss: 0.180 Vali Loss: 3.237 Vali Acc: 0.561 Test Loss: 3.237 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.092703342437744
Epoch: 7, Steps: 13 | Train Loss: 0.057 Vali Loss: 3.401 Vali Acc: 0.610 Test Loss: 3.401 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.426423788070679
Epoch: 8, Steps: 13 | Train Loss: 0.025 Vali Loss: 4.514 Vali Acc: 0.678 Test Loss: 4.514 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.759293794631958
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 4.494 Vali Acc: 0.610 Test Loss: 4.494 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.131730318069458
Epoch: 10, Steps: 13 | Train Loss: 0.011 Vali Loss: 4.651 Vali Acc: 0.590 Test Loss: 4.651 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.219996452331543
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 5.010 Vali Acc: 0.527 Test Loss: 5.010 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.128656148910522
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 5.139 Vali Acc: 0.527 Test Loss: 5.139 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.922276258468628
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 4.892 Vali Acc: 0.615 Test Loss: 4.892 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.918291807174683
Epoch: 14, Steps: 13 | Train Loss: 0.018 Vali Loss: 5.445 Vali Acc: 0.644 Test Loss: 5.445 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 624386
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.728694200515747
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.756 Vali Acc: 0.522 Test Loss: 0.756 Test Acc: 0.522
Validation loss decreased (inf --> -0.521944).  Saving model ...
Epoch: 2 cost time: 3.7866098880767822
Epoch: 2, Steps: 13 | Train Loss: 0.430 Vali Loss: 1.434 Vali Acc: 0.717 Test Loss: 1.434 Test Acc: 0.717
Validation loss decreased (-0.521944 --> -0.717059).  Saving model ...
Epoch: 3 cost time: 3.6636550426483154
Epoch: 3, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.156 Vali Acc: 0.639 Test Loss: 1.156 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.560871124267578
Epoch: 4, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.347 Vali Acc: 0.659 Test Loss: 1.347 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.857619524002075
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.686 Vali Acc: 0.659 Test Loss: 1.686 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9588935375213623
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.819 Vali Acc: 0.668 Test Loss: 1.819 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.603931427001953
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.939 Vali Acc: 0.610 Test Loss: 1.939 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5979363918304443
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.012 Vali Acc: 0.659 Test Loss: 2.012 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8365564346313477
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.624 Test Loss: 1.977 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.667046546936035
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.036 Vali Acc: 0.649 Test Loss: 2.036 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7111387252807617
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.011 Vali Acc: 0.644 Test Loss: 2.011 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.692362070083618
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.015 Vali Acc: 0.644 Test Loss: 2.015 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 382978
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.878817558288574
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.9654276371002197
Epoch: 2, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.755 Vali Acc: 0.649 Test Loss: 0.755 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9274754524230957
Epoch: 3, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.979 Vali Acc: 0.654 Test Loss: 0.979 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.81661057472229
Epoch: 4, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.177 Vali Acc: 0.707 Test Loss: 1.177 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0444998741149902
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.356 Vali Acc: 0.683 Test Loss: 1.356 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7999191284179688
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.598 Vali Acc: 0.683 Test Loss: 1.598 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7919230461120605
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.813 Vali Acc: 0.620 Test Loss: 1.813 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.051178216934204
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.875 Vali Acc: 0.639 Test Loss: 1.875 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1224870681762695
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.193 Vali Acc: 0.678 Test Loss: 2.193 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.961012840270996
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.140 Vali Acc: 0.654 Test Loss: 2.140 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.00748872756958
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.130 Vali Acc: 0.634 Test Loss: 2.130 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 297730
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.402042627334595
Epoch: 1, Steps: 13 | Train Loss: 0.705 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.140779495239258
Epoch: 2, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.742 Vali Acc: 0.688 Test Loss: 0.742 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6134607791900635
Epoch: 3, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.865 Vali Acc: 0.624 Test Loss: 0.865 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4835169315338135
Epoch: 4, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.31563401222229
Epoch: 5, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.263 Vali Acc: 0.659 Test Loss: 1.263 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2883520126342773
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.466 Vali Acc: 0.683 Test Loss: 1.466 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.397411346435547
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.515 Vali Acc: 0.673 Test Loss: 1.515 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.480232000350952
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.578 Vali Acc: 0.615 Test Loss: 1.578 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2110018730163574
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.663 Vali Acc: 0.663 Test Loss: 1.663 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0947608947753906
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.654 Test Loss: 1.643 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.452164888381958
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.668 Test Loss: 1.682 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 251522
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6517040729522705
Epoch: 1, Steps: 13 | Train Loss: 0.742 Vali Loss: 0.627 Vali Acc: 0.698 Test Loss: 0.627 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 1.7040159702301025
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.751 Vali Acc: 0.698 Test Loss: 0.751 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.828387975692749
Epoch: 3, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.862 Vali Acc: 0.673 Test Loss: 0.862 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3015363216400146
Epoch: 4, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.971 Vali Acc: 0.644 Test Loss: 0.971 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0513360500335693
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.078 Vali Acc: 0.639 Test Loss: 1.078 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8319647312164307
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.269 Vali Acc: 0.571 Test Loss: 1.269 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.952134609222412
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.377 Vali Acc: 0.600 Test Loss: 1.377 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.969008445739746
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.465 Vali Acc: 0.615 Test Loss: 1.465 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9868087768554688
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.634 Test Loss: 1.561 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0085039138793945
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.549 Vali Acc: 0.620 Test Loss: 1.549 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.77606201171875
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.592 Vali Acc: 0.620 Test Loss: 1.592 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 205954
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.458090305328369
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.7262444496154785
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.648 Vali Acc: 0.693 Test Loss: 0.648 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7926595211029053
Epoch: 3, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.778 Vali Acc: 0.610 Test Loss: 0.778 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.038614511489868
Epoch: 4, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.890 Vali Acc: 0.537 Test Loss: 0.890 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7906064987182617
Epoch: 5, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.153 Vali Acc: 0.702 Test Loss: 1.153 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.928654670715332
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.093 Vali Acc: 0.659 Test Loss: 1.093 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.887035846710205
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.198 Vali Acc: 0.634 Test Loss: 1.198 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6902666091918945
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.458 Vali Acc: 0.654 Test Loss: 1.458 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7250494956970215
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.429 Vali Acc: 0.605 Test Loss: 1.429 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9005796909332275
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.490 Vali Acc: 0.639 Test Loss: 1.490 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8479933738708496
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.471 Vali Acc: 0.624 Test Loss: 1.471 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 176002
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3105456829071045
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.0705769062042236
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.715 Vali Acc: 0.615 Test Loss: 0.715 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.091207504272461
Epoch: 3, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.769 Vali Acc: 0.712 Test Loss: 0.769 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0378429889678955
Epoch: 4, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.890 Vali Acc: 0.576 Test Loss: 0.890 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9979712963104248
Epoch: 5, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.996 Vali Acc: 0.605 Test Loss: 0.996 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.173762321472168
Epoch: 6, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.168 Vali Acc: 0.605 Test Loss: 1.168 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1156322956085205
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.334 Vali Acc: 0.629 Test Loss: 1.334 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.062706232070923
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.420 Vali Acc: 0.610 Test Loss: 1.420 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3424031734466553
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.615 Test Loss: 1.486 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8839709758758545
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.529 Vali Acc: 0.610 Test Loss: 1.529 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.928880214691162
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.581 Vali Acc: 0.629 Test Loss: 1.581 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 161730
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.058192729949951
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 2.440 Vali Acc: 0.278 Test Loss: 2.440 Test Acc: 0.278
Validation loss decreased (inf --> -0.278024).  Saving model ...
Epoch: 2 cost time: 6.685083627700806
Epoch: 2, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.012 Vali Acc: 0.673 Test Loss: 1.012 Test Acc: 0.673
Validation loss decreased (-0.278024 --> -0.673161).  Saving model ...
Epoch: 3 cost time: 8.116244316101074
Epoch: 3, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.497 Vali Acc: 0.580 Test Loss: 1.497 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.643649578094482
Epoch: 4, Steps: 13 | Train Loss: 0.053 Vali Loss: 2.143 Vali Acc: 0.507 Test Loss: 2.143 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.108665227890015
Epoch: 5, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.827 Vali Acc: 0.707 Test Loss: 2.827 Test Acc: 0.707
Validation loss decreased (-0.673161 --> -0.707289).  Saving model ...
Epoch: 6 cost time: 7.10231876373291
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 2.596 Vali Acc: 0.605 Test Loss: 2.596 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.870751857757568
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.783 Vali Acc: 0.605 Test Loss: 2.783 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.4219396114349365
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.907 Vali Acc: 0.595 Test Loss: 2.907 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.557177543640137
Epoch: 9, Steps: 13 | Train Loss: 0.055 Vali Loss: 4.096 Vali Acc: 0.507 Test Loss: 4.096 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.520262002944946
Epoch: 10, Steps: 13 | Train Loss: 0.064 Vali Loss: 4.731 Vali Acc: 0.688 Test Loss: 4.731 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.621403217315674
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 5.393 Vali Acc: 0.483 Test Loss: 5.393 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.439425945281982
Epoch: 12, Steps: 13 | Train Loss: 0.258 Vali Loss: 6.697 Vali Acc: 0.478 Test Loss: 6.697 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.601251602172852
Epoch: 13, Steps: 13 | Train Loss: 0.266 Vali Loss: 10.012 Vali Acc: 0.420 Test Loss: 10.012 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.488158464431763
Epoch: 14, Steps: 13 | Train Loss: 0.536 Vali Loss: 7.110 Vali Acc: 0.507 Test Loss: 7.110 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.300316095352173
Epoch: 15, Steps: 13 | Train Loss: 0.048 Vali Loss: 8.287 Vali Acc: 0.502 Test Loss: 8.287 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 599618
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.933312654495239
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.860 Vali Acc: 0.473 Test Loss: 0.860 Test Acc: 0.473
Validation loss decreased (inf --> -0.473162).  Saving model ...
Epoch: 2 cost time: 4.034479379653931
Epoch: 2, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.958 Vali Acc: 0.717 Test Loss: 0.958 Test Acc: 0.717
Validation loss decreased (-0.473162 --> -0.717064).  Saving model ...
Epoch: 3 cost time: 3.9009220600128174
Epoch: 3, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.078 Vali Acc: 0.673 Test Loss: 1.078 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.016155958175659
Epoch: 4, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.347 Vali Acc: 0.659 Test Loss: 1.347 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.841264247894287
Epoch: 5, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.514 Vali Acc: 0.600 Test Loss: 1.514 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.014261960983276
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.721 Vali Acc: 0.590 Test Loss: 1.721 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.126312017440796
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.600 Test Loss: 1.884 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.02464747428894
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.049 Vali Acc: 0.595 Test Loss: 2.049 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.882566452026367
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.076 Vali Acc: 0.600 Test Loss: 2.076 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.711636781692505
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.624 Test Loss: 2.159 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.937962055206299
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.121 Vali Acc: 0.624 Test Loss: 2.121 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8657445907592773
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.173 Vali Acc: 0.639 Test Loss: 2.173 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 358210
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.495479345321655
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.920 Vali Acc: 0.424 Test Loss: 0.920 Test Acc: 0.424
Validation loss decreased (inf --> -0.424381).  Saving model ...
Epoch: 2 cost time: 3.629723072052002
Epoch: 2, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.269 Vali Acc: 0.395 Test Loss: 1.269 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2949984073638916
Epoch: 3, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.936 Vali Acc: 0.624 Test Loss: 0.936 Test Acc: 0.624
Validation loss decreased (-0.424381 --> -0.624381).  Saving model ...
Epoch: 4 cost time: 3.571678400039673
Epoch: 4, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.273 Vali Acc: 0.644 Test Loss: 1.273 Test Acc: 0.644
Validation loss decreased (-0.624381 --> -0.643890).  Saving model ...
Epoch: 5 cost time: 3.5933730602264404
Epoch: 5, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.768 Vali Acc: 0.541 Test Loss: 1.768 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.955573558807373
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.775 Vali Acc: 0.659 Test Loss: 1.775 Test Acc: 0.659
Validation loss decreased (-0.643890 --> -0.658519).  Saving model ...
Epoch: 7 cost time: 3.8383371829986572
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.998 Vali Acc: 0.649 Test Loss: 1.998 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.781081438064575
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.991 Vali Acc: 0.624 Test Loss: 1.991 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.480299234390259
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.277 Vali Acc: 0.663 Test Loss: 2.277 Test Acc: 0.663
Validation loss decreased (-0.658519 --> -0.663392).  Saving model ...
Epoch: 10 cost time: 3.724392890930176
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.364 Vali Acc: 0.668 Test Loss: 2.364 Test Acc: 0.668
Validation loss decreased (-0.663392 --> -0.668269).  Saving model ...
Epoch: 11 cost time: 3.808850049972534
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.072 Vali Acc: 0.605 Test Loss: 2.072 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9860732555389404
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.405 Vali Acc: 0.688 Test Loss: 2.405 Test Acc: 0.688
Validation loss decreased (-0.668269 --> -0.687781).  Saving model ...
Epoch: 13 cost time: 3.1077468395233154
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.144 Vali Acc: 0.649 Test Loss: 2.144 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.448174476623535
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.332 Vali Acc: 0.673 Test Loss: 2.332 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.893181324005127
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.673 Test Loss: 2.449 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.716930866241455
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.330 Vali Acc: 0.654 Test Loss: 2.330 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.704188585281372
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.654 Test Loss: 2.336 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.921384811401367
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.379 Vali Acc: 0.659 Test Loss: 2.379 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.570808172225952
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.659 Test Loss: 2.388 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8295278549194336
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.654 Test Loss: 2.387 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.794682025909424
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.654 Test Loss: 2.388 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.8821873664855957
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.392 Vali Acc: 0.649 Test Loss: 2.392 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 272962
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.962777137756348
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.641 Vali Acc: 0.654 Test Loss: 0.641 Test Acc: 0.654
Validation loss decreased (inf --> -0.653652).  Saving model ...
Epoch: 2 cost time: 3.191148281097412
Epoch: 2, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.776 Vali Acc: 0.707 Test Loss: 0.776 Test Acc: 0.707
Validation loss decreased (-0.653652 --> -0.707309).  Saving model ...
Epoch: 3 cost time: 3.219884157180786
Epoch: 3, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.905 Vali Acc: 0.629 Test Loss: 0.905 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2818009853363037
Epoch: 4, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.082 Vali Acc: 0.615 Test Loss: 1.082 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.4439473152160645
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.332 Vali Acc: 0.678 Test Loss: 1.332 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1894609928131104
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.452 Vali Acc: 0.649 Test Loss: 1.452 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.370741128921509
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.625 Vali Acc: 0.668 Test Loss: 1.625 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1848371028900146
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.637 Vali Acc: 0.649 Test Loss: 1.637 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.354161024093628
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.663 Test Loss: 1.790 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1469085216522217
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.649 Test Loss: 1.711 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.44191837310791
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.649 Test Loss: 1.785 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.302490472793579
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.654 Test Loss: 1.741 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 226754
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.273430585861206
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.720 Vali Acc: 0.722 Test Loss: 0.720 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.594741106033325
Epoch: 2, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.656541109085083
Epoch: 3, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.772 Vali Acc: 0.688 Test Loss: 0.772 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6926381587982178
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.914 Vali Acc: 0.673 Test Loss: 0.914 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.499105453491211
Epoch: 5, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.177 Vali Acc: 0.683 Test Loss: 1.177 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7845234870910645
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.274 Vali Acc: 0.634 Test Loss: 1.274 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6164538860321045
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.434 Vali Acc: 0.663 Test Loss: 1.434 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.990355968475342
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.476 Vali Acc: 0.654 Test Loss: 1.476 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.536708116531372
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.508 Vali Acc: 0.605 Test Loss: 1.508 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.478900909423828
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.575 Vali Acc: 0.663 Test Loss: 1.575 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5447134971618652
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.639 Test Loss: 1.576 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.564509153366089
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.639 Test Loss: 1.599 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 181186
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.490207195281982
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.732 Vali Acc: 0.722 Test Loss: 0.732 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.573625087738037
Epoch: 2, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.715 Vali Acc: 0.576 Test Loss: 0.715 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.577094078063965
Epoch: 3, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.852 Vali Acc: 0.698 Test Loss: 0.852 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.378826856613159
Epoch: 4, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.879 Vali Acc: 0.634 Test Loss: 0.879 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3067920207977295
Epoch: 5, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.964 Vali Acc: 0.659 Test Loss: 0.964 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.381132125854492
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.132 Vali Acc: 0.585 Test Loss: 1.132 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1577751636505127
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.250 Vali Acc: 0.610 Test Loss: 1.250 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.458676815032959
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.348 Vali Acc: 0.624 Test Loss: 1.348 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3708014488220215
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.378 Vali Acc: 0.600 Test Loss: 1.378 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.557574987411499
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.449 Vali Acc: 0.649 Test Loss: 1.449 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.472825050354004
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.514 Vali Acc: 0.649 Test Loss: 1.514 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 151234
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.124156713485718
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.345536708831787
Epoch: 2, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.642 Vali Acc: 0.688 Test Loss: 0.642 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3499979972839355
Epoch: 3, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.715 Vali Acc: 0.693 Test Loss: 0.715 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2705650329589844
Epoch: 4, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.835 Vali Acc: 0.673 Test Loss: 0.835 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1120097637176514
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.948 Vali Acc: 0.639 Test Loss: 0.948 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.157350540161133
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.108 Vali Acc: 0.634 Test Loss: 1.108 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.101120948791504
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.239 Vali Acc: 0.649 Test Loss: 1.239 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1556921005249023
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.333 Vali Acc: 0.673 Test Loss: 1.333 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.296006679534912
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.352 Vali Acc: 0.624 Test Loss: 1.352 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.2351622581481934
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.385 Vali Acc: 0.659 Test Loss: 1.385 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.242229461669922
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.430 Vali Acc: 0.654 Test Loss: 1.430 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm64_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 136962
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.748052358627319
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.638 Vali Acc: 0.654 Test Loss: 0.638 Test Acc: 0.654
Validation loss decreased (inf --> -0.653652).  Saving model ...
Epoch: 2 cost time: 3.5281965732574463
Epoch: 2, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.769 Vali Acc: 0.615 Test Loss: 0.769 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.605668783187866
Epoch: 3, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.292 Vali Acc: 0.473 Test Loss: 1.292 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.245274066925049
Epoch: 4, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.248 Vali Acc: 0.683 Test Loss: 1.248 Test Acc: 0.683
Validation loss decreased (-0.653652 --> -0.682914).  Saving model ...
Epoch: 5 cost time: 3.4294331073760986
Epoch: 5, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.280 Vali Acc: 0.639 Test Loss: 1.280 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5660831928253174
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.458 Vali Acc: 0.639 Test Loss: 1.458 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3154830932617188
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.658 Vali Acc: 0.654 Test Loss: 1.658 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.3883824348449707
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.668 Test Loss: 1.862 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5774619579315186
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.624 Test Loss: 1.799 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.078238010406494
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.649 Test Loss: 1.882 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1279404163360596
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.668 Test Loss: 2.089 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0141890048980713
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.629 Test Loss: 1.938 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.397140979766846
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.634 Test Loss: 1.959 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.252308368682861
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.065 Vali Acc: 0.659 Test Loss: 2.065 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6829268292682927
model parameter : 325058
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.752943515777588
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.628 Vali Acc: 0.702 Test Loss: 0.628 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 2.4989404678344727
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.685 Vali Acc: 0.673 Test Loss: 0.685 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6350951194763184
Epoch: 3, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.824 Vali Acc: 0.663 Test Loss: 0.824 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.628194808959961
Epoch: 4, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.018 Vali Acc: 0.590 Test Loss: 1.018 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.957796335220337
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.304 Vali Acc: 0.678 Test Loss: 1.304 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.617262840270996
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.274 Vali Acc: 0.644 Test Loss: 1.274 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7231969833374023
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.401 Vali Acc: 0.634 Test Loss: 1.401 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.747678279876709
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.504 Vali Acc: 0.629 Test Loss: 1.504 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.631340265274048
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.654 Test Loss: 1.619 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.602071762084961
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.575 Vali Acc: 0.644 Test Loss: 1.575 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4953739643096924
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.659 Test Loss: 1.659 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 204354
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8752853870391846
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.8910870552062988
Epoch: 2, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.705 Vali Acc: 0.712 Test Loss: 0.705 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.183382034301758
Epoch: 3, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.771 Vali Acc: 0.688 Test Loss: 0.771 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.943042278289795
Epoch: 4, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.042 Vali Acc: 0.702 Test Loss: 1.042 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1045827865600586
Epoch: 5, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.052 Vali Acc: 0.639 Test Loss: 1.052 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1743180751800537
Epoch: 6, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.264 Vali Acc: 0.668 Test Loss: 1.264 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.126039743423462
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.342 Vali Acc: 0.605 Test Loss: 1.342 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9412236213684082
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.467 Vali Acc: 0.649 Test Loss: 1.467 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0978376865386963
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.606 Vali Acc: 0.663 Test Loss: 1.606 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9583778381347656
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.602 Vali Acc: 0.600 Test Loss: 1.602 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7486851215362549
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.649 Test Loss: 1.682 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 161730
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8967201709747314
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.772176742553711
Epoch: 2, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.695 Vali Acc: 0.673 Test Loss: 0.695 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8920183181762695
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.871 Vali Acc: 0.522 Test Loss: 0.871 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8490049839019775
Epoch: 4, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.127 Vali Acc: 0.473 Test Loss: 1.127 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.870304822921753
Epoch: 5, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.933 Vali Acc: 0.615 Test Loss: 0.933 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0885536670684814
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.068 Vali Acc: 0.615 Test Loss: 1.068 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9288983345031738
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.175 Vali Acc: 0.615 Test Loss: 1.175 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8990504741668701
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.180 Vali Acc: 0.644 Test Loss: 1.180 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8886396884918213
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.316 Vali Acc: 0.702 Test Loss: 1.316 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5951206684112549
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.300 Vali Acc: 0.634 Test Loss: 1.300 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7491743564605713
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.437 Vali Acc: 0.693 Test Loss: 1.437 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 138626
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.666135311126709
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.637 Vali Acc: 0.693 Test Loss: 0.637 Test Acc: 0.693
Validation loss decreased (inf --> -0.692677).  Saving model ...
Epoch: 2 cost time: 1.8069665431976318
Epoch: 2, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.662 Vali Acc: 0.654 Test Loss: 0.662 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7345359325408936
Epoch: 3, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.705 Vali Acc: 0.649 Test Loss: 0.705 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9477324485778809
Epoch: 4, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.773 Vali Acc: 0.639 Test Loss: 0.773 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9011878967285156
Epoch: 5, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.874 Vali Acc: 0.634 Test Loss: 0.874 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7940177917480469
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7807445526123047
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.124 Vali Acc: 0.600 Test Loss: 1.124 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8967385292053223
Epoch: 8, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.275 Vali Acc: 0.649 Test Loss: 1.275 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9600021839141846
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.291 Vali Acc: 0.585 Test Loss: 1.291 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8156037330627441
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.329 Vali Acc: 0.615 Test Loss: 1.329 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7134788036346436
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.406 Vali Acc: 0.649 Test Loss: 1.406 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 115842
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5644030570983887
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.649 Vali Acc: 0.732 Test Loss: 0.649 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.792722225189209
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.625 Vali Acc: 0.693 Test Loss: 0.625 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.849067211151123
Epoch: 3, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.649 Vali Acc: 0.688 Test Loss: 0.649 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7016832828521729
Epoch: 4, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.687 Vali Acc: 0.663 Test Loss: 0.687 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.62693452835083
Epoch: 5, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.769 Vali Acc: 0.683 Test Loss: 0.769 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4723846912384033
Epoch: 6, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.801 Vali Acc: 0.678 Test Loss: 0.801 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7483773231506348
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.906 Vali Acc: 0.678 Test Loss: 0.906 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6802918910980225
Epoch: 8, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.026 Vali Acc: 0.673 Test Loss: 1.026 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.616361141204834
Epoch: 9, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.069 Vali Acc: 0.683 Test Loss: 1.069 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5743975639343262
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.077 Vali Acc: 0.673 Test Loss: 1.077 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.436805009841919
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.185 Vali Acc: 0.678 Test Loss: 1.185 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 100866
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.511905670166016
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.656 Vali Acc: 0.639 Test Loss: 0.656 Test Acc: 0.639
Validation loss decreased (inf --> -0.639018).  Saving model ...
Epoch: 2 cost time: 1.786607265472412
Epoch: 2, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.665 Vali Acc: 0.624 Test Loss: 0.665 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.641012191772461
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.702 Vali Acc: 0.605 Test Loss: 0.702 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2325100898742676
Epoch: 4, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.764 Vali Acc: 0.566 Test Loss: 0.764 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.410322666168213
Epoch: 5, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.809 Vali Acc: 0.605 Test Loss: 0.809 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.384469509124756
Epoch: 6, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.898 Vali Acc: 0.620 Test Loss: 0.898 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.26603102684021
Epoch: 7, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.984 Vali Acc: 0.615 Test Loss: 0.984 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1715075969696045
Epoch: 8, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.122 Vali Acc: 0.615 Test Loss: 1.122 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.426701307296753
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.281 Vali Acc: 0.546 Test Loss: 1.281 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.198202133178711
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.360 Vali Acc: 0.590 Test Loss: 1.360 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.392789840698242
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.427 Vali Acc: 0.580 Test Loss: 1.427 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6390243902439025
model parameter : 93730
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.412290096282959
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.636 Vali Acc: 0.732 Test Loss: 0.636 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 3.9301838874816895
Epoch: 2, Steps: 13 | Train Loss: 0.413 Vali Loss: 1.067 Vali Acc: 0.434 Test Loss: 1.067 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.041247367858887
Epoch: 3, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.350 Vali Acc: 0.712 Test Loss: 1.350 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8791234493255615
Epoch: 4, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.780 Vali Acc: 0.366 Test Loss: 2.780 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.739762306213379
Epoch: 5, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.950 Vali Acc: 0.493 Test Loss: 1.950 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.649465560913086
Epoch: 6, Steps: 13 | Train Loss: 0.073 Vali Loss: 2.091 Vali Acc: 0.522 Test Loss: 2.091 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.935063600540161
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.889 Vali Acc: 0.615 Test Loss: 1.889 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.467778205871582
Epoch: 8, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.152 Vali Acc: 0.644 Test Loss: 2.152 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.333327054977417
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.202 Vali Acc: 0.600 Test Loss: 2.202 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4740512371063232
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.515 Vali Acc: 0.668 Test Loss: 2.515 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.9824588298797607
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.284 Vali Acc: 0.639 Test Loss: 2.284 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 300098
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.586135149002075
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5058095455169678
Epoch: 2, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.707 Vali Acc: 0.712 Test Loss: 0.707 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.784868001937866
Epoch: 3, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.011 Vali Acc: 0.522 Test Loss: 1.011 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3562114238739014
Epoch: 4, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.961 Vali Acc: 0.693 Test Loss: 0.961 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3881101608276367
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.252 Vali Acc: 0.688 Test Loss: 1.252 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.431748628616333
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.292 Vali Acc: 0.673 Test Loss: 1.292 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4008586406707764
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.542 Vali Acc: 0.532 Test Loss: 1.542 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4088404178619385
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.767 Vali Acc: 0.541 Test Loss: 1.767 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7149498462677
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.776 Vali Acc: 0.527 Test Loss: 1.776 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.454832077026367
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.876 Vali Acc: 0.673 Test Loss: 1.876 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.525367498397827
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.668 Test Loss: 1.953 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 179394
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.671452045440674
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.718 Vali Acc: 0.722 Test Loss: 0.718 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.9702539443969727
Epoch: 2, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.668 Vali Acc: 0.693 Test Loss: 0.668 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6901919841766357
Epoch: 3, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.804 Vali Acc: 0.624 Test Loss: 0.804 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9257307052612305
Epoch: 4, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.866 Vali Acc: 0.610 Test Loss: 0.866 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9508507251739502
Epoch: 5, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.007 Vali Acc: 0.654 Test Loss: 1.007 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9680671691894531
Epoch: 6, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.250 Vali Acc: 0.688 Test Loss: 1.250 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0168159008026123
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.290 Vali Acc: 0.659 Test Loss: 1.290 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.149609327316284
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.348 Vali Acc: 0.620 Test Loss: 1.348 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.960869550704956
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.410 Vali Acc: 0.678 Test Loss: 1.410 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.995457410812378
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.461 Vali Acc: 0.683 Test Loss: 1.461 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.012019395828247
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.478 Vali Acc: 0.668 Test Loss: 1.478 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 136770
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6034257411956787
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.710 Vali Acc: 0.722 Test Loss: 0.710 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.7734861373901367
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.689 Vali Acc: 0.712 Test Loss: 0.689 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.757021427154541
Epoch: 3, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.723 Vali Acc: 0.702 Test Loss: 0.723 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8258321285247803
Epoch: 4, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.867 Vali Acc: 0.546 Test Loss: 0.867 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7460625171661377
Epoch: 5, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.984 Vali Acc: 0.546 Test Loss: 0.984 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5979578495025635
Epoch: 6, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.106 Vali Acc: 0.585 Test Loss: 1.106 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6402251720428467
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.168 Vali Acc: 0.615 Test Loss: 1.168 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6453802585601807
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.325 Vali Acc: 0.673 Test Loss: 1.325 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.773878812789917
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.281 Vali Acc: 0.629 Test Loss: 1.281 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.761949062347412
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.379 Vali Acc: 0.639 Test Loss: 1.379 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.835496425628662
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.363 Vali Acc: 0.639 Test Loss: 1.363 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 113666
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.603909730911255
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6501569747924805
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.572831153869629
Epoch: 3, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.637 Vali Acc: 0.702 Test Loss: 0.637 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6998143196105957
Epoch: 4, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.763 Vali Acc: 0.585 Test Loss: 0.763 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5381927490234375
Epoch: 5, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.805 Vali Acc: 0.605 Test Loss: 0.805 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6035583019256592
Epoch: 6, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.892 Vali Acc: 0.649 Test Loss: 0.892 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.587904930114746
Epoch: 7, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.945 Vali Acc: 0.663 Test Loss: 0.945 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5708038806915283
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.046 Vali Acc: 0.673 Test Loss: 1.046 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6240904331207275
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.096 Vali Acc: 0.654 Test Loss: 1.096 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.741637945175171
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.151 Vali Acc: 0.678 Test Loss: 1.151 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6408870220184326
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.649 Test Loss: 1.185 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5573654174804688
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.223 Vali Acc: 0.668 Test Loss: 1.223 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 90882
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2876203060150146
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.663 Vali Acc: 0.712 Test Loss: 0.663 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 1.488349199295044
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.658 Vali Acc: 0.698 Test Loss: 0.658 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.482778787612915
Epoch: 3, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.695 Vali Acc: 0.712 Test Loss: 0.695 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5145072937011719
Epoch: 4, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.744 Vali Acc: 0.644 Test Loss: 0.744 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5578746795654297
Epoch: 5, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.792 Vali Acc: 0.668 Test Loss: 0.792 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.495748519897461
Epoch: 6, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.867 Vali Acc: 0.659 Test Loss: 0.867 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5033459663391113
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.955 Vali Acc: 0.673 Test Loss: 0.955 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6724119186401367
Epoch: 8, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.019 Vali Acc: 0.683 Test Loss: 1.019 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5221703052520752
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.117 Vali Acc: 0.698 Test Loss: 1.117 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5435400009155273
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.148 Vali Acc: 0.668 Test Loss: 1.148 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4940333366394043
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.218 Vali Acc: 0.668 Test Loss: 1.218 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 75906
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.172574281692505
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.635 Vali Acc: 0.698 Test Loss: 0.635 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 2.2151339054107666
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.649 Vali Acc: 0.678 Test Loss: 0.649 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3708765506744385
Epoch: 3, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.682 Vali Acc: 0.663 Test Loss: 0.682 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.256880760192871
Epoch: 4, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.738 Vali Acc: 0.659 Test Loss: 0.738 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.269442558288574
Epoch: 5, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.803 Vali Acc: 0.659 Test Loss: 0.803 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.395081043243408
Epoch: 6, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.894 Vali Acc: 0.654 Test Loss: 0.894 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3482534885406494
Epoch: 7, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.006 Vali Acc: 0.649 Test Loss: 1.006 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.2606570720672607
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.106 Vali Acc: 0.634 Test Loss: 1.106 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4600954055786133
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.213 Vali Acc: 0.639 Test Loss: 1.213 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3947410583496094
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.305 Vali Acc: 0.624 Test Loss: 1.305 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.204270601272583
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.362 Vali Acc: 0.624 Test Loss: 1.362 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 68770
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.793498754501343
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.624 Vali Acc: 0.668 Test Loss: 0.624 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 4.055732488632202
Epoch: 2, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.811 Vali Acc: 0.698 Test Loss: 0.811 Test Acc: 0.698
Validation loss decreased (-0.668286 --> -0.697553).  Saving model ...
Epoch: 3 cost time: 3.9084653854370117
Epoch: 3, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.996 Vali Acc: 0.659 Test Loss: 0.996 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.163681268692017
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.129 Vali Acc: 0.634 Test Loss: 1.129 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9303243160247803
Epoch: 5, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.689 Vali Acc: 0.390 Test Loss: 2.689 Test Acc: 0.390
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9404873847961426
Epoch: 6, Steps: 13 | Train Loss: 0.109 Vali Loss: 2.407 Vali Acc: 0.488 Test Loss: 2.407 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9025590419769287
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.969 Vali Acc: 0.644 Test Loss: 1.969 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8741090297698975
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.014 Vali Acc: 0.576 Test Loss: 2.014 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.9657058715820312
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.110 Vali Acc: 0.600 Test Loss: 2.110 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.266962766647339
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.479 Vali Acc: 0.678 Test Loss: 2.479 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.399122714996338
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.454 Vali Acc: 0.659 Test Loss: 2.454 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.2839765548706055
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.312 Vali Acc: 0.659 Test Loss: 2.312 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 287618
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.668764591217041
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.620 Vali Acc: 0.707 Test Loss: 0.620 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.774007797241211
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.723 Vali Acc: 0.707 Test Loss: 0.723 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.791180372238159
Epoch: 3, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.891 Vali Acc: 0.683 Test Loss: 0.891 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.980499505996704
Epoch: 4, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.980 Vali Acc: 0.702 Test Loss: 0.980 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8540027141571045
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.178 Vali Acc: 0.678 Test Loss: 1.178 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0592381954193115
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.474 Vali Acc: 0.688 Test Loss: 1.474 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.147155284881592
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.550 Vali Acc: 0.673 Test Loss: 1.550 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.115278482437134
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.568 Vali Acc: 0.610 Test Loss: 1.568 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.027167558670044
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.659 Test Loss: 1.643 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.808901786804199
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.648 Vali Acc: 0.668 Test Loss: 1.648 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.943248987197876
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.668 Test Loss: 1.686 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 166914
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.375880241394043
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.566842794418335
Epoch: 2, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.722 Vali Acc: 0.580 Test Loss: 0.722 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.415992498397827
Epoch: 3, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.768 Vali Acc: 0.663 Test Loss: 0.768 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5803568363189697
Epoch: 4, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.943 Vali Acc: 0.556 Test Loss: 0.943 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5257792472839355
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.002 Vali Acc: 0.629 Test Loss: 1.002 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6638317108154297
Epoch: 6, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.375 Vali Acc: 0.707 Test Loss: 1.375 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1600403785705566
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.373 Vali Acc: 0.678 Test Loss: 1.373 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0195484161376953
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.497 Vali Acc: 0.551 Test Loss: 1.497 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.074793577194214
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.458 Vali Acc: 0.629 Test Loss: 1.458 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.199608564376831
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.832 Vali Acc: 0.698 Test Loss: 1.832 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0622470378875732
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.749 Vali Acc: 0.663 Test Loss: 1.749 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 124290
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.538161039352417
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.662 Vali Acc: 0.722 Test Loss: 0.662 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.7304763793945312
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.669 Vali Acc: 0.654 Test Loss: 0.669 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.856379985809326
Epoch: 3, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.909 Vali Acc: 0.527 Test Loss: 0.909 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7660958766937256
Epoch: 4, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.843 Vali Acc: 0.663 Test Loss: 0.843 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6817569732666016
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.985 Vali Acc: 0.605 Test Loss: 0.985 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9868927001953125
Epoch: 6, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.029 Vali Acc: 0.644 Test Loss: 1.029 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.932671546936035
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.158 Vali Acc: 0.610 Test Loss: 1.158 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8752899169921875
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.232 Vali Acc: 0.649 Test Loss: 1.232 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8742833137512207
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.278 Vali Acc: 0.654 Test Loss: 1.278 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8697264194488525
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.314 Vali Acc: 0.668 Test Loss: 1.314 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.882380723953247
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.314 Vali Acc: 0.668 Test Loss: 1.314 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 101186
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2904276847839355
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.6652677059173584
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.612 Vali Acc: 0.668 Test Loss: 0.612 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8297934532165527
Epoch: 3, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.656 Vali Acc: 0.688 Test Loss: 0.656 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8145647048950195
Epoch: 4, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.732 Vali Acc: 0.668 Test Loss: 0.732 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1209464073181152
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.862 Vali Acc: 0.590 Test Loss: 0.862 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8663041591644287
Epoch: 6, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.904 Vali Acc: 0.580 Test Loss: 0.904 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7536139488220215
Epoch: 7, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.748924732208252
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.091 Vali Acc: 0.654 Test Loss: 1.091 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8071868419647217
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.182 Vali Acc: 0.649 Test Loss: 1.182 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.807206869125366
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.217 Vali Acc: 0.620 Test Loss: 1.217 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7356297969818115
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.275 Vali Acc: 0.639 Test Loss: 1.275 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 78402
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.154806137084961
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.632 Vali Acc: 0.702 Test Loss: 0.632 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 2.494276523590088
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.633 Vali Acc: 0.668 Test Loss: 0.633 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6697685718536377
Epoch: 3, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.666 Vali Acc: 0.693 Test Loss: 0.666 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.686460018157959
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.718 Vali Acc: 0.639 Test Loss: 0.718 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6863667964935303
Epoch: 5, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.765 Vali Acc: 0.683 Test Loss: 0.765 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.574824571609497
Epoch: 6, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.836 Vali Acc: 0.673 Test Loss: 0.836 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6241133213043213
Epoch: 7, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.879 Vali Acc: 0.668 Test Loss: 0.879 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4849648475646973
Epoch: 8, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.952 Vali Acc: 0.659 Test Loss: 0.952 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.706855058670044
Epoch: 9, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.033 Vali Acc: 0.668 Test Loss: 1.033 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8113937377929688
Epoch: 10, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.103 Vali Acc: 0.683 Test Loss: 1.103 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.613107681274414
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.129 Vali Acc: 0.668 Test Loss: 1.129 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 63426
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.333537340164185
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.659 Vali Acc: 0.678 Test Loss: 0.659 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 2.6207571029663086
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.662 Vali Acc: 0.683 Test Loss: 0.662 Test Acc: 0.683
Validation loss decreased (-0.678042 --> -0.682920).  Saving model ...
Epoch: 3 cost time: 2.663367509841919
Epoch: 3, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.678 Vali Acc: 0.663 Test Loss: 0.678 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.728850841522217
Epoch: 4, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.728 Vali Acc: 0.663 Test Loss: 0.728 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.902009963989258
Epoch: 5, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.778 Vali Acc: 0.624 Test Loss: 0.778 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8167355060577393
Epoch: 6, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.858 Vali Acc: 0.615 Test Loss: 0.858 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8619000911712646
Epoch: 7, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.943 Vali Acc: 0.639 Test Loss: 0.943 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.872509479522705
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.035 Vali Acc: 0.576 Test Loss: 1.035 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.773205280303955
Epoch: 9, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.9604623317718506
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.250 Vali Acc: 0.610 Test Loss: 1.250 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5389609336853027
Epoch: 11, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.360 Vali Acc: 0.644 Test Loss: 1.360 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.281303644180298
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.359 Vali Acc: 0.634 Test Loss: 1.359 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm32_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6829268292682927
model parameter : 56290
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.518340587615967
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.690 Vali Acc: 0.585 Test Loss: 0.690 Test Acc: 0.585
Validation loss decreased (inf --> -0.585359).  Saving model ...
Epoch: 2 cost time: 3.9503254890441895
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (-0.585359 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 4.410544395446777
Epoch: 3, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.773 Vali Acc: 0.585 Test Loss: 0.773 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.344534635543823
Epoch: 4, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.846 Vali Acc: 0.688 Test Loss: 0.846 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.516369581222534
Epoch: 5, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.172 Vali Acc: 0.537 Test Loss: 1.172 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8327627182006836
Epoch: 6, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.057 Vali Acc: 0.624 Test Loss: 1.057 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.314738750457764
Epoch: 7, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.172 Vali Acc: 0.654 Test Loss: 1.172 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.094231128692627
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.311 Vali Acc: 0.585 Test Loss: 1.311 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.118642330169678
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.401 Vali Acc: 0.590 Test Loss: 1.401 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9760406017303467
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.492 Vali Acc: 0.678 Test Loss: 1.492 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.298440217971802
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.485 Vali Acc: 0.649 Test Loss: 1.485 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.414610147476196
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.487 Vali Acc: 0.634 Test Loss: 1.487 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 159842
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.408400535583496
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.670 Vali Acc: 0.561 Test Loss: 0.670 Test Acc: 0.561
Validation loss decreased (inf --> -0.560969).  Saving model ...
Epoch: 2 cost time: 2.423394203186035
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.665 Vali Acc: 0.629 Test Loss: 0.665 Test Acc: 0.629
Validation loss decreased (-0.560969 --> -0.629262).  Saving model ...
Epoch: 3 cost time: 2.5716347694396973
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.650 Vali Acc: 0.693 Test Loss: 0.650 Test Acc: 0.693
Validation loss decreased (-0.629262 --> -0.692676).  Saving model ...
Epoch: 4 cost time: 2.484478712081909
Epoch: 4, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
Validation loss decreased (-0.692676 --> -0.717065).  Saving model ...
Epoch: 5 cost time: 2.629563570022583
Epoch: 5, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.770 Vali Acc: 0.693 Test Loss: 0.770 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.734724760055542
Epoch: 6, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.902 Vali Acc: 0.678 Test Loss: 0.902 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6503496170043945
Epoch: 7, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.903 Vali Acc: 0.702 Test Loss: 0.903 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.84796142578125
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 0.995 Vali Acc: 0.712 Test Loss: 0.995 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8546302318573
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.020 Vali Acc: 0.702 Test Loss: 1.020 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.618156909942627
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.693 Test Loss: 1.081 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.727473497390747
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.698 Test Loss: 1.144 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.828092098236084
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.103 Vali Acc: 0.702 Test Loss: 1.103 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8204452991485596
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.698 Test Loss: 1.138 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.815650224685669
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.257 Vali Acc: 0.693 Test Loss: 1.257 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 99490
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9129087924957275
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.646 Vali Acc: 0.722 Test Loss: 0.646 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9834823608398438
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.657 Vali Acc: 0.707 Test Loss: 0.657 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2281014919281006
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.760 Vali Acc: 0.707 Test Loss: 0.760 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.166800022125244
Epoch: 4, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.778 Vali Acc: 0.707 Test Loss: 0.778 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2127320766448975
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.804 Vali Acc: 0.698 Test Loss: 0.804 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2944796085357666
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.847 Vali Acc: 0.644 Test Loss: 0.847 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1588191986083984
Epoch: 7, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.979 Vali Acc: 0.712 Test Loss: 0.979 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.206012487411499
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.041 Vali Acc: 0.683 Test Loss: 1.041 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.295612096786499
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.049 Vali Acc: 0.673 Test Loss: 1.049 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.312079429626465
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.230 Vali Acc: 0.727 Test Loss: 1.230 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726817).  Saving model ...
Epoch: 11 cost time: 2.06549072265625
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.196 Vali Acc: 0.678 Test Loss: 1.196 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2295472621917725
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.247 Vali Acc: 0.678 Test Loss: 1.247 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9648823738098145
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.253 Vali Acc: 0.693 Test Loss: 1.253 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2360801696777344
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.291 Vali Acc: 0.702 Test Loss: 1.291 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.909745216369629
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.683 Test Loss: 1.293 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1100540161132812
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.339 Vali Acc: 0.688 Test Loss: 1.339 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0792226791381836
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.328 Vali Acc: 0.678 Test Loss: 1.328 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.08564829826355
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.702 Test Loss: 1.387 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.291449546813965
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.406 Vali Acc: 0.702 Test Loss: 1.406 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2585339546203613
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.427 Vali Acc: 0.698 Test Loss: 1.427 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 78178
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8401267528533936
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.645 Vali Acc: 0.688 Test Loss: 0.645 Test Acc: 0.688
Validation loss decreased (inf --> -0.687798).  Saving model ...
Epoch: 2 cost time: 2.0325284004211426
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.661 Vali Acc: 0.707 Test Loss: 0.661 Test Acc: 0.707
Validation loss decreased (-0.687798 --> -0.707310).  Saving model ...
Epoch: 3 cost time: 1.9619760513305664
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.693 Vali Acc: 0.634 Test Loss: 0.693 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9061498641967773
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.796 Vali Acc: 0.527 Test Loss: 0.796 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.045484781265259
Epoch: 5, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.763 Vali Acc: 0.634 Test Loss: 0.763 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1491165161132812
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.797 Vali Acc: 0.649 Test Loss: 0.797 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8008568286895752
Epoch: 7, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.043 Vali Acc: 0.712 Test Loss: 1.043 Test Acc: 0.712
Validation loss decreased (-0.707310 --> -0.712185).  Saving model ...
Epoch: 8 cost time: 1.9494717121124268
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.957 Vali Acc: 0.698 Test Loss: 0.957 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7323923110961914
Epoch: 9, Steps: 13 | Train Loss: 0.044 Vali Loss: 0.997 Vali Acc: 0.620 Test Loss: 0.997 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7452151775360107
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.052 Vali Acc: 0.610 Test Loss: 1.052 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9577090740203857
Epoch: 11, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.273 Vali Acc: 0.698 Test Loss: 1.273 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8880095481872559
Epoch: 12, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.112 Vali Acc: 0.629 Test Loss: 1.112 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9192070960998535
Epoch: 13, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.152 Vali Acc: 0.610 Test Loss: 1.152 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.858189582824707
Epoch: 14, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.218 Vali Acc: 0.654 Test Loss: 1.218 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8962299823760986
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.199 Vali Acc: 0.639 Test Loss: 1.199 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8573408126831055
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.221 Vali Acc: 0.649 Test Loss: 1.221 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8155646324157715
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.240 Vali Acc: 0.663 Test Loss: 1.240 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 66626
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.578172206878662
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6267149448394775
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.627 Vali Acc: 0.688 Test Loss: 0.627 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.684577226638794
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5819382667541504
Epoch: 4, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.677 Vali Acc: 0.683 Test Loss: 0.677 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.405271053314209
Epoch: 5, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.792 Vali Acc: 0.571 Test Loss: 0.792 Test Acc: 0.571
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7194020748138428
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.803 Vali Acc: 0.712 Test Loss: 0.803 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8040316104888916
Epoch: 7, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.839 Vali Acc: 0.683 Test Loss: 0.839 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.624093770980835
Epoch: 8, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.889 Vali Acc: 0.654 Test Loss: 0.889 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6205005645751953
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.979 Vali Acc: 0.610 Test Loss: 0.979 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.632157325744629
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.003 Vali Acc: 0.654 Test Loss: 1.003 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6996979713439941
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.077 Vali Acc: 0.639 Test Loss: 1.077 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 55234
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4703192710876465
Epoch: 1, Steps: 13 | Train Loss: 0.763 Vali Loss: 0.630 Vali Acc: 0.702 Test Loss: 0.630 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 1.6107287406921387
Epoch: 2, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.669 Vali Acc: 0.712 Test Loss: 0.669 Test Acc: 0.712
Validation loss decreased (-0.702433 --> -0.712188).  Saving model ...
Epoch: 3 cost time: 1.4323453903198242
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.655 Vali Acc: 0.688 Test Loss: 0.655 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4842557907104492
Epoch: 4, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.675 Vali Acc: 0.668 Test Loss: 0.675 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4667587280273438
Epoch: 5, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.712 Vali Acc: 0.683 Test Loss: 0.712 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3945465087890625
Epoch: 6, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.742 Vali Acc: 0.678 Test Loss: 0.742 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.488346815109253
Epoch: 7, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.801 Vali Acc: 0.673 Test Loss: 0.801 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6266872882843018
Epoch: 8, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.794 Vali Acc: 0.659 Test Loss: 0.794 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.482130765914917
Epoch: 9, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.888 Vali Acc: 0.659 Test Loss: 0.888 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7039639949798584
Epoch: 10, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.7205696105957031
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.962 Vali Acc: 0.639 Test Loss: 0.962 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7633419036865234
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.074 Vali Acc: 0.654 Test Loss: 1.074 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 47746
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.498804807662964
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.614 Vali Acc: 0.663 Test Loss: 0.614 Test Acc: 0.663
Validation loss decreased (inf --> -0.663408).  Saving model ...
Epoch: 2 cost time: 1.484043836593628
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
Validation loss decreased (-0.663408 --> -0.697555).  Saving model ...
Epoch: 3 cost time: 1.3461153507232666
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.595 Vali Acc: 0.693 Test Loss: 0.595 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4236998558044434
Epoch: 4, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.608 Vali Acc: 0.678 Test Loss: 0.608 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4693617820739746
Epoch: 5, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.643 Vali Acc: 0.624 Test Loss: 0.643 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5243463516235352
Epoch: 6, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.662 Vali Acc: 0.654 Test Loss: 0.662 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3618810176849365
Epoch: 7, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.723 Vali Acc: 0.634 Test Loss: 0.723 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.480163335800171
Epoch: 8, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.781 Vali Acc: 0.644 Test Loss: 0.781 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4481818675994873
Epoch: 9, Steps: 13 | Train Loss: 0.151 Vali Loss: 0.833 Vali Acc: 0.649 Test Loss: 0.833 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6768617630004883
Epoch: 10, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.902 Vali Acc: 0.615 Test Loss: 0.902 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5210700035095215
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.022 Vali Acc: 0.585 Test Loss: 1.022 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5254127979278564
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.113 Vali Acc: 0.649 Test Loss: 1.113 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 44178
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.6154539585113525
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.696 Vali Acc: 0.522 Test Loss: 0.696 Test Acc: 0.522
Validation loss decreased (inf --> -0.521944).  Saving model ...
Epoch: 2 cost time: 3.741659164428711
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.644 Vali Acc: 0.712 Test Loss: 0.644 Test Acc: 0.712
Validation loss decreased (-0.521944 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 3.7408506870269775
Epoch: 3, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.757 Vali Acc: 0.580 Test Loss: 0.757 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8367972373962402
Epoch: 4, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.824 Vali Acc: 0.673 Test Loss: 0.824 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.813175916671753
Epoch: 5, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.324 Vali Acc: 0.712 Test Loss: 1.324 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.919127941131592
Epoch: 6, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.171 Vali Acc: 0.551 Test Loss: 1.171 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.1008830070495605
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.213 Vali Acc: 0.693 Test Loss: 1.213 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.138517141342163
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.683 Test Loss: 1.276 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.985999822616577
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.673 Test Loss: 1.297 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.576993703842163
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.668 Test Loss: 1.350 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.5682809352874756
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.401 Vali Acc: 0.673 Test Loss: 1.401 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.104000568389893
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.453 Vali Acc: 0.688 Test Loss: 1.453 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 147170
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.114359378814697
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.624 Vali Acc: 0.712 Test Loss: 0.624 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.5357909202575684
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.658 Vali Acc: 0.620 Test Loss: 0.658 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5957863330841064
Epoch: 3, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.687 Vali Acc: 0.702 Test Loss: 0.687 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5481507778167725
Epoch: 4, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.919 Vali Acc: 0.454 Test Loss: 0.919 Test Acc: 0.454
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.523460865020752
Epoch: 5, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.048 Vali Acc: 0.473 Test Loss: 1.048 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.582186460494995
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.861 Vali Acc: 0.673 Test Loss: 0.861 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.469168186187744
Epoch: 7, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.895 Vali Acc: 0.629 Test Loss: 0.895 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.489619493484497
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 0.982 Vali Acc: 0.634 Test Loss: 0.982 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4938714504241943
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.061 Vali Acc: 0.654 Test Loss: 1.061 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4941909313201904
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.199 Vali Acc: 0.693 Test Loss: 1.199 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4880213737487793
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.165 Vali Acc: 0.668 Test Loss: 1.165 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 86818
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.476109504699707
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.634 Vali Acc: 0.659 Test Loss: 0.634 Test Acc: 0.659
Validation loss decreased (inf --> -0.658530).  Saving model ...
Epoch: 2 cost time: 2.0749354362487793
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.661 Vali Acc: 0.649 Test Loss: 0.661 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.046750783920288
Epoch: 3, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.723 Vali Acc: 0.610 Test Loss: 0.723 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8469793796539307
Epoch: 4, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.773 Vali Acc: 0.678 Test Loss: 0.773 Test Acc: 0.678
Validation loss decreased (-0.658530 --> -0.678041).  Saving model ...
Epoch: 5 cost time: 1.8704020977020264
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.854 Vali Acc: 0.654 Test Loss: 0.854 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9220435619354248
Epoch: 6, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.908 Vali Acc: 0.615 Test Loss: 0.908 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9585120677947998
Epoch: 7, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.992 Vali Acc: 0.644 Test Loss: 0.992 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.977290153503418
Epoch: 8, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.099 Vali Acc: 0.688 Test Loss: 1.099 Test Acc: 0.688
Validation loss decreased (-0.678041 --> -0.687794).  Saving model ...
Epoch: 9 cost time: 1.9503169059753418
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.130 Vali Acc: 0.688 Test Loss: 1.130 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.076758861541748
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.231 Vali Acc: 0.698 Test Loss: 1.231 Test Acc: 0.698
Validation loss decreased (-0.687794 --> -0.697549).  Saving model ...
Epoch: 11 cost time: 2.0145974159240723
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.211 Vali Acc: 0.659 Test Loss: 1.211 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9287993907928467
Epoch: 12, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.274 Vali Acc: 0.678 Test Loss: 1.274 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8829209804534912
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.308 Vali Acc: 0.673 Test Loss: 1.308 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9139437675476074
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.329 Vali Acc: 0.673 Test Loss: 1.329 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.757948637008667
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.349 Vali Acc: 0.663 Test Loss: 1.349 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7441480159759521
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.407 Vali Acc: 0.698 Test Loss: 1.407 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7936043739318848
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.380 Vali Acc: 0.654 Test Loss: 1.380 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6883113384246826
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.409 Vali Acc: 0.678 Test Loss: 1.409 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.907341718673706
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.428 Vali Acc: 0.678 Test Loss: 1.428 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8594026565551758
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.450 Vali Acc: 0.683 Test Loss: 1.450 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 65506
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5126090049743652
Epoch: 1, Steps: 13 | Train Loss: 0.726 Vali Loss: 0.714 Vali Acc: 0.722 Test Loss: 0.714 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.7156119346618652
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.640 Vali Acc: 0.693 Test Loss: 0.640 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8131883144378662
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.662 Vali Acc: 0.693 Test Loss: 0.662 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7068531513214111
Epoch: 4, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.717 Vali Acc: 0.649 Test Loss: 0.717 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.73101806640625
Epoch: 5, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.764 Vali Acc: 0.649 Test Loss: 0.764 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6297047138214111
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.826 Vali Acc: 0.688 Test Loss: 0.826 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6279268264770508
Epoch: 7, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7693188190460205
Epoch: 8, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.923 Vali Acc: 0.649 Test Loss: 0.923 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6899776458740234
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.007 Vali Acc: 0.673 Test Loss: 1.007 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6625428199768066
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7792973518371582
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.092 Vali Acc: 0.678 Test Loss: 1.092 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 53954
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2435834407806396
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.436793565750122
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.656 Vali Acc: 0.620 Test Loss: 0.656 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4559135437011719
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.626 Vali Acc: 0.712 Test Loss: 0.626 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5643670558929443
Epoch: 4, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.646 Vali Acc: 0.688 Test Loss: 0.646 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.486034870147705
Epoch: 5, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.716 Vali Acc: 0.629 Test Loss: 0.716 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.430870771408081
Epoch: 6, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.753 Vali Acc: 0.600 Test Loss: 0.753 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5401873588562012
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.791 Vali Acc: 0.649 Test Loss: 0.791 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4892983436584473
Epoch: 8, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.880 Vali Acc: 0.585 Test Loss: 0.880 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.590674638748169
Epoch: 9, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.928 Vali Acc: 0.620 Test Loss: 0.928 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4799885749816895
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5272204875946045
Epoch: 11, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.051 Vali Acc: 0.595 Test Loss: 1.051 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 42562
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1936886310577393
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5371789932250977
Epoch: 2, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.628 Vali Acc: 0.727 Test Loss: 0.628 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5285985469818115
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.634 Vali Acc: 0.707 Test Loss: 0.634 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6268348693847656
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.52535080909729
Epoch: 5, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.682 Vali Acc: 0.678 Test Loss: 0.682 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4194731712341309
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.711 Vali Acc: 0.683 Test Loss: 0.711 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5404412746429443
Epoch: 7, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.487009048461914
Epoch: 8, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.796 Vali Acc: 0.693 Test Loss: 0.796 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5107247829437256
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.815 Vali Acc: 0.663 Test Loss: 0.815 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2126445770263672
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.889 Vali Acc: 0.678 Test Loss: 0.889 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3361296653747559
Epoch: 11, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.921 Vali Acc: 0.659 Test Loss: 0.921 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 35074
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1727006435394287
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3570795059204102
Epoch: 2, Steps: 13 | Train Loss: 0.621 Vali Loss: 0.620 Vali Acc: 0.717 Test Loss: 0.620 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4344589710235596
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.3524246215820312
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.612 Vali Acc: 0.673 Test Loss: 0.612 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4497296810150146
Epoch: 5, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.628 Vali Acc: 0.659 Test Loss: 0.628 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4254391193389893
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.660 Vali Acc: 0.659 Test Loss: 0.660 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4728848934173584
Epoch: 7, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.694 Vali Acc: 0.668 Test Loss: 0.694 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3730518817901611
Epoch: 8, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.761 Vali Acc: 0.649 Test Loss: 0.761 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3690474033355713
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.818 Vali Acc: 0.600 Test Loss: 0.818 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3044302463531494
Epoch: 10, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.843 Vali Acc: 0.624 Test Loss: 0.843 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3392605781555176
Epoch: 11, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.918 Vali Acc: 0.605 Test Loss: 0.918 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3768196105957031
Epoch: 12, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.958 Vali Acc: 0.620 Test Loss: 0.958 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3869390487670898
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.044 Vali Acc: 0.615 Test Loss: 1.044 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 31506
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.817550420761108
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.615 Vali Acc: 0.683 Test Loss: 0.615 Test Acc: 0.683
Validation loss decreased (inf --> -0.682921).  Saving model ...
Epoch: 2 cost time: 4.107561111450195
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
Validation loss decreased (-0.682921 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 4.075285911560059
Epoch: 3, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.729 Vali Acc: 0.634 Test Loss: 0.729 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.160893678665161
Epoch: 4, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.285520315170288
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.030 Vali Acc: 0.654 Test Loss: 1.030 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.834334373474121
Epoch: 6, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.253 Vali Acc: 0.698 Test Loss: 1.253 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.092069864273071
Epoch: 7, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.405 Vali Acc: 0.512 Test Loss: 1.405 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9196345806121826
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.373 Vali Acc: 0.629 Test Loss: 1.373 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7520551681518555
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.401 Vali Acc: 0.634 Test Loss: 1.401 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.9448728561401367
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.405 Vali Acc: 0.659 Test Loss: 1.405 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.164282560348511
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.693 Test Loss: 1.527 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.281829357147217
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.460 Vali Acc: 0.639 Test Loss: 1.460 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 140834
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.008131742477417
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.981325626373291
Epoch: 2, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.657 Vali Acc: 0.727 Test Loss: 0.657 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 3.134666681289673
Epoch: 3, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.720 Vali Acc: 0.727 Test Loss: 0.720 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1743733882904053
Epoch: 4, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.748 Vali Acc: 0.590 Test Loss: 0.748 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.232158899307251
Epoch: 5, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.763 Vali Acc: 0.688 Test Loss: 0.763 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1039910316467285
Epoch: 6, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.827 Vali Acc: 0.649 Test Loss: 0.827 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0101141929626465
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.900 Vali Acc: 0.668 Test Loss: 0.900 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.20859956741333
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 0.988 Vali Acc: 0.693 Test Loss: 0.988 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.127232074737549
Epoch: 9, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.019 Vali Acc: 0.678 Test Loss: 1.019 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.336801052093506
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.113 Vali Acc: 0.673 Test Loss: 1.113 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.253051996231079
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.130 Vali Acc: 0.673 Test Loss: 1.130 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1640522480010986
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.168 Vali Acc: 0.678 Test Loss: 1.168 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 80482
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.261561155319214
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.620 Vali Acc: 0.707 Test Loss: 0.620 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.5743653774261475
Epoch: 2, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.647 Vali Acc: 0.683 Test Loss: 0.647 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5859529972076416
Epoch: 3, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.692 Vali Acc: 0.673 Test Loss: 0.692 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5829622745513916
Epoch: 4, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.725 Vali Acc: 0.668 Test Loss: 0.725 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.789661407470703
Epoch: 5, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.797 Vali Acc: 0.644 Test Loss: 0.797 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7764523029327393
Epoch: 6, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.907 Vali Acc: 0.688 Test Loss: 0.907 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5757253170013428
Epoch: 7, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.990 Vali Acc: 0.610 Test Loss: 0.990 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.69649076461792
Epoch: 8, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7459287643432617
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.158 Vali Acc: 0.595 Test Loss: 1.158 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.730304002761841
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.166 Vali Acc: 0.654 Test Loss: 1.166 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7651190757751465
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.280 Vali Acc: 0.693 Test Loss: 1.280 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 59170
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.1233720779418945
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.648 Vali Acc: 0.712 Test Loss: 0.648 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.3381428718566895
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 2.3112728595733643
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.625 Vali Acc: 0.707 Test Loss: 0.625 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6034817695617676
Epoch: 4, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.661 Vali Acc: 0.693 Test Loss: 0.661 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.657125473022461
Epoch: 5, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.801 Vali Acc: 0.546 Test Loss: 0.801 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.603466272354126
Epoch: 6, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.771 Vali Acc: 0.698 Test Loss: 0.771 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6482644081115723
Epoch: 7, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.828 Vali Acc: 0.702 Test Loss: 0.828 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.801471710205078
Epoch: 8, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.890 Vali Acc: 0.698 Test Loss: 0.890 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6741161346435547
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.939 Vali Acc: 0.688 Test Loss: 0.939 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.413022518157959
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.077 Vali Acc: 0.717 Test Loss: 1.077 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4508626461029053
Epoch: 11, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.103 Vali Acc: 0.717 Test Loss: 1.103 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.435487985610962
Epoch: 12, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.092 Vali Acc: 0.624 Test Loss: 1.092 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 47618
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.216877698898315
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.616 Vali Acc: 0.707 Test Loss: 0.616 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.5375547409057617
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.640 Vali Acc: 0.659 Test Loss: 0.640 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5347752571105957
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717066).  Saving model ...
Epoch: 4 cost time: 2.480956554412842
Epoch: 4, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.695 Vali Acc: 0.702 Test Loss: 0.695 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4783639907836914
Epoch: 5, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.743 Vali Acc: 0.698 Test Loss: 0.743 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.404555082321167
Epoch: 6, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.808 Vali Acc: 0.702 Test Loss: 0.808 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2416467666625977
Epoch: 7, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.843 Vali Acc: 0.634 Test Loss: 0.843 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2962710857391357
Epoch: 8, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.943 Vali Acc: 0.605 Test Loss: 0.943 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.327291250228882
Epoch: 9, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.020 Vali Acc: 0.688 Test Loss: 1.020 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.175785541534424
Epoch: 10, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.050 Vali Acc: 0.605 Test Loss: 1.050 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.111623525619507
Epoch: 11, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.089 Vali Acc: 0.629 Test Loss: 1.089 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3311398029327393
Epoch: 12, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.413447618484497
Epoch: 13, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.201 Vali Acc: 0.678 Test Loss: 1.201 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 36226
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.041900873184204
Epoch: 1, Steps: 13 | Train Loss: 0.722 Vali Loss: 0.631 Vali Acc: 0.639 Test Loss: 0.631 Test Acc: 0.639
Validation loss decreased (inf --> -0.639018).  Saving model ...
Epoch: 2 cost time: 2.5577752590179443
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.656 Vali Acc: 0.698 Test Loss: 0.656 Test Acc: 0.698
Validation loss decreased (-0.639018 --> -0.697554).  Saving model ...
Epoch: 3 cost time: 2.3824028968811035
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.670 Vali Acc: 0.644 Test Loss: 0.670 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4190924167633057
Epoch: 4, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.687 Vali Acc: 0.668 Test Loss: 0.687 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1947133541107178
Epoch: 5, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.704 Vali Acc: 0.673 Test Loss: 0.704 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.364542245864868
Epoch: 6, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.766 Vali Acc: 0.668 Test Loss: 0.766 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.309931993484497
Epoch: 7, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.794 Vali Acc: 0.639 Test Loss: 0.794 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3943235874176025
Epoch: 8, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.852 Vali Acc: 0.644 Test Loss: 0.852 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0211777687072754
Epoch: 9, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.877 Vali Acc: 0.644 Test Loss: 0.877 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.397233009338379
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.011 Vali Acc: 0.649 Test Loss: 1.011 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.459459066390991
Epoch: 11, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.005 Vali Acc: 0.620 Test Loss: 1.005 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4291107654571533
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.055 Vali Acc: 0.639 Test Loss: 1.055 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 28738
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9854633808135986
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.653 Vali Acc: 0.620 Test Loss: 0.653 Test Acc: 0.620
Validation loss decreased (inf --> -0.619506).  Saving model ...
Epoch: 2 cost time: 1.3155264854431152
Epoch: 2, Steps: 13 | Train Loss: 0.641 Vali Loss: 0.628 Vali Acc: 0.693 Test Loss: 0.628 Test Acc: 0.693
Validation loss decreased (-0.619506 --> -0.692677).  Saving model ...
Epoch: 3 cost time: 1.3175256252288818
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.631 Vali Acc: 0.698 Test Loss: 0.631 Test Acc: 0.698
Validation loss decreased (-0.692677 --> -0.697555).  Saving model ...
Epoch: 4 cost time: 1.3891756534576416
Epoch: 4, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.640 Vali Acc: 0.702 Test Loss: 0.640 Test Acc: 0.702
Validation loss decreased (-0.697555 --> -0.702433).  Saving model ...
Epoch: 5 cost time: 1.4045753479003906
Epoch: 5, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.673 Vali Acc: 0.649 Test Loss: 0.673 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3326339721679688
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.694 Vali Acc: 0.663 Test Loss: 0.694 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.464890956878662
Epoch: 7, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.731 Vali Acc: 0.668 Test Loss: 0.731 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.069838523864746
Epoch: 8, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.791 Vali Acc: 0.654 Test Loss: 0.791 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2522203922271729
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.843 Vali Acc: 0.649 Test Loss: 0.843 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2833139896392822
Epoch: 10, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.909 Vali Acc: 0.654 Test Loss: 0.909 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2095260620117188
Epoch: 11, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.011 Vali Acc: 0.639 Test Loss: 1.011 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3983254432678223
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.062 Vali Acc: 0.644 Test Loss: 1.062 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4810924530029297
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.117 Vali Acc: 0.634 Test Loss: 1.117 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3990757465362549
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.186 Vali Acc: 0.620 Test Loss: 1.186 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el3_dm16_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 25170
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 10.459701538085938
Epoch: 1, Steps: 13 | Train Loss: 1.552 Vali Loss: 1.381 Vali Acc: 0.717 Test Loss: 1.381 Test Acc: 0.717
Validation loss decreased (inf --> -0.717059).  Saving model ...
Epoch: 2 cost time: 8.079509973526001
Epoch: 2, Steps: 13 | Train Loss: 1.531 Vali Loss: 3.275 Vali Acc: 0.420 Test Loss: 3.275 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.078066349029541
Epoch: 3, Steps: 13 | Train Loss: 0.415 Vali Loss: 2.862 Vali Acc: 0.590 Test Loss: 2.862 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.180697441101074
Epoch: 4, Steps: 13 | Train Loss: 0.263 Vali Loss: 3.562 Vali Acc: 0.693 Test Loss: 3.562 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.538640260696411
Epoch: 5, Steps: 13 | Train Loss: 0.230 Vali Loss: 5.830 Vali Acc: 0.463 Test Loss: 5.830 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.495213031768799
Epoch: 6, Steps: 13 | Train Loss: 0.967 Vali Loss: 7.768 Vali Acc: 0.429 Test Loss: 7.768 Test Acc: 0.429
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.082268953323364
Epoch: 7, Steps: 13 | Train Loss: 0.795 Vali Loss: 6.664 Vali Acc: 0.517 Test Loss: 6.664 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.923539638519287
Epoch: 8, Steps: 13 | Train Loss: 0.232 Vali Loss: 6.689 Vali Acc: 0.610 Test Loss: 6.689 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.069130659103394
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 8.736 Vali Acc: 0.673 Test Loss: 8.736 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.39733338356018
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 10.446 Vali Acc: 0.702 Test Loss: 10.446 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.449966192245483
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 9.258 Vali Acc: 0.527 Test Loss: 9.258 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 1312898
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.377417802810669
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 1.003 Vali Acc: 0.722 Test Loss: 1.003 Test Acc: 0.722
Validation loss decreased (inf --> -0.721941).  Saving model ...
Epoch: 2 cost time: 4.566725254058838
Epoch: 2, Steps: 13 | Train Loss: 0.364 Vali Loss: 1.768 Vali Acc: 0.468 Test Loss: 1.768 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.938804626464844
Epoch: 3, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.641 Vali Acc: 0.663 Test Loss: 1.641 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.725523471832275
Epoch: 4, Steps: 13 | Train Loss: 0.128 Vali Loss: 2.265 Vali Acc: 0.659 Test Loss: 2.265 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.0147929191589355
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 3.906 Vali Acc: 0.702 Test Loss: 3.906 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.863489389419556
Epoch: 6, Steps: 13 | Train Loss: 0.174 Vali Loss: 3.384 Vali Acc: 0.585 Test Loss: 3.384 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.784250259399414
Epoch: 7, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.412 Vali Acc: 0.634 Test Loss: 4.412 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.697897434234619
Epoch: 8, Steps: 13 | Train Loss: 0.087 Vali Loss: 5.057 Vali Acc: 0.561 Test Loss: 5.057 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.621949672698975
Epoch: 9, Steps: 13 | Train Loss: 0.134 Vali Loss: 5.985 Vali Acc: 0.507 Test Loss: 5.985 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.648184537887573
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 5.630 Vali Acc: 0.654 Test Loss: 5.630 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.6574530601501465
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 6.236 Vali Acc: 0.580 Test Loss: 6.236 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 830082
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.857090711593628
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.824 Vali Acc: 0.517 Test Loss: 0.824 Test Acc: 0.517
Validation loss decreased (inf --> -0.517065).  Saving model ...
Epoch: 2 cost time: 3.3067023754119873
Epoch: 2, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.028 Vali Acc: 0.688 Test Loss: 1.028 Test Acc: 0.688
Validation loss decreased (-0.517065 --> -0.687795).  Saving model ...
Epoch: 3 cost time: 3.1656506061553955
Epoch: 3, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.260 Vali Acc: 0.717 Test Loss: 2.260 Test Acc: 0.717
Validation loss decreased (-0.687795 --> -0.717051).  Saving model ...
Epoch: 4 cost time: 3.0170280933380127
Epoch: 4, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.836 Vali Acc: 0.639 Test Loss: 1.836 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.975207805633545
Epoch: 5, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.426 Vali Acc: 0.595 Test Loss: 2.426 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.184269666671753
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.195 Vali Acc: 0.561 Test Loss: 3.195 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1326398849487305
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 3.101 Vali Acc: 0.615 Test Loss: 3.101 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0237128734588623
Epoch: 8, Steps: 13 | Train Loss: 0.031 Vali Loss: 3.168 Vali Acc: 0.668 Test Loss: 3.168 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1338751316070557
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 3.636 Vali Acc: 0.634 Test Loss: 3.636 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7795026302337646
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.945 Vali Acc: 0.580 Test Loss: 3.945 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.431144952774048
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.054 Vali Acc: 0.595 Test Loss: 4.054 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.612571954727173
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 4.482 Vali Acc: 0.629 Test Loss: 4.482 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5563671588897705
Epoch: 13, Steps: 13 | Train Loss: 0.030 Vali Loss: 5.202 Vali Acc: 0.644 Test Loss: 5.202 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 659586
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.010257244110107
Epoch: 1, Steps: 13 | Train Loss: 0.809 Vali Loss: 1.098 Vali Acc: 0.366 Test Loss: 1.098 Test Acc: 0.366
Validation loss decreased (inf --> -0.365843).  Saving model ...
Epoch: 2 cost time: 2.4925947189331055
Epoch: 2, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.966 Vali Acc: 0.702 Test Loss: 0.966 Test Acc: 0.702
Validation loss decreased (-0.365843 --> -0.702429).  Saving model ...
Epoch: 3 cost time: 2.5742664337158203
Epoch: 3, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.359 Vali Acc: 0.693 Test Loss: 1.359 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.574615001678467
Epoch: 4, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.790 Vali Acc: 0.698 Test Loss: 1.790 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.471999168395996
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.079 Vali Acc: 0.698 Test Loss: 2.079 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3640646934509277
Epoch: 6, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.046 Vali Acc: 0.654 Test Loss: 2.046 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3881916999816895
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.523 Vali Acc: 0.639 Test Loss: 2.523 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4853689670562744
Epoch: 8, Steps: 13 | Train Loss: 0.076 Vali Loss: 3.877 Vali Acc: 0.459 Test Loss: 3.877 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.426175355911255
Epoch: 9, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.957 Vali Acc: 0.634 Test Loss: 2.957 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4548251628875732
Epoch: 10, Steps: 13 | Train Loss: 0.022 Vali Loss: 3.329 Vali Acc: 0.629 Test Loss: 3.329 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3020029067993164
Epoch: 11, Steps: 13 | Train Loss: 0.025 Vali Loss: 4.238 Vali Acc: 0.517 Test Loss: 4.238 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3634400367736816
Epoch: 12, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.943 Vali Acc: 0.678 Test Loss: 3.943 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 567170
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7632436752319336
Epoch: 1, Steps: 13 | Train Loss: 0.674 Vali Loss: 0.931 Vali Acc: 0.434 Test Loss: 0.931 Test Acc: 0.434
Validation loss decreased (inf --> -0.434137).  Saving model ...
Epoch: 2 cost time: 1.8544039726257324
Epoch: 2, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.957 Vali Acc: 0.498 Test Loss: 0.957 Test Acc: 0.498
Validation loss decreased (-0.434137 --> -0.497551).  Saving model ...
Epoch: 3 cost time: 1.8458778858184814
Epoch: 3, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.089 Vali Acc: 0.634 Test Loss: 1.089 Test Acc: 0.634
Validation loss decreased (-0.497551 --> -0.634135).  Saving model ...
Epoch: 4 cost time: 1.8188323974609375
Epoch: 4, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.387 Vali Acc: 0.649 Test Loss: 1.387 Test Acc: 0.649
Validation loss decreased (-0.634135 --> -0.648767).  Saving model ...
Epoch: 5 cost time: 1.8418784141540527
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.653 Vali Acc: 0.639 Test Loss: 1.653 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0078606605529785
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.819 Vali Acc: 0.644 Test Loss: 1.819 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1788153648376465
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.890 Vali Acc: 0.639 Test Loss: 1.890 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1229896545410156
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.629 Test Loss: 1.934 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0510165691375732
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.624 Test Loss: 1.975 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0839364528656006
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.624 Test Loss: 2.001 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0993738174438477
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.021 Vali Acc: 0.634 Test Loss: 2.021 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.097134590148926
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.037 Vali Acc: 0.644 Test Loss: 2.037 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.1452527046203613
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.053 Vali Acc: 0.639 Test Loss: 2.053 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.30310320854187
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.639 Test Loss: 2.062 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6487804878048781
model parameter : 476034
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.488593816757202
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (inf --> -0.717065).  Saving model ...
Epoch: 2 cost time: 1.7147467136383057
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.598588228225708
Epoch: 3, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.909 Vali Acc: 0.663 Test Loss: 0.909 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6483330726623535
Epoch: 4, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.157 Vali Acc: 0.644 Test Loss: 1.157 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.728132963180542
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.362 Vali Acc: 0.659 Test Loss: 1.362 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6601107120513916
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.573 Vali Acc: 0.663 Test Loss: 1.573 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.802201509475708
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.633 Vali Acc: 0.673 Test Loss: 1.633 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7221498489379883
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.673 Test Loss: 1.716 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7806658744812012
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.663 Test Loss: 1.724 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8211572170257568
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.659 Test Loss: 1.746 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.763070821762085
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.654 Test Loss: 1.768 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 416130
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.494947910308838
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8504962921142578
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.901 Vali Acc: 0.488 Test Loss: 0.901 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.982799768447876
Epoch: 3, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.928 Vali Acc: 0.585 Test Loss: 0.928 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8830461502075195
Epoch: 4, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.229 Vali Acc: 0.683 Test Loss: 1.229 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9046554565429688
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.314 Vali Acc: 0.644 Test Loss: 1.314 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9474852085113525
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.459 Vali Acc: 0.629 Test Loss: 1.459 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.95231032371521
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.623 Vali Acc: 0.659 Test Loss: 1.623 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9782922267913818
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.600 Test Loss: 1.689 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9469366073608398
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.624 Test Loss: 1.749 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.82759690284729
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.629 Test Loss: 1.787 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7537763118743896
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.620 Test Loss: 1.801 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 387586
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.460599660873413
Epoch: 1, Steps: 13 | Train Loss: 0.918 Vali Loss: 3.690 Vali Acc: 0.288 Test Loss: 3.690 Test Acc: 0.288
Validation loss decreased (inf --> -0.287768).  Saving model ...
Epoch: 2 cost time: 6.773051023483276
Epoch: 2, Steps: 13 | Train Loss: 0.722 Vali Loss: 1.879 Vali Acc: 0.590 Test Loss: 1.879 Test Acc: 0.590
Validation loss decreased (-0.287768 --> -0.590225).  Saving model ...
Epoch: 3 cost time: 6.777977705001831
Epoch: 3, Steps: 13 | Train Loss: 0.423 Vali Loss: 2.532 Vali Acc: 0.571 Test Loss: 2.532 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.88252329826355
Epoch: 4, Steps: 13 | Train Loss: 0.176 Vali Loss: 3.535 Vali Acc: 0.512 Test Loss: 3.535 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.796127080917358
Epoch: 5, Steps: 13 | Train Loss: 0.148 Vali Loss: 4.365 Vali Acc: 0.702 Test Loss: 4.365 Test Acc: 0.702
Validation loss decreased (-0.590225 --> -0.702395).  Saving model ...
Epoch: 6 cost time: 6.835162162780762
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 4.811 Vali Acc: 0.629 Test Loss: 4.811 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.835158586502075
Epoch: 7, Steps: 13 | Train Loss: 0.173 Vali Loss: 6.649 Vali Acc: 0.512 Test Loss: 6.649 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.4647910594940186
Epoch: 8, Steps: 13 | Train Loss: 0.087 Vali Loss: 6.001 Vali Acc: 0.556 Test Loss: 6.001 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.463817834854126
Epoch: 9, Steps: 13 | Train Loss: 0.293 Vali Loss: 7.704 Vali Acc: 0.654 Test Loss: 7.704 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.0614399909973145
Epoch: 10, Steps: 13 | Train Loss: 0.318 Vali Loss: 7.470 Vali Acc: 0.571 Test Loss: 7.470 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.980752944946289
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 7.677 Vali Acc: 0.576 Test Loss: 7.677 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.9339072704315186
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 9.870 Vali Acc: 0.527 Test Loss: 9.870 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.953381776809692
Epoch: 13, Steps: 13 | Train Loss: 0.455 Vali Loss: 13.948 Vali Acc: 0.444 Test Loss: 13.948 Test Acc: 0.444
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.850887775421143
Epoch: 14, Steps: 13 | Train Loss: 0.077 Vali Loss: 13.349 Vali Acc: 0.498 Test Loss: 13.349 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.774447679519653
Epoch: 15, Steps: 13 | Train Loss: 0.266 Vali Loss: 12.167 Vali Acc: 0.663 Test Loss: 12.167 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 1247106
model size : 7.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.099469423294067
Epoch: 1, Steps: 13 | Train Loss: 0.840 Vali Loss: 1.253 Vali Acc: 0.717 Test Loss: 1.253 Test Acc: 0.717
Validation loss decreased (inf --> -0.717061).  Saving model ...
Epoch: 2 cost time: 3.632615327835083
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.511 Vali Acc: 0.498 Test Loss: 1.511 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.587602376937866
Epoch: 3, Steps: 13 | Train Loss: 0.265 Vali Loss: 1.690 Vali Acc: 0.634 Test Loss: 1.690 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.826350688934326
Epoch: 4, Steps: 13 | Train Loss: 0.130 Vali Loss: 2.797 Vali Acc: 0.678 Test Loss: 2.797 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.689906597137451
Epoch: 5, Steps: 13 | Train Loss: 0.155 Vali Loss: 3.219 Vali Acc: 0.668 Test Loss: 3.219 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6964030265808105
Epoch: 6, Steps: 13 | Train Loss: 0.085 Vali Loss: 5.859 Vali Acc: 0.702 Test Loss: 5.859 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.641934394836426
Epoch: 7, Steps: 13 | Train Loss: 0.077 Vali Loss: 4.959 Vali Acc: 0.644 Test Loss: 4.959 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.6974246501922607
Epoch: 8, Steps: 13 | Train Loss: 0.102 Vali Loss: 4.464 Vali Acc: 0.629 Test Loss: 4.464 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.8209002017974854
Epoch: 9, Steps: 13 | Train Loss: 0.092 Vali Loss: 5.466 Vali Acc: 0.693 Test Loss: 5.466 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.9081168174743652
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 5.116 Vali Acc: 0.702 Test Loss: 5.116 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.900376796722412
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 6.626 Vali Acc: 0.698 Test Loss: 6.626 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 764290
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.419655799865723
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.656 Vali Acc: 0.688 Test Loss: 0.656 Test Acc: 0.688
Validation loss decreased (inf --> -0.687798).  Saving model ...
Epoch: 2 cost time: 2.606552839279175
Epoch: 2, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.212 Vali Acc: 0.566 Test Loss: 1.212 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6530754566192627
Epoch: 3, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.552 Vali Acc: 0.629 Test Loss: 1.552 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.507552146911621
Epoch: 4, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.994 Vali Acc: 0.659 Test Loss: 1.994 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.726757287979126
Epoch: 5, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.676 Vali Acc: 0.678 Test Loss: 2.676 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.743962287902832
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.513 Vali Acc: 0.659 Test Loss: 2.513 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.741140604019165
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.841 Vali Acc: 0.629 Test Loss: 2.841 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7895309925079346
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.152 Vali Acc: 0.629 Test Loss: 3.152 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.826181411743164
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 3.812 Vali Acc: 0.624 Test Loss: 3.812 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6626923084259033
Epoch: 10, Steps: 13 | Train Loss: 0.081 Vali Loss: 3.996 Vali Acc: 0.663 Test Loss: 3.996 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.742335796356201
Epoch: 11, Steps: 13 | Train Loss: 0.151 Vali Loss: 5.583 Vali Acc: 0.532 Test Loss: 5.583 Test Acc: 0.532
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 593794
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.149227619171143
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.687 Vali Acc: 0.644 Test Loss: 0.687 Test Acc: 0.644
Validation loss decreased (inf --> -0.643896).  Saving model ...
Epoch: 2 cost time: 2.626819133758545
Epoch: 2, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.934 Vali Acc: 0.610 Test Loss: 0.934 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6647160053253174
Epoch: 3, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.316 Vali Acc: 0.620 Test Loss: 1.316 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.566166400909424
Epoch: 4, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.672 Vali Acc: 0.673 Test Loss: 1.672 Test Acc: 0.673
Validation loss decreased (-0.643896 --> -0.673154).  Saving model ...
Epoch: 5 cost time: 2.2531325817108154
Epoch: 5, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.006 Vali Acc: 0.659 Test Loss: 2.006 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.348198175430298
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.202 Vali Acc: 0.649 Test Loss: 2.202 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.398893117904663
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.270 Vali Acc: 0.615 Test Loss: 2.270 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.435638189315796
Epoch: 8, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.624 Test Loss: 2.369 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6594839096069336
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.381 Vali Acc: 0.620 Test Loss: 2.381 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.59053635597229
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.369 Vali Acc: 0.624 Test Loss: 2.369 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6982810497283936
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.417 Vali Acc: 0.654 Test Loss: 2.417 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.494900941848755
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.391 Vali Acc: 0.639 Test Loss: 2.391 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8835785388946533
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.392 Vali Acc: 0.615 Test Loss: 2.392 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6599812507629395
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.398 Vali Acc: 0.634 Test Loss: 2.398 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6731707317073171
model parameter : 501378
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6126515865325928
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.682 Vali Acc: 0.610 Test Loss: 0.682 Test Acc: 0.610
Validation loss decreased (inf --> -0.609749).  Saving model ...
Epoch: 2 cost time: 1.9689149856567383
Epoch: 2, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.801 Vali Acc: 0.654 Test Loss: 0.801 Test Acc: 0.654
Validation loss decreased (-0.609749 --> -0.653651).  Saving model ...
Epoch: 3 cost time: 1.7774479389190674
Epoch: 3, Steps: 13 | Train Loss: 0.098 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.009533643722534
Epoch: 4, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.354 Vali Acc: 0.605 Test Loss: 1.354 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0799167156219482
Epoch: 5, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.606 Vali Acc: 0.649 Test Loss: 1.606 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.110374927520752
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.848 Vali Acc: 0.639 Test Loss: 1.848 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1386263370513916
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.227 Vali Acc: 0.541 Test Loss: 2.227 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1221752166748047
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.705 Vali Acc: 0.683 Test Loss: 2.705 Test Acc: 0.683
Validation loss decreased (-0.653651 --> -0.682900).  Saving model ...
Epoch: 9 cost time: 2.0824692249298096
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.810 Vali Acc: 0.517 Test Loss: 2.810 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0547282695770264
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.703 Vali Acc: 0.639 Test Loss: 2.703 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9167027473449707
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.590 Test Loss: 2.718 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9822640419006348
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.818 Vali Acc: 0.546 Test Loss: 2.818 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1760504245758057
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.783 Vali Acc: 0.571 Test Loss: 2.783 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0537359714508057
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.812 Vali Acc: 0.639 Test Loss: 2.812 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.06406831741333
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.798 Vali Acc: 0.605 Test Loss: 2.798 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.2188243865966797
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.590 Test Loss: 2.810 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9492228031158447
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.590 Test Loss: 2.810 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0362584590911865
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.811 Vali Acc: 0.595 Test Loss: 2.811 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6829268292682927
model parameter : 410242
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.540286064147949
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.595 Vali Acc: 0.727 Test Loss: 0.595 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.9376788139343262
Epoch: 2, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.788 Vali Acc: 0.615 Test Loss: 0.788 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9212658405303955
Epoch: 3, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.993 Vali Acc: 0.683 Test Loss: 0.993 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.732090950012207
Epoch: 4, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.184 Vali Acc: 0.678 Test Loss: 1.184 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7263898849487305
Epoch: 5, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.353 Vali Acc: 0.649 Test Loss: 1.353 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6326167583465576
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.499 Vali Acc: 0.634 Test Loss: 1.499 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6662826538085938
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.673 Vali Acc: 0.673 Test Loss: 1.673 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7660002708435059
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.659 Test Loss: 1.802 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7849676609039307
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.930 Vali Acc: 0.673 Test Loss: 1.930 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.784813642501831
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.649 Test Loss: 1.855 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7434921264648438
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.668 Test Loss: 1.887 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 350338
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.615513801574707
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.633 Vali Acc: 0.712 Test Loss: 0.633 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.0088510513305664
Epoch: 2, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.742 Vali Acc: 0.659 Test Loss: 0.742 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0072669982910156
Epoch: 3, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.931 Vali Acc: 0.595 Test Loss: 0.931 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1998186111450195
Epoch: 4, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.239 Vali Acc: 0.551 Test Loss: 1.239 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.931229829788208
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.340 Vali Acc: 0.639 Test Loss: 1.340 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0363099575042725
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.465 Vali Acc: 0.615 Test Loss: 1.465 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.031728982925415
Epoch: 7, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.627 Vali Acc: 0.629 Test Loss: 1.627 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.062481641769409
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.717 Vali Acc: 0.615 Test Loss: 1.717 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.087001323699951
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.850 Vali Acc: 0.610 Test Loss: 1.850 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.997955322265625
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.985 Vali Acc: 0.639 Test Loss: 1.985 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9283945560455322
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.024 Vali Acc: 0.595 Test Loss: 2.024 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 321794
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.490682601928711
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.791 Vali Acc: 0.693 Test Loss: 0.791 Test Acc: 0.693
Validation loss decreased (inf --> -0.692675).  Saving model ...
Epoch: 2 cost time: 6.028506278991699
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 6.728 Vali Acc: 0.288 Test Loss: 6.728 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.135916233062744
Epoch: 3, Steps: 13 | Train Loss: 0.378 Vali Loss: 3.026 Vali Acc: 0.698 Test Loss: 3.026 Test Acc: 0.698
Validation loss decreased (-0.692675 --> -0.697531).  Saving model ...
Epoch: 4 cost time: 6.146996021270752
Epoch: 4, Steps: 13 | Train Loss: 0.189 Vali Loss: 3.056 Vali Acc: 0.639 Test Loss: 3.056 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.057921886444092
Epoch: 5, Steps: 13 | Train Loss: 0.198 Vali Loss: 5.848 Vali Acc: 0.707 Test Loss: 5.848 Test Acc: 0.707
Validation loss decreased (-0.697531 --> -0.707259).  Saving model ...
Epoch: 6 cost time: 6.163181304931641
Epoch: 6, Steps: 13 | Train Loss: 0.204 Vali Loss: 5.133 Vali Acc: 0.654 Test Loss: 5.133 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.395511627197266
Epoch: 7, Steps: 13 | Train Loss: 0.957 Vali Loss: 6.020 Vali Acc: 0.659 Test Loss: 6.020 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.436246156692505
Epoch: 8, Steps: 13 | Train Loss: 0.327 Vali Loss: 16.941 Vali Acc: 0.327 Test Loss: 16.941 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.2116944789886475
Epoch: 9, Steps: 13 | Train Loss: 0.736 Vali Loss: 10.426 Vali Acc: 0.488 Test Loss: 10.426 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.13723611831665
Epoch: 10, Steps: 13 | Train Loss: 0.695 Vali Loss: 16.449 Vali Acc: 0.366 Test Loss: 16.449 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.212404251098633
Epoch: 11, Steps: 13 | Train Loss: 0.670 Vali Loss: 12.970 Vali Acc: 0.473 Test Loss: 12.970 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.457789897918701
Epoch: 12, Steps: 13 | Train Loss: 0.072 Vali Loss: 9.656 Vali Acc: 0.634 Test Loss: 9.656 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.410229682922363
Epoch: 13, Steps: 13 | Train Loss: 0.070 Vali Loss: 12.262 Vali Acc: 0.678 Test Loss: 12.262 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.236964464187622
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 11.302 Vali Acc: 0.673 Test Loss: 11.302 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.288408994674683
Epoch: 15, Steps: 13 | Train Loss: 0.044 Vali Loss: 10.777 Vali Acc: 0.663 Test Loss: 10.777 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 1214210
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.762580871582031
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 1.877 Vali Acc: 0.307 Test Loss: 1.877 Test Acc: 0.307
Validation loss decreased (inf --> -0.307298).  Saving model ...
Epoch: 2 cost time: 3.61928391456604
Epoch: 2, Steps: 13 | Train Loss: 0.415 Vali Loss: 1.194 Vali Acc: 0.678 Test Loss: 1.194 Test Acc: 0.678
Validation loss decreased (-0.307298 --> -0.678037).  Saving model ...
Epoch: 3 cost time: 3.672346353530884
Epoch: 3, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.788 Vali Acc: 0.678 Test Loss: 1.788 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3499884605407715
Epoch: 4, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.411 Vali Acc: 0.668 Test Loss: 2.411 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.703256607055664
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 3.624 Vali Acc: 0.683 Test Loss: 3.624 Test Acc: 0.683
Validation loss decreased (-0.678037 --> -0.682891).  Saving model ...
Epoch: 6 cost time: 3.146749973297119
Epoch: 6, Steps: 13 | Train Loss: 0.166 Vali Loss: 4.683 Vali Acc: 0.707 Test Loss: 4.683 Test Acc: 0.707
Validation loss decreased (-0.682891 --> -0.707270).  Saving model ...
Epoch: 7 cost time: 3.2259387969970703
Epoch: 7, Steps: 13 | Train Loss: 0.576 Vali Loss: 4.662 Vali Acc: 0.698 Test Loss: 4.662 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.460646152496338
Epoch: 8, Steps: 13 | Train Loss: 0.142 Vali Loss: 6.370 Vali Acc: 0.717 Test Loss: 6.370 Test Acc: 0.717
Validation loss decreased (-0.707270 --> -0.717009).  Saving model ...
Epoch: 9 cost time: 3.508349895477295
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 6.324 Vali Acc: 0.693 Test Loss: 6.324 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4661378860473633
Epoch: 10, Steps: 13 | Train Loss: 0.153 Vali Loss: 6.339 Vali Acc: 0.678 Test Loss: 6.339 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7489242553710938
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 5.657 Vali Acc: 0.561 Test Loss: 5.657 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9751455783843994
Epoch: 12, Steps: 13 | Train Loss: 0.069 Vali Loss: 8.568 Vali Acc: 0.478 Test Loss: 8.568 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.18172550201416
Epoch: 13, Steps: 13 | Train Loss: 0.233 Vali Loss: 6.372 Vali Acc: 0.600 Test Loss: 6.372 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3669445514678955
Epoch: 14, Steps: 13 | Train Loss: 0.072 Vali Loss: 7.914 Vali Acc: 0.673 Test Loss: 7.914 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.337151050567627
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 7.828 Vali Acc: 0.585 Test Loss: 7.828 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.3688857555389404
Epoch: 16, Steps: 13 | Train Loss: 0.091 Vali Loss: 12.255 Vali Acc: 0.712 Test Loss: 12.255 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2694361209869385
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 7.993 Vali Acc: 0.585 Test Loss: 7.993 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.26850962638855
Epoch: 18, Steps: 13 | Train Loss: 0.231 Vali Loss: 11.110 Vali Acc: 0.683 Test Loss: 11.110 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 731394
model size : 5.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.176176309585571
Epoch: 1, Steps: 13 | Train Loss: 0.833 Vali Loss: 1.213 Vali Acc: 0.371 Test Loss: 1.213 Test Acc: 0.371
Validation loss decreased (inf --> -0.370720).  Saving model ...
Epoch: 2 cost time: 2.059359073638916
Epoch: 2, Steps: 13 | Train Loss: 0.354 Vali Loss: 1.227 Vali Acc: 0.693 Test Loss: 1.227 Test Acc: 0.693
Validation loss decreased (-0.370720 --> -0.692671).  Saving model ...
Epoch: 3 cost time: 2.6600899696350098
Epoch: 3, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.066 Vali Acc: 0.478 Test Loss: 2.066 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.526843786239624
Epoch: 4, Steps: 13 | Train Loss: 0.092 Vali Loss: 2.207 Vali Acc: 0.571 Test Loss: 2.207 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.474419355392456
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 2.338 Vali Acc: 0.551 Test Loss: 2.338 Test Acc: 0.551
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.515378475189209
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.574 Vali Acc: 0.624 Test Loss: 2.574 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3407623767852783
Epoch: 7, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.895 Vali Acc: 0.585 Test Loss: 2.895 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.522240161895752
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.324 Vali Acc: 0.639 Test Loss: 3.324 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5618574619293213
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 4.005 Vali Acc: 0.561 Test Loss: 4.005 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4800899028778076
Epoch: 10, Steps: 13 | Train Loss: 0.100 Vali Loss: 3.772 Vali Acc: 0.634 Test Loss: 3.772 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5927140712738037
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 4.319 Vali Acc: 0.659 Test Loss: 4.319 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5543782711029053
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 4.729 Vali Acc: 0.678 Test Loss: 4.729 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 560898
model size : 4.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7552828788757324
Epoch: 1, Steps: 13 | Train Loss: 0.714 Vali Loss: 1.097 Vali Acc: 0.385 Test Loss: 1.097 Test Acc: 0.385
Validation loss decreased (inf --> -0.385355).  Saving model ...
Epoch: 2 cost time: 2.2135167121887207
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.129 Vali Acc: 0.522 Test Loss: 1.129 Test Acc: 0.522
Validation loss decreased (-0.385355 --> -0.521940).  Saving model ...
Epoch: 3 cost time: 2.1364243030548096
Epoch: 3, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.342 Vali Acc: 0.683 Test Loss: 1.342 Test Acc: 0.683
Validation loss decreased (-0.521940 --> -0.682913).  Saving model ...
Epoch: 4 cost time: 2.1310977935791016
Epoch: 4, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.852 Vali Acc: 0.693 Test Loss: 1.852 Test Acc: 0.693
Validation loss decreased (-0.682913 --> -0.692664).  Saving model ...
Epoch: 5 cost time: 2.2370831966400146
Epoch: 5, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.369 Vali Acc: 0.698 Test Loss: 2.369 Test Acc: 0.698
Validation loss decreased (-0.692664 --> -0.697537).  Saving model ...
Epoch: 6 cost time: 2.1160032749176025
Epoch: 6, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.341 Vali Acc: 0.624 Test Loss: 2.341 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2672207355499268
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 2.627 Vali Acc: 0.537 Test Loss: 2.627 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.13350510597229
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 2.860 Vali Acc: 0.566 Test Loss: 2.860 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1679444313049316
Epoch: 9, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.979 Vali Acc: 0.605 Test Loss: 2.979 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1368863582611084
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.756 Vali Acc: 0.659 Test Loss: 3.756 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.018857955932617
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 3.922 Vali Acc: 0.580 Test Loss: 3.922 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0895822048187256
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.646 Vali Acc: 0.663 Test Loss: 3.646 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2034387588500977
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.696 Vali Acc: 0.639 Test Loss: 3.696 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.1250224113464355
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.854 Vali Acc: 0.659 Test Loss: 3.854 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1948468685150146
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.887 Vali Acc: 0.659 Test Loss: 3.887 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 468482
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.364814281463623
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.773036003112793
Epoch: 2, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.823 Vali Acc: 0.693 Test Loss: 0.823 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8462624549865723
Epoch: 3, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.443 Vali Acc: 0.712 Test Loss: 1.443 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9111034870147705
Epoch: 4, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.348 Vali Acc: 0.639 Test Loss: 1.348 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9451768398284912
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.492 Vali Acc: 0.639 Test Loss: 1.492 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8742990493774414
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.634 Test Loss: 1.713 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7883317470550537
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.639 Test Loss: 1.751 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8127169609069824
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.654 Test Loss: 1.758 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.826012134552002
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.842 Vali Acc: 0.668 Test Loss: 1.842 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8281636238098145
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.644 Test Loss: 1.890 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7374186515808105
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.949 Vali Acc: 0.629 Test Loss: 1.949 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 377346
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.585127830505371
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.644 Vali Acc: 0.722 Test Loss: 0.644 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5652999877929688
Epoch: 2, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.835 Vali Acc: 0.620 Test Loss: 0.835 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7497029304504395
Epoch: 3, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.042 Vali Acc: 0.668 Test Loss: 1.042 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6151018142700195
Epoch: 4, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.254 Vali Acc: 0.639 Test Loss: 1.254 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6837704181671143
Epoch: 5, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.414 Vali Acc: 0.668 Test Loss: 1.414 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5958073139190674
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.558 Vali Acc: 0.629 Test Loss: 1.558 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7621817588806152
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.634 Test Loss: 1.695 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5734384059906006
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.644 Test Loss: 1.773 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6050193309783936
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.639 Test Loss: 1.806 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.633601427078247
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.610 Test Loss: 1.844 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4794042110443115
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.896 Vali Acc: 0.639 Test Loss: 1.896 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 317442
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3549094200134277
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8758716583251953
Epoch: 2, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.775 Vali Acc: 0.605 Test Loss: 0.775 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.946422815322876
Epoch: 3, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.913 Vali Acc: 0.610 Test Loss: 0.913 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7363426685333252
Epoch: 4, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.176 Vali Acc: 0.585 Test Loss: 1.176 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0380566120147705
Epoch: 5, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.393 Vali Acc: 0.585 Test Loss: 1.393 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9311261177062988
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.465 Vali Acc: 0.654 Test Loss: 1.465 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0946884155273438
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.537 Vali Acc: 0.585 Test Loss: 1.537 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.983806848526001
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.636 Vali Acc: 0.644 Test Loss: 1.636 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9002761840820312
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.654 Test Loss: 1.718 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9744279384613037
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.620 Test Loss: 1.762 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9348549842834473
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.629 Test Loss: 1.803 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm128_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 288898
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 8.142934560775757
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.642 Vali Acc: 0.707 Test Loss: 0.642 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 6.734071731567383
Epoch: 2, Steps: 13 | Train Loss: 0.432 Vali Loss: 1.523 Vali Acc: 0.702 Test Loss: 1.523 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.284116983413696
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 2.506 Vali Acc: 0.395 Test Loss: 2.506 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.175302028656006
Epoch: 4, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.289 Vali Acc: 0.483 Test Loss: 2.289 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.336798667907715
Epoch: 5, Steps: 13 | Train Loss: 0.065 Vali Loss: 3.210 Vali Acc: 0.483 Test Loss: 3.210 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.272314786911011
Epoch: 6, Steps: 13 | Train Loss: 0.103 Vali Loss: 3.068 Vali Acc: 0.702 Test Loss: 3.068 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.100963830947876
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.285 Vali Acc: 0.663 Test Loss: 3.285 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.13413667678833
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 3.203 Vali Acc: 0.649 Test Loss: 3.203 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.334055185317993
Epoch: 9, Steps: 13 | Train Loss: 0.101 Vali Loss: 3.627 Vali Acc: 0.605 Test Loss: 3.627 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 6.370929002761841
Epoch: 10, Steps: 13 | Train Loss: 0.028 Vali Loss: 4.597 Vali Acc: 0.629 Test Loss: 4.597 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.8674156665802
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 4.637 Vali Acc: 0.624 Test Loss: 4.637 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 623938
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.924018859863281
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.658 Vali Acc: 0.702 Test Loss: 0.658 Test Acc: 0.702
Validation loss decreased (inf --> -0.702432).  Saving model ...
Epoch: 2 cost time: 3.2918670177459717
Epoch: 2, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.854 Vali Acc: 0.659 Test Loss: 0.854 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1991870403289795
Epoch: 3, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.570 Vali Acc: 0.444 Test Loss: 1.570 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.252218008041382
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.745 Vali Acc: 0.527 Test Loss: 1.745 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.3031346797943115
Epoch: 5, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.195 Vali Acc: 0.517 Test Loss: 2.195 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2692227363586426
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 2.212 Vali Acc: 0.590 Test Loss: 2.212 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.3149142265319824
Epoch: 7, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.298 Vali Acc: 0.595 Test Loss: 2.298 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.396568775177002
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.341 Vali Acc: 0.624 Test Loss: 2.341 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.291080951690674
Epoch: 9, Steps: 13 | Train Loss: 0.013 Vali Loss: 2.800 Vali Acc: 0.551 Test Loss: 2.800 Test Acc: 0.551
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.4359560012817383
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.831 Vali Acc: 0.678 Test Loss: 2.831 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.419158697128296
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.652 Vali Acc: 0.629 Test Loss: 2.652 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 382530
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.126112222671509
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.710 Vali Acc: 0.585 Test Loss: 0.710 Test Acc: 0.585
Validation loss decreased (inf --> -0.585359).  Saving model ...
Epoch: 2 cost time: 2.7745306491851807
Epoch: 2, Steps: 13 | Train Loss: 0.392 Vali Loss: 1.056 Vali Acc: 0.473 Test Loss: 1.056 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6963415145874023
Epoch: 3, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.043 Vali Acc: 0.668 Test Loss: 1.043 Test Acc: 0.668
Validation loss decreased (-0.585359 --> -0.668282).  Saving model ...
Epoch: 4 cost time: 2.6292943954467773
Epoch: 4, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.321 Vali Acc: 0.663 Test Loss: 1.321 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6833598613739014
Epoch: 5, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.637 Vali Acc: 0.659 Test Loss: 1.637 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.693835973739624
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.918 Vali Acc: 0.644 Test Loss: 1.918 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5999343395233154
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.125 Vali Acc: 0.610 Test Loss: 2.125 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.519287586212158
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.289 Vali Acc: 0.629 Test Loss: 2.289 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6546428203582764
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.495 Vali Acc: 0.585 Test Loss: 2.495 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.524076223373413
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.525 Vali Acc: 0.659 Test Loss: 2.525 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5721628665924072
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.422 Vali Acc: 0.634 Test Loss: 2.422 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.810026168823242
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.488 Vali Acc: 0.644 Test Loss: 2.488 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5361363887786865
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.644 Test Loss: 2.516 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6682926829268293
model parameter : 297282
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.638596534729004
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.644 Vali Acc: 0.678 Test Loss: 0.644 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 2.2700905799865723
Epoch: 2, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.752 Vali Acc: 0.629 Test Loss: 0.752 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3112666606903076
Epoch: 3, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.922 Vali Acc: 0.668 Test Loss: 0.922 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.30134654045105
Epoch: 4, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.088 Vali Acc: 0.654 Test Loss: 1.088 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.246039867401123
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.326 Vali Acc: 0.659 Test Loss: 1.326 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2425448894500732
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.499 Vali Acc: 0.688 Test Loss: 1.499 Test Acc: 0.688
Validation loss decreased (-0.678042 --> -0.687790).  Saving model ...
Epoch: 7 cost time: 2.21577787399292
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.803 Vali Acc: 0.546 Test Loss: 1.803 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2924745082855225
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.663 Test Loss: 1.797 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2096309661865234
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.634 Test Loss: 1.795 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.26073956489563
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.668 Test Loss: 1.924 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.217897653579712
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.644 Test Loss: 1.870 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.139051914215088
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.654 Test Loss: 1.898 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.200225591659546
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.654 Test Loss: 1.897 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3765647411346436
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.905 Vali Acc: 0.659 Test Loss: 1.905 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.039250135421753
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.649 Test Loss: 1.895 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.126615285873413
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.649 Test Loss: 1.901 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 251074
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3487000465393066
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.655 Vali Acc: 0.668 Test Loss: 0.655 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 1.8240370750427246
Epoch: 2, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.776 Vali Acc: 0.620 Test Loss: 0.776 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7308437824249268
Epoch: 3, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7554378509521484
Epoch: 4, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.041 Vali Acc: 0.590 Test Loss: 1.041 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7982816696166992
Epoch: 5, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.390 Vali Acc: 0.522 Test Loss: 1.390 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.784207820892334
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.496 Vali Acc: 0.556 Test Loss: 1.496 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7325170040130615
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.589 Vali Acc: 0.639 Test Loss: 1.589 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7983837127685547
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.616 Vali Acc: 0.580 Test Loss: 1.616 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8534960746765137
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.610 Test Loss: 1.655 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8094146251678467
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.595 Test Loss: 1.690 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7100794315338135
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.595 Test Loss: 1.726 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6682926829268293
model parameter : 205506
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.282721519470215
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.646 Vali Acc: 0.659 Test Loss: 0.646 Test Acc: 0.659
Validation loss decreased (inf --> -0.658530).  Saving model ...
Epoch: 2 cost time: 1.4641172885894775
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.703 Vali Acc: 0.620 Test Loss: 0.703 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.613236427307129
Epoch: 3, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.796 Vali Acc: 0.659 Test Loss: 0.796 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5521948337554932
Epoch: 4, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.876 Vali Acc: 0.649 Test Loss: 0.876 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5594370365142822
Epoch: 5, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.055 Vali Acc: 0.605 Test Loss: 1.055 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5505163669586182
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.204 Vali Acc: 0.571 Test Loss: 1.204 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5517587661743164
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.353 Vali Acc: 0.639 Test Loss: 1.353 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.574826955795288
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.415 Vali Acc: 0.639 Test Loss: 1.415 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.604926347732544
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.501 Vali Acc: 0.624 Test Loss: 1.501 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5699830055236816
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.524 Vali Acc: 0.634 Test Loss: 1.524 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4885056018829346
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.634 Test Loss: 1.539 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6585365853658537
model parameter : 175554
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4152486324310303
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8451268672943115
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.704 Vali Acc: 0.605 Test Loss: 0.704 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8437714576721191
Epoch: 3, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.784 Vali Acc: 0.649 Test Loss: 0.784 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8452861309051514
Epoch: 4, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.842 Vali Acc: 0.634 Test Loss: 0.842 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8335020542144775
Epoch: 5, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.944 Vali Acc: 0.634 Test Loss: 0.944 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9276268482208252
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.118 Vali Acc: 0.624 Test Loss: 1.118 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8338115215301514
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.250 Vali Acc: 0.624 Test Loss: 1.250 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.772712230682373
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.311 Vali Acc: 0.620 Test Loss: 1.311 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.819826602935791
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.377 Vali Acc: 0.634 Test Loss: 1.377 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.920342206954956
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.422 Vali Acc: 0.610 Test Loss: 1.422 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.838559627532959
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.624 Test Loss: 1.468 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 161282
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 7.054455757141113
Epoch: 1, Steps: 13 | Train Loss: 0.780 Vali Loss: 0.730 Vali Acc: 0.717 Test Loss: 0.730 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 5.608526945114136
Epoch: 2, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.994 Vali Acc: 0.629 Test Loss: 0.994 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.588149070739746
Epoch: 3, Steps: 13 | Train Loss: 0.054 Vali Loss: 2.472 Vali Acc: 0.717 Test Loss: 2.472 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.670127630233765
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 2.224 Vali Acc: 0.546 Test Loss: 2.224 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.376497507095337
Epoch: 5, Steps: 13 | Train Loss: 0.048 Vali Loss: 2.382 Vali Acc: 0.639 Test Loss: 2.382 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.72464656829834
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.712 Vali Acc: 0.561 Test Loss: 2.712 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.556792974472046
Epoch: 7, Steps: 13 | Train Loss: 0.024 Vali Loss: 3.687 Vali Acc: 0.707 Test Loss: 3.687 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.709424734115601
Epoch: 8, Steps: 13 | Train Loss: 0.064 Vali Loss: 4.105 Vali Acc: 0.702 Test Loss: 4.105 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.211044073104858
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.850 Vali Acc: 0.678 Test Loss: 3.850 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.43010401725769
Epoch: 10, Steps: 13 | Train Loss: 0.031 Vali Loss: 5.169 Vali Acc: 0.717 Test Loss: 5.169 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.191922187805176
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 6.380 Vali Acc: 0.727 Test Loss: 6.380 Test Acc: 0.727
Validation loss decreased (-0.717066 --> -0.726765).  Saving model ...
Epoch: 12 cost time: 5.395812749862671
Epoch: 12, Steps: 13 | Train Loss: 0.096 Vali Loss: 7.287 Vali Acc: 0.707 Test Loss: 7.287 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.336127519607544
Epoch: 13, Steps: 13 | Train Loss: 1.026 Vali Loss: 10.048 Vali Acc: 0.707 Test Loss: 10.048 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.187372207641602
Epoch: 14, Steps: 13 | Train Loss: 0.484 Vali Loss: 12.526 Vali Acc: 0.717 Test Loss: 12.526 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.229484796524048
Epoch: 15, Steps: 13 | Train Loss: 1.062 Vali Loss: 9.772 Vali Acc: 0.488 Test Loss: 9.772 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.152991533279419
Epoch: 16, Steps: 13 | Train Loss: 0.881 Vali Loss: 9.158 Vali Acc: 0.537 Test Loss: 9.158 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.749065160751343
Epoch: 17, Steps: 13 | Train Loss: 0.031 Vali Loss: 10.342 Vali Acc: 0.639 Test Loss: 10.342 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.01256537437439
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 11.887 Vali Acc: 0.649 Test Loss: 11.887 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.0788304805755615
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 10.285 Vali Acc: 0.600 Test Loss: 10.285 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.379777908325195
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 10.887 Vali Acc: 0.556 Test Loss: 10.887 Test Acc: 0.556
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.365798711776733
Epoch: 21, Steps: 13 | Train Loss: 0.010 Vali Loss: 10.514 Vali Acc: 0.610 Test Loss: 10.514 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 590914
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.116888761520386
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.641 Vali Acc: 0.678 Test Loss: 0.641 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 2.6437606811523438
Epoch: 2, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.919 Vali Acc: 0.693 Test Loss: 0.919 Test Acc: 0.693
Validation loss decreased (-0.678042 --> -0.692674).  Saving model ...
Epoch: 3 cost time: 2.6312570571899414
Epoch: 3, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.171 Vali Acc: 0.673 Test Loss: 1.171 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6562345027923584
Epoch: 4, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.445 Vali Acc: 0.546 Test Loss: 1.445 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.575345516204834
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.619 Vali Acc: 0.654 Test Loss: 1.619 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.592939615249634
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.787 Vali Acc: 0.639 Test Loss: 1.787 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.505286455154419
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.429 Vali Acc: 0.698 Test Loss: 2.429 Test Acc: 0.698
Validation loss decreased (-0.692674 --> -0.697537).  Saving model ...
Epoch: 8 cost time: 2.6596434116363525
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.236 Vali Acc: 0.600 Test Loss: 2.236 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.520536422729492
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.499 Vali Acc: 0.639 Test Loss: 2.499 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7010250091552734
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.640 Vali Acc: 0.615 Test Loss: 2.640 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5285961627960205
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.581 Vali Acc: 0.595 Test Loss: 2.581 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.580751895904541
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.082 Vali Acc: 0.654 Test Loss: 3.082 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5580365657806396
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 3.841 Vali Acc: 0.673 Test Loss: 3.841 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6246445178985596
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 3.932 Vali Acc: 0.683 Test Loss: 3.932 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6217339038848877
Epoch: 15, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.626 Vali Acc: 0.644 Test Loss: 3.626 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.491131067276001
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 3.696 Vali Acc: 0.620 Test Loss: 3.696 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6093194484710693
Epoch: 17, Steps: 13 | Train Loss: 0.018 Vali Loss: 4.233 Vali Acc: 0.624 Test Loss: 4.233 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 349506
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.725391149520874
Epoch: 1, Steps: 13 | Train Loss: 0.754 Vali Loss: 0.873 Vali Acc: 0.405 Test Loss: 0.873 Test Acc: 0.405
Validation loss decreased (inf --> -0.404869).  Saving model ...
Epoch: 2 cost time: 2.3007962703704834
Epoch: 2, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.831 Vali Acc: 0.546 Test Loss: 0.831 Test Acc: 0.546
Validation loss decreased (-0.404869 --> -0.546333).  Saving model ...
Epoch: 3 cost time: 2.087660551071167
Epoch: 3, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.992 Vali Acc: 0.698 Test Loss: 0.992 Test Acc: 0.698
Validation loss decreased (-0.546333 --> -0.697551).  Saving model ...
Epoch: 4 cost time: 2.0982487201690674
Epoch: 4, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.319 Vali Acc: 0.605 Test Loss: 1.319 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.068241834640503
Epoch: 5, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.709 Vali Acc: 0.668 Test Loss: 1.709 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.198401927947998
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.714 Vali Acc: 0.663 Test Loss: 1.714 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.196556329727173
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.706 Vali Acc: 0.663 Test Loss: 1.706 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0723657608032227
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.811 Vali Acc: 0.654 Test Loss: 1.811 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0720250606536865
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.880 Vali Acc: 0.654 Test Loss: 1.880 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2207119464874268
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.654 Test Loss: 1.923 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.119472026824951
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.654 Test Loss: 1.908 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.044945240020752
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.649 Test Loss: 1.969 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2591307163238525
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.649 Test Loss: 1.964 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 264258
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.768888473510742
Epoch: 1, Steps: 13 | Train Loss: 0.764 Vali Loss: 0.610 Vali Acc: 0.688 Test Loss: 0.610 Test Acc: 0.688
Validation loss decreased (inf --> -0.687799).  Saving model ...
Epoch: 2 cost time: 1.712113857269287
Epoch: 2, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.749 Vali Acc: 0.600 Test Loss: 0.749 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8288965225219727
Epoch: 3, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.867 Vali Acc: 0.585 Test Loss: 0.867 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.887824296951294
Epoch: 4, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.353 Vali Acc: 0.688 Test Loss: 1.353 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.945511817932129
Epoch: 5, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.392 Vali Acc: 0.693 Test Loss: 1.392 Test Acc: 0.693
Validation loss decreased (-0.687799 --> -0.692669).  Saving model ...
Epoch: 6 cost time: 1.8702564239501953
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.443 Vali Acc: 0.654 Test Loss: 1.443 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5570781230926514
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.766 Vali Acc: 0.595 Test Loss: 1.766 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.744239091873169
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.838 Vali Acc: 0.629 Test Loss: 1.838 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8398725986480713
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.443 Vali Acc: 0.702 Test Loss: 2.443 Test Acc: 0.702
Validation loss decreased (-0.692669 --> -0.702415).  Saving model ...
Epoch: 10 cost time: 2.070244073867798
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.874 Vali Acc: 0.659 Test Loss: 1.874 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7531402111053467
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.044 Vali Acc: 0.693 Test Loss: 2.044 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8382558822631836
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.003 Vali Acc: 0.644 Test Loss: 2.003 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8721990585327148
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.649 Test Loss: 2.026 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8995373249053955
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.024 Vali Acc: 0.639 Test Loss: 2.024 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.909466028213501
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.049 Vali Acc: 0.659 Test Loss: 2.049 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8223161697387695
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.668 Test Loss: 2.054 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.908639669418335
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.659 Test Loss: 2.046 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8826870918273926
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.663 Test Loss: 2.054 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8161611557006836
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.059 Vali Acc: 0.663 Test Loss: 2.059 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 218050
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3104865550994873
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5156564712524414
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.703 Vali Acc: 0.663 Test Loss: 0.703 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5393157005310059
Epoch: 3, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.788 Vali Acc: 0.620 Test Loss: 0.788 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4898788928985596
Epoch: 4, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.915 Vali Acc: 0.610 Test Loss: 0.915 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3546757698059082
Epoch: 5, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.091 Vali Acc: 0.615 Test Loss: 1.091 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.420961856842041
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.221 Vali Acc: 0.600 Test Loss: 1.221 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.393873929977417
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.300 Vali Acc: 0.620 Test Loss: 1.300 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3098359107971191
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.462 Vali Acc: 0.673 Test Loss: 1.462 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4658010005950928
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.634 Test Loss: 1.425 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5382359027862549
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.534 Vali Acc: 0.649 Test Loss: 1.534 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4534783363342285
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.644 Test Loss: 1.554 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 172482
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.938066244125366
Epoch: 1, Steps: 13 | Train Loss: 0.716 Vali Loss: 0.690 Vali Acc: 0.722 Test Loss: 0.690 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.33799147605896
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.726 Vali Acc: 0.615 Test Loss: 0.726 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3868303298950195
Epoch: 3, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.763 Vali Acc: 0.683 Test Loss: 0.763 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.46567702293396
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.898 Vali Acc: 0.605 Test Loss: 0.898 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2987606525421143
Epoch: 5, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.992 Vali Acc: 0.639 Test Loss: 0.992 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.486849069595337
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.181 Vali Acc: 0.668 Test Loss: 1.181 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4338798522949219
Epoch: 7, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.253 Vali Acc: 0.629 Test Loss: 1.253 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3857641220092773
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.360 Vali Acc: 0.629 Test Loss: 1.360 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3964073657989502
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.443 Vali Acc: 0.649 Test Loss: 1.443 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3560431003570557
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.477 Vali Acc: 0.649 Test Loss: 1.477 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1847269535064697
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.516 Vali Acc: 0.615 Test Loss: 1.516 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 142530
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1350483894348145
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.665 Vali Acc: 0.688 Test Loss: 0.665 Test Acc: 0.688
Validation loss decreased (inf --> -0.687798).  Saving model ...
Epoch: 2 cost time: 1.6187994480133057
Epoch: 2, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.762 Vali Acc: 0.561 Test Loss: 0.762 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5359556674957275
Epoch: 3, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.786 Vali Acc: 0.654 Test Loss: 0.786 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.387441873550415
Epoch: 4, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.899 Vali Acc: 0.693 Test Loss: 0.899 Test Acc: 0.693
Validation loss decreased (-0.687798 --> -0.692674).  Saving model ...
Epoch: 5 cost time: 1.531670093536377
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.010 Vali Acc: 0.585 Test Loss: 1.010 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.494560956954956
Epoch: 6, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.135 Vali Acc: 0.629 Test Loss: 1.135 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.309032678604126
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.293 Vali Acc: 0.566 Test Loss: 1.293 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6516194343566895
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.375 Vali Acc: 0.580 Test Loss: 1.375 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.701735496520996
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.440 Vali Acc: 0.595 Test Loss: 1.440 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3980748653411865
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.499 Vali Acc: 0.610 Test Loss: 1.499 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.16349458694458
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.590 Test Loss: 1.535 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7210633754730225
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.605 Test Loss: 1.561 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.805936336517334
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.590 Vali Acc: 0.610 Test Loss: 1.590 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7630724906921387
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.615 Test Loss: 1.619 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 128258
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.46781325340271
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.711 Vali Acc: 0.693 Test Loss: 0.711 Test Acc: 0.693
Validation loss decreased (inf --> -0.692676).  Saving model ...
Epoch: 2 cost time: 5.032962799072266
Epoch: 2, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.017 Vali Acc: 0.595 Test Loss: 1.017 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.971648216247559
Epoch: 3, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.491 Vali Acc: 0.600 Test Loss: 1.491 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.744340181350708
Epoch: 4, Steps: 13 | Train Loss: 0.059 Vali Loss: 2.599 Vali Acc: 0.702 Test Loss: 2.599 Test Acc: 0.702
Validation loss decreased (-0.692676 --> -0.702413).  Saving model ...
Epoch: 5 cost time: 4.81073260307312
Epoch: 5, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.184 Vali Acc: 0.561 Test Loss: 2.184 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.008361339569092
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.350 Vali Acc: 0.717 Test Loss: 3.350 Test Acc: 0.717
Validation loss decreased (-0.702413 --> -0.717040).  Saving model ...
Epoch: 7 cost time: 4.783980369567871
Epoch: 7, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.915 Vali Acc: 0.707 Test Loss: 4.915 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.862163066864014
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 4.257 Vali Acc: 0.493 Test Loss: 4.257 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.732910633087158
Epoch: 9, Steps: 13 | Train Loss: 0.017 Vali Loss: 3.894 Vali Acc: 0.595 Test Loss: 3.894 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.135151624679565
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 4.717 Vali Acc: 0.668 Test Loss: 4.717 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.0785369873046875
Epoch: 11, Steps: 13 | Train Loss: 0.091 Vali Loss: 4.594 Vali Acc: 0.585 Test Loss: 4.594 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.259825944900513
Epoch: 12, Steps: 13 | Train Loss: 0.053 Vali Loss: 5.533 Vali Acc: 0.546 Test Loss: 5.533 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.113541841506958
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 6.390 Vali Acc: 0.522 Test Loss: 6.390 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.341649770736694
Epoch: 14, Steps: 13 | Train Loss: 0.135 Vali Loss: 6.533 Vali Acc: 0.663 Test Loss: 6.533 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.5977818965911865
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 8.608 Vali Acc: 0.688 Test Loss: 8.608 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.84204626083374
Epoch: 16, Steps: 13 | Train Loss: 0.101 Vali Loss: 6.555 Vali Acc: 0.561 Test Loss: 6.555 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 574402
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.241288423538208
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.836 Vali Acc: 0.478 Test Loss: 0.836 Test Acc: 0.478
Validation loss decreased (inf --> -0.478040).  Saving model ...
Epoch: 2 cost time: 2.617288827896118
Epoch: 2, Steps: 13 | Train Loss: 0.408 Vali Loss: 1.013 Vali Acc: 0.698 Test Loss: 1.013 Test Acc: 0.698
Validation loss decreased (-0.478040 --> -0.697551).  Saving model ...
Epoch: 3 cost time: 2.7504570484161377
Epoch: 3, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.065 Vali Acc: 0.639 Test Loss: 1.065 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6924490928649902
Epoch: 4, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.522 Vali Acc: 0.673 Test Loss: 1.522 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.755213975906372
Epoch: 5, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.559 Vali Acc: 0.659 Test Loss: 1.559 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7366275787353516
Epoch: 6, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.735 Vali Acc: 0.605 Test Loss: 1.735 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.711979389190674
Epoch: 7, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.403 Vali Acc: 0.702 Test Loss: 2.403 Test Acc: 0.702
Validation loss decreased (-0.697551 --> -0.702415).  Saving model ...
Epoch: 8 cost time: 2.8579249382019043
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.010 Vali Acc: 0.693 Test Loss: 3.010 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1630938053131104
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.725 Vali Acc: 0.673 Test Loss: 2.725 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6592328548431396
Epoch: 10, Steps: 13 | Train Loss: 0.052 Vali Loss: 2.779 Vali Acc: 0.639 Test Loss: 2.779 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7658348083496094
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 3.611 Vali Acc: 0.546 Test Loss: 3.611 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6891827583312988
Epoch: 12, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.867 Vali Acc: 0.507 Test Loss: 3.867 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6778879165649414
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.770 Vali Acc: 0.654 Test Loss: 3.770 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6032612323760986
Epoch: 14, Steps: 13 | Train Loss: 0.005 Vali Loss: 4.096 Vali Acc: 0.571 Test Loss: 4.096 Test Acc: 0.571
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.616631031036377
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 4.530 Vali Acc: 0.537 Test Loss: 4.530 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6223912239074707
Epoch: 16, Steps: 13 | Train Loss: 0.058 Vali Loss: 4.600 Vali Acc: 0.571 Test Loss: 4.600 Test Acc: 0.571
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.768801689147949
Epoch: 17, Steps: 13 | Train Loss: 0.072 Vali Loss: 4.822 Vali Acc: 0.595 Test Loss: 4.822 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 332994
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.019493341445923
Epoch: 1, Steps: 13 | Train Loss: 0.679 Vali Loss: 0.967 Vali Acc: 0.351 Test Loss: 0.967 Test Acc: 0.351
Validation loss decreased (inf --> -0.351210).  Saving model ...
Epoch: 2 cost time: 2.5034191608428955
Epoch: 2, Steps: 13 | Train Loss: 0.403 Vali Loss: 1.074 Vali Acc: 0.459 Test Loss: 1.074 Test Acc: 0.459
Validation loss decreased (-0.351210 --> -0.458526).  Saving model ...
Epoch: 3 cost time: 2.410550355911255
Epoch: 3, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.127 Vali Acc: 0.693 Test Loss: 1.127 Test Acc: 0.693
Validation loss decreased (-0.458526 --> -0.692672).  Saving model ...
Epoch: 4 cost time: 2.4992103576660156
Epoch: 4, Steps: 13 | Train Loss: 0.069 Vali Loss: 1.289 Vali Acc: 0.610 Test Loss: 1.289 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.535599708557129
Epoch: 5, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.707 Vali Acc: 0.537 Test Loss: 1.707 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3651320934295654
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.041 Vali Acc: 0.527 Test Loss: 2.041 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.133134365081787
Epoch: 7, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.223 Vali Acc: 0.551 Test Loss: 2.223 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.231203079223633
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.267 Vali Acc: 0.649 Test Loss: 2.267 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.212965488433838
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.703 Vali Acc: 0.659 Test Loss: 2.703 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.35503888130188
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.446 Vali Acc: 0.590 Test Loss: 2.446 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.515334367752075
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.724 Vali Acc: 0.668 Test Loss: 2.724 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.448560953140259
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.985 Vali Acc: 0.659 Test Loss: 2.985 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.461602210998535
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.095 Vali Acc: 0.571 Test Loss: 3.095 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 247746
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5232696533203125
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.704 Vali Acc: 0.571 Test Loss: 0.704 Test Acc: 0.571
Validation loss decreased (inf --> -0.570725).  Saving model ...
Epoch: 2 cost time: 2.0430872440338135
Epoch: 2, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.753 Vali Acc: 0.649 Test Loss: 0.753 Test Acc: 0.649
Validation loss decreased (-0.570725 --> -0.648773).  Saving model ...
Epoch: 3 cost time: 2.1169793605804443
Epoch: 3, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.907 Vali Acc: 0.585 Test Loss: 0.907 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.063932418823242
Epoch: 4, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.053 Vali Acc: 0.639 Test Loss: 1.053 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.000291347503662
Epoch: 5, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.586 Vali Acc: 0.693 Test Loss: 1.586 Test Acc: 0.693
Validation loss decreased (-0.648773 --> -0.692667).  Saving model ...
Epoch: 6 cost time: 2.0671048164367676
Epoch: 6, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.800 Vali Acc: 0.683 Test Loss: 1.800 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1157033443450928
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.727 Vali Acc: 0.698 Test Loss: 1.727 Test Acc: 0.698
Validation loss decreased (-0.692667 --> -0.697544).  Saving model ...
Epoch: 8 cost time: 1.9785075187683105
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.999 Vali Acc: 0.527 Test Loss: 1.999 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0593528747558594
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.219 Vali Acc: 0.532 Test Loss: 2.219 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1423985958099365
Epoch: 10, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.233 Vali Acc: 0.663 Test Loss: 2.233 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9670581817626953
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.269 Vali Acc: 0.624 Test Loss: 2.269 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.038439989089966
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.323 Vali Acc: 0.649 Test Loss: 2.323 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.040705680847168
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.398 Vali Acc: 0.629 Test Loss: 2.398 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9910900592803955
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.639 Test Loss: 2.387 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9299070835113525
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.394 Vali Acc: 0.659 Test Loss: 2.394 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9491183757781982
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.654 Test Loss: 2.397 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.040822982788086
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.403 Vali Acc: 0.649 Test Loss: 2.403 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 201538
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.575166702270508
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.677 Vali Acc: 0.722 Test Loss: 0.677 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.7937240600585938
Epoch: 2, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.704 Vali Acc: 0.644 Test Loss: 0.704 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7314112186431885
Epoch: 3, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.834 Vali Acc: 0.590 Test Loss: 0.834 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7295379638671875
Epoch: 4, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.982 Vali Acc: 0.620 Test Loss: 0.982 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.718275547027588
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.133 Vali Acc: 0.663 Test Loss: 1.133 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6835832595825195
Epoch: 6, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.248 Vali Acc: 0.634 Test Loss: 1.248 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7591643333435059
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.353 Vali Acc: 0.595 Test Loss: 1.353 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6747620105743408
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.440 Vali Acc: 0.605 Test Loss: 1.440 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6726415157318115
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.493 Vali Acc: 0.610 Test Loss: 1.493 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8042881488800049
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.615 Test Loss: 1.508 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6817474365234375
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.644 Test Loss: 1.557 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 155970
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2571969032287598
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.739 Vali Acc: 0.722 Test Loss: 0.739 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.7101633548736572
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.734 Vali Acc: 0.566 Test Loss: 0.734 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6792447566986084
Epoch: 3, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.776 Vali Acc: 0.600 Test Loss: 0.776 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.744114875793457
Epoch: 4, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.881 Vali Acc: 0.654 Test Loss: 0.881 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8275961875915527
Epoch: 5, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.007 Vali Acc: 0.649 Test Loss: 1.007 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8475582599639893
Epoch: 6, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.110 Vali Acc: 0.644 Test Loss: 1.110 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8414826393127441
Epoch: 7, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.258 Vali Acc: 0.571 Test Loss: 1.258 Test Acc: 0.571
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7231159210205078
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.379 Vali Acc: 0.639 Test Loss: 1.379 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9679450988769531
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.406 Vali Acc: 0.615 Test Loss: 1.406 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.064615488052368
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.467 Vali Acc: 0.639 Test Loss: 1.467 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.049947500228882
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.644 Test Loss: 1.465 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 126018
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9076061248779297
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.696 Vali Acc: 0.722 Test Loss: 0.696 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.9080710411071777
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.674 Vali Acc: 0.683 Test Loss: 0.674 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9321203231811523
Epoch: 3, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.731 Vali Acc: 0.693 Test Loss: 0.731 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9186480045318604
Epoch: 4, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.800 Vali Acc: 0.654 Test Loss: 0.800 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7204039096832275
Epoch: 5, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.946 Vali Acc: 0.624 Test Loss: 0.946 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9047973155975342
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.127 Vali Acc: 0.605 Test Loss: 1.127 Test Acc: 0.605
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8736357688903809
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.175 Vali Acc: 0.615 Test Loss: 1.175 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.908564805984497
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.286 Vali Acc: 0.659 Test Loss: 1.286 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8460187911987305
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.289 Vali Acc: 0.634 Test Loss: 1.289 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.851555347442627
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.624 Test Loss: 1.352 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9409682750701904
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.425 Vali Acc: 0.639 Test Loss: 1.425 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm64_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 111746
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.756597995758057
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 2.41343092918396
Epoch: 2, Steps: 13 | Train Loss: 0.499 Vali Loss: 1.044 Vali Acc: 0.459 Test Loss: 1.044 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.631263494491577
Epoch: 3, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.919 Vali Acc: 0.644 Test Loss: 0.919 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.790031909942627
Epoch: 4, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.165 Vali Acc: 0.600 Test Loss: 1.165 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6588315963745117
Epoch: 5, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.487 Vali Acc: 0.556 Test Loss: 1.487 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.810161590576172
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.522 Vali Acc: 0.624 Test Loss: 1.522 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6958956718444824
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.995 Vali Acc: 0.678 Test Loss: 1.995 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.69705867767334
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 2.029 Vali Acc: 0.663 Test Loss: 2.029 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7130157947540283
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.910 Vali Acc: 0.624 Test Loss: 1.910 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.941333532333374
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.215 Vali Acc: 0.654 Test Loss: 2.215 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.652249813079834
Epoch: 11, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.513 Vali Acc: 0.668 Test Loss: 2.513 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 304034
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.363149881362915
Epoch: 1, Steps: 13 | Train Loss: 0.734 Vali Loss: 0.679 Vali Acc: 0.722 Test Loss: 0.679 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.8521671295166016
Epoch: 2, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.731 Vali Acc: 0.605 Test Loss: 0.731 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9009590148925781
Epoch: 3, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.850 Vali Acc: 0.688 Test Loss: 0.850 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.893193006515503
Epoch: 4, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.362 Vali Acc: 0.702 Test Loss: 1.362 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8139572143554688
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.182 Vali Acc: 0.585 Test Loss: 1.182 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.768749713897705
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.330 Vali Acc: 0.595 Test Loss: 1.330 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.993328332901001
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.445 Vali Acc: 0.639 Test Loss: 1.445 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8160607814788818
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.558 Vali Acc: 0.634 Test Loss: 1.558 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8490703105926514
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.606 Vali Acc: 0.634 Test Loss: 1.606 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7916128635406494
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.645 Vali Acc: 0.639 Test Loss: 1.645 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8229520320892334
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.639 Test Loss: 1.653 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 183330
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.94852876663208
Epoch: 1, Steps: 13 | Train Loss: 0.703 Vali Loss: 0.635 Vali Acc: 0.702 Test Loss: 0.635 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 1.4054183959960938
Epoch: 2, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.733 Vali Acc: 0.610 Test Loss: 0.733 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3156814575195312
Epoch: 3, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.894 Vali Acc: 0.551 Test Loss: 0.894 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2911858558654785
Epoch: 4, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.939 Vali Acc: 0.654 Test Loss: 0.939 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3503484725952148
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.106 Vali Acc: 0.644 Test Loss: 1.106 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.357264757156372
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.230 Vali Acc: 0.634 Test Loss: 1.230 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4377448558807373
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.316 Vali Acc: 0.629 Test Loss: 1.316 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3356196880340576
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.360 Vali Acc: 0.654 Test Loss: 1.360 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4284861087799072
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.379 Vali Acc: 0.644 Test Loss: 1.379 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2014508247375488
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.663 Test Loss: 1.436 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3602867126464844
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.433 Vali Acc: 0.663 Test Loss: 1.433 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 140706
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9655263423919678
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.673 Vali Acc: 0.722 Test Loss: 0.673 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.35408616065979
Epoch: 2, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.683 Vali Acc: 0.688 Test Loss: 0.683 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.277151346206665
Epoch: 3, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.795 Vali Acc: 0.556 Test Loss: 0.795 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.31880521774292
Epoch: 4, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.981 Vali Acc: 0.512 Test Loss: 0.981 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3120617866516113
Epoch: 5, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.062 Vali Acc: 0.507 Test Loss: 1.062 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.280637502670288
Epoch: 6, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.013 Vali Acc: 0.585 Test Loss: 1.013 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1661262512207031
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.122 Vali Acc: 0.590 Test Loss: 1.122 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3201110363006592
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.226 Vali Acc: 0.673 Test Loss: 1.226 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3246665000915527
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.352 Vali Acc: 0.683 Test Loss: 1.352 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3556568622589111
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.330 Vali Acc: 0.663 Test Loss: 1.330 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.34075927734375
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.375 Vali Acc: 0.673 Test Loss: 1.375 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 117602
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2803356647491455
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.716 Vali Acc: 0.722 Test Loss: 0.716 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.283796787261963
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.677 Vali Acc: 0.629 Test Loss: 0.677 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2838611602783203
Epoch: 3, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.715 Vali Acc: 0.639 Test Loss: 0.715 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2971174716949463
Epoch: 4, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.766 Vali Acc: 0.610 Test Loss: 0.766 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2038226127624512
Epoch: 5, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.885 Vali Acc: 0.678 Test Loss: 0.885 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2285895347595215
Epoch: 6, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.931 Vali Acc: 0.629 Test Loss: 0.931 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2862050533294678
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.107 Vali Acc: 0.678 Test Loss: 1.107 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.181626319885254
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.155 Vali Acc: 0.668 Test Loss: 1.155 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.144850730895996
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.192 Vali Acc: 0.615 Test Loss: 1.192 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1826672554016113
Epoch: 10, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.233 Vali Acc: 0.620 Test Loss: 1.233 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1122725009918213
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.302 Vali Acc: 0.624 Test Loss: 1.302 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 94818
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.89209246635437
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.651 Vali Acc: 0.698 Test Loss: 0.651 Test Acc: 0.698
Validation loss decreased (inf --> -0.697554).  Saving model ...
Epoch: 2 cost time: 1.2825062274932861
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.665 Vali Acc: 0.693 Test Loss: 0.665 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2455871105194092
Epoch: 3, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.704 Vali Acc: 0.698 Test Loss: 0.704 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1383709907531738
Epoch: 4, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.748 Vali Acc: 0.624 Test Loss: 0.748 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2442195415496826
Epoch: 5, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.839 Vali Acc: 0.683 Test Loss: 0.839 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1806983947753906
Epoch: 6, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.833 Vali Acc: 0.654 Test Loss: 0.833 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2879970073699951
Epoch: 7, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.924 Vali Acc: 0.634 Test Loss: 0.924 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2855892181396484
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.056 Vali Acc: 0.663 Test Loss: 1.056 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2260913848876953
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.064 Vali Acc: 0.634 Test Loss: 1.064 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2052855491638184
Epoch: 10, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.170 Vali Acc: 0.673 Test Loss: 1.170 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.318453073501587
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.141 Vali Acc: 0.629 Test Loss: 1.141 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 79842
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.169238567352295
Epoch: 1, Steps: 13 | Train Loss: 0.759 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.4955215454101562
Epoch: 2, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.610 Vali Acc: 0.707 Test Loss: 0.610 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6793615818023682
Epoch: 3, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6595826148986816
Epoch: 4, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.689 Vali Acc: 0.702 Test Loss: 0.689 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5728700160980225
Epoch: 5, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.763 Vali Acc: 0.649 Test Loss: 0.763 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5802812576293945
Epoch: 6, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.839 Vali Acc: 0.668 Test Loss: 0.839 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.698068380355835
Epoch: 7, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.945 Vali Acc: 0.673 Test Loss: 0.945 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.451341152191162
Epoch: 8, Steps: 13 | Train Loss: 0.062 Vali Loss: 1.011 Vali Acc: 0.620 Test Loss: 1.011 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5363726615905762
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.121 Vali Acc: 0.644 Test Loss: 1.121 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5729389190673828
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.198 Vali Acc: 0.620 Test Loss: 1.198 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6103076934814453
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.253 Vali Acc: 0.620 Test Loss: 1.253 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 72706
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.532203197479248
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.683 Vali Acc: 0.707 Test Loss: 0.683 Test Acc: 0.707
Validation loss decreased (inf --> -0.707310).  Saving model ...
Epoch: 2 cost time: 2.674753189086914
Epoch: 2, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.794 Vali Acc: 0.668 Test Loss: 0.794 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6526784896850586
Epoch: 3, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.645 Vali Acc: 0.415 Test Loss: 1.645 Test Acc: 0.415
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4930648803710938
Epoch: 4, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.540 Vali Acc: 0.688 Test Loss: 1.540 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.573500871658325
Epoch: 5, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.522 Vali Acc: 0.576 Test Loss: 1.522 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.462068796157837
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 2.222 Vali Acc: 0.498 Test Loss: 2.222 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9259836673736572
Epoch: 7, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.965 Vali Acc: 0.620 Test Loss: 1.965 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.3585901260375977
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.272 Vali Acc: 0.585 Test Loss: 2.272 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1418378353118896
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.356 Vali Acc: 0.620 Test Loss: 2.356 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1384644508361816
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.553 Vali Acc: 0.605 Test Loss: 2.553 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.93744158744812
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.639 Test Loss: 2.691 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 287394
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.233250617980957
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.937 Vali Acc: 0.390 Test Loss: 0.937 Test Acc: 0.390
Validation loss decreased (inf --> -0.390235).  Saving model ...
Epoch: 2 cost time: 2.179807186126709
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 1.221 Vali Acc: 0.346 Test Loss: 1.221 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0353217124938965
Epoch: 3, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.938 Vali Acc: 0.556 Test Loss: 0.938 Test Acc: 0.556
Validation loss decreased (-0.390235 --> -0.556088).  Saving model ...
Epoch: 4 cost time: 2.2709453105926514
Epoch: 4, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.989 Vali Acc: 0.673 Test Loss: 0.989 Test Acc: 0.673
Validation loss decreased (-0.556088 --> -0.673161).  Saving model ...
Epoch: 5 cost time: 2.189568281173706
Epoch: 5, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.241 Vali Acc: 0.561 Test Loss: 1.241 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9205348491668701
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.473 Vali Acc: 0.571 Test Loss: 1.473 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.393336057662964
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.654 Vali Acc: 0.610 Test Loss: 1.654 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7022552490234375
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.898 Vali Acc: 0.566 Test Loss: 1.898 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1134531497955322
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.160 Vali Acc: 0.683 Test Loss: 2.160 Test Acc: 0.683
Validation loss decreased (-0.673161 --> -0.682905).  Saving model ...
Epoch: 10 cost time: 2.20164155960083
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.905 Vali Acc: 0.659 Test Loss: 1.905 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1843385696411133
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.932 Vali Acc: 0.634 Test Loss: 1.932 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.047685146331787
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.006 Vali Acc: 0.634 Test Loss: 2.006 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0583126544952393
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.678 Test Loss: 2.140 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2355682849884033
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.634 Test Loss: 2.019 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0043132305145264
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.033 Vali Acc: 0.644 Test Loss: 2.033 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8731780052185059
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.639 Test Loss: 2.027 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0869078636169434
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.644 Test Loss: 2.022 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.1585001945495605
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.644 Test Loss: 2.027 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.986562728881836
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.644 Test Loss: 2.035 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6829268292682927
model parameter : 166690
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3663182258605957
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5428338050842285
Epoch: 2, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.775 Vali Acc: 0.551 Test Loss: 0.775 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4299366474151611
Epoch: 3, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.900 Vali Acc: 0.556 Test Loss: 0.900 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.355513572692871
Epoch: 4, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.908 Vali Acc: 0.629 Test Loss: 0.908 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.758059024810791
Epoch: 5, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5424697399139404
Epoch: 6, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.310 Vali Acc: 0.585 Test Loss: 1.310 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5264031887054443
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.443 Vali Acc: 0.585 Test Loss: 1.443 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6582655906677246
Epoch: 8, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.704 Vali Acc: 0.556 Test Loss: 1.704 Test Acc: 0.556
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.598017692565918
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.645 Vali Acc: 0.668 Test Loss: 1.645 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.779714822769165
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.707 Vali Acc: 0.624 Test Loss: 1.707 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.493654727935791
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.663 Test Loss: 1.772 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 124066
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0702176094055176
Epoch: 1, Steps: 13 | Train Loss: 0.729 Vali Loss: 0.645 Vali Acc: 0.712 Test Loss: 0.645 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.4428737163543701
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.685 Vali Acc: 0.707 Test Loss: 0.685 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4697015285491943
Epoch: 3, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.708 Vali Acc: 0.659 Test Loss: 0.708 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4970061779022217
Epoch: 4, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.876 Vali Acc: 0.698 Test Loss: 0.876 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3908381462097168
Epoch: 5, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.990 Vali Acc: 0.688 Test Loss: 0.990 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4845528602600098
Epoch: 6, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.118 Vali Acc: 0.668 Test Loss: 1.118 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5634007453918457
Epoch: 7, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.157 Vali Acc: 0.649 Test Loss: 1.157 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3640377521514893
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.417 Vali Acc: 0.698 Test Loss: 1.417 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3610427379608154
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.289 Vali Acc: 0.659 Test Loss: 1.289 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1719603538513184
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.349 Vali Acc: 0.620 Test Loss: 1.349 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.386131763458252
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.454 Vali Acc: 0.668 Test Loss: 1.454 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 100962
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1725828647613525
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.634 Vali Acc: 0.732 Test Loss: 0.634 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.3021190166473389
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.666 Vali Acc: 0.673 Test Loss: 0.666 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.346942663192749
Epoch: 3, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.851 Vali Acc: 0.522 Test Loss: 0.851 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.341080665588379
Epoch: 4, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.794 Vali Acc: 0.605 Test Loss: 0.794 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3748631477355957
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.887 Vali Acc: 0.605 Test Loss: 0.887 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.274585247039795
Epoch: 6, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.026 Vali Acc: 0.566 Test Loss: 1.026 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4367666244506836
Epoch: 7, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.054 Vali Acc: 0.615 Test Loss: 1.054 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.322120189666748
Epoch: 8, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.184 Vali Acc: 0.673 Test Loss: 1.184 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4115946292877197
Epoch: 9, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.214 Vali Acc: 0.644 Test Loss: 1.214 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4882299900054932
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.265 Vali Acc: 0.663 Test Loss: 1.265 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.208914041519165
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.281 Vali Acc: 0.610 Test Loss: 1.281 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 78178
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.979358434677124
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.2720708847045898
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.658 Vali Acc: 0.639 Test Loss: 0.658 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1158804893493652
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.684 Vali Acc: 0.668 Test Loss: 0.684 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.119987964630127
Epoch: 4, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.737 Vali Acc: 0.707 Test Loss: 0.737 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1734025478363037
Epoch: 5, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.789 Vali Acc: 0.683 Test Loss: 0.789 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1362242698669434
Epoch: 6, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.831 Vali Acc: 0.649 Test Loss: 0.831 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1250483989715576
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.923 Vali Acc: 0.624 Test Loss: 0.923 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0817959308624268
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.023 Vali Acc: 0.659 Test Loss: 1.023 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0786595344543457
Epoch: 9, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.059 Vali Acc: 0.659 Test Loss: 1.059 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0533206462860107
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.095 Vali Acc: 0.649 Test Loss: 1.095 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.033825159072876
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.192 Vali Acc: 0.683 Test Loss: 1.192 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 63202
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2247846126556396
Epoch: 1, Steps: 13 | Train Loss: 0.740 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6490178108215332
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.625 Vali Acc: 0.727 Test Loss: 0.625 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.4991154670715332
Epoch: 3, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.641 Vali Acc: 0.673 Test Loss: 0.641 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5123085975646973
Epoch: 4, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.699 Vali Acc: 0.678 Test Loss: 0.699 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4934706687927246
Epoch: 5, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.758 Vali Acc: 0.668 Test Loss: 0.758 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6149344444274902
Epoch: 6, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.841 Vali Acc: 0.624 Test Loss: 0.841 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7343459129333496
Epoch: 7, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.898 Vali Acc: 0.634 Test Loss: 0.898 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5703837871551514
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.998 Vali Acc: 0.624 Test Loss: 0.998 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.697072982788086
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.115 Vali Acc: 0.634 Test Loss: 1.115 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.773332118988037
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.210 Vali Acc: 0.610 Test Loss: 1.210 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6182374954223633
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.263 Vali Acc: 0.639 Test Loss: 1.263 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3770220279693604
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.305 Vali Acc: 0.639 Test Loss: 1.305 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 56066
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.180479049682617
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.1220340728759766
Epoch: 2, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.908 Vali Acc: 0.698 Test Loss: 0.908 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.198179006576538
Epoch: 3, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2791056632995605
Epoch: 4, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.208163261413574
Epoch: 5, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.571 Vali Acc: 0.698 Test Loss: 1.571 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.021503448486328
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.727 Vali Acc: 0.639 Test Loss: 1.727 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4705989360809326
Epoch: 7, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.952 Vali Acc: 0.595 Test Loss: 1.952 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.4674441814422607
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.041 Vali Acc: 0.624 Test Loss: 2.041 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1844124794006348
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.136 Vali Acc: 0.571 Test Loss: 2.136 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4340789318084717
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.145 Vali Acc: 0.624 Test Loss: 2.145 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.337482213973999
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.644 Test Loss: 2.178 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 279074
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5642778873443604
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.773 Vali Acc: 0.468 Test Loss: 0.773 Test Acc: 0.468
Validation loss decreased (inf --> -0.468285).  Saving model ...
Epoch: 2 cost time: 1.716435194015503
Epoch: 2, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.791 Vali Acc: 0.580 Test Loss: 0.791 Test Acc: 0.580
Validation loss decreased (-0.468285 --> -0.580480).  Saving model ...
Epoch: 3 cost time: 1.7504453659057617
Epoch: 3, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.986 Vali Acc: 0.512 Test Loss: 0.986 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7090003490447998
Epoch: 4, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.016 Vali Acc: 0.644 Test Loss: 1.016 Test Acc: 0.644
Validation loss decreased (-0.580480 --> -0.643892).  Saving model ...
Epoch: 5 cost time: 1.8272287845611572
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.166 Vali Acc: 0.649 Test Loss: 1.166 Test Acc: 0.649
Validation loss decreased (-0.643892 --> -0.648769).  Saving model ...
Epoch: 6 cost time: 1.5212504863739014
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.273 Vali Acc: 0.693 Test Loss: 1.273 Test Acc: 0.693
Validation loss decreased (-0.648769 --> -0.692670).  Saving model ...
Epoch: 7 cost time: 1.584198236465454
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.362 Vali Acc: 0.678 Test Loss: 1.362 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6946475505828857
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.433 Vali Acc: 0.615 Test Loss: 1.433 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.699786901473999
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.454 Vali Acc: 0.639 Test Loss: 1.454 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8379039764404297
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.668 Test Loss: 1.719 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8334174156188965
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.550 Vali Acc: 0.615 Test Loss: 1.550 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7108399868011475
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.673 Test Loss: 1.766 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4872276782989502
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.644 Test Loss: 1.615 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6835260391235352
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.673 Test Loss: 1.679 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9242100715637207
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.654 Test Loss: 1.647 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8000943660736084
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.659 Test Loss: 1.674 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 158370
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3904154300689697
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.636 Vali Acc: 0.678 Test Loss: 0.636 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 1.816495656967163
Epoch: 2, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.776 Vali Acc: 0.571 Test Loss: 0.776 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.783057689666748
Epoch: 3, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.823 Vali Acc: 0.620 Test Loss: 0.823 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.902007818222046
Epoch: 4, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.916 Vali Acc: 0.668 Test Loss: 0.916 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9185967445373535
Epoch: 5, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.065 Vali Acc: 0.620 Test Loss: 1.065 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6781854629516602
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.235 Vali Acc: 0.659 Test Loss: 1.235 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.628824234008789
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.346 Vali Acc: 0.668 Test Loss: 1.346 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6859619617462158
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.392 Vali Acc: 0.629 Test Loss: 1.392 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6559014320373535
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.459 Vali Acc: 0.659 Test Loss: 1.459 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7432446479797363
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.507 Vali Acc: 0.639 Test Loss: 1.507 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8922159671783447
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.702 Test Loss: 1.655 Test Acc: 0.702
Validation loss decreased (-0.678042 --> -0.702422).  Saving model ...
Epoch: 12 cost time: 1.7536077499389648
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.639 Test Loss: 1.576 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8207614421844482
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.659 Test Loss: 1.627 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9096884727478027
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.649 Test Loss: 1.623 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9045603275299072
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.644 Test Loss: 1.628 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9201714992523193
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.649 Test Loss: 1.655 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6735670566558838
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.649 Test Loss: 1.659 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7183725833892822
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.659 Test Loss: 1.706 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8940608501434326
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.670 Vali Acc: 0.644 Test Loss: 1.670 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8451061248779297
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.649 Test Loss: 1.703 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.939345359802246
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.709 Vali Acc: 0.644 Test Loss: 1.709 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 115746
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.455235481262207
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.8638591766357422
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.623 Vali Acc: 0.707 Test Loss: 0.623 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8276622295379639
Epoch: 3, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.689 Vali Acc: 0.707 Test Loss: 0.689 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.725261926651001
Epoch: 4, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.792 Vali Acc: 0.639 Test Loss: 0.792 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5458645820617676
Epoch: 5, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.899 Vali Acc: 0.639 Test Loss: 0.899 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.690091609954834
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.995 Vali Acc: 0.673 Test Loss: 0.995 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6265182495117188
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.130 Vali Acc: 0.644 Test Loss: 1.130 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.651939868927002
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.253 Vali Acc: 0.673 Test Loss: 1.253 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.1200029850006104
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.274 Vali Acc: 0.663 Test Loss: 1.274 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.0519402027130127
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.249 Vali Acc: 0.639 Test Loss: 1.249 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.933842420578003
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.310 Vali Acc: 0.668 Test Loss: 1.310 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 92642
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.772780179977417
Epoch: 1, Steps: 13 | Train Loss: 0.696 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.048292636871338
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.612 Vali Acc: 0.693 Test Loss: 0.612 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0034685134887695
Epoch: 3, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.660 Vali Acc: 0.678 Test Loss: 0.660 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9795541763305664
Epoch: 4, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.754 Vali Acc: 0.605 Test Loss: 0.754 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.160905599594116
Epoch: 5, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.830 Vali Acc: 0.654 Test Loss: 0.830 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0815048217773438
Epoch: 6, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.912 Vali Acc: 0.659 Test Loss: 0.912 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8503005504608154
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.045349359512329
Epoch: 8, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.108 Vali Acc: 0.620 Test Loss: 1.108 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9617829322814941
Epoch: 9, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.160 Vali Acc: 0.615 Test Loss: 1.160 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.941270351409912
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.206 Vali Acc: 0.590 Test Loss: 1.206 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9600296020507812
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.242 Vali Acc: 0.600 Test Loss: 1.242 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 69858
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.808474540710449
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8765971660614014
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.616 Vali Acc: 0.702 Test Loss: 0.616 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6589720249176025
Epoch: 3, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.660 Vali Acc: 0.702 Test Loss: 0.660 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9975483417510986
Epoch: 4, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.723 Vali Acc: 0.620 Test Loss: 0.723 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7465171813964844
Epoch: 5, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.740 Vali Acc: 0.683 Test Loss: 0.740 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5661628246307373
Epoch: 6, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.809 Vali Acc: 0.678 Test Loss: 0.809 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4790534973144531
Epoch: 7, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.929 Vali Acc: 0.668 Test Loss: 0.929 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5410642623901367
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.977 Vali Acc: 0.673 Test Loss: 0.977 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5772950649261475
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 0.994 Vali Acc: 0.663 Test Loss: 0.994 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.88627290725708
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.130 Vali Acc: 0.668 Test Loss: 1.130 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0695109367370605
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.119 Vali Acc: 0.659 Test Loss: 1.119 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 54882
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.647090435028076
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.624 Vali Acc: 0.712 Test Loss: 0.624 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6867785453796387
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.7703619003295898
Epoch: 3, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.672 Vali Acc: 0.639 Test Loss: 0.672 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5902106761932373
Epoch: 4, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.702 Vali Acc: 0.688 Test Loss: 0.702 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6067724227905273
Epoch: 5, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.762 Vali Acc: 0.663 Test Loss: 0.762 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5639169216156006
Epoch: 6, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.826 Vali Acc: 0.668 Test Loss: 0.826 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8528778553009033
Epoch: 7, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.922 Vali Acc: 0.673 Test Loss: 0.922 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8454766273498535
Epoch: 8, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.013 Vali Acc: 0.590 Test Loss: 1.013 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7388207912445068
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.096 Vali Acc: 0.620 Test Loss: 1.096 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5514349937438965
Epoch: 10, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.159 Vali Acc: 0.605 Test Loss: 1.159 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5338945388793945
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.228 Vali Acc: 0.610 Test Loss: 1.228 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4650018215179443
Epoch: 12, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.290 Vali Acc: 0.610 Test Loss: 1.290 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm32_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 47746
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5030357837677
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.99893856048584
Epoch: 2, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.869 Vali Acc: 0.439 Test Loss: 0.869 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9452199935913086
Epoch: 3, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.715 Vali Acc: 0.673 Test Loss: 0.715 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.482128143310547
Epoch: 4, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.908 Vali Acc: 0.702 Test Loss: 0.908 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3559391498565674
Epoch: 5, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.057 Vali Acc: 0.688 Test Loss: 1.057 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.466285228729248
Epoch: 6, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.212 Vali Acc: 0.546 Test Loss: 1.212 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0040924549102783
Epoch: 7, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.213 Vali Acc: 0.688 Test Loss: 1.213 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.878450632095337
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.284 Vali Acc: 0.673 Test Loss: 1.284 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.650278329849243
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.362 Vali Acc: 0.673 Test Loss: 1.362 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.500420093536377
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.464 Vali Acc: 0.668 Test Loss: 1.464 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6353306770324707
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.673 Test Loss: 1.430 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 150226
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.175505638122559
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.9171152114868164
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.912113904953003
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.644 Vali Acc: 0.663 Test Loss: 0.644 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1024715900421143
Epoch: 4, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.780 Vali Acc: 0.727 Test Loss: 0.780 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726821).  Saving model ...
Epoch: 5 cost time: 2.0201404094696045
Epoch: 5, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.870 Vali Acc: 0.707 Test Loss: 0.870 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0578384399414062
Epoch: 6, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.917966365814209
Epoch: 7, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.001 Vali Acc: 0.693 Test Loss: 1.001 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7897686958312988
Epoch: 8, Steps: 13 | Train Loss: 0.015 Vali Loss: 0.975 Vali Acc: 0.678 Test Loss: 0.975 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7990896701812744
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.051 Vali Acc: 0.654 Test Loss: 1.051 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9375791549682617
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.079 Vali Acc: 0.654 Test Loss: 1.079 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.027405023574829
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.148 Vali Acc: 0.659 Test Loss: 1.148 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9304893016815186
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.246 Vali Acc: 0.668 Test Loss: 1.246 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.900252342224121
Epoch: 13, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.178 Vali Acc: 0.663 Test Loss: 1.178 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9292726516723633
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.262 Vali Acc: 0.659 Test Loss: 1.262 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 89874
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2279138565063477
Epoch: 1, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.743 Vali Acc: 0.722 Test Loss: 0.743 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.5657298564910889
Epoch: 2, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.698 Vali Acc: 0.717 Test Loss: 0.698 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4711036682128906
Epoch: 3, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.905 Vali Acc: 0.439 Test Loss: 0.905 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5512580871582031
Epoch: 4, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.745 Vali Acc: 0.624 Test Loss: 0.745 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.693040132522583
Epoch: 5, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.786 Vali Acc: 0.673 Test Loss: 0.786 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7248814105987549
Epoch: 6, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.889 Vali Acc: 0.702 Test Loss: 0.889 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8161306381225586
Epoch: 7, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.932 Vali Acc: 0.644 Test Loss: 0.932 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7358644008636475
Epoch: 8, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.029 Vali Acc: 0.639 Test Loss: 1.029 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6709742546081543
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.102 Vali Acc: 0.649 Test Loss: 1.102 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.739039421081543
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.187 Vali Acc: 0.693 Test Loss: 1.187 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6238946914672852
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.217 Vali Acc: 0.693 Test Loss: 1.217 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 68562
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.300178289413452
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.619 Vali Acc: 0.693 Test Loss: 0.619 Test Acc: 0.693
Validation loss decreased (inf --> -0.692677).  Saving model ...
Epoch: 2 cost time: 1.5272231101989746
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.624 Vali Acc: 0.654 Test Loss: 0.624 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6327028274536133
Epoch: 3, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.663 Vali Acc: 0.693 Test Loss: 0.663 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.582056999206543
Epoch: 4, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.705 Vali Acc: 0.624 Test Loss: 0.705 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6462490558624268
Epoch: 5, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.740 Vali Acc: 0.624 Test Loss: 0.740 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4882566928863525
Epoch: 6, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.799 Vali Acc: 0.624 Test Loss: 0.799 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.624619960784912
Epoch: 7, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.891 Vali Acc: 0.639 Test Loss: 0.891 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.64884352684021
Epoch: 8, Steps: 13 | Train Loss: 0.050 Vali Loss: 0.919 Vali Acc: 0.659 Test Loss: 0.919 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6207737922668457
Epoch: 9, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.021 Vali Acc: 0.688 Test Loss: 1.021 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5479252338409424
Epoch: 10, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.049 Vali Acc: 0.615 Test Loss: 1.049 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5223004817962646
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.095 Vali Acc: 0.634 Test Loss: 1.095 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 57010
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1010515689849854
Epoch: 1, Steps: 13 | Train Loss: 0.715 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5406126976013184
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.630 Vali Acc: 0.698 Test Loss: 0.630 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4145255088806152
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.639 Vali Acc: 0.707 Test Loss: 0.639 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3811206817626953
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.670 Vali Acc: 0.683 Test Loss: 0.670 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.395961046218872
Epoch: 5, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.738 Vali Acc: 0.712 Test Loss: 0.738 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5455071926116943
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.780 Vali Acc: 0.620 Test Loss: 0.780 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3631150722503662
Epoch: 7, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.876 Vali Acc: 0.561 Test Loss: 0.876 Test Acc: 0.561
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5002527236938477
Epoch: 8, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.908 Vali Acc: 0.605 Test Loss: 0.908 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.45583176612854
Epoch: 9, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.959 Vali Acc: 0.644 Test Loss: 0.959 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.410191297531128
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.044 Vali Acc: 0.624 Test Loss: 1.044 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5111873149871826
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.116 Vali Acc: 0.590 Test Loss: 1.116 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 45618
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.138641119003296
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.641 Vali Acc: 0.712 Test Loss: 0.641 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.4700307846069336
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.671 Vali Acc: 0.722 Test Loss: 0.671 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.3755664825439453
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.661 Vali Acc: 0.702 Test Loss: 0.661 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3452112674713135
Epoch: 4, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.675 Vali Acc: 0.678 Test Loss: 0.675 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5753505229949951
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.700 Vali Acc: 0.688 Test Loss: 0.700 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.364668369293213
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.763 Vali Acc: 0.683 Test Loss: 0.763 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2827205657958984
Epoch: 7, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.781 Vali Acc: 0.639 Test Loss: 0.781 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3054463863372803
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.874 Vali Acc: 0.683 Test Loss: 0.874 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2337276935577393
Epoch: 9, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.845 Vali Acc: 0.649 Test Loss: 0.845 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2532532215118408
Epoch: 10, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.879 Vali Acc: 0.624 Test Loss: 0.879 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2453815937042236
Epoch: 11, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.018 Vali Acc: 0.649 Test Loss: 1.018 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2457606792449951
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.014 Vali Acc: 0.634 Test Loss: 1.014 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 38130
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.00746488571167
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.624 Vali Acc: 0.693 Test Loss: 0.624 Test Acc: 0.693
Validation loss decreased (inf --> -0.692677).  Saving model ...
Epoch: 2 cost time: 1.1630051136016846
Epoch: 2, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
Validation loss decreased (-0.692677 --> -0.707311).  Saving model ...
Epoch: 3 cost time: 1.1464617252349854
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.640 Vali Acc: 0.678 Test Loss: 0.640 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1088414192199707
Epoch: 4, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.654 Vali Acc: 0.683 Test Loss: 0.654 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0430712699890137
Epoch: 5, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.690 Vali Acc: 0.693 Test Loss: 0.690 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1247472763061523
Epoch: 6, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.724 Vali Acc: 0.639 Test Loss: 0.724 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1552608013153076
Epoch: 7, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.754 Vali Acc: 0.654 Test Loss: 0.754 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1610136032104492
Epoch: 8, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.815 Vali Acc: 0.590 Test Loss: 0.815 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.170989751815796
Epoch: 9, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.834 Vali Acc: 0.624 Test Loss: 0.834 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2129125595092773
Epoch: 10, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.921 Vali Acc: 0.566 Test Loss: 0.921 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.999948263168335
Epoch: 11, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.970 Vali Acc: 0.605 Test Loss: 0.970 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.183180332183838
Epoch: 12, Steps: 13 | Train Loss: 0.064 Vali Loss: 1.049 Vali Acc: 0.566 Test Loss: 1.049 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 34562
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.333720922470093
Epoch: 1, Steps: 13 | Train Loss: 0.704 Vali Loss: 0.823 Vali Acc: 0.395 Test Loss: 0.823 Test Acc: 0.395
Validation loss decreased (inf --> -0.395114).  Saving model ...
Epoch: 2 cost time: 2.7148382663726807
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.632 Vali Acc: 0.698 Test Loss: 0.632 Test Acc: 0.698
Validation loss decreased (-0.395114 --> -0.697555).  Saving model ...
Epoch: 3 cost time: 2.693263053894043
Epoch: 3, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.703 Vali Acc: 0.698 Test Loss: 0.703 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.840441942214966
Epoch: 4, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.801 Vali Acc: 0.649 Test Loss: 0.801 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.850095510482788
Epoch: 5, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.018 Vali Acc: 0.712 Test Loss: 1.018 Test Acc: 0.712
Validation loss decreased (-0.697555 --> -0.712185).  Saving model ...
Epoch: 6 cost time: 2.5871691703796387
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.364 Vali Acc: 0.698 Test Loss: 1.364 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.433081865310669
Epoch: 7, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.214 Vali Acc: 0.585 Test Loss: 1.214 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.452674388885498
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6814794540405273
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.311 Vali Acc: 0.654 Test Loss: 1.311 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.708282470703125
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.644 Test Loss: 1.367 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.838763475418091
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.406 Vali Acc: 0.605 Test Loss: 1.406 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7801690101623535
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.557 Vali Acc: 0.673 Test Loss: 1.557 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7312779426574707
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.415 Vali Acc: 0.629 Test Loss: 1.415 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.844374418258667
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.531 Vali Acc: 0.663 Test Loss: 1.531 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7361319065093994
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.456 Vali Acc: 0.663 Test Loss: 1.456 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 141778
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2858240604400635
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7026286125183105
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.610 Vali Acc: 0.688 Test Loss: 0.610 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.833739995956421
Epoch: 3, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.666 Vali Acc: 0.659 Test Loss: 0.666 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8055789470672607
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.741 Vali Acc: 0.615 Test Loss: 0.741 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8393452167510986
Epoch: 5, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.762 Vali Acc: 0.678 Test Loss: 0.762 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.843862771987915
Epoch: 6, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.076 Vali Acc: 0.712 Test Loss: 1.076 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7816376686096191
Epoch: 7, Steps: 13 | Train Loss: 0.075 Vali Loss: 1.316 Vali Acc: 0.712 Test Loss: 1.316 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9106965065002441
Epoch: 8, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.276 Vali Acc: 0.693 Test Loss: 1.276 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8841536045074463
Epoch: 9, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.434 Vali Acc: 0.693 Test Loss: 1.434 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8706409931182861
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.246 Vali Acc: 0.668 Test Loss: 1.246 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8057498931884766
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.249 Vali Acc: 0.659 Test Loss: 1.249 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 81426
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.580334424972534
Epoch: 1, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.695 Vali Acc: 0.722 Test Loss: 0.695 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.6223344802856445
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.716 Vali Acc: 0.712 Test Loss: 0.716 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.579134225845337
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.861 Vali Acc: 0.488 Test Loss: 0.861 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7697858810424805
Epoch: 4, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.822 Vali Acc: 0.605 Test Loss: 0.822 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.717494249343872
Epoch: 5, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.883 Vali Acc: 0.600 Test Loss: 0.883 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5650320053100586
Epoch: 6, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.906 Vali Acc: 0.649 Test Loss: 0.906 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7294046878814697
Epoch: 7, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.997 Vali Acc: 0.683 Test Loss: 0.997 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6612749099731445
Epoch: 8, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.048 Vali Acc: 0.649 Test Loss: 1.048 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8020379543304443
Epoch: 9, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.106 Vali Acc: 0.644 Test Loss: 1.106 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8428144454956055
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.129 Vali Acc: 0.644 Test Loss: 1.129 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7090928554534912
Epoch: 11, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.322 Vali Acc: 0.698 Test Loss: 1.322 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 60114
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2761592864990234
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4700095653533936
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.640 Vali Acc: 0.654 Test Loss: 0.640 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.373779535293579
Epoch: 3, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.673 Vali Acc: 0.698 Test Loss: 0.673 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6058540344238281
Epoch: 4, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.744 Vali Acc: 0.702 Test Loss: 0.744 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4779877662658691
Epoch: 5, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.762 Vali Acc: 0.629 Test Loss: 0.762 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4758503437042236
Epoch: 6, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.795 Vali Acc: 0.649 Test Loss: 0.795 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5815622806549072
Epoch: 7, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.864 Vali Acc: 0.683 Test Loss: 0.864 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6222403049468994
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.933 Vali Acc: 0.663 Test Loss: 0.933 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.673069715499878
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.997 Vali Acc: 0.668 Test Loss: 0.997 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.331538200378418
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.048 Vali Acc: 0.663 Test Loss: 1.048 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7583036422729492
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.129 Vali Acc: 0.693 Test Loss: 1.129 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 48562
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3192977905273438
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.631 Vali Acc: 0.712 Test Loss: 0.631 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.6095378398895264
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.629 Vali Acc: 0.688 Test Loss: 0.629 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4471383094787598
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.653 Vali Acc: 0.688 Test Loss: 0.653 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5274195671081543
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.681 Vali Acc: 0.698 Test Loss: 0.681 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3872478008270264
Epoch: 5, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.730 Vali Acc: 0.683 Test Loss: 0.730 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.566929578781128
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5309436321258545
Epoch: 7, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.862 Vali Acc: 0.620 Test Loss: 0.862 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4794275760650635
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.896 Vali Acc: 0.615 Test Loss: 0.896 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3720500469207764
Epoch: 9, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.977 Vali Acc: 0.580 Test Loss: 0.977 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4330520629882812
Epoch: 10, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.021 Vali Acc: 0.605 Test Loss: 1.021 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3512678146362305
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.066 Vali Acc: 0.654 Test Loss: 1.066 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 37170
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0893566608428955
Epoch: 1, Steps: 13 | Train Loss: 0.718 Vali Loss: 0.623 Vali Acc: 0.698 Test Loss: 0.623 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 1.3392550945281982
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.624 Vali Acc: 0.717 Test Loss: 0.624 Test Acc: 0.717
Validation loss decreased (-0.697555 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.4111647605895996
Epoch: 3, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4083380699157715
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.648 Vali Acc: 0.702 Test Loss: 0.648 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.352121353149414
Epoch: 5, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.679 Vali Acc: 0.688 Test Loss: 0.679 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.304441213607788
Epoch: 6, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.752 Vali Acc: 0.707 Test Loss: 0.752 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3202459812164307
Epoch: 7, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.741 Vali Acc: 0.683 Test Loss: 0.741 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.433678388595581
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.763 Vali Acc: 0.673 Test Loss: 0.763 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2580070495605469
Epoch: 9, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.781 Vali Acc: 0.673 Test Loss: 0.781 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.209282398223877
Epoch: 10, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.824 Vali Acc: 0.668 Test Loss: 0.824 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4109458923339844
Epoch: 11, Steps: 13 | Train Loss: 0.061 Vali Loss: 0.894 Vali Acc: 0.673 Test Loss: 0.894 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2488017082214355
Epoch: 12, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.937 Vali Acc: 0.649 Test Loss: 0.937 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 29682
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8042023181915283
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.667 Vali Acc: 0.634 Test Loss: 0.667 Test Acc: 0.634
Validation loss decreased (inf --> -0.634140).  Saving model ...
Epoch: 2 cost time: 1.068164587020874
Epoch: 2, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
Validation loss decreased (-0.634140 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.2594285011291504
Epoch: 3, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.678 Vali Acc: 0.585 Test Loss: 0.678 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1633388996124268
Epoch: 4, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.683 Vali Acc: 0.605 Test Loss: 0.683 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0939068794250488
Epoch: 5, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.694 Vali Acc: 0.663 Test Loss: 0.694 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2147703170776367
Epoch: 6, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.735 Vali Acc: 0.605 Test Loss: 0.735 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.299299955368042
Epoch: 7, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.764 Vali Acc: 0.620 Test Loss: 0.764 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1698825359344482
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.805 Vali Acc: 0.629 Test Loss: 0.805 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2246780395507812
Epoch: 9, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.872 Vali Acc: 0.615 Test Loss: 0.872 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1917176246643066
Epoch: 10, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.922 Vali Acc: 0.610 Test Loss: 0.922 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.14084792137146
Epoch: 11, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.035 Vali Acc: 0.585 Test Loss: 1.035 Test Acc: 0.585
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1702518463134766
Epoch: 12, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.075 Vali Acc: 0.590 Test Loss: 1.075 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 26114
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.853580951690674
Epoch: 1, Steps: 13 | Train Loss: 0.695 Vali Loss: 0.751 Vali Acc: 0.468 Test Loss: 0.751 Test Acc: 0.468
Validation loss decreased (inf --> -0.468285).  Saving model ...
Epoch: 2 cost time: 2.809358835220337
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.698 Vali Acc: 0.605 Test Loss: 0.698 Test Acc: 0.605
Validation loss decreased (-0.468285 --> -0.604871).  Saving model ...
Epoch: 3 cost time: 2.647444248199463
Epoch: 3, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.987 Vali Acc: 0.712 Test Loss: 0.987 Test Acc: 0.712
Validation loss decreased (-0.604871 --> -0.712185).  Saving model ...
Epoch: 4 cost time: 2.8409011363983154
Epoch: 4, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.876 Vali Acc: 0.590 Test Loss: 0.876 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0033907890319824
Epoch: 5, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.013 Vali Acc: 0.712 Test Loss: 1.013 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.165412664413452
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.182 Vali Acc: 0.546 Test Loss: 1.182 Test Acc: 0.546
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.062196969985962
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.342 Vali Acc: 0.693 Test Loss: 1.342 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2356975078582764
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.502 Vali Acc: 0.698 Test Loss: 1.502 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.9929871559143066
Epoch: 9, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.434 Vali Acc: 0.610 Test Loss: 1.434 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.718614101409912
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.566 Test Loss: 1.657 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3460803031921387
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.660 Vali Acc: 0.683 Test Loss: 1.660 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.771312952041626
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.678 Test Loss: 1.708 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.164102077484131
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.668 Test Loss: 1.688 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 137554
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.930910110473633
Epoch: 1, Steps: 13 | Train Loss: 0.728 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.9700133800506592
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.700 Vali Acc: 0.722 Test Loss: 0.700 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721944).  Saving model ...
Epoch: 3 cost time: 2.141993284225464
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.659 Vali Acc: 0.707 Test Loss: 0.659 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.967411994934082
Epoch: 4, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.711 Vali Acc: 0.722 Test Loss: 0.711 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4363315105438232
Epoch: 5, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.768 Vali Acc: 0.649 Test Loss: 0.768 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.187983512878418
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.910 Vali Acc: 0.615 Test Loss: 0.910 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.650315523147583
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 0.974 Vali Acc: 0.693 Test Loss: 0.974 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.442110538482666
Epoch: 8, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.041 Vali Acc: 0.673 Test Loss: 1.041 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6297245025634766
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.128 Vali Acc: 0.678 Test Loss: 1.128 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.106646776199341
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.157 Vali Acc: 0.673 Test Loss: 1.157 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0635368824005127
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.639 Test Loss: 1.128 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.100816488265991
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.215 Vali Acc: 0.688 Test Loss: 1.215 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 77202
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6754677295684814
Epoch: 1, Steps: 13 | Train Loss: 0.758 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.9932060241699219
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.654 Vali Acc: 0.639 Test Loss: 0.654 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.891918659210205
Epoch: 3, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.684 Vali Acc: 0.639 Test Loss: 0.684 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0605738162994385
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.873 Vali Acc: 0.512 Test Loss: 0.873 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4285190105438232
Epoch: 5, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.805 Vali Acc: 0.624 Test Loss: 0.805 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4107794761657715
Epoch: 6, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.838 Vali Acc: 0.693 Test Loss: 0.838 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6534686088562012
Epoch: 7, Steps: 13 | Train Loss: 0.062 Vali Loss: 0.908 Vali Acc: 0.673 Test Loss: 0.908 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4551961421966553
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 0.970 Vali Acc: 0.663 Test Loss: 0.970 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0805041790008545
Epoch: 9, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.018 Vali Acc: 0.639 Test Loss: 1.018 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1068952083587646
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.222 Vali Acc: 0.707 Test Loss: 1.222 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8532960414886475
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.136 Vali Acc: 0.649 Test Loss: 1.136 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 55890
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7665700912475586
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9031150341033936
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.612 Vali Acc: 0.688 Test Loss: 0.612 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7997157573699951
Epoch: 3, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.651 Vali Acc: 0.727 Test Loss: 0.651 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.5803236961364746
Epoch: 4, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.699 Vali Acc: 0.702 Test Loss: 0.699 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3737013339996338
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.795 Vali Acc: 0.561 Test Loss: 0.795 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5627374649047852
Epoch: 6, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.770 Vali Acc: 0.644 Test Loss: 0.770 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8159098625183105
Epoch: 7, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.837 Vali Acc: 0.663 Test Loss: 0.837 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8756680488586426
Epoch: 8, Steps: 13 | Train Loss: 0.054 Vali Loss: 0.946 Vali Acc: 0.585 Test Loss: 0.946 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7499184608459473
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 0.968 Vali Acc: 0.644 Test Loss: 0.968 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.059973955154419
Epoch: 10, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.046 Vali Acc: 0.668 Test Loss: 1.046 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8567655086517334
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.101 Vali Acc: 0.639 Test Loss: 1.101 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9383175373077393
Epoch: 12, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.129 Vali Acc: 0.649 Test Loss: 1.129 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9571659564971924
Epoch: 13, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.167 Vali Acc: 0.639 Test Loss: 1.167 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 44338
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.259709119796753
Epoch: 1, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.658 Vali Acc: 0.702 Test Loss: 0.658 Test Acc: 0.702
Validation loss decreased (inf --> -0.702432).  Saving model ...
Epoch: 2 cost time: 1.5169196128845215
Epoch: 2, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.669 Vali Acc: 0.668 Test Loss: 0.669 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4971072673797607
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.680 Vali Acc: 0.659 Test Loss: 0.680 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8193047046661377
Epoch: 4, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.706 Vali Acc: 0.668 Test Loss: 0.706 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7478699684143066
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.736 Vali Acc: 0.649 Test Loss: 0.736 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9682762622833252
Epoch: 6, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.796 Vali Acc: 0.629 Test Loss: 0.796 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.946882724761963
Epoch: 7, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.874 Vali Acc: 0.595 Test Loss: 0.874 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6798157691955566
Epoch: 8, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.913 Vali Acc: 0.595 Test Loss: 0.913 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7524518966674805
Epoch: 9, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.975 Vali Acc: 0.585 Test Loss: 0.975 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9890456199645996
Epoch: 10, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.043 Vali Acc: 0.600 Test Loss: 1.043 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6842896938323975
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.119 Vali Acc: 0.576 Test Loss: 1.119 Test Acc: 0.576
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 32946
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.381753444671631
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.633 Vali Acc: 0.717 Test Loss: 0.633 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.4604127407073975
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.654 Vali Acc: 0.712 Test Loss: 0.654 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7829835414886475
Epoch: 3, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.639 Vali Acc: 0.678 Test Loss: 0.639 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8039820194244385
Epoch: 4, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.676 Vali Acc: 0.683 Test Loss: 0.676 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6157796382904053
Epoch: 5, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.705 Vali Acc: 0.673 Test Loss: 0.705 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6793692111968994
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.727 Vali Acc: 0.663 Test Loss: 0.727 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.561208724975586
Epoch: 7, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.769 Vali Acc: 0.639 Test Loss: 0.769 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.624892234802246
Epoch: 8, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.828 Vali Acc: 0.673 Test Loss: 0.828 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5050978660583496
Epoch: 9, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.827 Vali Acc: 0.644 Test Loss: 0.827 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.544248104095459
Epoch: 10, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.910 Vali Acc: 0.654 Test Loss: 0.910 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6494359970092773
Epoch: 11, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.917 Vali Acc: 0.654 Test Loss: 0.917 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 25458
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2767341136932373
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2056858539581299
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.667 Vali Acc: 0.712 Test Loss: 0.667 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1795759201049805
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.656 Vali Acc: 0.693 Test Loss: 0.656 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1509661674499512
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.663 Vali Acc: 0.663 Test Loss: 0.663 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2132856845855713
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.680 Vali Acc: 0.678 Test Loss: 0.680 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2858140468597412
Epoch: 6, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.720 Vali Acc: 0.639 Test Loss: 0.720 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1354281902313232
Epoch: 7, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.757 Vali Acc: 0.610 Test Loss: 0.757 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1952319145202637
Epoch: 8, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.808 Vali Acc: 0.644 Test Loss: 0.808 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1722404956817627
Epoch: 9, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.893 Vali Acc: 0.571 Test Loss: 0.893 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1906139850616455
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 0.944 Vali Acc: 0.590 Test Loss: 0.944 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2503445148468018
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el2_dm16_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 21890
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.751958131790161
Epoch: 1, Steps: 13 | Train Loss: 0.778 Vali Loss: 1.092 Vali Acc: 0.478 Test Loss: 1.092 Test Acc: 0.478
Validation loss decreased (inf --> -0.478038).  Saving model ...
Epoch: 2 cost time: 4.720299243927002
Epoch: 2, Steps: 13 | Train Loss: 0.634 Vali Loss: 2.786 Vali Acc: 0.439 Test Loss: 2.786 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.148716926574707
Epoch: 3, Steps: 13 | Train Loss: 0.369 Vali Loss: 4.169 Vali Acc: 0.707 Test Loss: 4.169 Test Acc: 0.707
Validation loss decreased (-0.478038 --> -0.707275).  Saving model ...
Epoch: 4 cost time: 4.941277980804443
Epoch: 4, Steps: 13 | Train Loss: 0.343 Vali Loss: 5.385 Vali Acc: 0.459 Test Loss: 5.385 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.312978029251099
Epoch: 5, Steps: 13 | Train Loss: 0.216 Vali Loss: 4.255 Vali Acc: 0.693 Test Loss: 4.255 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.0935821533203125
Epoch: 6, Steps: 13 | Train Loss: 0.075 Vali Loss: 5.223 Vali Acc: 0.688 Test Loss: 5.223 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.243967056274414
Epoch: 7, Steps: 13 | Train Loss: 0.184 Vali Loss: 5.841 Vali Acc: 0.644 Test Loss: 5.841 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.980472803115845
Epoch: 8, Steps: 13 | Train Loss: 0.029 Vali Loss: 10.531 Vali Acc: 0.439 Test Loss: 10.531 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.294478416442871
Epoch: 9, Steps: 13 | Train Loss: 0.387 Vali Loss: 7.176 Vali Acc: 0.659 Test Loss: 7.176 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.8226213455200195
Epoch: 10, Steps: 13 | Train Loss: 0.227 Vali Loss: 11.374 Vali Acc: 0.444 Test Loss: 11.374 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.441499710083008
Epoch: 11, Steps: 13 | Train Loss: 1.746 Vali Loss: 19.234 Vali Acc: 0.390 Test Loss: 19.234 Test Acc: 0.390
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.794386148452759
Epoch: 12, Steps: 13 | Train Loss: 1.078 Vali Loss: 15.791 Vali Acc: 0.459 Test Loss: 15.791 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.751979827880859
Epoch: 13, Steps: 13 | Train Loss: 0.147 Vali Loss: 10.677 Vali Acc: 0.649 Test Loss: 10.677 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 1180418
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.7506937980651855
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.780 Vali Acc: 0.698 Test Loss: 0.780 Test Acc: 0.698
Validation loss decreased (inf --> -0.697553).  Saving model ...
Epoch: 2 cost time: 4.123247861862183
Epoch: 2, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.572 Vali Acc: 0.473 Test Loss: 1.572 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.171538591384888
Epoch: 3, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.780 Vali Acc: 0.634 Test Loss: 1.780 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8393948078155518
Epoch: 4, Steps: 13 | Train Loss: 0.012 Vali Loss: 2.640 Vali Acc: 0.678 Test Loss: 2.640 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.012148857116699
Epoch: 5, Steps: 13 | Train Loss: 0.024 Vali Loss: 3.068 Vali Acc: 0.693 Test Loss: 3.068 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.457639455795288
Epoch: 6, Steps: 13 | Train Loss: 0.016 Vali Loss: 3.492 Vali Acc: 0.688 Test Loss: 3.492 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8013758659362793
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.406 Vali Acc: 0.654 Test Loss: 3.406 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.605698823928833
Epoch: 8, Steps: 13 | Train Loss: 0.056 Vali Loss: 3.866 Vali Acc: 0.668 Test Loss: 3.866 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.414252996444702
Epoch: 9, Steps: 13 | Train Loss: 0.053 Vali Loss: 4.493 Vali Acc: 0.546 Test Loss: 4.493 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.744234323501587
Epoch: 10, Steps: 13 | Train Loss: 0.121 Vali Loss: 4.894 Vali Acc: 0.644 Test Loss: 4.894 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.6834216117858887
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 5.656 Vali Acc: 0.595 Test Loss: 5.656 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 697602
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3183064460754395
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.678 Vali Acc: 0.678 Test Loss: 0.678 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 2.8826186656951904
Epoch: 2, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.124 Vali Acc: 0.610 Test Loss: 1.124 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4759621620178223
Epoch: 3, Steps: 13 | Train Loss: 0.178 Vali Loss: 1.746 Vali Acc: 0.702 Test Loss: 1.746 Test Acc: 0.702
Validation loss decreased (-0.678042 --> -0.702422).  Saving model ...
Epoch: 4 cost time: 2.5517632961273193
Epoch: 4, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.869 Vali Acc: 0.620 Test Loss: 1.869 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.55258846282959
Epoch: 5, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.560 Vali Acc: 0.600 Test Loss: 2.560 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7382123470306396
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.329 Vali Acc: 0.517 Test Loss: 3.329 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.84100079536438
Epoch: 7, Steps: 13 | Train Loss: 0.055 Vali Loss: 4.209 Vali Acc: 0.498 Test Loss: 4.209 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.587719678878784
Epoch: 8, Steps: 13 | Train Loss: 0.027 Vali Loss: 4.081 Vali Acc: 0.566 Test Loss: 4.081 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6975557804107666
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 5.371 Vali Acc: 0.483 Test Loss: 5.371 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6195149421691895
Epoch: 10, Steps: 13 | Train Loss: 0.244 Vali Loss: 5.206 Vali Acc: 0.551 Test Loss: 5.206 Test Acc: 0.551
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8025615215301514
Epoch: 11, Steps: 13 | Train Loss: 0.244 Vali Loss: 5.115 Vali Acc: 0.605 Test Loss: 5.115 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.704669237136841
Epoch: 12, Steps: 13 | Train Loss: 0.054 Vali Loss: 6.117 Vali Acc: 0.678 Test Loss: 6.117 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.589972734451294
Epoch: 13, Steps: 13 | Train Loss: 0.078 Vali Loss: 5.779 Vali Acc: 0.659 Test Loss: 5.779 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 527106
model size : 4.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9842617511749268
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.677 Vali Acc: 0.654 Test Loss: 0.677 Test Acc: 0.654
Validation loss decreased (inf --> -0.653652).  Saving model ...
Epoch: 2 cost time: 2.5388762950897217
Epoch: 2, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.907 Vali Acc: 0.668 Test Loss: 0.907 Test Acc: 0.668
Validation loss decreased (-0.653652 --> -0.668284).  Saving model ...
Epoch: 3 cost time: 2.4278993606567383
Epoch: 3, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.230 Vali Acc: 0.683 Test Loss: 1.230 Test Acc: 0.683
Validation loss decreased (-0.668284 --> -0.682915).  Saving model ...
Epoch: 4 cost time: 2.4521753787994385
Epoch: 4, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.843 Vali Acc: 0.541 Test Loss: 1.843 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.213780403137207
Epoch: 5, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.278 Vali Acc: 0.556 Test Loss: 2.278 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.081211566925049
Epoch: 6, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.938 Vali Acc: 0.444 Test Loss: 2.938 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1431448459625244
Epoch: 7, Steps: 13 | Train Loss: 0.065 Vali Loss: 2.466 Vali Acc: 0.683 Test Loss: 2.466 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.245354175567627
Epoch: 8, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.740 Vali Acc: 0.668 Test Loss: 2.740 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3615078926086426
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.977 Vali Acc: 0.639 Test Loss: 2.977 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3653202056884766
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.233 Vali Acc: 0.576 Test Loss: 3.233 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.3293120861053467
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 3.263 Vali Acc: 0.629 Test Loss: 3.263 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.253049850463867
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.674 Vali Acc: 0.678 Test Loss: 3.674 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.502519130706787
Epoch: 13, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.765 Vali Acc: 0.615 Test Loss: 3.765 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6829268292682927
model parameter : 434690
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.921105146408081
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.667 Vali Acc: 0.629 Test Loss: 0.667 Test Acc: 0.629
Validation loss decreased (inf --> -0.629262).  Saving model ...
Epoch: 2 cost time: 2.2081003189086914
Epoch: 2, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.942 Vali Acc: 0.571 Test Loss: 0.942 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0455169677734375
Epoch: 3, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.055 Vali Acc: 0.620 Test Loss: 1.055 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.901247262954712
Epoch: 4, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.578 Vali Acc: 0.507 Test Loss: 1.578 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9982249736785889
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.754 Vali Acc: 0.527 Test Loss: 1.754 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.999950885772705
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.903 Vali Acc: 0.580 Test Loss: 1.903 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.0123214721679688
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.162 Vali Acc: 0.624 Test Loss: 2.162 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.094515323638916
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.275 Vali Acc: 0.605 Test Loss: 2.275 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2104082107543945
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.457 Vali Acc: 0.556 Test Loss: 2.457 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.004579544067383
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.384 Vali Acc: 0.629 Test Loss: 2.384 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0097544193267822
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.416 Vali Acc: 0.605 Test Loss: 2.416 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6292682926829268
model parameter : 343554
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.630035877227783
Epoch: 1, Steps: 13 | Train Loss: 0.709 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 1.7493484020233154
Epoch: 2, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.794 Vali Acc: 0.649 Test Loss: 0.794 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7634315490722656
Epoch: 3, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.065 Vali Acc: 0.532 Test Loss: 1.065 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.726365089416504
Epoch: 4, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.285 Vali Acc: 0.566 Test Loss: 1.285 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8130433559417725
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.447 Vali Acc: 0.649 Test Loss: 1.447 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7388601303100586
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.638 Vali Acc: 0.644 Test Loss: 1.638 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7803773880004883
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.646 Vali Acc: 0.610 Test Loss: 1.646 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7786500453948975
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.742 Vali Acc: 0.654 Test Loss: 1.742 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7901201248168945
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.634 Test Loss: 1.768 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6095376014709473
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.615 Test Loss: 1.788 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6346871852874756
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.624 Test Loss: 1.797 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 283650
model size : 3.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4331774711608887
Epoch: 1, Steps: 13 | Train Loss: 0.744 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.75472092628479
Epoch: 2, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.734 Vali Acc: 0.644 Test Loss: 0.734 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6905169486999512
Epoch: 3, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.856 Vali Acc: 0.639 Test Loss: 0.856 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7847490310668945
Epoch: 4, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.092 Vali Acc: 0.639 Test Loss: 1.092 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.636038064956665
Epoch: 5, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.318 Vali Acc: 0.663 Test Loss: 1.318 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8683593273162842
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.510 Vali Acc: 0.668 Test Loss: 1.510 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.933018445968628
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.585 Vali Acc: 0.663 Test Loss: 1.585 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8954205513000488
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.665 Vali Acc: 0.644 Test Loss: 1.665 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.82086181640625
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.654 Test Loss: 1.715 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8142940998077393
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.639 Test Loss: 1.726 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.878718376159668
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.639 Test Loss: 1.751 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 255106
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.511173963546753
Epoch: 1, Steps: 13 | Train Loss: 1.005 Vali Loss: 1.420 Vali Acc: 0.439 Test Loss: 1.420 Test Acc: 0.439
Validation loss decreased (inf --> -0.439010).  Saving model ...
Epoch: 2 cost time: 5.053314447402954
Epoch: 2, Steps: 13 | Train Loss: 0.653 Vali Loss: 3.938 Vali Acc: 0.371 Test Loss: 3.938 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.20874810218811
Epoch: 3, Steps: 13 | Train Loss: 0.370 Vali Loss: 4.082 Vali Acc: 0.702 Test Loss: 4.082 Test Acc: 0.702
Validation loss decreased (-0.439010 --> -0.702398).  Saving model ...
Epoch: 4 cost time: 5.281757116317749
Epoch: 4, Steps: 13 | Train Loss: 0.575 Vali Loss: 3.616 Vali Acc: 0.605 Test Loss: 3.616 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.45543360710144
Epoch: 5, Steps: 13 | Train Loss: 0.379 Vali Loss: 4.745 Vali Acc: 0.610 Test Loss: 4.745 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.555316925048828
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 5.514 Vali Acc: 0.600 Test Loss: 5.514 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.503623723983765
Epoch: 7, Steps: 13 | Train Loss: 0.242 Vali Loss: 5.886 Vali Acc: 0.595 Test Loss: 5.886 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.567853927612305
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 8.193 Vali Acc: 0.488 Test Loss: 8.193 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.346349000930786
Epoch: 9, Steps: 13 | Train Loss: 0.048 Vali Loss: 10.646 Vali Acc: 0.502 Test Loss: 10.646 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.193849563598633
Epoch: 10, Steps: 13 | Train Loss: 0.231 Vali Loss: 10.400 Vali Acc: 0.541 Test Loss: 10.400 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.084689378738403
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 9.628 Vali Acc: 0.663 Test Loss: 9.628 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.096584796905518
Epoch: 12, Steps: 13 | Train Loss: 0.975 Vali Loss: 16.391 Vali Acc: 0.702 Test Loss: 16.391 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.027164697647095
Epoch: 13, Steps: 13 | Train Loss: 0.410 Vali Loss: 11.257 Vali Acc: 0.673 Test Loss: 11.257 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 1147522
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.660297870635986
Epoch: 1, Steps: 13 | Train Loss: 0.776 Vali Loss: 0.916 Vali Acc: 0.717 Test Loss: 0.916 Test Acc: 0.717
Validation loss decreased (inf --> -0.717064).  Saving model ...
Epoch: 2 cost time: 2.731179714202881
Epoch: 2, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.319 Vali Acc: 0.541 Test Loss: 1.319 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.663621187210083
Epoch: 3, Steps: 13 | Train Loss: 0.306 Vali Loss: 1.661 Vali Acc: 0.644 Test Loss: 1.661 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7460594177246094
Epoch: 4, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.263 Vali Acc: 0.654 Test Loss: 2.263 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.715242624282837
Epoch: 5, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.669 Vali Acc: 0.649 Test Loss: 2.669 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.682359218597412
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 3.523 Vali Acc: 0.532 Test Loss: 3.523 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.7531070709228516
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 5.500 Vali Acc: 0.444 Test Loss: 5.500 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7176623344421387
Epoch: 8, Steps: 13 | Train Loss: 0.070 Vali Loss: 4.421 Vali Acc: 0.620 Test Loss: 4.421 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.883314371109009
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.034 Vali Acc: 0.659 Test Loss: 5.034 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4843339920043945
Epoch: 10, Steps: 13 | Train Loss: 0.053 Vali Loss: 5.268 Vali Acc: 0.678 Test Loss: 5.268 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.79307222366333
Epoch: 11, Steps: 13 | Train Loss: 0.016 Vali Loss: 4.894 Vali Acc: 0.649 Test Loss: 4.894 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 664706
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9243555068969727
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.725 Vali Acc: 0.605 Test Loss: 0.725 Test Acc: 0.605
Validation loss decreased (inf --> -0.604871).  Saving model ...
Epoch: 2 cost time: 2.137815237045288
Epoch: 2, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.045 Vali Acc: 0.639 Test Loss: 1.045 Test Acc: 0.639
Validation loss decreased (-0.604871 --> -0.639014).  Saving model ...
Epoch: 3 cost time: 1.9642748832702637
Epoch: 3, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.031 Vali Acc: 0.473 Test Loss: 2.031 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9207887649536133
Epoch: 4, Steps: 13 | Train Loss: 0.094 Vali Loss: 2.082 Vali Acc: 0.610 Test Loss: 2.082 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8878893852233887
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 2.139 Vali Acc: 0.663 Test Loss: 2.139 Test Acc: 0.663
Validation loss decreased (-0.639014 --> -0.663393).  Saving model ...
Epoch: 6 cost time: 1.863699197769165
Epoch: 6, Steps: 13 | Train Loss: 0.088 Vali Loss: 2.576 Vali Acc: 0.649 Test Loss: 2.576 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1408116817474365
Epoch: 7, Steps: 13 | Train Loss: 0.063 Vali Loss: 3.393 Vali Acc: 0.654 Test Loss: 3.393 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1425070762634277
Epoch: 8, Steps: 13 | Train Loss: 0.089 Vali Loss: 3.538 Vali Acc: 0.639 Test Loss: 3.538 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.11380934715271
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 3.602 Vali Acc: 0.654 Test Loss: 3.602 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1741783618927
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.753 Vali Acc: 0.639 Test Loss: 3.753 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.2228989601135254
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.726 Vali Acc: 0.659 Test Loss: 3.726 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.155698776245117
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.693 Test Loss: 4.535 Test Acc: 0.693
Validation loss decreased (-0.663393 --> -0.692638).  Saving model ...
Epoch: 13 cost time: 2.2423195838928223
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 4.245 Vali Acc: 0.595 Test Loss: 4.245 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1819517612457275
Epoch: 14, Steps: 13 | Train Loss: 0.003 Vali Loss: 4.357 Vali Acc: 0.663 Test Loss: 4.357 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.194409132003784
Epoch: 15, Steps: 13 | Train Loss: 0.007 Vali Loss: 4.476 Vali Acc: 0.673 Test Loss: 4.476 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1170761585235596
Epoch: 16, Steps: 13 | Train Loss: 0.054 Vali Loss: 4.446 Vali Acc: 0.634 Test Loss: 4.446 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.136385917663574
Epoch: 17, Steps: 13 | Train Loss: 0.021 Vali Loss: 5.159 Vali Acc: 0.644 Test Loss: 5.159 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.228860378265381
Epoch: 18, Steps: 13 | Train Loss: 0.203 Vali Loss: 7.394 Vali Acc: 0.673 Test Loss: 7.394 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1284923553466797
Epoch: 19, Steps: 13 | Train Loss: 0.195 Vali Loss: 8.470 Vali Acc: 0.673 Test Loss: 8.470 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.116611957550049
Epoch: 20, Steps: 13 | Train Loss: 0.074 Vali Loss: 7.482 Vali Acc: 0.620 Test Loss: 7.482 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1953859329223633
Epoch: 21, Steps: 13 | Train Loss: 0.053 Vali Loss: 8.767 Vali Acc: 0.620 Test Loss: 8.767 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1928579807281494
Epoch: 22, Steps: 13 | Train Loss: 0.191 Vali Loss: 9.044 Vali Acc: 0.624 Test Loss: 9.044 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 494210
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.699498414993286
Epoch: 1, Steps: 13 | Train Loss: 0.743 Vali Loss: 1.620 Vali Acc: 0.268 Test Loss: 1.620 Test Acc: 0.268
Validation loss decreased (inf --> -0.268276).  Saving model ...
Epoch: 2 cost time: 2.010375499725342
Epoch: 2, Steps: 13 | Train Loss: 0.488 Vali Loss: 1.015 Vali Acc: 0.551 Test Loss: 1.015 Test Acc: 0.551
Validation loss decreased (-0.268276 --> -0.551209).  Saving model ...
Epoch: 3 cost time: 1.914520263671875
Epoch: 3, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.333 Vali Acc: 0.663 Test Loss: 1.333 Test Acc: 0.663
Validation loss decreased (-0.551209 --> -0.663401).  Saving model ...
Epoch: 4 cost time: 1.90333890914917
Epoch: 4, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.677 Vali Acc: 0.644 Test Loss: 1.677 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8920526504516602
Epoch: 5, Steps: 13 | Train Loss: 0.041 Vali Loss: 2.175 Vali Acc: 0.644 Test Loss: 2.175 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9142653942108154
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.283 Vali Acc: 0.615 Test Loss: 2.283 Test Acc: 0.615
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1448452472686768
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.665 Vali Acc: 0.663 Test Loss: 2.665 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9143483638763428
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 2.811 Vali Acc: 0.610 Test Loss: 2.811 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.016005277633667
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.125 Vali Acc: 0.629 Test Loss: 3.125 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1840951442718506
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.616 Vali Acc: 0.663 Test Loss: 3.616 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.071746349334717
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.334 Vali Acc: 0.585 Test Loss: 3.334 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9661426544189453
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.567 Vali Acc: 0.668 Test Loss: 3.567 Test Acc: 0.668
Validation loss decreased (-0.663401 --> -0.668257).  Saving model ...
Epoch: 13 cost time: 2.1992948055267334
Epoch: 13, Steps: 13 | Train Loss: 0.004 Vali Loss: 3.633 Vali Acc: 0.659 Test Loss: 3.633 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.298896074295044
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 4.719 Vali Acc: 0.649 Test Loss: 4.719 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1905677318573
Epoch: 15, Steps: 13 | Train Loss: 0.014 Vali Loss: 4.531 Vali Acc: 0.673 Test Loss: 4.531 Test Acc: 0.673
Validation loss decreased (-0.668257 --> -0.673125).  Saving model ...
Epoch: 16 cost time: 2.092641830444336
Epoch: 16, Steps: 13 | Train Loss: 0.025 Vali Loss: 4.331 Vali Acc: 0.668 Test Loss: 4.331 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1904454231262207
Epoch: 17, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.957 Vali Acc: 0.576 Test Loss: 4.957 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1860833168029785
Epoch: 18, Steps: 13 | Train Loss: 0.146 Vali Loss: 7.884 Vali Acc: 0.473 Test Loss: 7.884 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.304915428161621
Epoch: 19, Steps: 13 | Train Loss: 0.264 Vali Loss: 6.536 Vali Acc: 0.566 Test Loss: 6.536 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2098186016082764
Epoch: 20, Steps: 13 | Train Loss: 0.131 Vali Loss: 7.205 Vali Acc: 0.702 Test Loss: 7.205 Test Acc: 0.702
Validation loss decreased (-0.673125 --> -0.702367).  Saving model ...
Epoch: 21 cost time: 1.9710297584533691
Epoch: 21, Steps: 13 | Train Loss: 0.087 Vali Loss: 6.489 Vali Acc: 0.649 Test Loss: 6.489 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0646839141845703
Epoch: 22, Steps: 13 | Train Loss: 0.039 Vali Loss: 7.136 Vali Acc: 0.590 Test Loss: 7.136 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9663565158843994
Epoch: 23, Steps: 13 | Train Loss: 0.026 Vali Loss: 8.764 Vali Acc: 0.707 Test Loss: 8.764 Test Acc: 0.707
Validation loss decreased (-0.702367 --> -0.707229).  Saving model ...
Epoch: 24 cost time: 1.9911727905273438
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.672 Vali Acc: 0.624 Test Loss: 8.672 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0000760555267334
Epoch: 25, Steps: 13 | Train Loss: 0.049 Vali Loss: 9.933 Vali Acc: 0.698 Test Loss: 9.933 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9414441585540771
Epoch: 26, Steps: 13 | Train Loss: 0.002 Vali Loss: 8.863 Vali Acc: 0.659 Test Loss: 8.863 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.919724941253662
Epoch: 27, Steps: 13 | Train Loss: 0.059 Vali Loss: 9.286 Vali Acc: 0.693 Test Loss: 9.286 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9617373943328857
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.730 Vali Acc: 0.649 Test Loss: 8.730 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.905106782913208
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.593 Vali Acc: 0.615 Test Loss: 8.593 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8491878509521484
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 8.897 Vali Acc: 0.668 Test Loss: 8.897 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.069695234298706
Epoch: 31, Steps: 13 | Train Loss: 0.015 Vali Loss: 8.849 Vali Acc: 0.634 Test Loss: 8.849 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.1119472980499268
Epoch: 32, Steps: 13 | Train Loss: 0.001 Vali Loss: 10.244 Vali Acc: 0.693 Test Loss: 10.244 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.154174327850342
Epoch: 33, Steps: 13 | Train Loss: 0.026 Vali Loss: 9.554 Vali Acc: 0.634 Test Loss: 9.554 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 401794
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8239946365356445
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.629 Vali Acc: 0.698 Test Loss: 0.629 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 2.0133306980133057
Epoch: 2, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.847 Vali Acc: 0.663 Test Loss: 0.847 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9116873741149902
Epoch: 3, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.026 Vali Acc: 0.634 Test Loss: 1.026 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7531077861785889
Epoch: 4, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.351 Vali Acc: 0.673 Test Loss: 1.351 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5932393074035645
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.794 Vali Acc: 0.585 Test Loss: 1.794 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8746988773345947
Epoch: 6, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.073 Vali Acc: 0.576 Test Loss: 2.073 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7967956066131592
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.157 Vali Acc: 0.615 Test Loss: 2.157 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8178091049194336
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.240 Vali Acc: 0.644 Test Loss: 2.240 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.828338861465454
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.263 Vali Acc: 0.634 Test Loss: 2.263 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.851114273071289
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.548 Vali Acc: 0.663 Test Loss: 2.548 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.931844711303711
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.593 Vali Acc: 0.546 Test Loss: 2.593 Test Acc: 0.546
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 310658
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3086090087890625
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.692 Vali Acc: 0.707 Test Loss: 0.692 Test Acc: 0.707
Validation loss decreased (inf --> -0.707310).  Saving model ...
Epoch: 2 cost time: 1.6921396255493164
Epoch: 2, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.833 Vali Acc: 0.668 Test Loss: 0.833 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8371386528015137
Epoch: 3, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.912 Vali Acc: 0.649 Test Loss: 0.912 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7975943088531494
Epoch: 4, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.162 Vali Acc: 0.639 Test Loss: 1.162 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5517833232879639
Epoch: 5, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.383 Vali Acc: 0.620 Test Loss: 1.383 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6160552501678467
Epoch: 6, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.560 Vali Acc: 0.654 Test Loss: 1.560 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4679739475250244
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.619 Vali Acc: 0.644 Test Loss: 1.619 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3826782703399658
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.639 Test Loss: 1.689 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4384996891021729
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.644 Test Loss: 1.718 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6074614524841309
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.644 Test Loss: 1.738 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5377881526947021
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.639 Test Loss: 1.753 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 250754
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.318458318710327
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.670 Vali Acc: 0.668 Test Loss: 0.670 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 1.62711501121521
Epoch: 2, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.780 Vali Acc: 0.624 Test Loss: 0.780 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7769708633422852
Epoch: 3, Steps: 13 | Train Loss: 0.170 Vali Loss: 1.012 Vali Acc: 0.576 Test Loss: 1.012 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8802695274353027
Epoch: 4, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.240 Vali Acc: 0.644 Test Loss: 1.240 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.757826566696167
Epoch: 5, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.438 Vali Acc: 0.639 Test Loss: 1.438 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.628178596496582
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.643 Vali Acc: 0.595 Test Loss: 1.643 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6872875690460205
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.907 Vali Acc: 0.673 Test Loss: 1.907 Test Acc: 0.673
Validation loss decreased (-0.668286 --> -0.673152).  Saving model ...
Epoch: 8 cost time: 1.9380402565002441
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.615 Test Loss: 1.804 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.807715654373169
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.865 Vali Acc: 0.620 Test Loss: 1.865 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6233773231506348
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.644 Test Loss: 1.940 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.597424030303955
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.948 Vali Acc: 0.644 Test Loss: 1.948 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.609234094619751
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.649 Test Loss: 1.948 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8050589561462402
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.955 Vali Acc: 0.649 Test Loss: 1.955 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7182862758636475
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.649 Test Loss: 1.968 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4752025604248047
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.663 Test Loss: 1.985 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.641054630279541
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.644 Test Loss: 1.986 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5753140449523926
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.654 Test Loss: 2.006 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6731707317073171
model parameter : 222210
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.087359666824341
Epoch: 1, Steps: 13 | Train Loss: 1.112 Vali Loss: 1.824 Vali Acc: 0.341 Test Loss: 1.824 Test Acc: 0.341
Validation loss decreased (inf --> -0.341445).  Saving model ...
Epoch: 2 cost time: 4.503693342208862
Epoch: 2, Steps: 13 | Train Loss: 0.647 Vali Loss: 5.049 Vali Acc: 0.317 Test Loss: 5.049 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.578715562820435
Epoch: 3, Steps: 13 | Train Loss: 0.785 Vali Loss: 5.012 Vali Acc: 0.722 Test Loss: 5.012 Test Acc: 0.722
Validation loss decreased (-0.341445 --> -0.721901).  Saving model ...
Epoch: 4 cost time: 4.583569526672363
Epoch: 4, Steps: 13 | Train Loss: 0.457 Vali Loss: 5.305 Vali Acc: 0.712 Test Loss: 5.305 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.29964280128479
Epoch: 5, Steps: 13 | Train Loss: 0.598 Vali Loss: 4.463 Vali Acc: 0.678 Test Loss: 4.463 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.45077657699585
Epoch: 6, Steps: 13 | Train Loss: 0.175 Vali Loss: 6.090 Vali Acc: 0.702 Test Loss: 6.090 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.438039302825928
Epoch: 7, Steps: 13 | Train Loss: 0.079 Vali Loss: 7.237 Vali Acc: 0.483 Test Loss: 7.237 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.6563639640808105
Epoch: 8, Steps: 13 | Train Loss: 0.041 Vali Loss: 7.242 Vali Acc: 0.610 Test Loss: 7.242 Test Acc: 0.610
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.559825420379639
Epoch: 9, Steps: 13 | Train Loss: 0.029 Vali Loss: 7.760 Vali Acc: 0.639 Test Loss: 7.760 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.877063512802124
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 7.665 Vali Acc: 0.580 Test Loss: 7.665 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.842855930328369
Epoch: 11, Steps: 13 | Train Loss: 0.502 Vali Loss: 9.050 Vali Acc: 0.712 Test Loss: 9.050 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.711702585220337
Epoch: 12, Steps: 13 | Train Loss: 0.333 Vali Loss: 8.607 Vali Acc: 0.668 Test Loss: 8.607 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.720821380615234
Epoch: 13, Steps: 13 | Train Loss: 0.069 Vali Loss: 9.566 Vali Acc: 0.629 Test Loss: 9.566 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1131074
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.189112901687622
Epoch: 1, Steps: 13 | Train Loss: 0.879 Vali Loss: 1.149 Vali Acc: 0.707 Test Loss: 1.149 Test Acc: 0.707
Validation loss decreased (inf --> -0.707306).  Saving model ...
Epoch: 2 cost time: 2.5872740745544434
Epoch: 2, Steps: 13 | Train Loss: 0.670 Vali Loss: 3.304 Vali Acc: 0.341 Test Loss: 3.304 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.806870222091675
Epoch: 3, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.806 Vali Acc: 0.571 Test Loss: 1.806 Test Acc: 0.571
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8772244453430176
Epoch: 4, Steps: 13 | Train Loss: 0.260 Vali Loss: 2.641 Vali Acc: 0.673 Test Loss: 2.641 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7211098670959473
Epoch: 5, Steps: 13 | Train Loss: 0.106 Vali Loss: 3.490 Vali Acc: 0.556 Test Loss: 3.490 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.815175771713257
Epoch: 6, Steps: 13 | Train Loss: 0.199 Vali Loss: 4.179 Vali Acc: 0.556 Test Loss: 4.179 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.754678726196289
Epoch: 7, Steps: 13 | Train Loss: 0.083 Vali Loss: 3.576 Vali Acc: 0.659 Test Loss: 3.576 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7101244926452637
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 4.416 Vali Acc: 0.537 Test Loss: 4.416 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.738936185836792
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 4.949 Vali Acc: 0.702 Test Loss: 4.949 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6805496215820312
Epoch: 10, Steps: 13 | Train Loss: 0.032 Vali Loss: 4.745 Vali Acc: 0.634 Test Loss: 4.745 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6019716262817383
Epoch: 11, Steps: 13 | Train Loss: 0.116 Vali Loss: 4.796 Vali Acc: 0.600 Test Loss: 4.796 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 648258
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.852078676223755
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
Validation loss decreased (inf --> -0.580480).  Saving model ...
Epoch: 2 cost time: 2.2474873065948486
Epoch: 2, Steps: 13 | Train Loss: 0.257 Vali Loss: 1.157 Vali Acc: 0.585 Test Loss: 1.157 Test Acc: 0.585
Validation loss decreased (-0.580480 --> -0.585354).  Saving model ...
Epoch: 3 cost time: 2.1575989723205566
Epoch: 3, Steps: 13 | Train Loss: 0.264 Vali Loss: 1.968 Vali Acc: 0.532 Test Loss: 1.968 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2069435119628906
Epoch: 4, Steps: 13 | Train Loss: 0.111 Vali Loss: 2.088 Vali Acc: 0.615 Test Loss: 2.088 Test Acc: 0.615
Validation loss decreased (-0.585354 --> -0.614613).  Saving model ...
Epoch: 5 cost time: 2.256411552429199
Epoch: 5, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.472 Vali Acc: 0.644 Test Loss: 2.472 Test Acc: 0.644
Validation loss decreased (-0.614613 --> -0.643878).  Saving model ...
Epoch: 6 cost time: 2.2757668495178223
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.861 Vali Acc: 0.590 Test Loss: 2.861 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1557884216308594
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.320 Vali Acc: 0.644 Test Loss: 3.320 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2106876373291016
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 3.891 Vali Acc: 0.649 Test Loss: 3.891 Test Acc: 0.649
Validation loss decreased (-0.643878 --> -0.648742).  Saving model ...
Epoch: 9 cost time: 2.108935832977295
Epoch: 9, Steps: 13 | Train Loss: 0.053 Vali Loss: 4.464 Vali Acc: 0.683 Test Loss: 4.464 Test Acc: 0.683
Validation loss decreased (-0.648742 --> -0.682882).  Saving model ...
Epoch: 10 cost time: 2.161648988723755
Epoch: 10, Steps: 13 | Train Loss: 0.117 Vali Loss: 3.883 Vali Acc: 0.629 Test Loss: 3.883 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0818231105804443
Epoch: 11, Steps: 13 | Train Loss: 0.186 Vali Loss: 4.352 Vali Acc: 0.654 Test Loss: 4.352 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1295864582061768
Epoch: 12, Steps: 13 | Train Loss: 0.222 Vali Loss: 6.700 Vali Acc: 0.702 Test Loss: 6.700 Test Acc: 0.702
Validation loss decreased (-0.682882 --> -0.702372).  Saving model ...
Epoch: 13 cost time: 2.241032123565674
Epoch: 13, Steps: 13 | Train Loss: 0.110 Vali Loss: 7.163 Vali Acc: 0.693 Test Loss: 7.163 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0452587604522705
Epoch: 14, Steps: 13 | Train Loss: 0.227 Vali Loss: 7.527 Vali Acc: 0.473 Test Loss: 7.527 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1729042530059814
Epoch: 15, Steps: 13 | Train Loss: 0.097 Vali Loss: 7.788 Vali Acc: 0.488 Test Loss: 7.788 Test Acc: 0.488
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0572915077209473
Epoch: 16, Steps: 13 | Train Loss: 0.083 Vali Loss: 8.209 Vali Acc: 0.668 Test Loss: 8.209 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.155916929244995
Epoch: 17, Steps: 13 | Train Loss: 0.086 Vali Loss: 8.714 Vali Acc: 0.576 Test Loss: 8.714 Test Acc: 0.576
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.244643211364746
Epoch: 18, Steps: 13 | Train Loss: 0.034 Vali Loss: 9.356 Vali Acc: 0.595 Test Loss: 9.356 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.185106039047241
Epoch: 19, Steps: 13 | Train Loss: 0.012 Vali Loss: 9.788 Vali Acc: 0.668 Test Loss: 9.788 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.192713499069214
Epoch: 20, Steps: 13 | Train Loss: 0.060 Vali Loss: 9.377 Vali Acc: 0.595 Test Loss: 9.377 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2793922424316406
Epoch: 21, Steps: 13 | Train Loss: 0.131 Vali Loss: 9.559 Vali Acc: 0.590 Test Loss: 9.559 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.270782470703125
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 9.767 Vali Acc: 0.649 Test Loss: 9.767 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 477762
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.576019048690796
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.699 Vali Acc: 0.624 Test Loss: 0.699 Test Acc: 0.624
Validation loss decreased (inf --> -0.624383).  Saving model ...
Epoch: 2 cost time: 1.9713945388793945
Epoch: 2, Steps: 13 | Train Loss: 0.390 Vali Loss: 1.407 Vali Acc: 0.439 Test Loss: 1.407 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.902848482131958
Epoch: 3, Steps: 13 | Train Loss: 0.343 Vali Loss: 1.559 Vali Acc: 0.468 Test Loss: 1.559 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8413841724395752
Epoch: 4, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.719 Vali Acc: 0.561 Test Loss: 1.719 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.875852108001709
Epoch: 5, Steps: 13 | Train Loss: 0.106 Vali Loss: 2.282 Vali Acc: 0.551 Test Loss: 2.282 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.852036476135254
Epoch: 6, Steps: 13 | Train Loss: 0.089 Vali Loss: 3.776 Vali Acc: 0.380 Test Loss: 3.776 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9214880466461182
Epoch: 7, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.700 Vali Acc: 0.634 Test Loss: 2.700 Test Acc: 0.634
Validation loss decreased (-0.624383 --> -0.634119).  Saving model ...
Epoch: 8 cost time: 1.982588529586792
Epoch: 8, Steps: 13 | Train Loss: 0.077 Vali Loss: 3.866 Vali Acc: 0.712 Test Loss: 3.866 Test Acc: 0.712
Validation loss decreased (-0.634119 --> -0.712156).  Saving model ...
Epoch: 9 cost time: 1.8981564044952393
Epoch: 9, Steps: 13 | Train Loss: 0.099 Vali Loss: 3.826 Vali Acc: 0.644 Test Loss: 3.826 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9918301105499268
Epoch: 10, Steps: 13 | Train Loss: 0.051 Vali Loss: 4.080 Vali Acc: 0.590 Test Loss: 4.080 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0075201988220215
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.939 Vali Acc: 0.639 Test Loss: 3.939 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9903438091278076
Epoch: 12, Steps: 13 | Train Loss: 0.008 Vali Loss: 4.239 Vali Acc: 0.600 Test Loss: 4.239 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9594841003417969
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 4.802 Vali Acc: 0.663 Test Loss: 4.802 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1029324531555176
Epoch: 14, Steps: 13 | Train Loss: 0.036 Vali Loss: 5.363 Vali Acc: 0.532 Test Loss: 5.363 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0174365043640137
Epoch: 15, Steps: 13 | Train Loss: 0.015 Vali Loss: 4.945 Vali Acc: 0.576 Test Loss: 4.945 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.841515302658081
Epoch: 16, Steps: 13 | Train Loss: 0.003 Vali Loss: 5.100 Vali Acc: 0.659 Test Loss: 5.100 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9468696117401123
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 5.105 Vali Acc: 0.639 Test Loss: 5.105 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.973426342010498
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.191 Vali Acc: 0.610 Test Loss: 5.191 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 385346
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5654585361480713
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.652 Vali Acc: 0.702 Test Loss: 0.652 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 1.8873114585876465
Epoch: 2, Steps: 13 | Train Loss: 0.341 Vali Loss: 1.042 Vali Acc: 0.532 Test Loss: 1.042 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8266088962554932
Epoch: 3, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.204 Vali Acc: 0.663 Test Loss: 1.204 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8591043949127197
Epoch: 4, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.318 Vali Acc: 0.639 Test Loss: 1.318 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8878111839294434
Epoch: 5, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.583 Vali Acc: 0.668 Test Loss: 1.583 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8039624691009521
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.691 Vali Acc: 0.654 Test Loss: 1.691 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6844508647918701
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.787 Vali Acc: 0.624 Test Loss: 1.787 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7190628051757812
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.880 Vali Acc: 0.629 Test Loss: 1.880 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7483599185943604
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.020 Vali Acc: 0.571 Test Loss: 2.020 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4203979969024658
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.041 Vali Acc: 0.639 Test Loss: 2.041 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6234030723571777
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.610 Test Loss: 2.029 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 294210
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2956104278564453
Epoch: 1, Steps: 13 | Train Loss: 0.731 Vali Loss: 0.693 Vali Acc: 0.712 Test Loss: 0.693 Test Acc: 0.712
Validation loss decreased (inf --> -0.712188).  Saving model ...
Epoch: 2 cost time: 1.6102404594421387
Epoch: 2, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.717 Vali Acc: 0.683 Test Loss: 0.717 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6262638568878174
Epoch: 3, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.921 Vali Acc: 0.649 Test Loss: 0.921 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6600744724273682
Epoch: 4, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.154 Vali Acc: 0.654 Test Loss: 1.154 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7179234027862549
Epoch: 5, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.412 Vali Acc: 0.649 Test Loss: 1.412 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5323221683502197
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.601 Vali Acc: 0.634 Test Loss: 1.601 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6588854789733887
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.600 Test Loss: 1.662 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5299785137176514
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.605 Test Loss: 1.693 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7996671199798584
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.639 Test Loss: 1.724 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7065377235412598
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.738 Vali Acc: 0.615 Test Loss: 1.738 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5878784656524658
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.620 Test Loss: 1.760 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 234306
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.22363018989563
Epoch: 1, Steps: 13 | Train Loss: 0.735 Vali Loss: 0.660 Vali Acc: 0.707 Test Loss: 0.660 Test Acc: 0.707
Validation loss decreased (inf --> -0.707310).  Saving model ...
Epoch: 2 cost time: 1.7851474285125732
Epoch: 2, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.738 Vali Acc: 0.576 Test Loss: 0.738 Test Acc: 0.576
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.715209722518921
Epoch: 3, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.872 Vali Acc: 0.663 Test Loss: 0.872 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.577068567276001
Epoch: 4, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.112 Vali Acc: 0.649 Test Loss: 1.112 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7652325630187988
Epoch: 5, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.348 Vali Acc: 0.561 Test Loss: 1.348 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.697164535522461
Epoch: 6, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.652 Vali Acc: 0.659 Test Loss: 1.652 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6998512744903564
Epoch: 7, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.754 Vali Acc: 0.551 Test Loss: 1.754 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7963676452636719
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.752 Vali Acc: 0.644 Test Loss: 1.752 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.649379014968872
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.770 Vali Acc: 0.639 Test Loss: 1.770 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8947265148162842
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.615 Test Loss: 1.770 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.578625202178955
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.629 Test Loss: 1.810 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm128_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 205762
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 6.192579507827759
Epoch: 1, Steps: 13 | Train Loss: 0.799 Vali Loss: 1.993 Vali Acc: 0.283 Test Loss: 1.993 Test Acc: 0.283
Validation loss decreased (inf --> -0.282907).  Saving model ...
Epoch: 2 cost time: 4.516279220581055
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 1.242 Vali Acc: 0.546 Test Loss: 1.242 Test Acc: 0.546
Validation loss decreased (-0.282907 --> -0.546329).  Saving model ...
Epoch: 3 cost time: 4.702129364013672
Epoch: 3, Steps: 13 | Train Loss: 0.367 Vali Loss: 1.641 Vali Acc: 0.561 Test Loss: 1.641 Test Acc: 0.561
Validation loss decreased (-0.546329 --> -0.560959).  Saving model ...
Epoch: 4 cost time: 4.735413074493408
Epoch: 4, Steps: 13 | Train Loss: 0.153 Vali Loss: 2.020 Vali Acc: 0.659 Test Loss: 2.020 Test Acc: 0.659
Validation loss decreased (-0.560959 --> -0.658516).  Saving model ...
Epoch: 5 cost time: 5.059833526611328
Epoch: 5, Steps: 13 | Train Loss: 0.027 Vali Loss: 2.276 Vali Acc: 0.644 Test Loss: 2.276 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.602417707443237
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.587 Vali Acc: 0.620 Test Loss: 2.587 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.871515512466431
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 3.196 Vali Acc: 0.673 Test Loss: 3.196 Test Acc: 0.673
Validation loss decreased (-0.658516 --> -0.673139).  Saving model ...
Epoch: 8 cost time: 5.229140043258667
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.891 Vali Acc: 0.693 Test Loss: 3.891 Test Acc: 0.693
Validation loss decreased (-0.673139 --> -0.692644).  Saving model ...
Epoch: 9 cost time: 5.051105260848999
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 3.613 Vali Acc: 0.551 Test Loss: 3.613 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.8227503299713135
Epoch: 10, Steps: 13 | Train Loss: 0.037 Vali Loss: 4.178 Vali Acc: 0.673 Test Loss: 4.178 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.302331447601318
Epoch: 11, Steps: 13 | Train Loss: 0.113 Vali Loss: 4.557 Vali Acc: 0.571 Test Loss: 4.557 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.730893850326538
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 4.735 Vali Acc: 0.620 Test Loss: 4.735 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.820009231567383
Epoch: 13, Steps: 13 | Train Loss: 0.093 Vali Loss: 7.458 Vali Acc: 0.439 Test Loss: 7.458 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.948476552963257
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 6.950 Vali Acc: 0.527 Test Loss: 6.950 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.205493927001953
Epoch: 15, Steps: 13 | Train Loss: 0.145 Vali Loss: 6.322 Vali Acc: 0.576 Test Loss: 6.322 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.956911087036133
Epoch: 16, Steps: 13 | Train Loss: 0.108 Vali Loss: 5.915 Vali Acc: 0.610 Test Loss: 5.915 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.6371095180511475
Epoch: 17, Steps: 13 | Train Loss: 0.177 Vali Loss: 7.161 Vali Acc: 0.532 Test Loss: 7.161 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.6471028327941895
Epoch: 18, Steps: 13 | Train Loss: 0.090 Vali Loss: 7.454 Vali Acc: 0.537 Test Loss: 7.454 Test Acc: 0.537
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 573954
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.497609853744507
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.744 Vali Acc: 0.722 Test Loss: 0.744 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.722417116165161
Epoch: 2, Steps: 13 | Train Loss: 0.455 Vali Loss: 1.517 Vali Acc: 0.712 Test Loss: 1.517 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7416605949401855
Epoch: 3, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.129 Vali Acc: 0.629 Test Loss: 1.129 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.69887638092041
Epoch: 4, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.726 Vali Acc: 0.541 Test Loss: 1.726 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.8211374282836914
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.607 Vali Acc: 0.644 Test Loss: 1.607 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.901050567626953
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.867 Vali Acc: 0.649 Test Loss: 1.867 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9408648014068604
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.057 Vali Acc: 0.668 Test Loss: 2.057 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.890141725540161
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.076 Vali Acc: 0.668 Test Loss: 2.076 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.794595956802368
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.054 Vali Acc: 0.634 Test Loss: 2.054 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7814927101135254
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.663 Test Loss: 2.084 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7643227577209473
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.673 Test Loss: 2.098 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 332546
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8904430866241455
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.041743040084839
Epoch: 2, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.770 Vali Acc: 0.659 Test Loss: 0.770 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.01389479637146
Epoch: 3, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.081 Vali Acc: 0.600 Test Loss: 1.081 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1147665977478027
Epoch: 4, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.412 Vali Acc: 0.659 Test Loss: 1.412 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0360348224639893
Epoch: 5, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.751 Vali Acc: 0.678 Test Loss: 1.751 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0375187397003174
Epoch: 6, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.933 Vali Acc: 0.663 Test Loss: 1.933 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9865515232086182
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 2.027 Vali Acc: 0.663 Test Loss: 2.027 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9978642463684082
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.787 Vali Acc: 0.493 Test Loss: 2.787 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9319045543670654
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.902 Vali Acc: 0.678 Test Loss: 2.902 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.072638750076294
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 3.668 Vali Acc: 0.454 Test Loss: 3.668 Test Acc: 0.454
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.151400566101074
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.052 Vali Acc: 0.678 Test Loss: 3.052 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 247298
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4997828006744385
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.628 Vali Acc: 0.673 Test Loss: 0.628 Test Acc: 0.673
Validation loss decreased (inf --> -0.673164).  Saving model ...
Epoch: 2 cost time: 1.9151277542114258
Epoch: 2, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.737 Vali Acc: 0.693 Test Loss: 0.737 Test Acc: 0.693
Validation loss decreased (-0.673164 --> -0.692676).  Saving model ...
Epoch: 3 cost time: 1.9493508338928223
Epoch: 3, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.309 Vali Acc: 0.454 Test Loss: 1.309 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6887121200561523
Epoch: 4, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.274 Vali Acc: 0.532 Test Loss: 1.274 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.023219347000122
Epoch: 5, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.295 Vali Acc: 0.639 Test Loss: 1.295 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0071284770965576
Epoch: 6, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.419 Vali Acc: 0.649 Test Loss: 1.419 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8595807552337646
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.563 Vali Acc: 0.620 Test Loss: 1.563 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5586674213409424
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.598 Vali Acc: 0.649 Test Loss: 1.598 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7484166622161865
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.662 Vali Acc: 0.649 Test Loss: 1.662 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6033315658569336
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.624 Test Loss: 1.589 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8346831798553467
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.618 Vali Acc: 0.649 Test Loss: 1.618 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8636229038238525
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.639 Test Loss: 1.622 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 201090
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0745604038238525
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5716376304626465
Epoch: 2, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.673 Vali Acc: 0.683 Test Loss: 0.673 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.510129690170288
Epoch: 3, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.841 Vali Acc: 0.590 Test Loss: 0.841 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.399364709854126
Epoch: 4, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.046 Vali Acc: 0.654 Test Loss: 1.046 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.484501600265503
Epoch: 5, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.145 Vali Acc: 0.615 Test Loss: 1.145 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5143404006958008
Epoch: 6, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.257 Vali Acc: 0.644 Test Loss: 1.257 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6019752025604248
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.355 Vali Acc: 0.639 Test Loss: 1.355 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4251973628997803
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.389 Vali Acc: 0.610 Test Loss: 1.389 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5365550518035889
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.432 Vali Acc: 0.610 Test Loss: 1.432 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5183565616607666
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.463 Vali Acc: 0.605 Test Loss: 1.463 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5190925598144531
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.486 Vali Acc: 0.610 Test Loss: 1.486 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 155522
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.965320110321045
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.655 Vali Acc: 0.712 Test Loss: 0.655 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.3020100593566895
Epoch: 2, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.697 Vali Acc: 0.629 Test Loss: 0.697 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1817619800567627
Epoch: 3, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.830 Vali Acc: 0.698 Test Loss: 0.830 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4204442501068115
Epoch: 4, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.068 Vali Acc: 0.702 Test Loss: 1.068 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.133488655090332
Epoch: 5, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.018 Vali Acc: 0.610 Test Loss: 1.018 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4369926452636719
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.180 Vali Acc: 0.620 Test Loss: 1.180 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5013656616210938
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.286 Vali Acc: 0.629 Test Loss: 1.286 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4157638549804688
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.358 Vali Acc: 0.654 Test Loss: 1.358 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4222939014434814
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.398 Vali Acc: 0.649 Test Loss: 1.398 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3874976634979248
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.450 Vali Acc: 0.649 Test Loss: 1.450 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4231617450714111
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.465 Vali Acc: 0.639 Test Loss: 1.465 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 125570
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0767931938171387
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.656 Vali Acc: 0.678 Test Loss: 0.656 Test Acc: 0.678
Validation loss decreased (inf --> -0.678042).  Saving model ...
Epoch: 2 cost time: 1.5719034671783447
Epoch: 2, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.704 Vali Acc: 0.639 Test Loss: 0.704 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4213392734527588
Epoch: 3, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.782 Vali Acc: 0.585 Test Loss: 0.782 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5675065517425537
Epoch: 4, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.891 Vali Acc: 0.668 Test Loss: 0.891 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.37149977684021
Epoch: 5, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.967 Vali Acc: 0.620 Test Loss: 0.967 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4458177089691162
Epoch: 6, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.156 Vali Acc: 0.600 Test Loss: 1.156 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.497342824935913
Epoch: 7, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.320 Vali Acc: 0.629 Test Loss: 1.320 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4183688163757324
Epoch: 8, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.393 Vali Acc: 0.576 Test Loss: 1.393 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.469529390335083
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.421 Vali Acc: 0.620 Test Loss: 1.421 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.6905343532562256
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.485 Vali Acc: 0.595 Test Loss: 1.485 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5554955005645752
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.534 Vali Acc: 0.595 Test Loss: 1.534 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6780487804878049
model parameter : 111298
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.9887378215789795
Epoch: 1, Steps: 13 | Train Loss: 0.750 Vali Loss: 1.356 Vali Acc: 0.722 Test Loss: 1.356 Test Acc: 0.722
Validation loss decreased (inf --> -0.721938).  Saving model ...
Epoch: 2 cost time: 3.351771116256714
Epoch: 2, Steps: 13 | Train Loss: 0.612 Vali Loss: 2.289 Vali Acc: 0.366 Test Loss: 2.289 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.754298686981201
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 2.046 Vali Acc: 0.698 Test Loss: 2.046 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.806112051010132
Epoch: 4, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.487 Vali Acc: 0.532 Test Loss: 2.487 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.002697467803955
Epoch: 5, Steps: 13 | Train Loss: 0.095 Vali Loss: 2.456 Vali Acc: 0.620 Test Loss: 2.456 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6248607635498047
Epoch: 6, Steps: 13 | Train Loss: 0.038 Vali Loss: 3.762 Vali Acc: 0.507 Test Loss: 3.762 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8477654457092285
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 3.514 Vali Acc: 0.659 Test Loss: 3.514 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.692466974258423
Epoch: 8, Steps: 13 | Train Loss: 0.066 Vali Loss: 5.859 Vali Acc: 0.707 Test Loss: 5.859 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.7838518619537354
Epoch: 9, Steps: 13 | Train Loss: 0.194 Vali Loss: 5.388 Vali Acc: 0.693 Test Loss: 5.388 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.74013614654541
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 5.442 Vali Acc: 0.678 Test Loss: 5.442 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.6188223361968994
Epoch: 11, Steps: 13 | Train Loss: 0.079 Vali Loss: 7.713 Vali Acc: 0.702 Test Loss: 7.713 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 557442
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8182156085968018
Epoch: 1, Steps: 13 | Train Loss: 0.721 Vali Loss: 0.680 Vali Acc: 0.624 Test Loss: 0.680 Test Acc: 0.624
Validation loss decreased (inf --> -0.624383).  Saving model ...
Epoch: 2 cost time: 2.0364575386047363
Epoch: 2, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.160 Vali Acc: 0.717 Test Loss: 1.160 Test Acc: 0.717
Validation loss decreased (-0.624383 --> -0.717062).  Saving model ...
Epoch: 3 cost time: 2.1346020698547363
Epoch: 3, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.168 Vali Acc: 0.688 Test Loss: 1.168 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9910688400268555
Epoch: 4, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.875 Vali Acc: 0.712 Test Loss: 1.875 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.020526885986328
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.806 Vali Acc: 0.537 Test Loss: 1.806 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9803309440612793
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.878 Vali Acc: 0.620 Test Loss: 1.878 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0297000408172607
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.016 Vali Acc: 0.659 Test Loss: 2.016 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.098796844482422
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 2.432 Vali Acc: 0.546 Test Loss: 2.432 Test Acc: 0.546
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.175652027130127
Epoch: 9, Steps: 13 | Train Loss: 0.042 Vali Loss: 3.339 Vali Acc: 0.502 Test Loss: 3.339 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.158550262451172
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 3.512 Vali Acc: 0.512 Test Loss: 3.512 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.092714786529541
Epoch: 11, Steps: 13 | Train Loss: 0.034 Vali Loss: 3.517 Vali Acc: 0.541 Test Loss: 3.517 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.0381059646606445
Epoch: 12, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.653 Vali Acc: 0.624 Test Loss: 3.653 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 316034
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.462529182434082
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.672 Vali Acc: 0.634 Test Loss: 0.672 Test Acc: 0.634
Validation loss decreased (inf --> -0.634140).  Saving model ...
Epoch: 2 cost time: 1.7567799091339111
Epoch: 2, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.843 Vali Acc: 0.668 Test Loss: 0.843 Test Acc: 0.668
Validation loss decreased (-0.634140 --> -0.668284).  Saving model ...
Epoch: 3 cost time: 1.8859179019927979
Epoch: 3, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.490 Vali Acc: 0.702 Test Loss: 1.490 Test Acc: 0.702
Validation loss decreased (-0.668284 --> -0.702424).  Saving model ...
Epoch: 4 cost time: 1.8984403610229492
Epoch: 4, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.399 Vali Acc: 0.659 Test Loss: 1.399 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8702471256256104
Epoch: 5, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.588 Vali Acc: 0.644 Test Loss: 1.588 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7162625789642334
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.767 Vali Acc: 0.644 Test Loss: 1.767 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7852189540863037
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.853 Vali Acc: 0.639 Test Loss: 1.853 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7373158931732178
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.939 Vali Acc: 0.654 Test Loss: 1.939 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8259060382843018
Epoch: 9, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.624 Test Loss: 1.962 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7530920505523682
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.649 Test Loss: 1.997 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8129889965057373
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.639 Test Loss: 2.005 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.804471731185913
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.649 Test Loss: 2.022 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.706023931503296
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.649 Test Loss: 2.019 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 230786
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.187819242477417
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.626 Vali Acc: 0.698 Test Loss: 0.626 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 1.5733177661895752
Epoch: 2, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.733 Vali Acc: 0.678 Test Loss: 0.733 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5217936038970947
Epoch: 3, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.002 Vali Acc: 0.585 Test Loss: 1.002 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5214369297027588
Epoch: 4, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.119 Vali Acc: 0.620 Test Loss: 1.119 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5534789562225342
Epoch: 5, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.340 Vali Acc: 0.644 Test Loss: 1.340 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5088000297546387
Epoch: 6, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.468 Vali Acc: 0.644 Test Loss: 1.468 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.567295789718628
Epoch: 7, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.506 Vali Acc: 0.639 Test Loss: 1.506 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5935726165771484
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.601 Vali Acc: 0.624 Test Loss: 1.601 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.511047601699829
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.634 Test Loss: 1.667 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.634634017944336
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.634 Test Loss: 1.682 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6208710670471191
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.687 Vali Acc: 0.629 Test Loss: 1.687 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 184578
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0387208461761475
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.686 Vali Acc: 0.722 Test Loss: 0.686 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.2132976055145264
Epoch: 2, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.786 Vali Acc: 0.532 Test Loss: 0.786 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3133273124694824
Epoch: 3, Steps: 13 | Train Loss: 0.240 Vali Loss: 1.018 Vali Acc: 0.473 Test Loss: 1.018 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3153316974639893
Epoch: 4, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.980 Vali Acc: 0.639 Test Loss: 0.980 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2758116722106934
Epoch: 5, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.119 Vali Acc: 0.629 Test Loss: 1.119 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3088436126708984
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.291 Vali Acc: 0.571 Test Loss: 1.291 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2052886486053467
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.411 Vali Acc: 0.595 Test Loss: 1.411 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.339331865310669
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.480 Vali Acc: 0.624 Test Loss: 1.480 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3674437999725342
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.490 Vali Acc: 0.620 Test Loss: 1.490 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2222633361816406
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.634 Test Loss: 1.519 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3051307201385498
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.540 Vali Acc: 0.629 Test Loss: 1.540 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 139010
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8035783767700195
Epoch: 1, Steps: 13 | Train Loss: 0.727 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.194427490234375
Epoch: 2, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.732 Vali Acc: 0.595 Test Loss: 0.732 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2372992038726807
Epoch: 3, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.843 Vali Acc: 0.576 Test Loss: 0.843 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2455801963806152
Epoch: 4, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.085 Vali Acc: 0.707 Test Loss: 1.085 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1964216232299805
Epoch: 5, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.014 Vali Acc: 0.644 Test Loss: 1.014 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1440486907958984
Epoch: 6, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.069 Vali Acc: 0.629 Test Loss: 1.069 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2513058185577393
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.202 Vali Acc: 0.624 Test Loss: 1.202 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.236962080001831
Epoch: 8, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.324 Vali Acc: 0.649 Test Loss: 1.324 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.208117961883545
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.337 Vali Acc: 0.644 Test Loss: 1.337 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1865265369415283
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.374 Vali Acc: 0.649 Test Loss: 1.374 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2162632942199707
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.429 Vali Acc: 0.634 Test Loss: 1.429 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 109058
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.156254291534424
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0862972736358643
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.734 Vali Acc: 0.590 Test Loss: 0.734 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3281934261322021
Epoch: 3, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.778 Vali Acc: 0.683 Test Loss: 0.778 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.187352180480957
Epoch: 4, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.858 Vali Acc: 0.571 Test Loss: 0.858 Test Acc: 0.571
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3265631198883057
Epoch: 5, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.977 Vali Acc: 0.629 Test Loss: 0.977 Test Acc: 0.629
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2393240928649902
Epoch: 6, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.192 Vali Acc: 0.654 Test Loss: 1.192 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2452483177185059
Epoch: 7, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.284 Vali Acc: 0.610 Test Loss: 1.284 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2806284427642822
Epoch: 8, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.365 Vali Acc: 0.629 Test Loss: 1.365 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2426400184631348
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.437 Vali Acc: 0.615 Test Loss: 1.437 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3243615627288818
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.475 Vali Acc: 0.600 Test Loss: 1.475 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2233498096466064
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.512 Vali Acc: 0.634 Test Loss: 1.512 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 94786
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.594449281692505
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.937 Vali Acc: 0.424 Test Loss: 0.937 Test Acc: 0.424
Validation loss decreased (inf --> -0.424381).  Saving model ...
Epoch: 2 cost time: 3.3207783699035645
Epoch: 2, Steps: 13 | Train Loss: 0.241 Vali Loss: 1.041 Vali Acc: 0.668 Test Loss: 1.041 Test Acc: 0.668
Validation loss decreased (-0.424381 --> -0.668282).  Saving model ...
Epoch: 3 cost time: 3.5415258407592773
Epoch: 3, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.779 Vali Acc: 0.717 Test Loss: 1.779 Test Acc: 0.717
Validation loss decreased (-0.668282 --> -0.717055).  Saving model ...
Epoch: 4 cost time: 3.477696418762207
Epoch: 4, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.157 Vali Acc: 0.571 Test Loss: 2.157 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7894809246063232
Epoch: 5, Steps: 13 | Train Loss: 0.091 Vali Loss: 2.813 Vali Acc: 0.707 Test Loss: 2.813 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7075955867767334
Epoch: 6, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.640 Vali Acc: 0.590 Test Loss: 2.640 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7340054512023926
Epoch: 7, Steps: 13 | Train Loss: 0.055 Vali Loss: 3.238 Vali Acc: 0.537 Test Loss: 3.238 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.825162649154663
Epoch: 8, Steps: 13 | Train Loss: 0.136 Vali Loss: 4.069 Vali Acc: 0.668 Test Loss: 4.069 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.710048198699951
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 8.354 Vali Acc: 0.712 Test Loss: 8.354 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4847609996795654
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 7.121 Vali Acc: 0.698 Test Loss: 7.121 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.465277910232544
Epoch: 11, Steps: 13 | Train Loss: 0.048 Vali Loss: 5.789 Vali Acc: 0.673 Test Loss: 5.789 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4608263969421387
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.488 Vali Acc: 0.634 Test Loss: 5.488 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.641388416290283
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.461 Vali Acc: 0.605 Test Loss: 5.461 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 549186
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9808013439178467
Epoch: 1, Steps: 13 | Train Loss: 0.804 Vali Loss: 0.997 Vali Acc: 0.366 Test Loss: 0.997 Test Acc: 0.366
Validation loss decreased (inf --> -0.365844).  Saving model ...
Epoch: 2 cost time: 1.842067003250122
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 1.171 Vali Acc: 0.459 Test Loss: 1.171 Test Acc: 0.459
Validation loss decreased (-0.365844 --> -0.458525).  Saving model ...
Epoch: 3 cost time: 1.9808125495910645
Epoch: 3, Steps: 13 | Train Loss: 0.349 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
Validation loss decreased (-0.458525 --> -0.541452).  Saving model ...
Epoch: 4 cost time: 2.1035659313201904
Epoch: 4, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.459 Vali Acc: 0.673 Test Loss: 1.459 Test Acc: 0.673
Validation loss decreased (-0.541452 --> -0.673156).  Saving model ...
Epoch: 5 cost time: 1.9763128757476807
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.790 Vali Acc: 0.624 Test Loss: 1.790 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9724643230438232
Epoch: 6, Steps: 13 | Train Loss: 0.042 Vali Loss: 2.236 Vali Acc: 0.629 Test Loss: 2.236 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.133786678314209
Epoch: 7, Steps: 13 | Train Loss: 0.014 Vali Loss: 2.746 Vali Acc: 0.522 Test Loss: 2.746 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.003269910812378
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.643 Vali Acc: 0.615 Test Loss: 2.643 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.007009506225586
Epoch: 9, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.989 Vali Acc: 0.673 Test Loss: 2.989 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1621170043945312
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.753 Vali Acc: 0.615 Test Loss: 2.753 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0762345790863037
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.605 Test Loss: 2.758 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9919283390045166
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.605 Test Loss: 2.758 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0197324752807617
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.754 Vali Acc: 0.605 Test Loss: 2.754 Test Acc: 0.605
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1574318408966064
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.752 Vali Acc: 0.605 Test Loss: 2.752 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6731707317073171
model parameter : 307778
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.740999460220337
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.670 Vali Acc: 0.605 Test Loss: 0.670 Test Acc: 0.605
Validation loss decreased (inf --> -0.604871).  Saving model ...
Epoch: 2 cost time: 2.022087812423706
Epoch: 2, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.838 Vali Acc: 0.663 Test Loss: 0.838 Test Acc: 0.663
Validation loss decreased (-0.604871 --> -0.663406).  Saving model ...
Epoch: 3 cost time: 2.0411055088043213
Epoch: 3, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.699 Vali Acc: 0.712 Test Loss: 1.699 Test Acc: 0.712
Validation loss decreased (-0.663406 --> -0.712178).  Saving model ...
Epoch: 4 cost time: 1.9561870098114014
Epoch: 4, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.243 Vali Acc: 0.629 Test Loss: 1.243 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3813724517822266
Epoch: 5, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.502 Vali Acc: 0.649 Test Loss: 1.502 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2130699157714844
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.852 Vali Acc: 0.659 Test Loss: 1.852 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.990980863571167
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.896 Vali Acc: 0.673 Test Loss: 1.896 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9892725944519043
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.036 Vali Acc: 0.634 Test Loss: 2.036 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1550750732421875
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.198 Vali Acc: 0.629 Test Loss: 2.198 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1662516593933105
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.352 Vali Acc: 0.649 Test Loss: 2.352 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.222776412963867
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.069 Vali Acc: 0.678 Test Loss: 3.069 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0892703533172607
Epoch: 12, Steps: 13 | Train Loss: 0.015 Vali Loss: 2.788 Vali Acc: 0.678 Test Loss: 2.788 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0732061862945557
Epoch: 13, Steps: 13 | Train Loss: 0.029 Vali Loss: 2.294 Vali Acc: 0.639 Test Loss: 2.294 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 222530
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.816702365875244
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.658 Vali Acc: 0.693 Test Loss: 0.658 Test Acc: 0.693
Validation loss decreased (inf --> -0.692676).  Saving model ...
Epoch: 2 cost time: 1.9778540134429932
Epoch: 2, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.778 Vali Acc: 0.649 Test Loss: 0.778 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7470035552978516
Epoch: 3, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.871 Vali Acc: 0.649 Test Loss: 0.871 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8551597595214844
Epoch: 4, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.081 Vali Acc: 0.634 Test Loss: 1.081 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7554194927215576
Epoch: 5, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.311 Vali Acc: 0.634 Test Loss: 1.311 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9402885437011719
Epoch: 6, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.415 Vali Acc: 0.624 Test Loss: 1.415 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9900157451629639
Epoch: 7, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.668 Test Loss: 1.621 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.837982177734375
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.562 Vali Acc: 0.654 Test Loss: 1.562 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8288280963897705
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.653 Vali Acc: 0.571 Test Loss: 1.653 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8829665184020996
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.663 Test Loss: 1.801 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.023305892944336
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.663 Test Loss: 1.722 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 176322
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4343435764312744
Epoch: 1, Steps: 13 | Train Loss: 0.690 Vali Loss: 0.615 Vali Acc: 0.712 Test Loss: 0.615 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.5231645107269287
Epoch: 2, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.689 Vali Acc: 0.634 Test Loss: 0.689 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.579700231552124
Epoch: 3, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.877 Vali Acc: 0.698 Test Loss: 0.877 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6561973094940186
Epoch: 4, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.982 Vali Acc: 0.649 Test Loss: 0.982 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.543086290359497
Epoch: 5, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.103 Vali Acc: 0.624 Test Loss: 1.103 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6835358142852783
Epoch: 6, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.207 Vali Acc: 0.629 Test Loss: 1.207 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5718998908996582
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.315 Vali Acc: 0.629 Test Loss: 1.315 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5671377182006836
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.409 Vali Acc: 0.620 Test Loss: 1.409 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6887741088867188
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.436 Vali Acc: 0.610 Test Loss: 1.436 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.559096336364746
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.473 Vali Acc: 0.610 Test Loss: 1.473 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5020225048065186
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.491 Vali Acc: 0.605 Test Loss: 1.491 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 130754
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0802462100982666
Epoch: 1, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.657 Vali Acc: 0.717 Test Loss: 0.657 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5436251163482666
Epoch: 2, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.703 Vali Acc: 0.580 Test Loss: 0.703 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.623964548110962
Epoch: 3, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.808 Vali Acc: 0.541 Test Loss: 0.808 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5320274829864502
Epoch: 4, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.873 Vali Acc: 0.585 Test Loss: 0.873 Test Acc: 0.585
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.445807933807373
Epoch: 5, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.049 Vali Acc: 0.663 Test Loss: 1.049 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.602525234222412
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.114 Vali Acc: 0.634 Test Loss: 1.114 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5035231113433838
Epoch: 7, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.241 Vali Acc: 0.663 Test Loss: 1.241 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5083355903625488
Epoch: 8, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.335 Vali Acc: 0.659 Test Loss: 1.335 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.625666856765747
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.357 Vali Acc: 0.595 Test Loss: 1.357 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5511360168457031
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.488 Vali Acc: 0.644 Test Loss: 1.488 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5670101642608643
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.456 Vali Acc: 0.644 Test Loss: 1.456 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 100802
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.192512273788452
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6032843589782715
Epoch: 2, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.775 Vali Acc: 0.522 Test Loss: 0.775 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5409877300262451
Epoch: 3, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.771 Vali Acc: 0.707 Test Loss: 0.771 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.366673469543457
Epoch: 4, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.839 Vali Acc: 0.688 Test Loss: 0.839 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4530000686645508
Epoch: 5, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.008 Vali Acc: 0.585 Test Loss: 1.008 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3664376735687256
Epoch: 6, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.158 Vali Acc: 0.663 Test Loss: 1.158 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5401930809020996
Epoch: 7, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.274 Vali Acc: 0.629 Test Loss: 1.274 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5399627685546875
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.341 Vali Acc: 0.620 Test Loss: 1.341 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.473339557647705
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.386 Vali Acc: 0.615 Test Loss: 1.386 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.564913034439087
Epoch: 10, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.414 Vali Acc: 0.615 Test Loss: 1.414 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.467698097229004
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.446 Vali Acc: 0.624 Test Loss: 1.446 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm64_nh16_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 86530
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9587976932525635
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.752 Vali Acc: 0.488 Test Loss: 0.752 Test Acc: 0.488
Validation loss decreased (inf --> -0.487797).  Saving model ...
Epoch: 2 cost time: 2.1990067958831787
Epoch: 2, Steps: 13 | Train Loss: 0.307 Vali Loss: 1.087 Vali Acc: 0.483 Test Loss: 1.087 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1400585174560547
Epoch: 3, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.140 Vali Acc: 0.688 Test Loss: 1.140 Test Acc: 0.688
Validation loss decreased (-0.487797 --> -0.687793).  Saving model ...
Epoch: 4 cost time: 2.1573379039764404
Epoch: 4, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.339 Vali Acc: 0.683 Test Loss: 1.339 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2939393520355225
Epoch: 5, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.409 Vali Acc: 0.605 Test Loss: 1.409 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.416437864303589
Epoch: 6, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.604 Vali Acc: 0.659 Test Loss: 1.604 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2317240238189697
Epoch: 7, Steps: 13 | Train Loss: 0.068 Vali Loss: 2.279 Vali Acc: 0.663 Test Loss: 2.279 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.254732847213745
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.162 Vali Acc: 0.634 Test Loss: 2.162 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.289996385574341
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.201 Vali Acc: 0.590 Test Loss: 2.201 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.184034585952759
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.360 Vali Acc: 0.649 Test Loss: 2.360 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2786576747894287
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.207 Vali Acc: 0.629 Test Loss: 2.207 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2753419876098633
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.624 Test Loss: 2.197 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4497103691101074
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.261 Vali Acc: 0.644 Test Loss: 2.261 Test Acc: 0.644
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 283010
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2144579887390137
Epoch: 1, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.809 Vali Acc: 0.478 Test Loss: 0.809 Test Acc: 0.478
Validation loss decreased (inf --> -0.478041).  Saving model ...
Epoch: 2 cost time: 1.7814345359802246
Epoch: 2, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.730 Vali Acc: 0.595 Test Loss: 0.730 Test Acc: 0.595
Validation loss decreased (-0.478041 --> -0.595115).  Saving model ...
Epoch: 3 cost time: 1.6650276184082031
Epoch: 3, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.911 Vali Acc: 0.629 Test Loss: 0.911 Test Acc: 0.629
Validation loss decreased (-0.595115 --> -0.629259).  Saving model ...
Epoch: 4 cost time: 1.5840990543365479
Epoch: 4, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.970 Vali Acc: 0.634 Test Loss: 0.970 Test Acc: 0.634
Validation loss decreased (-0.629259 --> -0.634137).  Saving model ...
Epoch: 5 cost time: 1.7091045379638672
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.147 Vali Acc: 0.639 Test Loss: 1.147 Test Acc: 0.639
Validation loss decreased (-0.634137 --> -0.639013).  Saving model ...
Epoch: 6 cost time: 1.7338950634002686
Epoch: 6, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.666 Vali Acc: 0.527 Test Loss: 1.666 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6446688175201416
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.084 Vali Acc: 0.459 Test Loss: 2.084 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6591746807098389
Epoch: 8, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.886 Vali Acc: 0.673 Test Loss: 1.886 Test Acc: 0.673
Validation loss decreased (-0.639013 --> -0.673152).  Saving model ...
Epoch: 9 cost time: 1.8913326263427734
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.251 Vali Acc: 0.688 Test Loss: 2.251 Test Acc: 0.688
Validation loss decreased (-0.673152 --> -0.687782).  Saving model ...
Epoch: 10 cost time: 1.6138091087341309
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.865 Vali Acc: 0.629 Test Loss: 1.865 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5700271129608154
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.910 Vali Acc: 0.639 Test Loss: 1.910 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7398059368133545
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.965 Vali Acc: 0.649 Test Loss: 1.965 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6943590641021729
Epoch: 13, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.644 Test Loss: 1.940 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.524928092956543
Epoch: 14, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.654 Test Loss: 1.933 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.920027256011963
Epoch: 15, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.649 Test Loss: 1.948 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8168728351593018
Epoch: 16, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.649 Test Loss: 1.967 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6622505187988281
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.649 Test Loss: 1.972 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6258010864257812
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.654 Test Loss: 1.956 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7921552658081055
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.654 Test Loss: 1.974 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6878048780487804
model parameter : 162306
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0834827423095703
Epoch: 1, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.834 Vali Acc: 0.410 Test Loss: 0.834 Test Acc: 0.410
Validation loss decreased (inf --> -0.409748).  Saving model ...
Epoch: 2 cost time: 1.2875816822052002
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.784 Vali Acc: 0.551 Test Loss: 0.784 Test Acc: 0.551
Validation loss decreased (-0.409748 --> -0.551212).  Saving model ...
Epoch: 3 cost time: 1.3566200733184814
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.977 Vali Acc: 0.702 Test Loss: 0.977 Test Acc: 0.702
Validation loss decreased (-0.551212 --> -0.702429).  Saving model ...
Epoch: 4 cost time: 1.3536643981933594
Epoch: 4, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.057 Vali Acc: 0.688 Test Loss: 1.057 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.277909278869629
Epoch: 5, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.167 Vali Acc: 0.683 Test Loss: 1.167 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3890132904052734
Epoch: 6, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.199 Vali Acc: 0.639 Test Loss: 1.199 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2224693298339844
Epoch: 7, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.397 Vali Acc: 0.620 Test Loss: 1.397 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4489154815673828
Epoch: 8, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.482 Vali Acc: 0.629 Test Loss: 1.482 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3726930618286133
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.488 Vali Acc: 0.629 Test Loss: 1.488 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.395932912826538
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.525 Vali Acc: 0.644 Test Loss: 1.525 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.388761281967163
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.555 Vali Acc: 0.644 Test Loss: 1.555 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2996551990509033
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.654 Test Loss: 1.600 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2746479511260986
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.654 Test Loss: 1.621 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 119682
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.876939535140991
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2969326972961426
Epoch: 2, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.675 Vali Acc: 0.668 Test Loss: 0.675 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4961938858032227
Epoch: 3, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.915 Vali Acc: 0.517 Test Loss: 0.915 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4002721309661865
Epoch: 4, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.825 Vali Acc: 0.634 Test Loss: 0.825 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4912021160125732
Epoch: 5, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.967 Vali Acc: 0.698 Test Loss: 0.967 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0306286811828613
Epoch: 6, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.048 Vali Acc: 0.620 Test Loss: 1.048 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.304917812347412
Epoch: 7, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1292073726654053
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.570 Vali Acc: 0.707 Test Loss: 1.570 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2083203792572021
Epoch: 9, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.396 Vali Acc: 0.620 Test Loss: 1.396 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2704808712005615
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.401 Vali Acc: 0.649 Test Loss: 1.401 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2431604862213135
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.528 Vali Acc: 0.659 Test Loss: 1.528 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 96578
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6692914962768555
Epoch: 1, Steps: 13 | Train Loss: 0.700 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.1150951385498047
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.657 Vali Acc: 0.698 Test Loss: 0.657 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.134286880493164
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.728 Vali Acc: 0.649 Test Loss: 0.728 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2284014225006104
Epoch: 4, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.806 Vali Acc: 0.649 Test Loss: 0.806 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3208365440368652
Epoch: 5, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.911 Vali Acc: 0.683 Test Loss: 0.911 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9861118793487549
Epoch: 6, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.072 Vali Acc: 0.673 Test Loss: 1.072 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1705634593963623
Epoch: 7, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.077 Vali Acc: 0.634 Test Loss: 1.077 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1754274368286133
Epoch: 8, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.178 Vali Acc: 0.615 Test Loss: 1.178 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1302459239959717
Epoch: 9, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.226 Vali Acc: 0.634 Test Loss: 1.226 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3024442195892334
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.276 Vali Acc: 0.663 Test Loss: 1.276 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1639351844787598
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.282 Vali Acc: 0.624 Test Loss: 1.282 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 73794
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8860933780670166
Epoch: 1, Steps: 13 | Train Loss: 0.693 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 0.9873051643371582
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.603 Vali Acc: 0.702 Test Loss: 0.603 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0100576877593994
Epoch: 3, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0434951782226562
Epoch: 4, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.696 Vali Acc: 0.639 Test Loss: 0.696 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.349747657775879
Epoch: 5, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.754 Vali Acc: 0.702 Test Loss: 0.754 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0138299465179443
Epoch: 6, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.786 Vali Acc: 0.688 Test Loss: 0.786 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1155526638031006
Epoch: 7, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.833 Vali Acc: 0.693 Test Loss: 0.833 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.154491662979126
Epoch: 8, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.903 Vali Acc: 0.668 Test Loss: 0.903 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1916594505310059
Epoch: 9, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.047 Vali Acc: 0.683 Test Loss: 1.047 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2337067127227783
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.071 Vali Acc: 0.668 Test Loss: 1.071 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1104457378387451
Epoch: 11, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.085 Vali Acc: 0.683 Test Loss: 1.085 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 58818
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1957004070281982
Epoch: 1, Steps: 13 | Train Loss: 0.694 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 1.2745387554168701
Epoch: 2, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.660 Vali Acc: 0.707 Test Loss: 0.660 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3424701690673828
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.699 Vali Acc: 0.639 Test Loss: 0.699 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4578161239624023
Epoch: 4, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.771 Vali Acc: 0.683 Test Loss: 0.771 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.427764654159546
Epoch: 5, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.827 Vali Acc: 0.620 Test Loss: 0.827 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2262492179870605
Epoch: 6, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.848 Vali Acc: 0.639 Test Loss: 0.848 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2042996883392334
Epoch: 7, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.916 Vali Acc: 0.634 Test Loss: 0.916 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2139666080474854
Epoch: 8, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.082 Vali Acc: 0.585 Test Loss: 1.082 Test Acc: 0.585
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3119404315948486
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.157 Vali Acc: 0.639 Test Loss: 1.157 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2799265384674072
Epoch: 10, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.231 Vali Acc: 0.595 Test Loss: 1.231 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1664776802062988
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.285 Vali Acc: 0.605 Test Loss: 1.285 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 51682
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.410567283630371
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.970 Vali Acc: 0.371 Test Loss: 0.970 Test Acc: 0.371
Validation loss decreased (inf --> -0.370722).  Saving model ...
Epoch: 2 cost time: 1.8935327529907227
Epoch: 2, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.990 Vali Acc: 0.707 Test Loss: 0.990 Test Acc: 0.707
Validation loss decreased (-0.370722 --> -0.707307).  Saving model ...
Epoch: 3 cost time: 2.0338551998138428
Epoch: 3, Steps: 13 | Train Loss: 0.272 Vali Loss: 1.214 Vali Acc: 0.707 Test Loss: 1.214 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.862062931060791
Epoch: 4, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.507 Vali Acc: 0.698 Test Loss: 1.507 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8986034393310547
Epoch: 5, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.629 Vali Acc: 0.654 Test Loss: 1.629 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7923386096954346
Epoch: 6, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.632 Vali Acc: 0.639 Test Loss: 1.632 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8861298561096191
Epoch: 7, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.998 Vali Acc: 0.663 Test Loss: 1.998 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9779913425445557
Epoch: 8, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.950 Vali Acc: 0.615 Test Loss: 1.950 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7771646976470947
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.031 Vali Acc: 0.649 Test Loss: 2.031 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.097402572631836
Epoch: 10, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.683 Test Loss: 2.220 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8691155910491943
Epoch: 11, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.620 Test Loss: 1.939 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9857428073883057
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.011 Vali Acc: 0.629 Test Loss: 2.011 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 274690
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1344053745269775
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.675 Vali Acc: 0.580 Test Loss: 0.675 Test Acc: 0.580
Validation loss decreased (inf --> -0.580481).  Saving model ...
Epoch: 2 cost time: 1.5223157405853271
Epoch: 2, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.732 Vali Acc: 0.605 Test Loss: 0.732 Test Acc: 0.605
Validation loss decreased (-0.580481 --> -0.604871).  Saving model ...
Epoch: 3 cost time: 1.5663657188415527
Epoch: 3, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.877 Vali Acc: 0.688 Test Loss: 0.877 Test Acc: 0.688
Validation loss decreased (-0.604871 --> -0.687796).  Saving model ...
Epoch: 4 cost time: 1.4493083953857422
Epoch: 4, Steps: 13 | Train Loss: 0.081 Vali Loss: 1.002 Vali Acc: 0.649 Test Loss: 1.002 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3632898330688477
Epoch: 5, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.238 Vali Acc: 0.693 Test Loss: 1.238 Test Acc: 0.693
Validation loss decreased (-0.687796 --> -0.692671).  Saving model ...
Epoch: 6 cost time: 1.3161876201629639
Epoch: 6, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.435 Vali Acc: 0.698 Test Loss: 1.435 Test Acc: 0.698
Validation loss decreased (-0.692671 --> -0.697547).  Saving model ...
Epoch: 7 cost time: 1.2864105701446533
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.452 Vali Acc: 0.649 Test Loss: 1.452 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2447288036346436
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.527 Vali Acc: 0.624 Test Loss: 1.527 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2806529998779297
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.564 Vali Acc: 0.683 Test Loss: 1.564 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.234327793121338
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.702 Test Loss: 1.625 Test Acc: 0.702
Validation loss decreased (-0.697547 --> -0.702423).  Saving model ...
Epoch: 11 cost time: 1.1485846042633057
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.673 Test Loss: 1.651 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2541279792785645
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.709 Vali Acc: 0.654 Test Loss: 1.709 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2254257202148438
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.869 Vali Acc: 0.629 Test Loss: 1.869 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1955127716064453
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.927 Vali Acc: 0.639 Test Loss: 1.927 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3757495880126953
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.649 Test Loss: 1.993 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.370023488998413
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.214 Vali Acc: 0.663 Test Loss: 2.214 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0543184280395508
Epoch: 17, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.074 Vali Acc: 0.644 Test Loss: 2.074 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4267823696136475
Epoch: 18, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.668 Test Loss: 2.234 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5404603481292725
Epoch: 19, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.663 Test Loss: 2.115 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3999073505401611
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.678 Test Loss: 2.081 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7024390243902439
model parameter : 153986
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9597887992858887
Epoch: 1, Steps: 13 | Train Loss: 0.717 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2306699752807617
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.676 Vali Acc: 0.698 Test Loss: 0.676 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.195519208908081
Epoch: 3, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.737 Vali Acc: 0.683 Test Loss: 0.737 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.255056619644165
Epoch: 4, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.912 Vali Acc: 0.678 Test Loss: 0.912 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4295151233673096
Epoch: 5, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.036 Vali Acc: 0.678 Test Loss: 1.036 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1704356670379639
Epoch: 6, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.166 Vali Acc: 0.678 Test Loss: 1.166 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3710379600524902
Epoch: 7, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.312 Vali Acc: 0.663 Test Loss: 1.312 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3512134552001953
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.334 Vali Acc: 0.663 Test Loss: 1.334 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2356586456298828
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.388 Vali Acc: 0.659 Test Loss: 1.388 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3763437271118164
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.663 Test Loss: 1.435 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.267563819885254
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.439 Vali Acc: 0.659 Test Loss: 1.439 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 111362
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.897150754928589
Epoch: 1, Steps: 13 | Train Loss: 0.682 Vali Loss: 0.756 Vali Acc: 0.722 Test Loss: 0.756 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.1136980056762695
Epoch: 2, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.224243402481079
Epoch: 3, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.727 Vali Acc: 0.683 Test Loss: 0.727 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3182387351989746
Epoch: 4, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.828 Vali Acc: 0.663 Test Loss: 0.828 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2555675506591797
Epoch: 5, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.956 Vali Acc: 0.615 Test Loss: 0.956 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2037672996520996
Epoch: 6, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.104 Vali Acc: 0.620 Test Loss: 1.104 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1636161804199219
Epoch: 7, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.229 Vali Acc: 0.605 Test Loss: 1.229 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2641851902008057
Epoch: 8, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.299 Vali Acc: 0.639 Test Loss: 1.299 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1035687923431396
Epoch: 9, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.333 Vali Acc: 0.639 Test Loss: 1.333 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.144157886505127
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.319 Vali Acc: 0.639 Test Loss: 1.319 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.193629264831543
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.357 Vali Acc: 0.639 Test Loss: 1.357 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 88258
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.591397285461426
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 0.9907190799713135
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.651 Vali Acc: 0.673 Test Loss: 0.651 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1080288887023926
Epoch: 3, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.695 Vali Acc: 0.707 Test Loss: 0.695 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1450669765472412
Epoch: 4, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.806 Vali Acc: 0.683 Test Loss: 0.806 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.076573371887207
Epoch: 5, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.893 Vali Acc: 0.605 Test Loss: 0.893 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1215424537658691
Epoch: 6, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.984 Vali Acc: 0.615 Test Loss: 0.984 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0912361145019531
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.038 Vali Acc: 0.663 Test Loss: 1.038 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.103318452835083
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.150 Vali Acc: 0.673 Test Loss: 1.150 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.053638219833374
Epoch: 9, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.221 Vali Acc: 0.639 Test Loss: 1.221 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1188538074493408
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.281 Vali Acc: 0.649 Test Loss: 1.281 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0611860752105713
Epoch: 11, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.317 Vali Acc: 0.629 Test Loss: 1.317 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 65474
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8777167797088623
Epoch: 1, Steps: 13 | Train Loss: 0.673 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.2666215896606445
Epoch: 2, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.640 Vali Acc: 0.688 Test Loss: 0.640 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2421200275421143
Epoch: 3, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.696 Vali Acc: 0.698 Test Loss: 0.696 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.142965316772461
Epoch: 4, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.744 Vali Acc: 0.678 Test Loss: 0.744 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2178151607513428
Epoch: 5, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.785 Vali Acc: 0.688 Test Loss: 0.785 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1526150703430176
Epoch: 6, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.893 Vali Acc: 0.688 Test Loss: 0.893 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0522196292877197
Epoch: 7, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.946 Vali Acc: 0.663 Test Loss: 0.946 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.111562967300415
Epoch: 8, Steps: 13 | Train Loss: 0.039 Vali Loss: 0.999 Vali Acc: 0.683 Test Loss: 0.999 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2101798057556152
Epoch: 9, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.133 Vali Acc: 0.683 Test Loss: 1.133 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1215848922729492
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.121 Vali Acc: 0.639 Test Loss: 1.121 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1434640884399414
Epoch: 11, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.194 Vali Acc: 0.659 Test Loss: 1.194 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 50498
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6930174827575684
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.629 Vali Acc: 0.712 Test Loss: 0.629 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.243185043334961
Epoch: 2, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.635 Vali Acc: 0.702 Test Loss: 0.635 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2759406566619873
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.652 Vali Acc: 0.693 Test Loss: 0.652 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.309936285018921
Epoch: 4, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.710 Vali Acc: 0.693 Test Loss: 0.710 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.245304822921753
Epoch: 5, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.758 Vali Acc: 0.673 Test Loss: 0.758 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.287546157836914
Epoch: 6, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.844 Vali Acc: 0.654 Test Loss: 0.844 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3974218368530273
Epoch: 7, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.965 Vali Acc: 0.624 Test Loss: 0.965 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3316011428833008
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.050 Vali Acc: 0.654 Test Loss: 1.050 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2684080600738525
Epoch: 9, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.117 Vali Acc: 0.629 Test Loss: 1.117 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4256603717803955
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.193 Vali Acc: 0.629 Test Loss: 1.193 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3875353336334229
Epoch: 11, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.255 Vali Acc: 0.620 Test Loss: 1.255 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 43362
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4281082153320312
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.645 Vali Acc: 0.693 Test Loss: 0.645 Test Acc: 0.693
Validation loss decreased (inf --> -0.692676).  Saving model ...
Epoch: 2 cost time: 1.821192741394043
Epoch: 2, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7705583572387695
Epoch: 3, Steps: 13 | Train Loss: 0.088 Vali Loss: 1.039 Vali Acc: 0.585 Test Loss: 1.039 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.820206880569458
Epoch: 4, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.242 Vali Acc: 0.605 Test Loss: 1.242 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8020110130310059
Epoch: 5, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.695 Vali Acc: 0.673 Test Loss: 1.695 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.893772840499878
Epoch: 6, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.588 Vali Acc: 0.634 Test Loss: 1.588 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.771064043045044
Epoch: 7, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.673 Test Loss: 1.750 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5536890029907227
Epoch: 8, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.895 Vali Acc: 0.576 Test Loss: 1.895 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.834855556488037
Epoch: 9, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.923 Vali Acc: 0.590 Test Loss: 1.923 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9443869590759277
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.162 Vali Acc: 0.663 Test Loss: 2.162 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.7527563571929932
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.339 Vali Acc: 0.615 Test Loss: 2.339 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.6926829268292682
model parameter : 270530
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1402640342712402
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.679 Vali Acc: 0.707 Test Loss: 0.679 Test Acc: 0.707
Validation loss decreased (inf --> -0.707310).  Saving model ...
Epoch: 2 cost time: 1.456921100616455
Epoch: 2, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
Validation loss decreased (-0.707310 --> -0.717065).  Saving model ...
Epoch: 3 cost time: 1.5409862995147705
Epoch: 3, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.894 Vali Acc: 0.590 Test Loss: 0.894 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.458554744720459
Epoch: 4, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.051 Vali Acc: 0.668 Test Loss: 1.051 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4841184616088867
Epoch: 5, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.363 Vali Acc: 0.678 Test Loss: 1.363 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.57965087890625
Epoch: 6, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.472 Vali Acc: 0.668 Test Loss: 1.472 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5297775268554688
Epoch: 7, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.566 Vali Acc: 0.673 Test Loss: 1.566 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4957993030548096
Epoch: 8, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.631 Vali Acc: 0.654 Test Loss: 1.631 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5029637813568115
Epoch: 9, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.668 Test Loss: 1.669 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4793577194213867
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.663 Test Loss: 1.674 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4161427021026611
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.659 Test Loss: 1.705 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4028856754302979
Epoch: 12, Steps: 13 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.649 Test Loss: 1.708 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 149826
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1706955432891846
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.632 Vali Acc: 0.688 Test Loss: 0.632 Test Acc: 0.688
Validation loss decreased (inf --> -0.687799).  Saving model ...
Epoch: 2 cost time: 1.2739052772521973
Epoch: 2, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.741 Vali Acc: 0.702 Test Loss: 0.741 Test Acc: 0.702
Validation loss decreased (-0.687799 --> -0.702432).  Saving model ...
Epoch: 3 cost time: 1.348038673400879
Epoch: 3, Steps: 13 | Train Loss: 0.276 Vali Loss: 1.090 Vali Acc: 0.712 Test Loss: 1.090 Test Acc: 0.712
Validation loss decreased (-0.702432 --> -0.712184).  Saving model ...
Epoch: 4 cost time: 1.3866980075836182
Epoch: 4, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.052 Vali Acc: 0.678 Test Loss: 1.052 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4780480861663818
Epoch: 5, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.075 Vali Acc: 0.654 Test Loss: 1.075 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4642126560211182
Epoch: 6, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.166 Vali Acc: 0.639 Test Loss: 1.166 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4098470211029053
Epoch: 7, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.328 Vali Acc: 0.600 Test Loss: 1.328 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4034531116485596
Epoch: 8, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.430 Vali Acc: 0.673 Test Loss: 1.430 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.315427541732788
Epoch: 9, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.439 Vali Acc: 0.624 Test Loss: 1.439 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.412961483001709
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.475 Vali Acc: 0.634 Test Loss: 1.475 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6547112464904785
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.519 Vali Acc: 0.654 Test Loss: 1.519 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.376955270767212
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.649 Test Loss: 1.537 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3712975978851318
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.654 Test Loss: 1.569 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 107202
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.56777024269104
Epoch: 1, Steps: 13 | Train Loss: 0.668 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.345095157623291
Epoch: 2, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.657 Vali Acc: 0.683 Test Loss: 0.657 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.038360595703125
Epoch: 3, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.731 Vali Acc: 0.688 Test Loss: 0.731 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.270949125289917
Epoch: 4, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.807 Vali Acc: 0.639 Test Loss: 0.807 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.111910104751587
Epoch: 5, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.069 Vali Acc: 0.546 Test Loss: 1.069 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0577380657196045
Epoch: 6, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.183 Vali Acc: 0.566 Test Loss: 1.183 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1615195274353027
Epoch: 7, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.190 Vali Acc: 0.668 Test Loss: 1.190 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2353155612945557
Epoch: 8, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.204 Vali Acc: 0.668 Test Loss: 1.204 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2962043285369873
Epoch: 9, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.234 Vali Acc: 0.649 Test Loss: 1.234 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2127604484558105
Epoch: 10, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.668 Test Loss: 1.293 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1923801898956299
Epoch: 11, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.336 Vali Acc: 0.668 Test Loss: 1.336 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 84098
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.799422025680542
Epoch: 1, Steps: 13 | Train Loss: 0.684 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.189023494720459
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.672 Vali Acc: 0.605 Test Loss: 0.672 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0709590911865234
Epoch: 3, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.695 Vali Acc: 0.673 Test Loss: 0.695 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0685644149780273
Epoch: 4, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.744 Vali Acc: 0.678 Test Loss: 0.744 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.133835792541504
Epoch: 5, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.825 Vali Acc: 0.634 Test Loss: 0.825 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2002675533294678
Epoch: 6, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.957 Vali Acc: 0.615 Test Loss: 0.957 Test Acc: 0.615
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1880745887756348
Epoch: 7, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.103 Vali Acc: 0.683 Test Loss: 1.103 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.152886152267456
Epoch: 8, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1191635131835938
Epoch: 9, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.135545253753662
Epoch: 10, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.227 Vali Acc: 0.620 Test Loss: 1.227 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0351996421813965
Epoch: 11, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.264 Vali Acc: 0.605 Test Loss: 1.264 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 61314
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8494319915771484
Epoch: 1, Steps: 13 | Train Loss: 0.710 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.158263921737671
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.616 Vali Acc: 0.683 Test Loss: 0.616 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2841379642486572
Epoch: 3, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.653 Vali Acc: 0.654 Test Loss: 0.653 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0769474506378174
Epoch: 4, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.700 Vali Acc: 0.649 Test Loss: 0.700 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.240523099899292
Epoch: 5, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.738 Vali Acc: 0.673 Test Loss: 0.738 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1629407405853271
Epoch: 6, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.815 Vali Acc: 0.654 Test Loss: 0.815 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0497534275054932
Epoch: 7, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.867 Vali Acc: 0.663 Test Loss: 0.867 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1104402542114258
Epoch: 8, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.936 Vali Acc: 0.639 Test Loss: 0.936 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1207678318023682
Epoch: 9, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.012 Vali Acc: 0.649 Test Loss: 1.012 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2073984146118164
Epoch: 10, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.085 Vali Acc: 0.654 Test Loss: 1.085 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1316325664520264
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.110 Vali Acc: 0.649 Test Loss: 1.110 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 46338
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8301925659179688
Epoch: 1, Steps: 13 | Train Loss: 0.733 Vali Loss: 0.604 Vali Acc: 0.707 Test Loss: 0.604 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 0.9842782020568848
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.618 Vali Acc: 0.693 Test Loss: 0.618 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1340205669403076
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.646 Vali Acc: 0.654 Test Loss: 0.646 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.050422191619873
Epoch: 4, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.683 Vali Acc: 0.659 Test Loss: 0.683 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9472525119781494
Epoch: 5, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.758 Vali Acc: 0.649 Test Loss: 0.758 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0087637901306152
Epoch: 6, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.850 Vali Acc: 0.600 Test Loss: 0.850 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1865308284759521
Epoch: 7, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.901 Vali Acc: 0.639 Test Loss: 0.901 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1682548522949219
Epoch: 8, Steps: 13 | Train Loss: 0.053 Vali Loss: 0.995 Vali Acc: 0.605 Test Loss: 0.995 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1089441776275635
Epoch: 9, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.047 Vali Acc: 0.639 Test Loss: 1.047 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9949705600738525
Epoch: 10, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.133 Vali Acc: 0.610 Test Loss: 1.133 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9621026515960693
Epoch: 11, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.184 Vali Acc: 0.620 Test Loss: 1.184 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm32_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 39202
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4635517597198486
Epoch: 1, Steps: 13 | Train Loss: 0.691 Vali Loss: 0.856 Vali Acc: 0.351 Test Loss: 0.856 Test Acc: 0.351
Validation loss decreased (inf --> -0.351211).  Saving model ...
Epoch: 2 cost time: 1.7718398571014404
Epoch: 2, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
Validation loss decreased (-0.351211 --> -0.717066).  Saving model ...
Epoch: 3 cost time: 1.8106186389923096
Epoch: 3, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.683 Vali Acc: 0.659 Test Loss: 0.683 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.747617244720459
Epoch: 4, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7856392860412598
Epoch: 5, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.145 Vali Acc: 0.707 Test Loss: 1.145 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6874961853027344
Epoch: 6, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.122 Vali Acc: 0.683 Test Loss: 1.122 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7966609001159668
Epoch: 7, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.125 Vali Acc: 0.659 Test Loss: 1.125 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8376827239990234
Epoch: 8, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.204 Vali Acc: 0.659 Test Loss: 1.204 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7799577713012695
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.261 Vali Acc: 0.673 Test Loss: 1.261 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6724157333374023
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.435 Vali Acc: 0.678 Test Loss: 1.435 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.810744285583496
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.380 Vali Acc: 0.673 Test Loss: 1.380 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6858081817626953
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.673 Test Loss: 1.413 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 140610
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0243420600891113
Epoch: 1, Steps: 13 | Train Loss: 0.772 Vali Loss: 0.588 Vali Acc: 0.688 Test Loss: 0.588 Test Acc: 0.688
Validation loss decreased (inf --> -0.687799).  Saving model ...
Epoch: 2 cost time: 1.3936553001403809
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (-0.687799 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.386122703552246
Epoch: 3, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.806 Vali Acc: 0.727 Test Loss: 0.806 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726821).  Saving model ...
Epoch: 4 cost time: 1.3981125354766846
Epoch: 4, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.878 Vali Acc: 0.732 Test Loss: 0.878 Test Acc: 0.732
Validation loss decreased (-0.726821 --> -0.731699).  Saving model ...
Epoch: 5 cost time: 1.282287359237671
Epoch: 5, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.868 Vali Acc: 0.717 Test Loss: 0.868 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3885040283203125
Epoch: 6, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.832 Vali Acc: 0.678 Test Loss: 0.832 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2760109901428223
Epoch: 7, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.014 Vali Acc: 0.702 Test Loss: 1.014 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3914341926574707
Epoch: 8, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.120 Vali Acc: 0.702 Test Loss: 1.120 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.397538661956787
Epoch: 9, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.178 Vali Acc: 0.688 Test Loss: 1.178 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.435300588607788
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.095 Vali Acc: 0.659 Test Loss: 1.095 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4405162334442139
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.219 Vali Acc: 0.688 Test Loss: 1.219 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4077725410461426
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.201 Vali Acc: 0.663 Test Loss: 1.201 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3001792430877686
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.201 Vali Acc: 0.668 Test Loss: 1.201 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3326261043548584
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.236 Vali Acc: 0.668 Test Loss: 1.236 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 80258
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8924291133880615
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.607 Vali Acc: 0.698 Test Loss: 0.607 Test Acc: 0.698
Validation loss decreased (inf --> -0.697555).  Saving model ...
Epoch: 2 cost time: 1.225085735321045
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.630 Vali Acc: 0.707 Test Loss: 0.630 Test Acc: 0.707
Validation loss decreased (-0.697555 --> -0.707311).  Saving model ...
Epoch: 3 cost time: 1.180476427078247
Epoch: 3, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.662 Vali Acc: 0.688 Test Loss: 0.662 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2744998931884766
Epoch: 4, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.730 Vali Acc: 0.707 Test Loss: 0.730 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2546687126159668
Epoch: 5, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.797 Vali Acc: 0.693 Test Loss: 0.797 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2467925548553467
Epoch: 6, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.912 Vali Acc: 0.702 Test Loss: 0.912 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2318730354309082
Epoch: 7, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.967 Vali Acc: 0.688 Test Loss: 0.967 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2884876728057861
Epoch: 8, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.030 Vali Acc: 0.639 Test Loss: 1.030 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2798101902008057
Epoch: 9, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2674717903137207
Epoch: 10, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.121 Vali Acc: 0.624 Test Loss: 1.121 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2299952507019043
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.231 Vali Acc: 0.693 Test Loss: 1.231 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2428429126739502
Epoch: 12, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.241 Vali Acc: 0.688 Test Loss: 1.241 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 58946
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0016491413116455
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.2254621982574463
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.632 Vali Acc: 0.698 Test Loss: 0.632 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3006422519683838
Epoch: 3, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1360809803009033
Epoch: 4, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.707 Vali Acc: 0.624 Test Loss: 0.707 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2730624675750732
Epoch: 5, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.745 Vali Acc: 0.663 Test Loss: 0.745 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2121963500976562
Epoch: 6, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.774 Vali Acc: 0.717 Test Loss: 0.774 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1383802890777588
Epoch: 7, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.846 Vali Acc: 0.688 Test Loss: 0.846 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2200889587402344
Epoch: 8, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.905 Vali Acc: 0.615 Test Loss: 0.905 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1554701328277588
Epoch: 9, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.961 Vali Acc: 0.629 Test Loss: 0.961 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1566128730773926
Epoch: 10, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.048 Vali Acc: 0.683 Test Loss: 1.048 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1862199306488037
Epoch: 11, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.071 Vali Acc: 0.668 Test Loss: 1.071 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 47394
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8786373138427734
Epoch: 1, Steps: 13 | Train Loss: 0.751 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0968456268310547
Epoch: 2, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.659 Vali Acc: 0.673 Test Loss: 0.659 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0792105197906494
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.683 Vali Acc: 0.663 Test Loss: 0.683 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1119859218597412
Epoch: 4, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.707 Vali Acc: 0.688 Test Loss: 0.707 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1888296604156494
Epoch: 5, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.786 Vali Acc: 0.585 Test Loss: 0.786 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0700981616973877
Epoch: 6, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.827 Vali Acc: 0.571 Test Loss: 0.827 Test Acc: 0.571
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.089782953262329
Epoch: 7, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.865 Vali Acc: 0.649 Test Loss: 0.865 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.15621018409729
Epoch: 8, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.950 Vali Acc: 0.659 Test Loss: 0.950 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0518629550933838
Epoch: 9, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.001 Vali Acc: 0.605 Test Loss: 1.001 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1034519672393799
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.056 Vali Acc: 0.639 Test Loss: 1.056 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0988099575042725
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.111 Vali Acc: 0.620 Test Loss: 1.111 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 36002
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.9558000564575195
Epoch: 1, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.127737283706665
Epoch: 2, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1119909286499023
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.623 Vali Acc: 0.693 Test Loss: 0.623 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0722391605377197
Epoch: 4, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.642 Vali Acc: 0.683 Test Loss: 0.642 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1792171001434326
Epoch: 5, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.672 Vali Acc: 0.693 Test Loss: 0.672 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0469558238983154
Epoch: 6, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.699 Vali Acc: 0.702 Test Loss: 0.699 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1733551025390625
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.737 Vali Acc: 0.688 Test Loss: 0.737 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1160099506378174
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.773 Vali Acc: 0.693 Test Loss: 0.773 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.046964168548584
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.829 Vali Acc: 0.698 Test Loss: 0.829 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0965850353240967
Epoch: 10, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.863 Vali Acc: 0.693 Test Loss: 0.863 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0547807216644287
Epoch: 11, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.938 Vali Acc: 0.654 Test Loss: 0.938 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 28514
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.606293201446533
Epoch: 1, Steps: 13 | Train Loss: 0.724 Vali Loss: 0.669 Vali Acc: 0.629 Test Loss: 0.669 Test Acc: 0.629
Validation loss decreased (inf --> -0.629262).  Saving model ...
Epoch: 2 cost time: 0.9007647037506104
Epoch: 2, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.650 Vali Acc: 0.712 Test Loss: 0.650 Test Acc: 0.712
Validation loss decreased (-0.629262 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 0.904778242111206
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.647 Vali Acc: 0.678 Test Loss: 0.647 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9828805923461914
Epoch: 4, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.657 Vali Acc: 0.702 Test Loss: 0.657 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9685237407684326
Epoch: 5, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.682 Vali Acc: 0.678 Test Loss: 0.682 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9273049831390381
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.712 Vali Acc: 0.644 Test Loss: 0.712 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9532005786895752
Epoch: 7, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.753 Vali Acc: 0.634 Test Loss: 0.753 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.949012041091919
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.812 Vali Acc: 0.620 Test Loss: 0.812 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9724774360656738
Epoch: 9, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.888 Vali Acc: 0.590 Test Loss: 0.888 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8995890617370605
Epoch: 10, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.916 Vali Acc: 0.629 Test Loss: 0.916 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9602158069610596
Epoch: 11, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.006 Vali Acc: 0.576 Test Loss: 1.006 Test Acc: 0.576
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9137258529663086
Epoch: 12, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.032 Vali Acc: 0.624 Test Loss: 1.032 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df256_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 24946
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3602819442749023
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.676806926727295
Epoch: 2, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.695 Vali Acc: 0.600 Test Loss: 0.695 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6675169467926025
Epoch: 3, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.742 Vali Acc: 0.707 Test Loss: 0.742 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6820642948150635
Epoch: 4, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.251 Vali Acc: 0.717 Test Loss: 1.251 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7589402198791504
Epoch: 5, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.110 Vali Acc: 0.707 Test Loss: 1.110 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7937753200531006
Epoch: 6, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7004199028015137
Epoch: 7, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.158 Vali Acc: 0.605 Test Loss: 1.158 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6524381637573242
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.439 Vali Acc: 0.688 Test Loss: 1.439 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.7855546474456787
Epoch: 9, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.425 Vali Acc: 0.668 Test Loss: 1.425 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.674163818359375
Epoch: 10, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.606 Vali Acc: 0.688 Test Loss: 1.606 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6952314376831055
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.634 Test Loss: 1.508 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 136386
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1198694705963135
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.252394437789917
Epoch: 2, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.601 Vali Acc: 0.668 Test Loss: 0.601 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.373213291168213
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.760 Vali Acc: 0.566 Test Loss: 0.760 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.35524320602417
Epoch: 4, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.685 Vali Acc: 0.649 Test Loss: 0.685 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2339348793029785
Epoch: 5, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.798 Vali Acc: 0.605 Test Loss: 0.798 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3325676918029785
Epoch: 6, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.823 Vali Acc: 0.707 Test Loss: 0.823 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2323312759399414
Epoch: 7, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.018 Vali Acc: 0.732 Test Loss: 1.018 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731697).  Saving model ...
Epoch: 8 cost time: 1.2892942428588867
Epoch: 8, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.032 Vali Acc: 0.678 Test Loss: 1.032 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3211665153503418
Epoch: 9, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.056 Vali Acc: 0.659 Test Loss: 1.056 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.29819655418396
Epoch: 10, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.082 Vali Acc: 0.683 Test Loss: 1.082 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2191412448883057
Epoch: 11, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.080 Vali Acc: 0.663 Test Loss: 1.080 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.43339204788208
Epoch: 12, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.107 Vali Acc: 0.673 Test Loss: 1.107 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4359056949615479
Epoch: 13, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.158 Vali Acc: 0.698 Test Loss: 1.158 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3921115398406982
Epoch: 14, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.152 Vali Acc: 0.673 Test Loss: 1.152 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.202728271484375
Epoch: 15, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.702 Test Loss: 1.202 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2981064319610596
Epoch: 16, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.183 Vali Acc: 0.673 Test Loss: 1.183 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.313427209854126
Epoch: 17, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.230 Vali Acc: 0.698 Test Loss: 1.230 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 76034
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0477521419525146
Epoch: 1, Steps: 13 | Train Loss: 0.737 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.121192216873169
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.704 Vali Acc: 0.712 Test Loss: 0.704 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.15708589553833
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.694 Vali Acc: 0.620 Test Loss: 0.694 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0961449146270752
Epoch: 4, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.755 Vali Acc: 0.620 Test Loss: 0.755 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.09749174118042
Epoch: 5, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.800 Vali Acc: 0.634 Test Loss: 0.800 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.161923885345459
Epoch: 6, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.881 Vali Acc: 0.600 Test Loss: 0.881 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.06754469871521
Epoch: 7, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.950 Vali Acc: 0.688 Test Loss: 0.950 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1321632862091064
Epoch: 8, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.004 Vali Acc: 0.693 Test Loss: 1.004 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0919272899627686
Epoch: 9, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.066 Vali Acc: 0.663 Test Loss: 1.066 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0267608165740967
Epoch: 10, Steps: 13 | Train Loss: 0.010 Vali Loss: 1.129 Vali Acc: 0.683 Test Loss: 1.129 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0176060199737549
Epoch: 11, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.201 Vali Acc: 0.698 Test Loss: 1.201 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 54722
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.6426146030426025
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.651 Vali Acc: 0.722 Test Loss: 0.651 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0581820011138916
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3035385608673096
Epoch: 3, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.627 Vali Acc: 0.673 Test Loss: 0.627 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0865414142608643
Epoch: 4, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.663 Vali Acc: 0.698 Test Loss: 0.663 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0400030612945557
Epoch: 5, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.736 Vali Acc: 0.654 Test Loss: 0.736 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0258126258850098
Epoch: 6, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.796 Vali Acc: 0.644 Test Loss: 0.796 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9306120872497559
Epoch: 7, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.861 Vali Acc: 0.600 Test Loss: 0.861 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1044695377349854
Epoch: 8, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.927 Vali Acc: 0.678 Test Loss: 0.927 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.173020601272583
Epoch: 9, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.009 Vali Acc: 0.683 Test Loss: 1.009 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2013726234436035
Epoch: 10, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.102 Vali Acc: 0.707 Test Loss: 1.102 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.1297376155853271
Epoch: 11, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.098 Vali Acc: 0.707 Test Loss: 1.098 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 43170
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8778276443481445
Epoch: 1, Steps: 13 | Train Loss: 0.736 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.196599006652832
Epoch: 2, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.017341136932373
Epoch: 3, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.652 Vali Acc: 0.659 Test Loss: 0.652 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0998117923736572
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.673 Vali Acc: 0.688 Test Loss: 0.673 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.042177438735962
Epoch: 5, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.724 Vali Acc: 0.698 Test Loss: 0.724 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9980337619781494
Epoch: 6, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.838 Vali Acc: 0.566 Test Loss: 0.838 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.874565601348877
Epoch: 7, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1678829193115234
Epoch: 8, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.907 Vali Acc: 0.605 Test Loss: 0.907 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1619865894317627
Epoch: 9, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.949 Vali Acc: 0.624 Test Loss: 0.949 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9075510501861572
Epoch: 10, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.006 Vali Acc: 0.654 Test Loss: 1.006 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1045711040496826
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1515917778015137
Epoch: 12, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.105 Vali Acc: 0.639 Test Loss: 1.105 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 31778
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8693041801452637
Epoch: 1, Steps: 13 | Train Loss: 0.789 Vali Loss: 0.664 Vali Acc: 0.629 Test Loss: 0.664 Test Acc: 0.629
Validation loss decreased (inf --> -0.629262).  Saving model ...
Epoch: 2 cost time: 1.1489546298980713
Epoch: 2, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.673 Vali Acc: 0.698 Test Loss: 0.673 Test Acc: 0.698
Validation loss decreased (-0.629262 --> -0.697554).  Saving model ...
Epoch: 3 cost time: 1.041330099105835
Epoch: 3, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.682 Vali Acc: 0.629 Test Loss: 0.682 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9418454170227051
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.687 Vali Acc: 0.649 Test Loss: 0.687 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1223602294921875
Epoch: 5, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.712 Vali Acc: 0.649 Test Loss: 0.712 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9722797870635986
Epoch: 6, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.741 Vali Acc: 0.644 Test Loss: 0.741 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9052519798278809
Epoch: 7, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.779 Vali Acc: 0.644 Test Loss: 0.779 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0005488395690918
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.826 Vali Acc: 0.663 Test Loss: 0.826 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0289883613586426
Epoch: 9, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.864 Vali Acc: 0.668 Test Loss: 0.864 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1266777515411377
Epoch: 10, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.904 Vali Acc: 0.629 Test Loss: 0.904 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0285353660583496
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 0.941 Vali Acc: 0.644 Test Loss: 0.941 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.085578203201294
Epoch: 12, Steps: 13 | Train Loss: 0.036 Vali Loss: 0.978 Vali Acc: 0.668 Test Loss: 0.978 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 24290
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.7052571773529053
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.636 Vali Acc: 0.702 Test Loss: 0.636 Test Acc: 0.702
Validation loss decreased (inf --> -0.702433).  Saving model ...
Epoch: 2 cost time: 0.9667527675628662
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.639 Vali Acc: 0.707 Test Loss: 0.639 Test Acc: 0.707
Validation loss decreased (-0.702433 --> -0.707311).  Saving model ...
Epoch: 3 cost time: 0.8797800540924072
Epoch: 3, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.626 Vali Acc: 0.693 Test Loss: 0.626 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9791903495788574
Epoch: 4, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.639 Vali Acc: 0.673 Test Loss: 0.639 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7998025417327881
Epoch: 5, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.657 Vali Acc: 0.654 Test Loss: 0.657 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8951084613800049
Epoch: 6, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.681 Vali Acc: 0.649 Test Loss: 0.681 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9527442455291748
Epoch: 7, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.717 Vali Acc: 0.659 Test Loss: 0.717 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.908447265625
Epoch: 8, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.785 Vali Acc: 0.615 Test Loss: 0.785 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9891500473022461
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.825 Vali Acc: 0.644 Test Loss: 0.825 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9424035549163818
Epoch: 10, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.903 Vali Acc: 0.566 Test Loss: 0.903 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9550726413726807
Epoch: 11, Steps: 13 | Train Loss: 0.080 Vali Loss: 0.943 Vali Acc: 0.639 Test Loss: 0.943 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8572702407836914
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.023 Vali Acc: 0.571 Test Loss: 1.023 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df128_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7073170731707317
model parameter : 20722
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4586191177368164
Epoch: 1, Steps: 13 | Train Loss: 0.692 Vali Loss: 1.213 Vali Acc: 0.288 Test Loss: 1.213 Test Acc: 0.288
Validation loss decreased (inf --> -0.287793).  Saving model ...
Epoch: 2 cost time: 1.5881779193878174
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.738 Vali Acc: 0.561 Test Loss: 0.738 Test Acc: 0.561
Validation loss decreased (-0.287793 --> -0.560968).  Saving model ...
Epoch: 3 cost time: 1.7323126792907715
Epoch: 3, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.696 Vali Acc: 0.698 Test Loss: 0.696 Test Acc: 0.698
Validation loss decreased (-0.560968 --> -0.697554).  Saving model ...
Epoch: 4 cost time: 1.7515084743499756
Epoch: 4, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.795 Vali Acc: 0.629 Test Loss: 0.795 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.794386863708496
Epoch: 5, Steps: 13 | Train Loss: 0.071 Vali Loss: 1.573 Vali Acc: 0.717 Test Loss: 1.573 Test Acc: 0.717
Validation loss decreased (-0.697554 --> -0.717057).  Saving model ...
Epoch: 6 cost time: 1.8012313842773438
Epoch: 6, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.042 Vali Acc: 0.639 Test Loss: 1.042 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5766112804412842
Epoch: 7, Steps: 13 | Train Loss: 0.034 Vali Loss: 1.176 Vali Acc: 0.654 Test Loss: 1.176 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6308181285858154
Epoch: 8, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.246 Vali Acc: 0.654 Test Loss: 1.246 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0092992782592773
Epoch: 9, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.297 Vali Acc: 0.654 Test Loss: 1.297 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8218767642974854
Epoch: 10, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.293 Vali Acc: 0.673 Test Loss: 1.293 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6371309757232666
Epoch: 11, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.306 Vali Acc: 0.668 Test Loss: 1.306 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7205607891082764
Epoch: 12, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.654 Test Loss: 1.390 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0571413040161133
Epoch: 13, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.340 Vali Acc: 0.668 Test Loss: 1.340 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9942448139190674
Epoch: 14, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.369 Vali Acc: 0.663 Test Loss: 1.369 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8248546123504639
Epoch: 15, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.395 Vali Acc: 0.659 Test Loss: 1.395 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7170731707317073
model parameter : 134274
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0756983757019043
Epoch: 1, Steps: 13 | Train Loss: 0.697 Vali Loss: 0.652 Vali Acc: 0.722 Test Loss: 0.652 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6804533004760742
Epoch: 2, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.652 Vali Acc: 0.620 Test Loss: 0.652 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6283657550811768
Epoch: 3, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.660 Vali Acc: 0.649 Test Loss: 0.660 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3725335597991943
Epoch: 4, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.722 Vali Acc: 0.644 Test Loss: 0.722 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5523664951324463
Epoch: 5, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.796 Vali Acc: 0.654 Test Loss: 0.796 Test Acc: 0.654
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5715928077697754
Epoch: 6, Steps: 13 | Train Loss: 0.047 Vali Loss: 0.899 Vali Acc: 0.595 Test Loss: 0.899 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3674654960632324
Epoch: 7, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.913 Vali Acc: 0.644 Test Loss: 0.913 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4136922359466553
Epoch: 8, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.003 Vali Acc: 0.605 Test Loss: 1.003 Test Acc: 0.605
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4446039199829102
Epoch: 9, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.064 Vali Acc: 0.639 Test Loss: 1.064 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.194885015487671
Epoch: 10, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.175 Vali Acc: 0.678 Test Loss: 1.175 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3752508163452148
Epoch: 11, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.702 Test Loss: 1.486 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 73922
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps31_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.922224283218384
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.646 Vali Acc: 0.683 Test Loss: 0.646 Test Acc: 0.683
Validation loss decreased (inf --> -0.682920).  Saving model ...
Epoch: 2 cost time: 1.3283045291900635
Epoch: 2, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.664 Vali Acc: 0.702 Test Loss: 0.664 Test Acc: 0.702
Validation loss decreased (-0.682920 --> -0.702432).  Saving model ...
Epoch: 3 cost time: 1.1828269958496094
Epoch: 3, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.776 Vali Acc: 0.507 Test Loss: 0.776 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2358951568603516
Epoch: 4, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.757 Vali Acc: 0.673 Test Loss: 0.757 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4414732456207275
Epoch: 5, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.794 Vali Acc: 0.663 Test Loss: 0.794 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3340415954589844
Epoch: 6, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.830 Vali Acc: 0.683 Test Loss: 0.830 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3100543022155762
Epoch: 7, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.915 Vali Acc: 0.678 Test Loss: 0.915 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4713120460510254
Epoch: 8, Steps: 13 | Train Loss: 0.035 Vali Loss: 0.993 Vali Acc: 0.663 Test Loss: 0.993 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.384624719619751
Epoch: 9, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.057 Vali Acc: 0.639 Test Loss: 1.057 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5007619857788086
Epoch: 10, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.189 Vali Acc: 0.698 Test Loss: 1.189 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5229249000549316
Epoch: 11, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.217 Vali Acc: 0.712 Test Loss: 1.217 Test Acc: 0.712
Validation loss decreased (-0.702432 --> -0.712183).  Saving model ...
Epoch: 12 cost time: 1.3837149143218994
Epoch: 12, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.223 Vali Acc: 0.702 Test Loss: 1.223 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3686940670013428
Epoch: 13, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.217 Vali Acc: 0.673 Test Loss: 1.217 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4265084266662598
Epoch: 14, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.265 Vali Acc: 0.702 Test Loss: 1.265 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.357459306716919
Epoch: 15, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.290 Vali Acc: 0.698 Test Loss: 1.290 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2957353591918945
Epoch: 16, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.293 Vali Acc: 0.688 Test Loss: 1.293 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.411935567855835
Epoch: 17, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.693 Test Loss: 1.321 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.386530876159668
Epoch: 18, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.353 Vali Acc: 0.702 Test Loss: 1.353 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.324829339981079
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.333 Vali Acc: 0.688 Test Loss: 1.333 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1303553581237793
Epoch: 20, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.370 Vali Acc: 0.688 Test Loss: 1.370 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3937397003173828
Epoch: 21, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.402 Vali Acc: 0.707 Test Loss: 1.402 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps31_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7121951219512195
model parameter : 52610
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps41_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.966913938522339
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3428950309753418
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.654 Vali Acc: 0.668 Test Loss: 0.654 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3498539924621582
Epoch: 3, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.671 Vali Acc: 0.702 Test Loss: 0.671 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2729830741882324
Epoch: 4, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3939266204833984
Epoch: 5, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.752 Vali Acc: 0.624 Test Loss: 0.752 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2294209003448486
Epoch: 6, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.797 Vali Acc: 0.722 Test Loss: 0.797 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721943).  Saving model ...
Epoch: 7 cost time: 1.1988639831542969
Epoch: 7, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.856 Vali Acc: 0.678 Test Loss: 0.856 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1516668796539307
Epoch: 8, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.940 Vali Acc: 0.634 Test Loss: 0.940 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.303678274154663
Epoch: 9, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.986 Vali Acc: 0.605 Test Loss: 0.986 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3873181343078613
Epoch: 10, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.037 Vali Acc: 0.649 Test Loss: 1.037 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2732651233673096
Epoch: 11, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.081 Vali Acc: 0.668 Test Loss: 1.081 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2502460479736328
Epoch: 12, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.112 Vali Acc: 0.678 Test Loss: 1.112 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1354162693023682
Epoch: 13, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.126 Vali Acc: 0.644 Test Loss: 1.126 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3622410297393799
Epoch: 14, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.168 Vali Acc: 0.683 Test Loss: 1.168 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3825223445892334
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.173 Vali Acc: 0.654 Test Loss: 1.173 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3423893451690674
Epoch: 16, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.198 Vali Acc: 0.654 Test Loss: 1.198 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps41_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 41058
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps61_str31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.8979971408843994
Epoch: 1, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.632 Vali Acc: 0.722 Test Loss: 0.632 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2327051162719727
Epoch: 2, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.599 Vali Acc: 0.712 Test Loss: 0.599 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3142199516296387
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.617 Vali Acc: 0.712 Test Loss: 0.617 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2993841171264648
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.658 Vali Acc: 0.702 Test Loss: 0.658 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3552100658416748
Epoch: 5, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.692 Vali Acc: 0.663 Test Loss: 0.692 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3069138526916504
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3971567153930664
Epoch: 7, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.810 Vali Acc: 0.678 Test Loss: 0.810 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3986155986785889
Epoch: 8, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.887 Vali Acc: 0.688 Test Loss: 0.887 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.339198112487793
Epoch: 9, Steps: 13 | Train Loss: 0.087 Vali Loss: 0.969 Vali Acc: 0.566 Test Loss: 0.969 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.242863655090332
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.239231824874878
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps61_str31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 29666
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps81_str41_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0466487407684326
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.641 Vali Acc: 0.634 Test Loss: 0.641 Test Acc: 0.634
Validation loss decreased (inf --> -0.634140).  Saving model ...
Epoch: 2 cost time: 1.3760855197906494
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.647 Vali Acc: 0.698 Test Loss: 0.647 Test Acc: 0.698
Validation loss decreased (-0.634140 --> -0.697555).  Saving model ...
Epoch: 3 cost time: 1.2129395008087158
Epoch: 3, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.652 Vali Acc: 0.663 Test Loss: 0.652 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2286076545715332
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.667 Vali Acc: 0.683 Test Loss: 0.667 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3096330165863037
Epoch: 5, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.684 Vali Acc: 0.683 Test Loss: 0.684 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1999599933624268
Epoch: 6, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.721 Vali Acc: 0.663 Test Loss: 0.721 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1359927654266357
Epoch: 7, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.744 Vali Acc: 0.663 Test Loss: 0.744 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1999733448028564
Epoch: 8, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.773 Vali Acc: 0.668 Test Loss: 0.773 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.199660062789917
Epoch: 9, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.799 Vali Acc: 0.654 Test Loss: 0.799 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3411705493927002
Epoch: 10, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.862 Vali Acc: 0.659 Test Loss: 0.862 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3936970233917236
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.901 Vali Acc: 0.649 Test Loss: 0.901 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2856769561767578
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.957 Vali Acc: 0.654 Test Loss: 0.957 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps81_str41_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 22178
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps102_str51_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 2.675572395324707
Epoch: 1, Steps: 13 | Train Loss: 0.730 Vali Loss: 0.654 Vali Acc: 0.644 Test Loss: 0.654 Test Acc: 0.644
Validation loss decreased (inf --> -0.643896).  Saving model ...
Epoch: 2 cost time: 0.9178683757781982
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.654 Vali Acc: 0.698 Test Loss: 0.654 Test Acc: 0.698
Validation loss decreased (-0.643896 --> -0.697554).  Saving model ...
Epoch: 3 cost time: 1.019726037979126
Epoch: 3, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.646 Vali Acc: 0.688 Test Loss: 0.646 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.021937608718872
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.656 Vali Acc: 0.678 Test Loss: 0.656 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0104572772979736
Epoch: 5, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.677 Vali Acc: 0.688 Test Loss: 0.677 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0396144390106201
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.696 Vali Acc: 0.688 Test Loss: 0.696 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8904585838317871
Epoch: 7, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.739 Vali Acc: 0.629 Test Loss: 0.739 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8709597587585449
Epoch: 8, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.777 Vali Acc: 0.624 Test Loss: 0.777 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.960578441619873
Epoch: 9, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.816 Vali Acc: 0.624 Test Loss: 0.816 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0024604797363281
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.853 Vali Acc: 0.629 Test Loss: 0.853 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9804189205169678
Epoch: 11, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.929 Vali Acc: 0.610 Test Loss: 0.929 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8352611064910889
Epoch: 12, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.979 Vali Acc: 0.615 Test Loss: 0.979 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_PatchTST_UEA_ftM_sl405_ll0_pl0_el1_dm16_nh4_df64_ps102_str51_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.697560975609756
model parameter : 18610
model size : 0.39MB
