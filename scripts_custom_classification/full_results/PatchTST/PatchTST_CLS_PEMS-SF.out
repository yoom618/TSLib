Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 16.5332909
	speed: 0.5121s/iter; left time: 6811.6417s
Epoch: 1 cost time: 68.57959318161011
Epoch: 1, Steps: 134 | Train Loss: 86.602 Vali Loss: 13.996 Vali Acc: 0.376 Test Loss: 13.996 Test Acc: 0.376
Validation loss decreased (inf --> -0.375583).  Saving model ...
	iters: 100, epoch: 2 | loss: 8.6532736
	speed: 1.0175s/iter; left time: 13397.2522s
Epoch: 2 cost time: 68.88416028022766
Epoch: 2, Steps: 134 | Train Loss: 5.844 Vali Loss: 8.338 Vali Acc: 0.486 Test Loss: 8.338 Test Acc: 0.486
Validation loss decreased (-0.375583 --> -0.485466).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 1.0260s/iter; left time: 13371.9790s
Epoch: 3 cost time: 68.59321546554565
Epoch: 3, Steps: 134 | Train Loss: 5.995 Vali Loss: 8.593 Vali Acc: 0.728 Test Loss: 8.593 Test Acc: 0.728
Validation loss decreased (-0.485466 --> -0.728238).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 1.0404s/iter; left time: 13420.4787s
Epoch: 4 cost time: 68.61517262458801
Epoch: 4, Steps: 134 | Train Loss: 2.416 Vali Loss: 13.754 Vali Acc: 0.636 Test Loss: 13.754 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 1.0114s/iter; left time: 12910.1550s
Epoch: 5 cost time: 68.98276352882385
Epoch: 5, Steps: 134 | Train Loss: 3.954 Vali Loss: 24.533 Vali Acc: 0.618 Test Loss: 24.533 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 1.0139s/iter; left time: 12806.4042s
Epoch: 6 cost time: 68.86674857139587
Epoch: 6, Steps: 134 | Train Loss: 1.973 Vali Loss: 32.479 Vali Acc: 0.699 Test Loss: 32.479 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 1.0078s/iter; left time: 12594.5611s
Epoch: 7 cost time: 68.85838651657104
Epoch: 7, Steps: 134 | Train Loss: 1.952 Vali Loss: 179.345 Vali Acc: 0.347 Test Loss: 179.345 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 1.0169s/iter; left time: 12571.8931s
Epoch: 8 cost time: 68.91520810127258
Epoch: 8, Steps: 134 | Train Loss: 7.637 Vali Loss: 55.408 Vali Acc: 0.665 Test Loss: 55.408 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 1.0189s/iter; left time: 12460.0546s
Epoch: 9 cost time: 68.91974878311157
Epoch: 9, Steps: 134 | Train Loss: 4.804 Vali Loss: 19.816 Vali Acc: 0.815 Test Loss: 19.816 Test Acc: 0.815
Validation loss decreased (-0.728238 --> -0.814831).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 1.0383s/iter; left time: 12558.5187s
Epoch: 10 cost time: 68.73981404304504
Epoch: 10, Steps: 134 | Train Loss: 5.506 Vali Loss: 84.017 Vali Acc: 0.578 Test Loss: 84.017 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 8.1874084
	speed: 1.0176s/iter; left time: 12171.1317s
Epoch: 11 cost time: 68.82212448120117
Epoch: 11, Steps: 134 | Train Loss: 6.425 Vali Loss: 115.479 Vali Acc: 0.480 Test Loss: 115.479 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 1.0182s/iter; left time: 12042.1313s
Epoch: 12 cost time: 68.94161462783813
Epoch: 12, Steps: 134 | Train Loss: 4.118 Vali Loss: 122.771 Vali Acc: 0.543 Test Loss: 122.771 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 8.1822071
	speed: 1.0158s/iter; left time: 11877.3593s
Epoch: 13 cost time: 68.71133947372437
Epoch: 13, Steps: 134 | Train Loss: 3.219 Vali Loss: 117.131 Vali Acc: 0.578 Test Loss: 117.131 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 1.0094s/iter; left time: 11668.0076s
Epoch: 14 cost time: 69.06561994552612
Epoch: 14, Steps: 134 | Train Loss: 0.029 Vali Loss: 152.278 Vali Acc: 0.503 Test Loss: 152.278 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 1.0149s/iter; left time: 11595.0728s
Epoch: 15 cost time: 68.84374570846558
Epoch: 15, Steps: 134 | Train Loss: 0.106 Vali Loss: 137.156 Vali Acc: 0.555 Test Loss: 137.156 Test Acc: 0.555
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 1.0150s/iter; left time: 11459.9894s
Epoch: 16 cost time: 68.92068386077881
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 132.999 Vali Acc: 0.543 Test Loss: 132.999 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000063
	speed: 1.0188s/iter; left time: 11367.2863s
Epoch: 17 cost time: 69.0340576171875
Epoch: 17, Steps: 134 | Train Loss: 1.685 Vali Loss: 57.313 Vali Acc: 0.665 Test Loss: 57.313 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 1.0173s/iter; left time: 11213.4616s
Epoch: 18 cost time: 68.88804054260254
Epoch: 18, Steps: 134 | Train Loss: 0.164 Vali Loss: 164.984 Vali Acc: 0.566 Test Loss: 164.984 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 1.0164s/iter; left time: 11067.2125s
Epoch: 19 cost time: 68.81037044525146
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 162.769 Vali Acc: 0.566 Test Loss: 162.769 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 62523271
model size : 240.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 32.79510474205017
Epoch: 1, Steps: 67 | Train Loss: 75.456 Vali Loss: 44.775 Vali Acc: 0.376 Test Loss: 44.775 Test Acc: 0.376
Validation loss decreased (inf --> -0.375275).  Saving model ...
Epoch: 2 cost time: 32.195475339889526
Epoch: 2, Steps: 67 | Train Loss: 9.213 Vali Loss: 3.609 Vali Acc: 0.584 Test Loss: 3.609 Test Acc: 0.584
Validation loss decreased (-0.375275 --> -0.583779).  Saving model ...
Epoch: 3 cost time: 31.491120100021362
Epoch: 3, Steps: 67 | Train Loss: 0.615 Vali Loss: 7.221 Vali Acc: 0.561 Test Loss: 7.221 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.933481216430664
Epoch: 4, Steps: 67 | Train Loss: 1.230 Vali Loss: 5.461 Vali Acc: 0.636 Test Loss: 5.461 Test Acc: 0.636
Validation loss decreased (-0.583779 --> -0.635784).  Saving model ...
Epoch: 5 cost time: 32.02049160003662
Epoch: 5, Steps: 67 | Train Loss: 1.147 Vali Loss: 6.934 Vali Acc: 0.694 Test Loss: 6.934 Test Acc: 0.694
Validation loss decreased (-0.635784 --> -0.693572).  Saving model ...
Epoch: 6 cost time: 32.23270916938782
Epoch: 6, Steps: 67 | Train Loss: 1.106 Vali Loss: 13.923 Vali Acc: 0.613 Test Loss: 13.923 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 32.29051733016968
Epoch: 7, Steps: 67 | Train Loss: 0.648 Vali Loss: 5.041 Vali Acc: 0.740 Test Loss: 5.041 Test Acc: 0.740
Validation loss decreased (-0.693572 --> -0.739834).  Saving model ...
Epoch: 8 cost time: 31.970007181167603
Epoch: 8, Steps: 67 | Train Loss: 1.742 Vali Loss: 14.286 Vali Acc: 0.653 Test Loss: 14.286 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.06767702102661
Epoch: 9, Steps: 67 | Train Loss: 0.789 Vali Loss: 33.953 Vali Acc: 0.584 Test Loss: 33.953 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.178823709487915
Epoch: 10, Steps: 67 | Train Loss: 1.829 Vali Loss: 13.283 Vali Acc: 0.769 Test Loss: 13.283 Test Acc: 0.769
Validation loss decreased (-0.739834 --> -0.768653).  Saving model ...
Epoch: 11 cost time: 31.978418827056885
Epoch: 11, Steps: 67 | Train Loss: 1.946 Vali Loss: 7.416 Vali Acc: 0.734 Test Loss: 7.416 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 32.44103217124939
Epoch: 12, Steps: 67 | Train Loss: 0.494 Vali Loss: 9.372 Vali Acc: 0.757 Test Loss: 9.372 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 32.24270558357239
Epoch: 13, Steps: 67 | Train Loss: 0.723 Vali Loss: 11.956 Vali Acc: 0.682 Test Loss: 11.956 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 31.95873475074768
Epoch: 14, Steps: 67 | Train Loss: 0.095 Vali Loss: 6.713 Vali Acc: 0.798 Test Loss: 6.713 Test Acc: 0.798
Validation loss decreased (-0.768653 --> -0.797621).  Saving model ...
Epoch: 15 cost time: 31.579524517059326
Epoch: 15, Steps: 67 | Train Loss: 0.301 Vali Loss: 27.042 Vali Acc: 0.618 Test Loss: 27.042 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 32.02930808067322
Epoch: 16, Steps: 67 | Train Loss: 2.048 Vali Loss: 25.087 Vali Acc: 0.526 Test Loss: 25.087 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.93035888671875
Epoch: 17, Steps: 67 | Train Loss: 1.645 Vali Loss: 78.136 Vali Acc: 0.457 Test Loss: 78.136 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 31.893878698349
Epoch: 18, Steps: 67 | Train Loss: 0.719 Vali Loss: 19.974 Vali Acc: 0.746 Test Loss: 19.974 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 31.728355884552002
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 17.549 Vali Acc: 0.699 Test Loss: 17.549 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 32.27069711685181
Epoch: 20, Steps: 67 | Train Loss: 1.496 Vali Loss: 110.315 Vali Acc: 0.486 Test Loss: 110.315 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 32.10731482505798
Epoch: 21, Steps: 67 | Train Loss: 1.472 Vali Loss: 103.956 Vali Acc: 0.260 Test Loss: 103.956 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 32.117486238479614
Epoch: 22, Steps: 67 | Train Loss: 1.111 Vali Loss: 22.977 Vali Acc: 0.682 Test Loss: 22.977 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 31.976482152938843
Epoch: 23, Steps: 67 | Train Loss: 0.613 Vali Loss: 91.323 Vali Acc: 0.584 Test Loss: 91.323 Test Acc: 0.584
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 32.25957131385803
Epoch: 24, Steps: 67 | Train Loss: 5.449 Vali Loss: 98.854 Vali Acc: 0.561 Test Loss: 98.854 Test Acc: 0.561
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 31461255
model size : 122.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.358756065368652
Epoch: 1, Steps: 67 | Train Loss: 27.620 Vali Loss: 41.722 Vali Acc: 0.393 Test Loss: 41.722 Test Acc: 0.393
Validation loss decreased (inf --> -0.392646).  Saving model ...
Epoch: 2 cost time: 17.53343367576599
Epoch: 2, Steps: 67 | Train Loss: 8.712 Vali Loss: 5.350 Vali Acc: 0.549 Test Loss: 5.350 Test Acc: 0.549
Validation loss decreased (-0.392646 --> -0.549079).  Saving model ...
Epoch: 3 cost time: 17.17778491973877
Epoch: 3, Steps: 67 | Train Loss: 0.609 Vali Loss: 1.913 Vali Acc: 0.751 Test Loss: 1.913 Test Acc: 0.751
Validation loss decreased (-0.549079 --> -0.751426).  Saving model ...
Epoch: 4 cost time: 17.237966299057007
Epoch: 4, Steps: 67 | Train Loss: 0.698 Vali Loss: 2.553 Vali Acc: 0.798 Test Loss: 2.553 Test Acc: 0.798
Validation loss decreased (-0.751426 --> -0.797662).  Saving model ...
Epoch: 5 cost time: 17.169387817382812
Epoch: 5, Steps: 67 | Train Loss: 0.413 Vali Loss: 2.868 Vali Acc: 0.734 Test Loss: 2.868 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.476750135421753
Epoch: 6, Steps: 67 | Train Loss: 0.491 Vali Loss: 6.880 Vali Acc: 0.734 Test Loss: 6.880 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.653209686279297
Epoch: 7, Steps: 67 | Train Loss: 0.316 Vali Loss: 15.835 Vali Acc: 0.665 Test Loss: 15.835 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.15425753593445
Epoch: 8, Steps: 67 | Train Loss: 0.861 Vali Loss: 22.625 Vali Acc: 0.642 Test Loss: 22.625 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.148423194885254
Epoch: 9, Steps: 67 | Train Loss: 2.063 Vali Loss: 6.678 Vali Acc: 0.780 Test Loss: 6.678 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 17.422245025634766
Epoch: 10, Steps: 67 | Train Loss: 2.062 Vali Loss: 9.175 Vali Acc: 0.780 Test Loss: 9.175 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.269896507263184
Epoch: 11, Steps: 67 | Train Loss: 0.611 Vali Loss: 16.552 Vali Acc: 0.642 Test Loss: 16.552 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.37385892868042
Epoch: 12, Steps: 67 | Train Loss: 0.398 Vali Loss: 10.472 Vali Acc: 0.688 Test Loss: 10.472 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 17.274701356887817
Epoch: 13, Steps: 67 | Train Loss: 0.341 Vali Loss: 15.369 Vali Acc: 0.780 Test Loss: 15.369 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 17.249693632125854
Epoch: 14, Steps: 67 | Train Loss: 0.234 Vali Loss: 9.147 Vali Acc: 0.815 Test Loss: 9.147 Test Acc: 0.815
Validation loss decreased (-0.797662 --> -0.814937).  Saving model ...
Epoch: 15 cost time: 17.74153184890747
Epoch: 15, Steps: 67 | Train Loss: 0.713 Vali Loss: 8.566 Vali Acc: 0.757 Test Loss: 8.566 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 17.397664308547974
Epoch: 16, Steps: 67 | Train Loss: 1.085 Vali Loss: 14.518 Vali Acc: 0.647 Test Loss: 14.518 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 17.587718963623047
Epoch: 17, Steps: 67 | Train Loss: 1.024 Vali Loss: 30.550 Vali Acc: 0.775 Test Loss: 30.550 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.27190113067627
Epoch: 18, Steps: 67 | Train Loss: 1.467 Vali Loss: 493.802 Vali Acc: 0.156 Test Loss: 493.802 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 17.42708683013916
Epoch: 19, Steps: 67 | Train Loss: 3.091 Vali Loss: 159.912 Vali Acc: 0.173 Test Loss: 159.912 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 17.35619306564331
Epoch: 20, Steps: 67 | Train Loss: 4.666 Vali Loss: 62.708 Vali Acc: 0.468 Test Loss: 62.708 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 17.446117162704468
Epoch: 21, Steps: 67 | Train Loss: 0.725 Vali Loss: 11.395 Vali Acc: 0.751 Test Loss: 11.395 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 17.375980138778687
Epoch: 22, Steps: 67 | Train Loss: 0.833 Vali Loss: 111.733 Vali Acc: 0.491 Test Loss: 111.733 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 17.351027250289917
Epoch: 23, Steps: 67 | Train Loss: 0.345 Vali Loss: 18.097 Vali Acc: 0.751 Test Loss: 18.097 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 17.14862298965454
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 18.181 Vali Acc: 0.751 Test Loss: 18.181 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 21107463
model size : 82.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.09485173225403
Epoch: 1, Steps: 67 | Train Loss: 20.112 Vali Loss: 24.641 Vali Acc: 0.439 Test Loss: 24.641 Test Acc: 0.439
Validation loss decreased (inf --> -0.439060).  Saving model ...
Epoch: 2 cost time: 14.71424651145935
Epoch: 2, Steps: 67 | Train Loss: 3.585 Vali Loss: 1.847 Vali Acc: 0.699 Test Loss: 1.847 Test Acc: 0.699
Validation loss decreased (-0.439060 --> -0.699403).  Saving model ...
Epoch: 3 cost time: 14.968956708908081
Epoch: 3, Steps: 67 | Train Loss: 0.488 Vali Loss: 2.334 Vali Acc: 0.723 Test Loss: 2.334 Test Acc: 0.723
Validation loss decreased (-0.699403 --> -0.722520).  Saving model ...
Epoch: 4 cost time: 14.885688066482544
Epoch: 4, Steps: 67 | Train Loss: 0.244 Vali Loss: 6.659 Vali Acc: 0.723 Test Loss: 6.659 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.977146863937378
Epoch: 5, Steps: 67 | Train Loss: 0.219 Vali Loss: 5.558 Vali Acc: 0.763 Test Loss: 5.558 Test Acc: 0.763
Validation loss decreased (-0.722520 --> -0.762950).  Saving model ...
Epoch: 6 cost time: 14.681170463562012
Epoch: 6, Steps: 67 | Train Loss: 0.469 Vali Loss: 4.685 Vali Acc: 0.780 Test Loss: 4.685 Test Acc: 0.780
Validation loss decreased (-0.762950 --> -0.780300).  Saving model ...
Epoch: 7 cost time: 14.894284009933472
Epoch: 7, Steps: 67 | Train Loss: 1.499 Vali Loss: 8.954 Vali Acc: 0.763 Test Loss: 8.954 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.10127592086792
Epoch: 8, Steps: 67 | Train Loss: 1.749 Vali Loss: 14.157 Vali Acc: 0.647 Test Loss: 14.157 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.89694619178772
Epoch: 9, Steps: 67 | Train Loss: 0.460 Vali Loss: 19.215 Vali Acc: 0.688 Test Loss: 19.215 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 14.92365312576294
Epoch: 10, Steps: 67 | Train Loss: 0.831 Vali Loss: 17.395 Vali Acc: 0.618 Test Loss: 17.395 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.047439336776733
Epoch: 11, Steps: 67 | Train Loss: 0.357 Vali Loss: 62.650 Vali Acc: 0.607 Test Loss: 62.650 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 14.848735570907593
Epoch: 12, Steps: 67 | Train Loss: 0.773 Vali Loss: 7.964 Vali Acc: 0.786 Test Loss: 7.964 Test Acc: 0.786
Validation loss decreased (-0.780300 --> -0.786048).  Saving model ...
Epoch: 13 cost time: 14.764365434646606
Epoch: 13, Steps: 67 | Train Loss: 0.265 Vali Loss: 7.274 Vali Acc: 0.809 Test Loss: 7.274 Test Acc: 0.809
Validation loss decreased (-0.786048 --> -0.809176).  Saving model ...
Epoch: 14 cost time: 14.79351258277893
Epoch: 14, Steps: 67 | Train Loss: 0.169 Vali Loss: 14.133 Vali Acc: 0.751 Test Loss: 14.133 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 14.938609838485718
Epoch: 15, Steps: 67 | Train Loss: 0.608 Vali Loss: 31.993 Vali Acc: 0.590 Test Loss: 31.993 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.04082179069519
Epoch: 16, Steps: 67 | Train Loss: 0.658 Vali Loss: 51.302 Vali Acc: 0.578 Test Loss: 51.302 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.096770763397217
Epoch: 17, Steps: 67 | Train Loss: 1.354 Vali Loss: 28.162 Vali Acc: 0.468 Test Loss: 28.162 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.863475799560547
Epoch: 18, Steps: 67 | Train Loss: 0.596 Vali Loss: 14.855 Vali Acc: 0.757 Test Loss: 14.855 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.895216226577759
Epoch: 19, Steps: 67 | Train Loss: 0.589 Vali Loss: 19.219 Vali Acc: 0.780 Test Loss: 19.219 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 15.049825668334961
Epoch: 20, Steps: 67 | Train Loss: 0.113 Vali Loss: 178.755 Vali Acc: 0.329 Test Loss: 178.755 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.107628107070923
Epoch: 21, Steps: 67 | Train Loss: 2.644 Vali Loss: 16.360 Vali Acc: 0.705 Test Loss: 16.360 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 15.368277311325073
Epoch: 22, Steps: 67 | Train Loss: 1.491 Vali Loss: 50.204 Vali Acc: 0.566 Test Loss: 50.204 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 15.243620872497559
Epoch: 23, Steps: 67 | Train Loss: 3.431 Vali Loss: 361.963 Vali Acc: 0.283 Test Loss: 361.963 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 15930887
model size : 63.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.2116539478302
Epoch: 1, Steps: 67 | Train Loss: 18.578 Vali Loss: 4.930 Vali Acc: 0.584 Test Loss: 4.930 Test Acc: 0.584
Validation loss decreased (inf --> -0.583766).  Saving model ...
Epoch: 2 cost time: 10.794363498687744
Epoch: 2, Steps: 67 | Train Loss: 1.567 Vali Loss: 0.840 Vali Acc: 0.746 Test Loss: 0.840 Test Acc: 0.746
Validation loss decreased (-0.583766 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 10.805223941802979
Epoch: 3, Steps: 67 | Train Loss: 0.536 Vali Loss: 1.640 Vali Acc: 0.711 Test Loss: 1.640 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.01445746421814
Epoch: 4, Steps: 67 | Train Loss: 0.468 Vali Loss: 5.458 Vali Acc: 0.723 Test Loss: 5.458 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.238176584243774
Epoch: 5, Steps: 67 | Train Loss: 0.850 Vali Loss: 3.842 Vali Acc: 0.653 Test Loss: 3.842 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.956808805465698
Epoch: 6, Steps: 67 | Train Loss: 0.934 Vali Loss: 7.092 Vali Acc: 0.671 Test Loss: 7.092 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.114794492721558
Epoch: 7, Steps: 67 | Train Loss: 0.969 Vali Loss: 4.744 Vali Acc: 0.780 Test Loss: 4.744 Test Acc: 0.780
Validation loss decreased (-0.745656 --> -0.780299).  Saving model ...
Epoch: 8 cost time: 11.053517580032349
Epoch: 8, Steps: 67 | Train Loss: 0.446 Vali Loss: 5.194 Vali Acc: 0.780 Test Loss: 5.194 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.037384748458862
Epoch: 9, Steps: 67 | Train Loss: 0.489 Vali Loss: 17.321 Vali Acc: 0.526 Test Loss: 17.321 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.847809314727783
Epoch: 10, Steps: 67 | Train Loss: 0.258 Vali Loss: 20.685 Vali Acc: 0.665 Test Loss: 20.685 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.155128240585327
Epoch: 11, Steps: 67 | Train Loss: 0.724 Vali Loss: 4.427 Vali Acc: 0.792 Test Loss: 4.427 Test Acc: 0.792
Validation loss decreased (-0.780299 --> -0.791863).  Saving model ...
Epoch: 12 cost time: 10.85423231124878
Epoch: 12, Steps: 67 | Train Loss: 0.521 Vali Loss: 42.977 Vali Acc: 0.376 Test Loss: 42.977 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.968550443649292
Epoch: 13, Steps: 67 | Train Loss: 0.887 Vali Loss: 6.796 Vali Acc: 0.728 Test Loss: 6.796 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.720749378204346
Epoch: 14, Steps: 67 | Train Loss: 0.597 Vali Loss: 11.609 Vali Acc: 0.775 Test Loss: 11.609 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.949990034103394
Epoch: 15, Steps: 67 | Train Loss: 0.647 Vali Loss: 19.613 Vali Acc: 0.717 Test Loss: 19.613 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.011934518814087
Epoch: 16, Steps: 67 | Train Loss: 0.638 Vali Loss: 20.997 Vali Acc: 0.647 Test Loss: 20.997 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.750994682312012
Epoch: 17, Steps: 67 | Train Loss: 1.229 Vali Loss: 56.710 Vali Acc: 0.341 Test Loss: 56.710 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.057835102081299
Epoch: 18, Steps: 67 | Train Loss: 1.078 Vali Loss: 35.777 Vali Acc: 0.561 Test Loss: 35.777 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.866964101791382
Epoch: 19, Steps: 67 | Train Loss: 1.077 Vali Loss: 11.827 Vali Acc: 0.665 Test Loss: 11.827 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.8841073513031
Epoch: 20, Steps: 67 | Train Loss: 0.601 Vali Loss: 20.032 Vali Acc: 0.607 Test Loss: 20.032 Test Acc: 0.607
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.968048572540283
Epoch: 21, Steps: 67 | Train Loss: 0.465 Vali Loss: 50.051 Vali Acc: 0.653 Test Loss: 50.051 Test Acc: 0.653
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 11617543
model size : 46.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.453334093093872
Epoch: 1, Steps: 67 | Train Loss: 7.634 Vali Loss: 3.759 Vali Acc: 0.630 Test Loss: 3.759 Test Acc: 0.630
Validation loss decreased (inf --> -0.630020).  Saving model ...
Epoch: 2 cost time: 8.817041397094727
Epoch: 2, Steps: 67 | Train Loss: 2.361 Vali Loss: 1.183 Vali Acc: 0.705 Test Loss: 1.183 Test Acc: 0.705
Validation loss decreased (-0.630020 --> -0.705190).  Saving model ...
Epoch: 3 cost time: 8.937883138656616
Epoch: 3, Steps: 67 | Train Loss: 0.201 Vali Loss: 0.929 Vali Acc: 0.827 Test Loss: 0.929 Test Acc: 0.827
Validation loss decreased (-0.705190 --> -0.826580).  Saving model ...
Epoch: 4 cost time: 8.993172883987427
Epoch: 4, Steps: 67 | Train Loss: 0.234 Vali Loss: 2.559 Vali Acc: 0.694 Test Loss: 2.559 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.926187753677368
Epoch: 5, Steps: 67 | Train Loss: 0.490 Vali Loss: 1.898 Vali Acc: 0.740 Test Loss: 1.898 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.03114128112793
Epoch: 6, Steps: 67 | Train Loss: 0.315 Vali Loss: 4.310 Vali Acc: 0.711 Test Loss: 4.310 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.143327713012695
Epoch: 7, Steps: 67 | Train Loss: 0.443 Vali Loss: 8.254 Vali Acc: 0.503 Test Loss: 8.254 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.184752225875854
Epoch: 8, Steps: 67 | Train Loss: 0.492 Vali Loss: 34.767 Vali Acc: 0.422 Test Loss: 34.767 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.107351064682007
Epoch: 9, Steps: 67 | Train Loss: 0.417 Vali Loss: 25.512 Vali Acc: 0.590 Test Loss: 25.512 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.076854467391968
Epoch: 10, Steps: 67 | Train Loss: 1.092 Vali Loss: 84.258 Vali Acc: 0.301 Test Loss: 84.258 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.09317684173584
Epoch: 11, Steps: 67 | Train Loss: 0.333 Vali Loss: 26.693 Vali Acc: 0.439 Test Loss: 26.693 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.105544090270996
Epoch: 12, Steps: 67 | Train Loss: 0.694 Vali Loss: 14.583 Vali Acc: 0.561 Test Loss: 14.583 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 8.93725323677063
Epoch: 13, Steps: 67 | Train Loss: 0.368 Vali Loss: 6.684 Vali Acc: 0.792 Test Loss: 6.684 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 8167047
model size : 33.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.125000953674316
Epoch: 1, Steps: 67 | Train Loss: 10.504 Vali Loss: 2.825 Vali Acc: 0.601 Test Loss: 2.825 Test Acc: 0.601
Validation loss decreased (inf --> -0.601128).  Saving model ...
Epoch: 2 cost time: 7.286017417907715
Epoch: 2, Steps: 67 | Train Loss: 0.998 Vali Loss: 2.534 Vali Acc: 0.647 Test Loss: 2.534 Test Acc: 0.647
Validation loss decreased (-0.601128 --> -0.647374).  Saving model ...
Epoch: 3 cost time: 7.672888278961182
Epoch: 3, Steps: 67 | Train Loss: 0.384 Vali Loss: 1.787 Vali Acc: 0.798 Test Loss: 1.787 Test Acc: 0.798
Validation loss decreased (-0.647374 --> -0.797670).  Saving model ...
Epoch: 4 cost time: 7.263204336166382
Epoch: 4, Steps: 67 | Train Loss: 0.516 Vali Loss: 11.478 Vali Acc: 0.566 Test Loss: 11.478 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.54313850402832
Epoch: 5, Steps: 67 | Train Loss: 0.380 Vali Loss: 3.178 Vali Acc: 0.682 Test Loss: 3.178 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.424202919006348
Epoch: 6, Steps: 67 | Train Loss: 0.171 Vali Loss: 5.478 Vali Acc: 0.665 Test Loss: 5.478 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.481014966964722
Epoch: 7, Steps: 67 | Train Loss: 0.184 Vali Loss: 4.436 Vali Acc: 0.723 Test Loss: 4.436 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.519974231719971
Epoch: 8, Steps: 67 | Train Loss: 0.138 Vali Loss: 3.380 Vali Acc: 0.809 Test Loss: 3.380 Test Acc: 0.809
Validation loss decreased (-0.797670 --> -0.809215).  Saving model ...
Epoch: 9 cost time: 7.633946180343628
Epoch: 9, Steps: 67 | Train Loss: 0.747 Vali Loss: 19.072 Vali Acc: 0.434 Test Loss: 19.072 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.479208707809448
Epoch: 10, Steps: 67 | Train Loss: 0.208 Vali Loss: 21.115 Vali Acc: 0.566 Test Loss: 21.115 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.462328195571899
Epoch: 11, Steps: 67 | Train Loss: 0.608 Vali Loss: 14.410 Vali Acc: 0.578 Test Loss: 14.410 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.493793249130249
Epoch: 12, Steps: 67 | Train Loss: 0.528 Vali Loss: 11.255 Vali Acc: 0.566 Test Loss: 11.255 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.529932260513306
Epoch: 13, Steps: 67 | Train Loss: 0.514 Vali Loss: 17.247 Vali Acc: 0.595 Test Loss: 17.247 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.586622714996338
Epoch: 14, Steps: 67 | Train Loss: 0.340 Vali Loss: 15.635 Vali Acc: 0.624 Test Loss: 15.635 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.607279300689697
Epoch: 15, Steps: 67 | Train Loss: 0.261 Vali Loss: 86.018 Vali Acc: 0.150 Test Loss: 86.018 Test Acc: 0.150
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.415441036224365
Epoch: 16, Steps: 67 | Train Loss: 0.876 Vali Loss: 14.801 Vali Acc: 0.665 Test Loss: 14.801 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.449206590652466
Epoch: 17, Steps: 67 | Train Loss: 0.380 Vali Loss: 69.742 Vali Acc: 0.509 Test Loss: 69.742 Test Acc: 0.509
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.717658519744873
Epoch: 18, Steps: 67 | Train Loss: 0.764 Vali Loss: 217.093 Vali Acc: 0.301 Test Loss: 217.093 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 7305095
model size : 30.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 0.0000000
	speed: 0.4845s/iter; left time: 6444.2151s
Epoch: 1 cost time: 64.61005282402039
Epoch: 1, Steps: 134 | Train Loss: 104.457 Vali Loss: 37.693 Vali Acc: 0.220 Test Loss: 37.693 Test Acc: 0.220
Validation loss decreased (inf --> -0.219276).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.9670s/iter; left time: 12732.7622s
Epoch: 2 cost time: 63.516870975494385
Epoch: 2, Steps: 134 | Train Loss: 7.213 Vali Loss: 24.702 Vali Acc: 0.301 Test Loss: 24.702 Test Acc: 0.301
Validation loss decreased (-0.219276 --> -0.300331).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0266212
	speed: 0.9998s/iter; left time: 13030.8689s
Epoch: 3 cost time: 63.54070210456848
Epoch: 3, Steps: 134 | Train Loss: 7.607 Vali Loss: 10.174 Vali Acc: 0.694 Test Loss: 10.174 Test Acc: 0.694
Validation loss decreased (-0.300331 --> -0.693540).  Saving model ...
	iters: 100, epoch: 4 | loss: 11.9530487
	speed: 0.9976s/iter; left time: 12868.1648s
Epoch: 4 cost time: 63.60645365715027
Epoch: 4, Steps: 134 | Train Loss: 8.483 Vali Loss: 22.874 Vali Acc: 0.566 Test Loss: 22.874 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 22.1560364
	speed: 0.9708s/iter; left time: 12392.5681s
Epoch: 5 cost time: 64.00638151168823
Epoch: 5, Steps: 134 | Train Loss: 3.946 Vali Loss: 55.496 Vali Acc: 0.659 Test Loss: 55.496 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.9708s/iter; left time: 12262.5320s
Epoch: 6 cost time: 64.5421314239502
Epoch: 6, Steps: 134 | Train Loss: 3.125 Vali Loss: 22.241 Vali Acc: 0.751 Test Loss: 22.241 Test Acc: 0.751
Validation loss decreased (-0.693540 --> -0.751223).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 1.0061s/iter; left time: 12573.4626s
Epoch: 7 cost time: 64.2773187160492
Epoch: 7, Steps: 134 | Train Loss: 4.648 Vali Loss: 72.661 Vali Acc: 0.497 Test Loss: 72.661 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.9758s/iter; left time: 12063.5213s
Epoch: 8 cost time: 64.37938952445984
Epoch: 8, Steps: 134 | Train Loss: 7.744 Vali Loss: 103.681 Vali Acc: 0.341 Test Loss: 103.681 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 101.3304520
	speed: 0.9783s/iter; left time: 11963.1267s
Epoch: 9 cost time: 64.25283694267273
Epoch: 9, Steps: 134 | Train Loss: 7.189 Vali Loss: 146.087 Vali Acc: 0.480 Test Loss: 146.087 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.9781s/iter; left time: 11830.0169s
Epoch: 10 cost time: 64.53600311279297
Epoch: 10, Steps: 134 | Train Loss: 4.346 Vali Loss: 96.824 Vali Acc: 0.584 Test Loss: 96.824 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.9779s/iter; left time: 11696.9987s
Epoch: 11 cost time: 64.58396482467651
Epoch: 11, Steps: 134 | Train Loss: 1.413 Vali Loss: 197.954 Vali Acc: 0.312 Test Loss: 197.954 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 22.4016037
	speed: 0.9826s/iter; left time: 11621.7959s
Epoch: 12 cost time: 64.40597438812256
Epoch: 12, Steps: 134 | Train Loss: 5.430 Vali Loss: 60.169 Vali Acc: 0.723 Test Loss: 60.169 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.9770s/iter; left time: 11424.3602s
Epoch: 13 cost time: 64.52395486831665
Epoch: 13, Steps: 134 | Train Loss: 4.711 Vali Loss: 67.687 Vali Acc: 0.699 Test Loss: 67.687 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.9799s/iter; left time: 11326.6361s
Epoch: 14 cost time: 64.0806577205658
Epoch: 14, Steps: 134 | Train Loss: 0.183 Vali Loss: 64.482 Vali Acc: 0.671 Test Loss: 64.482 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.9752s/iter; left time: 11141.7352s
Epoch: 15 cost time: 64.32081437110901
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 64.886 Vali Acc: 0.671 Test Loss: 64.886 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.9831s/iter; left time: 11100.2255s
Epoch: 16 cost time: 64.41872644424438
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 64.696 Vali Acc: 0.671 Test Loss: 64.696 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7514450867052023
model parameter : 62424583
model size : 240.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 29.387353658676147
Epoch: 1, Steps: 67 | Train Loss: 57.474 Vali Loss: 25.309 Vali Acc: 0.329 Test Loss: 25.309 Test Acc: 0.329
Validation loss decreased (inf --> -0.329227).  Saving model ...
Epoch: 2 cost time: 28.17994236946106
Epoch: 2, Steps: 67 | Train Loss: 3.990 Vali Loss: 8.543 Vali Acc: 0.341 Test Loss: 8.543 Test Acc: 0.341
Validation loss decreased (-0.329227 --> -0.340955).  Saving model ...
Epoch: 3 cost time: 27.70508623123169
Epoch: 3, Steps: 67 | Train Loss: 2.514 Vali Loss: 7.104 Vali Acc: 0.486 Test Loss: 7.104 Test Acc: 0.486
Validation loss decreased (-0.340955 --> -0.485478).  Saving model ...
Epoch: 4 cost time: 27.909220218658447
Epoch: 4, Steps: 67 | Train Loss: 2.590 Vali Loss: 6.796 Vali Acc: 0.578 Test Loss: 6.796 Test Acc: 0.578
Validation loss decreased (-0.485478 --> -0.577967).  Saving model ...
Epoch: 5 cost time: 28.040801525115967
Epoch: 5, Steps: 67 | Train Loss: 2.412 Vali Loss: 26.939 Vali Acc: 0.468 Test Loss: 26.939 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.86782717704773
Epoch: 6, Steps: 67 | Train Loss: 2.233 Vali Loss: 7.539 Vali Acc: 0.757 Test Loss: 7.539 Test Acc: 0.757
Validation loss decreased (-0.577967 --> -0.757150).  Saving model ...
Epoch: 7 cost time: 27.83802628517151
Epoch: 7, Steps: 67 | Train Loss: 2.397 Vali Loss: 4.872 Vali Acc: 0.757 Test Loss: 4.872 Test Acc: 0.757
Validation loss decreased (-0.757150 --> -0.757177).  Saving model ...
Epoch: 8 cost time: 27.835397481918335
Epoch: 8, Steps: 67 | Train Loss: 0.251 Vali Loss: 10.884 Vali Acc: 0.734 Test Loss: 10.884 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.934931755065918
Epoch: 9, Steps: 67 | Train Loss: 0.473 Vali Loss: 4.168 Vali Acc: 0.798 Test Loss: 4.168 Test Acc: 0.798
Validation loss decreased (-0.757177 --> -0.797646).  Saving model ...
Epoch: 10 cost time: 27.898865699768066
Epoch: 10, Steps: 67 | Train Loss: 0.497 Vali Loss: 8.637 Vali Acc: 0.786 Test Loss: 8.637 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 28.12658405303955
Epoch: 11, Steps: 67 | Train Loss: 0.214 Vali Loss: 16.905 Vali Acc: 0.682 Test Loss: 16.905 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 28.202415227890015
Epoch: 12, Steps: 67 | Train Loss: 0.619 Vali Loss: 6.796 Vali Acc: 0.838 Test Loss: 6.796 Test Acc: 0.838
Validation loss decreased (-0.797646 --> -0.838082).  Saving model ...
Epoch: 13 cost time: 28.0046124458313
Epoch: 13, Steps: 67 | Train Loss: 3.307 Vali Loss: 28.209 Vali Acc: 0.717 Test Loss: 28.209 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 27.824641227722168
Epoch: 14, Steps: 67 | Train Loss: 3.386 Vali Loss: 639.445 Vali Acc: 0.133 Test Loss: 639.445 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 28.112725734710693
Epoch: 15, Steps: 67 | Train Loss: 3.279 Vali Loss: 43.257 Vali Acc: 0.694 Test Loss: 43.257 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 28.118836641311646
Epoch: 16, Steps: 67 | Train Loss: 5.336 Vali Loss: 309.278 Vali Acc: 0.133 Test Loss: 309.278 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 27.76064133644104
Epoch: 17, Steps: 67 | Train Loss: 3.627 Vali Loss: 29.450 Vali Acc: 0.694 Test Loss: 29.450 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 27.98091411590576
Epoch: 18, Steps: 67 | Train Loss: 1.680 Vali Loss: 33.553 Vali Acc: 0.740 Test Loss: 33.553 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 28.16069746017456
Epoch: 19, Steps: 67 | Train Loss: 1.082 Vali Loss: 57.698 Vali Acc: 0.561 Test Loss: 57.698 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 27.934049606323242
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 23.422 Vali Acc: 0.740 Test Loss: 23.422 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 27.984078884124756
Epoch: 21, Steps: 67 | Train Loss: 0.083 Vali Loss: 45.346 Vali Acc: 0.723 Test Loss: 45.346 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 28.037221908569336
Epoch: 22, Steps: 67 | Train Loss: 5.612 Vali Loss: 1118.169 Vali Acc: 0.150 Test Loss: 1118.169 Test Acc: 0.150
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 31362567
model size : 122.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.851373434066772
Epoch: 1, Steps: 67 | Train Loss: 36.432 Vali Loss: 11.523 Vali Acc: 0.457 Test Loss: 11.523 Test Acc: 0.457
Validation loss decreased (inf --> -0.456532).  Saving model ...
Epoch: 2 cost time: 15.862982749938965
Epoch: 2, Steps: 67 | Train Loss: 6.842 Vali Loss: 5.484 Vali Acc: 0.370 Test Loss: 5.484 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.900022268295288
Epoch: 3, Steps: 67 | Train Loss: 1.554 Vali Loss: 4.381 Vali Acc: 0.630 Test Loss: 4.381 Test Acc: 0.630
Validation loss decreased (-0.456532 --> -0.630014).  Saving model ...
Epoch: 4 cost time: 15.874953985214233
Epoch: 4, Steps: 67 | Train Loss: 1.138 Vali Loss: 6.135 Vali Acc: 0.671 Test Loss: 6.135 Test Acc: 0.671
Validation loss decreased (-0.630014 --> -0.670459).  Saving model ...
Epoch: 5 cost time: 15.941161632537842
Epoch: 5, Steps: 67 | Train Loss: 0.654 Vali Loss: 5.883 Vali Acc: 0.769 Test Loss: 5.883 Test Acc: 0.769
Validation loss decreased (-0.670459 --> -0.768727).  Saving model ...
Epoch: 6 cost time: 15.790132999420166
Epoch: 6, Steps: 67 | Train Loss: 0.656 Vali Loss: 4.735 Vali Acc: 0.711 Test Loss: 4.735 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.843780040740967
Epoch: 7, Steps: 67 | Train Loss: 0.543 Vali Loss: 11.373 Vali Acc: 0.561 Test Loss: 11.373 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.789024353027344
Epoch: 8, Steps: 67 | Train Loss: 0.597 Vali Loss: 6.311 Vali Acc: 0.757 Test Loss: 6.311 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.078930139541626
Epoch: 9, Steps: 67 | Train Loss: 1.187 Vali Loss: 5.957 Vali Acc: 0.786 Test Loss: 5.957 Test Acc: 0.786
Validation loss decreased (-0.768727 --> -0.786068).  Saving model ...
Epoch: 10 cost time: 15.841467142105103
Epoch: 10, Steps: 67 | Train Loss: 0.797 Vali Loss: 13.468 Vali Acc: 0.717 Test Loss: 13.468 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.167118787765503
Epoch: 11, Steps: 67 | Train Loss: 0.619 Vali Loss: 11.736 Vali Acc: 0.740 Test Loss: 11.736 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 16.137531757354736
Epoch: 12, Steps: 67 | Train Loss: 0.813 Vali Loss: 7.231 Vali Acc: 0.746 Test Loss: 7.231 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 16.13858985900879
Epoch: 13, Steps: 67 | Train Loss: 0.053 Vali Loss: 8.277 Vali Acc: 0.832 Test Loss: 8.277 Test Acc: 0.832
Validation loss decreased (-0.786068 --> -0.832287).  Saving model ...
Epoch: 14 cost time: 15.867432355880737
Epoch: 14, Steps: 67 | Train Loss: 0.366 Vali Loss: 23.626 Vali Acc: 0.676 Test Loss: 23.626 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.0396511554718
Epoch: 15, Steps: 67 | Train Loss: 0.992 Vali Loss: 35.749 Vali Acc: 0.462 Test Loss: 35.749 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 16.103708744049072
Epoch: 16, Steps: 67 | Train Loss: 1.536 Vali Loss: 19.832 Vali Acc: 0.428 Test Loss: 19.832 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.883540868759155
Epoch: 17, Steps: 67 | Train Loss: 1.155 Vali Loss: 29.852 Vali Acc: 0.717 Test Loss: 29.852 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 16.041320085525513
Epoch: 18, Steps: 67 | Train Loss: 0.728 Vali Loss: 21.860 Vali Acc: 0.699 Test Loss: 21.860 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 16.07052755355835
Epoch: 19, Steps: 67 | Train Loss: 0.406 Vali Loss: 44.004 Vali Acc: 0.607 Test Loss: 44.004 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 16.132562160491943
Epoch: 20, Steps: 67 | Train Loss: 0.474 Vali Loss: 22.153 Vali Acc: 0.607 Test Loss: 22.153 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 15.910549402236938
Epoch: 21, Steps: 67 | Train Loss: 0.652 Vali Loss: 8.931 Vali Acc: 0.815 Test Loss: 8.931 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 16.065798044204712
Epoch: 22, Steps: 67 | Train Loss: 1.927 Vali Loss: 38.196 Vali Acc: 0.601 Test Loss: 38.196 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 16.184699296951294
Epoch: 23, Steps: 67 | Train Loss: 3.332 Vali Loss: 28.344 Vali Acc: 0.630 Test Loss: 28.344 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 21008775
model size : 82.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.64399790763855
Epoch: 1, Steps: 67 | Train Loss: 29.124 Vali Loss: 8.860 Vali Acc: 0.618 Test Loss: 8.860 Test Acc: 0.618
Validation loss decreased (inf --> -0.618409).  Saving model ...
Epoch: 2 cost time: 13.102867364883423
Epoch: 2, Steps: 67 | Train Loss: 2.777 Vali Loss: 4.143 Vali Acc: 0.601 Test Loss: 4.143 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.01665711402893
Epoch: 3, Steps: 67 | Train Loss: 0.253 Vali Loss: 4.256 Vali Acc: 0.642 Test Loss: 4.256 Test Acc: 0.642
Validation loss decreased (-0.618409 --> -0.641576).  Saving model ...
Epoch: 4 cost time: 14.256282091140747
Epoch: 4, Steps: 67 | Train Loss: 0.463 Vali Loss: 3.332 Vali Acc: 0.769 Test Loss: 3.332 Test Acc: 0.769
Validation loss decreased (-0.641576 --> -0.768753).  Saving model ...
Epoch: 5 cost time: 13.931206941604614
Epoch: 5, Steps: 67 | Train Loss: 0.330 Vali Loss: 3.763 Vali Acc: 0.786 Test Loss: 3.763 Test Acc: 0.786
Validation loss decreased (-0.768753 --> -0.786090).  Saving model ...
Epoch: 6 cost time: 13.625618934631348
Epoch: 6, Steps: 67 | Train Loss: 0.765 Vali Loss: 20.163 Vali Acc: 0.439 Test Loss: 20.163 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.234549760818481
Epoch: 7, Steps: 67 | Train Loss: 0.523 Vali Loss: 14.958 Vali Acc: 0.595 Test Loss: 14.958 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.900238513946533
Epoch: 8, Steps: 67 | Train Loss: 0.102 Vali Loss: 9.187 Vali Acc: 0.734 Test Loss: 9.187 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.63555645942688
Epoch: 9, Steps: 67 | Train Loss: 0.400 Vali Loss: 6.169 Vali Acc: 0.775 Test Loss: 6.169 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.9026358127594
Epoch: 10, Steps: 67 | Train Loss: 0.791 Vali Loss: 3.620 Vali Acc: 0.746 Test Loss: 3.620 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 13.981343030929565
Epoch: 11, Steps: 67 | Train Loss: 1.609 Vali Loss: 28.552 Vali Acc: 0.549 Test Loss: 28.552 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 13.884997606277466
Epoch: 12, Steps: 67 | Train Loss: 1.769 Vali Loss: 17.826 Vali Acc: 0.630 Test Loss: 17.826 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 13.694936752319336
Epoch: 13, Steps: 67 | Train Loss: 1.691 Vali Loss: 16.768 Vali Acc: 0.561 Test Loss: 16.768 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 13.918251514434814
Epoch: 14, Steps: 67 | Train Loss: 2.418 Vali Loss: 18.061 Vali Acc: 0.723 Test Loss: 18.061 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 13.92613434791565
Epoch: 15, Steps: 67 | Train Loss: 0.740 Vali Loss: 21.222 Vali Acc: 0.780 Test Loss: 21.222 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 15832199
model size : 62.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.178515434265137
Epoch: 1, Steps: 67 | Train Loss: 19.323 Vali Loss: 10.818 Vali Acc: 0.422 Test Loss: 10.818 Test Acc: 0.422
Validation loss decreased (inf --> -0.421857).  Saving model ...
Epoch: 2 cost time: 9.837111234664917
Epoch: 2, Steps: 67 | Train Loss: 2.426 Vali Loss: 2.880 Vali Acc: 0.618 Test Loss: 2.880 Test Acc: 0.618
Validation loss decreased (-0.421857 --> -0.618468).  Saving model ...
Epoch: 3 cost time: 9.929928064346313
Epoch: 3, Steps: 67 | Train Loss: 0.271 Vali Loss: 3.377 Vali Acc: 0.757 Test Loss: 3.377 Test Acc: 0.757
Validation loss decreased (-0.618468 --> -0.757192).  Saving model ...
Epoch: 4 cost time: 10.14934229850769
Epoch: 4, Steps: 67 | Train Loss: 0.532 Vali Loss: 1.605 Vali Acc: 0.815 Test Loss: 1.605 Test Acc: 0.815
Validation loss decreased (-0.757192 --> -0.815013).  Saving model ...
Epoch: 5 cost time: 10.165021896362305
Epoch: 5, Steps: 67 | Train Loss: 0.424 Vali Loss: 5.617 Vali Acc: 0.751 Test Loss: 5.617 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.039728879928589
Epoch: 6, Steps: 67 | Train Loss: 0.923 Vali Loss: 2.454 Vali Acc: 0.751 Test Loss: 2.454 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.312047004699707
Epoch: 7, Steps: 67 | Train Loss: 1.163 Vali Loss: 7.645 Vali Acc: 0.659 Test Loss: 7.645 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.071043491363525
Epoch: 8, Steps: 67 | Train Loss: 0.770 Vali Loss: 16.993 Vali Acc: 0.711 Test Loss: 16.993 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.057815074920654
Epoch: 9, Steps: 67 | Train Loss: 0.452 Vali Loss: 9.375 Vali Acc: 0.763 Test Loss: 9.375 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.972367286682129
Epoch: 10, Steps: 67 | Train Loss: 0.137 Vali Loss: 4.282 Vali Acc: 0.798 Test Loss: 4.282 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.071224689483643
Epoch: 11, Steps: 67 | Train Loss: 0.158 Vali Loss: 5.732 Vali Acc: 0.815 Test Loss: 5.732 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.133449077606201
Epoch: 12, Steps: 67 | Train Loss: 0.206 Vali Loss: 5.294 Vali Acc: 0.775 Test Loss: 5.294 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.038628578186035
Epoch: 13, Steps: 67 | Train Loss: 0.251 Vali Loss: 6.431 Vali Acc: 0.751 Test Loss: 6.431 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.92865538597107
Epoch: 14, Steps: 67 | Train Loss: 0.825 Vali Loss: 38.942 Vali Acc: 0.376 Test Loss: 38.942 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 11518855
model size : 46.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.8913414478302
Epoch: 1, Steps: 67 | Train Loss: 13.263 Vali Loss: 9.199 Vali Acc: 0.474 Test Loss: 9.199 Test Acc: 0.474
Validation loss decreased (inf --> -0.473896).  Saving model ...
Epoch: 2 cost time: 7.540016174316406
Epoch: 2, Steps: 67 | Train Loss: 2.269 Vali Loss: 1.953 Vali Acc: 0.699 Test Loss: 1.953 Test Acc: 0.699
Validation loss decreased (-0.473896 --> -0.699402).  Saving model ...
Epoch: 3 cost time: 7.664219379425049
Epoch: 3, Steps: 67 | Train Loss: 0.638 Vali Loss: 7.235 Vali Acc: 0.549 Test Loss: 7.235 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.60503888130188
Epoch: 4, Steps: 67 | Train Loss: 0.712 Vali Loss: 2.580 Vali Acc: 0.763 Test Loss: 2.580 Test Acc: 0.763
Validation loss decreased (-0.699402 --> -0.762980).  Saving model ...
Epoch: 5 cost time: 7.600101709365845
Epoch: 5, Steps: 67 | Train Loss: 0.252 Vali Loss: 3.777 Vali Acc: 0.723 Test Loss: 3.777 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.837435960769653
Epoch: 6, Steps: 67 | Train Loss: 0.467 Vali Loss: 4.479 Vali Acc: 0.746 Test Loss: 4.479 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.670830965042114
Epoch: 7, Steps: 67 | Train Loss: 0.269 Vali Loss: 2.974 Vali Acc: 0.763 Test Loss: 2.974 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.700238466262817
Epoch: 8, Steps: 67 | Train Loss: 0.156 Vali Loss: 4.075 Vali Acc: 0.803 Test Loss: 4.075 Test Acc: 0.803
Validation loss decreased (-0.762980 --> -0.803427).  Saving model ...
Epoch: 9 cost time: 7.8478312492370605
Epoch: 9, Steps: 67 | Train Loss: 0.434 Vali Loss: 7.983 Vali Acc: 0.682 Test Loss: 7.983 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.67684006690979
Epoch: 10, Steps: 67 | Train Loss: 0.869 Vali Loss: 26.511 Vali Acc: 0.497 Test Loss: 26.511 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.954815864562988
Epoch: 11, Steps: 67 | Train Loss: 0.279 Vali Loss: 3.293 Vali Acc: 0.832 Test Loss: 3.293 Test Acc: 0.832
Validation loss decreased (-0.803427 --> -0.832337).  Saving model ...
Epoch: 12 cost time: 7.797938108444214
Epoch: 12, Steps: 67 | Train Loss: 0.170 Vali Loss: 8.546 Vali Acc: 0.653 Test Loss: 8.546 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.900412321090698
Epoch: 13, Steps: 67 | Train Loss: 0.387 Vali Loss: 18.981 Vali Acc: 0.613 Test Loss: 18.981 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.992105960845947
Epoch: 14, Steps: 67 | Train Loss: 0.126 Vali Loss: 54.465 Vali Acc: 0.410 Test Loss: 54.465 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.92539119720459
Epoch: 15, Steps: 67 | Train Loss: 1.164 Vali Loss: 29.946 Vali Acc: 0.416 Test Loss: 29.946 Test Acc: 0.416
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.735209226608276
Epoch: 16, Steps: 67 | Train Loss: 1.042 Vali Loss: 14.853 Vali Acc: 0.642 Test Loss: 14.853 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.820939302444458
Epoch: 17, Steps: 67 | Train Loss: 0.463 Vali Loss: 26.333 Vali Acc: 0.543 Test Loss: 26.333 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.694360733032227
Epoch: 18, Steps: 67 | Train Loss: 0.272 Vali Loss: 45.055 Vali Acc: 0.364 Test Loss: 45.055 Test Acc: 0.364
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.892283201217651
Epoch: 19, Steps: 67 | Train Loss: 0.095 Vali Loss: 48.688 Vali Acc: 0.439 Test Loss: 48.688 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.923914432525635
Epoch: 20, Steps: 67 | Train Loss: 0.357 Vali Loss: 55.421 Vali Acc: 0.434 Test Loss: 55.421 Test Acc: 0.434
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.774288892745972
Epoch: 21, Steps: 67 | Train Loss: 1.222 Vali Loss: 319.366 Vali Acc: 0.121 Test Loss: 319.366 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 8068359
model size : 33.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.105238676071167
Epoch: 1, Steps: 67 | Train Loss: 13.684 Vali Loss: 11.809 Vali Acc: 0.497 Test Loss: 11.809 Test Acc: 0.497
Validation loss decreased (inf --> -0.496992).  Saving model ...
Epoch: 2 cost time: 6.6300108432769775
Epoch: 2, Steps: 67 | Train Loss: 2.056 Vali Loss: 1.071 Vali Acc: 0.711 Test Loss: 1.071 Test Acc: 0.711
Validation loss decreased (-0.496992 --> -0.710972).  Saving model ...
Epoch: 3 cost time: 6.607522964477539
Epoch: 3, Steps: 67 | Train Loss: 0.348 Vali Loss: 2.449 Vali Acc: 0.769 Test Loss: 2.449 Test Acc: 0.769
Validation loss decreased (-0.710972 --> -0.768762).  Saving model ...
Epoch: 4 cost time: 6.603429079055786
Epoch: 4, Steps: 67 | Train Loss: 0.390 Vali Loss: 2.292 Vali Acc: 0.792 Test Loss: 2.292 Test Acc: 0.792
Validation loss decreased (-0.768762 --> -0.791885).  Saving model ...
Epoch: 5 cost time: 6.52677059173584
Epoch: 5, Steps: 67 | Train Loss: 0.465 Vali Loss: 3.261 Vali Acc: 0.798 Test Loss: 3.261 Test Acc: 0.798
Validation loss decreased (-0.791885 --> -0.797655).  Saving model ...
Epoch: 6 cost time: 6.622560501098633
Epoch: 6, Steps: 67 | Train Loss: 0.569 Vali Loss: 3.545 Vali Acc: 0.775 Test Loss: 3.545 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.650058031082153
Epoch: 7, Steps: 67 | Train Loss: 0.334 Vali Loss: 2.563 Vali Acc: 0.705 Test Loss: 2.563 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.658854961395264
Epoch: 8, Steps: 67 | Train Loss: 0.363 Vali Loss: 10.418 Vali Acc: 0.532 Test Loss: 10.418 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.61637806892395
Epoch: 9, Steps: 67 | Train Loss: 0.781 Vali Loss: 9.306 Vali Acc: 0.647 Test Loss: 9.306 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.6793553829193115
Epoch: 10, Steps: 67 | Train Loss: 0.075 Vali Loss: 12.267 Vali Acc: 0.590 Test Loss: 12.267 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.661442041397095
Epoch: 11, Steps: 67 | Train Loss: 0.192 Vali Loss: 5.975 Vali Acc: 0.769 Test Loss: 5.975 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.694039821624756
Epoch: 12, Steps: 67 | Train Loss: 0.160 Vali Loss: 3.543 Vali Acc: 0.792 Test Loss: 3.543 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.818392515182495
Epoch: 13, Steps: 67 | Train Loss: 0.282 Vali Loss: 14.193 Vali Acc: 0.532 Test Loss: 14.193 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.615465879440308
Epoch: 14, Steps: 67 | Train Loss: 0.684 Vali Loss: 59.920 Vali Acc: 0.289 Test Loss: 59.920 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.6384031772613525
Epoch: 15, Steps: 67 | Train Loss: 0.962 Vali Loss: 36.185 Vali Acc: 0.457 Test Loss: 36.185 Test Acc: 0.457
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 7206407
model size : 29.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 5.6512699
	speed: 0.4477s/iter; left time: 5955.0302s
Epoch: 1 cost time: 59.77490210533142
Epoch: 1, Steps: 134 | Train Loss: 127.661 Vali Loss: 69.136 Vali Acc: 0.145 Test Loss: 69.136 Test Acc: 0.145
Validation loss decreased (inf --> -0.143817).  Saving model ...
	iters: 100, epoch: 2 | loss: 44.0933189
	speed: 0.9122s/iter; left time: 12010.6165s
Epoch: 2 cost time: 59.24084424972534
Epoch: 2, Steps: 134 | Train Loss: 9.714 Vali Loss: 13.796 Vali Acc: 0.416 Test Loss: 13.796 Test Acc: 0.416
Validation loss decreased (-0.143817 --> -0.416047).  Saving model ...
	iters: 100, epoch: 3 | loss: 12.6266422
	speed: 0.9331s/iter; left time: 12161.1478s
Epoch: 3 cost time: 59.22031283378601
Epoch: 3, Steps: 134 | Train Loss: 11.382 Vali Loss: 22.222 Vali Acc: 0.462 Test Loss: 22.222 Test Acc: 0.462
Validation loss decreased (-0.416047 --> -0.462206).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.9317s/iter; left time: 12017.8946s
Epoch: 4 cost time: 59.56049203872681
Epoch: 4, Steps: 134 | Train Loss: 12.532 Vali Loss: 40.593 Vali Acc: 0.503 Test Loss: 40.593 Test Acc: 0.503
Validation loss decreased (-0.462206 --> -0.502484).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.9385s/iter; left time: 11979.7965s
Epoch: 5 cost time: 59.410908699035645
Epoch: 5, Steps: 134 | Train Loss: 7.009 Vali Loss: 15.942 Vali Acc: 0.775 Test Loss: 15.942 Test Acc: 0.775
Validation loss decreased (-0.502484 --> -0.774407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.9335s/iter; left time: 11791.2483s
Epoch: 6 cost time: 59.076719522476196
Epoch: 6, Steps: 134 | Train Loss: 6.019 Vali Loss: 15.740 Vali Acc: 0.775 Test Loss: 15.740 Test Acc: 0.775
Validation loss decreased (-0.774407 --> -0.774409).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.9320s/iter; left time: 11646.7411s
Epoch: 7 cost time: 59.239569664001465
Epoch: 7, Steps: 134 | Train Loss: 4.698 Vali Loss: 52.238 Vali Acc: 0.676 Test Loss: 52.238 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 14.6475525
	speed: 0.9116s/iter; left time: 11269.6732s
Epoch: 8 cost time: 59.28441286087036
Epoch: 8, Steps: 134 | Train Loss: 4.643 Vali Loss: 43.246 Vali Acc: 0.659 Test Loss: 43.246 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.9174s/iter; left time: 11218.4831s
Epoch: 9 cost time: 59.893534898757935
Epoch: 9, Steps: 134 | Train Loss: 2.890 Vali Loss: 75.007 Vali Acc: 0.428 Test Loss: 75.007 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.9219s/iter; left time: 11150.0268s
Epoch: 10 cost time: 59.90480828285217
Epoch: 10, Steps: 134 | Train Loss: 2.609 Vali Loss: 97.608 Vali Acc: 0.595 Test Loss: 97.608 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.9187s/iter; left time: 10988.0005s
Epoch: 11 cost time: 59.47110080718994
Epoch: 11, Steps: 134 | Train Loss: 2.934 Vali Loss: 49.512 Vali Acc: 0.699 Test Loss: 49.512 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.9175s/iter; left time: 10851.7356s
Epoch: 12 cost time: 59.796109676361084
Epoch: 12, Steps: 134 | Train Loss: 4.097 Vali Loss: 69.786 Vali Acc: 0.746 Test Loss: 69.786 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.9156s/iter; left time: 10705.8402s
Epoch: 13 cost time: 59.93033766746521
Epoch: 13, Steps: 134 | Train Loss: 0.219 Vali Loss: 66.366 Vali Acc: 0.694 Test Loss: 66.366 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.9201s/iter; left time: 10635.9296s
Epoch: 14 cost time: 59.69787621498108
Epoch: 14, Steps: 134 | Train Loss: 1.676 Vali Loss: 44.150 Vali Acc: 0.647 Test Loss: 44.150 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.9177s/iter; left time: 10484.5675s
Epoch: 15 cost time: 59.58862781524658
Epoch: 15, Steps: 134 | Train Loss: 1.697 Vali Loss: 57.853 Vali Acc: 0.723 Test Loss: 57.853 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.9170s/iter; left time: 10354.3425s
Epoch: 16 cost time: 59.445239543914795
Epoch: 16, Steps: 134 | Train Loss: 4.293 Vali Loss: 55.821 Vali Acc: 0.572 Test Loss: 55.821 Test Acc: 0.572
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 62375239
model size : 240.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 25.453187704086304
Epoch: 1, Steps: 67 | Train Loss: 58.539 Vali Loss: 22.607 Vali Acc: 0.468 Test Loss: 22.607 Test Acc: 0.468
Validation loss decreased (inf --> -0.467982).  Saving model ...
Epoch: 2 cost time: 24.941500186920166
Epoch: 2, Steps: 67 | Train Loss: 5.123 Vali Loss: 6.555 Vali Acc: 0.410 Test Loss: 6.555 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.68287968635559
Epoch: 3, Steps: 67 | Train Loss: 3.758 Vali Loss: 12.504 Vali Acc: 0.451 Test Loss: 12.504 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 24.62748074531555
Epoch: 4, Steps: 67 | Train Loss: 3.256 Vali Loss: 5.256 Vali Acc: 0.653 Test Loss: 5.256 Test Acc: 0.653
Validation loss decreased (-0.467982 --> -0.653127).  Saving model ...
Epoch: 5 cost time: 24.710824966430664
Epoch: 5, Steps: 67 | Train Loss: 1.800 Vali Loss: 6.424 Vali Acc: 0.671 Test Loss: 6.424 Test Acc: 0.671
Validation loss decreased (-0.653127 --> -0.670456).  Saving model ...
Epoch: 6 cost time: 24.89270520210266
Epoch: 6, Steps: 67 | Train Loss: 2.981 Vali Loss: 11.131 Vali Acc: 0.711 Test Loss: 11.131 Test Acc: 0.711
Validation loss decreased (-0.670456 --> -0.710871).  Saving model ...
Epoch: 7 cost time: 24.823992252349854
Epoch: 7, Steps: 67 | Train Loss: 3.614 Vali Loss: 9.060 Vali Acc: 0.630 Test Loss: 9.060 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.16308617591858
Epoch: 8, Steps: 67 | Train Loss: 1.488 Vali Loss: 14.698 Vali Acc: 0.699 Test Loss: 14.698 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 25.033504962921143
Epoch: 9, Steps: 67 | Train Loss: 0.672 Vali Loss: 4.155 Vali Acc: 0.838 Test Loss: 4.155 Test Acc: 0.838
Validation loss decreased (-0.710871 --> -0.838109).  Saving model ...
Epoch: 10 cost time: 24.989418029785156
Epoch: 10, Steps: 67 | Train Loss: 0.505 Vali Loss: 11.545 Vali Acc: 0.734 Test Loss: 11.545 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 25.123310327529907
Epoch: 11, Steps: 67 | Train Loss: 0.172 Vali Loss: 11.116 Vali Acc: 0.815 Test Loss: 11.116 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 24.927141189575195
Epoch: 12, Steps: 67 | Train Loss: 0.997 Vali Loss: 16.105 Vali Acc: 0.728 Test Loss: 16.105 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 25.151442289352417
Epoch: 13, Steps: 67 | Train Loss: 1.192 Vali Loss: 9.799 Vali Acc: 0.798 Test Loss: 9.799 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 25.243953943252563
Epoch: 14, Steps: 67 | Train Loss: 5.817 Vali Loss: 119.274 Vali Acc: 0.254 Test Loss: 119.274 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 25.175506114959717
Epoch: 15, Steps: 67 | Train Loss: 4.263 Vali Loss: 11.096 Vali Acc: 0.688 Test Loss: 11.096 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 25.170870542526245
Epoch: 16, Steps: 67 | Train Loss: 2.406 Vali Loss: 17.758 Vali Acc: 0.728 Test Loss: 17.758 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 25.18527626991272
Epoch: 17, Steps: 67 | Train Loss: 1.156 Vali Loss: 20.000 Vali Acc: 0.740 Test Loss: 20.000 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 25.066205739974976
Epoch: 18, Steps: 67 | Train Loss: 0.319 Vali Loss: 19.144 Vali Acc: 0.769 Test Loss: 19.144 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 25.1176176071167
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 18.640 Vali Acc: 0.809 Test Loss: 18.640 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 31313223
model size : 121.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.10347890853882
Epoch: 1, Steps: 67 | Train Loss: 26.369 Vali Loss: 14.797 Vali Acc: 0.480 Test Loss: 14.797 Test Acc: 0.480
Validation loss decreased (inf --> -0.479621).  Saving model ...
Epoch: 2 cost time: 15.068193197250366
Epoch: 2, Steps: 67 | Train Loss: 5.607 Vali Loss: 2.726 Vali Acc: 0.457 Test Loss: 2.726 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.3310227394104
Epoch: 3, Steps: 67 | Train Loss: 1.322 Vali Loss: 7.507 Vali Acc: 0.590 Test Loss: 7.507 Test Acc: 0.590
Validation loss decreased (-0.479621 --> -0.589520).  Saving model ...
Epoch: 4 cost time: 15.187601089477539
Epoch: 4, Steps: 67 | Train Loss: 2.607 Vali Loss: 4.969 Vali Acc: 0.624 Test Loss: 4.969 Test Acc: 0.624
Validation loss decreased (-0.589520 --> -0.624228).  Saving model ...
Epoch: 5 cost time: 15.31486964225769
Epoch: 5, Steps: 67 | Train Loss: 1.453 Vali Loss: 2.857 Vali Acc: 0.763 Test Loss: 2.857 Test Acc: 0.763
Validation loss decreased (-0.624228 --> -0.762977).  Saving model ...
Epoch: 6 cost time: 15.12565302848816
Epoch: 6, Steps: 67 | Train Loss: 0.747 Vali Loss: 5.678 Vali Acc: 0.763 Test Loss: 5.678 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.323879718780518
Epoch: 7, Steps: 67 | Train Loss: 1.699 Vali Loss: 5.371 Vali Acc: 0.728 Test Loss: 5.371 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.284074783325195
Epoch: 8, Steps: 67 | Train Loss: 0.948 Vali Loss: 10.940 Vali Acc: 0.601 Test Loss: 10.940 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 15.254368543624878
Epoch: 9, Steps: 67 | Train Loss: 0.388 Vali Loss: 26.642 Vali Acc: 0.694 Test Loss: 26.642 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 15.351908445358276
Epoch: 10, Steps: 67 | Train Loss: 1.479 Vali Loss: 5.608 Vali Acc: 0.809 Test Loss: 5.608 Test Acc: 0.809
Validation loss decreased (-0.762977 --> -0.809192).  Saving model ...
Epoch: 11 cost time: 15.136584758758545
Epoch: 11, Steps: 67 | Train Loss: 1.195 Vali Loss: 11.014 Vali Acc: 0.728 Test Loss: 11.014 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.190012216567993
Epoch: 12, Steps: 67 | Train Loss: 1.021 Vali Loss: 25.064 Vali Acc: 0.601 Test Loss: 25.064 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.486526012420654
Epoch: 13, Steps: 67 | Train Loss: 0.871 Vali Loss: 24.500 Vali Acc: 0.734 Test Loss: 24.500 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.419191837310791
Epoch: 14, Steps: 67 | Train Loss: 1.515 Vali Loss: 15.103 Vali Acc: 0.786 Test Loss: 15.103 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.13858675956726
Epoch: 15, Steps: 67 | Train Loss: 1.246 Vali Loss: 18.355 Vali Acc: 0.786 Test Loss: 18.355 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.185033321380615
Epoch: 16, Steps: 67 | Train Loss: 0.758 Vali Loss: 23.860 Vali Acc: 0.676 Test Loss: 23.860 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.322913408279419
Epoch: 17, Steps: 67 | Train Loss: 0.165 Vali Loss: 25.136 Vali Acc: 0.786 Test Loss: 25.136 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 15.475095987319946
Epoch: 18, Steps: 67 | Train Loss: 0.864 Vali Loss: 20.501 Vali Acc: 0.723 Test Loss: 20.501 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.119911193847656
Epoch: 19, Steps: 67 | Train Loss: 0.030 Vali Loss: 25.349 Vali Acc: 0.775 Test Loss: 25.349 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.068497657775879
Epoch: 20, Steps: 67 | Train Loss: 0.592 Vali Loss: 25.106 Vali Acc: 0.642 Test Loss: 25.106 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 20959431
model size : 82.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.139977931976318
Epoch: 1, Steps: 67 | Train Loss: 26.489 Vali Loss: 11.408 Vali Acc: 0.486 Test Loss: 11.408 Test Acc: 0.486
Validation loss decreased (inf --> -0.485435).  Saving model ...
Epoch: 2 cost time: 12.817337989807129
Epoch: 2, Steps: 67 | Train Loss: 6.550 Vali Loss: 2.067 Vali Acc: 0.578 Test Loss: 2.067 Test Acc: 0.578
Validation loss decreased (-0.485435 --> -0.578014).  Saving model ...
Epoch: 3 cost time: 12.999054193496704
Epoch: 3, Steps: 67 | Train Loss: 1.576 Vali Loss: 1.424 Vali Acc: 0.751 Test Loss: 1.424 Test Acc: 0.751
Validation loss decreased (-0.578014 --> -0.751431).  Saving model ...
Epoch: 4 cost time: 13.24709177017212
Epoch: 4, Steps: 67 | Train Loss: 1.418 Vali Loss: 6.598 Vali Acc: 0.590 Test Loss: 6.598 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.089829444885254
Epoch: 5, Steps: 67 | Train Loss: 0.837 Vali Loss: 6.618 Vali Acc: 0.647 Test Loss: 6.618 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.09342074394226
Epoch: 6, Steps: 67 | Train Loss: 0.416 Vali Loss: 9.043 Vali Acc: 0.751 Test Loss: 9.043 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.105967998504639
Epoch: 7, Steps: 67 | Train Loss: 0.784 Vali Loss: 12.358 Vali Acc: 0.624 Test Loss: 12.358 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.892370223999023
Epoch: 8, Steps: 67 | Train Loss: 0.809 Vali Loss: 5.661 Vali Acc: 0.676 Test Loss: 5.661 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.958500146865845
Epoch: 9, Steps: 67 | Train Loss: 0.435 Vali Loss: 5.834 Vali Acc: 0.705 Test Loss: 5.834 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.962898015975952
Epoch: 10, Steps: 67 | Train Loss: 1.381 Vali Loss: 4.976 Vali Acc: 0.792 Test Loss: 4.976 Test Acc: 0.792
Validation loss decreased (-0.751431 --> -0.791858).  Saving model ...
Epoch: 11 cost time: 13.08301305770874
Epoch: 11, Steps: 67 | Train Loss: 1.425 Vali Loss: 6.475 Vali Acc: 0.642 Test Loss: 6.475 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.896254062652588
Epoch: 12, Steps: 67 | Train Loss: 0.850 Vali Loss: 15.901 Vali Acc: 0.659 Test Loss: 15.901 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.987910747528076
Epoch: 13, Steps: 67 | Train Loss: 1.026 Vali Loss: 38.972 Vali Acc: 0.520 Test Loss: 38.972 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.11091661453247
Epoch: 14, Steps: 67 | Train Loss: 0.733 Vali Loss: 41.462 Vali Acc: 0.503 Test Loss: 41.462 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.060401916503906
Epoch: 15, Steps: 67 | Train Loss: 0.244 Vali Loss: 18.885 Vali Acc: 0.769 Test Loss: 18.885 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.140247344970703
Epoch: 16, Steps: 67 | Train Loss: 0.839 Vali Loss: 18.258 Vali Acc: 0.751 Test Loss: 18.258 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.066245794296265
Epoch: 17, Steps: 67 | Train Loss: 0.310 Vali Loss: 10.941 Vali Acc: 0.763 Test Loss: 10.941 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 12.90265440940857
Epoch: 18, Steps: 67 | Train Loss: 0.363 Vali Loss: 11.035 Vali Acc: 0.723 Test Loss: 11.035 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.060982704162598
Epoch: 19, Steps: 67 | Train Loss: 0.033 Vali Loss: 41.758 Vali Acc: 0.451 Test Loss: 41.758 Test Acc: 0.451
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.037140846252441
Epoch: 20, Steps: 67 | Train Loss: 0.565 Vali Loss: 18.786 Vali Acc: 0.688 Test Loss: 18.786 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 15782855
model size : 62.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.668377161026001
Epoch: 1, Steps: 67 | Train Loss: 15.332 Vali Loss: 12.780 Vali Acc: 0.538 Test Loss: 12.780 Test Acc: 0.538
Validation loss decreased (inf --> -0.537444).  Saving model ...
Epoch: 2 cost time: 9.33165979385376
Epoch: 2, Steps: 67 | Train Loss: 4.257 Vali Loss: 3.884 Vali Acc: 0.306 Test Loss: 3.884 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.432991981506348
Epoch: 3, Steps: 67 | Train Loss: 1.335 Vali Loss: 3.659 Vali Acc: 0.688 Test Loss: 3.659 Test Acc: 0.688
Validation loss decreased (-0.537444 --> -0.687825).  Saving model ...
Epoch: 4 cost time: 9.416343927383423
Epoch: 4, Steps: 67 | Train Loss: 1.302 Vali Loss: 4.321 Vali Acc: 0.653 Test Loss: 4.321 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.474485397338867
Epoch: 5, Steps: 67 | Train Loss: 0.494 Vali Loss: 7.579 Vali Acc: 0.595 Test Loss: 7.579 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.598366260528564
Epoch: 6, Steps: 67 | Train Loss: 0.894 Vali Loss: 9.048 Vali Acc: 0.746 Test Loss: 9.048 Test Acc: 0.746
Validation loss decreased (-0.687825 --> -0.745574).  Saving model ...
Epoch: 7 cost time: 9.667469263076782
Epoch: 7, Steps: 67 | Train Loss: 0.551 Vali Loss: 5.233 Vali Acc: 0.775 Test Loss: 5.233 Test Acc: 0.775
Validation loss decreased (-0.745574 --> -0.774514).  Saving model ...
Epoch: 8 cost time: 9.598695993423462
Epoch: 8, Steps: 67 | Train Loss: 1.573 Vali Loss: 6.087 Vali Acc: 0.728 Test Loss: 6.087 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.460791826248169
Epoch: 9, Steps: 67 | Train Loss: 0.360 Vali Loss: 6.432 Vali Acc: 0.786 Test Loss: 6.432 Test Acc: 0.786
Validation loss decreased (-0.774514 --> -0.786063).  Saving model ...
Epoch: 10 cost time: 9.627953052520752
Epoch: 10, Steps: 67 | Train Loss: 0.448 Vali Loss: 6.320 Vali Acc: 0.705 Test Loss: 6.320 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.552922010421753
Epoch: 11, Steps: 67 | Train Loss: 0.131 Vali Loss: 6.042 Vali Acc: 0.809 Test Loss: 6.042 Test Acc: 0.809
Validation loss decreased (-0.786063 --> -0.809188).  Saving model ...
Epoch: 12 cost time: 9.59984827041626
Epoch: 12, Steps: 67 | Train Loss: 0.530 Vali Loss: 6.790 Vali Acc: 0.705 Test Loss: 6.790 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.689320802688599
Epoch: 13, Steps: 67 | Train Loss: 0.176 Vali Loss: 5.107 Vali Acc: 0.821 Test Loss: 5.107 Test Acc: 0.821
Validation loss decreased (-0.809188 --> -0.820758).  Saving model ...
Epoch: 14 cost time: 9.57057785987854
Epoch: 14, Steps: 67 | Train Loss: 0.364 Vali Loss: 13.798 Vali Acc: 0.740 Test Loss: 13.798 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.427812337875366
Epoch: 15, Steps: 67 | Train Loss: 0.307 Vali Loss: 12.644 Vali Acc: 0.682 Test Loss: 12.644 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.576016426086426
Epoch: 16, Steps: 67 | Train Loss: 0.409 Vali Loss: 16.398 Vali Acc: 0.728 Test Loss: 16.398 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.642614364624023
Epoch: 17, Steps: 67 | Train Loss: 1.143 Vali Loss: 97.106 Vali Acc: 0.341 Test Loss: 97.106 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.478065490722656
Epoch: 18, Steps: 67 | Train Loss: 3.307 Vali Loss: 53.883 Vali Acc: 0.347 Test Loss: 53.883 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.668737411499023
Epoch: 19, Steps: 67 | Train Loss: 1.651 Vali Loss: 45.330 Vali Acc: 0.399 Test Loss: 45.330 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.520676851272583
Epoch: 20, Steps: 67 | Train Loss: 2.379 Vali Loss: 92.250 Vali Acc: 0.393 Test Loss: 92.250 Test Acc: 0.393
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.745008707046509
Epoch: 21, Steps: 67 | Train Loss: 0.818 Vali Loss: 37.902 Vali Acc: 0.630 Test Loss: 37.902 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.475214958190918
Epoch: 22, Steps: 67 | Train Loss: 1.355 Vali Loss: 17.983 Vali Acc: 0.780 Test Loss: 17.983 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.640100240707397
Epoch: 23, Steps: 67 | Train Loss: 0.800 Vali Loss: 23.289 Vali Acc: 0.786 Test Loss: 23.289 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 11469511
model size : 46.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.627958059310913
Epoch: 1, Steps: 67 | Train Loss: 14.704 Vali Loss: 11.989 Vali Acc: 0.503 Test Loss: 11.989 Test Acc: 0.503
Validation loss decreased (inf --> -0.502770).  Saving model ...
Epoch: 2 cost time: 7.206670761108398
Epoch: 2, Steps: 67 | Train Loss: 4.461 Vali Loss: 1.448 Vali Acc: 0.636 Test Loss: 1.448 Test Acc: 0.636
Validation loss decreased (-0.502770 --> -0.635824).  Saving model ...
Epoch: 3 cost time: 7.195882558822632
Epoch: 3, Steps: 67 | Train Loss: 0.392 Vali Loss: 2.790 Vali Acc: 0.740 Test Loss: 2.790 Test Acc: 0.740
Validation loss decreased (-0.635824 --> -0.739856).  Saving model ...
Epoch: 4 cost time: 7.223559617996216
Epoch: 4, Steps: 67 | Train Loss: 0.599 Vali Loss: 4.813 Vali Acc: 0.757 Test Loss: 4.813 Test Acc: 0.757
Validation loss decreased (-0.739856 --> -0.757177).  Saving model ...
Epoch: 5 cost time: 7.168573617935181
Epoch: 5, Steps: 67 | Train Loss: 0.678 Vali Loss: 3.311 Vali Acc: 0.740 Test Loss: 3.311 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.387922286987305
Epoch: 6, Steps: 67 | Train Loss: 0.352 Vali Loss: 6.637 Vali Acc: 0.618 Test Loss: 6.637 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.38061785697937
Epoch: 7, Steps: 67 | Train Loss: 0.765 Vali Loss: 4.899 Vali Acc: 0.647 Test Loss: 4.899 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.383420944213867
Epoch: 8, Steps: 67 | Train Loss: 0.352 Vali Loss: 66.324 Vali Acc: 0.208 Test Loss: 66.324 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.412882328033447
Epoch: 9, Steps: 67 | Train Loss: 0.572 Vali Loss: 8.883 Vali Acc: 0.734 Test Loss: 8.883 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.380826234817505
Epoch: 10, Steps: 67 | Train Loss: 0.321 Vali Loss: 7.017 Vali Acc: 0.786 Test Loss: 7.017 Test Acc: 0.786
Validation loss decreased (-0.757177 --> -0.786057).  Saving model ...
Epoch: 11 cost time: 7.4705870151519775
Epoch: 11, Steps: 67 | Train Loss: 0.180 Vali Loss: 4.135 Vali Acc: 0.775 Test Loss: 4.135 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.342894077301025
Epoch: 12, Steps: 67 | Train Loss: 0.240 Vali Loss: 3.012 Vali Acc: 0.815 Test Loss: 3.012 Test Acc: 0.815
Validation loss decreased (-0.786057 --> -0.814999).  Saving model ...
Epoch: 13 cost time: 7.308386325836182
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.748 Vali Acc: 0.809 Test Loss: 5.748 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.3026123046875
Epoch: 14, Steps: 67 | Train Loss: 0.617 Vali Loss: 10.524 Vali Acc: 0.757 Test Loss: 10.524 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.457691431045532
Epoch: 15, Steps: 67 | Train Loss: 0.984 Vali Loss: 8.955 Vali Acc: 0.584 Test Loss: 8.955 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.334183931350708
Epoch: 16, Steps: 67 | Train Loss: 1.456 Vali Loss: 69.978 Vali Acc: 0.220 Test Loss: 69.978 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.3645851612091064
Epoch: 17, Steps: 67 | Train Loss: 0.434 Vali Loss: 18.636 Vali Acc: 0.607 Test Loss: 18.636 Test Acc: 0.607
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.48631739616394
Epoch: 18, Steps: 67 | Train Loss: 0.620 Vali Loss: 34.381 Vali Acc: 0.514 Test Loss: 34.381 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.450971841812134
Epoch: 19, Steps: 67 | Train Loss: 0.735 Vali Loss: 11.898 Vali Acc: 0.642 Test Loss: 11.898 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.498730421066284
Epoch: 20, Steps: 67 | Train Loss: 0.760 Vali Loss: 65.667 Vali Acc: 0.480 Test Loss: 65.667 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.524631500244141
Epoch: 21, Steps: 67 | Train Loss: 1.233 Vali Loss: 12.129 Vali Acc: 0.688 Test Loss: 12.129 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.4269492626190186
Epoch: 22, Steps: 67 | Train Loss: 0.365 Vali Loss: 36.501 Vali Acc: 0.705 Test Loss: 36.501 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 8019015
model size : 33.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.632268667221069
Epoch: 1, Steps: 67 | Train Loss: 12.364 Vali Loss: 11.016 Vali Acc: 0.497 Test Loss: 11.016 Test Acc: 0.497
Validation loss decreased (inf --> -0.497000).  Saving model ...
Epoch: 2 cost time: 6.2656543254852295
Epoch: 2, Steps: 67 | Train Loss: 2.936 Vali Loss: 1.138 Vali Acc: 0.688 Test Loss: 1.138 Test Acc: 0.688
Validation loss decreased (-0.497000 --> -0.687850).  Saving model ...
Epoch: 3 cost time: 6.3790013790130615
Epoch: 3, Steps: 67 | Train Loss: 0.767 Vali Loss: 3.469 Vali Acc: 0.734 Test Loss: 3.469 Test Acc: 0.734
Validation loss decreased (-0.687850 --> -0.734069).  Saving model ...
Epoch: 4 cost time: 6.361356496810913
Epoch: 4, Steps: 67 | Train Loss: 1.143 Vali Loss: 4.840 Vali Acc: 0.740 Test Loss: 4.840 Test Acc: 0.740
Validation loss decreased (-0.734069 --> -0.739836).  Saving model ...
Epoch: 5 cost time: 6.424184799194336
Epoch: 5, Steps: 67 | Train Loss: 0.540 Vali Loss: 2.268 Vali Acc: 0.803 Test Loss: 2.268 Test Acc: 0.803
Validation loss decreased (-0.739836 --> -0.803446).  Saving model ...
Epoch: 6 cost time: 6.257680177688599
Epoch: 6, Steps: 67 | Train Loss: 0.750 Vali Loss: 7.368 Vali Acc: 0.665 Test Loss: 7.368 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.387920618057251
Epoch: 7, Steps: 67 | Train Loss: 0.204 Vali Loss: 3.952 Vali Acc: 0.694 Test Loss: 3.952 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.338655233383179
Epoch: 8, Steps: 67 | Train Loss: 0.455 Vali Loss: 6.484 Vali Acc: 0.711 Test Loss: 6.484 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.318480014801025
Epoch: 9, Steps: 67 | Train Loss: 0.314 Vali Loss: 43.578 Vali Acc: 0.462 Test Loss: 43.578 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.321686506271362
Epoch: 10, Steps: 67 | Train Loss: 0.187 Vali Loss: 5.391 Vali Acc: 0.728 Test Loss: 5.391 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.298326253890991
Epoch: 11, Steps: 67 | Train Loss: 0.573 Vali Loss: 18.564 Vali Acc: 0.578 Test Loss: 18.564 Test Acc: 0.578
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.210041046142578
Epoch: 12, Steps: 67 | Train Loss: 0.500 Vali Loss: 9.957 Vali Acc: 0.723 Test Loss: 9.957 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.332881927490234
Epoch: 13, Steps: 67 | Train Loss: 0.642 Vali Loss: 6.170 Vali Acc: 0.717 Test Loss: 6.170 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.288188457489014
Epoch: 14, Steps: 67 | Train Loss: 0.076 Vali Loss: 8.197 Vali Acc: 0.746 Test Loss: 8.197 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.189635276794434
Epoch: 15, Steps: 67 | Train Loss: 0.166 Vali Loss: 62.447 Vali Acc: 0.324 Test Loss: 62.447 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 7157063
model size : 29.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 82.3732452
	speed: 0.4188s/iter; left time: 5570.2904s
Epoch: 1 cost time: 55.80654859542847
Epoch: 1, Steps: 134 | Train Loss: 101.007 Vali Loss: 15.087 Vali Acc: 0.370 Test Loss: 15.087 Test Acc: 0.370
Validation loss decreased (inf --> -0.369791).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5598717
	speed: 0.8089s/iter; left time: 10650.9086s
Epoch: 2 cost time: 55.13908576965332
Epoch: 2, Steps: 134 | Train Loss: 3.746 Vali Loss: 8.162 Vali Acc: 0.520 Test Loss: 8.162 Test Acc: 0.520
Validation loss decreased (-0.369791 --> -0.520150).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.8109s/iter; left time: 10568.0402s
Epoch: 3 cost time: 55.10505819320679
Epoch: 3, Steps: 134 | Train Loss: 3.062 Vali Loss: 5.300 Vali Acc: 0.711 Test Loss: 5.300 Test Acc: 0.711
Validation loss decreased (-0.520150 --> -0.710930).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1234974
	speed: 0.8171s/iter; left time: 10540.3408s
Epoch: 4 cost time: 55.15286087989807
Epoch: 4, Steps: 134 | Train Loss: 1.362 Vali Loss: 9.553 Vali Acc: 0.653 Test Loss: 9.553 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.8049s/iter; left time: 10275.1664s
Epoch: 5 cost time: 55.19338917732239
Epoch: 5, Steps: 134 | Train Loss: 3.789 Vali Loss: 15.768 Vali Acc: 0.613 Test Loss: 15.768 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.8071s/iter; left time: 10193.9856s
Epoch: 6 cost time: 55.197465658187866
Epoch: 6, Steps: 134 | Train Loss: 2.024 Vali Loss: 13.731 Vali Acc: 0.786 Test Loss: 13.731 Test Acc: 0.786
Validation loss decreased (-0.710930 --> -0.785990).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.8171s/iter; left time: 10210.6868s
Epoch: 7 cost time: 55.17501163482666
Epoch: 7, Steps: 134 | Train Loss: 2.554 Vali Loss: 6.508 Vali Acc: 0.803 Test Loss: 6.508 Test Acc: 0.803
Validation loss decreased (-0.785990 --> -0.803403).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.8193s/iter; left time: 10128.4257s
Epoch: 8 cost time: 55.104825258255005
Epoch: 8, Steps: 134 | Train Loss: 5.163 Vali Loss: 8.634 Vali Acc: 0.763 Test Loss: 8.634 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.8008s/iter; left time: 9792.5051s
Epoch: 9 cost time: 55.154930114746094
Epoch: 9, Steps: 134 | Train Loss: 1.422 Vali Loss: 11.010 Vali Acc: 0.803 Test Loss: 11.010 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.8013s/iter; left time: 9691.5055s
Epoch: 10 cost time: 55.156920194625854
Epoch: 10, Steps: 134 | Train Loss: 0.339 Vali Loss: 11.921 Vali Acc: 0.746 Test Loss: 11.921 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.8063s/iter; left time: 9644.2396s
Epoch: 11 cost time: 55.38609433174133
Epoch: 11, Steps: 134 | Train Loss: 1.310 Vali Loss: 52.083 Vali Acc: 0.717 Test Loss: 52.083 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.8067s/iter; left time: 9540.8470s
Epoch: 12 cost time: 55.17280888557434
Epoch: 12, Steps: 134 | Train Loss: 1.297 Vali Loss: 70.145 Vali Acc: 0.595 Test Loss: 70.145 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.8050s/iter; left time: 9412.6650s
Epoch: 13 cost time: 55.02329969406128
Epoch: 13, Steps: 134 | Train Loss: 1.308 Vali Loss: 35.075 Vali Acc: 0.665 Test Loss: 35.075 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.8007s/iter; left time: 9254.9451s
Epoch: 14 cost time: 55.0012629032135
Epoch: 14, Steps: 134 | Train Loss: 0.580 Vali Loss: 20.258 Vali Acc: 0.763 Test Loss: 20.258 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7989s/iter; left time: 9126.9259s
Epoch: 15 cost time: 55.1230947971344
Epoch: 15, Steps: 134 | Train Loss: 1.722 Vali Loss: 18.689 Vali Acc: 0.827 Test Loss: 18.689 Test Acc: 0.827
Validation loss decreased (-0.803403 --> -0.826403).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.8131s/iter; left time: 9180.8654s
Epoch: 16 cost time: 54.92747163772583
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.596 Vali Acc: 0.815 Test Loss: 18.596 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7991s/iter; left time: 8915.8525s
Epoch: 17 cost time: 55.07912230491638
Epoch: 17, Steps: 134 | Train Loss: 0.938 Vali Loss: 37.531 Vali Acc: 0.676 Test Loss: 37.531 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 4.9934883
	speed: 0.8002s/iter; left time: 8820.7143s
Epoch: 18 cost time: 55.090425968170166
Epoch: 18, Steps: 134 | Train Loss: 3.582 Vali Loss: 104.184 Vali Acc: 0.387 Test Loss: 104.184 Test Acc: 0.387
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.8015s/iter; left time: 8727.6174s
Epoch: 19 cost time: 55.03734827041626
Epoch: 19, Steps: 134 | Train Loss: 1.115 Vali Loss: 450.385 Vali Acc: 0.150 Test Loss: 450.385 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 16.2217331
	speed: 0.7981s/iter; left time: 8583.2125s
Epoch: 20 cost time: 54.9919548034668
Epoch: 20, Steps: 134 | Train Loss: 6.607 Vali Loss: 140.982 Vali Acc: 0.486 Test Loss: 140.982 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.8005s/iter; left time: 8502.4028s
Epoch: 21 cost time: 55.10609245300293
Epoch: 21, Steps: 134 | Train Loss: 3.858 Vali Loss: 204.070 Vali Acc: 0.341 Test Loss: 204.070 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.8006s/iter; left time: 8396.2294s
Epoch: 22 cost time: 54.98317885398865
Epoch: 22, Steps: 134 | Train Loss: 0.865 Vali Loss: 41.187 Vali Acc: 0.624 Test Loss: 41.187 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.7989s/iter; left time: 8271.4496s
Epoch: 23 cost time: 55.08014154434204
Epoch: 23, Steps: 134 | Train Loss: 0.306 Vali Loss: 67.119 Vali Acc: 0.676 Test Loss: 67.119 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.8010s/iter; left time: 8185.5813s
Epoch: 24 cost time: 55.09221148490906
Epoch: 24, Steps: 134 | Train Loss: 0.144 Vali Loss: 55.426 Vali Acc: 0.751 Test Loss: 55.426 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.8067s/iter; left time: 8135.2434s
Epoch: 25 cost time: 55.159265756607056
Epoch: 25, Steps: 134 | Train Loss: 0.000 Vali Loss: 55.620 Vali Acc: 0.751 Test Loss: 55.620 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 31212871
model size : 120.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.310836791992188
Epoch: 1, Steps: 67 | Train Loss: 22.510 Vali Loss: 30.554 Vali Acc: 0.422 Test Loss: 30.554 Test Acc: 0.422
Validation loss decreased (inf --> -0.421660).  Saving model ...
Epoch: 2 cost time: 23.530597925186157
Epoch: 2, Steps: 67 | Train Loss: 11.344 Vali Loss: 4.462 Vali Acc: 0.694 Test Loss: 4.462 Test Acc: 0.694
Validation loss decreased (-0.421660 --> -0.693597).  Saving model ...
Epoch: 3 cost time: 23.15417170524597
Epoch: 3, Steps: 67 | Train Loss: 0.838 Vali Loss: 5.342 Vali Acc: 0.659 Test Loss: 5.342 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 23.31633949279785
Epoch: 4, Steps: 67 | Train Loss: 0.447 Vali Loss: 4.899 Vali Acc: 0.734 Test Loss: 4.899 Test Acc: 0.734
Validation loss decreased (-0.693597 --> -0.734055).  Saving model ...
Epoch: 5 cost time: 23.353206157684326
Epoch: 5, Steps: 67 | Train Loss: 0.127 Vali Loss: 5.684 Vali Acc: 0.757 Test Loss: 5.684 Test Acc: 0.757
Validation loss decreased (-0.734055 --> -0.757169).  Saving model ...
Epoch: 6 cost time: 23.429275035858154
Epoch: 6, Steps: 67 | Train Loss: 0.438 Vali Loss: 4.139 Vali Acc: 0.711 Test Loss: 4.139 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 23.326123237609863
Epoch: 7, Steps: 67 | Train Loss: 0.429 Vali Loss: 1.431 Vali Acc: 0.844 Test Loss: 1.431 Test Acc: 0.844
Validation loss decreased (-0.757169 --> -0.843916).  Saving model ...
Epoch: 8 cost time: 23.25679850578308
Epoch: 8, Steps: 67 | Train Loss: 0.678 Vali Loss: 15.867 Vali Acc: 0.717 Test Loss: 15.867 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 23.280147075653076
Epoch: 9, Steps: 67 | Train Loss: 0.927 Vali Loss: 4.919 Vali Acc: 0.775 Test Loss: 4.919 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.286718368530273
Epoch: 10, Steps: 67 | Train Loss: 1.227 Vali Loss: 14.026 Vali Acc: 0.636 Test Loss: 14.026 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.172747373580933
Epoch: 11, Steps: 67 | Train Loss: 2.022 Vali Loss: 11.276 Vali Acc: 0.734 Test Loss: 11.276 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.253625631332397
Epoch: 12, Steps: 67 | Train Loss: 0.608 Vali Loss: 10.617 Vali Acc: 0.775 Test Loss: 10.617 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.115784645080566
Epoch: 13, Steps: 67 | Train Loss: 0.422 Vali Loss: 4.111 Vali Acc: 0.821 Test Loss: 4.111 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 23.46820569038391
Epoch: 14, Steps: 67 | Train Loss: 0.213 Vali Loss: 50.360 Vali Acc: 0.491 Test Loss: 50.360 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 23.239388465881348
Epoch: 15, Steps: 67 | Train Loss: 1.784 Vali Loss: 12.128 Vali Acc: 0.734 Test Loss: 12.128 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 23.53256392478943
Epoch: 16, Steps: 67 | Train Loss: 0.644 Vali Loss: 6.828 Vali Acc: 0.786 Test Loss: 6.828 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.242193460464478
Epoch: 17, Steps: 67 | Train Loss: 0.128 Vali Loss: 50.181 Vali Acc: 0.647 Test Loss: 50.181 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 15681863
model size : 61.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.361782550811768
Epoch: 1, Steps: 67 | Train Loss: 18.319 Vali Loss: 16.421 Vali Acc: 0.572 Test Loss: 16.421 Test Acc: 0.572
Validation loss decreased (inf --> -0.572090).  Saving model ...
Epoch: 2 cost time: 14.17932915687561
Epoch: 2, Steps: 67 | Train Loss: 10.530 Vali Loss: 6.597 Vali Acc: 0.659 Test Loss: 6.597 Test Acc: 0.659
Validation loss decreased (-0.572090 --> -0.658894).  Saving model ...
Epoch: 3 cost time: 14.276078224182129
Epoch: 3, Steps: 67 | Train Loss: 3.469 Vali Loss: 5.337 Vali Acc: 0.746 Test Loss: 5.337 Test Acc: 0.746
Validation loss decreased (-0.658894 --> -0.745611).  Saving model ...
Epoch: 4 cost time: 14.436867952346802
Epoch: 4, Steps: 67 | Train Loss: 0.483 Vali Loss: 4.090 Vali Acc: 0.775 Test Loss: 4.090 Test Acc: 0.775
Validation loss decreased (-0.745611 --> -0.774526).  Saving model ...
Epoch: 5 cost time: 14.288968801498413
Epoch: 5, Steps: 67 | Train Loss: 0.178 Vali Loss: 2.095 Vali Acc: 0.792 Test Loss: 2.095 Test Acc: 0.792
Validation loss decreased (-0.774526 --> -0.791887).  Saving model ...
Epoch: 6 cost time: 14.274920463562012
Epoch: 6, Steps: 67 | Train Loss: 0.227 Vali Loss: 1.834 Vali Acc: 0.798 Test Loss: 1.834 Test Acc: 0.798
Validation loss decreased (-0.791887 --> -0.797670).  Saving model ...
Epoch: 7 cost time: 14.236029624938965
Epoch: 7, Steps: 67 | Train Loss: 0.060 Vali Loss: 2.751 Vali Acc: 0.827 Test Loss: 2.751 Test Acc: 0.827
Validation loss decreased (-0.797670 --> -0.826562).  Saving model ...
Epoch: 8 cost time: 14.391973495483398
Epoch: 8, Steps: 67 | Train Loss: 0.061 Vali Loss: 4.181 Vali Acc: 0.780 Test Loss: 4.181 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.263436555862427
Epoch: 9, Steps: 67 | Train Loss: 0.358 Vali Loss: 5.872 Vali Acc: 0.757 Test Loss: 5.872 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.195926427841187
Epoch: 10, Steps: 67 | Train Loss: 0.951 Vali Loss: 3.815 Vali Acc: 0.798 Test Loss: 3.815 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.28859281539917
Epoch: 11, Steps: 67 | Train Loss: 0.372 Vali Loss: 12.601 Vali Acc: 0.728 Test Loss: 12.601 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 14.193550109863281
Epoch: 12, Steps: 67 | Train Loss: 1.483 Vali Loss: 18.052 Vali Acc: 0.613 Test Loss: 18.052 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.510247230529785
Epoch: 13, Steps: 67 | Train Loss: 0.847 Vali Loss: 7.915 Vali Acc: 0.734 Test Loss: 7.915 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 14.339565992355347
Epoch: 14, Steps: 67 | Train Loss: 0.196 Vali Loss: 10.885 Vali Acc: 0.780 Test Loss: 10.885 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 14.279016017913818
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.090 Vali Acc: 0.798 Test Loss: 11.090 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 14.190504312515259
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.057 Vali Acc: 0.786 Test Loss: 11.057 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 14.437860488891602
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.041 Vali Acc: 0.786 Test Loss: 11.041 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 10504967
model size : 41.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.50603199005127
Epoch: 1, Steps: 67 | Train Loss: 13.500 Vali Loss: 9.060 Vali Acc: 0.595 Test Loss: 9.060 Test Acc: 0.595
Validation loss decreased (inf --> -0.595285).  Saving model ...
Epoch: 2 cost time: 12.127841711044312
Epoch: 2, Steps: 67 | Train Loss: 4.966 Vali Loss: 2.267 Vali Acc: 0.769 Test Loss: 2.267 Test Acc: 0.769
Validation loss decreased (-0.595285 --> -0.768763).  Saving model ...
Epoch: 3 cost time: 12.28572416305542
Epoch: 3, Steps: 67 | Train Loss: 0.446 Vali Loss: 1.871 Vali Acc: 0.769 Test Loss: 1.871 Test Acc: 0.769
Validation loss decreased (-0.768763 --> -0.768767).  Saving model ...
Epoch: 4 cost time: 12.263383626937866
Epoch: 4, Steps: 67 | Train Loss: 0.162 Vali Loss: 2.443 Vali Acc: 0.832 Test Loss: 2.443 Test Acc: 0.832
Validation loss decreased (-0.768767 --> -0.832346).  Saving model ...
Epoch: 5 cost time: 12.51137089729309
Epoch: 5, Steps: 67 | Train Loss: 0.044 Vali Loss: 2.365 Vali Acc: 0.792 Test Loss: 2.365 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.558284282684326
Epoch: 6, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.123 Vali Acc: 0.827 Test Loss: 2.123 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.362456560134888
Epoch: 7, Steps: 67 | Train Loss: 0.101 Vali Loss: 3.833 Vali Acc: 0.775 Test Loss: 3.833 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.615483283996582
Epoch: 8, Steps: 67 | Train Loss: 0.487 Vali Loss: 4.428 Vali Acc: 0.711 Test Loss: 4.428 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.578819274902344
Epoch: 9, Steps: 67 | Train Loss: 1.031 Vali Loss: 4.782 Vali Acc: 0.728 Test Loss: 4.782 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.37611699104309
Epoch: 10, Steps: 67 | Train Loss: 0.366 Vali Loss: 4.891 Vali Acc: 0.769 Test Loss: 4.891 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 12.487934350967407
Epoch: 11, Steps: 67 | Train Loss: 0.225 Vali Loss: 6.656 Vali Acc: 0.786 Test Loss: 6.656 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.449587106704712
Epoch: 12, Steps: 67 | Train Loss: 0.620 Vali Loss: 7.476 Vali Acc: 0.717 Test Loss: 7.476 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.362715482711792
Epoch: 13, Steps: 67 | Train Loss: 0.286 Vali Loss: 8.049 Vali Acc: 0.803 Test Loss: 8.049 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.347782135009766
Epoch: 14, Steps: 67 | Train Loss: 0.396 Vali Loss: 6.156 Vali Acc: 0.815 Test Loss: 6.156 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7916679
model size : 31.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.347371339797974
Epoch: 1, Steps: 67 | Train Loss: 10.200 Vali Loss: 9.089 Vali Acc: 0.543 Test Loss: 9.089 Test Acc: 0.543
Validation loss decreased (inf --> -0.543262).  Saving model ...
Epoch: 2 cost time: 8.730095148086548
Epoch: 2, Steps: 67 | Train Loss: 4.456 Vali Loss: 2.378 Vali Acc: 0.630 Test Loss: 2.378 Test Acc: 0.630
Validation loss decreased (-0.543262 --> -0.630034).  Saving model ...
Epoch: 3 cost time: 8.922482252120972
Epoch: 3, Steps: 67 | Train Loss: 0.403 Vali Loss: 1.742 Vali Acc: 0.803 Test Loss: 1.742 Test Acc: 0.803
Validation loss decreased (-0.630034 --> -0.803451).  Saving model ...
Epoch: 4 cost time: 8.861647129058838
Epoch: 4, Steps: 67 | Train Loss: 0.169 Vali Loss: 3.191 Vali Acc: 0.786 Test Loss: 3.191 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.912790536880493
Epoch: 5, Steps: 67 | Train Loss: 0.103 Vali Loss: 1.417 Vali Acc: 0.861 Test Loss: 1.417 Test Acc: 0.861
Validation loss decreased (-0.803451 --> -0.861258).  Saving model ...
Epoch: 6 cost time: 8.779709815979004
Epoch: 6, Steps: 67 | Train Loss: 0.097 Vali Loss: 3.514 Vali Acc: 0.769 Test Loss: 3.514 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.904104471206665
Epoch: 7, Steps: 67 | Train Loss: 0.216 Vali Loss: 13.531 Vali Acc: 0.543 Test Loss: 13.531 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.876326322555542
Epoch: 8, Steps: 67 | Train Loss: 0.401 Vali Loss: 7.030 Vali Acc: 0.728 Test Loss: 7.030 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.918631315231323
Epoch: 9, Steps: 67 | Train Loss: 0.254 Vali Loss: 4.964 Vali Acc: 0.705 Test Loss: 4.964 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.980263471603394
Epoch: 10, Steps: 67 | Train Loss: 0.062 Vali Loss: 11.613 Vali Acc: 0.740 Test Loss: 11.613 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.961556911468506
Epoch: 11, Steps: 67 | Train Loss: 0.508 Vali Loss: 4.795 Vali Acc: 0.775 Test Loss: 4.795 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.937682390213013
Epoch: 12, Steps: 67 | Train Loss: 0.088 Vali Loss: 2.410 Vali Acc: 0.827 Test Loss: 2.410 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.081648111343384
Epoch: 13, Steps: 67 | Train Loss: 0.059 Vali Loss: 3.223 Vali Acc: 0.757 Test Loss: 3.223 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.878260374069214
Epoch: 14, Steps: 67 | Train Loss: 0.064 Vali Loss: 2.783 Vali Acc: 0.809 Test Loss: 2.783 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.905747890472412
Epoch: 15, Steps: 67 | Train Loss: 0.010 Vali Loss: 9.545 Vali Acc: 0.740 Test Loss: 9.545 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 5760007
model size : 23.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.447507381439209
Epoch: 1, Steps: 67 | Train Loss: 9.183 Vali Loss: 5.995 Vali Acc: 0.590 Test Loss: 5.995 Test Acc: 0.590
Validation loss decreased (inf --> -0.589535).  Saving model ...
Epoch: 2 cost time: 7.002307891845703
Epoch: 2, Steps: 67 | Train Loss: 3.486 Vali Loss: 3.532 Vali Acc: 0.705 Test Loss: 3.532 Test Acc: 0.705
Validation loss decreased (-0.589535 --> -0.705167).  Saving model ...
Epoch: 3 cost time: 6.909714221954346
Epoch: 3, Steps: 67 | Train Loss: 0.442 Vali Loss: 2.068 Vali Acc: 0.647 Test Loss: 2.068 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.942513942718506
Epoch: 4, Steps: 67 | Train Loss: 0.039 Vali Loss: 0.984 Vali Acc: 0.861 Test Loss: 0.984 Test Acc: 0.861
Validation loss decreased (-0.705167 --> -0.861262).  Saving model ...
Epoch: 5 cost time: 6.893516302108765
Epoch: 5, Steps: 67 | Train Loss: 0.050 Vali Loss: 4.911 Vali Acc: 0.572 Test Loss: 4.911 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.002639532089233
Epoch: 6, Steps: 67 | Train Loss: 0.211 Vali Loss: 1.465 Vali Acc: 0.838 Test Loss: 1.465 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.073422908782959
Epoch: 7, Steps: 67 | Train Loss: 0.114 Vali Loss: 1.804 Vali Acc: 0.815 Test Loss: 1.804 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.063390493392944
Epoch: 8, Steps: 67 | Train Loss: 0.357 Vali Loss: 2.686 Vali Acc: 0.751 Test Loss: 2.686 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.015688896179199
Epoch: 9, Steps: 67 | Train Loss: 0.010 Vali Loss: 10.149 Vali Acc: 0.636 Test Loss: 10.149 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.999947786331177
Epoch: 10, Steps: 67 | Train Loss: 0.377 Vali Loss: 5.206 Vali Acc: 0.763 Test Loss: 5.206 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.919850587844849
Epoch: 11, Steps: 67 | Train Loss: 0.135 Vali Loss: 4.841 Vali Acc: 0.746 Test Loss: 4.841 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.127629518508911
Epoch: 12, Steps: 67 | Train Loss: 0.429 Vali Loss: 3.192 Vali Acc: 0.763 Test Loss: 3.192 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.133938312530518
Epoch: 13, Steps: 67 | Train Loss: 0.449 Vali Loss: 14.987 Vali Acc: 0.555 Test Loss: 14.987 Test Acc: 0.555
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.153247356414795
Epoch: 14, Steps: 67 | Train Loss: 0.430 Vali Loss: 9.617 Vali Acc: 0.497 Test Loss: 9.617 Test Acc: 0.497
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 4034759
model size : 16.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.028819561004639
Epoch: 1, Steps: 67 | Train Loss: 6.764 Vali Loss: 9.200 Vali Acc: 0.584 Test Loss: 9.200 Test Acc: 0.584
Validation loss decreased (inf --> -0.583723).  Saving model ...
Epoch: 2 cost time: 5.671658992767334
Epoch: 2, Steps: 67 | Train Loss: 4.522 Vali Loss: 4.032 Vali Acc: 0.624 Test Loss: 4.032 Test Acc: 0.624
Validation loss decreased (-0.583723 --> -0.624237).  Saving model ...
Epoch: 3 cost time: 5.857448577880859
Epoch: 3, Steps: 67 | Train Loss: 0.604 Vali Loss: 0.787 Vali Acc: 0.815 Test Loss: 0.787 Test Acc: 0.815
Validation loss decreased (-0.624237 --> -0.815021).  Saving model ...
Epoch: 4 cost time: 5.7593841552734375
Epoch: 4, Steps: 67 | Train Loss: 0.056 Vali Loss: 1.599 Vali Acc: 0.803 Test Loss: 1.599 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.679326295852661
Epoch: 5, Steps: 67 | Train Loss: 0.069 Vali Loss: 1.208 Vali Acc: 0.809 Test Loss: 1.208 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.734076976776123
Epoch: 6, Steps: 67 | Train Loss: 0.009 Vali Loss: 1.225 Vali Acc: 0.815 Test Loss: 1.225 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.664090156555176
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.809 Test Loss: 2.178 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.687284469604492
Epoch: 8, Steps: 67 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.867 Test Loss: 1.079 Test Acc: 0.867
Validation loss decreased (-0.815021 --> -0.867041).  Saving model ...
Epoch: 9 cost time: 5.835169076919556
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.230 Vali Acc: 0.821 Test Loss: 1.230 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.615981578826904
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.336 Vali Acc: 0.827 Test Loss: 1.336 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.777364730834961
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.783815145492554
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.838 Test Loss: 0.823 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.738992691040039
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.844 Test Loss: 0.882 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.691256284713745
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.827 Test Loss: 1.089 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.703237771987915
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.821 Test Loss: 1.149 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.892019510269165
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.838 Test Loss: 1.058 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.72907280921936
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.838 Test Loss: 1.061 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.606621503829956
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.838 Test Loss: 1.059 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 3603783
model size : 14.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 225.7284241
	speed: 0.3648s/iter; left time: 4852.3133s
Epoch: 1 cost time: 48.84575963020325
Epoch: 1, Steps: 134 | Train Loss: 124.716 Vali Loss: 22.644 Vali Acc: 0.416 Test Loss: 22.644 Test Acc: 0.416
Validation loss decreased (inf --> -0.415959).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000592
	speed: 0.7478s/iter; left time: 9846.1503s
Epoch: 2 cost time: 48.049373626708984
Epoch: 2, Steps: 134 | Train Loss: 4.435 Vali Loss: 11.525 Vali Acc: 0.480 Test Loss: 11.525 Test Acc: 0.480
Validation loss decreased (-0.415959 --> -0.479654).  Saving model ...
	iters: 100, epoch: 3 | loss: 5.2051907
	speed: 0.7444s/iter; left time: 9701.2725s
Epoch: 3 cost time: 47.63868737220764
Epoch: 3, Steps: 134 | Train Loss: 2.850 Vali Loss: 7.520 Vali Acc: 0.694 Test Loss: 7.520 Test Acc: 0.694
Validation loss decreased (-0.479654 --> -0.693566).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.7552s/iter; left time: 9741.0973s
Epoch: 4 cost time: 48.162694215774536
Epoch: 4, Steps: 134 | Train Loss: 2.908 Vali Loss: 42.497 Vali Acc: 0.486 Test Loss: 42.497 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7483s/iter; left time: 9551.5385s
Epoch: 5 cost time: 48.265729904174805
Epoch: 5, Steps: 134 | Train Loss: 4.877 Vali Loss: 9.551 Vali Acc: 0.665 Test Loss: 9.551 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7422s/iter; left time: 9374.6389s
Epoch: 6 cost time: 47.929628133773804
Epoch: 6, Steps: 134 | Train Loss: 0.375 Vali Loss: 17.207 Vali Acc: 0.659 Test Loss: 17.207 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 24.3094234
	speed: 0.7399s/iter; left time: 9246.7706s
Epoch: 7 cost time: 47.87022042274475
Epoch: 7, Steps: 134 | Train Loss: 1.894 Vali Loss: 9.073 Vali Acc: 0.798 Test Loss: 9.073 Test Acc: 0.798
Validation loss decreased (-0.693566 --> -0.797597).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7527s/iter; left time: 9305.1649s
Epoch: 8 cost time: 48.13421654701233
Epoch: 8, Steps: 134 | Train Loss: 1.281 Vali Loss: 10.757 Vali Acc: 0.780 Test Loss: 10.757 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7483s/iter; left time: 9150.5156s
Epoch: 9 cost time: 48.48879051208496
Epoch: 9, Steps: 134 | Train Loss: 2.498 Vali Loss: 29.382 Vali Acc: 0.543 Test Loss: 29.382 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7457s/iter; left time: 9018.8417s
Epoch: 10 cost time: 48.08178353309631
Epoch: 10, Steps: 134 | Train Loss: 2.028 Vali Loss: 7.530 Vali Acc: 0.746 Test Loss: 7.530 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7401s/iter; left time: 8852.7380s
Epoch: 11 cost time: 47.91061782836914
Epoch: 11, Steps: 134 | Train Loss: 3.167 Vali Loss: 26.698 Vali Acc: 0.595 Test Loss: 26.698 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7450s/iter; left time: 8811.5267s
Epoch: 12 cost time: 48.15743565559387
Epoch: 12, Steps: 134 | Train Loss: 1.642 Vali Loss: 11.609 Vali Acc: 0.798 Test Loss: 11.609 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7468s/iter; left time: 8732.4624s
Epoch: 13 cost time: 48.04383325576782
Epoch: 13, Steps: 134 | Train Loss: 0.404 Vali Loss: 14.687 Vali Acc: 0.728 Test Loss: 14.687 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 63.4328728
	speed: 0.7467s/iter; left time: 8630.8783s
Epoch: 14 cost time: 48.338834285736084
Epoch: 14, Steps: 134 | Train Loss: 4.383 Vali Loss: 15.678 Vali Acc: 0.803 Test Loss: 15.678 Test Acc: 0.803
Validation loss decreased (-0.797597 --> -0.803311).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7586s/iter; left time: 8666.6638s
Epoch: 15 cost time: 47.977779388427734
Epoch: 15, Steps: 134 | Train Loss: 1.115 Vali Loss: 20.441 Vali Acc: 0.723 Test Loss: 20.441 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7450s/iter; left time: 8411.8134s
Epoch: 16 cost time: 48.10957741737366
Epoch: 16, Steps: 134 | Train Loss: 1.934 Vali Loss: 21.956 Vali Acc: 0.734 Test Loss: 21.956 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7402s/iter; left time: 8258.9277s
Epoch: 17 cost time: 47.888087034225464
Epoch: 17, Steps: 134 | Train Loss: 0.391 Vali Loss: 33.511 Vali Acc: 0.775 Test Loss: 33.511 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.7500s/iter; left time: 8266.7184s
Epoch: 18 cost time: 48.244932651519775
Epoch: 18, Steps: 134 | Train Loss: 1.833 Vali Loss: 25.315 Vali Acc: 0.665 Test Loss: 25.315 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.7440s/iter; left time: 8101.5506s
Epoch: 19 cost time: 48.19974422454834
Epoch: 19, Steps: 134 | Train Loss: 0.100 Vali Loss: 21.156 Vali Acc: 0.786 Test Loss: 21.156 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.7432s/iter; left time: 7993.6180s
Epoch: 20 cost time: 48.09856128692627
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.161 Vali Acc: 0.786 Test Loss: 21.161 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7451s/iter; left time: 7913.4237s
Epoch: 21 cost time: 48.08019018173218
Epoch: 21, Steps: 134 | Train Loss: 1.945 Vali Loss: 81.408 Vali Acc: 0.607 Test Loss: 81.408 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.7418s/iter; left time: 7779.7762s
Epoch: 22 cost time: 47.97412347793579
Epoch: 22, Steps: 134 | Train Loss: 4.868 Vali Loss: 58.230 Vali Acc: 0.335 Test Loss: 58.230 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.7416s/iter; left time: 7678.1835s
Epoch: 23 cost time: 47.90118885040283
Epoch: 23, Steps: 134 | Train Loss: 5.676 Vali Loss: 83.064 Vali Acc: 0.578 Test Loss: 83.064 Test Acc: 0.578
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.7392s/iter; left time: 7553.8560s
Epoch: 24 cost time: 48.00415825843811
Epoch: 24, Steps: 134 | Train Loss: 4.599 Vali Loss: 24.520 Vali Acc: 0.769 Test Loss: 24.520 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 31163335
model size : 120.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.522788047790527
Epoch: 1, Steps: 67 | Train Loss: 28.172 Vali Loss: 34.241 Vali Acc: 0.480 Test Loss: 34.241 Test Acc: 0.480
Validation loss decreased (inf --> -0.479426).  Saving model ...
Epoch: 2 cost time: 19.613440990447998
Epoch: 2, Steps: 67 | Train Loss: 12.999 Vali Loss: 5.462 Vali Acc: 0.572 Test Loss: 5.462 Test Acc: 0.572
Validation loss decreased (-0.479426 --> -0.572200).  Saving model ...
Epoch: 3 cost time: 19.528375387191772
Epoch: 3, Steps: 67 | Train Loss: 0.590 Vali Loss: 2.829 Vali Acc: 0.723 Test Loss: 2.829 Test Acc: 0.723
Validation loss decreased (-0.572200 --> -0.722515).  Saving model ...
Epoch: 4 cost time: 19.400834560394287
Epoch: 4, Steps: 67 | Train Loss: 0.399 Vali Loss: 2.089 Vali Acc: 0.757 Test Loss: 2.089 Test Acc: 0.757
Validation loss decreased (-0.722515 --> -0.757205).  Saving model ...
Epoch: 5 cost time: 19.519612312316895
Epoch: 5, Steps: 67 | Train Loss: 0.526 Vali Loss: 4.984 Vali Acc: 0.624 Test Loss: 4.984 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.583966970443726
Epoch: 6, Steps: 67 | Train Loss: 0.411 Vali Loss: 14.604 Vali Acc: 0.665 Test Loss: 14.604 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.557568788528442
Epoch: 7, Steps: 67 | Train Loss: 1.566 Vali Loss: 15.272 Vali Acc: 0.561 Test Loss: 15.272 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.91213631629944
Epoch: 8, Steps: 67 | Train Loss: 1.266 Vali Loss: 4.346 Vali Acc: 0.688 Test Loss: 4.346 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.989891529083252
Epoch: 9, Steps: 67 | Train Loss: 0.187 Vali Loss: 10.267 Vali Acc: 0.740 Test Loss: 10.267 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 19.73069405555725
Epoch: 10, Steps: 67 | Train Loss: 0.553 Vali Loss: 4.302 Vali Acc: 0.809 Test Loss: 4.302 Test Acc: 0.809
Validation loss decreased (-0.757205 --> -0.809206).  Saving model ...
Epoch: 11 cost time: 19.75579524040222
Epoch: 11, Steps: 67 | Train Loss: 0.352 Vali Loss: 8.055 Vali Acc: 0.671 Test Loss: 8.055 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.95800542831421
Epoch: 12, Steps: 67 | Train Loss: 0.633 Vali Loss: 17.397 Vali Acc: 0.723 Test Loss: 17.397 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.720775842666626
Epoch: 13, Steps: 67 | Train Loss: 0.735 Vali Loss: 10.689 Vali Acc: 0.780 Test Loss: 10.689 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.745641231536865
Epoch: 14, Steps: 67 | Train Loss: 0.960 Vali Loss: 15.057 Vali Acc: 0.676 Test Loss: 15.057 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.51390504837036
Epoch: 15, Steps: 67 | Train Loss: 0.075 Vali Loss: 5.690 Vali Acc: 0.838 Test Loss: 5.690 Test Acc: 0.838
Validation loss decreased (-0.809206 --> -0.838093).  Saving model ...
Epoch: 16 cost time: 19.5838303565979
Epoch: 16, Steps: 67 | Train Loss: 0.327 Vali Loss: 11.205 Vali Acc: 0.699 Test Loss: 11.205 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.724255084991455
Epoch: 17, Steps: 67 | Train Loss: 0.434 Vali Loss: 9.817 Vali Acc: 0.746 Test Loss: 9.817 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 19.72247815132141
Epoch: 18, Steps: 67 | Train Loss: 1.393 Vali Loss: 43.815 Vali Acc: 0.422 Test Loss: 43.815 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.699042081832886
Epoch: 19, Steps: 67 | Train Loss: 0.408 Vali Loss: 11.940 Vali Acc: 0.711 Test Loss: 11.940 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 19.840442895889282
Epoch: 20, Steps: 67 | Train Loss: 0.998 Vali Loss: 10.192 Vali Acc: 0.659 Test Loss: 10.192 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 19.6640784740448
Epoch: 21, Steps: 67 | Train Loss: 0.291 Vali Loss: 26.650 Vali Acc: 0.728 Test Loss: 26.650 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.769423007965088
Epoch: 22, Steps: 67 | Train Loss: 0.505 Vali Loss: 13.093 Vali Acc: 0.734 Test Loss: 13.093 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 19.56462001800537
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.741 Vali Acc: 0.734 Test Loss: 13.741 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 19.45571279525757
Epoch: 24, Steps: 67 | Train Loss: 0.149 Vali Loss: 20.440 Vali Acc: 0.694 Test Loss: 20.440 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 19.92734408378601
Epoch: 25, Steps: 67 | Train Loss: 1.256 Vali Loss: 13.554 Vali Acc: 0.734 Test Loss: 13.554 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 15632327
model size : 60.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.974247217178345
Epoch: 1, Steps: 67 | Train Loss: 18.893 Vali Loss: 30.165 Vali Acc: 0.410 Test Loss: 30.165 Test Acc: 0.410
Validation loss decreased (inf --> -0.410103).  Saving model ...
Epoch: 2 cost time: 12.449033737182617
Epoch: 2, Steps: 67 | Train Loss: 11.242 Vali Loss: 8.851 Vali Acc: 0.491 Test Loss: 8.851 Test Acc: 0.491
Validation loss decreased (-0.410103 --> -0.491241).  Saving model ...
Epoch: 3 cost time: 12.652981042861938
Epoch: 3, Steps: 67 | Train Loss: 1.516 Vali Loss: 1.413 Vali Acc: 0.780 Test Loss: 1.413 Test Acc: 0.780
Validation loss decreased (-0.491241 --> -0.780333).  Saving model ...
Epoch: 4 cost time: 12.465543031692505
Epoch: 4, Steps: 67 | Train Loss: 0.304 Vali Loss: 4.106 Vali Acc: 0.746 Test Loss: 4.106 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.784538269042969
Epoch: 5, Steps: 67 | Train Loss: 0.234 Vali Loss: 4.756 Vali Acc: 0.682 Test Loss: 4.756 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.471070528030396
Epoch: 6, Steps: 67 | Train Loss: 0.663 Vali Loss: 6.330 Vali Acc: 0.607 Test Loss: 6.330 Test Acc: 0.607
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.535349607467651
Epoch: 7, Steps: 67 | Train Loss: 0.632 Vali Loss: 2.117 Vali Acc: 0.798 Test Loss: 2.117 Test Acc: 0.798
Validation loss decreased (-0.780333 --> -0.797667).  Saving model ...
Epoch: 8 cost time: 12.526419878005981
Epoch: 8, Steps: 67 | Train Loss: 0.429 Vali Loss: 6.920 Vali Acc: 0.786 Test Loss: 6.920 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.588841199874878
Epoch: 9, Steps: 67 | Train Loss: 0.629 Vali Loss: 9.993 Vali Acc: 0.665 Test Loss: 9.993 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.50527834892273
Epoch: 10, Steps: 67 | Train Loss: 0.480 Vali Loss: 5.673 Vali Acc: 0.809 Test Loss: 5.673 Test Acc: 0.809
Validation loss decreased (-0.797667 --> -0.809192).  Saving model ...
Epoch: 11 cost time: 12.70401668548584
Epoch: 11, Steps: 67 | Train Loss: 0.190 Vali Loss: 6.303 Vali Acc: 0.786 Test Loss: 6.303 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.494771718978882
Epoch: 12, Steps: 67 | Train Loss: 0.115 Vali Loss: 4.623 Vali Acc: 0.775 Test Loss: 4.623 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.718751907348633
Epoch: 13, Steps: 67 | Train Loss: 0.450 Vali Loss: 7.091 Vali Acc: 0.798 Test Loss: 7.091 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 12.550898313522339
Epoch: 14, Steps: 67 | Train Loss: 0.243 Vali Loss: 5.458 Vali Acc: 0.769 Test Loss: 5.458 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.565828800201416
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.098 Vali Acc: 0.815 Test Loss: 5.098 Test Acc: 0.815
Validation loss decreased (-0.809192 --> -0.814978).  Saving model ...
Epoch: 16 cost time: 12.399187803268433
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.092 Vali Acc: 0.815 Test Loss: 5.092 Test Acc: 0.815
Validation loss decreased (-0.814978 --> -0.814978).  Saving model ...
Epoch: 17 cost time: 12.58906602859497
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.120 Vali Acc: 0.815 Test Loss: 5.120 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.515713214874268
Epoch: 18, Steps: 67 | Train Loss: 0.297 Vali Loss: 5.838 Vali Acc: 0.809 Test Loss: 5.838 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.57384204864502
Epoch: 19, Steps: 67 | Train Loss: 0.420 Vali Loss: 13.949 Vali Acc: 0.642 Test Loss: 13.949 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.81001329421997
Epoch: 20, Steps: 67 | Train Loss: 1.219 Vali Loss: 11.779 Vali Acc: 0.734 Test Loss: 11.779 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.467890739440918
Epoch: 21, Steps: 67 | Train Loss: 1.172 Vali Loss: 4.609 Vali Acc: 0.780 Test Loss: 4.609 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.677237749099731
Epoch: 22, Steps: 67 | Train Loss: 1.752 Vali Loss: 19.287 Vali Acc: 0.694 Test Loss: 19.287 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 12.673583269119263
Epoch: 23, Steps: 67 | Train Loss: 0.733 Vali Loss: 11.955 Vali Acc: 0.780 Test Loss: 11.955 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.691737651824951
Epoch: 24, Steps: 67 | Train Loss: 0.317 Vali Loss: 18.249 Vali Acc: 0.815 Test Loss: 18.249 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.666236400604248
Epoch: 25, Steps: 67 | Train Loss: 0.143 Vali Loss: 18.063 Vali Acc: 0.763 Test Loss: 18.063 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 12.704051494598389
Epoch: 26, Steps: 67 | Train Loss: 0.847 Vali Loss: 18.084 Vali Acc: 0.734 Test Loss: 18.084 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 10455431
model size : 41.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.967352628707886
Epoch: 1, Steps: 67 | Train Loss: 15.310 Vali Loss: 34.549 Vali Acc: 0.370 Test Loss: 34.549 Test Acc: 0.370
Validation loss decreased (inf --> -0.369597).  Saving model ...
Epoch: 2 cost time: 10.70009160041809
Epoch: 2, Steps: 67 | Train Loss: 6.911 Vali Loss: 5.764 Vali Acc: 0.671 Test Loss: 5.764 Test Acc: 0.671
Validation loss decreased (-0.369597 --> -0.670463).  Saving model ...
Epoch: 3 cost time: 10.836162328720093
Epoch: 3, Steps: 67 | Train Loss: 1.874 Vali Loss: 3.369 Vali Acc: 0.751 Test Loss: 3.369 Test Acc: 0.751
Validation loss decreased (-0.670463 --> -0.751411).  Saving model ...
Epoch: 4 cost time: 11.126416444778442
Epoch: 4, Steps: 67 | Train Loss: 0.435 Vali Loss: 3.603 Vali Acc: 0.740 Test Loss: 3.603 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.131192207336426
Epoch: 5, Steps: 67 | Train Loss: 0.099 Vali Loss: 2.795 Vali Acc: 0.780 Test Loss: 2.795 Test Acc: 0.780
Validation loss decreased (-0.751411 --> -0.780319).  Saving model ...
Epoch: 6 cost time: 11.026759386062622
Epoch: 6, Steps: 67 | Train Loss: 0.076 Vali Loss: 3.502 Vali Acc: 0.694 Test Loss: 3.502 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.0484778881073
Epoch: 7, Steps: 67 | Train Loss: 0.456 Vali Loss: 6.848 Vali Acc: 0.694 Test Loss: 6.848 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.973360538482666
Epoch: 8, Steps: 67 | Train Loss: 0.684 Vali Loss: 5.199 Vali Acc: 0.746 Test Loss: 5.199 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.929266691207886
Epoch: 9, Steps: 67 | Train Loss: 0.124 Vali Loss: 6.475 Vali Acc: 0.746 Test Loss: 6.475 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.00706934928894
Epoch: 10, Steps: 67 | Train Loss: 0.531 Vali Loss: 3.044 Vali Acc: 0.757 Test Loss: 3.044 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.001046180725098
Epoch: 11, Steps: 67 | Train Loss: 0.143 Vali Loss: 3.957 Vali Acc: 0.780 Test Loss: 3.957 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.88686203956604
Epoch: 12, Steps: 67 | Train Loss: 0.469 Vali Loss: 11.365 Vali Acc: 0.740 Test Loss: 11.365 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.99675440788269
Epoch: 13, Steps: 67 | Train Loss: 0.325 Vali Loss: 5.671 Vali Acc: 0.798 Test Loss: 5.671 Test Acc: 0.798
Validation loss decreased (-0.780319 --> -0.797631).  Saving model ...
Epoch: 14 cost time: 10.996195554733276
Epoch: 14, Steps: 67 | Train Loss: 0.036 Vali Loss: 4.726 Vali Acc: 0.792 Test Loss: 4.726 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.996806859970093
Epoch: 15, Steps: 67 | Train Loss: 0.076 Vali Loss: 6.033 Vali Acc: 0.792 Test Loss: 6.033 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.77706265449524
Epoch: 16, Steps: 67 | Train Loss: 0.002 Vali Loss: 4.532 Vali Acc: 0.792 Test Loss: 4.532 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.885789155960083
Epoch: 17, Steps: 67 | Train Loss: 0.033 Vali Loss: 6.028 Vali Acc: 0.786 Test Loss: 6.028 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.849095106124878
Epoch: 18, Steps: 67 | Train Loss: 0.210 Vali Loss: 3.014 Vali Acc: 0.861 Test Loss: 3.014 Test Acc: 0.861
Validation loss decreased (-0.797631 --> -0.861242).  Saving model ...
Epoch: 19 cost time: 11.062704801559448
Epoch: 19, Steps: 67 | Train Loss: 0.170 Vali Loss: 6.310 Vali Acc: 0.780 Test Loss: 6.310 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.92412257194519
Epoch: 20, Steps: 67 | Train Loss: 0.677 Vali Loss: 6.599 Vali Acc: 0.769 Test Loss: 6.599 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.08807373046875
Epoch: 21, Steps: 67 | Train Loss: 0.930 Vali Loss: 4.549 Vali Acc: 0.734 Test Loss: 4.549 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.889333009719849
Epoch: 22, Steps: 67 | Train Loss: 1.478 Vali Loss: 37.942 Vali Acc: 0.474 Test Loss: 37.942 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.047147512435913
Epoch: 23, Steps: 67 | Train Loss: 0.934 Vali Loss: 5.909 Vali Acc: 0.815 Test Loss: 5.909 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.02650260925293
Epoch: 24, Steps: 67 | Train Loss: 0.571 Vali Loss: 9.667 Vali Acc: 0.624 Test Loss: 9.667 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 11.083872318267822
Epoch: 25, Steps: 67 | Train Loss: 1.223 Vali Loss: 41.041 Vali Acc: 0.439 Test Loss: 41.041 Test Acc: 0.439
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 10.880888938903809
Epoch: 26, Steps: 67 | Train Loss: 0.139 Vali Loss: 11.450 Vali Acc: 0.815 Test Loss: 11.450 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.002287149429321
Epoch: 27, Steps: 67 | Train Loss: 0.339 Vali Loss: 3.347 Vali Acc: 0.855 Test Loss: 3.347 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.943710803985596
Epoch: 28, Steps: 67 | Train Loss: 0.134 Vali Loss: 24.975 Vali Acc: 0.694 Test Loss: 24.975 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 7867143
model size : 31.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.406956672668457
Epoch: 1, Steps: 67 | Train Loss: 8.192 Vali Loss: 14.450 Vali Acc: 0.480 Test Loss: 14.450 Test Acc: 0.480
Validation loss decreased (inf --> -0.479624).  Saving model ...
Epoch: 2 cost time: 7.265859127044678
Epoch: 2, Steps: 67 | Train Loss: 8.397 Vali Loss: 6.852 Vali Acc: 0.601 Test Loss: 6.852 Test Acc: 0.601
Validation loss decreased (-0.479624 --> -0.601088).  Saving model ...
Epoch: 3 cost time: 7.260400772094727
Epoch: 3, Steps: 67 | Train Loss: 2.642 Vali Loss: 2.625 Vali Acc: 0.780 Test Loss: 2.625 Test Acc: 0.780
Validation loss decreased (-0.601088 --> -0.780321).  Saving model ...
Epoch: 4 cost time: 7.4495978355407715
Epoch: 4, Steps: 67 | Train Loss: 0.324 Vali Loss: 2.213 Vali Acc: 0.786 Test Loss: 2.213 Test Acc: 0.786
Validation loss decreased (-0.780321 --> -0.786105).  Saving model ...
Epoch: 5 cost time: 7.544473648071289
Epoch: 5, Steps: 67 | Train Loss: 0.115 Vali Loss: 2.731 Vali Acc: 0.763 Test Loss: 2.731 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.468686103820801
Epoch: 6, Steps: 67 | Train Loss: 0.262 Vali Loss: 4.707 Vali Acc: 0.763 Test Loss: 4.707 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.507740020751953
Epoch: 7, Steps: 67 | Train Loss: 0.637 Vali Loss: 8.143 Vali Acc: 0.514 Test Loss: 8.143 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.54161262512207
Epoch: 8, Steps: 67 | Train Loss: 0.818 Vali Loss: 2.628 Vali Acc: 0.827 Test Loss: 2.628 Test Acc: 0.827
Validation loss decreased (-0.786105 --> -0.826563).  Saving model ...
Epoch: 9 cost time: 7.602362632751465
Epoch: 9, Steps: 67 | Train Loss: 0.090 Vali Loss: 2.759 Vali Acc: 0.821 Test Loss: 2.759 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.475757360458374
Epoch: 10, Steps: 67 | Train Loss: 0.045 Vali Loss: 2.698 Vali Acc: 0.821 Test Loss: 2.698 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.61790657043457
Epoch: 11, Steps: 67 | Train Loss: 0.126 Vali Loss: 3.804 Vali Acc: 0.757 Test Loss: 3.804 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.471710920333862
Epoch: 12, Steps: 67 | Train Loss: 0.006 Vali Loss: 5.204 Vali Acc: 0.821 Test Loss: 5.204 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.559706211090088
Epoch: 13, Steps: 67 | Train Loss: 0.009 Vali Loss: 2.617 Vali Acc: 0.855 Test Loss: 2.617 Test Acc: 0.855
Validation loss decreased (-0.826563 --> -0.855465).  Saving model ...
Epoch: 14 cost time: 7.5831215381622314
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.950 Vali Acc: 0.792 Test Loss: 7.950 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.458559513092041
Epoch: 15, Steps: 67 | Train Loss: 0.043 Vali Loss: 2.968 Vali Acc: 0.832 Test Loss: 2.968 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.551911354064941
Epoch: 16, Steps: 67 | Train Loss: 0.407 Vali Loss: 9.180 Vali Acc: 0.728 Test Loss: 9.180 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.524245500564575
Epoch: 17, Steps: 67 | Train Loss: 0.120 Vali Loss: 6.938 Vali Acc: 0.780 Test Loss: 6.938 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.58612060546875
Epoch: 18, Steps: 67 | Train Loss: 0.169 Vali Loss: 4.029 Vali Acc: 0.809 Test Loss: 4.029 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.542379379272461
Epoch: 19, Steps: 67 | Train Loss: 0.044 Vali Loss: 8.385 Vali Acc: 0.786 Test Loss: 8.385 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.570387840270996
Epoch: 20, Steps: 67 | Train Loss: 0.609 Vali Loss: 28.930 Vali Acc: 0.549 Test Loss: 28.930 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.668969392776489
Epoch: 21, Steps: 67 | Train Loss: 1.552 Vali Loss: 11.938 Vali Acc: 0.636 Test Loss: 11.938 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.4654998779296875
Epoch: 22, Steps: 67 | Train Loss: 1.203 Vali Loss: 7.819 Vali Acc: 0.723 Test Loss: 7.819 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.565638780593872
Epoch: 23, Steps: 67 | Train Loss: 0.957 Vali Loss: 25.054 Vali Acc: 0.740 Test Loss: 25.054 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 5710471
model size : 23.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3211829662323
Epoch: 1, Steps: 67 | Train Loss: 6.797 Vali Loss: 4.178 Vali Acc: 0.497 Test Loss: 4.178 Test Acc: 0.497
Validation loss decreased (inf --> -0.497068).  Saving model ...
Epoch: 2 cost time: 5.973701000213623
Epoch: 2, Steps: 67 | Train Loss: 4.769 Vali Loss: 2.466 Vali Acc: 0.636 Test Loss: 2.466 Test Acc: 0.636
Validation loss decreased (-0.497068 --> -0.635813).  Saving model ...
Epoch: 3 cost time: 5.842727899551392
Epoch: 3, Steps: 67 | Train Loss: 0.406 Vali Loss: 0.978 Vali Acc: 0.827 Test Loss: 0.978 Test Acc: 0.827
Validation loss decreased (-0.635813 --> -0.826580).  Saving model ...
Epoch: 4 cost time: 5.969252586364746
Epoch: 4, Steps: 67 | Train Loss: 0.251 Vali Loss: 3.650 Vali Acc: 0.740 Test Loss: 3.650 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.886672735214233
Epoch: 5, Steps: 67 | Train Loss: 0.078 Vali Loss: 3.025 Vali Acc: 0.746 Test Loss: 3.025 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.829210042953491
Epoch: 6, Steps: 67 | Train Loss: 0.083 Vali Loss: 1.521 Vali Acc: 0.879 Test Loss: 1.521 Test Acc: 0.879
Validation loss decreased (-0.826580 --> -0.878598).  Saving model ...
Epoch: 7 cost time: 5.8377978801727295
Epoch: 7, Steps: 67 | Train Loss: 0.169 Vali Loss: 5.704 Vali Acc: 0.676 Test Loss: 5.704 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.795097351074219
Epoch: 8, Steps: 67 | Train Loss: 0.417 Vali Loss: 3.964 Vali Acc: 0.699 Test Loss: 3.964 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.875453472137451
Epoch: 9, Steps: 67 | Train Loss: 0.232 Vali Loss: 10.731 Vali Acc: 0.613 Test Loss: 10.731 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.8853747844696045
Epoch: 10, Steps: 67 | Train Loss: 0.336 Vali Loss: 2.034 Vali Acc: 0.803 Test Loss: 2.034 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.9559266567230225
Epoch: 11, Steps: 67 | Train Loss: 0.359 Vali Loss: 1.975 Vali Acc: 0.815 Test Loss: 1.975 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.976099491119385
Epoch: 12, Steps: 67 | Train Loss: 0.116 Vali Loss: 3.628 Vali Acc: 0.792 Test Loss: 3.628 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.851045846939087
Epoch: 13, Steps: 67 | Train Loss: 0.067 Vali Loss: 2.695 Vali Acc: 0.850 Test Loss: 2.695 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.865630865097046
Epoch: 14, Steps: 67 | Train Loss: 0.149 Vali Loss: 4.588 Vali Acc: 0.751 Test Loss: 4.588 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.887045383453369
Epoch: 15, Steps: 67 | Train Loss: 0.001 Vali Loss: 3.689 Vali Acc: 0.809 Test Loss: 3.689 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.950873851776123
Epoch: 16, Steps: 67 | Train Loss: 0.149 Vali Loss: 4.925 Vali Acc: 0.717 Test Loss: 4.925 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 3985223
model size : 16.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.21567702293396
Epoch: 1, Steps: 67 | Train Loss: 7.202 Vali Loss: 4.120 Vali Acc: 0.595 Test Loss: 4.120 Test Acc: 0.595
Validation loss decreased (inf --> -0.595335).  Saving model ...
Epoch: 2 cost time: 5.086311101913452
Epoch: 2, Steps: 67 | Train Loss: 4.249 Vali Loss: 5.365 Vali Acc: 0.613 Test Loss: 5.365 Test Acc: 0.613
Validation loss decreased (-0.595335 --> -0.612663).  Saving model ...
Epoch: 3 cost time: 5.052546501159668
Epoch: 3, Steps: 67 | Train Loss: 1.032 Vali Loss: 2.779 Vali Acc: 0.728 Test Loss: 2.779 Test Acc: 0.728
Validation loss decreased (-0.612663 --> -0.728296).  Saving model ...
Epoch: 4 cost time: 5.107921361923218
Epoch: 4, Steps: 67 | Train Loss: 0.056 Vali Loss: 2.411 Vali Acc: 0.786 Test Loss: 2.411 Test Acc: 0.786
Validation loss decreased (-0.728296 --> -0.786103).  Saving model ...
Epoch: 5 cost time: 5.1190690994262695
Epoch: 5, Steps: 67 | Train Loss: 0.108 Vali Loss: 3.096 Vali Acc: 0.699 Test Loss: 3.096 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.115887880325317
Epoch: 6, Steps: 67 | Train Loss: 0.028 Vali Loss: 2.443 Vali Acc: 0.792 Test Loss: 2.443 Test Acc: 0.792
Validation loss decreased (-0.786103 --> -0.791883).  Saving model ...
Epoch: 7 cost time: 5.272646903991699
Epoch: 7, Steps: 67 | Train Loss: 0.182 Vali Loss: 4.429 Vali Acc: 0.647 Test Loss: 4.429 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.169074296951294
Epoch: 8, Steps: 67 | Train Loss: 0.225 Vali Loss: 5.211 Vali Acc: 0.699 Test Loss: 5.211 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.170388460159302
Epoch: 9, Steps: 67 | Train Loss: 0.096 Vali Loss: 4.795 Vali Acc: 0.775 Test Loss: 4.795 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.2491254806518555
Epoch: 10, Steps: 67 | Train Loss: 0.212 Vali Loss: 6.252 Vali Acc: 0.757 Test Loss: 6.252 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.186017036437988
Epoch: 11, Steps: 67 | Train Loss: 0.234 Vali Loss: 10.103 Vali Acc: 0.618 Test Loss: 10.103 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.363267421722412
Epoch: 12, Steps: 67 | Train Loss: 0.521 Vali Loss: 3.691 Vali Acc: 0.769 Test Loss: 3.691 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.241861581802368
Epoch: 13, Steps: 67 | Train Loss: 0.200 Vali Loss: 3.505 Vali Acc: 0.769 Test Loss: 3.505 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.199879169464111
Epoch: 14, Steps: 67 | Train Loss: 0.374 Vali Loss: 7.739 Vali Acc: 0.688 Test Loss: 7.739 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.238302946090698
Epoch: 15, Steps: 67 | Train Loss: 0.350 Vali Loss: 9.729 Vali Acc: 0.682 Test Loss: 9.729 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.273132562637329
Epoch: 16, Steps: 67 | Train Loss: 0.206 Vali Loss: 12.102 Vali Acc: 0.688 Test Loss: 12.102 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 3554247
model size : 14.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 43.9960632
	speed: 0.3457s/iter; left time: 4597.7891s
Epoch: 1 cost time: 46.048635482788086
Epoch: 1, Steps: 134 | Train Loss: 103.208 Vali Loss: 40.951 Vali Acc: 0.318 Test Loss: 40.951 Test Acc: 0.318
Validation loss decreased (inf --> -0.317510).  Saving model ...
	iters: 100, epoch: 2 | loss: 8.7867584
	speed: 0.7153s/iter; left time: 9418.1767s
Epoch: 2 cost time: 45.90972399711609
Epoch: 2, Steps: 134 | Train Loss: 6.247 Vali Loss: 10.413 Vali Acc: 0.520 Test Loss: 10.413 Test Acc: 0.520
Validation loss decreased (-0.317510 --> -0.520127).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0006793
	speed: 0.7157s/iter; left time: 9327.9183s
Epoch: 3 cost time: 45.436567544937134
Epoch: 3, Steps: 134 | Train Loss: 2.328 Vali Loss: 13.343 Vali Acc: 0.699 Test Loss: 13.343 Test Acc: 0.699
Validation loss decreased (-0.520127 --> -0.699289).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.7166s/iter; left time: 9243.6951s
Epoch: 4 cost time: 45.60893154144287
Epoch: 4, Steps: 134 | Train Loss: 3.377 Vali Loss: 38.662 Vali Acc: 0.468 Test Loss: 38.662 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 33.0731125
	speed: 0.7108s/iter; left time: 9072.7305s
Epoch: 5 cost time: 45.615652084350586
Epoch: 5, Steps: 134 | Train Loss: 3.873 Vali Loss: 8.984 Vali Acc: 0.757 Test Loss: 8.984 Test Acc: 0.757
Validation loss decreased (-0.699289 --> -0.757136).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7163s/iter; left time: 9047.7925s
Epoch: 6 cost time: 45.21618890762329
Epoch: 6, Steps: 134 | Train Loss: 0.829 Vali Loss: 18.633 Vali Acc: 0.728 Test Loss: 18.633 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7076s/iter; left time: 8842.9278s
Epoch: 7 cost time: 45.73629832267761
Epoch: 7, Steps: 134 | Train Loss: 1.969 Vali Loss: 8.782 Vali Acc: 0.775 Test Loss: 8.782 Test Acc: 0.775
Validation loss decreased (-0.757136 --> -0.774479).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7200s/iter; left time: 8901.7606s
Epoch: 8 cost time: 45.502201318740845
Epoch: 8, Steps: 134 | Train Loss: 3.501 Vali Loss: 42.360 Vali Acc: 0.584 Test Loss: 42.360 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 4.6917343
	speed: 0.7136s/iter; left time: 8726.5523s
Epoch: 9 cost time: 45.672032833099365
Epoch: 9, Steps: 134 | Train Loss: 3.656 Vali Loss: 21.525 Vali Acc: 0.723 Test Loss: 21.525 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7168s/iter; left time: 8669.2966s
Epoch: 10 cost time: 45.833335399627686
Epoch: 10, Steps: 134 | Train Loss: 3.099 Vali Loss: 37.938 Vali Acc: 0.630 Test Loss: 37.938 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7120s/iter; left time: 8516.7755s
Epoch: 11 cost time: 45.56485104560852
Epoch: 11, Steps: 134 | Train Loss: 1.288 Vali Loss: 33.420 Vali Acc: 0.717 Test Loss: 33.420 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7134s/iter; left time: 8437.8529s
Epoch: 12 cost time: 45.67928957939148
Epoch: 12, Steps: 134 | Train Loss: 1.102 Vali Loss: 20.918 Vali Acc: 0.711 Test Loss: 20.918 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7070s/iter; left time: 8267.2177s
Epoch: 13 cost time: 45.60234522819519
Epoch: 13, Steps: 134 | Train Loss: 1.446 Vali Loss: 37.697 Vali Acc: 0.642 Test Loss: 37.697 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7152s/iter; left time: 8267.2375s
Epoch: 14 cost time: 45.73800206184387
Epoch: 14, Steps: 134 | Train Loss: 0.299 Vali Loss: 15.186 Vali Acc: 0.780 Test Loss: 15.186 Test Acc: 0.780
Validation loss decreased (-0.774479 --> -0.780195).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7291s/iter; left time: 8329.9865s
Epoch: 15 cost time: 45.66560173034668
Epoch: 15, Steps: 134 | Train Loss: 3.974 Vali Loss: 66.902 Vali Acc: 0.647 Test Loss: 66.902 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7086s/iter; left time: 8000.5477s
Epoch: 16 cost time: 45.77859282493591
Epoch: 16, Steps: 134 | Train Loss: 2.276 Vali Loss: 22.550 Vali Acc: 0.746 Test Loss: 22.550 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7098s/iter; left time: 7918.9776s
Epoch: 17 cost time: 45.42288017272949
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 27.455 Vali Acc: 0.827 Test Loss: 27.455 Test Acc: 0.827
Validation loss decreased (-0.780195 --> -0.826315).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.7175s/iter; left time: 7908.8172s
Epoch: 18 cost time: 45.35125732421875
Epoch: 18, Steps: 134 | Train Loss: 9.328 Vali Loss: 23.121 Vali Acc: 0.780 Test Loss: 23.121 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.7141s/iter; left time: 7775.5078s
Epoch: 19 cost time: 45.52491474151611
Epoch: 19, Steps: 134 | Train Loss: 0.322 Vali Loss: 42.448 Vali Acc: 0.757 Test Loss: 42.448 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.7115s/iter; left time: 7652.6036s
Epoch: 20 cost time: 45.39497709274292
Epoch: 20, Steps: 134 | Train Loss: 0.711 Vali Loss: 20.016 Vali Acc: 0.838 Test Loss: 20.016 Test Acc: 0.838
Validation loss decreased (-0.826315 --> -0.837950).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7265s/iter; left time: 7716.2799s
Epoch: 21 cost time: 45.622570514678955
Epoch: 21, Steps: 134 | Train Loss: 2.461 Vali Loss: 23.132 Vali Acc: 0.728 Test Loss: 23.132 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.7134s/iter; left time: 7481.3471s
Epoch: 22 cost time: 45.52239274978638
Epoch: 22, Steps: 134 | Train Loss: 0.999 Vali Loss: 36.403 Vali Acc: 0.682 Test Loss: 36.403 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.7121s/iter; left time: 7372.6877s
Epoch: 23 cost time: 45.457839250564575
Epoch: 23, Steps: 134 | Train Loss: 0.171 Vali Loss: 33.536 Vali Acc: 0.775 Test Loss: 33.536 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.7136s/iter; left time: 7292.5843s
Epoch: 24 cost time: 45.53328776359558
Epoch: 24, Steps: 134 | Train Loss: 0.772 Vali Loss: 34.293 Vali Acc: 0.699 Test Loss: 34.293 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.7158s/iter; left time: 7218.5924s
Epoch: 25 cost time: 45.74310231208801
Epoch: 25, Steps: 134 | Train Loss: 0.509 Vali Loss: 38.857 Vali Acc: 0.803 Test Loss: 38.857 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.7145s/iter; left time: 7109.5730s
Epoch: 26 cost time: 45.87364411354065
Epoch: 26, Steps: 134 | Train Loss: 0.000 Vali Loss: 38.263 Vali Acc: 0.803 Test Loss: 38.263 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.7172s/iter; left time: 7040.9093s
Epoch: 27 cost time: 45.80834126472473
Epoch: 27, Steps: 134 | Train Loss: 1.637 Vali Loss: 39.723 Vali Acc: 0.728 Test Loss: 39.723 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.7139s/iter; left time: 6913.1422s
Epoch: 28 cost time: 45.42232084274292
Epoch: 28, Steps: 134 | Train Loss: 0.136 Vali Loss: 33.493 Vali Acc: 0.786 Test Loss: 33.493 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.7156s/iter; left time: 6833.0664s
Epoch: 29 cost time: 45.527812004089355
Epoch: 29, Steps: 134 | Train Loss: 0.000 Vali Loss: 37.058 Vali Acc: 0.780 Test Loss: 37.058 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.7069s/iter; left time: 6655.3168s
Epoch: 30 cost time: 45.18925738334656
Epoch: 30, Steps: 134 | Train Loss: 0.000 Vali Loss: 37.033 Vali Acc: 0.780 Test Loss: 37.033 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 31138567
model size : 120.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.48446273803711
Epoch: 1, Steps: 67 | Train Loss: 32.139 Vali Loss: 52.803 Vali Acc: 0.324 Test Loss: 52.803 Test Acc: 0.324
Validation loss decreased (inf --> -0.323171).  Saving model ...
Epoch: 2 cost time: 17.51865577697754
Epoch: 2, Steps: 67 | Train Loss: 16.106 Vali Loss: 12.449 Vali Acc: 0.445 Test Loss: 12.449 Test Acc: 0.445
Validation loss decreased (-0.323171 --> -0.444962).  Saving model ...
Epoch: 3 cost time: 17.831191539764404
Epoch: 3, Steps: 67 | Train Loss: 0.669 Vali Loss: 1.089 Vali Acc: 0.769 Test Loss: 1.089 Test Acc: 0.769
Validation loss decreased (-0.444962 --> -0.768775).  Saving model ...
Epoch: 4 cost time: 17.854950189590454
Epoch: 4, Steps: 67 | Train Loss: 0.228 Vali Loss: 2.601 Vali Acc: 0.803 Test Loss: 2.601 Test Acc: 0.803
Validation loss decreased (-0.768775 --> -0.803442).  Saving model ...
Epoch: 5 cost time: 17.832460403442383
Epoch: 5, Steps: 67 | Train Loss: 0.920 Vali Loss: 15.252 Vali Acc: 0.659 Test Loss: 15.252 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.730053663253784
Epoch: 6, Steps: 67 | Train Loss: 0.843 Vali Loss: 12.972 Vali Acc: 0.699 Test Loss: 12.972 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.834925413131714
Epoch: 7, Steps: 67 | Train Loss: 1.034 Vali Loss: 19.235 Vali Acc: 0.491 Test Loss: 19.235 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.754319429397583
Epoch: 8, Steps: 67 | Train Loss: 1.197 Vali Loss: 7.150 Vali Acc: 0.746 Test Loss: 7.150 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.838496923446655
Epoch: 9, Steps: 67 | Train Loss: 0.461 Vali Loss: 4.025 Vali Acc: 0.746 Test Loss: 4.025 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 17.854017972946167
Epoch: 10, Steps: 67 | Train Loss: 0.685 Vali Loss: 7.342 Vali Acc: 0.775 Test Loss: 7.342 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.83332633972168
Epoch: 11, Steps: 67 | Train Loss: 1.336 Vali Loss: 7.988 Vali Acc: 0.728 Test Loss: 7.988 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 17.91335439682007
Epoch: 12, Steps: 67 | Train Loss: 0.792 Vali Loss: 2.533 Vali Acc: 0.821 Test Loss: 2.533 Test Acc: 0.821
Validation loss decreased (-0.803442 --> -0.820784).  Saving model ...
Epoch: 13 cost time: 17.84944438934326
Epoch: 13, Steps: 67 | Train Loss: 0.188 Vali Loss: 3.876 Vali Acc: 0.827 Test Loss: 3.876 Test Acc: 0.827
Validation loss decreased (-0.820784 --> -0.826551).  Saving model ...
Epoch: 14 cost time: 17.839027166366577
Epoch: 14, Steps: 67 | Train Loss: 0.309 Vali Loss: 14.542 Vali Acc: 0.734 Test Loss: 14.542 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.81906747817993
Epoch: 15, Steps: 67 | Train Loss: 0.333 Vali Loss: 8.448 Vali Acc: 0.769 Test Loss: 8.448 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.038614988327026
Epoch: 16, Steps: 67 | Train Loss: 0.246 Vali Loss: 11.142 Vali Acc: 0.780 Test Loss: 11.142 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.76563262939453
Epoch: 17, Steps: 67 | Train Loss: 1.401 Vali Loss: 12.660 Vali Acc: 0.769 Test Loss: 12.660 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.822243452072144
Epoch: 18, Steps: 67 | Train Loss: 1.246 Vali Loss: 11.492 Vali Acc: 0.775 Test Loss: 11.492 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.626172304153442
Epoch: 19, Steps: 67 | Train Loss: 0.286 Vali Loss: 6.827 Vali Acc: 0.809 Test Loss: 6.827 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 17.80306577682495
Epoch: 20, Steps: 67 | Train Loss: 0.798 Vali Loss: 7.548 Vali Acc: 0.786 Test Loss: 7.548 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.742274284362793
Epoch: 21, Steps: 67 | Train Loss: 0.110 Vali Loss: 22.894 Vali Acc: 0.636 Test Loss: 22.894 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.756441354751587
Epoch: 22, Steps: 67 | Train Loss: 0.636 Vali Loss: 42.689 Vali Acc: 0.671 Test Loss: 42.689 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.878451824188232
Epoch: 23, Steps: 67 | Train Loss: 1.656 Vali Loss: 15.738 Vali Acc: 0.775 Test Loss: 15.738 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 15607559
model size : 60.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.041677713394165
Epoch: 1, Steps: 67 | Train Loss: 19.479 Vali Loss: 18.131 Vali Acc: 0.491 Test Loss: 18.131 Test Acc: 0.491
Validation loss decreased (inf --> -0.491148).  Saving model ...
Epoch: 2 cost time: 11.781147241592407
Epoch: 2, Steps: 67 | Train Loss: 9.945 Vali Loss: 6.027 Vali Acc: 0.740 Test Loss: 6.027 Test Acc: 0.740
Validation loss decreased (-0.491148 --> -0.739824).  Saving model ...
Epoch: 3 cost time: 11.860509872436523
Epoch: 3, Steps: 67 | Train Loss: 5.719 Vali Loss: 12.424 Vali Acc: 0.659 Test Loss: 12.424 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.247394561767578
Epoch: 4, Steps: 67 | Train Loss: 1.060 Vali Loss: 6.698 Vali Acc: 0.757 Test Loss: 6.698 Test Acc: 0.757
Validation loss decreased (-0.739824 --> -0.757158).  Saving model ...
Epoch: 5 cost time: 12.006338834762573
Epoch: 5, Steps: 67 | Train Loss: 0.119 Vali Loss: 3.463 Vali Acc: 0.803 Test Loss: 3.463 Test Acc: 0.803
Validation loss decreased (-0.757158 --> -0.803434).  Saving model ...
Epoch: 6 cost time: 11.931870937347412
Epoch: 6, Steps: 67 | Train Loss: 0.671 Vali Loss: 4.610 Vali Acc: 0.792 Test Loss: 4.610 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.969714164733887
Epoch: 7, Steps: 67 | Train Loss: 0.255 Vali Loss: 2.309 Vali Acc: 0.803 Test Loss: 2.309 Test Acc: 0.803
Validation loss decreased (-0.803434 --> -0.803445).  Saving model ...
Epoch: 8 cost time: 12.005613803863525
Epoch: 8, Steps: 67 | Train Loss: 0.222 Vali Loss: 3.649 Vali Acc: 0.803 Test Loss: 3.649 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.054231405258179
Epoch: 9, Steps: 67 | Train Loss: 0.089 Vali Loss: 4.506 Vali Acc: 0.757 Test Loss: 4.506 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.975147008895874
Epoch: 10, Steps: 67 | Train Loss: 0.303 Vali Loss: 9.910 Vali Acc: 0.665 Test Loss: 9.910 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.936811923980713
Epoch: 11, Steps: 67 | Train Loss: 0.405 Vali Loss: 7.684 Vali Acc: 0.798 Test Loss: 7.684 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.023796796798706
Epoch: 12, Steps: 67 | Train Loss: 0.021 Vali Loss: 10.170 Vali Acc: 0.734 Test Loss: 10.170 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 12.03687310218811
Epoch: 13, Steps: 67 | Train Loss: 0.368 Vali Loss: 15.814 Vali Acc: 0.699 Test Loss: 15.814 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.961228609085083
Epoch: 14, Steps: 67 | Train Loss: 1.262 Vali Loss: 11.595 Vali Acc: 0.728 Test Loss: 11.595 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.099863052368164
Epoch: 15, Steps: 67 | Train Loss: 1.491 Vali Loss: 7.099 Vali Acc: 0.798 Test Loss: 7.099 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.160325765609741
Epoch: 16, Steps: 67 | Train Loss: 0.337 Vali Loss: 21.784 Vali Acc: 0.636 Test Loss: 21.784 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.033836603164673
Epoch: 17, Steps: 67 | Train Loss: 0.812 Vali Loss: 48.041 Vali Acc: 0.514 Test Loss: 48.041 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 10430663
model size : 41.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.635208368301392
Epoch: 1, Steps: 67 | Train Loss: 13.980 Vali Loss: 20.771 Vali Acc: 0.549 Test Loss: 20.771 Test Acc: 0.549
Validation loss decreased (inf --> -0.548925).  Saving model ...
Epoch: 2 cost time: 10.278841257095337
Epoch: 2, Steps: 67 | Train Loss: 6.500 Vali Loss: 7.113 Vali Acc: 0.480 Test Loss: 7.113 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.380579710006714
Epoch: 3, Steps: 67 | Train Loss: 1.050 Vali Loss: 1.746 Vali Acc: 0.792 Test Loss: 1.746 Test Acc: 0.792
Validation loss decreased (-0.548925 --> -0.791890).  Saving model ...
Epoch: 4 cost time: 10.437979221343994
Epoch: 4, Steps: 67 | Train Loss: 0.191 Vali Loss: 2.888 Vali Acc: 0.705 Test Loss: 2.888 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.616336345672607
Epoch: 5, Steps: 67 | Train Loss: 0.213 Vali Loss: 3.098 Vali Acc: 0.786 Test Loss: 3.098 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.711130857467651
Epoch: 6, Steps: 67 | Train Loss: 0.098 Vali Loss: 4.235 Vali Acc: 0.763 Test Loss: 4.235 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.543566226959229
Epoch: 7, Steps: 67 | Train Loss: 0.466 Vali Loss: 3.219 Vali Acc: 0.734 Test Loss: 3.219 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.563542366027832
Epoch: 8, Steps: 67 | Train Loss: 0.623 Vali Loss: 2.083 Vali Acc: 0.827 Test Loss: 2.083 Test Acc: 0.827
Validation loss decreased (-0.791890 --> -0.826569).  Saving model ...
Epoch: 9 cost time: 10.573439359664917
Epoch: 9, Steps: 67 | Train Loss: 0.004 Vali Loss: 2.713 Vali Acc: 0.798 Test Loss: 2.713 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.71100640296936
Epoch: 10, Steps: 67 | Train Loss: 1.494 Vali Loss: 1.517 Vali Acc: 0.740 Test Loss: 1.517 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.73413372039795
Epoch: 11, Steps: 67 | Train Loss: 0.458 Vali Loss: 6.646 Vali Acc: 0.728 Test Loss: 6.646 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.54242753982544
Epoch: 12, Steps: 67 | Train Loss: 0.685 Vali Loss: 5.080 Vali Acc: 0.786 Test Loss: 5.080 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.831328392028809
Epoch: 13, Steps: 67 | Train Loss: 0.614 Vali Loss: 5.260 Vali Acc: 0.815 Test Loss: 5.260 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.529730081558228
Epoch: 14, Steps: 67 | Train Loss: 0.140 Vali Loss: 11.930 Vali Acc: 0.728 Test Loss: 11.930 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.548340559005737
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.837 Vali Acc: 0.798 Test Loss: 9.837 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.668949365615845
Epoch: 16, Steps: 67 | Train Loss: 0.124 Vali Loss: 9.221 Vali Acc: 0.798 Test Loss: 9.221 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.475165843963623
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.679 Vali Acc: 0.775 Test Loss: 10.679 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.585590362548828
Epoch: 18, Steps: 67 | Train Loss: 0.012 Vali Loss: 9.603 Vali Acc: 0.780 Test Loss: 9.603 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7842375
model size : 31.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.326660633087158
Epoch: 1, Steps: 67 | Train Loss: 11.308 Vali Loss: 12.631 Vali Acc: 0.526 Test Loss: 12.631 Test Acc: 0.526
Validation loss decreased (inf --> -0.525885).  Saving model ...
Epoch: 2 cost time: 6.768521547317505
Epoch: 2, Steps: 67 | Train Loss: 9.592 Vali Loss: 3.161 Vali Acc: 0.624 Test Loss: 3.161 Test Acc: 0.624
Validation loss decreased (-0.525885 --> -0.624246).  Saving model ...
Epoch: 3 cost time: 6.923467636108398
Epoch: 3, Steps: 67 | Train Loss: 0.821 Vali Loss: 2.543 Vali Acc: 0.751 Test Loss: 2.543 Test Acc: 0.751
Validation loss decreased (-0.624246 --> -0.751420).  Saving model ...
Epoch: 4 cost time: 6.936716556549072
Epoch: 4, Steps: 67 | Train Loss: 0.192 Vali Loss: 1.492 Vali Acc: 0.769 Test Loss: 1.492 Test Acc: 0.769
Validation loss decreased (-0.751420 --> -0.768771).  Saving model ...
Epoch: 5 cost time: 6.933037042617798
Epoch: 5, Steps: 67 | Train Loss: 0.129 Vali Loss: 1.918 Vali Acc: 0.798 Test Loss: 1.918 Test Acc: 0.798
Validation loss decreased (-0.768771 --> -0.797669).  Saving model ...
Epoch: 6 cost time: 7.0425310134887695
Epoch: 6, Steps: 67 | Train Loss: 0.073 Vali Loss: 1.860 Vali Acc: 0.786 Test Loss: 1.860 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.0509068965911865
Epoch: 7, Steps: 67 | Train Loss: 0.073 Vali Loss: 3.030 Vali Acc: 0.682 Test Loss: 3.030 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.026592493057251
Epoch: 8, Steps: 67 | Train Loss: 0.053 Vali Loss: 5.354 Vali Acc: 0.705 Test Loss: 5.354 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.140516042709351
Epoch: 9, Steps: 67 | Train Loss: 0.210 Vali Loss: 3.199 Vali Acc: 0.734 Test Loss: 3.199 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.180848121643066
Epoch: 10, Steps: 67 | Train Loss: 0.377 Vali Loss: 4.676 Vali Acc: 0.734 Test Loss: 4.676 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.157393932342529
Epoch: 11, Steps: 67 | Train Loss: 0.708 Vali Loss: 2.956 Vali Acc: 0.798 Test Loss: 2.956 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.139674425125122
Epoch: 12, Steps: 67 | Train Loss: 0.659 Vali Loss: 8.165 Vali Acc: 0.699 Test Loss: 8.165 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.153520584106445
Epoch: 13, Steps: 67 | Train Loss: 0.906 Vali Loss: 28.961 Vali Acc: 0.520 Test Loss: 28.961 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.126171350479126
Epoch: 14, Steps: 67 | Train Loss: 0.478 Vali Loss: 8.244 Vali Acc: 0.734 Test Loss: 8.244 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.284118413925171
Epoch: 15, Steps: 67 | Train Loss: 0.583 Vali Loss: 11.966 Vali Acc: 0.705 Test Loss: 11.966 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 5685703
model size : 22.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.949278354644775
Epoch: 1, Steps: 67 | Train Loss: 6.908 Vali Loss: 4.510 Vali Acc: 0.595 Test Loss: 4.510 Test Acc: 0.595
Validation loss decreased (inf --> -0.595331).  Saving model ...
Epoch: 2 cost time: 5.609199523925781
Epoch: 2, Steps: 67 | Train Loss: 3.497 Vali Loss: 2.985 Vali Acc: 0.711 Test Loss: 2.985 Test Acc: 0.711
Validation loss decreased (-0.595331 --> -0.710953).  Saving model ...
Epoch: 3 cost time: 5.503659248352051
Epoch: 3, Steps: 67 | Train Loss: 1.488 Vali Loss: 2.407 Vali Acc: 0.798 Test Loss: 2.407 Test Acc: 0.798
Validation loss decreased (-0.710953 --> -0.797664).  Saving model ...
Epoch: 4 cost time: 5.547817945480347
Epoch: 4, Steps: 67 | Train Loss: 0.368 Vali Loss: 1.367 Vali Acc: 0.780 Test Loss: 1.367 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.579207181930542
Epoch: 5, Steps: 67 | Train Loss: 0.121 Vali Loss: 2.444 Vali Acc: 0.792 Test Loss: 2.444 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5759437084198
Epoch: 6, Steps: 67 | Train Loss: 0.009 Vali Loss: 1.804 Vali Acc: 0.867 Test Loss: 1.804 Test Acc: 0.867
Validation loss decreased (-0.797664 --> -0.867034).  Saving model ...
Epoch: 7 cost time: 5.523933410644531
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.844 Test Loss: 1.437 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.58919095993042
Epoch: 8, Steps: 67 | Train Loss: 0.074 Vali Loss: 3.395 Vali Acc: 0.746 Test Loss: 3.395 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.603676795959473
Epoch: 9, Steps: 67 | Train Loss: 0.066 Vali Loss: 1.442 Vali Acc: 0.798 Test Loss: 1.442 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.629591703414917
Epoch: 10, Steps: 67 | Train Loss: 0.213 Vali Loss: 4.811 Vali Acc: 0.671 Test Loss: 4.811 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.564512729644775
Epoch: 11, Steps: 67 | Train Loss: 0.906 Vali Loss: 5.987 Vali Acc: 0.671 Test Loss: 5.987 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.5535500049591064
Epoch: 12, Steps: 67 | Train Loss: 0.364 Vali Loss: 5.307 Vali Acc: 0.699 Test Loss: 5.307 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.65805721282959
Epoch: 13, Steps: 67 | Train Loss: 0.397 Vali Loss: 4.515 Vali Acc: 0.792 Test Loss: 4.515 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.5972089767456055
Epoch: 14, Steps: 67 | Train Loss: 0.150 Vali Loss: 4.855 Vali Acc: 0.827 Test Loss: 4.855 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.697737455368042
Epoch: 15, Steps: 67 | Train Loss: 0.389 Vali Loss: 6.469 Vali Acc: 0.728 Test Loss: 6.469 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.6141462326049805
Epoch: 16, Steps: 67 | Train Loss: 0.765 Vali Loss: 23.661 Vali Acc: 0.584 Test Loss: 23.661 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 3960455
model size : 16.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.0652101039886475
Epoch: 1, Steps: 67 | Train Loss: 6.252 Vali Loss: 6.592 Vali Acc: 0.462 Test Loss: 6.592 Test Acc: 0.462
Validation loss decreased (inf --> -0.462362).  Saving model ...
Epoch: 2 cost time: 4.69438624382019
Epoch: 2, Steps: 67 | Train Loss: 4.662 Vali Loss: 5.521 Vali Acc: 0.613 Test Loss: 5.521 Test Acc: 0.613
Validation loss decreased (-0.462362 --> -0.612662).  Saving model ...
Epoch: 3 cost time: 4.711092233657837
Epoch: 3, Steps: 67 | Train Loss: 1.372 Vali Loss: 2.617 Vali Acc: 0.786 Test Loss: 2.617 Test Acc: 0.786
Validation loss decreased (-0.612662 --> -0.786101).  Saving model ...
Epoch: 4 cost time: 4.690747976303101
Epoch: 4, Steps: 67 | Train Loss: 0.307 Vali Loss: 0.951 Vali Acc: 0.832 Test Loss: 0.951 Test Acc: 0.832
Validation loss decreased (-0.786101 --> -0.832360).  Saving model ...
Epoch: 5 cost time: 4.787968873977661
Epoch: 5, Steps: 67 | Train Loss: 0.057 Vali Loss: 3.779 Vali Acc: 0.711 Test Loss: 3.779 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.649423599243164
Epoch: 6, Steps: 67 | Train Loss: 0.395 Vali Loss: 2.869 Vali Acc: 0.717 Test Loss: 2.869 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.737762928009033
Epoch: 7, Steps: 67 | Train Loss: 0.471 Vali Loss: 5.365 Vali Acc: 0.740 Test Loss: 5.365 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.826425790786743
Epoch: 8, Steps: 67 | Train Loss: 0.629 Vali Loss: 1.287 Vali Acc: 0.827 Test Loss: 1.287 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.707833766937256
Epoch: 9, Steps: 67 | Train Loss: 0.115 Vali Loss: 2.336 Vali Acc: 0.780 Test Loss: 2.336 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.728686571121216
Epoch: 10, Steps: 67 | Train Loss: 0.050 Vali Loss: 7.379 Vali Acc: 0.607 Test Loss: 7.379 Test Acc: 0.607
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.692668437957764
Epoch: 11, Steps: 67 | Train Loss: 0.146 Vali Loss: 4.348 Vali Acc: 0.746 Test Loss: 4.348 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.6781675815582275
Epoch: 12, Steps: 67 | Train Loss: 0.203 Vali Loss: 7.444 Vali Acc: 0.751 Test Loss: 7.444 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.928144454956055
Epoch: 13, Steps: 67 | Train Loss: 0.514 Vali Loss: 20.780 Vali Acc: 0.538 Test Loss: 20.780 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.705247640609741
Epoch: 14, Steps: 67 | Train Loss: 0.306 Vali Loss: 5.112 Vali Acc: 0.757 Test Loss: 5.112 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3529479
model size : 14.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 30.2724514
	speed: 0.1734s/iter; left time: 2306.0850s
Epoch: 1 cost time: 22.704494953155518
Epoch: 1, Steps: 134 | Train Loss: 70.935 Vali Loss: 53.998 Vali Acc: 0.584 Test Loss: 53.998 Test Acc: 0.584
Validation loss decreased (inf --> -0.583275).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.3415s/iter; left time: 4495.8902s
Epoch: 2 cost time: 21.814359426498413
Epoch: 2, Steps: 134 | Train Loss: 26.154 Vali Loss: 12.855 Vali Acc: 0.526 Test Loss: 12.855 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.3432s/iter; left time: 4472.8517s
Epoch: 3 cost time: 21.75024104118347
Epoch: 3, Steps: 134 | Train Loss: 0.763 Vali Loss: 8.040 Vali Acc: 0.659 Test Loss: 8.040 Test Acc: 0.659
Validation loss decreased (-0.583275 --> -0.658879).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000971
	speed: 0.3434s/iter; left time: 4428.9464s
Epoch: 4 cost time: 21.661589860916138
Epoch: 4, Steps: 134 | Train Loss: 1.063 Vali Loss: 8.140 Vali Acc: 0.624 Test Loss: 8.140 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.3407s/iter; left time: 4349.0834s
Epoch: 5 cost time: 21.76542901992798
Epoch: 5, Steps: 134 | Train Loss: 0.967 Vali Loss: 13.798 Vali Acc: 0.665 Test Loss: 13.798 Test Acc: 0.665
Validation loss decreased (-0.658879 --> -0.664602).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000725
	speed: 0.3469s/iter; left time: 4381.6051s
Epoch: 6 cost time: 21.811681270599365
Epoch: 6, Steps: 134 | Train Loss: 2.027 Vali Loss: 4.723 Vali Acc: 0.763 Test Loss: 4.723 Test Acc: 0.763
Validation loss decreased (-0.664602 --> -0.762959).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000135
	speed: 0.3504s/iter; left time: 4378.9758s
Epoch: 7 cost time: 21.759231328964233
Epoch: 7, Steps: 134 | Train Loss: 1.317 Vali Loss: 19.850 Vali Acc: 0.717 Test Loss: 19.850 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3435s/iter; left time: 4246.2865s
Epoch: 8 cost time: 21.83137583732605
Epoch: 8, Steps: 134 | Train Loss: 0.714 Vali Loss: 4.458 Vali Acc: 0.786 Test Loss: 4.458 Test Acc: 0.786
Validation loss decreased (-0.762959 --> -0.786083).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3545s/iter; left time: 4334.9234s
Epoch: 9 cost time: 21.836726903915405
Epoch: 9, Steps: 134 | Train Loss: 0.818 Vali Loss: 8.190 Vali Acc: 0.590 Test Loss: 8.190 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3427s/iter; left time: 4145.4888s
Epoch: 10 cost time: 21.716737031936646
Epoch: 10, Steps: 134 | Train Loss: 0.637 Vali Loss: 11.460 Vali Acc: 0.740 Test Loss: 11.460 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 27.8362026
	speed: 0.3459s/iter; left time: 4137.1682s
Epoch: 11 cost time: 21.779672861099243
Epoch: 11, Steps: 134 | Train Loss: 0.404 Vali Loss: 32.304 Vali Acc: 0.671 Test Loss: 32.304 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3400s/iter; left time: 4021.1812s
Epoch: 12 cost time: 21.941393852233887
Epoch: 12, Steps: 134 | Train Loss: 3.682 Vali Loss: 18.153 Vali Acc: 0.601 Test Loss: 18.153 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 25.3051567
	speed: 0.3410s/iter; left time: 3987.2448s
Epoch: 13 cost time: 21.627387523651123
Epoch: 13, Steps: 134 | Train Loss: 1.612 Vali Loss: 17.848 Vali Acc: 0.705 Test Loss: 17.848 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 28.0599804
	speed: 0.3443s/iter; left time: 3980.0350s
Epoch: 14 cost time: 21.81698966026306
Epoch: 14, Steps: 134 | Train Loss: 1.278 Vali Loss: 14.427 Vali Acc: 0.740 Test Loss: 14.427 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3400s/iter; left time: 3884.7680s
Epoch: 15 cost time: 21.659025192260742
Epoch: 15, Steps: 134 | Train Loss: 1.820 Vali Loss: 19.310 Vali Acc: 0.740 Test Loss: 19.310 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3392s/iter; left time: 3829.4537s
Epoch: 16 cost time: 21.751966953277588
Epoch: 16, Steps: 134 | Train Loss: 0.082 Vali Loss: 19.592 Vali Acc: 0.734 Test Loss: 19.592 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3425s/iter; left time: 3821.1521s
Epoch: 17 cost time: 21.7749445438385
Epoch: 17, Steps: 134 | Train Loss: 0.071 Vali Loss: 52.908 Vali Acc: 0.624 Test Loss: 52.908 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3492s/iter; left time: 3849.4861s
Epoch: 18 cost time: 21.832000970840454
Epoch: 18, Steps: 134 | Train Loss: 2.026 Vali Loss: 31.049 Vali Acc: 0.694 Test Loss: 31.049 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 15594535
model size : 60.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.879766941070557
Epoch: 1, Steps: 67 | Train Loss: 20.793 Vali Loss: 42.262 Vali Acc: 0.335 Test Loss: 42.262 Test Acc: 0.335
Validation loss decreased (inf --> -0.334837).  Saving model ...
Epoch: 2 cost time: 10.320810794830322
Epoch: 2, Steps: 67 | Train Loss: 12.333 Vali Loss: 6.393 Vali Acc: 0.671 Test Loss: 6.393 Test Acc: 0.671
Validation loss decreased (-0.334837 --> -0.670456).  Saving model ...
Epoch: 3 cost time: 10.383039236068726
Epoch: 3, Steps: 67 | Train Loss: 2.575 Vali Loss: 2.892 Vali Acc: 0.665 Test Loss: 2.892 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.400179386138916
Epoch: 4, Steps: 67 | Train Loss: 0.265 Vali Loss: 2.369 Vali Acc: 0.809 Test Loss: 2.369 Test Acc: 0.809
Validation loss decreased (-0.670456 --> -0.809225).  Saving model ...
Epoch: 5 cost time: 10.392833709716797
Epoch: 5, Steps: 67 | Train Loss: 0.141 Vali Loss: 3.916 Vali Acc: 0.775 Test Loss: 3.916 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.35875940322876
Epoch: 6, Steps: 67 | Train Loss: 0.051 Vali Loss: 2.855 Vali Acc: 0.792 Test Loss: 2.855 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.27849531173706
Epoch: 7, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.599 Vali Acc: 0.792 Test Loss: 2.599 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.359486818313599
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.821 Test Loss: 2.252 Test Acc: 0.821
Validation loss decreased (-0.809225 --> -0.820787).  Saving model ...
Epoch: 9 cost time: 10.44078803062439
Epoch: 9, Steps: 67 | Train Loss: 0.220 Vali Loss: 9.551 Vali Acc: 0.636 Test Loss: 9.551 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.525943279266357
Epoch: 10, Steps: 67 | Train Loss: 1.856 Vali Loss: 6.619 Vali Acc: 0.624 Test Loss: 6.619 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.3817720413208
Epoch: 11, Steps: 67 | Train Loss: 0.597 Vali Loss: 4.194 Vali Acc: 0.711 Test Loss: 4.194 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.354726791381836
Epoch: 12, Steps: 67 | Train Loss: 0.690 Vali Loss: 3.441 Vali Acc: 0.815 Test Loss: 3.441 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.41439938545227
Epoch: 13, Steps: 67 | Train Loss: 0.408 Vali Loss: 4.092 Vali Acc: 0.769 Test Loss: 4.092 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.423704624176025
Epoch: 14, Steps: 67 | Train Loss: 0.238 Vali Loss: 12.286 Vali Acc: 0.676 Test Loss: 12.286 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.475675821304321
Epoch: 15, Steps: 67 | Train Loss: 0.349 Vali Loss: 6.241 Vali Acc: 0.769 Test Loss: 6.241 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.346804141998291
Epoch: 16, Steps: 67 | Train Loss: 0.148 Vali Loss: 9.815 Vali Acc: 0.780 Test Loss: 9.815 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.399965286254883
Epoch: 17, Steps: 67 | Train Loss: 0.647 Vali Loss: 5.994 Vali Acc: 0.746 Test Loss: 5.994 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.460722208023071
Epoch: 18, Steps: 67 | Train Loss: 0.133 Vali Loss: 5.273 Vali Acc: 0.786 Test Loss: 5.273 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 7829031
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.589914321899414
Epoch: 1, Steps: 67 | Train Loss: 10.859 Vali Loss: 5.999 Vali Acc: 0.445 Test Loss: 5.999 Test Acc: 0.445
Validation loss decreased (inf --> -0.445027).  Saving model ...
Epoch: 2 cost time: 6.084859848022461
Epoch: 2, Steps: 67 | Train Loss: 6.966 Vali Loss: 5.035 Vali Acc: 0.659 Test Loss: 5.035 Test Acc: 0.659
Validation loss decreased (-0.445027 --> -0.658909).  Saving model ...
Epoch: 3 cost time: 6.211147308349609
Epoch: 3, Steps: 67 | Train Loss: 1.434 Vali Loss: 7.164 Vali Acc: 0.705 Test Loss: 7.164 Test Acc: 0.705
Validation loss decreased (-0.658909 --> -0.705131).  Saving model ...
Epoch: 4 cost time: 6.1572229862213135
Epoch: 4, Steps: 67 | Train Loss: 0.655 Vali Loss: 5.647 Vali Acc: 0.746 Test Loss: 5.647 Test Acc: 0.746
Validation loss decreased (-0.705131 --> -0.745608).  Saving model ...
Epoch: 5 cost time: 6.136520147323608
Epoch: 5, Steps: 67 | Train Loss: 0.015 Vali Loss: 5.597 Vali Acc: 0.671 Test Loss: 5.597 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.373066186904907
Epoch: 6, Steps: 67 | Train Loss: 0.219 Vali Loss: 7.239 Vali Acc: 0.734 Test Loss: 7.239 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.278126239776611
Epoch: 7, Steps: 67 | Train Loss: 0.567 Vali Loss: 4.270 Vali Acc: 0.757 Test Loss: 4.270 Test Acc: 0.757
Validation loss decreased (-0.745608 --> -0.757183).  Saving model ...
Epoch: 8 cost time: 6.248736381530762
Epoch: 8, Steps: 67 | Train Loss: 0.355 Vali Loss: 10.787 Vali Acc: 0.607 Test Loss: 10.787 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.298985004425049
Epoch: 9, Steps: 67 | Train Loss: 0.250 Vali Loss: 2.712 Vali Acc: 0.827 Test Loss: 2.712 Test Acc: 0.827
Validation loss decreased (-0.757183 --> -0.826562).  Saving model ...
Epoch: 10 cost time: 6.191229820251465
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.195 Vali Acc: 0.780 Test Loss: 3.195 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.257312297821045
Epoch: 11, Steps: 67 | Train Loss: 0.242 Vali Loss: 3.004 Vali Acc: 0.809 Test Loss: 3.004 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.233731985092163
Epoch: 12, Steps: 67 | Train Loss: 0.075 Vali Loss: 8.679 Vali Acc: 0.728 Test Loss: 8.679 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.48348593711853
Epoch: 13, Steps: 67 | Train Loss: 0.406 Vali Loss: 11.854 Vali Acc: 0.682 Test Loss: 11.854 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.291021108627319
Epoch: 14, Steps: 67 | Train Loss: 0.448 Vali Loss: 8.770 Vali Acc: 0.676 Test Loss: 8.770 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.31209135055542
Epoch: 15, Steps: 67 | Train Loss: 0.521 Vali Loss: 4.103 Vali Acc: 0.763 Test Loss: 4.103 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.415925979614258
Epoch: 16, Steps: 67 | Train Loss: 0.253 Vali Loss: 6.951 Vali Acc: 0.740 Test Loss: 6.951 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.420575857162476
Epoch: 17, Steps: 67 | Train Loss: 0.401 Vali Loss: 12.479 Vali Acc: 0.618 Test Loss: 12.479 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.375906944274902
Epoch: 18, Steps: 67 | Train Loss: 0.300 Vali Loss: 5.801 Vali Acc: 0.728 Test Loss: 5.801 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.41604471206665
Epoch: 19, Steps: 67 | Train Loss: 0.144 Vali Loss: 4.488 Vali Acc: 0.780 Test Loss: 4.488 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5240583
model size : 20.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.577809572219849
Epoch: 1, Steps: 67 | Train Loss: 6.600 Vali Loss: 5.478 Vali Acc: 0.694 Test Loss: 5.478 Test Acc: 0.694
Validation loss decreased (inf --> -0.693587).  Saving model ...
Epoch: 2 cost time: 5.162165880203247
Epoch: 2, Steps: 67 | Train Loss: 3.838 Vali Loss: 2.193 Vali Acc: 0.740 Test Loss: 2.193 Test Acc: 0.740
Validation loss decreased (-0.693587 --> -0.739862).  Saving model ...
Epoch: 3 cost time: 5.132011413574219
Epoch: 3, Steps: 67 | Train Loss: 2.188 Vali Loss: 5.097 Vali Acc: 0.734 Test Loss: 5.097 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.258147954940796
Epoch: 4, Steps: 67 | Train Loss: 0.993 Vali Loss: 3.008 Vali Acc: 0.780 Test Loss: 3.008 Test Acc: 0.780
Validation loss decreased (-0.739862 --> -0.780317).  Saving model ...
Epoch: 5 cost time: 5.264434099197388
Epoch: 5, Steps: 67 | Train Loss: 0.232 Vali Loss: 9.714 Vali Acc: 0.688 Test Loss: 9.714 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2544238567352295
Epoch: 6, Steps: 67 | Train Loss: 0.433 Vali Loss: 3.453 Vali Acc: 0.763 Test Loss: 3.453 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.287364482879639
Epoch: 7, Steps: 67 | Train Loss: 0.177 Vali Loss: 2.821 Vali Acc: 0.798 Test Loss: 2.821 Test Acc: 0.798
Validation loss decreased (-0.780317 --> -0.797660).  Saving model ...
Epoch: 8 cost time: 5.39392876625061
Epoch: 8, Steps: 67 | Train Loss: 0.047 Vali Loss: 2.101 Vali Acc: 0.838 Test Loss: 2.101 Test Acc: 0.838
Validation loss decreased (-0.797660 --> -0.838129).  Saving model ...
Epoch: 9 cost time: 5.356067419052124
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.708 Vali Acc: 0.844 Test Loss: 2.708 Test Acc: 0.844
Validation loss decreased (-0.838129 --> -0.843904).  Saving model ...
Epoch: 10 cost time: 5.522311687469482
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.698 Vali Acc: 0.844 Test Loss: 2.698 Test Acc: 0.844
Validation loss decreased (-0.843904 --> -0.843904).  Saving model ...
Epoch: 11 cost time: 5.35437798500061
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.693 Vali Acc: 0.844 Test Loss: 2.693 Test Acc: 0.844
Validation loss decreased (-0.843904 --> -0.843904).  Saving model ...
Epoch: 12 cost time: 5.428360939025879
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.838 Test Loss: 2.889 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.378348350524902
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.897 Vali Acc: 0.838 Test Loss: 2.897 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.477237939834595
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.838 Test Loss: 2.889 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.35238790512085
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.888 Vali Acc: 0.838 Test Loss: 2.888 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.447912693023682
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.909 Vali Acc: 0.838 Test Loss: 2.909 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.387540817260742
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.893 Vali Acc: 0.838 Test Loss: 2.893 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.4228150844573975
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.889 Vali Acc: 0.838 Test Loss: 2.889 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.487489223480225
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.896 Vali Acc: 0.838 Test Loss: 2.896 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.368062973022461
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.879 Vali Acc: 0.838 Test Loss: 2.879 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.4147584438323975
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.899 Vali Acc: 0.838 Test Loss: 2.899 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3946439
model size : 15.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.95855712890625
Epoch: 1, Steps: 67 | Train Loss: 4.881 Vali Loss: 4.618 Vali Acc: 0.468 Test Loss: 4.618 Test Acc: 0.468
Validation loss decreased (inf --> -0.468162).  Saving model ...
Epoch: 2 cost time: 4.189688205718994
Epoch: 2, Steps: 67 | Train Loss: 2.957 Vali Loss: 4.465 Vali Acc: 0.624 Test Loss: 4.465 Test Acc: 0.624
Validation loss decreased (-0.468162 --> -0.624233).  Saving model ...
Epoch: 3 cost time: 4.228564023971558
Epoch: 3, Steps: 67 | Train Loss: 1.185 Vali Loss: 8.017 Vali Acc: 0.566 Test Loss: 8.017 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.471745729446411
Epoch: 4, Steps: 67 | Train Loss: 0.587 Vali Loss: 4.988 Vali Acc: 0.630 Test Loss: 4.988 Test Acc: 0.630
Validation loss decreased (-0.624233 --> -0.630008).  Saving model ...
Epoch: 5 cost time: 4.2594780921936035
Epoch: 5, Steps: 67 | Train Loss: 0.134 Vali Loss: 2.491 Vali Acc: 0.757 Test Loss: 2.491 Test Acc: 0.757
Validation loss decreased (-0.630008 --> -0.757201).  Saving model ...
Epoch: 6 cost time: 4.330525875091553
Epoch: 6, Steps: 67 | Train Loss: 0.240 Vali Loss: 1.881 Vali Acc: 0.803 Test Loss: 1.881 Test Acc: 0.803
Validation loss decreased (-0.757201 --> -0.803449).  Saving model ...
Epoch: 7 cost time: 4.237591981887817
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.809 Test Loss: 1.790 Test Acc: 0.809
Validation loss decreased (-0.803449 --> -0.809231).  Saving model ...
Epoch: 8 cost time: 4.337494850158691
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.809 Test Loss: 1.784 Test Acc: 0.809
Validation loss decreased (-0.809231 --> -0.809231).  Saving model ...
Epoch: 9 cost time: 4.2692413330078125
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.809 Test Loss: 1.784 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.21465802192688
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.809 Test Loss: 1.782 Test Acc: 0.809
Validation loss decreased (-0.809231 --> -0.809231).  Saving model ...
Epoch: 11 cost time: 4.353456974029541
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.821 Test Loss: 1.585 Test Acc: 0.821
Validation loss decreased (-0.809231 --> -0.820793).  Saving model ...
Epoch: 12 cost time: 4.253615379333496
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.821 Test Loss: 1.586 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.256373167037964
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.821 Test Loss: 1.582 Test Acc: 0.821
Validation loss decreased (-0.820793 --> -0.820793).  Saving model ...
Epoch: 14 cost time: 4.25180196762085
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.821 Test Loss: 1.581 Test Acc: 0.821
Validation loss decreased (-0.820793 --> -0.820793).  Saving model ...
Epoch: 15 cost time: 4.165971040725708
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.821 Test Loss: 1.580 Test Acc: 0.821
Validation loss decreased (-0.820793 --> -0.820793).  Saving model ...
Epoch: 16 cost time: 4.239968538284302
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.821 Test Loss: 1.582 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.206961631774902
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.821 Test Loss: 1.581 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.2121710777282715
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.821 Test Loss: 1.583 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.307730197906494
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.540 Vali Acc: 0.838 Test Loss: 1.540 Test Acc: 0.838
Validation loss decreased (-0.820793 --> -0.838135).  Saving model ...
Epoch: 20 cost time: 4.2287843227386475
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.832 Test Loss: 1.530 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.261843681335449
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.832 Test Loss: 1.529 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.3055925369262695
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.832 Test Loss: 1.535 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.196107864379883
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.832 Test Loss: 1.527 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.357519149780273
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.838 Test Loss: 1.536 Test Acc: 0.838
Validation loss decreased (-0.838135 --> -0.838135).  Saving model ...
Epoch: 25 cost time: 4.349658489227295
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.533 Vali Acc: 0.838 Test Loss: 1.533 Test Acc: 0.838
Validation loss decreased (-0.838135 --> -0.838135).  Saving model ...
Epoch: 26 cost time: 4.214551687240601
Epoch: 26, Steps: 67 | Train Loss: 0.006 Vali Loss: 10.184 Vali Acc: 0.671 Test Loss: 10.184 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.341243743896484
Epoch: 27, Steps: 67 | Train Loss: 4.589 Vali Loss: 14.362 Vali Acc: 0.578 Test Loss: 14.362 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.193951845169067
Epoch: 28, Steps: 67 | Train Loss: 5.423 Vali Loss: 40.626 Vali Acc: 0.376 Test Loss: 40.626 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.212998628616333
Epoch: 29, Steps: 67 | Train Loss: 4.201 Vali Loss: 13.828 Vali Acc: 0.711 Test Loss: 13.828 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.329641103744507
Epoch: 30, Steps: 67 | Train Loss: 0.735 Vali Loss: 14.551 Vali Acc: 0.682 Test Loss: 14.551 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.329177618026733
Epoch: 31, Steps: 67 | Train Loss: 1.199 Vali Loss: 11.698 Vali Acc: 0.688 Test Loss: 11.698 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.393403768539429
Epoch: 32, Steps: 67 | Train Loss: 0.457 Vali Loss: 9.394 Vali Acc: 0.746 Test Loss: 9.394 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.328979015350342
Epoch: 33, Steps: 67 | Train Loss: 0.418 Vali Loss: 7.993 Vali Acc: 0.792 Test Loss: 7.993 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.3576812744140625
Epoch: 34, Steps: 67 | Train Loss: 0.440 Vali Loss: 7.337 Vali Acc: 0.809 Test Loss: 7.337 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.321095705032349
Epoch: 35, Steps: 67 | Train Loss: 0.107 Vali Loss: 6.174 Vali Acc: 0.746 Test Loss: 6.174 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2868103
model size : 11.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.094477653503418
Epoch: 1, Steps: 67 | Train Loss: 3.255 Vali Loss: 2.090 Vali Acc: 0.711 Test Loss: 2.090 Test Acc: 0.711
Validation loss decreased (inf --> -0.710962).  Saving model ...
Epoch: 2 cost time: 3.5888595581054688
Epoch: 2, Steps: 67 | Train Loss: 1.815 Vali Loss: 3.108 Vali Acc: 0.607 Test Loss: 3.108 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.628587245941162
Epoch: 3, Steps: 67 | Train Loss: 0.715 Vali Loss: 1.421 Vali Acc: 0.723 Test Loss: 1.421 Test Acc: 0.723
Validation loss decreased (-0.710962 --> -0.722529).  Saving model ...
Epoch: 4 cost time: 3.575270175933838
Epoch: 4, Steps: 67 | Train Loss: 0.284 Vali Loss: 1.498 Vali Acc: 0.780 Test Loss: 1.498 Test Acc: 0.780
Validation loss decreased (-0.722529 --> -0.780332).  Saving model ...
Epoch: 5 cost time: 3.6770341396331787
Epoch: 5, Steps: 67 | Train Loss: 0.122 Vali Loss: 1.490 Vali Acc: 0.723 Test Loss: 1.490 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.616373062133789
Epoch: 6, Steps: 67 | Train Loss: 0.027 Vali Loss: 0.959 Vali Acc: 0.815 Test Loss: 0.959 Test Acc: 0.815
Validation loss decreased (-0.780332 --> -0.815019).  Saving model ...
Epoch: 7 cost time: 3.6217918395996094
Epoch: 7, Steps: 67 | Train Loss: 0.021 Vali Loss: 1.191 Vali Acc: 0.838 Test Loss: 1.191 Test Acc: 0.838
Validation loss decreased (-0.815019 --> -0.838138).  Saving model ...
Epoch: 8 cost time: 3.575956344604492
Epoch: 8, Steps: 67 | Train Loss: 0.412 Vali Loss: 3.892 Vali Acc: 0.630 Test Loss: 3.892 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5454933643341064
Epoch: 9, Steps: 67 | Train Loss: 0.137 Vali Loss: 4.178 Vali Acc: 0.723 Test Loss: 4.178 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.687065601348877
Epoch: 10, Steps: 67 | Train Loss: 0.176 Vali Loss: 3.546 Vali Acc: 0.723 Test Loss: 3.546 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.567617416381836
Epoch: 11, Steps: 67 | Train Loss: 0.144 Vali Loss: 3.245 Vali Acc: 0.728 Test Loss: 3.245 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7250335216522217
Epoch: 12, Steps: 67 | Train Loss: 0.043 Vali Loss: 6.563 Vali Acc: 0.659 Test Loss: 6.563 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.690462112426758
Epoch: 13, Steps: 67 | Train Loss: 0.112 Vali Loss: 4.243 Vali Acc: 0.740 Test Loss: 4.243 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6076149940490723
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.172 Vali Acc: 0.757 Test Loss: 4.172 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.6147494316101074
Epoch: 15, Steps: 67 | Train Loss: 0.010 Vali Loss: 5.046 Vali Acc: 0.780 Test Loss: 5.046 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.472900390625
Epoch: 16, Steps: 67 | Train Loss: 0.065 Vali Loss: 3.260 Vali Acc: 0.809 Test Loss: 3.260 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.580745220184326
Epoch: 17, Steps: 67 | Train Loss: 0.032 Vali Loss: 3.727 Vali Acc: 0.780 Test Loss: 3.727 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2005479
model size : 8.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.257332801818848
Epoch: 1, Steps: 67 | Train Loss: 2.878 Vali Loss: 2.407 Vali Acc: 0.532 Test Loss: 2.407 Test Acc: 0.532
Validation loss decreased (inf --> -0.531768).  Saving model ...
Epoch: 2 cost time: 3.1696889400482178
Epoch: 2, Steps: 67 | Train Loss: 1.426 Vali Loss: 1.082 Vali Acc: 0.827 Test Loss: 1.082 Test Acc: 0.827
Validation loss decreased (-0.531768 --> -0.826579).  Saving model ...
Epoch: 3 cost time: 3.0963103771209717
Epoch: 3, Steps: 67 | Train Loss: 0.408 Vali Loss: 2.150 Vali Acc: 0.780 Test Loss: 2.150 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0278635025024414
Epoch: 4, Steps: 67 | Train Loss: 0.129 Vali Loss: 1.950 Vali Acc: 0.740 Test Loss: 1.950 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.047600746154785
Epoch: 5, Steps: 67 | Train Loss: 0.128 Vali Loss: 4.366 Vali Acc: 0.723 Test Loss: 4.366 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1126153469085693
Epoch: 6, Steps: 67 | Train Loss: 0.093 Vali Loss: 1.912 Vali Acc: 0.803 Test Loss: 1.912 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0492143630981445
Epoch: 7, Steps: 67 | Train Loss: 0.054 Vali Loss: 1.669 Vali Acc: 0.803 Test Loss: 1.669 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1368675231933594
Epoch: 8, Steps: 67 | Train Loss: 0.003 Vali Loss: 1.286 Vali Acc: 0.821 Test Loss: 1.286 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.047590970993042
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.827 Test Loss: 1.236 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0531461238861084
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.832 Test Loss: 1.219 Test Acc: 0.832
Validation loss decreased (-0.826579 --> -0.832358).  Saving model ...
Epoch: 11 cost time: 3.018806219100952
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.832 Test Loss: 1.195 Test Acc: 0.832
Validation loss decreased (-0.832358 --> -0.832358).  Saving model ...
Epoch: 12 cost time: 3.074782609939575
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.838 Test Loss: 1.128 Test Acc: 0.838
Validation loss decreased (-0.832358 --> -0.838139).  Saving model ...
Epoch: 13 cost time: 3.023238182067871
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.855 Test Loss: 1.116 Test Acc: 0.855
Validation loss decreased (-0.838139 --> -0.855480).  Saving model ...
Epoch: 14 cost time: 2.9905405044555664
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.114 Vali Acc: 0.855 Test Loss: 1.114 Test Acc: 0.855
Validation loss decreased (-0.855480 --> -0.855480).  Saving model ...
Epoch: 15 cost time: 3.0651257038116455
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.850 Test Loss: 1.101 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1431074142456055
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.844 Test Loss: 1.074 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0935006141662598
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.861 Test Loss: 1.061 Test Acc: 0.861
Validation loss decreased (-0.855480 --> -0.861261).  Saving model ...
Epoch: 18 cost time: 3.1132593154907227
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.861 Test Loss: 1.057 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 19 cost time: 3.0874183177948
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.861 Test Loss: 1.063 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0344321727752686
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.861 Test Loss: 1.065 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1319751739501953
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.861 Test Loss: 1.058 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.0897774696350098
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.861 Test Loss: 1.063 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0774030685424805
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.861 Test Loss: 1.063 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0477805137634277
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.062 Vali Acc: 0.861 Test Loss: 1.062 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1067802906036377
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.861 Test Loss: 1.055 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 26 cost time: 3.124640464782715
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.861 Test Loss: 1.059 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.084817886352539
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.861 Test Loss: 1.055 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1365439891815186
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.861 Test Loss: 1.049 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 29 cost time: 3.0716474056243896
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.861 Test Loss: 1.049 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.053473711013794
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.861 Test Loss: 1.046 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 31 cost time: 3.173152208328247
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.861 Test Loss: 1.052 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0528130531311035
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.861 Test Loss: 1.054 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.1245923042297363
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.861 Test Loss: 1.044 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 34 cost time: 3.457453489303589
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.861 Test Loss: 1.045 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1380815505981445
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.861 Test Loss: 1.033 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 36 cost time: 3.1493496894836426
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.861 Test Loss: 1.035 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.140164613723755
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.036 Vali Acc: 0.861 Test Loss: 1.036 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.079827308654785
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.861 Test Loss: 1.028 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 39 cost time: 3.115696668624878
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.034 Vali Acc: 0.861 Test Loss: 1.034 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0873003005981445
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.861 Test Loss: 1.030 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.2615156173706055
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.861 Test Loss: 1.033 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.118914842605591
Epoch: 42, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.026 Vali Acc: 0.861 Test Loss: 1.026 Test Acc: 0.861
Validation loss decreased (-0.861261 --> -0.861261).  Saving model ...
Epoch: 43 cost time: 3.466434955596924
Epoch: 43, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.850 Test Loss: 1.011 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 3.1616337299346924
Epoch: 44, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.016 Vali Acc: 0.850 Test Loss: 1.016 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.214840888977051
Epoch: 45, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.018 Vali Acc: 0.850 Test Loss: 1.018 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.1234683990478516
Epoch: 46, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.850 Test Loss: 1.014 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.2087900638580322
Epoch: 47, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.850 Test Loss: 1.017 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 3.2265689373016357
Epoch: 48, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.850 Test Loss: 1.009 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.1052086353302
Epoch: 49, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.850 Test Loss: 1.013 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 3.0786070823669434
Epoch: 50, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.023 Vali Acc: 0.850 Test Loss: 1.023 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 3.128061056137085
Epoch: 51, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.850 Test Loss: 1.015 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 3.096747636795044
Epoch: 52, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.017 Vali Acc: 0.850 Test Loss: 1.017 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1789991
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 36.2613373
	speed: 0.1489s/iter; left time: 1980.3383s
Epoch: 1 cost time: 19.43200421333313
Epoch: 1, Steps: 134 | Train Loss: 55.982 Vali Loss: 12.731 Vali Acc: 0.439 Test Loss: 12.731 Test Acc: 0.439
Validation loss decreased (inf --> -0.439179).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0158445
	speed: 0.2893s/iter; left time: 3809.2161s
Epoch: 2 cost time: 18.5241596698761
Epoch: 2, Steps: 134 | Train Loss: 4.025 Vali Loss: 2.855 Vali Acc: 0.636 Test Loss: 2.855 Test Acc: 0.636
Validation loss decreased (-0.439179 --> -0.635810).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.3027s/iter; left time: 3944.8230s
Epoch: 3 cost time: 18.70173192024231
Epoch: 3, Steps: 134 | Train Loss: 2.364 Vali Loss: 4.412 Vali Acc: 0.699 Test Loss: 4.412 Test Acc: 0.699
Validation loss decreased (-0.635810 --> -0.699378).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3021s/iter; left time: 3896.4398s
Epoch: 4 cost time: 18.809728384017944
Epoch: 4, Steps: 134 | Train Loss: 1.332 Vali Loss: 7.483 Vali Acc: 0.763 Test Loss: 7.483 Test Acc: 0.763
Validation loss decreased (-0.699378 --> -0.762931).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2996s/iter; left time: 3824.8901s
Epoch: 5 cost time: 18.557594060897827
Epoch: 5, Steps: 134 | Train Loss: 1.845 Vali Loss: 11.426 Vali Acc: 0.659 Test Loss: 11.426 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2943s/iter; left time: 3717.9305s
Epoch: 6 cost time: 18.581064462661743
Epoch: 6, Steps: 134 | Train Loss: 1.741 Vali Loss: 18.642 Vali Acc: 0.624 Test Loss: 18.642 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2213001
	speed: 0.2938s/iter; left time: 3671.6295s
Epoch: 7 cost time: 18.58934497833252
Epoch: 7, Steps: 134 | Train Loss: 1.213 Vali Loss: 20.891 Vali Acc: 0.584 Test Loss: 20.891 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3004s/iter; left time: 3713.9715s
Epoch: 8 cost time: 19.14518904685974
Epoch: 8, Steps: 134 | Train Loss: 1.078 Vali Loss: 21.711 Vali Acc: 0.711 Test Loss: 21.711 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2939s/iter; left time: 3593.5102s
Epoch: 9 cost time: 18.735828638076782
Epoch: 9, Steps: 134 | Train Loss: 1.327 Vali Loss: 7.564 Vali Acc: 0.769 Test Loss: 7.564 Test Acc: 0.769
Validation loss decreased (-0.762931 --> -0.768710).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2965s/iter; left time: 3586.1164s
Epoch: 10 cost time: 18.62444019317627
Epoch: 10, Steps: 134 | Train Loss: 0.832 Vali Loss: 11.520 Vali Acc: 0.792 Test Loss: 11.520 Test Acc: 0.792
Validation loss decreased (-0.768710 --> -0.791792).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3054s/iter; left time: 3652.7080s
Epoch: 11 cost time: 18.858744621276855
Epoch: 11, Steps: 134 | Train Loss: 0.609 Vali Loss: 10.661 Vali Acc: 0.757 Test Loss: 10.661 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2999s/iter; left time: 3546.5159s
Epoch: 12 cost time: 18.92249894142151
Epoch: 12, Steps: 134 | Train Loss: 0.545 Vali Loss: 17.350 Vali Acc: 0.809 Test Loss: 17.350 Test Acc: 0.809
Validation loss decreased (-0.791792 --> -0.809075).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3086s/iter; left time: 3607.8853s
Epoch: 13 cost time: 18.80724287033081
Epoch: 13, Steps: 134 | Train Loss: 1.401 Vali Loss: 8.929 Vali Acc: 0.751 Test Loss: 8.929 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 3507.0714s
Epoch: 14 cost time: 18.923442125320435
Epoch: 14, Steps: 134 | Train Loss: 0.848 Vali Loss: 19.127 Vali Acc: 0.757 Test Loss: 19.127 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3030s/iter; left time: 3461.4565s
Epoch: 15 cost time: 18.907866954803467
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.092 Vali Acc: 0.763 Test Loss: 19.092 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2985s/iter; left time: 3370.1243s
Epoch: 16 cost time: 18.7245774269104
Epoch: 16, Steps: 134 | Train Loss: 0.136 Vali Loss: 68.876 Vali Acc: 0.497 Test Loss: 68.876 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2979s/iter; left time: 3323.8028s
Epoch: 17 cost time: 19.006207942962646
Epoch: 17, Steps: 134 | Train Loss: 1.233 Vali Loss: 18.719 Vali Acc: 0.676 Test Loss: 18.719 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 3278.3685s
Epoch: 18 cost time: 18.80881667137146
Epoch: 18, Steps: 134 | Train Loss: 0.413 Vali Loss: 31.346 Vali Acc: 0.636 Test Loss: 31.346 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2974s/iter; left time: 3238.5687s
Epoch: 19 cost time: 18.764523029327393
Epoch: 19, Steps: 134 | Train Loss: 0.343 Vali Loss: 19.919 Vali Acc: 0.688 Test Loss: 19.919 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2957s/iter; left time: 3180.7440s
Epoch: 20 cost time: 18.81812834739685
Epoch: 20, Steps: 134 | Train Loss: 2.455 Vali Loss: 24.893 Vali Acc: 0.734 Test Loss: 24.893 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2959s/iter; left time: 3142.8523s
Epoch: 21 cost time: 18.87238121032715
Epoch: 21, Steps: 134 | Train Loss: 1.878 Vali Loss: 20.660 Vali Acc: 0.723 Test Loss: 20.660 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2939s/iter; left time: 3082.2326s
Epoch: 22 cost time: 18.72542142868042
Epoch: 22, Steps: 134 | Train Loss: 1.767 Vali Loss: 13.950 Vali Acc: 0.705 Test Loss: 13.950 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 15569575
model size : 60.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.28333830833435
Epoch: 1, Steps: 67 | Train Loss: 17.674 Vali Loss: 28.909 Vali Acc: 0.462 Test Loss: 28.909 Test Acc: 0.462
Validation loss decreased (inf --> -0.462139).  Saving model ...
Epoch: 2 cost time: 8.956396579742432
Epoch: 2, Steps: 67 | Train Loss: 16.068 Vali Loss: 4.316 Vali Acc: 0.711 Test Loss: 4.316 Test Acc: 0.711
Validation loss decreased (-0.462139 --> -0.710939).  Saving model ...
Epoch: 3 cost time: 9.18751049041748
Epoch: 3, Steps: 67 | Train Loss: 1.329 Vali Loss: 3.749 Vali Acc: 0.682 Test Loss: 3.749 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.991752862930298
Epoch: 4, Steps: 67 | Train Loss: 0.321 Vali Loss: 3.424 Vali Acc: 0.665 Test Loss: 3.424 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.04518175125122
Epoch: 5, Steps: 67 | Train Loss: 0.162 Vali Loss: 6.119 Vali Acc: 0.688 Test Loss: 6.119 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.07613468170166
Epoch: 6, Steps: 67 | Train Loss: 0.416 Vali Loss: 3.383 Vali Acc: 0.711 Test Loss: 3.383 Test Acc: 0.711
Validation loss decreased (-0.710939 --> -0.710949).  Saving model ...
Epoch: 7 cost time: 9.073201179504395
Epoch: 7, Steps: 67 | Train Loss: 0.032 Vali Loss: 2.248 Vali Acc: 0.798 Test Loss: 2.248 Test Acc: 0.798
Validation loss decreased (-0.710949 --> -0.797665).  Saving model ...
Epoch: 8 cost time: 9.050989627838135
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.746 Test Loss: 2.516 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.043908834457397
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.510 Vali Acc: 0.751 Test Loss: 2.510 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.045343399047852
Epoch: 10, Steps: 67 | Train Loss: 0.275 Vali Loss: 6.676 Vali Acc: 0.688 Test Loss: 6.676 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.197397232055664
Epoch: 11, Steps: 67 | Train Loss: 0.899 Vali Loss: 6.237 Vali Acc: 0.757 Test Loss: 6.237 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.020334482192993
Epoch: 12, Steps: 67 | Train Loss: 1.353 Vali Loss: 7.936 Vali Acc: 0.757 Test Loss: 7.936 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.936171293258667
Epoch: 13, Steps: 67 | Train Loss: 1.144 Vali Loss: 5.897 Vali Acc: 0.723 Test Loss: 5.897 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.997881889343262
Epoch: 14, Steps: 67 | Train Loss: 0.434 Vali Loss: 3.928 Vali Acc: 0.803 Test Loss: 3.928 Test Acc: 0.803
Validation loss decreased (-0.797665 --> -0.803429).  Saving model ...
Epoch: 15 cost time: 9.074113368988037
Epoch: 15, Steps: 67 | Train Loss: 0.597 Vali Loss: 8.513 Vali Acc: 0.763 Test Loss: 8.513 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.967035293579102
Epoch: 16, Steps: 67 | Train Loss: 0.103 Vali Loss: 10.983 Vali Acc: 0.763 Test Loss: 10.983 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.07458758354187
Epoch: 17, Steps: 67 | Train Loss: 0.057 Vali Loss: 9.263 Vali Acc: 0.821 Test Loss: 9.263 Test Acc: 0.821
Validation loss decreased (-0.803429 --> -0.820717).  Saving model ...
Epoch: 18 cost time: 9.034096240997314
Epoch: 18, Steps: 67 | Train Loss: 0.074 Vali Loss: 4.660 Vali Acc: 0.844 Test Loss: 4.660 Test Acc: 0.844
Validation loss decreased (-0.820717 --> -0.843884).  Saving model ...
Epoch: 19 cost time: 8.994942426681519
Epoch: 19, Steps: 67 | Train Loss: 0.334 Vali Loss: 6.901 Vali Acc: 0.775 Test Loss: 6.901 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.06098461151123
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.661 Vali Acc: 0.809 Test Loss: 6.661 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.064640045166016
Epoch: 21, Steps: 67 | Train Loss: 0.120 Vali Loss: 18.903 Vali Acc: 0.613 Test Loss: 18.903 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.995384693145752
Epoch: 22, Steps: 67 | Train Loss: 0.902 Vali Loss: 3.937 Vali Acc: 0.821 Test Loss: 3.937 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.031687021255493
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.844 Vali Acc: 0.769 Test Loss: 5.844 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.071549654006958
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.140 Vali Acc: 0.751 Test Loss: 10.140 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.982741594314575
Epoch: 25, Steps: 67 | Train Loss: 0.503 Vali Loss: 16.593 Vali Acc: 0.636 Test Loss: 16.593 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.050493240356445
Epoch: 26, Steps: 67 | Train Loss: 0.899 Vali Loss: 5.964 Vali Acc: 0.815 Test Loss: 5.964 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 9.331058263778687
Epoch: 27, Steps: 67 | Train Loss: 0.820 Vali Loss: 13.926 Vali Acc: 0.775 Test Loss: 13.926 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.132957696914673
Epoch: 28, Steps: 67 | Train Loss: 0.051 Vali Loss: 13.117 Vali Acc: 0.671 Test Loss: 13.117 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 7804071
model size : 30.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.510068416595459
Epoch: 1, Steps: 67 | Train Loss: 12.841 Vali Loss: 12.954 Vali Acc: 0.549 Test Loss: 12.954 Test Acc: 0.549
Validation loss decreased (inf --> -0.549003).  Saving model ...
Epoch: 2 cost time: 5.15235161781311
Epoch: 2, Steps: 67 | Train Loss: 8.731 Vali Loss: 9.429 Vali Acc: 0.607 Test Loss: 9.429 Test Acc: 0.607
Validation loss decreased (-0.549003 --> -0.606842).  Saving model ...
Epoch: 3 cost time: 5.202306747436523
Epoch: 3, Steps: 67 | Train Loss: 4.892 Vali Loss: 17.774 Vali Acc: 0.566 Test Loss: 17.774 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.159841060638428
Epoch: 4, Steps: 67 | Train Loss: 3.056 Vali Loss: 2.711 Vali Acc: 0.832 Test Loss: 2.711 Test Acc: 0.832
Validation loss decreased (-0.606842 --> -0.832343).  Saving model ...
Epoch: 5 cost time: 5.1850316524505615
Epoch: 5, Steps: 67 | Train Loss: 0.778 Vali Loss: 6.926 Vali Acc: 0.734 Test Loss: 6.926 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.174033164978027
Epoch: 6, Steps: 67 | Train Loss: 0.163 Vali Loss: 8.812 Vali Acc: 0.734 Test Loss: 8.812 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.232801914215088
Epoch: 7, Steps: 67 | Train Loss: 0.455 Vali Loss: 10.700 Vali Acc: 0.705 Test Loss: 10.700 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.178900718688965
Epoch: 8, Steps: 67 | Train Loss: 0.204 Vali Loss: 3.472 Vali Acc: 0.780 Test Loss: 3.472 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.253390312194824
Epoch: 9, Steps: 67 | Train Loss: 0.151 Vali Loss: 4.778 Vali Acc: 0.798 Test Loss: 4.778 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.246485233306885
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.626 Vali Acc: 0.775 Test Loss: 4.626 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.335835695266724
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.618 Vali Acc: 0.861 Test Loss: 2.618 Test Acc: 0.861
Validation loss decreased (-0.832343 --> -0.861245).  Saving model ...
Epoch: 12 cost time: 5.4143571853637695
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.438 Vali Acc: 0.832 Test Loss: 3.438 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.344925880432129
Epoch: 13, Steps: 67 | Train Loss: 0.311 Vali Loss: 5.391 Vali Acc: 0.780 Test Loss: 5.391 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.487745761871338
Epoch: 14, Steps: 67 | Train Loss: 0.066 Vali Loss: 3.073 Vali Acc: 0.838 Test Loss: 3.073 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.408767223358154
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.095 Vali Acc: 0.832 Test Loss: 3.095 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.395124435424805
Epoch: 16, Steps: 67 | Train Loss: 0.061 Vali Loss: 3.123 Vali Acc: 0.821 Test Loss: 3.123 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.459336996078491
Epoch: 17, Steps: 67 | Train Loss: 0.008 Vali Loss: 2.858 Vali Acc: 0.815 Test Loss: 2.858 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.4009950160980225
Epoch: 18, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.057 Vali Acc: 0.884 Test Loss: 2.057 Test Acc: 0.884
Validation loss decreased (-0.861245 --> -0.884372).  Saving model ...
Epoch: 19 cost time: 5.399150371551514
Epoch: 19, Steps: 67 | Train Loss: 0.367 Vali Loss: 2.956 Vali Acc: 0.821 Test Loss: 2.956 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.510618448257446
Epoch: 20, Steps: 67 | Train Loss: 0.211 Vali Loss: 1.663 Vali Acc: 0.838 Test Loss: 1.663 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.4035234451293945
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.409 Vali Acc: 0.844 Test Loss: 1.409 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.5750672817230225
Epoch: 22, Steps: 67 | Train Loss: 0.152 Vali Loss: 11.425 Vali Acc: 0.711 Test Loss: 11.425 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.436543703079224
Epoch: 23, Steps: 67 | Train Loss: 1.244 Vali Loss: 11.253 Vali Acc: 0.734 Test Loss: 11.253 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.447284936904907
Epoch: 24, Steps: 67 | Train Loss: 1.637 Vali Loss: 8.525 Vali Acc: 0.757 Test Loss: 8.525 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.400100946426392
Epoch: 25, Steps: 67 | Train Loss: 1.419 Vali Loss: 10.044 Vali Acc: 0.717 Test Loss: 10.044 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.4076550006866455
Epoch: 26, Steps: 67 | Train Loss: 0.988 Vali Loss: 6.968 Vali Acc: 0.786 Test Loss: 6.968 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.502305507659912
Epoch: 27, Steps: 67 | Train Loss: 0.457 Vali Loss: 12.867 Vali Acc: 0.751 Test Loss: 12.867 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.367546796798706
Epoch: 28, Steps: 67 | Train Loss: 0.105 Vali Loss: 14.215 Vali Acc: 0.786 Test Loss: 14.215 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 5215623
model size : 20.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.959745407104492
Epoch: 1, Steps: 67 | Train Loss: 8.515 Vali Loss: 7.076 Vali Acc: 0.613 Test Loss: 7.076 Test Acc: 0.613
Validation loss decreased (inf --> -0.612646).  Saving model ...
Epoch: 2 cost time: 4.720305919647217
Epoch: 2, Steps: 67 | Train Loss: 7.409 Vali Loss: 4.696 Vali Acc: 0.618 Test Loss: 4.696 Test Acc: 0.618
Validation loss decreased (-0.612646 --> -0.618450).  Saving model ...
Epoch: 3 cost time: 4.861598491668701
Epoch: 3, Steps: 67 | Train Loss: 1.609 Vali Loss: 4.254 Vali Acc: 0.659 Test Loss: 4.254 Test Acc: 0.659
Validation loss decreased (-0.618450 --> -0.658917).  Saving model ...
Epoch: 4 cost time: 4.795579433441162
Epoch: 4, Steps: 67 | Train Loss: 0.884 Vali Loss: 2.811 Vali Acc: 0.751 Test Loss: 2.811 Test Acc: 0.751
Validation loss decreased (-0.658917 --> -0.751417).  Saving model ...
Epoch: 5 cost time: 4.88494610786438
Epoch: 5, Steps: 67 | Train Loss: 0.232 Vali Loss: 2.278 Vali Acc: 0.798 Test Loss: 2.278 Test Acc: 0.798
Validation loss decreased (-0.751417 --> -0.797665).  Saving model ...
Epoch: 6 cost time: 4.768326997756958
Epoch: 6, Steps: 67 | Train Loss: 0.146 Vali Loss: 1.816 Vali Acc: 0.844 Test Loss: 1.816 Test Acc: 0.844
Validation loss decreased (-0.797665 --> -0.843912).  Saving model ...
Epoch: 7 cost time: 4.7290565967559814
Epoch: 7, Steps: 67 | Train Loss: 0.083 Vali Loss: 2.871 Vali Acc: 0.757 Test Loss: 2.871 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.715270757675171
Epoch: 8, Steps: 67 | Train Loss: 0.182 Vali Loss: 2.017 Vali Acc: 0.809 Test Loss: 2.017 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.736718416213989
Epoch: 9, Steps: 67 | Train Loss: 0.055 Vali Loss: 2.379 Vali Acc: 0.855 Test Loss: 2.379 Test Acc: 0.855
Validation loss decreased (-0.843912 --> -0.855468).  Saving model ...
Epoch: 10 cost time: 4.68263053894043
Epoch: 10, Steps: 67 | Train Loss: 0.087 Vali Loss: 2.608 Vali Acc: 0.769 Test Loss: 2.608 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.725010633468628
Epoch: 11, Steps: 67 | Train Loss: 0.023 Vali Loss: 2.195 Vali Acc: 0.798 Test Loss: 2.195 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.748326778411865
Epoch: 12, Steps: 67 | Train Loss: 0.087 Vali Loss: 2.117 Vali Acc: 0.815 Test Loss: 2.117 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.729679822921753
Epoch: 13, Steps: 67 | Train Loss: 0.003 Vali Loss: 2.152 Vali Acc: 0.751 Test Loss: 2.152 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.751164197921753
Epoch: 14, Steps: 67 | Train Loss: 0.240 Vali Loss: 6.964 Vali Acc: 0.711 Test Loss: 6.964 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.856966495513916
Epoch: 15, Steps: 67 | Train Loss: 0.152 Vali Loss: 4.788 Vali Acc: 0.786 Test Loss: 4.788 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.75964093208313
Epoch: 16, Steps: 67 | Train Loss: 0.224 Vali Loss: 2.819 Vali Acc: 0.809 Test Loss: 2.819 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.869795560836792
Epoch: 17, Steps: 67 | Train Loss: 0.197 Vali Loss: 9.515 Vali Acc: 0.717 Test Loss: 9.515 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.71979284286499
Epoch: 18, Steps: 67 | Train Loss: 0.084 Vali Loss: 4.778 Vali Acc: 0.694 Test Loss: 4.778 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.79566764831543
Epoch: 19, Steps: 67 | Train Loss: 0.092 Vali Loss: 5.998 Vali Acc: 0.832 Test Loss: 5.998 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 3921479
model size : 15.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.2585673332214355
Epoch: 1, Steps: 67 | Train Loss: 4.732 Vali Loss: 5.048 Vali Acc: 0.514 Test Loss: 5.048 Test Acc: 0.514
Validation loss decreased (inf --> -0.514400).  Saving model ...
Epoch: 2 cost time: 3.6474697589874268
Epoch: 2, Steps: 67 | Train Loss: 4.046 Vali Loss: 4.872 Vali Acc: 0.682 Test Loss: 4.872 Test Acc: 0.682
Validation loss decreased (-0.514400 --> -0.682032).  Saving model ...
Epoch: 3 cost time: 3.9104692935943604
Epoch: 3, Steps: 67 | Train Loss: 0.654 Vali Loss: 4.967 Vali Acc: 0.717 Test Loss: 4.967 Test Acc: 0.717
Validation loss decreased (-0.682032 --> -0.716713).  Saving model ...
Epoch: 4 cost time: 3.8026113510131836
Epoch: 4, Steps: 67 | Train Loss: 0.556 Vali Loss: 3.710 Vali Acc: 0.682 Test Loss: 3.710 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7624335289001465
Epoch: 5, Steps: 67 | Train Loss: 0.539 Vali Loss: 1.842 Vali Acc: 0.798 Test Loss: 1.842 Test Acc: 0.798
Validation loss decreased (-0.716713 --> -0.797669).  Saving model ...
Epoch: 6 cost time: 3.7896173000335693
Epoch: 6, Steps: 67 | Train Loss: 0.439 Vali Loss: 1.620 Vali Acc: 0.809 Test Loss: 1.620 Test Acc: 0.809
Validation loss decreased (-0.797669 --> -0.809232).  Saving model ...
Epoch: 7 cost time: 3.8125202655792236
Epoch: 7, Steps: 67 | Train Loss: 0.242 Vali Loss: 2.168 Vali Acc: 0.832 Test Loss: 2.168 Test Acc: 0.832
Validation loss decreased (-0.809232 --> -0.832348).  Saving model ...
Epoch: 8 cost time: 3.780125856399536
Epoch: 8, Steps: 67 | Train Loss: 0.040 Vali Loss: 2.077 Vali Acc: 0.803 Test Loss: 2.077 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6882901191711426
Epoch: 9, Steps: 67 | Train Loss: 0.024 Vali Loss: 0.967 Vali Acc: 0.867 Test Loss: 0.967 Test Acc: 0.867
Validation loss decreased (-0.832348 --> -0.867042).  Saving model ...
Epoch: 10 cost time: 3.8456742763519287
Epoch: 10, Steps: 67 | Train Loss: 0.059 Vali Loss: 4.211 Vali Acc: 0.798 Test Loss: 4.211 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.65621280670166
Epoch: 11, Steps: 67 | Train Loss: 0.113 Vali Loss: 3.605 Vali Acc: 0.786 Test Loss: 3.605 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.716235399246216
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.661 Vali Acc: 0.780 Test Loss: 2.661 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.624826431274414
Epoch: 13, Steps: 67 | Train Loss: 0.167 Vali Loss: 4.084 Vali Acc: 0.786 Test Loss: 4.084 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7453484535217285
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.768 Vali Acc: 0.803 Test Loss: 2.768 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6550889015197754
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.336 Vali Acc: 0.769 Test Loss: 3.336 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.766805410385132
Epoch: 16, Steps: 67 | Train Loss: 0.023 Vali Loss: 3.318 Vali Acc: 0.786 Test Loss: 3.318 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6411023139953613
Epoch: 17, Steps: 67 | Train Loss: 0.361 Vali Loss: 7.347 Vali Acc: 0.566 Test Loss: 7.347 Test Acc: 0.566
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.723982095718384
Epoch: 18, Steps: 67 | Train Loss: 0.382 Vali Loss: 4.828 Vali Acc: 0.798 Test Loss: 4.828 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7157201766967773
Epoch: 19, Steps: 67 | Train Loss: 0.746 Vali Loss: 24.169 Vali Acc: 0.538 Test Loss: 24.169 Test Acc: 0.538
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2843143
model size : 11.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.299967527389526
Epoch: 1, Steps: 67 | Train Loss: 3.410 Vali Loss: 9.000 Vali Acc: 0.468 Test Loss: 9.000 Test Acc: 0.468
Validation loss decreased (inf --> -0.468118).  Saving model ...
Epoch: 2 cost time: 3.0158026218414307
Epoch: 2, Steps: 67 | Train Loss: 3.979 Vali Loss: 5.289 Vali Acc: 0.618 Test Loss: 5.289 Test Acc: 0.618
Validation loss decreased (-0.468118 --> -0.618444).  Saving model ...
Epoch: 3 cost time: 3.166316509246826
Epoch: 3, Steps: 67 | Train Loss: 0.746 Vali Loss: 1.547 Vali Acc: 0.763 Test Loss: 1.547 Test Acc: 0.763
Validation loss decreased (-0.618444 --> -0.762990).  Saving model ...
Epoch: 4 cost time: 3.027104616165161
Epoch: 4, Steps: 67 | Train Loss: 0.217 Vali Loss: 3.587 Vali Acc: 0.723 Test Loss: 3.587 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0008769035339355
Epoch: 5, Steps: 67 | Train Loss: 0.439 Vali Loss: 2.415 Vali Acc: 0.751 Test Loss: 2.415 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.096250534057617
Epoch: 6, Steps: 67 | Train Loss: 0.221 Vali Loss: 3.866 Vali Acc: 0.723 Test Loss: 3.866 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.193688154220581
Epoch: 7, Steps: 67 | Train Loss: 0.279 Vali Loss: 1.801 Vali Acc: 0.792 Test Loss: 1.801 Test Acc: 0.792
Validation loss decreased (-0.762990 --> -0.791890).  Saving model ...
Epoch: 8 cost time: 3.1928505897521973
Epoch: 8, Steps: 67 | Train Loss: 0.007 Vali Loss: 2.656 Vali Acc: 0.780 Test Loss: 2.656 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9934945106506348
Epoch: 9, Steps: 67 | Train Loss: 0.061 Vali Loss: 2.132 Vali Acc: 0.803 Test Loss: 2.132 Test Acc: 0.803
Validation loss decreased (-0.791890 --> -0.803447).  Saving model ...
Epoch: 10 cost time: 3.1024842262268066
Epoch: 10, Steps: 67 | Train Loss: 0.006 Vali Loss: 3.280 Vali Acc: 0.769 Test Loss: 3.280 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.139833688735962
Epoch: 11, Steps: 67 | Train Loss: 0.012 Vali Loss: 2.592 Vali Acc: 0.699 Test Loss: 2.592 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1385509967803955
Epoch: 12, Steps: 67 | Train Loss: 0.100 Vali Loss: 4.239 Vali Acc: 0.763 Test Loss: 4.239 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.19338059425354
Epoch: 13, Steps: 67 | Train Loss: 0.115 Vali Loss: 5.474 Vali Acc: 0.769 Test Loss: 5.474 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2664642333984375
Epoch: 14, Steps: 67 | Train Loss: 0.302 Vali Loss: 5.219 Vali Acc: 0.723 Test Loss: 5.219 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.286892890930176
Epoch: 15, Steps: 67 | Train Loss: 0.341 Vali Loss: 6.964 Vali Acc: 0.653 Test Loss: 6.964 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.202517509460449
Epoch: 16, Steps: 67 | Train Loss: 0.118 Vali Loss: 2.669 Vali Acc: 0.844 Test Loss: 2.669 Test Acc: 0.844
Validation loss decreased (-0.803447 --> -0.843904).  Saving model ...
Epoch: 17 cost time: 3.2202916145324707
Epoch: 17, Steps: 67 | Train Loss: 0.006 Vali Loss: 3.723 Vali Acc: 0.827 Test Loss: 3.723 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.486527442932129
Epoch: 18, Steps: 67 | Train Loss: 0.010 Vali Loss: 2.322 Vali Acc: 0.821 Test Loss: 2.322 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2943928241729736
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.331 Vali Acc: 0.815 Test Loss: 2.331 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.199998378753662
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.382 Vali Acc: 0.815 Test Loss: 2.382 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.4201290607452393
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.368 Vali Acc: 0.815 Test Loss: 2.368 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.174833297729492
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.821 Test Loss: 2.367 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2864151000976562
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.385 Vali Acc: 0.815 Test Loss: 2.385 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3160738945007324
Epoch: 24, Steps: 67 | Train Loss: 0.197 Vali Loss: 20.351 Vali Acc: 0.503 Test Loss: 20.351 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2749929428100586
Epoch: 25, Steps: 67 | Train Loss: 0.405 Vali Loss: 11.567 Vali Acc: 0.636 Test Loss: 11.567 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.2527146339416504
Epoch: 26, Steps: 67 | Train Loss: 0.935 Vali Loss: 18.531 Vali Acc: 0.514 Test Loss: 18.531 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1980519
model size : 8.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.228108644485474
Epoch: 1, Steps: 67 | Train Loss: 4.631 Vali Loss: 5.628 Vali Acc: 0.387 Test Loss: 5.628 Test Acc: 0.387
Validation loss decreased (inf --> -0.387227).  Saving model ...
Epoch: 2 cost time: 2.590149164199829
Epoch: 2, Steps: 67 | Train Loss: 1.995 Vali Loss: 3.833 Vali Acc: 0.590 Test Loss: 3.833 Test Acc: 0.590
Validation loss decreased (-0.387227 --> -0.589557).  Saving model ...
Epoch: 3 cost time: 2.580021381378174
Epoch: 3, Steps: 67 | Train Loss: 0.857 Vali Loss: 1.378 Vali Acc: 0.786 Test Loss: 1.378 Test Acc: 0.786
Validation loss decreased (-0.589557 --> -0.786113).  Saving model ...
Epoch: 4 cost time: 2.6825857162475586
Epoch: 4, Steps: 67 | Train Loss: 0.171 Vali Loss: 4.974 Vali Acc: 0.705 Test Loss: 4.974 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5610361099243164
Epoch: 5, Steps: 67 | Train Loss: 0.092 Vali Loss: 2.953 Vali Acc: 0.711 Test Loss: 2.953 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.67596173286438
Epoch: 6, Steps: 67 | Train Loss: 0.200 Vali Loss: 3.203 Vali Acc: 0.763 Test Loss: 3.203 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.6535942554473877
Epoch: 7, Steps: 67 | Train Loss: 0.212 Vali Loss: 1.460 Vali Acc: 0.809 Test Loss: 1.460 Test Acc: 0.809
Validation loss decreased (-0.786113 --> -0.809234).  Saving model ...
Epoch: 8 cost time: 2.6177215576171875
Epoch: 8, Steps: 67 | Train Loss: 0.129 Vali Loss: 2.281 Vali Acc: 0.751 Test Loss: 2.281 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5814974308013916
Epoch: 9, Steps: 67 | Train Loss: 0.104 Vali Loss: 1.716 Vali Acc: 0.757 Test Loss: 1.716 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.529266119003296
Epoch: 10, Steps: 67 | Train Loss: 0.077 Vali Loss: 2.266 Vali Acc: 0.769 Test Loss: 2.266 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6081998348236084
Epoch: 11, Steps: 67 | Train Loss: 0.062 Vali Loss: 1.840 Vali Acc: 0.792 Test Loss: 1.840 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7798514366149902
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.378 Vali Acc: 0.728 Test Loss: 2.378 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.670445680618286
Epoch: 13, Steps: 67 | Train Loss: 0.053 Vali Loss: 2.744 Vali Acc: 0.809 Test Loss: 2.744 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6560394763946533
Epoch: 14, Steps: 67 | Train Loss: 0.073 Vali Loss: 1.950 Vali Acc: 0.809 Test Loss: 1.950 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.77294659614563
Epoch: 15, Steps: 67 | Train Loss: 0.012 Vali Loss: 1.875 Vali Acc: 0.832 Test Loss: 1.875 Test Acc: 0.832
Validation loss decreased (-0.809234 --> -0.832351).  Saving model ...
Epoch: 16 cost time: 2.8517372608184814
Epoch: 16, Steps: 67 | Train Loss: 0.048 Vali Loss: 4.919 Vali Acc: 0.763 Test Loss: 4.919 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8105714321136475
Epoch: 17, Steps: 67 | Train Loss: 0.035 Vali Loss: 3.561 Vali Acc: 0.780 Test Loss: 3.561 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6374409198760986
Epoch: 18, Steps: 67 | Train Loss: 0.147 Vali Loss: 3.536 Vali Acc: 0.775 Test Loss: 3.536 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6349518299102783
Epoch: 19, Steps: 67 | Train Loss: 0.165 Vali Loss: 4.175 Vali Acc: 0.734 Test Loss: 4.175 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9157440662384033
Epoch: 20, Steps: 67 | Train Loss: 0.078 Vali Loss: 3.644 Vali Acc: 0.751 Test Loss: 3.644 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7987592220306396
Epoch: 21, Steps: 67 | Train Loss: 0.652 Vali Loss: 2.659 Vali Acc: 0.780 Test Loss: 2.659 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7811498641967773
Epoch: 22, Steps: 67 | Train Loss: 0.252 Vali Loss: 7.395 Vali Acc: 0.711 Test Loss: 7.395 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7618231773376465
Epoch: 23, Steps: 67 | Train Loss: 0.576 Vali Loss: 2.579 Vali Acc: 0.803 Test Loss: 2.579 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.850052833557129
Epoch: 24, Steps: 67 | Train Loss: 0.038 Vali Loss: 3.275 Vali Acc: 0.769 Test Loss: 3.275 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.764296293258667
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.887 Vali Acc: 0.769 Test Loss: 3.887 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1765031
model size : 7.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 110.5346527
	speed: 0.1338s/iter; left time: 1779.2304s
Epoch: 1 cost time: 17.426040410995483
Epoch: 1, Steps: 134 | Train Loss: 70.238 Vali Loss: 77.817 Vali Acc: 0.382 Test Loss: 77.817 Test Acc: 0.382
Validation loss decreased (inf --> -0.380725).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000014
	speed: 0.2666s/iter; left time: 3510.7316s
Epoch: 2 cost time: 16.39327597618103
Epoch: 2, Steps: 134 | Train Loss: 18.971 Vali Loss: 5.494 Vali Acc: 0.630 Test Loss: 5.494 Test Acc: 0.630
Validation loss decreased (-0.380725 --> -0.630003).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000003
	speed: 0.2796s/iter; left time: 3644.6139s
Epoch: 3 cost time: 16.424152135849
Epoch: 3, Steps: 134 | Train Loss: 1.869 Vali Loss: 3.801 Vali Acc: 0.792 Test Loss: 3.801 Test Acc: 0.792
Validation loss decreased (-0.630003 --> -0.791870).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0001114
	speed: 0.2760s/iter; left time: 3559.9939s
Epoch: 4 cost time: 16.395291566848755
Epoch: 4, Steps: 134 | Train Loss: 1.081 Vali Loss: 5.719 Vali Acc: 0.746 Test Loss: 5.719 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2649s/iter; left time: 3381.2979s
Epoch: 5 cost time: 16.300824880599976
Epoch: 5, Steps: 134 | Train Loss: 2.360 Vali Loss: 19.989 Vali Acc: 0.601 Test Loss: 19.989 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003227
	speed: 0.2650s/iter; left time: 3347.2895s
Epoch: 6 cost time: 16.5005521774292
Epoch: 6, Steps: 134 | Train Loss: 1.381 Vali Loss: 9.837 Vali Acc: 0.740 Test Loss: 9.837 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2607s/iter; left time: 3257.9803s
Epoch: 7 cost time: 16.2942156791687
Epoch: 7, Steps: 134 | Train Loss: 1.166 Vali Loss: 13.970 Vali Acc: 0.699 Test Loss: 13.970 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2636s/iter; left time: 3259.4570s
Epoch: 8 cost time: 16.344236373901367
Epoch: 8, Steps: 134 | Train Loss: 0.873 Vali Loss: 8.276 Vali Acc: 0.734 Test Loss: 8.276 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2617s/iter; left time: 3200.3510s
Epoch: 9 cost time: 16.287599086761475
Epoch: 9, Steps: 134 | Train Loss: 1.333 Vali Loss: 17.668 Vali Acc: 0.671 Test Loss: 17.668 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2673s/iter; left time: 3232.7920s
Epoch: 10 cost time: 16.381996631622314
Epoch: 10, Steps: 134 | Train Loss: 4.345 Vali Loss: 25.770 Vali Acc: 0.665 Test Loss: 25.770 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2683s/iter; left time: 3208.8246s
Epoch: 11 cost time: 16.317492961883545
Epoch: 11, Steps: 134 | Train Loss: 0.732 Vali Loss: 10.533 Vali Acc: 0.769 Test Loss: 10.533 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2717s/iter; left time: 3213.9515s
Epoch: 12 cost time: 16.488949060440063
Epoch: 12, Steps: 134 | Train Loss: 0.437 Vali Loss: 7.356 Vali Acc: 0.838 Test Loss: 7.356 Test Acc: 0.838
Validation loss decreased (-0.791870 --> -0.838077).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 3277.4688s
Epoch: 13 cost time: 16.3761146068573
Epoch: 13, Steps: 134 | Train Loss: 0.265 Vali Loss: 9.149 Vali Acc: 0.740 Test Loss: 9.149 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2657s/iter; left time: 3070.7083s
Epoch: 14 cost time: 16.418442487716675
Epoch: 14, Steps: 134 | Train Loss: 0.285 Vali Loss: 18.505 Vali Acc: 0.723 Test Loss: 18.505 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2648s/iter; left time: 3024.7778s
Epoch: 15 cost time: 16.256309747695923
Epoch: 15, Steps: 134 | Train Loss: 2.985 Vali Loss: 10.141 Vali Acc: 0.763 Test Loss: 10.141 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2678s/iter; left time: 3023.8612s
Epoch: 16 cost time: 16.45512580871582
Epoch: 16, Steps: 134 | Train Loss: 2.426 Vali Loss: 21.160 Vali Acc: 0.792 Test Loss: 21.160 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2641s/iter; left time: 2946.3484s
Epoch: 17 cost time: 16.352895975112915
Epoch: 17, Steps: 134 | Train Loss: 1.131 Vali Loss: 28.997 Vali Acc: 0.676 Test Loss: 28.997 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2625s/iter; left time: 2893.7389s
Epoch: 18 cost time: 16.306598901748657
Epoch: 18, Steps: 134 | Train Loss: 0.684 Vali Loss: 36.092 Vali Acc: 0.711 Test Loss: 36.092 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2625s/iter; left time: 2858.6916s
Epoch: 19 cost time: 16.300343990325928
Epoch: 19, Steps: 134 | Train Loss: 0.828 Vali Loss: 30.003 Vali Acc: 0.780 Test Loss: 30.003 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2628s/iter; left time: 2826.4279s
Epoch: 20 cost time: 16.329236268997192
Epoch: 20, Steps: 134 | Train Loss: 0.429 Vali Loss: 19.886 Vali Acc: 0.728 Test Loss: 19.886 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2640s/iter; left time: 2803.8609s
Epoch: 21 cost time: 16.440662622451782
Epoch: 21, Steps: 134 | Train Loss: 0.836 Vali Loss: 17.725 Vali Acc: 0.728 Test Loss: 17.725 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2650s/iter; left time: 2779.1303s
Epoch: 22 cost time: 16.32657742500305
Epoch: 22, Steps: 134 | Train Loss: 0.115 Vali Loss: 35.356 Vali Acc: 0.711 Test Loss: 35.356 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 15557095
model size : 59.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.648862600326538
Epoch: 1, Steps: 67 | Train Loss: 16.123 Vali Loss: 24.587 Vali Acc: 0.376 Test Loss: 24.587 Test Acc: 0.376
Validation loss decreased (inf --> -0.375477).  Saving model ...
Epoch: 2 cost time: 7.321514129638672
Epoch: 2, Steps: 67 | Train Loss: 14.165 Vali Loss: 4.808 Vali Acc: 0.642 Test Loss: 4.808 Test Acc: 0.642
Validation loss decreased (-0.375477 --> -0.641570).  Saving model ...
Epoch: 3 cost time: 7.331502437591553
Epoch: 3, Steps: 67 | Train Loss: 4.504 Vali Loss: 5.218 Vali Acc: 0.694 Test Loss: 5.218 Test Acc: 0.694
Validation loss decreased (-0.641570 --> -0.693589).  Saving model ...
Epoch: 4 cost time: 7.386523008346558
Epoch: 4, Steps: 67 | Train Loss: 0.916 Vali Loss: 4.865 Vali Acc: 0.769 Test Loss: 4.865 Test Acc: 0.769
Validation loss decreased (-0.693589 --> -0.768737).  Saving model ...
Epoch: 5 cost time: 7.494198799133301
Epoch: 5, Steps: 67 | Train Loss: 0.428 Vali Loss: 1.116 Vali Acc: 0.850 Test Loss: 1.116 Test Acc: 0.850
Validation loss decreased (-0.768737 --> -0.849700).  Saving model ...
Epoch: 6 cost time: 7.332574367523193
Epoch: 6, Steps: 67 | Train Loss: 0.185 Vali Loss: 1.271 Vali Acc: 0.850 Test Loss: 1.271 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.321547269821167
Epoch: 7, Steps: 67 | Train Loss: 0.663 Vali Loss: 3.717 Vali Acc: 0.757 Test Loss: 3.717 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.403611183166504
Epoch: 8, Steps: 67 | Train Loss: 0.061 Vali Loss: 4.123 Vali Acc: 0.809 Test Loss: 4.123 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.383497476577759
Epoch: 9, Steps: 67 | Train Loss: 0.462 Vali Loss: 2.399 Vali Acc: 0.821 Test Loss: 2.399 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.320983409881592
Epoch: 10, Steps: 67 | Train Loss: 0.072 Vali Loss: 3.757 Vali Acc: 0.775 Test Loss: 3.757 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.489891290664673
Epoch: 11, Steps: 67 | Train Loss: 0.552 Vali Loss: 2.579 Vali Acc: 0.809 Test Loss: 2.579 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.354668378829956
Epoch: 12, Steps: 67 | Train Loss: 0.564 Vali Loss: 11.266 Vali Acc: 0.699 Test Loss: 11.266 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.34709620475769
Epoch: 13, Steps: 67 | Train Loss: 0.324 Vali Loss: 2.542 Vali Acc: 0.861 Test Loss: 2.542 Test Acc: 0.861
Validation loss decreased (-0.849700 --> -0.861246).  Saving model ...
Epoch: 14 cost time: 7.350381135940552
Epoch: 14, Steps: 67 | Train Loss: 0.993 Vali Loss: 5.115 Vali Acc: 0.798 Test Loss: 5.115 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.425257682800293
Epoch: 15, Steps: 67 | Train Loss: 0.689 Vali Loss: 6.270 Vali Acc: 0.740 Test Loss: 6.270 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.414095163345337
Epoch: 16, Steps: 67 | Train Loss: 0.460 Vali Loss: 12.128 Vali Acc: 0.780 Test Loss: 12.128 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.483628034591675
Epoch: 17, Steps: 67 | Train Loss: 0.266 Vali Loss: 5.554 Vali Acc: 0.815 Test Loss: 5.554 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.414479494094849
Epoch: 18, Steps: 67 | Train Loss: 0.005 Vali Loss: 5.282 Vali Acc: 0.803 Test Loss: 5.282 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.413976192474365
Epoch: 19, Steps: 67 | Train Loss: 0.099 Vali Loss: 8.137 Vali Acc: 0.821 Test Loss: 8.137 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.569689035415649
Epoch: 20, Steps: 67 | Train Loss: 0.002 Vali Loss: 4.818 Vali Acc: 0.803 Test Loss: 4.818 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.395004987716675
Epoch: 21, Steps: 67 | Train Loss: 0.078 Vali Loss: 12.003 Vali Acc: 0.757 Test Loss: 12.003 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.360252618789673
Epoch: 22, Steps: 67 | Train Loss: 0.658 Vali Loss: 12.412 Vali Acc: 0.734 Test Loss: 12.412 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.453104734420776
Epoch: 23, Steps: 67 | Train Loss: 0.268 Vali Loss: 5.151 Vali Acc: 0.803 Test Loss: 5.151 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 7791591
model size : 30.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.107545614242554
Epoch: 1, Steps: 67 | Train Loss: 14.352 Vali Loss: 18.428 Vali Acc: 0.434 Test Loss: 18.428 Test Acc: 0.434
Validation loss decreased (inf --> -0.433342).  Saving model ...
Epoch: 2 cost time: 4.994882583618164
Epoch: 2, Steps: 67 | Train Loss: 7.374 Vali Loss: 7.270 Vali Acc: 0.676 Test Loss: 7.270 Test Acc: 0.676
Validation loss decreased (-0.433342 --> -0.676228).  Saving model ...
Epoch: 3 cost time: 4.814403057098389
Epoch: 3, Steps: 67 | Train Loss: 3.017 Vali Loss: 2.689 Vali Acc: 0.728 Test Loss: 2.689 Test Acc: 0.728
Validation loss decreased (-0.676228 --> -0.728297).  Saving model ...
Epoch: 4 cost time: 4.810421466827393
Epoch: 4, Steps: 67 | Train Loss: 0.328 Vali Loss: 2.262 Vali Acc: 0.821 Test Loss: 2.262 Test Acc: 0.821
Validation loss decreased (-0.728297 --> -0.820787).  Saving model ...
Epoch: 5 cost time: 4.750859022140503
Epoch: 5, Steps: 67 | Train Loss: 0.370 Vali Loss: 2.874 Vali Acc: 0.815 Test Loss: 2.874 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.775069236755371
Epoch: 6, Steps: 67 | Train Loss: 0.209 Vali Loss: 1.973 Vali Acc: 0.809 Test Loss: 1.973 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.809768199920654
Epoch: 7, Steps: 67 | Train Loss: 0.076 Vali Loss: 1.979 Vali Acc: 0.798 Test Loss: 1.979 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.917526721954346
Epoch: 8, Steps: 67 | Train Loss: 0.013 Vali Loss: 3.850 Vali Acc: 0.769 Test Loss: 3.850 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.779963493347168
Epoch: 9, Steps: 67 | Train Loss: 0.199 Vali Loss: 6.133 Vali Acc: 0.711 Test Loss: 6.133 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.736322641372681
Epoch: 10, Steps: 67 | Train Loss: 0.305 Vali Loss: 6.971 Vali Acc: 0.798 Test Loss: 6.971 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.788033485412598
Epoch: 11, Steps: 67 | Train Loss: 0.397 Vali Loss: 3.149 Vali Acc: 0.798 Test Loss: 3.149 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.824263572692871
Epoch: 12, Steps: 67 | Train Loss: 0.306 Vali Loss: 4.391 Vali Acc: 0.763 Test Loss: 4.391 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.924470901489258
Epoch: 13, Steps: 67 | Train Loss: 0.064 Vali Loss: 3.163 Vali Acc: 0.746 Test Loss: 3.163 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.760559320449829
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.763 Test Loss: 2.540 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5203143
model size : 20.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.535222291946411
Epoch: 1, Steps: 67 | Train Loss: 12.451 Vali Loss: 8.581 Vali Acc: 0.462 Test Loss: 8.581 Test Acc: 0.462
Validation loss decreased (inf --> -0.462342).  Saving model ...
Epoch: 2 cost time: 4.367324590682983
Epoch: 2, Steps: 67 | Train Loss: 8.296 Vali Loss: 10.025 Vali Acc: 0.549 Test Loss: 10.025 Test Acc: 0.549
Validation loss decreased (-0.462342 --> -0.549033).  Saving model ...
Epoch: 3 cost time: 4.329064846038818
Epoch: 3, Steps: 67 | Train Loss: 4.419 Vali Loss: 7.611 Vali Acc: 0.676 Test Loss: 7.611 Test Acc: 0.676
Validation loss decreased (-0.549033 --> -0.676224).  Saving model ...
Epoch: 4 cost time: 4.3710854053497314
Epoch: 4, Steps: 67 | Train Loss: 0.399 Vali Loss: 7.805 Vali Acc: 0.705 Test Loss: 7.805 Test Acc: 0.705
Validation loss decreased (-0.676224 --> -0.705124).  Saving model ...
Epoch: 5 cost time: 4.480022192001343
Epoch: 5, Steps: 67 | Train Loss: 1.438 Vali Loss: 6.160 Vali Acc: 0.665 Test Loss: 6.160 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.4834089279174805
Epoch: 6, Steps: 67 | Train Loss: 0.336 Vali Loss: 6.572 Vali Acc: 0.780 Test Loss: 6.572 Test Acc: 0.780
Validation loss decreased (-0.705124 --> -0.780281).  Saving model ...
Epoch: 7 cost time: 4.457702875137329
Epoch: 7, Steps: 67 | Train Loss: 0.129 Vali Loss: 11.859 Vali Acc: 0.682 Test Loss: 11.859 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.475940465927124
Epoch: 8, Steps: 67 | Train Loss: 0.227 Vali Loss: 5.554 Vali Acc: 0.723 Test Loss: 5.554 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.377744913101196
Epoch: 9, Steps: 67 | Train Loss: 0.080 Vali Loss: 2.201 Vali Acc: 0.809 Test Loss: 2.201 Test Acc: 0.809
Validation loss decreased (-0.780281 --> -0.809227).  Saving model ...
Epoch: 10 cost time: 4.5198400020599365
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.341 Vali Acc: 0.821 Test Loss: 2.341 Test Acc: 0.821
Validation loss decreased (-0.809227 --> -0.820786).  Saving model ...
Epoch: 11 cost time: 4.532770156860352
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.336 Vali Acc: 0.821 Test Loss: 2.336 Test Acc: 0.821
Validation loss decreased (-0.820786 --> -0.820786).  Saving model ...
Epoch: 12 cost time: 4.4668803215026855
Epoch: 12, Steps: 67 | Train Loss: 0.023 Vali Loss: 5.441 Vali Acc: 0.803 Test Loss: 5.441 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.511478662490845
Epoch: 13, Steps: 67 | Train Loss: 0.222 Vali Loss: 7.448 Vali Acc: 0.751 Test Loss: 7.448 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.500957250595093
Epoch: 14, Steps: 67 | Train Loss: 0.015 Vali Loss: 6.083 Vali Acc: 0.705 Test Loss: 6.083 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.4579620361328125
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.100 Vali Acc: 0.769 Test Loss: 5.100 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.44044041633606
Epoch: 16, Steps: 67 | Train Loss: 0.063 Vali Loss: 4.940 Vali Acc: 0.734 Test Loss: 4.940 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.479228258132935
Epoch: 17, Steps: 67 | Train Loss: 0.081 Vali Loss: 13.175 Vali Acc: 0.723 Test Loss: 13.175 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.474332571029663
Epoch: 18, Steps: 67 | Train Loss: 0.441 Vali Loss: 7.682 Vali Acc: 0.740 Test Loss: 7.682 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.41779637336731
Epoch: 19, Steps: 67 | Train Loss: 0.450 Vali Loss: 14.257 Vali Acc: 0.572 Test Loss: 14.257 Test Acc: 0.572
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.501921892166138
Epoch: 20, Steps: 67 | Train Loss: 0.372 Vali Loss: 5.156 Vali Acc: 0.780 Test Loss: 5.156 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.50487208366394
Epoch: 21, Steps: 67 | Train Loss: 0.078 Vali Loss: 9.732 Vali Acc: 0.740 Test Loss: 9.732 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3908999
model size : 15.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.7835259437561035
Epoch: 1, Steps: 67 | Train Loss: 6.614 Vali Loss: 5.246 Vali Acc: 0.497 Test Loss: 5.246 Test Acc: 0.497
Validation loss decreased (inf --> -0.497057).  Saving model ...
Epoch: 2 cost time: 3.377711296081543
Epoch: 2, Steps: 67 | Train Loss: 5.778 Vali Loss: 5.604 Vali Acc: 0.699 Test Loss: 5.604 Test Acc: 0.699
Validation loss decreased (-0.497057 --> -0.699366).  Saving model ...
Epoch: 3 cost time: 3.4466214179992676
Epoch: 3, Steps: 67 | Train Loss: 2.102 Vali Loss: 5.780 Vali Acc: 0.584 Test Loss: 5.780 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3558056354522705
Epoch: 4, Steps: 67 | Train Loss: 0.698 Vali Loss: 1.948 Vali Acc: 0.769 Test Loss: 1.948 Test Acc: 0.769
Validation loss decreased (-0.699366 --> -0.768767).  Saving model ...
Epoch: 5 cost time: 3.340834856033325
Epoch: 5, Steps: 67 | Train Loss: 0.315 Vali Loss: 2.630 Vali Acc: 0.740 Test Loss: 2.630 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4505393505096436
Epoch: 6, Steps: 67 | Train Loss: 0.161 Vali Loss: 3.576 Vali Acc: 0.757 Test Loss: 3.576 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4003326892852783
Epoch: 7, Steps: 67 | Train Loss: 0.178 Vali Loss: 3.349 Vali Acc: 0.757 Test Loss: 3.349 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.4128963947296143
Epoch: 8, Steps: 67 | Train Loss: 0.075 Vali Loss: 2.680 Vali Acc: 0.763 Test Loss: 2.680 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3695433139801025
Epoch: 9, Steps: 67 | Train Loss: 0.132 Vali Loss: 2.591 Vali Acc: 0.803 Test Loss: 2.591 Test Acc: 0.803
Validation loss decreased (-0.768767 --> -0.803442).  Saving model ...
Epoch: 10 cost time: 3.3747189044952393
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.792 Test Loss: 1.855 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4759514331817627
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.820 Vali Acc: 0.780 Test Loss: 1.820 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.371177911758423
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.780 Test Loss: 1.821 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.4978203773498535
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.582 Vali Acc: 0.780 Test Loss: 1.582 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3771231174468994
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.780 Test Loss: 1.580 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3795981407165527
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.792 Test Loss: 1.576 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.38368558883667
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.780 Test Loss: 1.581 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.3529293537139893
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.780 Test Loss: 1.587 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3586385250091553
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.792 Test Loss: 1.571 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.430023193359375
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.821 Test Loss: 1.818 Test Acc: 0.821
Validation loss decreased (-0.803442 --> -0.820791).  Saving model ...
Epoch: 20 cost time: 3.4583852291107178
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.821 Test Loss: 1.816 Test Acc: 0.821
Validation loss decreased (-0.820791 --> -0.820791).  Saving model ...
Epoch: 21 cost time: 3.502157688140869
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.821 Test Loss: 1.819 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.607938289642334
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.821 Test Loss: 1.817 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5293710231781006
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.827 Test Loss: 1.801 Test Acc: 0.827
Validation loss decreased (-0.820791 --> -0.826572).  Saving model ...
Epoch: 24 cost time: 3.6240108013153076
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.827 Test Loss: 1.794 Test Acc: 0.827
Validation loss decreased (-0.826572 --> -0.826572).  Saving model ...
Epoch: 25 cost time: 3.707672357559204
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.827 Test Loss: 1.801 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5140037536621094
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.827 Test Loss: 1.800 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.555612087249756
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.827 Test Loss: 1.762 Test Acc: 0.827
Validation loss decreased (-0.826572 --> -0.826572).  Saving model ...
Epoch: 28 cost time: 3.720818281173706
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.827 Test Loss: 1.749 Test Acc: 0.827
Validation loss decreased (-0.826572 --> -0.826572).  Saving model ...
Epoch: 29 cost time: 3.403742551803589
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.750 Vali Acc: 0.827 Test Loss: 1.750 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4547884464263916
Epoch: 30, Steps: 67 | Train Loss: 2.079 Vali Loss: 19.171 Vali Acc: 0.451 Test Loss: 19.171 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.4682776927948
Epoch: 31, Steps: 67 | Train Loss: 5.323 Vali Loss: 13.961 Vali Acc: 0.601 Test Loss: 13.961 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.503255605697632
Epoch: 32, Steps: 67 | Train Loss: 1.667 Vali Loss: 23.593 Vali Acc: 0.578 Test Loss: 23.593 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.533933639526367
Epoch: 33, Steps: 67 | Train Loss: 2.097 Vali Loss: 19.767 Vali Acc: 0.676 Test Loss: 19.767 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 3.4001779556274414
Epoch: 34, Steps: 67 | Train Loss: 1.017 Vali Loss: 11.508 Vali Acc: 0.671 Test Loss: 11.508 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.3588273525238037
Epoch: 35, Steps: 67 | Train Loss: 1.289 Vali Loss: 18.625 Vali Acc: 0.682 Test Loss: 18.625 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.4882593154907227
Epoch: 36, Steps: 67 | Train Loss: 0.281 Vali Loss: 7.422 Vali Acc: 0.780 Test Loss: 7.422 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.3680968284606934
Epoch: 37, Steps: 67 | Train Loss: 0.100 Vali Loss: 14.613 Vali Acc: 0.775 Test Loss: 14.613 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.3195557594299316
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.982 Vali Acc: 0.792 Test Loss: 15.982 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2830663
model size : 11.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.270971298217773
Epoch: 1, Steps: 67 | Train Loss: 3.550 Vali Loss: 4.804 Vali Acc: 0.382 Test Loss: 4.804 Test Acc: 0.382
Validation loss decreased (inf --> -0.381455).  Saving model ...
Epoch: 2 cost time: 2.793409824371338
Epoch: 2, Steps: 67 | Train Loss: 2.387 Vali Loss: 5.877 Vali Acc: 0.555 Test Loss: 5.877 Test Acc: 0.555
Validation loss decreased (-0.381455 --> -0.554855).  Saving model ...
Epoch: 3 cost time: 2.7277820110321045
Epoch: 3, Steps: 67 | Train Loss: 2.614 Vali Loss: 2.018 Vali Acc: 0.746 Test Loss: 2.018 Test Acc: 0.746
Validation loss decreased (-0.554855 --> -0.745645).  Saving model ...
Epoch: 4 cost time: 2.785276412963867
Epoch: 4, Steps: 67 | Train Loss: 0.205 Vali Loss: 1.893 Vali Acc: 0.711 Test Loss: 1.893 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7506496906280518
Epoch: 5, Steps: 67 | Train Loss: 0.090 Vali Loss: 1.418 Vali Acc: 0.809 Test Loss: 1.418 Test Acc: 0.809
Validation loss decreased (-0.745645 --> -0.809234).  Saving model ...
Epoch: 6 cost time: 2.7806742191314697
Epoch: 6, Steps: 67 | Train Loss: 0.045 Vali Loss: 0.980 Vali Acc: 0.850 Test Loss: 0.980 Test Acc: 0.850
Validation loss decreased (-0.809234 --> -0.849701).  Saving model ...
Epoch: 7 cost time: 2.771477460861206
Epoch: 7, Steps: 67 | Train Loss: 0.092 Vali Loss: 1.469 Vali Acc: 0.855 Test Loss: 1.469 Test Acc: 0.855
Validation loss decreased (-0.849701 --> -0.855477).  Saving model ...
Epoch: 8 cost time: 2.753556489944458
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.867 Test Loss: 0.727 Test Acc: 0.867
Validation loss decreased (-0.855477 --> -0.867045).  Saving model ...
Epoch: 9 cost time: 2.754767894744873
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.867 Test Loss: 0.707 Test Acc: 0.867
Validation loss decreased (-0.867045 --> -0.867045).  Saving model ...
Epoch: 10 cost time: 2.7871737480163574
Epoch: 10, Steps: 67 | Train Loss: 0.003 Vali Loss: 4.981 Vali Acc: 0.688 Test Loss: 4.981 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7709836959838867
Epoch: 11, Steps: 67 | Train Loss: 0.138 Vali Loss: 6.391 Vali Acc: 0.624 Test Loss: 6.391 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7363295555114746
Epoch: 12, Steps: 67 | Train Loss: 0.915 Vali Loss: 1.638 Vali Acc: 0.786 Test Loss: 1.638 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7312705516815186
Epoch: 13, Steps: 67 | Train Loss: 0.426 Vali Loss: 3.876 Vali Acc: 0.792 Test Loss: 3.876 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7511329650878906
Epoch: 14, Steps: 67 | Train Loss: 0.220 Vali Loss: 3.462 Vali Acc: 0.792 Test Loss: 3.462 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8355724811553955
Epoch: 15, Steps: 67 | Train Loss: 0.208 Vali Loss: 2.530 Vali Acc: 0.769 Test Loss: 2.530 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9577536582946777
Epoch: 16, Steps: 67 | Train Loss: 0.053 Vali Loss: 3.660 Vali Acc: 0.832 Test Loss: 3.660 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7751846313476562
Epoch: 17, Steps: 67 | Train Loss: 0.042 Vali Loss: 2.762 Vali Acc: 0.844 Test Loss: 2.762 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.851073741912842
Epoch: 18, Steps: 67 | Train Loss: 0.105 Vali Loss: 4.685 Vali Acc: 0.751 Test Loss: 4.685 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.0832881927490234
Epoch: 19, Steps: 67 | Train Loss: 0.326 Vali Loss: 1.553 Vali Acc: 0.832 Test Loss: 1.553 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1968039
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.917720079421997
Epoch: 1, Steps: 67 | Train Loss: 3.891 Vali Loss: 3.570 Vali Acc: 0.607 Test Loss: 3.570 Test Acc: 0.607
Validation loss decreased (inf --> -0.606901).  Saving model ...
Epoch: 2 cost time: 2.4758856296539307
Epoch: 2, Steps: 67 | Train Loss: 4.262 Vali Loss: 5.313 Vali Acc: 0.543 Test Loss: 5.313 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3550000190734863
Epoch: 3, Steps: 67 | Train Loss: 0.605 Vali Loss: 2.910 Vali Acc: 0.751 Test Loss: 2.910 Test Acc: 0.751
Validation loss decreased (-0.606901 --> -0.751416).  Saving model ...
Epoch: 4 cost time: 2.4491631984710693
Epoch: 4, Steps: 67 | Train Loss: 0.513 Vali Loss: 2.600 Vali Acc: 0.740 Test Loss: 2.600 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4122984409332275
Epoch: 5, Steps: 67 | Train Loss: 0.306 Vali Loss: 1.442 Vali Acc: 0.803 Test Loss: 1.442 Test Acc: 0.803
Validation loss decreased (-0.751416 --> -0.803454).  Saving model ...
Epoch: 6 cost time: 2.431478500366211
Epoch: 6, Steps: 67 | Train Loss: 0.236 Vali Loss: 3.897 Vali Acc: 0.705 Test Loss: 3.897 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.295924425125122
Epoch: 7, Steps: 67 | Train Loss: 0.216 Vali Loss: 3.811 Vali Acc: 0.717 Test Loss: 3.811 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.483043670654297
Epoch: 8, Steps: 67 | Train Loss: 0.163 Vali Loss: 1.152 Vali Acc: 0.879 Test Loss: 1.152 Test Acc: 0.879
Validation loss decreased (-0.803454 --> -0.878601).  Saving model ...
Epoch: 9 cost time: 2.316406011581421
Epoch: 9, Steps: 67 | Train Loss: 0.040 Vali Loss: 3.379 Vali Acc: 0.740 Test Loss: 3.379 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4652271270751953
Epoch: 10, Steps: 67 | Train Loss: 0.042 Vali Loss: 3.804 Vali Acc: 0.757 Test Loss: 3.804 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5316245555877686
Epoch: 11, Steps: 67 | Train Loss: 0.054 Vali Loss: 1.965 Vali Acc: 0.792 Test Loss: 1.965 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6232707500457764
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 3.112 Vali Acc: 0.751 Test Loss: 3.112 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4213321208953857
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.102 Vali Acc: 0.786 Test Loss: 3.102 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.526390552520752
Epoch: 14, Steps: 67 | Train Loss: 0.061 Vali Loss: 3.576 Vali Acc: 0.699 Test Loss: 3.576 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.511598825454712
Epoch: 15, Steps: 67 | Train Loss: 0.199 Vali Loss: 8.807 Vali Acc: 0.659 Test Loss: 8.807 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5367672443389893
Epoch: 16, Steps: 67 | Train Loss: 0.549 Vali Loss: 9.434 Vali Acc: 0.659 Test Loss: 9.434 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.473477840423584
Epoch: 17, Steps: 67 | Train Loss: 0.193 Vali Loss: 2.843 Vali Acc: 0.780 Test Loss: 2.843 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4503941535949707
Epoch: 18, Steps: 67 | Train Loss: 0.166 Vali Loss: 1.648 Vali Acc: 0.809 Test Loss: 1.648 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1752551
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 54.1336327
	speed: 0.1474s/iter; left time: 1960.8917s
Epoch: 1 cost time: 19.293660163879395
Epoch: 1, Steps: 134 | Train Loss: 39.036 Vali Loss: 13.528 Vali Acc: 0.497 Test Loss: 13.528 Test Acc: 0.497
Validation loss decreased (inf --> -0.496975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000001
	speed: 0.2744s/iter; left time: 3613.0417s
Epoch: 2 cost time: 18.255497694015503
Epoch: 2, Steps: 134 | Train Loss: 4.759 Vali Loss: 3.398 Vali Acc: 0.734 Test Loss: 3.398 Test Acc: 0.734
Validation loss decreased (-0.496975 --> -0.734070).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.2830s/iter; left time: 3688.2732s
Epoch: 3 cost time: 18.68667435646057
Epoch: 3, Steps: 134 | Train Loss: 0.699 Vali Loss: 7.728 Vali Acc: 0.711 Test Loss: 7.728 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000282
	speed: 0.2787s/iter; left time: 3595.4674s
Epoch: 4 cost time: 18.475937604904175
Epoch: 4, Steps: 134 | Train Loss: 1.157 Vali Loss: 5.513 Vali Acc: 0.717 Test Loss: 5.513 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000001
	speed: 0.2826s/iter; left time: 3607.6312s
Epoch: 5 cost time: 18.654218435287476
Epoch: 5, Steps: 134 | Train Loss: 0.676 Vali Loss: 4.818 Vali Acc: 0.763 Test Loss: 4.818 Test Acc: 0.763
Validation loss decreased (-0.734070 --> -0.762958).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2827s/iter; left time: 3570.1862s
Epoch: 6 cost time: 18.630608558654785
Epoch: 6, Steps: 134 | Train Loss: 0.164 Vali Loss: 4.239 Vali Acc: 0.798 Test Loss: 4.239 Test Acc: 0.798
Validation loss decreased (-0.762958 --> -0.797645).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2857s/iter; left time: 3570.0700s
Epoch: 7 cost time: 18.70323157310486
Epoch: 7, Steps: 134 | Train Loss: 1.487 Vali Loss: 5.604 Vali Acc: 0.757 Test Loss: 5.604 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2814s/iter; left time: 3479.1018s
Epoch: 8 cost time: 18.85383176803589
Epoch: 8, Steps: 134 | Train Loss: 1.076 Vali Loss: 5.205 Vali Acc: 0.780 Test Loss: 5.205 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 3487.6566s
Epoch: 9 cost time: 18.64121723175049
Epoch: 9, Steps: 134 | Train Loss: 0.272 Vali Loss: 4.730 Vali Acc: 0.763 Test Loss: 4.730 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2793s/iter; left time: 3377.8783s
Epoch: 10 cost time: 18.745177030563354
Epoch: 10, Steps: 134 | Train Loss: 0.049 Vali Loss: 26.409 Vali Acc: 0.572 Test Loss: 26.409 Test Acc: 0.572
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2788s/iter; left time: 3334.6801s
Epoch: 11 cost time: 18.62010407447815
Epoch: 11, Steps: 134 | Train Loss: 0.836 Vali Loss: 2.987 Vali Acc: 0.723 Test Loss: 2.987 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 5.6758289
	speed: 0.2775s/iter; left time: 3282.3984s
Epoch: 12 cost time: 18.51857614517212
Epoch: 12, Steps: 134 | Train Loss: 0.374 Vali Loss: 15.615 Vali Acc: 0.746 Test Loss: 15.615 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 3277.1945s
Epoch: 13 cost time: 18.60492992401123
Epoch: 13, Steps: 134 | Train Loss: 0.658 Vali Loss: 5.050 Vali Acc: 0.763 Test Loss: 5.050 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2762s/iter; left time: 3193.0869s
Epoch: 14 cost time: 18.5193989276886
Epoch: 14, Steps: 134 | Train Loss: 0.378 Vali Loss: 19.460 Vali Acc: 0.676 Test Loss: 19.460 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2766s/iter; left time: 3159.9036s
Epoch: 15 cost time: 18.588616847991943
Epoch: 15, Steps: 134 | Train Loss: 0.475 Vali Loss: 10.418 Vali Acc: 0.815 Test Loss: 10.418 Test Acc: 0.815
Validation loss decreased (-0.797645 --> -0.814925).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2837s/iter; left time: 3203.1149s
Epoch: 16 cost time: 18.534451484680176
Epoch: 16, Steps: 134 | Train Loss: 0.657 Vali Loss: 17.565 Vali Acc: 0.723 Test Loss: 17.565 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2831s/iter; left time: 3158.0696s
Epoch: 17 cost time: 18.77094841003418
Epoch: 17, Steps: 134 | Train Loss: 2.239 Vali Loss: 4.870 Vali Acc: 0.775 Test Loss: 4.870 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2850s/iter; left time: 3141.4819s
Epoch: 18 cost time: 18.73465085029602
Epoch: 18, Steps: 134 | Train Loss: 0.427 Vali Loss: 10.429 Vali Acc: 0.798 Test Loss: 10.429 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2834s/iter; left time: 3085.9165s
Epoch: 19 cost time: 18.560362339019775
Epoch: 19, Steps: 134 | Train Loss: 0.003 Vali Loss: 9.625 Vali Acc: 0.763 Test Loss: 9.625 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2789s/iter; left time: 2999.5685s
Epoch: 20 cost time: 18.661247730255127
Epoch: 20, Steps: 134 | Train Loss: 0.114 Vali Loss: 15.640 Vali Acc: 0.832 Test Loss: 15.640 Test Acc: 0.832
Validation loss decreased (-0.814925 --> -0.832214).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2807s/iter; left time: 2980.9324s
Epoch: 21 cost time: 18.63080358505249
Epoch: 21, Steps: 134 | Train Loss: 0.000 Vali Loss: 11.302 Vali Acc: 0.792 Test Loss: 11.302 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2786s/iter; left time: 2922.0028s
Epoch: 22 cost time: 18.72668147087097
Epoch: 22, Steps: 134 | Train Loss: 0.000 Vali Loss: 11.695 Vali Acc: 0.769 Test Loss: 11.695 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2821s/iter; left time: 2920.6937s
Epoch: 23 cost time: 18.730581998825073
Epoch: 23, Steps: 134 | Train Loss: 0.000 Vali Loss: 11.569 Vali Acc: 0.769 Test Loss: 11.569 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2797s/iter; left time: 2858.6215s
Epoch: 24 cost time: 18.582352876663208
Epoch: 24, Steps: 134 | Train Loss: 0.000 Vali Loss: 24.038 Vali Acc: 0.699 Test Loss: 24.038 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2816s/iter; left time: 2839.6812s
Epoch: 25 cost time: 18.634928226470947
Epoch: 25, Steps: 134 | Train Loss: 3.117 Vali Loss: 22.144 Vali Acc: 0.682 Test Loss: 22.144 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2868s/iter; left time: 2853.8717s
Epoch: 26 cost time: 18.8420889377594
Epoch: 26, Steps: 134 | Train Loss: 0.993 Vali Loss: 26.368 Vali Acc: 0.642 Test Loss: 26.368 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.2846s/iter; left time: 2793.7443s
Epoch: 27 cost time: 18.69289207458496
Epoch: 27, Steps: 134 | Train Loss: 0.393 Vali Loss: 25.581 Vali Acc: 0.723 Test Loss: 25.581 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.2837s/iter; left time: 2747.0222s
Epoch: 28 cost time: 18.777649641036987
Epoch: 28, Steps: 134 | Train Loss: 0.434 Vali Loss: 108.099 Vali Acc: 0.538 Test Loss: 108.099 Test Acc: 0.538
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 30.1011810
	speed: 0.2829s/iter; left time: 2701.0493s
Epoch: 29 cost time: 18.855027437210083
Epoch: 29, Steps: 134 | Train Loss: 1.401 Vali Loss: 29.386 Vali Acc: 0.757 Test Loss: 29.386 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.2825s/iter; left time: 2659.3438s
Epoch: 30 cost time: 18.950974464416504
Epoch: 30, Steps: 134 | Train Loss: 0.060 Vali Loss: 22.641 Vali Acc: 0.763 Test Loss: 22.641 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7794583
model size : 30.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.536410808563232
Epoch: 1, Steps: 67 | Train Loss: 8.947 Vali Loss: 9.446 Vali Acc: 0.532 Test Loss: 9.446 Test Acc: 0.532
Validation loss decreased (inf --> -0.531697).  Saving model ...
Epoch: 2 cost time: 9.163651466369629
Epoch: 2, Steps: 67 | Train Loss: 11.760 Vali Loss: 10.533 Vali Acc: 0.549 Test Loss: 10.533 Test Acc: 0.549
Validation loss decreased (-0.531697 --> -0.549028).  Saving model ...
Epoch: 3 cost time: 9.130530834197998
Epoch: 3, Steps: 67 | Train Loss: 1.818 Vali Loss: 3.949 Vali Acc: 0.676 Test Loss: 3.949 Test Acc: 0.676
Validation loss decreased (-0.549028 --> -0.676261).  Saving model ...
Epoch: 4 cost time: 9.471111297607422
Epoch: 4, Steps: 67 | Train Loss: 0.300 Vali Loss: 2.845 Vali Acc: 0.780 Test Loss: 2.845 Test Acc: 0.780
Validation loss decreased (-0.676261 --> -0.780318).  Saving model ...
Epoch: 5 cost time: 9.29304838180542
Epoch: 5, Steps: 67 | Train Loss: 0.082 Vali Loss: 3.561 Vali Acc: 0.757 Test Loss: 3.561 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.256659746170044
Epoch: 6, Steps: 67 | Train Loss: 0.310 Vali Loss: 3.784 Vali Acc: 0.734 Test Loss: 3.784 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.26694631576538
Epoch: 7, Steps: 67 | Train Loss: 0.113 Vali Loss: 3.438 Vali Acc: 0.763 Test Loss: 3.438 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.276285409927368
Epoch: 8, Steps: 67 | Train Loss: 0.091 Vali Loss: 3.982 Vali Acc: 0.751 Test Loss: 3.982 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.237529754638672
Epoch: 9, Steps: 67 | Train Loss: 0.051 Vali Loss: 3.232 Vali Acc: 0.821 Test Loss: 3.232 Test Acc: 0.821
Validation loss decreased (-0.780318 --> -0.820777).  Saving model ...
Epoch: 10 cost time: 9.418668270111084
Epoch: 10, Steps: 67 | Train Loss: 0.026 Vali Loss: 5.149 Vali Acc: 0.740 Test Loss: 5.149 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.344465017318726
Epoch: 11, Steps: 67 | Train Loss: 0.066 Vali Loss: 4.250 Vali Acc: 0.740 Test Loss: 4.250 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.193134546279907
Epoch: 12, Steps: 67 | Train Loss: 0.382 Vali Loss: 5.172 Vali Acc: 0.734 Test Loss: 5.172 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.271599769592285
Epoch: 13, Steps: 67 | Train Loss: 0.322 Vali Loss: 7.683 Vali Acc: 0.636 Test Loss: 7.683 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.263587474822998
Epoch: 14, Steps: 67 | Train Loss: 0.200 Vali Loss: 2.508 Vali Acc: 0.850 Test Loss: 2.508 Test Acc: 0.850
Validation loss decreased (-0.820777 --> -0.849686).  Saving model ...
Epoch: 15 cost time: 9.364539861679077
Epoch: 15, Steps: 67 | Train Loss: 0.224 Vali Loss: 3.335 Vali Acc: 0.809 Test Loss: 3.335 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.352406024932861
Epoch: 16, Steps: 67 | Train Loss: 0.079 Vali Loss: 3.588 Vali Acc: 0.821 Test Loss: 3.588 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.277040719985962
Epoch: 17, Steps: 67 | Train Loss: 0.056 Vali Loss: 2.735 Vali Acc: 0.850 Test Loss: 2.735 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.250416040420532
Epoch: 18, Steps: 67 | Train Loss: 0.520 Vali Loss: 5.147 Vali Acc: 0.653 Test Loss: 5.147 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.280761003494263
Epoch: 19, Steps: 67 | Train Loss: 0.159 Vali Loss: 2.595 Vali Acc: 0.832 Test Loss: 2.595 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.41679573059082
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.014 Vali Acc: 0.786 Test Loss: 4.014 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.157897472381592
Epoch: 21, Steps: 67 | Train Loss: 0.130 Vali Loss: 4.572 Vali Acc: 0.763 Test Loss: 4.572 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.273070573806763
Epoch: 22, Steps: 67 | Train Loss: 0.508 Vali Loss: 7.108 Vali Acc: 0.751 Test Loss: 7.108 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.185096263885498
Epoch: 23, Steps: 67 | Train Loss: 0.192 Vali Loss: 7.295 Vali Acc: 0.705 Test Loss: 7.295 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.507671356201172
Epoch: 24, Steps: 67 | Train Loss: 0.104 Vali Loss: 6.549 Vali Acc: 0.751 Test Loss: 6.549 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 3911831
model size : 15.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.678156614303589
Epoch: 1, Steps: 67 | Train Loss: 5.487 Vali Loss: 12.597 Vali Acc: 0.445 Test Loss: 12.597 Test Acc: 0.445
Validation loss decreased (inf --> -0.444961).  Saving model ...
Epoch: 2 cost time: 5.237236261367798
Epoch: 2, Steps: 67 | Train Loss: 3.000 Vali Loss: 1.040 Vali Acc: 0.769 Test Loss: 1.040 Test Acc: 0.769
Validation loss decreased (-0.444961 --> -0.768776).  Saving model ...
Epoch: 3 cost time: 5.2173144817352295
Epoch: 3, Steps: 67 | Train Loss: 0.860 Vali Loss: 2.531 Vali Acc: 0.694 Test Loss: 2.531 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.227916717529297
Epoch: 4, Steps: 67 | Train Loss: 0.283 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
Validation loss decreased (-0.768776 --> -0.809240).  Saving model ...
Epoch: 5 cost time: 5.1716954708099365
Epoch: 5, Steps: 67 | Train Loss: 0.084 Vali Loss: 1.809 Vali Acc: 0.751 Test Loss: 1.809 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.28737211227417
Epoch: 6, Steps: 67 | Train Loss: 0.138 Vali Loss: 1.591 Vali Acc: 0.780 Test Loss: 1.591 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.338918447494507
Epoch: 7, Steps: 67 | Train Loss: 0.138 Vali Loss: 1.666 Vali Acc: 0.792 Test Loss: 1.666 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.413294076919556
Epoch: 8, Steps: 67 | Train Loss: 0.045 Vali Loss: 1.580 Vali Acc: 0.867 Test Loss: 1.580 Test Acc: 0.867
Validation loss decreased (-0.809240 --> -0.867036).  Saving model ...
Epoch: 9 cost time: 5.324714660644531
Epoch: 9, Steps: 67 | Train Loss: 0.184 Vali Loss: 2.318 Vali Acc: 0.728 Test Loss: 2.318 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.3732640743255615
Epoch: 10, Steps: 67 | Train Loss: 0.150 Vali Loss: 1.655 Vali Acc: 0.861 Test Loss: 1.655 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.389733076095581
Epoch: 11, Steps: 67 | Train Loss: 0.405 Vali Loss: 3.274 Vali Acc: 0.821 Test Loss: 3.274 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.432345628738403
Epoch: 12, Steps: 67 | Train Loss: 0.201 Vali Loss: 3.282 Vali Acc: 0.757 Test Loss: 3.282 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.440755367279053
Epoch: 13, Steps: 67 | Train Loss: 0.029 Vali Loss: 1.914 Vali Acc: 0.844 Test Loss: 1.914 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.438975811004639
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.809 Test Loss: 2.279 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.449208498001099
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.259 Vali Acc: 0.809 Test Loss: 2.259 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.437233924865723
Epoch: 16, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.542 Vali Acc: 0.798 Test Loss: 2.542 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.463195085525513
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.776 Vali Acc: 0.798 Test Loss: 2.776 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.380987882614136
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.853 Vali Acc: 0.809 Test Loss: 2.853 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2617607
model size : 10.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.830569744110107
Epoch: 1, Steps: 67 | Train Loss: 4.715 Vali Loss: 6.917 Vali Acc: 0.584 Test Loss: 6.917 Test Acc: 0.584
Validation loss decreased (inf --> -0.583746).  Saving model ...
Epoch: 2 cost time: 4.58098292350769
Epoch: 2, Steps: 67 | Train Loss: 4.499 Vali Loss: 2.583 Vali Acc: 0.723 Test Loss: 2.583 Test Acc: 0.723
Validation loss decreased (-0.583746 --> -0.722518).  Saving model ...
Epoch: 3 cost time: 4.710038661956787
Epoch: 3, Steps: 67 | Train Loss: 0.874 Vali Loss: 3.774 Vali Acc: 0.676 Test Loss: 3.774 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.617793560028076
Epoch: 4, Steps: 67 | Train Loss: 0.402 Vali Loss: 2.704 Vali Acc: 0.757 Test Loss: 2.704 Test Acc: 0.757
Validation loss decreased (-0.722518 --> -0.757198).  Saving model ...
Epoch: 5 cost time: 4.646347761154175
Epoch: 5, Steps: 67 | Train Loss: 0.225 Vali Loss: 2.280 Vali Acc: 0.798 Test Loss: 2.280 Test Acc: 0.798
Validation loss decreased (-0.757198 --> -0.797665).  Saving model ...
Epoch: 6 cost time: 4.559226036071777
Epoch: 6, Steps: 67 | Train Loss: 0.642 Vali Loss: 3.331 Vali Acc: 0.740 Test Loss: 3.331 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.626829147338867
Epoch: 7, Steps: 67 | Train Loss: 0.170 Vali Loss: 3.957 Vali Acc: 0.746 Test Loss: 3.957 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.705289602279663
Epoch: 8, Steps: 67 | Train Loss: 0.001 Vali Loss: 3.339 Vali Acc: 0.792 Test Loss: 3.339 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.641007900238037
Epoch: 9, Steps: 67 | Train Loss: 0.002 Vali Loss: 1.745 Vali Acc: 0.838 Test Loss: 1.745 Test Acc: 0.838
Validation loss decreased (-0.797665 --> -0.838133).  Saving model ...
Epoch: 10 cost time: 4.7379679679870605
Epoch: 10, Steps: 67 | Train Loss: 0.178 Vali Loss: 1.542 Vali Acc: 0.815 Test Loss: 1.542 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.702159404754639
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.792 Test Loss: 1.587 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.746609449386597
Epoch: 12, Steps: 67 | Train Loss: 0.018 Vali Loss: 3.729 Vali Acc: 0.694 Test Loss: 3.729 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.5928802490234375
Epoch: 13, Steps: 67 | Train Loss: 0.046 Vali Loss: 2.763 Vali Acc: 0.809 Test Loss: 2.763 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.674651384353638
Epoch: 14, Steps: 67 | Train Loss: 0.049 Vali Loss: 5.382 Vali Acc: 0.746 Test Loss: 5.382 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.710738658905029
Epoch: 15, Steps: 67 | Train Loss: 0.259 Vali Loss: 2.530 Vali Acc: 0.775 Test Loss: 2.530 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.910121202468872
Epoch: 16, Steps: 67 | Train Loss: 0.045 Vali Loss: 2.186 Vali Acc: 0.798 Test Loss: 2.186 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.697695016860962
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.409 Vali Acc: 0.786 Test Loss: 2.409 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.669787645339966
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.393 Vali Acc: 0.786 Test Loss: 2.393 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.67786717414856
Epoch: 19, Steps: 67 | Train Loss: 0.034 Vali Loss: 3.620 Vali Acc: 0.792 Test Loss: 3.620 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1970535
model size : 7.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.094639539718628
Epoch: 1, Steps: 67 | Train Loss: 2.759 Vali Loss: 4.861 Vali Acc: 0.405 Test Loss: 4.861 Test Acc: 0.405
Validation loss decreased (inf --> -0.404576).  Saving model ...
Epoch: 2 cost time: 3.536081075668335
Epoch: 2, Steps: 67 | Train Loss: 1.391 Vali Loss: 1.667 Vali Acc: 0.647 Test Loss: 1.667 Test Acc: 0.647
Validation loss decreased (-0.404576 --> -0.647382).  Saving model ...
Epoch: 3 cost time: 3.569631338119507
Epoch: 3, Steps: 67 | Train Loss: 0.683 Vali Loss: 3.212 Vali Acc: 0.653 Test Loss: 3.212 Test Acc: 0.653
Validation loss decreased (-0.647382 --> -0.653147).  Saving model ...
Epoch: 4 cost time: 3.589444637298584
Epoch: 4, Steps: 67 | Train Loss: 0.353 Vali Loss: 1.313 Vali Acc: 0.757 Test Loss: 1.313 Test Acc: 0.757
Validation loss decreased (-0.653147 --> -0.757212).  Saving model ...
Epoch: 5 cost time: 3.483834743499756
Epoch: 5, Steps: 67 | Train Loss: 0.181 Vali Loss: 1.083 Vali Acc: 0.769 Test Loss: 1.083 Test Acc: 0.769
Validation loss decreased (-0.757212 --> -0.768775).  Saving model ...
Epoch: 6 cost time: 3.5514657497406006
Epoch: 6, Steps: 67 | Train Loss: 0.015 Vali Loss: 2.207 Vali Acc: 0.746 Test Loss: 2.207 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.516268014907837
Epoch: 7, Steps: 67 | Train Loss: 0.010 Vali Loss: 1.793 Vali Acc: 0.780 Test Loss: 1.793 Test Acc: 0.780
Validation loss decreased (-0.768775 --> -0.780329).  Saving model ...
Epoch: 8 cost time: 3.5263710021972656
Epoch: 8, Steps: 67 | Train Loss: 0.039 Vali Loss: 3.100 Vali Acc: 0.769 Test Loss: 3.100 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5146968364715576
Epoch: 9, Steps: 67 | Train Loss: 0.114 Vali Loss: 3.242 Vali Acc: 0.705 Test Loss: 3.242 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.55584979057312
Epoch: 10, Steps: 67 | Train Loss: 0.033 Vali Loss: 2.544 Vali Acc: 0.653 Test Loss: 2.544 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.493608236312866
Epoch: 11, Steps: 67 | Train Loss: 0.047 Vali Loss: 3.914 Vali Acc: 0.728 Test Loss: 3.914 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.4879419803619385
Epoch: 12, Steps: 67 | Train Loss: 0.029 Vali Loss: 2.409 Vali Acc: 0.717 Test Loss: 2.409 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4589951038360596
Epoch: 13, Steps: 67 | Train Loss: 0.021 Vali Loss: 1.952 Vali Acc: 0.751 Test Loss: 1.952 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.543621063232422
Epoch: 14, Steps: 67 | Train Loss: 0.011 Vali Loss: 2.756 Vali Acc: 0.676 Test Loss: 2.756 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.625894546508789
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.688 Test Loss: 2.182 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.5373880863189697
Epoch: 16, Steps: 67 | Train Loss: 0.024 Vali Loss: 2.600 Vali Acc: 0.769 Test Loss: 2.600 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7433903217315674
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.859 Vali Acc: 0.786 Test Loss: 2.859 Test Acc: 0.786
Validation loss decreased (-0.780329 --> -0.786099).  Saving model ...
Epoch: 18 cost time: 3.6692121028900146
Epoch: 18, Steps: 67 | Train Loss: 0.045 Vali Loss: 2.870 Vali Acc: 0.780 Test Loss: 2.870 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6135060787200928
Epoch: 19, Steps: 67 | Train Loss: 0.051 Vali Loss: 2.772 Vali Acc: 0.792 Test Loss: 2.772 Test Acc: 0.792
Validation loss decreased (-0.786099 --> -0.791880).  Saving model ...
Epoch: 20 cost time: 3.6570351123809814
Epoch: 20, Steps: 67 | Train Loss: 0.047 Vali Loss: 2.885 Vali Acc: 0.855 Test Loss: 2.885 Test Acc: 0.855
Validation loss decreased (-0.791880 --> -0.855462).  Saving model ...
Epoch: 21 cost time: 3.6734707355499268
Epoch: 21, Steps: 67 | Train Loss: 0.084 Vali Loss: 3.743 Vali Acc: 0.792 Test Loss: 3.743 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5400779247283936
Epoch: 22, Steps: 67 | Train Loss: 0.470 Vali Loss: 5.490 Vali Acc: 0.746 Test Loss: 5.490 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6850407123565674
Epoch: 23, Steps: 67 | Train Loss: 0.159 Vali Loss: 6.832 Vali Acc: 0.705 Test Loss: 6.832 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6202402114868164
Epoch: 24, Steps: 67 | Train Loss: 0.163 Vali Loss: 5.033 Vali Acc: 0.803 Test Loss: 5.033 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.53731107711792
Epoch: 25, Steps: 67 | Train Loss: 0.056 Vali Loss: 19.104 Vali Acc: 0.642 Test Loss: 19.104 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.6254115104675293
Epoch: 26, Steps: 67 | Train Loss: 0.317 Vali Loss: 4.375 Vali Acc: 0.792 Test Loss: 4.375 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.588129758834839
Epoch: 27, Steps: 67 | Train Loss: 0.076 Vali Loss: 3.829 Vali Acc: 0.763 Test Loss: 3.829 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5927953720092773
Epoch: 28, Steps: 67 | Train Loss: 0.155 Vali Loss: 4.785 Vali Acc: 0.815 Test Loss: 4.785 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.540828227996826
Epoch: 29, Steps: 67 | Train Loss: 0.053 Vali Loss: 3.238 Vali Acc: 0.803 Test Loss: 3.238 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.58840274810791
Epoch: 30, Steps: 67 | Train Loss: 0.062 Vali Loss: 4.230 Vali Acc: 0.809 Test Loss: 4.230 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1431367
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.165855407714844
Epoch: 1, Steps: 67 | Train Loss: 2.347 Vali Loss: 1.538 Vali Acc: 0.624 Test Loss: 1.538 Test Acc: 0.624
Validation loss decreased (inf --> -0.624262).  Saving model ...
Epoch: 2 cost time: 3.0385398864746094
Epoch: 2, Steps: 67 | Train Loss: 1.342 Vali Loss: 2.108 Vali Acc: 0.624 Test Loss: 2.108 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.985361099243164
Epoch: 3, Steps: 67 | Train Loss: 0.436 Vali Loss: 3.225 Vali Acc: 0.630 Test Loss: 3.225 Test Acc: 0.630
Validation loss decreased (-0.624262 --> -0.630026).  Saving model ...
Epoch: 4 cost time: 2.9590911865234375
Epoch: 4, Steps: 67 | Train Loss: 0.624 Vali Loss: 1.025 Vali Acc: 0.838 Test Loss: 1.025 Test Acc: 0.838
Validation loss decreased (-0.630026 --> -0.838140).  Saving model ...
Epoch: 5 cost time: 2.9888103008270264
Epoch: 5, Steps: 67 | Train Loss: 0.094 Vali Loss: 0.822 Vali Acc: 0.838 Test Loss: 0.822 Test Acc: 0.838
Validation loss decreased (-0.838140 --> -0.838142).  Saving model ...
Epoch: 6 cost time: 2.9617416858673096
Epoch: 6, Steps: 67 | Train Loss: 0.043 Vali Loss: 2.004 Vali Acc: 0.763 Test Loss: 2.004 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.014763832092285
Epoch: 7, Steps: 67 | Train Loss: 0.024 Vali Loss: 0.894 Vali Acc: 0.850 Test Loss: 0.894 Test Acc: 0.850
Validation loss decreased (-0.838142 --> -0.849702).  Saving model ...
Epoch: 8 cost time: 2.978621006011963
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.815 Test Loss: 1.428 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.987351894378662
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.775 Test Loss: 1.717 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.987114191055298
Epoch: 10, Steps: 67 | Train Loss: 0.005 Vali Loss: 1.247 Vali Acc: 0.786 Test Loss: 1.247 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.013545513153076
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.511 Vali Acc: 0.751 Test Loss: 1.511 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1685218811035156
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.792 Test Loss: 1.184 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.015092372894287
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.809 Test Loss: 1.092 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.047506093978882
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.821 Test Loss: 1.077 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0162832736968994
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.821 Test Loss: 1.082 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0012502670288086
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.821 Test Loss: 1.082 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.0209853649139404
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.088 Vali Acc: 0.809 Test Loss: 1.088 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1000055
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.156743049621582
Epoch: 1, Steps: 67 | Train Loss: 2.100 Vali Loss: 2.610 Vali Acc: 0.601 Test Loss: 2.610 Test Acc: 0.601
Validation loss decreased (inf --> -0.601130).  Saving model ...
Epoch: 2 cost time: 2.6543545722961426
Epoch: 2, Steps: 67 | Train Loss: 1.691 Vali Loss: 6.265 Vali Acc: 0.439 Test Loss: 6.265 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.564216136932373
Epoch: 3, Steps: 67 | Train Loss: 1.089 Vali Loss: 2.656 Vali Acc: 0.717 Test Loss: 2.656 Test Acc: 0.717
Validation loss decreased (-0.601130 --> -0.716736).  Saving model ...
Epoch: 4 cost time: 2.614118814468384
Epoch: 4, Steps: 67 | Train Loss: 0.199 Vali Loss: 0.982 Vali Acc: 0.815 Test Loss: 0.982 Test Acc: 0.815
Validation loss decreased (-0.716736 --> -0.815019).  Saving model ...
Epoch: 5 cost time: 2.7063307762145996
Epoch: 5, Steps: 67 | Train Loss: 0.031 Vali Loss: 1.162 Vali Acc: 0.821 Test Loss: 1.162 Test Acc: 0.821
Validation loss decreased (-0.815019 --> -0.820798).  Saving model ...
Epoch: 6 cost time: 2.595259428024292
Epoch: 6, Steps: 67 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
Validation loss decreased (-0.820798 --> -0.849704).  Saving model ...
Epoch: 7 cost time: 2.5869100093841553
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.792 Test Loss: 1.894 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6204957962036133
Epoch: 8, Steps: 67 | Train Loss: 0.072 Vali Loss: 1.543 Vali Acc: 0.786 Test Loss: 1.543 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5743863582611084
Epoch: 9, Steps: 67 | Train Loss: 0.173 Vali Loss: 1.558 Vali Acc: 0.751 Test Loss: 1.558 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.743110418319702
Epoch: 10, Steps: 67 | Train Loss: 0.024 Vali Loss: 3.693 Vali Acc: 0.595 Test Loss: 3.693 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7009377479553223
Epoch: 11, Steps: 67 | Train Loss: 0.227 Vali Loss: 3.420 Vali Acc: 0.734 Test Loss: 3.420 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.718306303024292
Epoch: 12, Steps: 67 | Train Loss: 0.043 Vali Loss: 1.268 Vali Acc: 0.855 Test Loss: 1.268 Test Acc: 0.855
Validation loss decreased (-0.849704 --> -0.855479).  Saving model ...
Epoch: 13 cost time: 2.710723876953125
Epoch: 13, Steps: 67 | Train Loss: 0.018 Vali Loss: 2.423 Vali Acc: 0.792 Test Loss: 2.423 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7708489894866943
Epoch: 14, Steps: 67 | Train Loss: 0.030 Vali Loss: 5.590 Vali Acc: 0.618 Test Loss: 5.590 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.629138708114624
Epoch: 15, Steps: 67 | Train Loss: 0.195 Vali Loss: 3.826 Vali Acc: 0.590 Test Loss: 3.826 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6200647354125977
Epoch: 16, Steps: 67 | Train Loss: 0.139 Vali Loss: 1.787 Vali Acc: 0.838 Test Loss: 1.787 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.808750629425049
Epoch: 17, Steps: 67 | Train Loss: 0.032 Vali Loss: 6.407 Vali Acc: 0.676 Test Loss: 6.407 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.840120315551758
Epoch: 18, Steps: 67 | Train Loss: 0.152 Vali Loss: 1.870 Vali Acc: 0.815 Test Loss: 1.870 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.743321180343628
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.815 Test Loss: 1.835 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7234933376312256
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.815 Test Loss: 1.816 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7949140071868896
Epoch: 21, Steps: 67 | Train Loss: 0.368 Vali Loss: 2.938 Vali Acc: 0.792 Test Loss: 2.938 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6590921878814697
Epoch: 22, Steps: 67 | Train Loss: 0.476 Vali Loss: 6.459 Vali Acc: 0.636 Test Loss: 6.459 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 892311
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 25.1611023
	speed: 0.1286s/iter; left time: 1710.8600s
Epoch: 1 cost time: 16.79505181312561
Epoch: 1, Steps: 134 | Train Loss: 42.262 Vali Loss: 47.139 Vali Acc: 0.509 Test Loss: 47.139 Test Acc: 0.509
Validation loss decreased (inf --> -0.508199).  Saving model ...
	iters: 100, epoch: 2 | loss: 11.6628895
	speed: 0.2373s/iter; left time: 3124.5220s
Epoch: 2 cost time: 15.594748973846436
Epoch: 2, Steps: 134 | Train Loss: 24.949 Vali Loss: 2.200 Vali Acc: 0.769 Test Loss: 2.200 Test Acc: 0.769
Validation loss decreased (-0.508199 --> -0.768764).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001144
	speed: 0.2471s/iter; left time: 3220.8233s
Epoch: 3 cost time: 16.187774181365967
Epoch: 3, Steps: 134 | Train Loss: 1.302 Vali Loss: 3.649 Vali Acc: 0.723 Test Loss: 3.649 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2450s/iter; left time: 3160.6198s
Epoch: 4 cost time: 16.058555841445923
Epoch: 4, Steps: 134 | Train Loss: 0.377 Vali Loss: 2.114 Vali Acc: 0.780 Test Loss: 2.114 Test Acc: 0.780
Validation loss decreased (-0.768764 --> -0.780326).  Saving model ...
	iters: 100, epoch: 5 | loss: 9.2617235
	speed: 0.2477s/iter; left time: 3161.8817s
Epoch: 5 cost time: 16.068464040756226
Epoch: 5, Steps: 134 | Train Loss: 0.799 Vali Loss: 5.603 Vali Acc: 0.659 Test Loss: 5.603 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2461s/iter; left time: 3108.4364s
Epoch: 6 cost time: 16.042919158935547
Epoch: 6, Steps: 134 | Train Loss: 0.749 Vali Loss: 5.798 Vali Acc: 0.723 Test Loss: 5.798 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2448s/iter; left time: 3058.8929s
Epoch: 7 cost time: 16.16041588783264
Epoch: 7, Steps: 134 | Train Loss: 1.152 Vali Loss: 4.628 Vali Acc: 0.803 Test Loss: 4.628 Test Acc: 0.803
Validation loss decreased (-0.780326 --> -0.803422).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.2463s/iter; left time: 3044.5026s
Epoch: 8 cost time: 15.840041875839233
Epoch: 8, Steps: 134 | Train Loss: 0.270 Vali Loss: 5.761 Vali Acc: 0.780 Test Loss: 5.761 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2432s/iter; left time: 2973.6053s
Epoch: 9 cost time: 16.129966974258423
Epoch: 9, Steps: 134 | Train Loss: 0.232 Vali Loss: 9.992 Vali Acc: 0.728 Test Loss: 9.992 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2448s/iter; left time: 2960.2890s
Epoch: 10 cost time: 16.006129503250122
Epoch: 10, Steps: 134 | Train Loss: 1.058 Vali Loss: 5.617 Vali Acc: 0.780 Test Loss: 5.617 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2425s/iter; left time: 2900.5870s
Epoch: 11 cost time: 15.837709665298462
Epoch: 11, Steps: 134 | Train Loss: 1.483 Vali Loss: 17.156 Vali Acc: 0.734 Test Loss: 17.156 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2467s/iter; left time: 2918.1292s
Epoch: 12 cost time: 16.15087652206421
Epoch: 12, Steps: 134 | Train Loss: 0.485 Vali Loss: 5.164 Vali Acc: 0.832 Test Loss: 5.164 Test Acc: 0.832
Validation loss decreased (-0.803422 --> -0.832318).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2485s/iter; left time: 2906.2011s
Epoch: 13 cost time: 15.884862184524536
Epoch: 13, Steps: 134 | Train Loss: 0.634 Vali Loss: 4.205 Vali Acc: 0.832 Test Loss: 4.205 Test Acc: 0.832
Validation loss decreased (-0.832318 --> -0.832328).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2523s/iter; left time: 2916.8226s
Epoch: 14 cost time: 16.130556344985962
Epoch: 14, Steps: 134 | Train Loss: 0.131 Vali Loss: 4.095 Vali Acc: 0.838 Test Loss: 4.095 Test Acc: 0.838
Validation loss decreased (-0.832328 --> -0.838109).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2536s/iter; left time: 2896.9166s
Epoch: 15 cost time: 16.0587899684906
Epoch: 15, Steps: 134 | Train Loss: 0.125 Vali Loss: 10.854 Vali Acc: 0.798 Test Loss: 10.854 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2466s/iter; left time: 2784.7882s
Epoch: 16 cost time: 15.993831157684326
Epoch: 16, Steps: 134 | Train Loss: 0.583 Vali Loss: 4.735 Vali Acc: 0.850 Test Loss: 4.735 Test Acc: 0.850
Validation loss decreased (-0.838109 --> -0.849664).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2545s/iter; left time: 2839.7340s
Epoch: 17 cost time: 16.279626607894897
Epoch: 17, Steps: 134 | Train Loss: 0.313 Vali Loss: 8.187 Vali Acc: 0.832 Test Loss: 8.187 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2477s/iter; left time: 2730.5894s
Epoch: 18 cost time: 16.08596134185791
Epoch: 18, Steps: 134 | Train Loss: 0.673 Vali Loss: 8.255 Vali Acc: 0.809 Test Loss: 8.255 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 104.0793915
	speed: 0.2459s/iter; left time: 2677.6350s
Epoch: 19 cost time: 16.089768886566162
Epoch: 19, Steps: 134 | Train Loss: 1.493 Vali Loss: 22.027 Vali Acc: 0.636 Test Loss: 22.027 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2491s/iter; left time: 2679.4679s
Epoch: 20 cost time: 16.159517765045166
Epoch: 20, Steps: 134 | Train Loss: 0.159 Vali Loss: 16.783 Vali Acc: 0.728 Test Loss: 16.783 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2482s/iter; left time: 2636.2874s
Epoch: 21 cost time: 16.150087356567383
Epoch: 21, Steps: 134 | Train Loss: 0.513 Vali Loss: 14.441 Vali Acc: 0.798 Test Loss: 14.441 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2436s/iter; left time: 2554.1456s
Epoch: 22 cost time: 15.92647099494934
Epoch: 22, Steps: 134 | Train Loss: 0.000 Vali Loss: 15.771 Vali Acc: 0.780 Test Loss: 15.771 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.2481s/iter; left time: 2568.7216s
Epoch: 23 cost time: 16.049666166305542
Epoch: 23, Steps: 134 | Train Loss: 0.605 Vali Loss: 11.577 Vali Acc: 0.798 Test Loss: 11.577 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.2484s/iter; left time: 2538.0666s
Epoch: 24 cost time: 16.12971520423889
Epoch: 24, Steps: 134 | Train Loss: 0.103 Vali Loss: 21.093 Vali Acc: 0.717 Test Loss: 21.093 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.2510s/iter; left time: 2531.2494s
Epoch: 25 cost time: 16.200276374816895
Epoch: 25, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.060 Vali Acc: 0.717 Test Loss: 21.060 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2460s/iter; left time: 2448.2631s
Epoch: 26 cost time: 16.113933563232422
Epoch: 26, Steps: 134 | Train Loss: 0.000 Vali Loss: 17.077 Vali Acc: 0.757 Test Loss: 17.077 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 7781911
model size : 30.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.575490236282349
Epoch: 1, Steps: 67 | Train Loss: 7.101 Vali Loss: 8.219 Vali Acc: 0.584 Test Loss: 8.219 Test Acc: 0.584
Validation loss decreased (inf --> -0.583733).  Saving model ...
Epoch: 2 cost time: 7.341649293899536
Epoch: 2, Steps: 67 | Train Loss: 8.794 Vali Loss: 11.111 Vali Acc: 0.549 Test Loss: 11.111 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.446573495864868
Epoch: 3, Steps: 67 | Train Loss: 7.059 Vali Loss: 4.988 Vali Acc: 0.653 Test Loss: 4.988 Test Acc: 0.653
Validation loss decreased (-0.583733 --> -0.653129).  Saving model ...
Epoch: 4 cost time: 7.404488801956177
Epoch: 4, Steps: 67 | Train Loss: 0.625 Vali Loss: 1.479 Vali Acc: 0.821 Test Loss: 1.479 Test Acc: 0.821
Validation loss decreased (-0.653129 --> -0.820794).  Saving model ...
Epoch: 5 cost time: 7.679499626159668
Epoch: 5, Steps: 67 | Train Loss: 0.208 Vali Loss: 3.006 Vali Acc: 0.815 Test Loss: 3.006 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.399528980255127
Epoch: 6, Steps: 67 | Train Loss: 0.081 Vali Loss: 2.197 Vali Acc: 0.827 Test Loss: 2.197 Test Acc: 0.827
Validation loss decreased (-0.820794 --> -0.826568).  Saving model ...
Epoch: 7 cost time: 7.776394605636597
Epoch: 7, Steps: 67 | Train Loss: 0.034 Vali Loss: 1.697 Vali Acc: 0.809 Test Loss: 1.697 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.5643227100372314
Epoch: 8, Steps: 67 | Train Loss: 0.017 Vali Loss: 1.846 Vali Acc: 0.798 Test Loss: 1.846 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.604626655578613
Epoch: 9, Steps: 67 | Train Loss: 0.081 Vali Loss: 2.695 Vali Acc: 0.786 Test Loss: 2.695 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.569955587387085
Epoch: 10, Steps: 67 | Train Loss: 0.094 Vali Loss: 4.583 Vali Acc: 0.780 Test Loss: 4.583 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.539240837097168
Epoch: 11, Steps: 67 | Train Loss: 0.038 Vali Loss: 3.168 Vali Acc: 0.775 Test Loss: 3.168 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.382920026779175
Epoch: 12, Steps: 67 | Train Loss: 0.019 Vali Loss: 1.831 Vali Acc: 0.809 Test Loss: 1.831 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.384718656539917
Epoch: 13, Steps: 67 | Train Loss: 0.043 Vali Loss: 1.760 Vali Acc: 0.792 Test Loss: 1.760 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.361887216567993
Epoch: 14, Steps: 67 | Train Loss: 0.041 Vali Loss: 5.433 Vali Acc: 0.751 Test Loss: 5.433 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.572362661361694
Epoch: 15, Steps: 67 | Train Loss: 0.325 Vali Loss: 2.577 Vali Acc: 0.786 Test Loss: 2.577 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.419111251831055
Epoch: 16, Steps: 67 | Train Loss: 0.311 Vali Loss: 4.093 Vali Acc: 0.780 Test Loss: 4.093 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3899159
model size : 15.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.689999341964722
Epoch: 1, Steps: 67 | Train Loss: 5.563 Vali Loss: 4.474 Vali Acc: 0.538 Test Loss: 4.474 Test Acc: 0.538
Validation loss decreased (inf --> -0.537528).  Saving model ...
Epoch: 2 cost time: 4.64133358001709
Epoch: 2, Steps: 67 | Train Loss: 7.756 Vali Loss: 3.624 Vali Acc: 0.538 Test Loss: 3.624 Test Acc: 0.538
Validation loss decreased (-0.537528 --> -0.537536).  Saving model ...
Epoch: 3 cost time: 4.579827308654785
Epoch: 3, Steps: 67 | Train Loss: 1.754 Vali Loss: 5.641 Vali Acc: 0.665 Test Loss: 5.641 Test Acc: 0.665
Validation loss decreased (-0.537536 --> -0.664683).  Saving model ...
Epoch: 4 cost time: 4.536494970321655
Epoch: 4, Steps: 67 | Train Loss: 1.926 Vali Loss: 2.897 Vali Acc: 0.728 Test Loss: 2.897 Test Acc: 0.728
Validation loss decreased (-0.664683 --> -0.728295).  Saving model ...
Epoch: 5 cost time: 4.539731502532959
Epoch: 5, Steps: 67 | Train Loss: 0.080 Vali Loss: 1.010 Vali Acc: 0.769 Test Loss: 1.010 Test Acc: 0.769
Validation loss decreased (-0.728295 --> -0.768776).  Saving model ...
Epoch: 6 cost time: 4.511051416397095
Epoch: 6, Steps: 67 | Train Loss: 0.153 Vali Loss: 1.901 Vali Acc: 0.792 Test Loss: 1.901 Test Acc: 0.792
Validation loss decreased (-0.768776 --> -0.791888).  Saving model ...
Epoch: 7 cost time: 4.58825421333313
Epoch: 7, Steps: 67 | Train Loss: 0.128 Vali Loss: 5.554 Vali Acc: 0.630 Test Loss: 5.554 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.584109783172607
Epoch: 8, Steps: 67 | Train Loss: 0.154 Vali Loss: 5.940 Vali Acc: 0.705 Test Loss: 5.940 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.633152723312378
Epoch: 9, Steps: 67 | Train Loss: 0.048 Vali Loss: 2.117 Vali Acc: 0.803 Test Loss: 2.117 Test Acc: 0.803
Validation loss decreased (-0.791888 --> -0.803447).  Saving model ...
Epoch: 10 cost time: 4.714480876922607
Epoch: 10, Steps: 67 | Train Loss: 0.024 Vali Loss: 5.622 Vali Acc: 0.728 Test Loss: 5.622 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.64384126663208
Epoch: 11, Steps: 67 | Train Loss: 0.038 Vali Loss: 3.931 Vali Acc: 0.775 Test Loss: 3.931 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.679391622543335
Epoch: 12, Steps: 67 | Train Loss: 0.007 Vali Loss: 2.611 Vali Acc: 0.780 Test Loss: 2.611 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.748163461685181
Epoch: 13, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.045 Vali Acc: 0.850 Test Loss: 2.045 Test Acc: 0.850
Validation loss decreased (-0.803447 --> -0.849691).  Saving model ...
Epoch: 14 cost time: 4.797369003295898
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.404 Vali Acc: 0.763 Test Loss: 5.404 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.663370609283447
Epoch: 15, Steps: 67 | Train Loss: 0.471 Vali Loss: 4.938 Vali Acc: 0.653 Test Loss: 4.938 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.7948362827301025
Epoch: 16, Steps: 67 | Train Loss: 0.024 Vali Loss: 2.964 Vali Acc: 0.809 Test Loss: 2.964 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.7778637409210205
Epoch: 17, Steps: 67 | Train Loss: 0.022 Vali Loss: 2.214 Vali Acc: 0.809 Test Loss: 2.214 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.787086486816406
Epoch: 18, Steps: 67 | Train Loss: 0.074 Vali Loss: 3.605 Vali Acc: 0.757 Test Loss: 3.605 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.7942795753479
Epoch: 19, Steps: 67 | Train Loss: 0.054 Vali Loss: 2.872 Vali Acc: 0.844 Test Loss: 2.872 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.82029128074646
Epoch: 20, Steps: 67 | Train Loss: 0.123 Vali Loss: 2.199 Vali Acc: 0.827 Test Loss: 2.199 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.8006062507629395
Epoch: 21, Steps: 67 | Train Loss: 0.010 Vali Loss: 2.633 Vali Acc: 0.832 Test Loss: 2.633 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.74479341506958
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.756 Vali Acc: 0.821 Test Loss: 2.756 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.734389781951904
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.585 Vali Acc: 0.809 Test Loss: 2.585 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2604935
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.469118595123291
Epoch: 1, Steps: 67 | Train Loss: 4.188 Vali Loss: 6.280 Vali Acc: 0.566 Test Loss: 6.280 Test Acc: 0.566
Validation loss decreased (inf --> -0.566411).  Saving model ...
Epoch: 2 cost time: 4.177501440048218
Epoch: 2, Steps: 67 | Train Loss: 3.470 Vali Loss: 2.619 Vali Acc: 0.717 Test Loss: 2.619 Test Acc: 0.717
Validation loss decreased (-0.566411 --> -0.716737).  Saving model ...
Epoch: 3 cost time: 4.101508140563965
Epoch: 3, Steps: 67 | Train Loss: 2.429 Vali Loss: 6.907 Vali Acc: 0.526 Test Loss: 6.907 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.105736494064331
Epoch: 4, Steps: 67 | Train Loss: 2.364 Vali Loss: 6.438 Vali Acc: 0.740 Test Loss: 6.438 Test Acc: 0.740
Validation loss decreased (-0.716737 --> -0.739820).  Saving model ...
Epoch: 5 cost time: 4.123151063919067
Epoch: 5, Steps: 67 | Train Loss: 0.538 Vali Loss: 2.922 Vali Acc: 0.792 Test Loss: 2.922 Test Acc: 0.792
Validation loss decreased (-0.739820 --> -0.791878).  Saving model ...
Epoch: 6 cost time: 4.132184028625488
Epoch: 6, Steps: 67 | Train Loss: 0.329 Vali Loss: 4.860 Vali Acc: 0.775 Test Loss: 4.860 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.111302852630615
Epoch: 7, Steps: 67 | Train Loss: 0.392 Vali Loss: 4.566 Vali Acc: 0.751 Test Loss: 4.566 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.037587404251099
Epoch: 8, Steps: 67 | Train Loss: 0.223 Vali Loss: 3.404 Vali Acc: 0.798 Test Loss: 3.404 Test Acc: 0.798
Validation loss decreased (-0.791878 --> -0.797654).  Saving model ...
Epoch: 9 cost time: 4.081693410873413
Epoch: 9, Steps: 67 | Train Loss: 0.042 Vali Loss: 3.704 Vali Acc: 0.786 Test Loss: 3.704 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.039058685302734
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.821 Test Loss: 1.884 Test Acc: 0.821
Validation loss decreased (-0.797654 --> -0.820790).  Saving model ...
Epoch: 11 cost time: 4.0588202476501465
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.893 Vali Acc: 0.821 Test Loss: 1.893 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.046989440917969
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.815 Test Loss: 1.886 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.028552055358887
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.443 Vali Acc: 0.821 Test Loss: 3.443 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.256818771362305
Epoch: 14, Steps: 67 | Train Loss: 0.192 Vali Loss: 4.965 Vali Acc: 0.786 Test Loss: 4.965 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.18328070640564
Epoch: 15, Steps: 67 | Train Loss: 0.014 Vali Loss: 4.996 Vali Acc: 0.746 Test Loss: 4.996 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.101537466049194
Epoch: 16, Steps: 67 | Train Loss: 0.251 Vali Loss: 2.238 Vali Acc: 0.740 Test Loss: 2.238 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.030160188674927
Epoch: 17, Steps: 67 | Train Loss: 0.070 Vali Loss: 5.040 Vali Acc: 0.757 Test Loss: 5.040 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.057900667190552
Epoch: 18, Steps: 67 | Train Loss: 0.186 Vali Loss: 3.009 Vali Acc: 0.775 Test Loss: 3.009 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.078834295272827
Epoch: 19, Steps: 67 | Train Loss: 0.248 Vali Loss: 6.768 Vali Acc: 0.671 Test Loss: 6.768 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.04447340965271
Epoch: 20, Steps: 67 | Train Loss: 0.525 Vali Loss: 6.257 Vali Acc: 0.803 Test Loss: 6.257 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1957863
model size : 7.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.126206159591675
Epoch: 1, Steps: 67 | Train Loss: 3.355 Vali Loss: 2.970 Vali Acc: 0.514 Test Loss: 2.970 Test Acc: 0.514
Validation loss decreased (inf --> -0.514421).  Saving model ...
Epoch: 2 cost time: 2.9905049800872803
Epoch: 2, Steps: 67 | Train Loss: 2.069 Vali Loss: 3.130 Vali Acc: 0.578 Test Loss: 3.130 Test Acc: 0.578
Validation loss decreased (-0.514421 --> -0.578003).  Saving model ...
Epoch: 3 cost time: 3.032041549682617
Epoch: 3, Steps: 67 | Train Loss: 1.376 Vali Loss: 3.161 Vali Acc: 0.618 Test Loss: 3.161 Test Acc: 0.618
Validation loss decreased (-0.578003 --> -0.618465).  Saving model ...
Epoch: 4 cost time: 3.0110952854156494
Epoch: 4, Steps: 67 | Train Loss: 0.554 Vali Loss: 2.131 Vali Acc: 0.763 Test Loss: 2.131 Test Acc: 0.763
Validation loss decreased (-0.618465 --> -0.762984).  Saving model ...
Epoch: 5 cost time: 3.057394027709961
Epoch: 5, Steps: 67 | Train Loss: 0.636 Vali Loss: 2.358 Vali Acc: 0.786 Test Loss: 2.358 Test Acc: 0.786
Validation loss decreased (-0.762984 --> -0.786104).  Saving model ...
Epoch: 6 cost time: 3.1922388076782227
Epoch: 6, Steps: 67 | Train Loss: 0.282 Vali Loss: 2.453 Vali Acc: 0.792 Test Loss: 2.453 Test Acc: 0.792
Validation loss decreased (-0.786104 --> -0.791883).  Saving model ...
Epoch: 7 cost time: 4.135620832443237
Epoch: 7, Steps: 67 | Train Loss: 0.021 Vali Loss: 2.152 Vali Acc: 0.792 Test Loss: 2.152 Test Acc: 0.792
Validation loss decreased (-0.791883 --> -0.791886).  Saving model ...
Epoch: 8 cost time: 8.401390552520752
Epoch: 8, Steps: 67 | Train Loss: 0.273 Vali Loss: 2.102 Vali Acc: 0.815 Test Loss: 2.102 Test Acc: 0.815
Validation loss decreased (-0.791886 --> -0.815008).  Saving model ...
Epoch: 9 cost time: 7.930871486663818
Epoch: 9, Steps: 67 | Train Loss: 0.078 Vali Loss: 3.482 Vali Acc: 0.809 Test Loss: 3.482 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.552901268005371
Epoch: 10, Steps: 67 | Train Loss: 0.055 Vali Loss: 1.039 Vali Acc: 0.821 Test Loss: 1.039 Test Acc: 0.821
Validation loss decreased (-0.815008 --> -0.820799).  Saving model ...
Epoch: 11 cost time: 8.313507080078125
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.815 Test Loss: 1.008 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.205832481384277
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.809 Test Loss: 1.001 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.056434869766235
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.832 Test Loss: 0.985 Test Acc: 0.832
Validation loss decreased (-0.820799 --> -0.832360).  Saving model ...
Epoch: 14 cost time: 7.459543466567993
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.993 Vali Acc: 0.827 Test Loss: 0.993 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.097604990005493
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.827 Test Loss: 0.982 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.176950454711914
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.827 Test Loss: 0.988 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.686459541320801
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.827 Test Loss: 0.986 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.05288290977478
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.827 Test Loss: 0.986 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.890507221221924
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.827 Test Loss: 0.996 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.021219730377197
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.832 Test Loss: 0.999 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.076446056365967
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.989 Vali Acc: 0.832 Test Loss: 0.989 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1712121963500977
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.832 Test Loss: 0.988 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1301145553588867
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.832 Test Loss: 0.983 Test Acc: 0.832
Validation loss decreased (-0.832360 --> -0.832360).  Saving model ...
Epoch: 24 cost time: 3.0894312858581543
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.832 Test Loss: 0.976 Test Acc: 0.832
Validation loss decreased (-0.832360 --> -0.832360).  Saving model ...
Epoch: 25 cost time: 3.1082632541656494
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.978 Vali Acc: 0.827 Test Loss: 0.978 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.168369770050049
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.827 Test Loss: 0.980 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.158346652984619
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.973 Vali Acc: 0.832 Test Loss: 0.973 Test Acc: 0.832
Validation loss decreased (-0.832360 --> -0.832360).  Saving model ...
Epoch: 28 cost time: 3.1689865589141846
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.827 Test Loss: 0.970 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2129881381988525
Epoch: 29, Steps: 67 | Train Loss: 0.100 Vali Loss: 2.224 Vali Acc: 0.803 Test Loss: 2.224 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1497743129730225
Epoch: 30, Steps: 67 | Train Loss: 0.855 Vali Loss: 4.630 Vali Acc: 0.566 Test Loss: 4.630 Test Acc: 0.566
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0654826164245605
Epoch: 31, Steps: 67 | Train Loss: 2.453 Vali Loss: 8.401 Vali Acc: 0.555 Test Loss: 8.401 Test Acc: 0.555
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.1339223384857178
Epoch: 32, Steps: 67 | Train Loss: 1.877 Vali Loss: 19.271 Vali Acc: 0.514 Test Loss: 19.271 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.1714065074920654
Epoch: 33, Steps: 67 | Train Loss: 1.424 Vali Loss: 7.852 Vali Acc: 0.688 Test Loss: 7.852 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.2112462520599365
Epoch: 34, Steps: 67 | Train Loss: 0.400 Vali Loss: 2.761 Vali Acc: 0.809 Test Loss: 2.761 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.1417996883392334
Epoch: 35, Steps: 67 | Train Loss: 0.053 Vali Loss: 7.109 Vali Acc: 0.734 Test Loss: 7.109 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.116957664489746
Epoch: 36, Steps: 67 | Train Loss: 0.004 Vali Loss: 11.967 Vali Acc: 0.751 Test Loss: 11.967 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.1310503482818604
Epoch: 37, Steps: 67 | Train Loss: 0.007 Vali Loss: 3.958 Vali Acc: 0.844 Test Loss: 3.958 Test Acc: 0.844
Validation loss decreased (-0.832360 --> -0.843891).  Saving model ...
Epoch: 38 cost time: 3.109008312225342
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.965 Vali Acc: 0.844 Test Loss: 3.965 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.1061253547668457
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.951 Vali Acc: 0.844 Test Loss: 3.951 Test Acc: 0.844
Validation loss decreased (-0.843891 --> -0.843891).  Saving model ...
Epoch: 40 cost time: 3.174283266067505
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.963 Vali Acc: 0.844 Test Loss: 3.963 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.156468152999878
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.960 Vali Acc: 0.844 Test Loss: 3.960 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.166259288787842
Epoch: 42, Steps: 67 | Train Loss: 0.091 Vali Loss: 6.996 Vali Acc: 0.734 Test Loss: 6.996 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.156583786010742
Epoch: 43, Steps: 67 | Train Loss: 0.442 Vali Loss: 4.566 Vali Acc: 0.769 Test Loss: 4.566 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.1364409923553467
Epoch: 44, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.209 Vali Acc: 0.815 Test Loss: 4.209 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.1837010383605957
Epoch: 45, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.290 Vali Acc: 0.803 Test Loss: 4.290 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.1251039505004883
Epoch: 46, Steps: 67 | Train Loss: 0.350 Vali Loss: 15.463 Vali Acc: 0.653 Test Loss: 15.463 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.1360702514648438
Epoch: 47, Steps: 67 | Train Loss: 0.017 Vali Loss: 8.605 Vali Acc: 0.688 Test Loss: 8.605 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.22076416015625
Epoch: 48, Steps: 67 | Train Loss: 0.287 Vali Loss: 7.882 Vali Acc: 0.780 Test Loss: 7.882 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.107917308807373
Epoch: 49, Steps: 67 | Train Loss: 0.128 Vali Loss: 9.323 Vali Acc: 0.751 Test Loss: 9.323 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1418695
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7394583225250244
Epoch: 1, Steps: 67 | Train Loss: 3.026 Vali Loss: 2.240 Vali Acc: 0.497 Test Loss: 2.240 Test Acc: 0.497
Validation loss decreased (inf --> -0.497087).  Saving model ...
Epoch: 2 cost time: 2.66780686378479
Epoch: 2, Steps: 67 | Train Loss: 1.713 Vali Loss: 2.033 Vali Acc: 0.653 Test Loss: 2.033 Test Acc: 0.653
Validation loss decreased (-0.497087 --> -0.653159).  Saving model ...
Epoch: 3 cost time: 2.6340737342834473
Epoch: 3, Steps: 67 | Train Loss: 0.636 Vali Loss: 1.008 Vali Acc: 0.792 Test Loss: 1.008 Test Acc: 0.792
Validation loss decreased (-0.653159 --> -0.791897).  Saving model ...
Epoch: 4 cost time: 2.5831105709075928
Epoch: 4, Steps: 67 | Train Loss: 0.518 Vali Loss: 0.681 Vali Acc: 0.838 Test Loss: 0.681 Test Acc: 0.838
Validation loss decreased (-0.791897 --> -0.838143).  Saving model ...
Epoch: 5 cost time: 2.574415445327759
Epoch: 5, Steps: 67 | Train Loss: 0.321 Vali Loss: 1.995 Vali Acc: 0.769 Test Loss: 1.995 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5654847621917725
Epoch: 6, Steps: 67 | Train Loss: 0.081 Vali Loss: 1.949 Vali Acc: 0.769 Test Loss: 1.949 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.589247226715088
Epoch: 7, Steps: 67 | Train Loss: 0.209 Vali Loss: 2.859 Vali Acc: 0.746 Test Loss: 2.859 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7021892070770264
Epoch: 8, Steps: 67 | Train Loss: 0.037 Vali Loss: 2.323 Vali Acc: 0.734 Test Loss: 2.323 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.622849702835083
Epoch: 9, Steps: 67 | Train Loss: 0.118 Vali Loss: 2.278 Vali Acc: 0.723 Test Loss: 2.278 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5398857593536377
Epoch: 10, Steps: 67 | Train Loss: 0.119 Vali Loss: 3.349 Vali Acc: 0.763 Test Loss: 3.349 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6517560482025146
Epoch: 11, Steps: 67 | Train Loss: 0.008 Vali Loss: 1.554 Vali Acc: 0.786 Test Loss: 1.554 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6390841007232666
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 1.292 Vali Acc: 0.757 Test Loss: 1.292 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6474084854125977
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.127 Vali Acc: 0.792 Test Loss: 1.127 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6338698863983154
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.786 Test Loss: 1.900 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 987383
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3415918350219727
Epoch: 1, Steps: 67 | Train Loss: 2.545 Vali Loss: 0.993 Vali Acc: 0.647 Test Loss: 0.993 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 2.2204055786132812
Epoch: 2, Steps: 67 | Train Loss: 2.021 Vali Loss: 2.194 Vali Acc: 0.699 Test Loss: 2.194 Test Acc: 0.699
Validation loss decreased (-0.647389 --> -0.699400).  Saving model ...
Epoch: 3 cost time: 2.3724582195281982
Epoch: 3, Steps: 67 | Train Loss: 0.880 Vali Loss: 3.193 Vali Acc: 0.676 Test Loss: 3.193 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3364665508270264
Epoch: 4, Steps: 67 | Train Loss: 0.236 Vali Loss: 2.659 Vali Acc: 0.688 Test Loss: 2.659 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.249251127243042
Epoch: 5, Steps: 67 | Train Loss: 0.120 Vali Loss: 0.996 Vali Acc: 0.798 Test Loss: 0.996 Test Acc: 0.798
Validation loss decreased (-0.699400 --> -0.797678).  Saving model ...
Epoch: 6 cost time: 2.3560404777526855
Epoch: 6, Steps: 67 | Train Loss: 0.037 Vali Loss: 1.131 Vali Acc: 0.786 Test Loss: 1.131 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2679569721221924
Epoch: 7, Steps: 67 | Train Loss: 0.066 Vali Loss: 1.489 Vali Acc: 0.763 Test Loss: 1.489 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.226215124130249
Epoch: 8, Steps: 67 | Train Loss: 0.022 Vali Loss: 1.462 Vali Acc: 0.844 Test Loss: 1.462 Test Acc: 0.844
Validation loss decreased (-0.797678 --> -0.843916).  Saving model ...
Epoch: 9 cost time: 2.243927478790283
Epoch: 9, Steps: 67 | Train Loss: 0.143 Vali Loss: 1.745 Vali Acc: 0.746 Test Loss: 1.745 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3025007247924805
Epoch: 10, Steps: 67 | Train Loss: 0.088 Vali Loss: 1.694 Vali Acc: 0.792 Test Loss: 1.694 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2392287254333496
Epoch: 11, Steps: 67 | Train Loss: 0.051 Vali Loss: 1.287 Vali Acc: 0.855 Test Loss: 1.287 Test Acc: 0.855
Validation loss decreased (-0.843916 --> -0.855478).  Saving model ...
Epoch: 12 cost time: 2.202685594558716
Epoch: 12, Steps: 67 | Train Loss: 0.416 Vali Loss: 1.744 Vali Acc: 0.775 Test Loss: 1.744 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2838895320892334
Epoch: 13, Steps: 67 | Train Loss: 0.189 Vali Loss: 1.871 Vali Acc: 0.809 Test Loss: 1.871 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3142805099487305
Epoch: 14, Steps: 67 | Train Loss: 0.071 Vali Loss: 7.668 Vali Acc: 0.613 Test Loss: 7.668 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.250612735748291
Epoch: 15, Steps: 67 | Train Loss: 0.301 Vali Loss: 1.790 Vali Acc: 0.809 Test Loss: 1.790 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.281805992126465
Epoch: 16, Steps: 67 | Train Loss: 0.012 Vali Loss: 2.665 Vali Acc: 0.815 Test Loss: 2.665 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3004446029663086
Epoch: 17, Steps: 67 | Train Loss: 0.033 Vali Loss: 1.710 Vali Acc: 0.844 Test Loss: 1.710 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2291314601898193
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.844 Test Loss: 1.663 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2720730304718018
Epoch: 19, Steps: 67 | Train Loss: 0.001 Vali Loss: 1.425 Vali Acc: 0.855 Test Loss: 1.425 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3186333179473877
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.561 Vali Acc: 0.850 Test Loss: 1.561 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4103567600250244
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.574 Vali Acc: 0.850 Test Loss: 1.574 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 879639
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 86.7371979
	speed: 0.1142s/iter; left time: 1518.5014s
Epoch: 1 cost time: 14.87171459197998
Epoch: 1, Steps: 134 | Train Loss: 34.871 Vali Loss: 41.991 Vali Acc: 0.480 Test Loss: 41.991 Test Acc: 0.480
Validation loss decreased (inf --> -0.479349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000013
	speed: 0.2149s/iter; left time: 2830.1672s
Epoch: 2 cost time: 13.770610809326172
Epoch: 2, Steps: 134 | Train Loss: 13.095 Vali Loss: 3.780 Vali Acc: 0.711 Test Loss: 3.780 Test Acc: 0.711
Validation loss decreased (-0.479349 --> -0.710945).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.2298s/iter; left time: 2994.9638s
Epoch: 3 cost time: 14.17219853401184
Epoch: 3, Steps: 134 | Train Loss: 1.822 Vali Loss: 3.797 Vali Acc: 0.717 Test Loss: 3.797 Test Acc: 0.717
Validation loss decreased (-0.710945 --> -0.716725).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0043652
	speed: 0.2304s/iter; left time: 2972.1650s
Epoch: 4 cost time: 14.37611436843872
Epoch: 4, Steps: 134 | Train Loss: 1.285 Vali Loss: 5.279 Vali Acc: 0.688 Test Loss: 5.279 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2290s/iter; left time: 2923.5067s
Epoch: 5 cost time: 13.992231369018555
Epoch: 5, Steps: 134 | Train Loss: 0.722 Vali Loss: 5.507 Vali Acc: 0.769 Test Loss: 5.507 Test Acc: 0.769
Validation loss decreased (-0.716725 --> -0.768731).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2271s/iter; left time: 2868.7814s
Epoch: 6 cost time: 14.377087116241455
Epoch: 6, Steps: 134 | Train Loss: 0.177 Vali Loss: 7.116 Vali Acc: 0.740 Test Loss: 7.116 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.2250s/iter; left time: 2812.3919s
Epoch: 7 cost time: 14.318591356277466
Epoch: 7, Steps: 134 | Train Loss: 0.726 Vali Loss: 5.281 Vali Acc: 0.769 Test Loss: 5.281 Test Acc: 0.769
Validation loss decreased (-0.768731 --> -0.768733).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3734160
	speed: 0.2255s/iter; left time: 2788.0218s
Epoch: 8 cost time: 14.272572755813599
Epoch: 8, Steps: 134 | Train Loss: 0.749 Vali Loss: 8.998 Vali Acc: 0.798 Test Loss: 8.998 Test Acc: 0.798
Validation loss decreased (-0.768733 --> -0.797598).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2270s/iter; left time: 2775.9157s
Epoch: 9 cost time: 14.08789324760437
Epoch: 9, Steps: 134 | Train Loss: 1.789 Vali Loss: 7.629 Vali Acc: 0.682 Test Loss: 7.629 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.2263s/iter; left time: 2737.4852s
Epoch: 10 cost time: 14.139394044876099
Epoch: 10, Steps: 134 | Train Loss: 0.380 Vali Loss: 12.817 Vali Acc: 0.682 Test Loss: 12.817 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2249s/iter; left time: 2690.5933s
Epoch: 11 cost time: 14.391000986099243
Epoch: 11, Steps: 134 | Train Loss: 0.268 Vali Loss: 9.960 Vali Acc: 0.775 Test Loss: 9.960 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.2262s/iter; left time: 2675.2106s
Epoch: 12 cost time: 14.236971139907837
Epoch: 12, Steps: 134 | Train Loss: 0.723 Vali Loss: 8.592 Vali Acc: 0.803 Test Loss: 8.592 Test Acc: 0.803
Validation loss decreased (-0.797598 --> -0.803382).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2347s/iter; left time: 2744.4289s
Epoch: 13 cost time: 14.340711116790771
Epoch: 13, Steps: 134 | Train Loss: 0.399 Vali Loss: 8.967 Vali Acc: 0.792 Test Loss: 8.967 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2378s/iter; left time: 2748.9046s
Epoch: 14 cost time: 14.313169717788696
Epoch: 14, Steps: 134 | Train Loss: 0.299 Vali Loss: 8.231 Vali Acc: 0.798 Test Loss: 8.231 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.2331s/iter; left time: 2663.2545s
Epoch: 15 cost time: 14.36733365058899
Epoch: 15, Steps: 134 | Train Loss: 0.600 Vali Loss: 11.025 Vali Acc: 0.699 Test Loss: 11.025 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.2274s/iter; left time: 2567.1348s
Epoch: 16 cost time: 14.42060112953186
Epoch: 16, Steps: 134 | Train Loss: 0.181 Vali Loss: 21.435 Vali Acc: 0.682 Test Loss: 21.435 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.2306s/iter; left time: 2572.7124s
Epoch: 17 cost time: 14.417747497558594
Epoch: 17, Steps: 134 | Train Loss: 0.428 Vali Loss: 12.035 Vali Acc: 0.786 Test Loss: 12.035 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.2275s/iter; left time: 2507.9850s
Epoch: 18 cost time: 14.286900997161865
Epoch: 18, Steps: 134 | Train Loss: 0.179 Vali Loss: 14.154 Vali Acc: 0.803 Test Loss: 14.154 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.2275s/iter; left time: 2477.7896s
Epoch: 19 cost time: 14.451364755630493
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 14.382 Vali Acc: 0.780 Test Loss: 14.382 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2262s/iter; left time: 2433.2978s
Epoch: 20 cost time: 14.305980682373047
Epoch: 20, Steps: 134 | Train Loss: 0.372 Vali Loss: 8.219 Vali Acc: 0.769 Test Loss: 8.219 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2268s/iter; left time: 2409.1353s
Epoch: 21 cost time: 14.33980417251587
Epoch: 21, Steps: 134 | Train Loss: 0.095 Vali Loss: 13.457 Vali Acc: 0.775 Test Loss: 13.457 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.2307s/iter; left time: 2418.9507s
Epoch: 22 cost time: 14.432718992233276
Epoch: 22, Steps: 134 | Train Loss: 0.108 Vali Loss: 42.740 Vali Acc: 0.746 Test Loss: 42.740 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 7775575
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.4142045974731445
Epoch: 1, Steps: 67 | Train Loss: 10.149 Vali Loss: 9.334 Vali Acc: 0.543 Test Loss: 9.334 Test Acc: 0.543
Validation loss decreased (inf --> -0.543259).  Saving model ...
Epoch: 2 cost time: 5.800921678543091
Epoch: 2, Steps: 67 | Train Loss: 11.132 Vali Loss: 11.189 Vali Acc: 0.497 Test Loss: 11.189 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.7734150886535645
Epoch: 3, Steps: 67 | Train Loss: 4.392 Vali Loss: 9.186 Vali Acc: 0.468 Test Loss: 9.186 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.8269360065460205
Epoch: 4, Steps: 67 | Train Loss: 3.428 Vali Loss: 6.361 Vali Acc: 0.711 Test Loss: 6.361 Test Acc: 0.711
Validation loss decreased (-0.543259 --> -0.710919).  Saving model ...
Epoch: 5 cost time: 5.92928147315979
Epoch: 5, Steps: 67 | Train Loss: 0.566 Vali Loss: 2.100 Vali Acc: 0.780 Test Loss: 2.100 Test Acc: 0.780
Validation loss decreased (-0.710919 --> -0.780326).  Saving model ...
Epoch: 6 cost time: 6.011089086532593
Epoch: 6, Steps: 67 | Train Loss: 0.258 Vali Loss: 3.658 Vali Acc: 0.780 Test Loss: 3.658 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.052968740463257
Epoch: 7, Steps: 67 | Train Loss: 0.207 Vali Loss: 2.231 Vali Acc: 0.803 Test Loss: 2.231 Test Acc: 0.803
Validation loss decreased (-0.780326 --> -0.803446).  Saving model ...
Epoch: 8 cost time: 6.05636191368103
Epoch: 8, Steps: 67 | Train Loss: 0.336 Vali Loss: 2.124 Vali Acc: 0.821 Test Loss: 2.124 Test Acc: 0.821
Validation loss decreased (-0.803446 --> -0.820788).  Saving model ...
Epoch: 9 cost time: 6.03915548324585
Epoch: 9, Steps: 67 | Train Loss: 0.065 Vali Loss: 1.368 Vali Acc: 0.827 Test Loss: 1.368 Test Acc: 0.827
Validation loss decreased (-0.820788 --> -0.826576).  Saving model ...
Epoch: 10 cost time: 5.912912607192993
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.570 Vali Acc: 0.769 Test Loss: 2.570 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.182172775268555
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.326 Vali Acc: 0.740 Test Loss: 7.326 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.102585792541504
Epoch: 12, Steps: 67 | Train Loss: 0.367 Vali Loss: 3.705 Vali Acc: 0.792 Test Loss: 3.705 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.967688083648682
Epoch: 13, Steps: 67 | Train Loss: 0.353 Vali Loss: 7.670 Vali Acc: 0.705 Test Loss: 7.670 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.1401660442352295
Epoch: 14, Steps: 67 | Train Loss: 0.472 Vali Loss: 8.196 Vali Acc: 0.590 Test Loss: 8.196 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.178062915802002
Epoch: 15, Steps: 67 | Train Loss: 0.161 Vali Loss: 6.620 Vali Acc: 0.775 Test Loss: 6.620 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.112668514251709
Epoch: 16, Steps: 67 | Train Loss: 0.367 Vali Loss: 12.902 Vali Acc: 0.688 Test Loss: 12.902 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.057993412017822
Epoch: 17, Steps: 67 | Train Loss: 0.221 Vali Loss: 6.260 Vali Acc: 0.792 Test Loss: 6.260 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.321846008300781
Epoch: 18, Steps: 67 | Train Loss: 0.121 Vali Loss: 3.874 Vali Acc: 0.815 Test Loss: 3.874 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.101833820343018
Epoch: 19, Steps: 67 | Train Loss: 0.001 Vali Loss: 4.424 Vali Acc: 0.798 Test Loss: 4.424 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3892823
model size : 15.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.3835608959198
Epoch: 1, Steps: 67 | Train Loss: 5.412 Vali Loss: 7.094 Vali Acc: 0.405 Test Loss: 7.094 Test Acc: 0.405
Validation loss decreased (inf --> -0.404553).  Saving model ...
Epoch: 2 cost time: 4.146662712097168
Epoch: 2, Steps: 67 | Train Loss: 6.382 Vali Loss: 9.015 Vali Acc: 0.601 Test Loss: 9.015 Test Acc: 0.601
Validation loss decreased (-0.404553 --> -0.601066).  Saving model ...
Epoch: 3 cost time: 4.200669527053833
Epoch: 3, Steps: 67 | Train Loss: 4.115 Vali Loss: 5.390 Vali Acc: 0.636 Test Loss: 5.390 Test Acc: 0.636
Validation loss decreased (-0.601066 --> -0.635784).  Saving model ...
Epoch: 4 cost time: 4.1572020053863525
Epoch: 4, Steps: 67 | Train Loss: 1.328 Vali Loss: 3.202 Vali Acc: 0.705 Test Loss: 3.202 Test Acc: 0.705
Validation loss decreased (-0.635784 --> -0.705170).  Saving model ...
Epoch: 5 cost time: 4.097023963928223
Epoch: 5, Steps: 67 | Train Loss: 0.202 Vali Loss: 1.636 Vali Acc: 0.780 Test Loss: 1.636 Test Acc: 0.780
Validation loss decreased (-0.705170 --> -0.780330).  Saving model ...
Epoch: 6 cost time: 4.111658573150635
Epoch: 6, Steps: 67 | Train Loss: 0.243 Vali Loss: 3.532 Vali Acc: 0.740 Test Loss: 3.532 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.163762331008911
Epoch: 7, Steps: 67 | Train Loss: 0.158 Vali Loss: 1.813 Vali Acc: 0.763 Test Loss: 1.813 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.286779880523682
Epoch: 8, Steps: 67 | Train Loss: 0.012 Vali Loss: 2.314 Vali Acc: 0.734 Test Loss: 2.314 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.351901292800903
Epoch: 9, Steps: 67 | Train Loss: 0.020 Vali Loss: 2.946 Vali Acc: 0.751 Test Loss: 2.946 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.351082801818848
Epoch: 10, Steps: 67 | Train Loss: 0.135 Vali Loss: 2.275 Vali Acc: 0.763 Test Loss: 2.275 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.67955994606018
Epoch: 11, Steps: 67 | Train Loss: 0.168 Vali Loss: 3.097 Vali Acc: 0.769 Test Loss: 3.097 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.516518592834473
Epoch: 12, Steps: 67 | Train Loss: 0.023 Vali Loss: 3.871 Vali Acc: 0.792 Test Loss: 3.871 Test Acc: 0.792
Validation loss decreased (-0.780330 --> -0.791869).  Saving model ...
Epoch: 13 cost time: 12.973819017410278
Epoch: 13, Steps: 67 | Train Loss: 0.009 Vali Loss: 5.186 Vali Acc: 0.763 Test Loss: 5.186 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.225787878036499
Epoch: 14, Steps: 67 | Train Loss: 0.109 Vali Loss: 4.745 Vali Acc: 0.780 Test Loss: 4.745 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.98191499710083
Epoch: 15, Steps: 67 | Train Loss: 0.327 Vali Loss: 3.309 Vali Acc: 0.740 Test Loss: 3.309 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.135619640350342
Epoch: 16, Steps: 67 | Train Loss: 0.313 Vali Loss: 4.170 Vali Acc: 0.775 Test Loss: 4.170 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.866541624069214
Epoch: 17, Steps: 67 | Train Loss: 0.442 Vali Loss: 5.975 Vali Acc: 0.705 Test Loss: 5.975 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.412815809249878
Epoch: 18, Steps: 67 | Train Loss: 0.502 Vali Loss: 7.124 Vali Acc: 0.671 Test Loss: 7.124 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 13.546451330184937
Epoch: 19, Steps: 67 | Train Loss: 0.093 Vali Loss: 4.507 Vali Acc: 0.740 Test Loss: 4.507 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.446571350097656
Epoch: 20, Steps: 67 | Train Loss: 0.004 Vali Loss: 7.482 Vali Acc: 0.751 Test Loss: 7.482 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.841984272003174
Epoch: 21, Steps: 67 | Train Loss: 0.188 Vali Loss: 4.701 Vali Acc: 0.751 Test Loss: 4.701 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.74544644355774
Epoch: 22, Steps: 67 | Train Loss: 0.118 Vali Loss: 4.769 Vali Acc: 0.769 Test Loss: 4.769 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 2598599
model size : 10.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.759308815002441
Epoch: 1, Steps: 67 | Train Loss: 3.505 Vali Loss: 11.841 Vali Acc: 0.370 Test Loss: 11.841 Test Acc: 0.370
Validation loss decreased (inf --> -0.369824).  Saving model ...
Epoch: 2 cost time: 3.6606154441833496
Epoch: 2, Steps: 67 | Train Loss: 3.707 Vali Loss: 3.175 Vali Acc: 0.642 Test Loss: 3.175 Test Acc: 0.642
Validation loss decreased (-0.369824 --> -0.641587).  Saving model ...
Epoch: 3 cost time: 3.6661882400512695
Epoch: 3, Steps: 67 | Train Loss: 1.687 Vali Loss: 8.528 Vali Acc: 0.607 Test Loss: 8.528 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.66253662109375
Epoch: 4, Steps: 67 | Train Loss: 1.410 Vali Loss: 4.206 Vali Acc: 0.694 Test Loss: 4.206 Test Acc: 0.694
Validation loss decreased (-0.641587 --> -0.693600).  Saving model ...
Epoch: 5 cost time: 3.7524001598358154
Epoch: 5, Steps: 67 | Train Loss: 0.376 Vali Loss: 2.956 Vali Acc: 0.746 Test Loss: 2.956 Test Acc: 0.746
Validation loss decreased (-0.693600 --> -0.745635).  Saving model ...
Epoch: 6 cost time: 3.631571054458618
Epoch: 6, Steps: 67 | Train Loss: 0.112 Vali Loss: 2.796 Vali Acc: 0.792 Test Loss: 2.796 Test Acc: 0.792
Validation loss decreased (-0.745635 --> -0.791880).  Saving model ...
Epoch: 7 cost time: 3.7188570499420166
Epoch: 7, Steps: 67 | Train Loss: 0.218 Vali Loss: 3.002 Vali Acc: 0.827 Test Loss: 3.002 Test Acc: 0.827
Validation loss decreased (-0.791880 --> -0.826560).  Saving model ...
Epoch: 8 cost time: 3.6206445693969727
Epoch: 8, Steps: 67 | Train Loss: 0.122 Vali Loss: 5.356 Vali Acc: 0.763 Test Loss: 5.356 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6795618534088135
Epoch: 9, Steps: 67 | Train Loss: 0.321 Vali Loss: 4.004 Vali Acc: 0.717 Test Loss: 4.004 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.712131977081299
Epoch: 10, Steps: 67 | Train Loss: 0.151 Vali Loss: 3.239 Vali Acc: 0.769 Test Loss: 3.239 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.706176280975342
Epoch: 11, Steps: 67 | Train Loss: 0.054 Vali Loss: 2.657 Vali Acc: 0.803 Test Loss: 2.657 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.575005292892456
Epoch: 12, Steps: 67 | Train Loss: 0.004 Vali Loss: 3.557 Vali Acc: 0.780 Test Loss: 3.557 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5976669788360596
Epoch: 13, Steps: 67 | Train Loss: 0.164 Vali Loss: 1.948 Vali Acc: 0.827 Test Loss: 1.948 Test Acc: 0.827
Validation loss decreased (-0.826560 --> -0.826570).  Saving model ...
Epoch: 14 cost time: 3.6408560276031494
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.832 Test Loss: 1.901 Test Acc: 0.832
Validation loss decreased (-0.826570 --> -0.832351).  Saving model ...
Epoch: 15 cost time: 3.65573787689209
Epoch: 15, Steps: 67 | Train Loss: 0.004 Vali Loss: 2.120 Vali Acc: 0.803 Test Loss: 2.120 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.649146795272827
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.163 Vali Acc: 0.734 Test Loss: 5.163 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6953625679016113
Epoch: 17, Steps: 67 | Train Loss: 0.215 Vali Loss: 3.362 Vali Acc: 0.757 Test Loss: 3.362 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6865878105163574
Epoch: 18, Steps: 67 | Train Loss: 0.347 Vali Loss: 2.404 Vali Acc: 0.780 Test Loss: 2.404 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.670290946960449
Epoch: 19, Steps: 67 | Train Loss: 0.051 Vali Loss: 3.140 Vali Acc: 0.798 Test Loss: 3.140 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6403234004974365
Epoch: 20, Steps: 67 | Train Loss: 0.107 Vali Loss: 6.415 Vali Acc: 0.775 Test Loss: 6.415 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8029274940490723
Epoch: 21, Steps: 67 | Train Loss: 0.666 Vali Loss: 1.913 Vali Acc: 0.809 Test Loss: 1.913 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.74657940864563
Epoch: 22, Steps: 67 | Train Loss: 0.198 Vali Loss: 3.009 Vali Acc: 0.821 Test Loss: 3.009 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.7763099670410156
Epoch: 23, Steps: 67 | Train Loss: 0.038 Vali Loss: 3.697 Vali Acc: 0.780 Test Loss: 3.697 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.7965450286865234
Epoch: 24, Steps: 67 | Train Loss: 0.024 Vali Loss: 2.196 Vali Acc: 0.850 Test Loss: 2.196 Test Acc: 0.850
Validation loss decreased (-0.832351 --> -0.849689).  Saving model ...
Epoch: 25 cost time: 3.741048574447632
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.057 Vali Acc: 0.844 Test Loss: 2.057 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.819075345993042
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.844 Test Loss: 2.042 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8201630115509033
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.063 Vali Acc: 0.855 Test Loss: 2.063 Test Acc: 0.855
Validation loss decreased (-0.849689 --> -0.855471).  Saving model ...
Epoch: 28 cost time: 3.7900032997131348
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.788 Vali Acc: 0.827 Test Loss: 2.788 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.6689960956573486
Epoch: 29, Steps: 67 | Train Loss: 0.055 Vali Loss: 4.064 Vali Acc: 0.827 Test Loss: 4.064 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6960973739624023
Epoch: 30, Steps: 67 | Train Loss: 0.444 Vali Loss: 8.375 Vali Acc: 0.699 Test Loss: 8.375 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.6507461071014404
Epoch: 31, Steps: 67 | Train Loss: 0.143 Vali Loss: 18.436 Vali Acc: 0.711 Test Loss: 18.436 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.6352412700653076
Epoch: 32, Steps: 67 | Train Loss: 1.093 Vali Loss: 15.388 Vali Acc: 0.624 Test Loss: 15.388 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.7575290203094482
Epoch: 33, Steps: 67 | Train Loss: 0.418 Vali Loss: 5.681 Vali Acc: 0.780 Test Loss: 5.681 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.7113170623779297
Epoch: 34, Steps: 67 | Train Loss: 0.203 Vali Loss: 5.467 Vali Acc: 0.798 Test Loss: 5.467 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.715498447418213
Epoch: 35, Steps: 67 | Train Loss: 0.002 Vali Loss: 10.249 Vali Acc: 0.723 Test Loss: 10.249 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.7066845893859863
Epoch: 36, Steps: 67 | Train Loss: 0.048 Vali Loss: 6.985 Vali Acc: 0.780 Test Loss: 6.985 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.66011118888855
Epoch: 37, Steps: 67 | Train Loss: 0.154 Vali Loss: 8.656 Vali Acc: 0.757 Test Loss: 8.656 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1951527
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.207988262176514
Epoch: 1, Steps: 67 | Train Loss: 3.152 Vali Loss: 3.721 Vali Acc: 0.590 Test Loss: 3.721 Test Acc: 0.590
Validation loss decreased (inf --> -0.589558).  Saving model ...
Epoch: 2 cost time: 2.7381863594055176
Epoch: 2, Steps: 67 | Train Loss: 2.838 Vali Loss: 1.237 Vali Acc: 0.734 Test Loss: 1.237 Test Acc: 0.734
Validation loss decreased (-0.589558 --> -0.734092).  Saving model ...
Epoch: 3 cost time: 2.762244462966919
Epoch: 3, Steps: 67 | Train Loss: 0.788 Vali Loss: 1.903 Vali Acc: 0.723 Test Loss: 1.903 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.823333263397217
Epoch: 4, Steps: 67 | Train Loss: 0.708 Vali Loss: 1.947 Vali Acc: 0.803 Test Loss: 1.947 Test Acc: 0.803
Validation loss decreased (-0.734092 --> -0.803449).  Saving model ...
Epoch: 5 cost time: 2.7773704528808594
Epoch: 5, Steps: 67 | Train Loss: 0.356 Vali Loss: 3.393 Vali Acc: 0.763 Test Loss: 3.393 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.975303888320923
Epoch: 6, Steps: 67 | Train Loss: 0.305 Vali Loss: 5.122 Vali Acc: 0.601 Test Loss: 5.122 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.793922185897827
Epoch: 7, Steps: 67 | Train Loss: 0.286 Vali Loss: 2.327 Vali Acc: 0.775 Test Loss: 2.327 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.731696128845215
Epoch: 8, Steps: 67 | Train Loss: 0.026 Vali Loss: 2.165 Vali Acc: 0.751 Test Loss: 2.165 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.800320625305176
Epoch: 9, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.773 Vali Acc: 0.780 Test Loss: 2.773 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.869389772415161
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.763 Test Loss: 2.171 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8279407024383545
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.763 Test Loss: 2.171 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.812864303588867
Epoch: 12, Steps: 67 | Train Loss: 0.473 Vali Loss: 5.573 Vali Acc: 0.647 Test Loss: 5.573 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8239047527313232
Epoch: 13, Steps: 67 | Train Loss: 0.349 Vali Loss: 6.204 Vali Acc: 0.665 Test Loss: 6.204 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8217830657958984
Epoch: 14, Steps: 67 | Train Loss: 0.326 Vali Loss: 4.568 Vali Acc: 0.775 Test Loss: 4.568 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1412359
model size : 5.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7822816371917725
Epoch: 1, Steps: 67 | Train Loss: 2.875 Vali Loss: 2.772 Vali Acc: 0.462 Test Loss: 2.772 Test Acc: 0.462
Validation loss decreased (inf --> -0.462400).  Saving model ...
Epoch: 2 cost time: 2.2919087409973145
Epoch: 2, Steps: 67 | Train Loss: 2.358 Vali Loss: 3.803 Vali Acc: 0.532 Test Loss: 3.803 Test Acc: 0.532
Validation loss decreased (-0.462400 --> -0.531754).  Saving model ...
Epoch: 3 cost time: 2.4850316047668457
Epoch: 3, Steps: 67 | Train Loss: 0.732 Vali Loss: 2.403 Vali Acc: 0.688 Test Loss: 2.403 Test Acc: 0.688
Validation loss decreased (-0.531754 --> -0.687837).  Saving model ...
Epoch: 4 cost time: 2.3143889904022217
Epoch: 4, Steps: 67 | Train Loss: 0.247 Vali Loss: 1.736 Vali Acc: 0.734 Test Loss: 1.736 Test Acc: 0.734
Validation loss decreased (-0.687837 --> -0.734087).  Saving model ...
Epoch: 5 cost time: 2.326279878616333
Epoch: 5, Steps: 67 | Train Loss: 0.341 Vali Loss: 1.107 Vali Acc: 0.809 Test Loss: 1.107 Test Acc: 0.809
Validation loss decreased (-0.734087 --> -0.809237).  Saving model ...
Epoch: 6 cost time: 2.3847436904907227
Epoch: 6, Steps: 67 | Train Loss: 0.027 Vali Loss: 1.677 Vali Acc: 0.792 Test Loss: 1.677 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.353787660598755
Epoch: 7, Steps: 67 | Train Loss: 0.260 Vali Loss: 2.324 Vali Acc: 0.705 Test Loss: 2.324 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5317542552948
Epoch: 8, Steps: 67 | Train Loss: 0.086 Vali Loss: 5.998 Vali Acc: 0.699 Test Loss: 5.998 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3203790187835693
Epoch: 9, Steps: 67 | Train Loss: 0.313 Vali Loss: 2.757 Vali Acc: 0.757 Test Loss: 2.757 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.264960289001465
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.553 Vali Acc: 0.792 Test Loss: 1.553 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.389662027359009
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.792 Test Loss: 1.538 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.3538596630096436
Epoch: 12, Steps: 67 | Train Loss: 0.321 Vali Loss: 2.683 Vali Acc: 0.740 Test Loss: 2.683 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.327707290649414
Epoch: 13, Steps: 67 | Train Loss: 0.106 Vali Loss: 2.711 Vali Acc: 0.775 Test Loss: 2.711 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.280240774154663
Epoch: 14, Steps: 67 | Train Loss: 0.020 Vali Loss: 2.817 Vali Acc: 0.769 Test Loss: 2.817 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.3681464195251465
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.798 Test Loss: 2.220 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 981047
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.458070993423462
Epoch: 1, Steps: 67 | Train Loss: 2.437 Vali Loss: 3.241 Vali Acc: 0.497 Test Loss: 3.241 Test Acc: 0.497
Validation loss decreased (inf --> -0.497077).  Saving model ...
Epoch: 2 cost time: 2.014359951019287
Epoch: 2, Steps: 67 | Train Loss: 1.342 Vali Loss: 2.765 Vali Acc: 0.665 Test Loss: 2.765 Test Acc: 0.665
Validation loss decreased (-0.497077 --> -0.664712).  Saving model ...
Epoch: 3 cost time: 2.126067876815796
Epoch: 3, Steps: 67 | Train Loss: 1.187 Vali Loss: 4.209 Vali Acc: 0.699 Test Loss: 4.209 Test Acc: 0.699
Validation loss decreased (-0.664712 --> -0.699380).  Saving model ...
Epoch: 4 cost time: 2.063377857208252
Epoch: 4, Steps: 67 | Train Loss: 0.589 Vali Loss: 1.948 Vali Acc: 0.763 Test Loss: 1.948 Test Acc: 0.763
Validation loss decreased (-0.699380 --> -0.762986).  Saving model ...
Epoch: 5 cost time: 2.1497223377227783
Epoch: 5, Steps: 67 | Train Loss: 0.087 Vali Loss: 0.966 Vali Acc: 0.786 Test Loss: 0.966 Test Acc: 0.786
Validation loss decreased (-0.762986 --> -0.786118).  Saving model ...
Epoch: 6 cost time: 2.115217685699463
Epoch: 6, Steps: 67 | Train Loss: 0.037 Vali Loss: 3.386 Vali Acc: 0.694 Test Loss: 3.386 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2750751972198486
Epoch: 7, Steps: 67 | Train Loss: 0.018 Vali Loss: 0.828 Vali Acc: 0.844 Test Loss: 0.828 Test Acc: 0.844
Validation loss decreased (-0.786118 --> -0.843922).  Saving model ...
Epoch: 8 cost time: 2.0545599460601807
Epoch: 8, Steps: 67 | Train Loss: 0.010 Vali Loss: 1.413 Vali Acc: 0.798 Test Loss: 1.413 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.048396110534668
Epoch: 9, Steps: 67 | Train Loss: 0.004 Vali Loss: 2.462 Vali Acc: 0.775 Test Loss: 2.462 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1511807441711426
Epoch: 10, Steps: 67 | Train Loss: 0.026 Vali Loss: 1.227 Vali Acc: 0.815 Test Loss: 1.227 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.173576593399048
Epoch: 11, Steps: 67 | Train Loss: 0.027 Vali Loss: 0.828 Vali Acc: 0.798 Test Loss: 0.828 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0175740718841553
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.844 Test Loss: 0.947 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.063349485397339
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.980 Vali Acc: 0.844 Test Loss: 0.980 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0174500942230225
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.844 Test Loss: 0.985 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.224782943725586
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.850 Test Loss: 0.894 Test Acc: 0.850
Validation loss decreased (-0.843922 --> -0.849702).  Saving model ...
Epoch: 16 cost time: 2.2079107761383057
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.844 Test Loss: 0.885 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1675658226013184
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.850 Test Loss: 0.862 Test Acc: 0.850
Validation loss decreased (-0.849702 --> -0.849702).  Saving model ...
Epoch: 18 cost time: 2.2420907020568848
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.850 Test Loss: 0.862 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2034778594970703
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.855 Test Loss: 0.717 Test Acc: 0.855
Validation loss decreased (-0.849702 --> -0.855484).  Saving model ...
Epoch: 20 cost time: 2.3360888957977295
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0966591835021973
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.844 Test Loss: 0.743 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2319257259368896
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.855 Test Loss: 0.730 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1850996017456055
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.855 Test Loss: 0.728 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4574077129364014
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.855 Test Loss: 0.731 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3305609226226807
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.844 Test Loss: 0.720 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0986275672912598
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2212936878204346
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.855 Test Loss: 0.718 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3580052852630615
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.210710287094116
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.855 Test Loss: 0.720 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 873303
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 33.2511444
	speed: 0.3713s/iter; left time: 4938.5039s
Epoch: 1 cost time: 49.52053737640381
Epoch: 1, Steps: 134 | Train Loss: 171.969 Vali Loss: 10.310 Vali Acc: 0.382 Test Loss: 10.310 Test Acc: 0.382
Validation loss decreased (inf --> -0.381400).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.7411s/iter; left time: 9758.1804s
Epoch: 2 cost time: 49.34927701950073
Epoch: 2, Steps: 134 | Train Loss: 4.258 Vali Loss: 22.250 Vali Acc: 0.462 Test Loss: 22.250 Test Acc: 0.462
Validation loss decreased (-0.381400 --> -0.462205).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000045
	speed: 0.7602s/iter; left time: 9907.6421s
Epoch: 3 cost time: 49.245630502700806
Epoch: 3, Steps: 134 | Train Loss: 3.274 Vali Loss: 14.597 Vali Acc: 0.532 Test Loss: 14.597 Test Acc: 0.532
Validation loss decreased (-0.462205 --> -0.531646).  Saving model ...
	iters: 100, epoch: 4 | loss: 9.3610792
	speed: 0.7666s/iter; left time: 9888.9155s
Epoch: 4 cost time: 49.18942880630493
Epoch: 4, Steps: 134 | Train Loss: 4.497 Vali Loss: 11.039 Vali Acc: 0.647 Test Loss: 11.039 Test Acc: 0.647
Validation loss decreased (-0.531646 --> -0.647288).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7641s/iter; left time: 9754.2874s
Epoch: 5 cost time: 49.393688917160034
Epoch: 5, Steps: 134 | Train Loss: 3.429 Vali Loss: 29.900 Vali Acc: 0.491 Test Loss: 29.900 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0477456
	speed: 0.7383s/iter; left time: 9325.7327s
Epoch: 6 cost time: 49.54456877708435
Epoch: 6, Steps: 134 | Train Loss: 2.870 Vali Loss: 56.827 Vali Acc: 0.595 Test Loss: 56.827 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7367s/iter; left time: 9206.1672s
Epoch: 7 cost time: 49.48716688156128
Epoch: 7, Steps: 134 | Train Loss: 3.200 Vali Loss: 10.558 Vali Acc: 0.827 Test Loss: 10.558 Test Acc: 0.827
Validation loss decreased (-0.647288 --> -0.826484).  Saving model ...
	iters: 100, epoch: 8 | loss: 13.6844749
	speed: 0.7678s/iter; left time: 9492.7081s
Epoch: 8 cost time: 49.60986852645874
Epoch: 8, Steps: 134 | Train Loss: 2.581 Vali Loss: 59.928 Vali Acc: 0.613 Test Loss: 59.928 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 52.8895683
	speed: 0.7398s/iter; left time: 9046.4457s
Epoch: 9 cost time: 49.524334192276
Epoch: 9, Steps: 134 | Train Loss: 1.804 Vali Loss: 33.337 Vali Acc: 0.630 Test Loss: 33.337 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7370s/iter; left time: 8914.1201s
Epoch: 10 cost time: 49.31284856796265
Epoch: 10, Steps: 134 | Train Loss: 2.042 Vali Loss: 43.362 Vali Acc: 0.671 Test Loss: 43.362 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7368s/iter; left time: 8813.0147s
Epoch: 11 cost time: 49.23808217048645
Epoch: 11, Steps: 134 | Train Loss: 3.158 Vali Loss: 48.765 Vali Acc: 0.682 Test Loss: 48.765 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7366s/iter; left time: 8711.6095s
Epoch: 12 cost time: 49.465789794921875
Epoch: 12, Steps: 134 | Train Loss: 3.583 Vali Loss: 44.794 Vali Acc: 0.705 Test Loss: 44.794 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7371s/iter; left time: 8618.7752s
Epoch: 13 cost time: 49.542123317718506
Epoch: 13, Steps: 134 | Train Loss: 4.342 Vali Loss: 115.371 Vali Acc: 0.329 Test Loss: 115.371 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7432s/iter; left time: 8590.5386s
Epoch: 14 cost time: 49.504162311553955
Epoch: 14, Steps: 134 | Train Loss: 1.733 Vali Loss: 73.985 Vali Acc: 0.653 Test Loss: 73.985 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7359s/iter; left time: 8407.9196s
Epoch: 15 cost time: 49.24449920654297
Epoch: 15, Steps: 134 | Train Loss: 1.521 Vali Loss: 128.597 Vali Acc: 0.694 Test Loss: 128.597 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7384s/iter; left time: 8337.5865s
Epoch: 16 cost time: 49.502522468566895
Epoch: 16, Steps: 134 | Train Loss: 4.897 Vali Loss: 292.247 Vali Acc: 0.520 Test Loss: 292.247 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7401s/iter; left time: 8257.4797s
Epoch: 17 cost time: 49.28822660446167
Epoch: 17, Steps: 134 | Train Loss: 4.769 Vali Loss: 263.073 Vali Acc: 0.283 Test Loss: 263.073 Test Acc: 0.283
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 62390791
model size : 240.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 23.546565532684326
Epoch: 1, Steps: 67 | Train Loss: 62.493 Vali Loss: 61.476 Vali Acc: 0.353 Test Loss: 61.476 Test Acc: 0.353
Validation loss decreased (inf --> -0.351986).  Saving model ...
Epoch: 2 cost time: 23.16436219215393
Epoch: 2, Steps: 67 | Train Loss: 30.316 Vali Loss: 9.420 Vali Acc: 0.549 Test Loss: 9.420 Test Acc: 0.549
Validation loss decreased (-0.351986 --> -0.549039).  Saving model ...
Epoch: 3 cost time: 23.32611632347107
Epoch: 3, Steps: 67 | Train Loss: 0.432 Vali Loss: 5.319 Vali Acc: 0.699 Test Loss: 5.319 Test Acc: 0.699
Validation loss decreased (-0.549039 --> -0.699369).  Saving model ...
Epoch: 4 cost time: 22.968137502670288
Epoch: 4, Steps: 67 | Train Loss: 0.355 Vali Loss: 7.935 Vali Acc: 0.636 Test Loss: 7.935 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 23.218928337097168
Epoch: 5, Steps: 67 | Train Loss: 0.516 Vali Loss: 12.447 Vali Acc: 0.688 Test Loss: 12.447 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 23.16010093688965
Epoch: 6, Steps: 67 | Train Loss: 0.613 Vali Loss: 6.466 Vali Acc: 0.694 Test Loss: 6.466 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 23.149336099624634
Epoch: 7, Steps: 67 | Train Loss: 0.776 Vali Loss: 17.590 Vali Acc: 0.566 Test Loss: 17.590 Test Acc: 0.566
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 23.280815362930298
Epoch: 8, Steps: 67 | Train Loss: 0.837 Vali Loss: 8.661 Vali Acc: 0.734 Test Loss: 8.661 Test Acc: 0.734
Validation loss decreased (-0.699369 --> -0.734017).  Saving model ...
Epoch: 9 cost time: 23.38982129096985
Epoch: 9, Steps: 67 | Train Loss: 0.897 Vali Loss: 8.599 Vali Acc: 0.723 Test Loss: 8.599 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 23.384010314941406
Epoch: 10, Steps: 67 | Train Loss: 0.966 Vali Loss: 14.909 Vali Acc: 0.769 Test Loss: 14.909 Test Acc: 0.769
Validation loss decreased (-0.734017 --> -0.768637).  Saving model ...
Epoch: 11 cost time: 23.072328329086304
Epoch: 11, Steps: 67 | Train Loss: 3.099 Vali Loss: 54.621 Vali Acc: 0.549 Test Loss: 54.621 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.168056964874268
Epoch: 12, Steps: 67 | Train Loss: 1.410 Vali Loss: 10.434 Vali Acc: 0.803 Test Loss: 10.434 Test Acc: 0.803
Validation loss decreased (-0.768637 --> -0.803364).  Saving model ...
Epoch: 13 cost time: 22.939184427261353
Epoch: 13, Steps: 67 | Train Loss: 1.058 Vali Loss: 14.961 Vali Acc: 0.751 Test Loss: 14.961 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 23.22583317756653
Epoch: 14, Steps: 67 | Train Loss: 0.388 Vali Loss: 12.385 Vali Acc: 0.798 Test Loss: 12.385 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 23.23718762397766
Epoch: 15, Steps: 67 | Train Loss: 0.634 Vali Loss: 28.243 Vali Acc: 0.671 Test Loss: 28.243 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 23.182259798049927
Epoch: 16, Steps: 67 | Train Loss: 1.877 Vali Loss: 23.712 Vali Acc: 0.798 Test Loss: 23.712 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 23.424304485321045
Epoch: 17, Steps: 67 | Train Loss: 1.016 Vali Loss: 16.546 Vali Acc: 0.792 Test Loss: 16.546 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 23.133217811584473
Epoch: 18, Steps: 67 | Train Loss: 0.517 Vali Loss: 44.964 Vali Acc: 0.590 Test Loss: 44.964 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 22.917458534240723
Epoch: 19, Steps: 67 | Train Loss: 0.682 Vali Loss: 9.856 Vali Acc: 0.803 Test Loss: 9.856 Test Acc: 0.803
Validation loss decreased (-0.803364 --> -0.803370).  Saving model ...
Epoch: 20 cost time: 22.773455381393433
Epoch: 20, Steps: 67 | Train Loss: 0.781 Vali Loss: 19.302 Vali Acc: 0.740 Test Loss: 19.302 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 22.804824352264404
Epoch: 21, Steps: 67 | Train Loss: 0.247 Vali Loss: 60.479 Vali Acc: 0.740 Test Loss: 60.479 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 22.81435513496399
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 43.935 Vali Acc: 0.734 Test Loss: 43.935 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 22.96995735168457
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 43.207 Vali Acc: 0.734 Test Loss: 43.207 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 23.1344096660614
Epoch: 24, Steps: 67 | Train Loss: 1.602 Vali Loss: 42.581 Vali Acc: 0.613 Test Loss: 42.581 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 23.249234676361084
Epoch: 25, Steps: 67 | Train Loss: 0.838 Vali Loss: 26.064 Vali Acc: 0.763 Test Loss: 26.064 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 22.938140153884888
Epoch: 26, Steps: 67 | Train Loss: 0.681 Vali Loss: 29.257 Vali Acc: 0.717 Test Loss: 29.257 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 23.267212390899658
Epoch: 27, Steps: 67 | Train Loss: 1.703 Vali Loss: 16.011 Vali Acc: 0.769 Test Loss: 16.011 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 23.18284821510315
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 20.048 Vali Acc: 0.746 Test Loss: 20.048 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 23.27462387084961
Epoch: 29, Steps: 67 | Train Loss: 0.042 Vali Loss: 62.171 Vali Acc: 0.694 Test Loss: 62.171 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 31328775
model size : 121.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.709880828857422
Epoch: 1, Steps: 67 | Train Loss: 30.683 Vali Loss: 42.674 Vali Acc: 0.387 Test Loss: 42.674 Test Acc: 0.387
Validation loss decreased (inf --> -0.386856).  Saving model ...
Epoch: 2 cost time: 12.129254579544067
Epoch: 2, Steps: 67 | Train Loss: 26.623 Vali Loss: 7.878 Vali Acc: 0.671 Test Loss: 7.878 Test Acc: 0.671
Validation loss decreased (-0.386856 --> -0.670441).  Saving model ...
Epoch: 3 cost time: 12.467045068740845
Epoch: 3, Steps: 67 | Train Loss: 1.407 Vali Loss: 1.504 Vali Acc: 0.821 Test Loss: 1.504 Test Acc: 0.821
Validation loss decreased (-0.670441 --> -0.820794).  Saving model ...
Epoch: 4 cost time: 12.315466403961182
Epoch: 4, Steps: 67 | Train Loss: 0.062 Vali Loss: 1.920 Vali Acc: 0.809 Test Loss: 1.920 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.648905754089355
Epoch: 5, Steps: 67 | Train Loss: 0.553 Vali Loss: 2.537 Vali Acc: 0.809 Test Loss: 2.537 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.283083438873291
Epoch: 6, Steps: 67 | Train Loss: 0.012 Vali Loss: 6.971 Vali Acc: 0.786 Test Loss: 6.971 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.431033372879028
Epoch: 7, Steps: 67 | Train Loss: 0.245 Vali Loss: 5.890 Vali Acc: 0.763 Test Loss: 5.890 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 12.327273607254028
Epoch: 8, Steps: 67 | Train Loss: 0.384 Vali Loss: 4.547 Vali Acc: 0.740 Test Loss: 4.547 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 12.333655595779419
Epoch: 9, Steps: 67 | Train Loss: 1.707 Vali Loss: 11.705 Vali Acc: 0.665 Test Loss: 11.705 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.329630613327026
Epoch: 10, Steps: 67 | Train Loss: 0.497 Vali Loss: 8.234 Vali Acc: 0.757 Test Loss: 8.234 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.275046110153198
Epoch: 11, Steps: 67 | Train Loss: 0.738 Vali Loss: 7.004 Vali Acc: 0.751 Test Loss: 7.004 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 12.404594421386719
Epoch: 12, Steps: 67 | Train Loss: 0.301 Vali Loss: 8.629 Vali Acc: 0.728 Test Loss: 8.629 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.351690769195557
Epoch: 13, Steps: 67 | Train Loss: 1.669 Vali Loss: 5.517 Vali Acc: 0.850 Test Loss: 5.517 Test Acc: 0.850
Validation loss decreased (-0.820794 --> -0.849656).  Saving model ...
Epoch: 14 cost time: 12.401697635650635
Epoch: 14, Steps: 67 | Train Loss: 1.329 Vali Loss: 32.223 Vali Acc: 0.520 Test Loss: 32.223 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.281038999557495
Epoch: 15, Steps: 67 | Train Loss: 1.414 Vali Loss: 31.333 Vali Acc: 0.555 Test Loss: 31.333 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 12.367464542388916
Epoch: 16, Steps: 67 | Train Loss: 2.284 Vali Loss: 13.888 Vali Acc: 0.763 Test Loss: 13.888 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.357160806655884
Epoch: 17, Steps: 67 | Train Loss: 1.122 Vali Loss: 5.202 Vali Acc: 0.850 Test Loss: 5.202 Test Acc: 0.850
Validation loss decreased (-0.849656 --> -0.849659).  Saving model ...
Epoch: 18 cost time: 12.161111831665039
Epoch: 18, Steps: 67 | Train Loss: 1.070 Vali Loss: 33.288 Vali Acc: 0.613 Test Loss: 33.288 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.488422870635986
Epoch: 19, Steps: 67 | Train Loss: 0.955 Vali Loss: 25.700 Vali Acc: 0.728 Test Loss: 25.700 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 12.39355993270874
Epoch: 20, Steps: 67 | Train Loss: 0.322 Vali Loss: 37.234 Vali Acc: 0.763 Test Loss: 37.234 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 12.445868968963623
Epoch: 21, Steps: 67 | Train Loss: 2.203 Vali Loss: 28.591 Vali Acc: 0.717 Test Loss: 28.591 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.355260133743286
Epoch: 22, Steps: 67 | Train Loss: 0.281 Vali Loss: 20.695 Vali Acc: 0.786 Test Loss: 20.695 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.180466651916504
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.533 Vali Acc: 0.786 Test Loss: 21.533 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.43522024154663
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.377 Vali Acc: 0.786 Test Loss: 21.377 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.347871780395508
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.465 Vali Acc: 0.786 Test Loss: 21.465 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 12.273821353912354
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.451 Vali Acc: 0.786 Test Loss: 21.451 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 12.25587773323059
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.648 Vali Acc: 0.786 Test Loss: 21.648 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 20974983
model size : 82.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.342347145080566
Epoch: 1, Steps: 67 | Train Loss: 29.945 Vali Loss: 43.850 Vali Acc: 0.439 Test Loss: 43.850 Test Acc: 0.439
Validation loss decreased (inf --> -0.438868).  Saving model ...
Epoch: 2 cost time: 10.299497842788696
Epoch: 2, Steps: 67 | Train Loss: 7.961 Vali Loss: 1.332 Vali Acc: 0.705 Test Loss: 1.332 Test Acc: 0.705
Validation loss decreased (-0.438868 --> -0.705189).  Saving model ...
Epoch: 3 cost time: 10.435489177703857
Epoch: 3, Steps: 67 | Train Loss: 0.356 Vali Loss: 5.280 Vali Acc: 0.659 Test Loss: 5.280 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.878641128540039
Epoch: 4, Steps: 67 | Train Loss: 0.539 Vali Loss: 3.486 Vali Acc: 0.746 Test Loss: 3.486 Test Acc: 0.746
Validation loss decreased (-0.705189 --> -0.745630).  Saving model ...
Epoch: 5 cost time: 10.70889925956726
Epoch: 5, Steps: 67 | Train Loss: 0.404 Vali Loss: 4.879 Vali Acc: 0.751 Test Loss: 4.879 Test Acc: 0.751
Validation loss decreased (-0.745630 --> -0.751396).  Saving model ...
Epoch: 6 cost time: 10.72822618484497
Epoch: 6, Steps: 67 | Train Loss: 0.076 Vali Loss: 5.229 Vali Acc: 0.803 Test Loss: 5.229 Test Acc: 0.803
Validation loss decreased (-0.751396 --> -0.803416).  Saving model ...
Epoch: 7 cost time: 10.639909029006958
Epoch: 7, Steps: 67 | Train Loss: 0.656 Vali Loss: 6.252 Vali Acc: 0.751 Test Loss: 6.252 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.571486234664917
Epoch: 8, Steps: 67 | Train Loss: 0.335 Vali Loss: 8.779 Vali Acc: 0.757 Test Loss: 8.779 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.007524490356445
Epoch: 9, Steps: 67 | Train Loss: 0.735 Vali Loss: 7.935 Vali Acc: 0.775 Test Loss: 7.935 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.533371686935425
Epoch: 10, Steps: 67 | Train Loss: 0.686 Vali Loss: 5.461 Vali Acc: 0.717 Test Loss: 5.461 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.793309450149536
Epoch: 11, Steps: 67 | Train Loss: 0.502 Vali Loss: 9.464 Vali Acc: 0.688 Test Loss: 9.464 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.572043895721436
Epoch: 12, Steps: 67 | Train Loss: 0.506 Vali Loss: 29.011 Vali Acc: 0.775 Test Loss: 29.011 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.771857023239136
Epoch: 13, Steps: 67 | Train Loss: 0.969 Vali Loss: 6.673 Vali Acc: 0.780 Test Loss: 6.673 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.507607221603394
Epoch: 14, Steps: 67 | Train Loss: 0.965 Vali Loss: 18.156 Vali Acc: 0.682 Test Loss: 18.156 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.668895244598389
Epoch: 15, Steps: 67 | Train Loss: 1.703 Vali Loss: 7.945 Vali Acc: 0.775 Test Loss: 7.945 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.678375244140625
Epoch: 16, Steps: 67 | Train Loss: 0.683 Vali Loss: 23.368 Vali Acc: 0.740 Test Loss: 23.368 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 15798407
model size : 62.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.939618349075317
Epoch: 1, Steps: 67 | Train Loss: 20.349 Vali Loss: 10.821 Vali Acc: 0.405 Test Loss: 10.821 Test Acc: 0.405
Validation loss decreased (inf --> -0.404516).  Saving model ...
Epoch: 2 cost time: 7.657894134521484
Epoch: 2, Steps: 67 | Train Loss: 5.614 Vali Loss: 2.753 Vali Acc: 0.699 Test Loss: 2.753 Test Acc: 0.699
Validation loss decreased (-0.404516 --> -0.699394).  Saving model ...
Epoch: 3 cost time: 7.608770132064819
Epoch: 3, Steps: 67 | Train Loss: 0.439 Vali Loss: 1.920 Vali Acc: 0.757 Test Loss: 1.920 Test Acc: 0.757
Validation loss decreased (-0.699394 --> -0.757206).  Saving model ...
Epoch: 4 cost time: 7.621932029724121
Epoch: 4, Steps: 67 | Train Loss: 0.192 Vali Loss: 4.335 Vali Acc: 0.694 Test Loss: 4.335 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.730158090591431
Epoch: 5, Steps: 67 | Train Loss: 0.131 Vali Loss: 3.523 Vali Acc: 0.780 Test Loss: 3.523 Test Acc: 0.780
Validation loss decreased (-0.757206 --> -0.780312).  Saving model ...
Epoch: 6 cost time: 7.735309600830078
Epoch: 6, Steps: 67 | Train Loss: 0.785 Vali Loss: 3.884 Vali Acc: 0.711 Test Loss: 3.884 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.802378416061401
Epoch: 7, Steps: 67 | Train Loss: 0.251 Vali Loss: 3.882 Vali Acc: 0.798 Test Loss: 3.882 Test Acc: 0.798
Validation loss decreased (-0.780312 --> -0.797649).  Saving model ...
Epoch: 8 cost time: 7.686542510986328
Epoch: 8, Steps: 67 | Train Loss: 0.157 Vali Loss: 3.168 Vali Acc: 0.809 Test Loss: 3.168 Test Acc: 0.809
Validation loss decreased (-0.797649 --> -0.809217).  Saving model ...
Epoch: 9 cost time: 7.842729330062866
Epoch: 9, Steps: 67 | Train Loss: 0.360 Vali Loss: 17.151 Vali Acc: 0.624 Test Loss: 17.151 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.726458787918091
Epoch: 10, Steps: 67 | Train Loss: 0.981 Vali Loss: 6.502 Vali Acc: 0.757 Test Loss: 6.502 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.690382242202759
Epoch: 11, Steps: 67 | Train Loss: 0.812 Vali Loss: 9.868 Vali Acc: 0.751 Test Loss: 9.868 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.920540809631348
Epoch: 12, Steps: 67 | Train Loss: 0.986 Vali Loss: 3.741 Vali Acc: 0.786 Test Loss: 3.741 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.943503141403198
Epoch: 13, Steps: 67 | Train Loss: 1.968 Vali Loss: 8.157 Vali Acc: 0.671 Test Loss: 8.157 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.864909648895264
Epoch: 14, Steps: 67 | Train Loss: 0.176 Vali Loss: 41.038 Vali Acc: 0.595 Test Loss: 41.038 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.79365611076355
Epoch: 15, Steps: 67 | Train Loss: 0.509 Vali Loss: 5.741 Vali Acc: 0.815 Test Loss: 5.741 Test Acc: 0.815
Validation loss decreased (-0.809217 --> -0.814971).  Saving model ...
Epoch: 16 cost time: 7.823512554168701
Epoch: 16, Steps: 67 | Train Loss: 0.166 Vali Loss: 6.474 Vali Acc: 0.809 Test Loss: 6.474 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.806014060974121
Epoch: 17, Steps: 67 | Train Loss: 0.165 Vali Loss: 12.458 Vali Acc: 0.728 Test Loss: 12.458 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.945026397705078
Epoch: 18, Steps: 67 | Train Loss: 0.811 Vali Loss: 21.886 Vali Acc: 0.671 Test Loss: 21.886 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.023329973220825
Epoch: 19, Steps: 67 | Train Loss: 0.707 Vali Loss: 28.418 Vali Acc: 0.543 Test Loss: 28.418 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.88380241394043
Epoch: 20, Steps: 67 | Train Loss: 0.093 Vali Loss: 40.213 Vali Acc: 0.624 Test Loss: 40.213 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.848931312561035
Epoch: 21, Steps: 67 | Train Loss: 1.044 Vali Loss: 54.409 Vali Acc: 0.434 Test Loss: 54.409 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.79681396484375
Epoch: 22, Steps: 67 | Train Loss: 0.843 Vali Loss: 75.885 Vali Acc: 0.474 Test Loss: 75.885 Test Acc: 0.474
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.815272331237793
Epoch: 23, Steps: 67 | Train Loss: 1.149 Vali Loss: 14.606 Vali Acc: 0.711 Test Loss: 14.606 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.821414470672607
Epoch: 24, Steps: 67 | Train Loss: 0.058 Vali Loss: 15.045 Vali Acc: 0.769 Test Loss: 15.045 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.7129645347595215
Epoch: 25, Steps: 67 | Train Loss: 0.271 Vali Loss: 29.338 Vali Acc: 0.613 Test Loss: 29.338 Test Acc: 0.613
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 11485063
model size : 46.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.330890893936157
Epoch: 1, Steps: 67 | Train Loss: 17.759 Vali Loss: 6.016 Vali Acc: 0.572 Test Loss: 6.016 Test Acc: 0.572
Validation loss decreased (inf --> -0.572194).  Saving model ...
Epoch: 2 cost time: 6.191269397735596
Epoch: 2, Steps: 67 | Train Loss: 4.008 Vali Loss: 3.853 Vali Acc: 0.757 Test Loss: 3.853 Test Acc: 0.757
Validation loss decreased (-0.572194 --> -0.757187).  Saving model ...
Epoch: 3 cost time: 6.330763101577759
Epoch: 3, Steps: 67 | Train Loss: 0.681 Vali Loss: 2.389 Vali Acc: 0.751 Test Loss: 2.389 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.360610008239746
Epoch: 4, Steps: 67 | Train Loss: 0.127 Vali Loss: 1.650 Vali Acc: 0.838 Test Loss: 1.650 Test Acc: 0.838
Validation loss decreased (-0.757187 --> -0.838134).  Saving model ...
Epoch: 5 cost time: 6.460947751998901
Epoch: 5, Steps: 67 | Train Loss: 0.211 Vali Loss: 4.248 Vali Acc: 0.688 Test Loss: 4.248 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.473221063613892
Epoch: 6, Steps: 67 | Train Loss: 0.100 Vali Loss: 6.569 Vali Acc: 0.676 Test Loss: 6.569 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.484369277954102
Epoch: 7, Steps: 67 | Train Loss: 0.829 Vali Loss: 30.717 Vali Acc: 0.410 Test Loss: 30.717 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.232770204544067
Epoch: 8, Steps: 67 | Train Loss: 1.486 Vali Loss: 4.293 Vali Acc: 0.717 Test Loss: 4.293 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.459127902984619
Epoch: 9, Steps: 67 | Train Loss: 0.700 Vali Loss: 5.138 Vali Acc: 0.786 Test Loss: 5.138 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.4098265171051025
Epoch: 10, Steps: 67 | Train Loss: 0.453 Vali Loss: 19.427 Vali Acc: 0.613 Test Loss: 19.427 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.216641902923584
Epoch: 11, Steps: 67 | Train Loss: 0.357 Vali Loss: 25.955 Vali Acc: 0.561 Test Loss: 25.955 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.2763941287994385
Epoch: 12, Steps: 67 | Train Loss: 0.020 Vali Loss: 6.475 Vali Acc: 0.792 Test Loss: 6.475 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.300513029098511
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.471 Vali Acc: 0.792 Test Loss: 7.471 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.361665725708008
Epoch: 14, Steps: 67 | Train Loss: 0.029 Vali Loss: 9.837 Vali Acc: 0.671 Test Loss: 9.837 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 8034567
model size : 33.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.558511018753052
Epoch: 1, Steps: 67 | Train Loss: 20.081 Vali Loss: 3.571 Vali Acc: 0.659 Test Loss: 3.571 Test Acc: 0.659
Validation loss decreased (inf --> -0.658924).  Saving model ...
Epoch: 2 cost time: 5.251540899276733
Epoch: 2, Steps: 67 | Train Loss: 4.530 Vali Loss: 4.191 Vali Acc: 0.549 Test Loss: 4.191 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.207340955734253
Epoch: 3, Steps: 67 | Train Loss: 0.316 Vali Loss: 1.284 Vali Acc: 0.792 Test Loss: 1.284 Test Acc: 0.792
Validation loss decreased (-0.658924 --> -0.791895).  Saving model ...
Epoch: 4 cost time: 5.260492324829102
Epoch: 4, Steps: 67 | Train Loss: 0.237 Vali Loss: 2.788 Vali Acc: 0.740 Test Loss: 2.788 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.202116012573242
Epoch: 5, Steps: 67 | Train Loss: 0.156 Vali Loss: 3.655 Vali Acc: 0.711 Test Loss: 3.655 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.361464023590088
Epoch: 6, Steps: 67 | Train Loss: 0.221 Vali Loss: 5.425 Vali Acc: 0.728 Test Loss: 5.425 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.38279914855957
Epoch: 7, Steps: 67 | Train Loss: 0.101 Vali Loss: 1.829 Vali Acc: 0.832 Test Loss: 1.829 Test Acc: 0.832
Validation loss decreased (-0.791895 --> -0.832352).  Saving model ...
Epoch: 8 cost time: 5.378972053527832
Epoch: 8, Steps: 67 | Train Loss: 0.251 Vali Loss: 4.781 Vali Acc: 0.665 Test Loss: 4.781 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.440537691116333
Epoch: 9, Steps: 67 | Train Loss: 0.043 Vali Loss: 4.068 Vali Acc: 0.838 Test Loss: 4.068 Test Acc: 0.838
Validation loss decreased (-0.832352 --> -0.838110).  Saving model ...
Epoch: 10 cost time: 5.477635860443115
Epoch: 10, Steps: 67 | Train Loss: 0.399 Vali Loss: 7.300 Vali Acc: 0.711 Test Loss: 7.300 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.37887167930603
Epoch: 11, Steps: 67 | Train Loss: 1.139 Vali Loss: 11.249 Vali Acc: 0.601 Test Loss: 11.249 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.376990556716919
Epoch: 12, Steps: 67 | Train Loss: 2.031 Vali Loss: 43.793 Vali Acc: 0.555 Test Loss: 43.793 Test Acc: 0.555
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.384499549865723
Epoch: 13, Steps: 67 | Train Loss: 0.727 Vali Loss: 106.634 Vali Acc: 0.127 Test Loss: 106.634 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.3578503131866455
Epoch: 14, Steps: 67 | Train Loss: 0.468 Vali Loss: 17.609 Vali Acc: 0.572 Test Loss: 17.609 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.386556625366211
Epoch: 15, Steps: 67 | Train Loss: 0.220 Vali Loss: 16.667 Vali Acc: 0.566 Test Loss: 16.667 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.285851001739502
Epoch: 16, Steps: 67 | Train Loss: 0.387 Vali Loss: 49.495 Vali Acc: 0.434 Test Loss: 49.495 Test Acc: 0.434
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.265798091888428
Epoch: 17, Steps: 67 | Train Loss: 0.113 Vali Loss: 3.856 Vali Acc: 0.798 Test Loss: 3.856 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.367931127548218
Epoch: 18, Steps: 67 | Train Loss: 0.023 Vali Loss: 16.235 Vali Acc: 0.642 Test Loss: 16.235 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.323556900024414
Epoch: 19, Steps: 67 | Train Loss: 0.038 Vali Loss: 13.621 Vali Acc: 0.711 Test Loss: 13.621 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 7172615
model size : 29.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 67.1168900
	speed: 0.3502s/iter; left time: 4657.5338s
Epoch: 1 cost time: 46.72835826873779
Epoch: 1, Steps: 134 | Train Loss: 195.365 Vali Loss: 38.148 Vali Acc: 0.306 Test Loss: 38.148 Test Acc: 0.306
Validation loss decreased (inf --> -0.305977).  Saving model ...
	iters: 100, epoch: 2 | loss: 24.4971962
	speed: 0.7186s/iter; left time: 9461.3924s
Epoch: 2 cost time: 46.25841546058655
Epoch: 2, Steps: 134 | Train Loss: 7.629 Vali Loss: 26.104 Vali Acc: 0.358 Test Loss: 26.104 Test Acc: 0.358
Validation loss decreased (-0.305977 --> -0.358120).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2993060
	speed: 0.7304s/iter; left time: 9518.8521s
Epoch: 3 cost time: 45.92278695106506
Epoch: 3, Steps: 134 | Train Loss: 8.183 Vali Loss: 17.952 Vali Acc: 0.451 Test Loss: 17.952 Test Acc: 0.451
Validation loss decreased (-0.358120 --> -0.450688).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.7403s/iter; left time: 9549.1029s
Epoch: 4 cost time: 46.2398898601532
Epoch: 4, Steps: 134 | Train Loss: 5.982 Vali Loss: 20.474 Vali Acc: 0.561 Test Loss: 20.474 Test Acc: 0.561
Validation loss decreased (-0.450688 --> -0.560489).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7427s/iter; left time: 9481.0044s
Epoch: 5 cost time: 46.36507701873779
Epoch: 5, Steps: 134 | Train Loss: 3.913 Vali Loss: 11.125 Vali Acc: 0.780 Test Loss: 11.125 Test Acc: 0.780
Validation loss decreased (-0.560489 --> -0.780236).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7446s/iter; left time: 9405.1557s
Epoch: 6 cost time: 46.36850547790527
Epoch: 6, Steps: 134 | Train Loss: 4.145 Vali Loss: 38.859 Vali Acc: 0.717 Test Loss: 38.859 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7111s/iter; left time: 8886.6774s
Epoch: 7 cost time: 46.22083282470703
Epoch: 7, Steps: 134 | Train Loss: 5.557 Vali Loss: 41.104 Vali Acc: 0.647 Test Loss: 41.104 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7123s/iter; left time: 8806.4799s
Epoch: 8 cost time: 46.27384281158447
Epoch: 8, Steps: 134 | Train Loss: 2.220 Vali Loss: 33.146 Vali Acc: 0.688 Test Loss: 33.146 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7152s/iter; left time: 8745.8331s
Epoch: 9 cost time: 46.427088260650635
Epoch: 9, Steps: 134 | Train Loss: 3.235 Vali Loss: 29.623 Vali Acc: 0.711 Test Loss: 29.623 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7116s/iter; left time: 8606.7915s
Epoch: 10 cost time: 46.485026359558105
Epoch: 10, Steps: 134 | Train Loss: 4.703 Vali Loss: 30.345 Vali Acc: 0.734 Test Loss: 30.345 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7160s/iter; left time: 8563.5601s
Epoch: 11 cost time: 46.39106845855713
Epoch: 11, Steps: 134 | Train Loss: 0.355 Vali Loss: 32.294 Vali Acc: 0.717 Test Loss: 32.294 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7136s/iter; left time: 8439.4868s
Epoch: 12 cost time: 46.173200368881226
Epoch: 12, Steps: 134 | Train Loss: 0.830 Vali Loss: 41.183 Vali Acc: 0.780 Test Loss: 41.183 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7188s/iter; left time: 8405.0650s
Epoch: 13 cost time: 46.471248626708984
Epoch: 13, Steps: 134 | Train Loss: 1.971 Vali Loss: 56.396 Vali Acc: 0.705 Test Loss: 56.396 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 9.3430977
	speed: 0.7190s/iter; left time: 8310.8459s
Epoch: 14 cost time: 46.117382526397705
Epoch: 14, Steps: 134 | Train Loss: 4.592 Vali Loss: 26.282 Vali Acc: 0.809 Test Loss: 26.282 Test Acc: 0.809
Validation loss decreased (-0.780236 --> -0.808986).  Saving model ...
	iters: 100, epoch: 15 | loss: 33.7789154
	speed: 0.7383s/iter; left time: 8435.0609s
Epoch: 15 cost time: 46.16476893424988
Epoch: 15, Steps: 134 | Train Loss: 4.097 Vali Loss: 67.428 Vali Acc: 0.694 Test Loss: 67.428 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7120s/iter; left time: 8039.5264s
Epoch: 16 cost time: 46.5028293132782
Epoch: 16, Steps: 134 | Train Loss: 5.398 Vali Loss: 83.023 Vali Acc: 0.647 Test Loss: 83.023 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7265s/iter; left time: 8105.8625s
Epoch: 17 cost time: 46.532634258270264
Epoch: 17, Steps: 134 | Train Loss: 1.014 Vali Loss: 93.850 Vali Acc: 0.653 Test Loss: 93.850 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.7224s/iter; left time: 7963.0046s
Epoch: 18 cost time: 46.476733446121216
Epoch: 18, Steps: 134 | Train Loss: 2.831 Vali Loss: 59.706 Vali Acc: 0.746 Test Loss: 59.706 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.7200s/iter; left time: 7839.8442s
Epoch: 19 cost time: 46.493979692459106
Epoch: 19, Steps: 134 | Train Loss: 1.924 Vali Loss: 68.865 Vali Acc: 0.694 Test Loss: 68.865 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.7189s/iter; left time: 7731.7730s
Epoch: 20 cost time: 46.597548723220825
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 73.137 Vali Acc: 0.694 Test Loss: 73.137 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7162s/iter; left time: 7606.2816s
Epoch: 21 cost time: 46.33569145202637
Epoch: 21, Steps: 134 | Train Loss: 0.325 Vali Loss: 201.249 Vali Acc: 0.526 Test Loss: 201.249 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.7179s/iter; left time: 7528.2954s
Epoch: 22 cost time: 46.398914098739624
Epoch: 22, Steps: 134 | Train Loss: 0.000 Vali Loss: 75.782 Vali Acc: 0.711 Test Loss: 75.782 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.7177s/iter; left time: 7430.7678s
Epoch: 23 cost time: 46.29289770126343
Epoch: 23, Steps: 134 | Train Loss: 0.000 Vali Loss: 75.680 Vali Acc: 0.711 Test Loss: 75.680 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.7174s/iter; left time: 7331.2861s
Epoch: 24 cost time: 46.157808780670166
Epoch: 24, Steps: 134 | Train Loss: 0.000 Vali Loss: 75.321 Vali Acc: 0.705 Test Loss: 75.321 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 62324999
model size : 240.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.170088529586792
Epoch: 1, Steps: 67 | Train Loss: 63.424 Vali Loss: 82.558 Vali Acc: 0.468 Test Loss: 82.558 Test Acc: 0.468
Validation loss decreased (inf --> -0.467383).  Saving model ...
Epoch: 2 cost time: 20.787087440490723
Epoch: 2, Steps: 67 | Train Loss: 18.335 Vali Loss: 4.844 Vali Acc: 0.543 Test Loss: 4.844 Test Acc: 0.543
Validation loss decreased (-0.467383 --> -0.543304).  Saving model ...
Epoch: 3 cost time: 21.005420923233032
Epoch: 3, Steps: 67 | Train Loss: 0.821 Vali Loss: 4.170 Vali Acc: 0.671 Test Loss: 4.170 Test Acc: 0.671
Validation loss decreased (-0.543304 --> -0.670479).  Saving model ...
Epoch: 4 cost time: 20.86939573287964
Epoch: 4, Steps: 67 | Train Loss: 0.331 Vali Loss: 5.345 Vali Acc: 0.717 Test Loss: 5.345 Test Acc: 0.717
Validation loss decreased (-0.670479 --> -0.716710).  Saving model ...
Epoch: 5 cost time: 20.80387568473816
Epoch: 5, Steps: 67 | Train Loss: 1.235 Vali Loss: 5.762 Vali Acc: 0.775 Test Loss: 5.762 Test Acc: 0.775
Validation loss decreased (-0.716710 --> -0.774509).  Saving model ...
Epoch: 6 cost time: 20.442684173583984
Epoch: 6, Steps: 67 | Train Loss: 1.731 Vali Loss: 6.295 Vali Acc: 0.769 Test Loss: 6.295 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.762558698654175
Epoch: 7, Steps: 67 | Train Loss: 1.746 Vali Loss: 3.700 Vali Acc: 0.844 Test Loss: 3.700 Test Acc: 0.844
Validation loss decreased (-0.774509 --> -0.843894).  Saving model ...
Epoch: 8 cost time: 20.724567890167236
Epoch: 8, Steps: 67 | Train Loss: 0.884 Vali Loss: 10.816 Vali Acc: 0.728 Test Loss: 10.816 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.97270441055298
Epoch: 9, Steps: 67 | Train Loss: 1.285 Vali Loss: 9.225 Vali Acc: 0.786 Test Loss: 9.225 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 20.912826776504517
Epoch: 10, Steps: 67 | Train Loss: 1.355 Vali Loss: 13.110 Vali Acc: 0.751 Test Loss: 13.110 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.92993402481079
Epoch: 11, Steps: 67 | Train Loss: 3.741 Vali Loss: 16.856 Vali Acc: 0.647 Test Loss: 16.856 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.90376329421997
Epoch: 12, Steps: 67 | Train Loss: 0.576 Vali Loss: 32.749 Vali Acc: 0.636 Test Loss: 32.749 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.92318320274353
Epoch: 13, Steps: 67 | Train Loss: 1.606 Vali Loss: 10.269 Vali Acc: 0.751 Test Loss: 10.269 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 21.004950523376465
Epoch: 14, Steps: 67 | Train Loss: 0.553 Vali Loss: 7.295 Vali Acc: 0.815 Test Loss: 7.295 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.814008712768555
Epoch: 15, Steps: 67 | Train Loss: 0.440 Vali Loss: 27.839 Vali Acc: 0.699 Test Loss: 27.839 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 20.933473110198975
Epoch: 16, Steps: 67 | Train Loss: 0.198 Vali Loss: 13.937 Vali Acc: 0.740 Test Loss: 13.937 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 20.90600824356079
Epoch: 17, Steps: 67 | Train Loss: 0.210 Vali Loss: 73.723 Vali Acc: 0.566 Test Loss: 73.723 Test Acc: 0.566
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 31262983
model size : 121.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.411494970321655
Epoch: 1, Steps: 67 | Train Loss: 44.009 Vali Loss: 49.517 Vali Acc: 0.335 Test Loss: 49.517 Test Acc: 0.335
Validation loss decreased (inf --> -0.334765).  Saving model ...
Epoch: 2 cost time: 11.03867220878601
Epoch: 2, Steps: 67 | Train Loss: 19.436 Vali Loss: 4.125 Vali Acc: 0.590 Test Loss: 4.125 Test Acc: 0.590
Validation loss decreased (-0.334765 --> -0.589554).  Saving model ...
Epoch: 3 cost time: 11.472294807434082
Epoch: 3, Steps: 67 | Train Loss: 0.786 Vali Loss: 1.860 Vali Acc: 0.740 Test Loss: 1.860 Test Acc: 0.740
Validation loss decreased (-0.589554 --> -0.739866).  Saving model ...
Epoch: 4 cost time: 11.331939697265625
Epoch: 4, Steps: 67 | Train Loss: 1.093 Vali Loss: 3.924 Vali Acc: 0.705 Test Loss: 3.924 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.47773790359497
Epoch: 5, Steps: 67 | Train Loss: 0.279 Vali Loss: 3.701 Vali Acc: 0.780 Test Loss: 3.701 Test Acc: 0.780
Validation loss decreased (-0.739866 --> -0.780310).  Saving model ...
Epoch: 6 cost time: 11.273415327072144
Epoch: 6, Steps: 67 | Train Loss: 0.383 Vali Loss: 8.698 Vali Acc: 0.728 Test Loss: 8.698 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.300512552261353
Epoch: 7, Steps: 67 | Train Loss: 0.329 Vali Loss: 11.739 Vali Acc: 0.694 Test Loss: 11.739 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.373634576797485
Epoch: 8, Steps: 67 | Train Loss: 0.745 Vali Loss: 7.942 Vali Acc: 0.688 Test Loss: 7.942 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.440941333770752
Epoch: 9, Steps: 67 | Train Loss: 0.332 Vali Loss: 13.980 Vali Acc: 0.688 Test Loss: 13.980 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.390167713165283
Epoch: 10, Steps: 67 | Train Loss: 0.381 Vali Loss: 7.002 Vali Acc: 0.740 Test Loss: 7.002 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.464463949203491
Epoch: 11, Steps: 67 | Train Loss: 0.801 Vali Loss: 4.196 Vali Acc: 0.821 Test Loss: 4.196 Test Acc: 0.821
Validation loss decreased (-0.780310 --> -0.820767).  Saving model ...
Epoch: 12 cost time: 11.481611967086792
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 10.895 Vali Acc: 0.809 Test Loss: 10.895 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.485386610031128
Epoch: 13, Steps: 67 | Train Loss: 0.230 Vali Loss: 6.404 Vali Acc: 0.780 Test Loss: 6.404 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.334071397781372
Epoch: 14, Steps: 67 | Train Loss: 0.092 Vali Loss: 7.282 Vali Acc: 0.780 Test Loss: 7.282 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.459307432174683
Epoch: 15, Steps: 67 | Train Loss: 1.650 Vali Loss: 17.366 Vali Acc: 0.659 Test Loss: 17.366 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 11.397702932357788
Epoch: 16, Steps: 67 | Train Loss: 4.493 Vali Loss: 5.664 Vali Acc: 0.803 Test Loss: 5.664 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 11.331589698791504
Epoch: 17, Steps: 67 | Train Loss: 2.125 Vali Loss: 16.178 Vali Acc: 0.688 Test Loss: 16.178 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 11.412537336349487
Epoch: 18, Steps: 67 | Train Loss: 1.118 Vali Loss: 18.864 Vali Acc: 0.676 Test Loss: 18.864 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 11.5577712059021
Epoch: 19, Steps: 67 | Train Loss: 1.840 Vali Loss: 15.615 Vali Acc: 0.786 Test Loss: 15.615 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.573744297027588
Epoch: 20, Steps: 67 | Train Loss: 3.858 Vali Loss: 20.115 Vali Acc: 0.769 Test Loss: 20.115 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 11.48825192451477
Epoch: 21, Steps: 67 | Train Loss: 1.750 Vali Loss: 34.518 Vali Acc: 0.636 Test Loss: 34.518 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 20909191
model size : 82.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.82960844039917
Epoch: 1, Steps: 67 | Train Loss: 24.045 Vali Loss: 6.834 Vali Acc: 0.647 Test Loss: 6.834 Test Acc: 0.647
Validation loss decreased (inf --> -0.647331).  Saving model ...
Epoch: 2 cost time: 9.417264699935913
Epoch: 2, Steps: 67 | Train Loss: 13.462 Vali Loss: 5.122 Vali Acc: 0.740 Test Loss: 5.122 Test Acc: 0.740
Validation loss decreased (-0.647331 --> -0.739833).  Saving model ...
Epoch: 3 cost time: 9.919913530349731
Epoch: 3, Steps: 67 | Train Loss: 0.823 Vali Loss: 2.062 Vali Acc: 0.769 Test Loss: 2.062 Test Acc: 0.769
Validation loss decreased (-0.739833 --> -0.768766).  Saving model ...
Epoch: 4 cost time: 9.738189220428467
Epoch: 4, Steps: 67 | Train Loss: 0.369 Vali Loss: 1.847 Vali Acc: 0.786 Test Loss: 1.847 Test Acc: 0.786
Validation loss decreased (-0.768766 --> -0.786109).  Saving model ...
Epoch: 5 cost time: 9.657470464706421
Epoch: 5, Steps: 67 | Train Loss: 0.189 Vali Loss: 2.208 Vali Acc: 0.792 Test Loss: 2.208 Test Acc: 0.792
Validation loss decreased (-0.786109 --> -0.791885).  Saving model ...
Epoch: 6 cost time: 9.75112771987915
Epoch: 6, Steps: 67 | Train Loss: 0.523 Vali Loss: 5.147 Vali Acc: 0.740 Test Loss: 5.147 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.75899338722229
Epoch: 7, Steps: 67 | Train Loss: 0.163 Vali Loss: 6.974 Vali Acc: 0.740 Test Loss: 6.974 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.776236295700073
Epoch: 8, Steps: 67 | Train Loss: 0.248 Vali Loss: 11.811 Vali Acc: 0.584 Test Loss: 11.811 Test Acc: 0.584
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.593418598175049
Epoch: 9, Steps: 67 | Train Loss: 1.807 Vali Loss: 9.849 Vali Acc: 0.578 Test Loss: 9.849 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.649251222610474
Epoch: 10, Steps: 67 | Train Loss: 0.729 Vali Loss: 9.685 Vali Acc: 0.786 Test Loss: 9.685 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.696843385696411
Epoch: 11, Steps: 67 | Train Loss: 1.425 Vali Loss: 10.327 Vali Acc: 0.780 Test Loss: 10.327 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.646735668182373
Epoch: 12, Steps: 67 | Train Loss: 0.470 Vali Loss: 9.869 Vali Acc: 0.798 Test Loss: 9.869 Test Acc: 0.798
Validation loss decreased (-0.791885 --> -0.797589).  Saving model ...
Epoch: 13 cost time: 9.643181324005127
Epoch: 13, Steps: 67 | Train Loss: 0.519 Vali Loss: 10.367 Vali Acc: 0.809 Test Loss: 10.367 Test Acc: 0.809
Validation loss decreased (-0.797589 --> -0.809145).  Saving model ...
Epoch: 14 cost time: 9.74595022201538
Epoch: 14, Steps: 67 | Train Loss: 0.435 Vali Loss: 8.601 Vali Acc: 0.763 Test Loss: 8.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.7241370677948
Epoch: 15, Steps: 67 | Train Loss: 0.674 Vali Loss: 10.625 Vali Acc: 0.740 Test Loss: 10.625 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.750800371170044
Epoch: 16, Steps: 67 | Train Loss: 1.018 Vali Loss: 21.867 Vali Acc: 0.786 Test Loss: 21.867 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.758269548416138
Epoch: 17, Steps: 67 | Train Loss: 1.716 Vali Loss: 17.586 Vali Acc: 0.728 Test Loss: 17.586 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.677273273468018
Epoch: 18, Steps: 67 | Train Loss: 0.532 Vali Loss: 10.631 Vali Acc: 0.751 Test Loss: 10.631 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.63261890411377
Epoch: 19, Steps: 67 | Train Loss: 0.436 Vali Loss: 17.021 Vali Acc: 0.688 Test Loss: 17.021 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.872354984283447
Epoch: 20, Steps: 67 | Train Loss: 0.321 Vali Loss: 43.940 Vali Acc: 0.647 Test Loss: 43.940 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.755276441574097
Epoch: 21, Steps: 67 | Train Loss: 1.624 Vali Loss: 18.947 Vali Acc: 0.769 Test Loss: 18.947 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.7388756275177
Epoch: 22, Steps: 67 | Train Loss: 0.172 Vali Loss: 20.395 Vali Acc: 0.751 Test Loss: 20.395 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.820325374603271
Epoch: 23, Steps: 67 | Train Loss: 1.024 Vali Loss: 28.560 Vali Acc: 0.676 Test Loss: 28.560 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 15732615
model size : 62.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.801017045974731
Epoch: 1, Steps: 67 | Train Loss: 25.510 Vali Loss: 26.520 Vali Acc: 0.457 Test Loss: 26.520 Test Acc: 0.457
Validation loss decreased (inf --> -0.456382).  Saving model ...
Epoch: 2 cost time: 7.349369764328003
Epoch: 2, Steps: 67 | Train Loss: 4.144 Vali Loss: 6.347 Vali Acc: 0.578 Test Loss: 6.347 Test Acc: 0.578
Validation loss decreased (-0.456382 --> -0.577971).  Saving model ...
Epoch: 3 cost time: 7.262460947036743
Epoch: 3, Steps: 67 | Train Loss: 0.592 Vali Loss: 2.083 Vali Acc: 0.734 Test Loss: 2.083 Test Acc: 0.734
Validation loss decreased (-0.577971 --> -0.734083).  Saving model ...
Epoch: 4 cost time: 7.378937005996704
Epoch: 4, Steps: 67 | Train Loss: 0.447 Vali Loss: 1.668 Vali Acc: 0.769 Test Loss: 1.668 Test Acc: 0.769
Validation loss decreased (-0.734083 --> -0.768769).  Saving model ...
Epoch: 5 cost time: 7.433026075363159
Epoch: 5, Steps: 67 | Train Loss: 0.147 Vali Loss: 8.589 Vali Acc: 0.653 Test Loss: 8.589 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.534088850021362
Epoch: 6, Steps: 67 | Train Loss: 0.710 Vali Loss: 2.754 Vali Acc: 0.821 Test Loss: 2.754 Test Acc: 0.821
Validation loss decreased (-0.768769 --> -0.820782).  Saving model ...
Epoch: 7 cost time: 7.445751428604126
Epoch: 7, Steps: 67 | Train Loss: 0.709 Vali Loss: 4.870 Vali Acc: 0.723 Test Loss: 4.870 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.579257488250732
Epoch: 8, Steps: 67 | Train Loss: 0.743 Vali Loss: 1.688 Vali Acc: 0.867 Test Loss: 1.688 Test Acc: 0.867
Validation loss decreased (-0.820782 --> -0.867035).  Saving model ...
Epoch: 9 cost time: 7.465038061141968
Epoch: 9, Steps: 67 | Train Loss: 0.458 Vali Loss: 9.196 Vali Acc: 0.723 Test Loss: 9.196 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.255029201507568
Epoch: 10, Steps: 67 | Train Loss: 1.102 Vali Loss: 6.011 Vali Acc: 0.728 Test Loss: 6.011 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.239223480224609
Epoch: 11, Steps: 67 | Train Loss: 0.413 Vali Loss: 11.750 Vali Acc: 0.717 Test Loss: 11.750 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.268887519836426
Epoch: 12, Steps: 67 | Train Loss: 0.304 Vali Loss: 8.278 Vali Acc: 0.803 Test Loss: 8.278 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.4725542068481445
Epoch: 13, Steps: 67 | Train Loss: 0.345 Vali Loss: 5.252 Vali Acc: 0.798 Test Loss: 5.252 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.571006774902344
Epoch: 14, Steps: 67 | Train Loss: 2.489 Vali Loss: 6.543 Vali Acc: 0.705 Test Loss: 6.543 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.327762126922607
Epoch: 15, Steps: 67 | Train Loss: 0.361 Vali Loss: 13.901 Vali Acc: 0.723 Test Loss: 13.901 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.3448896408081055
Epoch: 16, Steps: 67 | Train Loss: 0.934 Vali Loss: 3.961 Vali Acc: 0.832 Test Loss: 3.961 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.466346740722656
Epoch: 17, Steps: 67 | Train Loss: 0.111 Vali Loss: 6.556 Vali Acc: 0.769 Test Loss: 6.556 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.294984340667725
Epoch: 18, Steps: 67 | Train Loss: 0.450 Vali Loss: 5.945 Vali Acc: 0.792 Test Loss: 5.945 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 11419271
model size : 46.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.063907146453857
Epoch: 1, Steps: 67 | Train Loss: 16.719 Vali Loss: 12.455 Vali Acc: 0.514 Test Loss: 12.455 Test Acc: 0.514
Validation loss decreased (inf --> -0.514326).  Saving model ...
Epoch: 2 cost time: 5.616105318069458
Epoch: 2, Steps: 67 | Train Loss: 6.852 Vali Loss: 3.811 Vali Acc: 0.578 Test Loss: 3.811 Test Acc: 0.578
Validation loss decreased (-0.514326 --> -0.577997).  Saving model ...
Epoch: 3 cost time: 5.608150243759155
Epoch: 3, Steps: 67 | Train Loss: 0.332 Vali Loss: 3.180 Vali Acc: 0.711 Test Loss: 3.180 Test Acc: 0.711
Validation loss decreased (-0.577997 --> -0.710951).  Saving model ...
Epoch: 4 cost time: 5.692546606063843
Epoch: 4, Steps: 67 | Train Loss: 0.405 Vali Loss: 5.726 Vali Acc: 0.676 Test Loss: 5.726 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.585789203643799
Epoch: 5, Steps: 67 | Train Loss: 0.293 Vali Loss: 1.546 Vali Acc: 0.827 Test Loss: 1.546 Test Acc: 0.827
Validation loss decreased (-0.710951 --> -0.826574).  Saving model ...
Epoch: 6 cost time: 5.687981843948364
Epoch: 6, Steps: 67 | Train Loss: 0.294 Vali Loss: 5.420 Vali Acc: 0.769 Test Loss: 5.420 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.7004454135894775
Epoch: 7, Steps: 67 | Train Loss: 0.657 Vali Loss: 9.723 Vali Acc: 0.723 Test Loss: 9.723 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.579843282699585
Epoch: 8, Steps: 67 | Train Loss: 0.384 Vali Loss: 4.085 Vali Acc: 0.786 Test Loss: 4.085 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.675002098083496
Epoch: 9, Steps: 67 | Train Loss: 0.090 Vali Loss: 4.640 Vali Acc: 0.786 Test Loss: 4.640 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.571518421173096
Epoch: 10, Steps: 67 | Train Loss: 0.035 Vali Loss: 7.956 Vali Acc: 0.723 Test Loss: 7.956 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.647636890411377
Epoch: 11, Steps: 67 | Train Loss: 0.406 Vali Loss: 5.658 Vali Acc: 0.792 Test Loss: 5.658 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.614459753036499
Epoch: 12, Steps: 67 | Train Loss: 0.338 Vali Loss: 8.558 Vali Acc: 0.723 Test Loss: 8.558 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.660147666931152
Epoch: 13, Steps: 67 | Train Loss: 0.906 Vali Loss: 56.152 Vali Acc: 0.486 Test Loss: 56.152 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.635882616043091
Epoch: 14, Steps: 67 | Train Loss: 0.663 Vali Loss: 28.684 Vali Acc: 0.480 Test Loss: 28.684 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.7388200759887695
Epoch: 15, Steps: 67 | Train Loss: 0.083 Vali Loss: 21.343 Vali Acc: 0.584 Test Loss: 21.343 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7968775
model size : 32.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.282139301300049
Epoch: 1, Steps: 67 | Train Loss: 15.563 Vali Loss: 28.537 Vali Acc: 0.451 Test Loss: 28.537 Test Acc: 0.451
Validation loss decreased (inf --> -0.450582).  Saving model ...
Epoch: 2 cost time: 4.8548712730407715
Epoch: 2, Steps: 67 | Train Loss: 5.068 Vali Loss: 5.248 Vali Acc: 0.618 Test Loss: 5.248 Test Acc: 0.618
Validation loss decreased (-0.450582 --> -0.618445).  Saving model ...
Epoch: 3 cost time: 4.956857919692993
Epoch: 3, Steps: 67 | Train Loss: 0.141 Vali Loss: 1.620 Vali Acc: 0.763 Test Loss: 1.620 Test Acc: 0.763
Validation loss decreased (-0.618445 --> -0.762990).  Saving model ...
Epoch: 4 cost time: 4.82383394241333
Epoch: 4, Steps: 67 | Train Loss: 0.288 Vali Loss: 2.100 Vali Acc: 0.780 Test Loss: 2.100 Test Acc: 0.780
Validation loss decreased (-0.762990 --> -0.780326).  Saving model ...
Epoch: 5 cost time: 4.8936591148376465
Epoch: 5, Steps: 67 | Train Loss: 0.586 Vali Loss: 7.142 Vali Acc: 0.601 Test Loss: 7.142 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.889729738235474
Epoch: 6, Steps: 67 | Train Loss: 0.383 Vali Loss: 1.506 Vali Acc: 0.809 Test Loss: 1.506 Test Acc: 0.809
Validation loss decreased (-0.780326 --> -0.809233).  Saving model ...
Epoch: 7 cost time: 5.059280157089233
Epoch: 7, Steps: 67 | Train Loss: 0.073 Vali Loss: 2.113 Vali Acc: 0.763 Test Loss: 2.113 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.966195821762085
Epoch: 8, Steps: 67 | Train Loss: 0.131 Vali Loss: 7.099 Vali Acc: 0.653 Test Loss: 7.099 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.967815637588501
Epoch: 9, Steps: 67 | Train Loss: 0.532 Vali Loss: 5.212 Vali Acc: 0.815 Test Loss: 5.212 Test Acc: 0.815
Validation loss decreased (-0.809233 --> -0.814977).  Saving model ...
Epoch: 10 cost time: 5.067584753036499
Epoch: 10, Steps: 67 | Train Loss: 0.243 Vali Loss: 6.840 Vali Acc: 0.803 Test Loss: 6.840 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.922943353652954
Epoch: 11, Steps: 67 | Train Loss: 1.085 Vali Loss: 7.835 Vali Acc: 0.734 Test Loss: 7.835 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.950430631637573
Epoch: 12, Steps: 67 | Train Loss: 0.305 Vali Loss: 8.699 Vali Acc: 0.728 Test Loss: 8.699 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.998079061508179
Epoch: 13, Steps: 67 | Train Loss: 0.459 Vali Loss: 11.968 Vali Acc: 0.763 Test Loss: 11.968 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.939711332321167
Epoch: 14, Steps: 67 | Train Loss: 0.792 Vali Loss: 4.721 Vali Acc: 0.763 Test Loss: 4.721 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.9665539264678955
Epoch: 15, Steps: 67 | Train Loss: 0.086 Vali Loss: 6.529 Vali Acc: 0.809 Test Loss: 6.529 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.025770902633667
Epoch: 16, Steps: 67 | Train Loss: 0.044 Vali Loss: 6.837 Vali Acc: 0.792 Test Loss: 6.837 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.8670971393585205
Epoch: 17, Steps: 67 | Train Loss: 0.214 Vali Loss: 8.585 Vali Acc: 0.786 Test Loss: 8.585 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.81938624382019
Epoch: 18, Steps: 67 | Train Loss: 0.163 Vali Loss: 20.517 Vali Acc: 0.740 Test Loss: 20.517 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.916857004165649
Epoch: 19, Steps: 67 | Train Loss: 0.131 Vali Loss: 4.708 Vali Acc: 0.827 Test Loss: 4.708 Test Acc: 0.827
Validation loss decreased (-0.814977 --> -0.826543).  Saving model ...
Epoch: 20 cost time: 4.926926612854004
Epoch: 20, Steps: 67 | Train Loss: 0.277 Vali Loss: 6.656 Vali Acc: 0.769 Test Loss: 6.656 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.945925951004028
Epoch: 21, Steps: 67 | Train Loss: 0.110 Vali Loss: 15.580 Vali Acc: 0.717 Test Loss: 15.580 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.833181381225586
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 23.575 Vali Acc: 0.746 Test Loss: 23.575 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.941807508468628
Epoch: 23, Steps: 67 | Train Loss: 0.745 Vali Loss: 52.162 Vali Acc: 0.462 Test Loss: 52.162 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.934396266937256
Epoch: 24, Steps: 67 | Train Loss: 1.563 Vali Loss: 318.326 Vali Acc: 0.173 Test Loss: 318.326 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.902756452560425
Epoch: 25, Steps: 67 | Train Loss: 0.954 Vali Loss: 65.692 Vali Acc: 0.422 Test Loss: 65.692 Test Acc: 0.422
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.054296016693115
Epoch: 26, Steps: 67 | Train Loss: 1.287 Vali Loss: 194.638 Vali Acc: 0.283 Test Loss: 194.638 Test Acc: 0.283
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.021258592605591
Epoch: 27, Steps: 67 | Train Loss: 1.454 Vali Loss: 67.828 Vali Acc: 0.214 Test Loss: 67.828 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.953815698623657
Epoch: 28, Steps: 67 | Train Loss: 0.315 Vali Loss: 24.388 Vali Acc: 0.694 Test Loss: 24.388 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.895902395248413
Epoch: 29, Steps: 67 | Train Loss: 0.580 Vali Loss: 16.529 Vali Acc: 0.717 Test Loss: 16.529 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7106823
model size : 29.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 50.1038971
	speed: 0.3302s/iter; left time: 4392.0117s
Epoch: 1 cost time: 43.98544692993164
Epoch: 1, Steps: 134 | Train Loss: 158.601 Vali Loss: 26.574 Vali Acc: 0.451 Test Loss: 26.574 Test Acc: 0.451
Validation loss decreased (inf --> -0.450601).  Saving model ...
	iters: 100, epoch: 2 | loss: 18.7589302
	speed: 0.6940s/iter; left time: 9137.5892s
Epoch: 2 cost time: 43.37553310394287
Epoch: 2, Steps: 134 | Train Loss: 8.555 Vali Loss: 12.191 Vali Acc: 0.555 Test Loss: 12.191 Test Acc: 0.555
Validation loss decreased (-0.450601 --> -0.554791).  Saving model ...
	iters: 100, epoch: 3 | loss: 9.7736435
	speed: 0.6809s/iter; left time: 8874.6927s
Epoch: 3 cost time: 42.68254494667053
Epoch: 3, Steps: 134 | Train Loss: 7.713 Vali Loss: 19.162 Vali Acc: 0.584 Test Loss: 19.162 Test Acc: 0.584
Validation loss decreased (-0.554791 --> -0.583623).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.6871s/iter; left time: 8862.6087s
Epoch: 4 cost time: 43.28250026702881
Epoch: 4, Steps: 134 | Train Loss: 6.672 Vali Loss: 20.363 Vali Acc: 0.618 Test Loss: 20.363 Test Acc: 0.618
Validation loss decreased (-0.583623 --> -0.618293).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.6983s/iter; left time: 8913.8498s
Epoch: 5 cost time: 42.85101795196533
Epoch: 5, Steps: 134 | Train Loss: 6.477 Vali Loss: 26.790 Vali Acc: 0.682 Test Loss: 26.790 Test Acc: 0.682
Validation loss decreased (-0.618293 --> -0.681813).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7044s/iter; left time: 8897.0395s
Epoch: 6 cost time: 42.8958580493927
Epoch: 6, Steps: 134 | Train Loss: 5.055 Vali Loss: 20.035 Vali Acc: 0.676 Test Loss: 20.035 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 14.8857574
	speed: 0.6761s/iter; left time: 8449.2913s
Epoch: 7 cost time: 43.049960136413574
Epoch: 7, Steps: 134 | Train Loss: 4.720 Vali Loss: 15.777 Vali Acc: 0.786 Test Loss: 15.777 Test Acc: 0.786
Validation loss decreased (-0.681813 --> -0.785969).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7074s/iter; left time: 8745.0805s
Epoch: 8 cost time: 42.990519523620605
Epoch: 8, Steps: 134 | Train Loss: 2.476 Vali Loss: 17.796 Vali Acc: 0.711 Test Loss: 17.796 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 19.7508240
	speed: 0.6768s/iter; left time: 8276.6439s
Epoch: 9 cost time: 42.973384380340576
Epoch: 9, Steps: 134 | Train Loss: 2.263 Vali Loss: 21.710 Vali Acc: 0.665 Test Loss: 21.710 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.6824s/iter; left time: 8253.1939s
Epoch: 10 cost time: 43.13403344154358
Epoch: 10, Steps: 134 | Train Loss: 5.949 Vali Loss: 39.101 Vali Acc: 0.555 Test Loss: 39.101 Test Acc: 0.555
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6756s/iter; left time: 8080.9306s
Epoch: 11 cost time: 42.95965242385864
Epoch: 11, Steps: 134 | Train Loss: 2.055 Vali Loss: 32.817 Vali Acc: 0.769 Test Loss: 32.817 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6757s/iter; left time: 7991.1519s
Epoch: 12 cost time: 42.78585910797119
Epoch: 12, Steps: 134 | Train Loss: 0.632 Vali Loss: 30.317 Vali Acc: 0.792 Test Loss: 30.317 Test Acc: 0.792
Validation loss decreased (-0.785969 --> -0.791604).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.6983s/iter; left time: 8165.2671s
Epoch: 13 cost time: 43.01172471046448
Epoch: 13, Steps: 134 | Train Loss: 3.782 Vali Loss: 102.518 Vali Acc: 0.671 Test Loss: 102.518 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6752s/iter; left time: 7805.0852s
Epoch: 14 cost time: 43.14424753189087
Epoch: 14, Steps: 134 | Train Loss: 2.142 Vali Loss: 33.040 Vali Acc: 0.775 Test Loss: 33.040 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.6817s/iter; left time: 7788.7125s
Epoch: 15 cost time: 43.0497088432312
Epoch: 15, Steps: 134 | Train Loss: 1.567 Vali Loss: 22.275 Vali Acc: 0.751 Test Loss: 22.275 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.6737s/iter; left time: 7606.5184s
Epoch: 16 cost time: 42.992335081100464
Epoch: 16, Steps: 134 | Train Loss: 11.764 Vali Loss: 94.079 Vali Acc: 0.601 Test Loss: 94.079 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 14.2976685
	speed: 0.6748s/iter; left time: 7528.8496s
Epoch: 17 cost time: 43.009294509887695
Epoch: 17, Steps: 134 | Train Loss: 7.017 Vali Loss: 40.577 Vali Acc: 0.717 Test Loss: 40.577 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.6758s/iter; left time: 7449.7605s
Epoch: 18 cost time: 43.14265751838684
Epoch: 18, Steps: 134 | Train Loss: 3.732 Vali Loss: 68.159 Vali Acc: 0.682 Test Loss: 68.159 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.6730s/iter; left time: 7328.5755s
Epoch: 19 cost time: 42.901691198349
Epoch: 19, Steps: 134 | Train Loss: 0.553 Vali Loss: 98.039 Vali Acc: 0.688 Test Loss: 98.039 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.6737s/iter; left time: 7245.2672s
Epoch: 20 cost time: 42.76911735534668
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 97.996 Vali Acc: 0.688 Test Loss: 97.996 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.6761s/iter; left time: 7180.5785s
Epoch: 21 cost time: 42.687946796417236
Epoch: 21, Steps: 134 | Train Loss: 0.818 Vali Loss: 75.113 Vali Acc: 0.688 Test Loss: 75.113 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.6735s/iter; left time: 7063.2091s
Epoch: 22 cost time: 42.92247128486633
Epoch: 22, Steps: 134 | Train Loss: 6.614 Vali Loss: 93.148 Vali Acc: 0.671 Test Loss: 93.148 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 62292103
model size : 240.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.577799320220947
Epoch: 1, Steps: 67 | Train Loss: 79.342 Vali Loss: 87.378 Vali Acc: 0.480 Test Loss: 87.378 Test Acc: 0.480
Validation loss decreased (inf --> -0.478895).  Saving model ...
Epoch: 2 cost time: 17.72434687614441
Epoch: 2, Steps: 67 | Train Loss: 18.780 Vali Loss: 3.098 Vali Acc: 0.630 Test Loss: 3.098 Test Acc: 0.630
Validation loss decreased (-0.478895 --> -0.630027).  Saving model ...
Epoch: 3 cost time: 17.952231407165527
Epoch: 3, Steps: 67 | Train Loss: 1.594 Vali Loss: 11.546 Vali Acc: 0.497 Test Loss: 11.546 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.87081789970398
Epoch: 4, Steps: 67 | Train Loss: 1.695 Vali Loss: 5.678 Vali Acc: 0.671 Test Loss: 5.678 Test Acc: 0.671
Validation loss decreased (-0.630027 --> -0.670463).  Saving model ...
Epoch: 5 cost time: 17.975128889083862
Epoch: 5, Steps: 67 | Train Loss: 1.960 Vali Loss: 9.424 Vali Acc: 0.809 Test Loss: 9.424 Test Acc: 0.809
Validation loss decreased (-0.670463 --> -0.809154).  Saving model ...
Epoch: 6 cost time: 17.96345567703247
Epoch: 6, Steps: 67 | Train Loss: 1.691 Vali Loss: 13.476 Vali Acc: 0.734 Test Loss: 13.476 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.81553316116333
Epoch: 7, Steps: 67 | Train Loss: 0.804 Vali Loss: 14.669 Vali Acc: 0.607 Test Loss: 14.669 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 17.731147527694702
Epoch: 8, Steps: 67 | Train Loss: 1.321 Vali Loss: 8.029 Vali Acc: 0.734 Test Loss: 8.029 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 17.805688858032227
Epoch: 9, Steps: 67 | Train Loss: 0.886 Vali Loss: 10.945 Vali Acc: 0.751 Test Loss: 10.945 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 17.84357213973999
Epoch: 10, Steps: 67 | Train Loss: 1.575 Vali Loss: 24.213 Vali Acc: 0.584 Test Loss: 24.213 Test Acc: 0.584
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.801897287368774
Epoch: 11, Steps: 67 | Train Loss: 0.762 Vali Loss: 10.733 Vali Acc: 0.746 Test Loss: 10.733 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 17.83557677268982
Epoch: 12, Steps: 67 | Train Loss: 0.570 Vali Loss: 10.332 Vali Acc: 0.792 Test Loss: 10.332 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 17.571664333343506
Epoch: 13, Steps: 67 | Train Loss: 0.752 Vali Loss: 5.862 Vali Acc: 0.786 Test Loss: 5.862 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.862255811691284
Epoch: 14, Steps: 67 | Train Loss: 1.773 Vali Loss: 12.696 Vali Acc: 0.653 Test Loss: 12.696 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 17.813952684402466
Epoch: 15, Steps: 67 | Train Loss: 1.224 Vali Loss: 18.308 Vali Acc: 0.751 Test Loss: 18.308 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 31230087
model size : 121.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.000263452529907
Epoch: 1, Steps: 67 | Train Loss: 43.293 Vali Loss: 56.824 Vali Acc: 0.451 Test Loss: 56.824 Test Acc: 0.451
Validation loss decreased (inf --> -0.450299).  Saving model ...
Epoch: 2 cost time: 10.760607481002808
Epoch: 2, Steps: 67 | Train Loss: 15.380 Vali Loss: 2.635 Vali Acc: 0.711 Test Loss: 2.635 Test Acc: 0.711
Validation loss decreased (-0.450299 --> -0.710956).  Saving model ...
Epoch: 3 cost time: 10.799408435821533
Epoch: 3, Steps: 67 | Train Loss: 0.547 Vali Loss: 3.467 Vali Acc: 0.734 Test Loss: 3.467 Test Acc: 0.734
Validation loss decreased (-0.710956 --> -0.734069).  Saving model ...
Epoch: 4 cost time: 10.964211463928223
Epoch: 4, Steps: 67 | Train Loss: 1.306 Vali Loss: 3.281 Vali Acc: 0.780 Test Loss: 3.281 Test Acc: 0.780
Validation loss decreased (-0.734069 --> -0.780314).  Saving model ...
Epoch: 5 cost time: 10.74470043182373
Epoch: 5, Steps: 67 | Train Loss: 0.499 Vali Loss: 13.847 Vali Acc: 0.613 Test Loss: 13.847 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.97734022140503
Epoch: 6, Steps: 67 | Train Loss: 1.295 Vali Loss: 7.090 Vali Acc: 0.734 Test Loss: 7.090 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.07030463218689
Epoch: 7, Steps: 67 | Train Loss: 0.996 Vali Loss: 8.939 Vali Acc: 0.775 Test Loss: 8.939 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.918381929397583
Epoch: 8, Steps: 67 | Train Loss: 0.693 Vali Loss: 16.208 Vali Acc: 0.723 Test Loss: 16.208 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.849338293075562
Epoch: 9, Steps: 67 | Train Loss: 0.574 Vali Loss: 8.723 Vali Acc: 0.723 Test Loss: 8.723 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.921384572982788
Epoch: 10, Steps: 67 | Train Loss: 1.751 Vali Loss: 11.985 Vali Acc: 0.746 Test Loss: 11.985 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.821022748947144
Epoch: 11, Steps: 67 | Train Loss: 1.711 Vali Loss: 24.791 Vali Acc: 0.665 Test Loss: 24.791 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.898261547088623
Epoch: 12, Steps: 67 | Train Loss: 0.521 Vali Loss: 4.396 Vali Acc: 0.798 Test Loss: 4.396 Test Acc: 0.798
Validation loss decreased (-0.780314 --> -0.797644).  Saving model ...
Epoch: 13 cost time: 10.855870723724365
Epoch: 13, Steps: 67 | Train Loss: 2.066 Vali Loss: 11.322 Vali Acc: 0.711 Test Loss: 11.322 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.794272422790527
Epoch: 14, Steps: 67 | Train Loss: 2.614 Vali Loss: 10.514 Vali Acc: 0.763 Test Loss: 10.514 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.780434131622314
Epoch: 15, Steps: 67 | Train Loss: 0.041 Vali Loss: 19.996 Vali Acc: 0.769 Test Loss: 19.996 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.001552104949951
Epoch: 16, Steps: 67 | Train Loss: 0.563 Vali Loss: 14.659 Vali Acc: 0.740 Test Loss: 14.659 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.177378177642822
Epoch: 17, Steps: 67 | Train Loss: 1.025 Vali Loss: 20.438 Vali Acc: 0.757 Test Loss: 20.438 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.823952674865723
Epoch: 18, Steps: 67 | Train Loss: 0.622 Vali Loss: 24.047 Vali Acc: 0.618 Test Loss: 24.047 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.955646276473999
Epoch: 19, Steps: 67 | Train Loss: 1.363 Vali Loss: 30.604 Vali Acc: 0.711 Test Loss: 30.604 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.861817359924316
Epoch: 20, Steps: 67 | Train Loss: 1.193 Vali Loss: 12.990 Vali Acc: 0.688 Test Loss: 12.990 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.825868606567383
Epoch: 21, Steps: 67 | Train Loss: 0.071 Vali Loss: 49.388 Vali Acc: 0.653 Test Loss: 49.388 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.819830656051636
Epoch: 22, Steps: 67 | Train Loss: 0.275 Vali Loss: 46.996 Vali Acc: 0.486 Test Loss: 46.996 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 20876295
model size : 82.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.627268075942993
Epoch: 1, Steps: 67 | Train Loss: 31.501 Vali Loss: 17.908 Vali Acc: 0.555 Test Loss: 17.908 Test Acc: 0.555
Validation loss decreased (inf --> -0.554734).  Saving model ...
Epoch: 2 cost time: 9.272181510925293
Epoch: 2, Steps: 67 | Train Loss: 11.887 Vali Loss: 2.562 Vali Acc: 0.711 Test Loss: 2.562 Test Acc: 0.711
Validation loss decreased (-0.554734 --> -0.710957).  Saving model ...
Epoch: 3 cost time: 9.127400398254395
Epoch: 3, Steps: 67 | Train Loss: 0.785 Vali Loss: 3.630 Vali Acc: 0.723 Test Loss: 3.630 Test Acc: 0.723
Validation loss decreased (-0.710957 --> -0.722507).  Saving model ...
Epoch: 4 cost time: 9.306106567382812
Epoch: 4, Steps: 67 | Train Loss: 0.563 Vali Loss: 4.594 Vali Acc: 0.786 Test Loss: 4.594 Test Acc: 0.786
Validation loss decreased (-0.722507 --> -0.786081).  Saving model ...
Epoch: 5 cost time: 9.357392311096191
Epoch: 5, Steps: 67 | Train Loss: 1.179 Vali Loss: 2.777 Vali Acc: 0.775 Test Loss: 2.777 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.464008092880249
Epoch: 6, Steps: 67 | Train Loss: 0.298 Vali Loss: 8.602 Vali Acc: 0.751 Test Loss: 8.602 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.29585075378418
Epoch: 7, Steps: 67 | Train Loss: 0.591 Vali Loss: 10.541 Vali Acc: 0.665 Test Loss: 10.541 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.256651163101196
Epoch: 8, Steps: 67 | Train Loss: 0.843 Vali Loss: 7.449 Vali Acc: 0.728 Test Loss: 7.449 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.253095388412476
Epoch: 9, Steps: 67 | Train Loss: 0.562 Vali Loss: 3.553 Vali Acc: 0.815 Test Loss: 3.553 Test Acc: 0.815
Validation loss decreased (-0.786081 --> -0.814993).  Saving model ...
Epoch: 10 cost time: 9.282522439956665
Epoch: 10, Steps: 67 | Train Loss: 0.032 Vali Loss: 6.407 Vali Acc: 0.786 Test Loss: 6.407 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.420706510543823
Epoch: 11, Steps: 67 | Train Loss: 0.823 Vali Loss: 8.816 Vali Acc: 0.757 Test Loss: 8.816 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.4126455783844
Epoch: 12, Steps: 67 | Train Loss: 0.342 Vali Loss: 10.500 Vali Acc: 0.740 Test Loss: 10.500 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.648795127868652
Epoch: 13, Steps: 67 | Train Loss: 1.170 Vali Loss: 18.017 Vali Acc: 0.734 Test Loss: 18.017 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.392575979232788
Epoch: 14, Steps: 67 | Train Loss: 0.746 Vali Loss: 11.822 Vali Acc: 0.659 Test Loss: 11.822 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.364652156829834
Epoch: 15, Steps: 67 | Train Loss: 0.205 Vali Loss: 12.567 Vali Acc: 0.792 Test Loss: 12.567 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.30967378616333
Epoch: 16, Steps: 67 | Train Loss: 0.908 Vali Loss: 5.125 Vali Acc: 0.803 Test Loss: 5.125 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.411794662475586
Epoch: 17, Steps: 67 | Train Loss: 0.125 Vali Loss: 12.141 Vali Acc: 0.803 Test Loss: 12.141 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.406167030334473
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.416 Vali Acc: 0.815 Test Loss: 12.416 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.52795124053955
Epoch: 19, Steps: 67 | Train Loss: 1.377 Vali Loss: 13.759 Vali Acc: 0.711 Test Loss: 13.759 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15699719
model size : 62.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.380470514297485
Epoch: 1, Steps: 67 | Train Loss: 24.230 Vali Loss: 23.851 Vali Acc: 0.353 Test Loss: 23.851 Test Acc: 0.353
Validation loss decreased (inf --> -0.352363).  Saving model ...
Epoch: 2 cost time: 6.977723598480225
Epoch: 2, Steps: 67 | Train Loss: 7.277 Vali Loss: 1.316 Vali Acc: 0.746 Test Loss: 1.316 Test Acc: 0.746
Validation loss decreased (-0.352363 --> -0.745652).  Saving model ...
Epoch: 3 cost time: 6.964576244354248
Epoch: 3, Steps: 67 | Train Loss: 0.589 Vali Loss: 1.370 Vali Acc: 0.815 Test Loss: 1.370 Test Acc: 0.815
Validation loss decreased (-0.745652 --> -0.815015).  Saving model ...
Epoch: 4 cost time: 7.070940256118774
Epoch: 4, Steps: 67 | Train Loss: 0.291 Vali Loss: 5.314 Vali Acc: 0.763 Test Loss: 5.314 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.92105507850647
Epoch: 5, Steps: 67 | Train Loss: 0.340 Vali Loss: 4.313 Vali Acc: 0.757 Test Loss: 4.313 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.02544903755188
Epoch: 6, Steps: 67 | Train Loss: 1.026 Vali Loss: 4.079 Vali Acc: 0.647 Test Loss: 4.079 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.236291170120239
Epoch: 7, Steps: 67 | Train Loss: 0.846 Vali Loss: 3.984 Vali Acc: 0.827 Test Loss: 3.984 Test Acc: 0.827
Validation loss decreased (-0.815015 --> -0.826550).  Saving model ...
Epoch: 8 cost time: 7.1276350021362305
Epoch: 8, Steps: 67 | Train Loss: 0.486 Vali Loss: 4.774 Vali Acc: 0.786 Test Loss: 4.774 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.184232234954834
Epoch: 9, Steps: 67 | Train Loss: 0.369 Vali Loss: 3.981 Vali Acc: 0.769 Test Loss: 3.981 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.1391589641571045
Epoch: 10, Steps: 67 | Train Loss: 0.193 Vali Loss: 10.251 Vali Acc: 0.757 Test Loss: 10.251 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.126812219619751
Epoch: 11, Steps: 67 | Train Loss: 0.743 Vali Loss: 13.050 Vali Acc: 0.659 Test Loss: 13.050 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.076807498931885
Epoch: 12, Steps: 67 | Train Loss: 1.431 Vali Loss: 8.797 Vali Acc: 0.728 Test Loss: 8.797 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.088706016540527
Epoch: 13, Steps: 67 | Train Loss: 1.475 Vali Loss: 9.984 Vali Acc: 0.746 Test Loss: 9.984 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.1232359409332275
Epoch: 14, Steps: 67 | Train Loss: 0.482 Vali Loss: 10.188 Vali Acc: 0.775 Test Loss: 10.188 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.021626710891724
Epoch: 15, Steps: 67 | Train Loss: 0.309 Vali Loss: 7.890 Vali Acc: 0.786 Test Loss: 7.890 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.105684518814087
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.258 Vali Acc: 0.815 Test Loss: 7.258 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.135183811187744
Epoch: 17, Steps: 67 | Train Loss: 0.013 Vali Loss: 9.182 Vali Acc: 0.786 Test Loss: 9.182 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11386375
model size : 45.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.079130411148071
Epoch: 1, Steps: 67 | Train Loss: 17.336 Vali Loss: 27.820 Vali Acc: 0.382 Test Loss: 27.820 Test Acc: 0.382
Validation loss decreased (inf --> -0.381225).  Saving model ...
Epoch: 2 cost time: 5.54646110534668
Epoch: 2, Steps: 67 | Train Loss: 5.004 Vali Loss: 2.359 Vali Acc: 0.642 Test Loss: 2.359 Test Acc: 0.642
Validation loss decreased (-0.381225 --> -0.641595).  Saving model ...
Epoch: 3 cost time: 5.300612449645996
Epoch: 3, Steps: 67 | Train Loss: 0.536 Vali Loss: 3.576 Vali Acc: 0.751 Test Loss: 3.576 Test Acc: 0.751
Validation loss decreased (-0.641595 --> -0.751409).  Saving model ...
Epoch: 4 cost time: 5.43479585647583
Epoch: 4, Steps: 67 | Train Loss: 0.696 Vali Loss: 2.717 Vali Acc: 0.728 Test Loss: 2.717 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.371069669723511
Epoch: 5, Steps: 67 | Train Loss: 0.108 Vali Loss: 3.221 Vali Acc: 0.815 Test Loss: 3.221 Test Acc: 0.815
Validation loss decreased (-0.751409 --> -0.814997).  Saving model ...
Epoch: 6 cost time: 5.411666393280029
Epoch: 6, Steps: 67 | Train Loss: 0.406 Vali Loss: 4.926 Vali Acc: 0.699 Test Loss: 4.926 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.371039628982544
Epoch: 7, Steps: 67 | Train Loss: 0.106 Vali Loss: 3.294 Vali Acc: 0.798 Test Loss: 3.294 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.312991142272949
Epoch: 8, Steps: 67 | Train Loss: 0.769 Vali Loss: 18.250 Vali Acc: 0.601 Test Loss: 18.250 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.475561618804932
Epoch: 9, Steps: 67 | Train Loss: 0.525 Vali Loss: 7.086 Vali Acc: 0.775 Test Loss: 7.086 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.447059392929077
Epoch: 10, Steps: 67 | Train Loss: 1.418 Vali Loss: 4.571 Vali Acc: 0.757 Test Loss: 4.571 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.334342956542969
Epoch: 11, Steps: 67 | Train Loss: 0.181 Vali Loss: 10.233 Vali Acc: 0.746 Test Loss: 10.233 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.506998062133789
Epoch: 12, Steps: 67 | Train Loss: 0.525 Vali Loss: 18.257 Vali Acc: 0.630 Test Loss: 18.257 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.656505107879639
Epoch: 13, Steps: 67 | Train Loss: 0.867 Vali Loss: 15.990 Vali Acc: 0.659 Test Loss: 15.990 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.339369773864746
Epoch: 14, Steps: 67 | Train Loss: 0.175 Vali Loss: 17.705 Vali Acc: 0.699 Test Loss: 17.705 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.506513595581055
Epoch: 15, Steps: 67 | Train Loss: 0.613 Vali Loss: 12.495 Vali Acc: 0.786 Test Loss: 12.495 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 7935879
model size : 32.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.312629699707031
Epoch: 1, Steps: 67 | Train Loss: 12.447 Vali Loss: 10.743 Vali Acc: 0.538 Test Loss: 10.743 Test Acc: 0.538
Validation loss decreased (inf --> -0.537465).  Saving model ...
Epoch: 2 cost time: 4.65611457824707
Epoch: 2, Steps: 67 | Train Loss: 5.330 Vali Loss: 2.838 Vali Acc: 0.671 Test Loss: 2.838 Test Acc: 0.671
Validation loss decreased (-0.537465 --> -0.670492).  Saving model ...
Epoch: 3 cost time: 4.7050018310546875
Epoch: 3, Steps: 67 | Train Loss: 0.582 Vali Loss: 2.150 Vali Acc: 0.734 Test Loss: 2.150 Test Acc: 0.734
Validation loss decreased (-0.670492 --> -0.734083).  Saving model ...
Epoch: 4 cost time: 4.696314573287964
Epoch: 4, Steps: 67 | Train Loss: 0.414 Vali Loss: 4.284 Vali Acc: 0.740 Test Loss: 4.284 Test Acc: 0.740
Validation loss decreased (-0.734083 --> -0.739842).  Saving model ...
Epoch: 5 cost time: 4.878845691680908
Epoch: 5, Steps: 67 | Train Loss: 0.439 Vali Loss: 5.780 Vali Acc: 0.699 Test Loss: 5.780 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.778053045272827
Epoch: 6, Steps: 67 | Train Loss: 0.107 Vali Loss: 3.424 Vali Acc: 0.827 Test Loss: 3.424 Test Acc: 0.827
Validation loss decreased (-0.739842 --> -0.826555).  Saving model ...
Epoch: 7 cost time: 4.597477912902832
Epoch: 7, Steps: 67 | Train Loss: 0.347 Vali Loss: 3.743 Vali Acc: 0.757 Test Loss: 3.743 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.630271673202515
Epoch: 8, Steps: 67 | Train Loss: 0.522 Vali Loss: 3.614 Vali Acc: 0.798 Test Loss: 3.614 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.684751033782959
Epoch: 9, Steps: 67 | Train Loss: 1.315 Vali Loss: 2.027 Vali Acc: 0.803 Test Loss: 2.027 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.602204084396362
Epoch: 10, Steps: 67 | Train Loss: 0.341 Vali Loss: 3.022 Vali Acc: 0.763 Test Loss: 3.022 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.707951784133911
Epoch: 11, Steps: 67 | Train Loss: 0.426 Vali Loss: 7.977 Vali Acc: 0.746 Test Loss: 7.977 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.722377777099609
Epoch: 12, Steps: 67 | Train Loss: 0.162 Vali Loss: 3.483 Vali Acc: 0.827 Test Loss: 3.483 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.69164252281189
Epoch: 13, Steps: 67 | Train Loss: 0.586 Vali Loss: 6.937 Vali Acc: 0.694 Test Loss: 6.937 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.663488864898682
Epoch: 14, Steps: 67 | Train Loss: 0.163 Vali Loss: 7.361 Vali Acc: 0.809 Test Loss: 7.361 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.6090662479400635
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.864 Vali Acc: 0.803 Test Loss: 7.864 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.620336055755615
Epoch: 16, Steps: 67 | Train Loss: 0.628 Vali Loss: 7.649 Vali Acc: 0.740 Test Loss: 7.649 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7073927
model size : 29.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 40.7249146
	speed: 0.2960s/iter; left time: 3937.4181s
Epoch: 1 cost time: 39.40928387641907
Epoch: 1, Steps: 134 | Train Loss: 108.761 Vali Loss: 28.748 Vali Acc: 0.636 Test Loss: 28.748 Test Acc: 0.636
Validation loss decreased (inf --> -0.635551).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2044525
	speed: 0.5870s/iter; left time: 7729.0999s
Epoch: 2 cost time: 39.200438022613525
Epoch: 2, Steps: 134 | Train Loss: 7.948 Vali Loss: 7.172 Vali Acc: 0.688 Test Loss: 7.172 Test Acc: 0.688
Validation loss decreased (-0.635551 --> -0.687790).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.6000s/iter; left time: 7820.2429s
Epoch: 3 cost time: 38.67549157142639
Epoch: 3, Steps: 134 | Train Loss: 1.549 Vali Loss: 10.805 Vali Acc: 0.595 Test Loss: 10.805 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.5852s/iter; left time: 7548.5932s
Epoch: 4 cost time: 38.969778060913086
Epoch: 4, Steps: 134 | Train Loss: 0.642 Vali Loss: 12.994 Vali Acc: 0.705 Test Loss: 12.994 Test Acc: 0.705
Validation loss decreased (-0.687790 --> -0.705072).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0002286
	speed: 0.6011s/iter; left time: 7673.6371s
Epoch: 5 cost time: 38.96350169181824
Epoch: 5, Steps: 134 | Train Loss: 5.345 Vali Loss: 9.678 Vali Acc: 0.665 Test Loss: 9.678 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.5862s/iter; left time: 7404.7842s
Epoch: 6 cost time: 38.928208351135254
Epoch: 6, Steps: 134 | Train Loss: 1.491 Vali Loss: 10.585 Vali Acc: 0.746 Test Loss: 10.585 Test Acc: 0.746
Validation loss decreased (-0.705072 --> -0.745559).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5904s/iter; left time: 7378.7105s
Epoch: 7 cost time: 38.865565061569214
Epoch: 7, Steps: 134 | Train Loss: 1.021 Vali Loss: 16.486 Vali Acc: 0.711 Test Loss: 16.486 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5808s/iter; left time: 7180.0815s
Epoch: 8 cost time: 39.01203155517578
Epoch: 8, Steps: 134 | Train Loss: 4.238 Vali Loss: 17.486 Vali Acc: 0.590 Test Loss: 17.486 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5890s/iter; left time: 7202.7994s
Epoch: 9 cost time: 39.079248905181885
Epoch: 9, Steps: 134 | Train Loss: 2.142 Vali Loss: 21.415 Vali Acc: 0.763 Test Loss: 21.415 Test Acc: 0.763
Validation loss decreased (-0.745559 --> -0.762792).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.6000s/iter; left time: 7257.0855s
Epoch: 10 cost time: 39.131234884262085
Epoch: 10, Steps: 134 | Train Loss: 0.857 Vali Loss: 21.401 Vali Acc: 0.786 Test Loss: 21.401 Test Acc: 0.786
Validation loss decreased (-0.762792 --> -0.785913).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5927s/iter; left time: 7089.8365s
Epoch: 11 cost time: 38.91458320617676
Epoch: 11, Steps: 134 | Train Loss: 1.359 Vali Loss: 30.391 Vali Acc: 0.746 Test Loss: 30.391 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5884s/iter; left time: 6958.7998s
Epoch: 12 cost time: 39.154274702072144
Epoch: 12, Steps: 134 | Train Loss: 0.955 Vali Loss: 18.850 Vali Acc: 0.815 Test Loss: 18.850 Test Acc: 0.815
Validation loss decreased (-0.785913 --> -0.814840).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.6024s/iter; left time: 7043.8164s
Epoch: 13 cost time: 39.032485008239746
Epoch: 13, Steps: 134 | Train Loss: 0.580 Vali Loss: 22.253 Vali Acc: 0.717 Test Loss: 22.253 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5917s/iter; left time: 6839.0840s
Epoch: 14 cost time: 39.22701930999756
Epoch: 14, Steps: 134 | Train Loss: 0.168 Vali Loss: 25.440 Vali Acc: 0.780 Test Loss: 25.440 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5959s/iter; left time: 6807.8939s
Epoch: 15 cost time: 39.278321981430054
Epoch: 15, Steps: 134 | Train Loss: 1.277 Vali Loss: 32.023 Vali Acc: 0.723 Test Loss: 32.023 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5907s/iter; left time: 6669.4387s
Epoch: 16 cost time: 39.01560688018799
Epoch: 16, Steps: 134 | Train Loss: 1.870 Vali Loss: 19.301 Vali Acc: 0.740 Test Loss: 19.301 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.5895s/iter; left time: 6576.8615s
Epoch: 17 cost time: 39.15995478630066
Epoch: 17, Steps: 134 | Train Loss: 0.070 Vali Loss: 33.824 Vali Acc: 0.740 Test Loss: 33.824 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.5950s/iter; left time: 6559.1284s
Epoch: 18 cost time: 39.31394338607788
Epoch: 18, Steps: 134 | Train Loss: 0.000 Vali Loss: 34.089 Vali Acc: 0.740 Test Loss: 34.089 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 35.2017746
	speed: 0.5857s/iter; left time: 6377.2818s
Epoch: 19 cost time: 38.9942946434021
Epoch: 19, Steps: 134 | Train Loss: 3.038 Vali Loss: 17.133 Vali Acc: 0.780 Test Loss: 17.133 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5918s/iter; left time: 6364.7982s
Epoch: 20 cost time: 39.067702770233154
Epoch: 20, Steps: 134 | Train Loss: 4.471 Vali Loss: 59.598 Vali Acc: 0.561 Test Loss: 59.598 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.5849s/iter; left time: 6212.4104s
Epoch: 21 cost time: 38.895779848098755
Epoch: 21, Steps: 134 | Train Loss: 0.580 Vali Loss: 26.624 Vali Acc: 0.763 Test Loss: 26.624 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.5920s/iter; left time: 6207.8426s
Epoch: 22 cost time: 39.26017117500305
Epoch: 22, Steps: 134 | Train Loss: 1.163 Vali Loss: 59.319 Vali Acc: 0.728 Test Loss: 59.319 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 31162887
model size : 120.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.85018539428711
Epoch: 1, Steps: 67 | Train Loss: 29.572 Vali Loss: 32.326 Vali Acc: 0.382 Test Loss: 32.326 Test Acc: 0.382
Validation loss decreased (inf --> -0.381180).  Saving model ...
Epoch: 2 cost time: 16.59048342704773
Epoch: 2, Steps: 67 | Train Loss: 26.171 Vali Loss: 25.660 Vali Acc: 0.566 Test Loss: 25.660 Test Acc: 0.566
Validation loss decreased (-0.381180 --> -0.566217).  Saving model ...
Epoch: 3 cost time: 16.636114835739136
Epoch: 3, Steps: 67 | Train Loss: 8.858 Vali Loss: 22.321 Vali Acc: 0.647 Test Loss: 22.321 Test Acc: 0.647
Validation loss decreased (-0.566217 --> -0.647176).  Saving model ...
Epoch: 4 cost time: 16.770410776138306
Epoch: 4, Steps: 67 | Train Loss: 3.593 Vali Loss: 15.012 Vali Acc: 0.717 Test Loss: 15.012 Test Acc: 0.717
Validation loss decreased (-0.647176 --> -0.716613).  Saving model ...
Epoch: 5 cost time: 16.793968200683594
Epoch: 5, Steps: 67 | Train Loss: 0.768 Vali Loss: 10.845 Vali Acc: 0.746 Test Loss: 10.845 Test Acc: 0.746
Validation loss decreased (-0.716613 --> -0.745556).  Saving model ...
Epoch: 6 cost time: 16.777150869369507
Epoch: 6, Steps: 67 | Train Loss: 0.069 Vali Loss: 4.431 Vali Acc: 0.815 Test Loss: 4.431 Test Acc: 0.815
Validation loss decreased (-0.745556 --> -0.814985).  Saving model ...
Epoch: 7 cost time: 16.77994680404663
Epoch: 7, Steps: 67 | Train Loss: 0.001 Vali Loss: 6.527 Vali Acc: 0.763 Test Loss: 6.527 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.739388942718506
Epoch: 8, Steps: 67 | Train Loss: 0.200 Vali Loss: 5.047 Vali Acc: 0.775 Test Loss: 5.047 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.915555000305176
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.310 Vali Acc: 0.775 Test Loss: 5.310 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.973235607147217
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.303 Vali Acc: 0.775 Test Loss: 5.303 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.976196765899658
Epoch: 11, Steps: 67 | Train Loss: 0.105 Vali Loss: 4.573 Vali Acc: 0.780 Test Loss: 4.573 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.04093313217163
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.167 Vali Acc: 0.815 Test Loss: 5.167 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.981558799743652
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.187 Vali Acc: 0.815 Test Loss: 5.187 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.01293969154358
Epoch: 14, Steps: 67 | Train Loss: 2.094 Vali Loss: 16.515 Vali Acc: 0.653 Test Loss: 16.515 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 17.095457077026367
Epoch: 15, Steps: 67 | Train Loss: 1.416 Vali Loss: 12.171 Vali Acc: 0.694 Test Loss: 12.171 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.855573415756226
Epoch: 16, Steps: 67 | Train Loss: 0.890 Vali Loss: 19.609 Vali Acc: 0.636 Test Loss: 19.609 Test Acc: 0.636
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15631879
model size : 60.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.056999921798706
Epoch: 1, Steps: 67 | Train Loss: 24.424 Vali Loss: 52.129 Vali Acc: 0.572 Test Loss: 52.129 Test Acc: 0.572
Validation loss decreased (inf --> -0.571733).  Saving model ...
Epoch: 2 cost time: 10.129451990127563
Epoch: 2, Steps: 67 | Train Loss: 16.879 Vali Loss: 7.528 Vali Acc: 0.636 Test Loss: 7.528 Test Acc: 0.636
Validation loss decreased (-0.571733 --> -0.635763).  Saving model ...
Epoch: 3 cost time: 10.357097387313843
Epoch: 3, Steps: 67 | Train Loss: 3.859 Vali Loss: 15.758 Vali Acc: 0.705 Test Loss: 15.758 Test Acc: 0.705
Validation loss decreased (-0.635763 --> -0.705045).  Saving model ...
Epoch: 4 cost time: 10.417673110961914
Epoch: 4, Steps: 67 | Train Loss: 2.730 Vali Loss: 2.435 Vali Acc: 0.809 Test Loss: 2.435 Test Acc: 0.809
Validation loss decreased (-0.705045 --> -0.809224).  Saving model ...
Epoch: 5 cost time: 10.604910373687744
Epoch: 5, Steps: 67 | Train Loss: 0.151 Vali Loss: 3.419 Vali Acc: 0.850 Test Loss: 3.419 Test Acc: 0.850
Validation loss decreased (-0.809224 --> -0.849677).  Saving model ...
Epoch: 6 cost time: 10.573660850524902
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.371 Vali Acc: 0.792 Test Loss: 2.371 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.656170845031738
Epoch: 7, Steps: 67 | Train Loss: 0.025 Vali Loss: 4.632 Vali Acc: 0.786 Test Loss: 4.632 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.491300344467163
Epoch: 8, Steps: 67 | Train Loss: 0.010 Vali Loss: 3.356 Vali Acc: 0.775 Test Loss: 3.356 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.463661193847656
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.332 Vali Acc: 0.775 Test Loss: 3.332 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.510835886001587
Epoch: 10, Steps: 67 | Train Loss: 0.148 Vali Loss: 2.608 Vali Acc: 0.879 Test Loss: 2.608 Test Acc: 0.879
Validation loss decreased (-0.849677 --> -0.878587).  Saving model ...
Epoch: 11 cost time: 10.384841680526733
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.143 Vali Acc: 0.798 Test Loss: 3.143 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.301913022994995
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.908 Vali Acc: 0.832 Test Loss: 2.908 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.478945970535278
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.943 Vali Acc: 0.832 Test Loss: 2.943 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.348593711853027
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.071 Vali Acc: 0.798 Test Loss: 3.071 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.369423151016235
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.052 Vali Acc: 0.798 Test Loss: 3.052 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.407905101776123
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.054 Vali Acc: 0.798 Test Loss: 3.054 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.336493015289307
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.798 Test Loss: 3.048 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.299746990203857
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.043 Vali Acc: 0.798 Test Loss: 3.043 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.208233833312988
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.704 Vali Acc: 0.832 Test Loss: 2.704 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.401004076004028
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.688 Vali Acc: 0.832 Test Loss: 2.688 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 10454983
model size : 41.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.24213433265686
Epoch: 1, Steps: 67 | Train Loss: 10.504 Vali Loss: 17.902 Vali Acc: 0.434 Test Loss: 17.902 Test Acc: 0.434
Validation loss decreased (inf --> -0.433347).  Saving model ...
Epoch: 2 cost time: 8.84689974784851
Epoch: 2, Steps: 67 | Train Loss: 14.426 Vali Loss: 11.774 Vali Acc: 0.601 Test Loss: 11.774 Test Acc: 0.601
Validation loss decreased (-0.433347 --> -0.601038).  Saving model ...
Epoch: 3 cost time: 8.76566767692566
Epoch: 3, Steps: 67 | Train Loss: 1.298 Vali Loss: 5.006 Vali Acc: 0.769 Test Loss: 5.006 Test Acc: 0.769
Validation loss decreased (-0.601038 --> -0.768736).  Saving model ...
Epoch: 4 cost time: 8.856064319610596
Epoch: 4, Steps: 67 | Train Loss: 0.982 Vali Loss: 3.770 Vali Acc: 0.746 Test Loss: 3.770 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.765319585800171
Epoch: 5, Steps: 67 | Train Loss: 0.234 Vali Loss: 2.766 Vali Acc: 0.803 Test Loss: 2.766 Test Acc: 0.803
Validation loss decreased (-0.768736 --> -0.803441).  Saving model ...
Epoch: 6 cost time: 8.905511379241943
Epoch: 6, Steps: 67 | Train Loss: 0.127 Vali Loss: 2.513 Vali Acc: 0.815 Test Loss: 2.513 Test Acc: 0.815
Validation loss decreased (-0.803441 --> -0.815004).  Saving model ...
Epoch: 7 cost time: 9.134965419769287
Epoch: 7, Steps: 67 | Train Loss: 0.004 Vali Loss: 4.575 Vali Acc: 0.746 Test Loss: 4.575 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.890570402145386
Epoch: 8, Steps: 67 | Train Loss: 0.054 Vali Loss: 3.483 Vali Acc: 0.786 Test Loss: 3.483 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.974069118499756
Epoch: 9, Steps: 67 | Train Loss: 0.178 Vali Loss: 3.323 Vali Acc: 0.786 Test Loss: 3.323 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.024739265441895
Epoch: 10, Steps: 67 | Train Loss: 0.005 Vali Loss: 3.873 Vali Acc: 0.832 Test Loss: 3.873 Test Acc: 0.832
Validation loss decreased (-0.815004 --> -0.832331).  Saving model ...
Epoch: 11 cost time: 8.973208904266357
Epoch: 11, Steps: 67 | Train Loss: 0.176 Vali Loss: 5.726 Vali Acc: 0.763 Test Loss: 5.726 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.87012791633606
Epoch: 12, Steps: 67 | Train Loss: 0.237 Vali Loss: 5.008 Vali Acc: 0.832 Test Loss: 5.008 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.791861295700073
Epoch: 13, Steps: 67 | Train Loss: 0.305 Vali Loss: 7.153 Vali Acc: 0.717 Test Loss: 7.153 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.90261459350586
Epoch: 14, Steps: 67 | Train Loss: 0.378 Vali Loss: 19.232 Vali Acc: 0.613 Test Loss: 19.232 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.83246636390686
Epoch: 15, Steps: 67 | Train Loss: 0.879 Vali Loss: 5.676 Vali Acc: 0.844 Test Loss: 5.676 Test Acc: 0.844
Validation loss decreased (-0.832331 --> -0.843874).  Saving model ...
Epoch: 16 cost time: 8.85928201675415
Epoch: 16, Steps: 67 | Train Loss: 1.766 Vali Loss: 6.029 Vali Acc: 0.757 Test Loss: 6.029 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.918968677520752
Epoch: 17, Steps: 67 | Train Loss: 1.190 Vali Loss: 11.511 Vali Acc: 0.769 Test Loss: 11.511 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.891141891479492
Epoch: 18, Steps: 67 | Train Loss: 1.042 Vali Loss: 3.127 Vali Acc: 0.873 Test Loss: 3.127 Test Acc: 0.873
Validation loss decreased (-0.843874 --> -0.872801).  Saving model ...
Epoch: 19 cost time: 8.927693605422974
Epoch: 19, Steps: 67 | Train Loss: 0.096 Vali Loss: 7.630 Vali Acc: 0.838 Test Loss: 7.630 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.048324823379517
Epoch: 20, Steps: 67 | Train Loss: 0.007 Vali Loss: 14.042 Vali Acc: 0.803 Test Loss: 14.042 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.707629680633545
Epoch: 21, Steps: 67 | Train Loss: 0.433 Vali Loss: 11.303 Vali Acc: 0.746 Test Loss: 11.303 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.036029577255249
Epoch: 22, Steps: 67 | Train Loss: 0.182 Vali Loss: 19.386 Vali Acc: 0.769 Test Loss: 19.386 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.94846510887146
Epoch: 23, Steps: 67 | Train Loss: 0.226 Vali Loss: 25.873 Vali Acc: 0.676 Test Loss: 25.873 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.023913383483887
Epoch: 24, Steps: 67 | Train Loss: 0.240 Vali Loss: 17.318 Vali Acc: 0.786 Test Loss: 17.318 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.748250722885132
Epoch: 25, Steps: 67 | Train Loss: 0.479 Vali Loss: 20.495 Vali Acc: 0.665 Test Loss: 20.495 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 8.951399326324463
Epoch: 26, Steps: 67 | Train Loss: 1.023 Vali Loss: 12.477 Vali Acc: 0.751 Test Loss: 12.477 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.786173105239868
Epoch: 27, Steps: 67 | Train Loss: 0.058 Vali Loss: 12.411 Vali Acc: 0.746 Test Loss: 12.411 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 8.992942571640015
Epoch: 28, Steps: 67 | Train Loss: 0.591 Vali Loss: 10.789 Vali Acc: 0.815 Test Loss: 10.789 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 7866695
model size : 31.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.613114833831787
Epoch: 1, Steps: 67 | Train Loss: 15.669 Vali Loss: 13.866 Vali Acc: 0.538 Test Loss: 13.866 Test Acc: 0.538
Validation loss decreased (inf --> -0.537434).  Saving model ...
Epoch: 2 cost time: 6.336045742034912
Epoch: 2, Steps: 67 | Train Loss: 6.594 Vali Loss: 7.129 Vali Acc: 0.653 Test Loss: 7.129 Test Acc: 0.653
Validation loss decreased (-0.537434 --> -0.653108).  Saving model ...
Epoch: 3 cost time: 6.2783589363098145
Epoch: 3, Steps: 67 | Train Loss: 1.696 Vali Loss: 10.136 Vali Acc: 0.601 Test Loss: 10.136 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.291738510131836
Epoch: 4, Steps: 67 | Train Loss: 1.576 Vali Loss: 5.609 Vali Acc: 0.751 Test Loss: 5.609 Test Acc: 0.751
Validation loss decreased (-0.653108 --> -0.751389).  Saving model ...
Epoch: 5 cost time: 6.35148024559021
Epoch: 5, Steps: 67 | Train Loss: 0.126 Vali Loss: 7.056 Vali Acc: 0.786 Test Loss: 7.056 Test Acc: 0.786
Validation loss decreased (-0.751389 --> -0.786057).  Saving model ...
Epoch: 6 cost time: 6.564469575881958
Epoch: 6, Steps: 67 | Train Loss: 0.121 Vali Loss: 2.716 Vali Acc: 0.809 Test Loss: 2.716 Test Acc: 0.809
Validation loss decreased (-0.786057 --> -0.809221).  Saving model ...
Epoch: 7 cost time: 6.346351385116577
Epoch: 7, Steps: 67 | Train Loss: 0.060 Vali Loss: 6.522 Vali Acc: 0.728 Test Loss: 6.522 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.434848308563232
Epoch: 8, Steps: 67 | Train Loss: 0.069 Vali Loss: 3.181 Vali Acc: 0.803 Test Loss: 3.181 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.48767352104187
Epoch: 9, Steps: 67 | Train Loss: 0.234 Vali Loss: 3.728 Vali Acc: 0.815 Test Loss: 3.728 Test Acc: 0.815
Validation loss decreased (-0.809221 --> -0.814992).  Saving model ...
Epoch: 10 cost time: 6.321797609329224
Epoch: 10, Steps: 67 | Train Loss: 0.198 Vali Loss: 1.436 Vali Acc: 0.838 Test Loss: 1.436 Test Acc: 0.838
Validation loss decreased (-0.814992 --> -0.838136).  Saving model ...
Epoch: 11 cost time: 6.38616943359375
Epoch: 11, Steps: 67 | Train Loss: 0.096 Vali Loss: 1.693 Vali Acc: 0.838 Test Loss: 1.693 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.34818434715271
Epoch: 12, Steps: 67 | Train Loss: 0.465 Vali Loss: 3.333 Vali Acc: 0.751 Test Loss: 3.333 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.439542293548584
Epoch: 13, Steps: 67 | Train Loss: 0.908 Vali Loss: 3.437 Vali Acc: 0.751 Test Loss: 3.437 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.447260141372681
Epoch: 14, Steps: 67 | Train Loss: 0.280 Vali Loss: 10.233 Vali Acc: 0.746 Test Loss: 10.233 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.48744535446167
Epoch: 15, Steps: 67 | Train Loss: 0.739 Vali Loss: 19.203 Vali Acc: 0.647 Test Loss: 19.203 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.359748840332031
Epoch: 16, Steps: 67 | Train Loss: 0.298 Vali Loss: 3.213 Vali Acc: 0.798 Test Loss: 3.213 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.483585357666016
Epoch: 17, Steps: 67 | Train Loss: 0.052 Vali Loss: 14.249 Vali Acc: 0.711 Test Loss: 14.249 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.436866044998169
Epoch: 18, Steps: 67 | Train Loss: 0.789 Vali Loss: 14.188 Vali Acc: 0.653 Test Loss: 14.188 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.4151294231414795
Epoch: 19, Steps: 67 | Train Loss: 1.174 Vali Loss: 5.945 Vali Acc: 0.769 Test Loss: 5.945 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.368649482727051
Epoch: 20, Steps: 67 | Train Loss: 0.502 Vali Loss: 10.975 Vali Acc: 0.775 Test Loss: 10.975 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 5710023
model size : 23.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.676367282867432
Epoch: 1, Steps: 67 | Train Loss: 7.168 Vali Loss: 6.631 Vali Acc: 0.566 Test Loss: 6.631 Test Acc: 0.566
Validation loss decreased (inf --> -0.566408).  Saving model ...
Epoch: 2 cost time: 5.046160697937012
Epoch: 2, Steps: 67 | Train Loss: 3.090 Vali Loss: 5.799 Vali Acc: 0.653 Test Loss: 5.799 Test Acc: 0.653
Validation loss decreased (-0.566408 --> -0.653121).  Saving model ...
Epoch: 3 cost time: 5.301820755004883
Epoch: 3, Steps: 67 | Train Loss: 2.519 Vali Loss: 1.262 Vali Acc: 0.832 Test Loss: 1.262 Test Acc: 0.832
Validation loss decreased (-0.653121 --> -0.832357).  Saving model ...
Epoch: 4 cost time: 5.0838658809661865
Epoch: 4, Steps: 67 | Train Loss: 0.468 Vali Loss: 3.605 Vali Acc: 0.723 Test Loss: 3.605 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.100463390350342
Epoch: 5, Steps: 67 | Train Loss: 0.210 Vali Loss: 1.948 Vali Acc: 0.832 Test Loss: 1.948 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.081850051879883
Epoch: 6, Steps: 67 | Train Loss: 0.031 Vali Loss: 2.701 Vali Acc: 0.780 Test Loss: 2.701 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.102719068527222
Epoch: 7, Steps: 67 | Train Loss: 0.266 Vali Loss: 2.193 Vali Acc: 0.861 Test Loss: 2.193 Test Acc: 0.861
Validation loss decreased (-0.832357 --> -0.861250).  Saving model ...
Epoch: 8 cost time: 5.143497467041016
Epoch: 8, Steps: 67 | Train Loss: 0.067 Vali Loss: 5.078 Vali Acc: 0.734 Test Loss: 5.078 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.113550424575806
Epoch: 9, Steps: 67 | Train Loss: 0.277 Vali Loss: 7.228 Vali Acc: 0.734 Test Loss: 7.228 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.104042291641235
Epoch: 10, Steps: 67 | Train Loss: 0.431 Vali Loss: 3.997 Vali Acc: 0.815 Test Loss: 3.997 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.094991207122803
Epoch: 11, Steps: 67 | Train Loss: 0.036 Vali Loss: 6.115 Vali Acc: 0.751 Test Loss: 6.115 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.112688064575195
Epoch: 12, Steps: 67 | Train Loss: 0.168 Vali Loss: 4.411 Vali Acc: 0.711 Test Loss: 4.411 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.203864574432373
Epoch: 13, Steps: 67 | Train Loss: 0.021 Vali Loss: 2.931 Vali Acc: 0.769 Test Loss: 2.931 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.039200782775879
Epoch: 14, Steps: 67 | Train Loss: 0.038 Vali Loss: 4.285 Vali Acc: 0.786 Test Loss: 4.285 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.1134467124938965
Epoch: 15, Steps: 67 | Train Loss: 0.335 Vali Loss: 4.058 Vali Acc: 0.780 Test Loss: 4.058 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.09610390663147
Epoch: 16, Steps: 67 | Train Loss: 0.112 Vali Loss: 2.882 Vali Acc: 0.775 Test Loss: 2.882 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.301778316497803
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.769 Test Loss: 2.527 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3984775
model size : 16.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.6362128257751465
Epoch: 1, Steps: 67 | Train Loss: 5.330 Vali Loss: 4.245 Vali Acc: 0.647 Test Loss: 4.245 Test Acc: 0.647
Validation loss decreased (inf --> -0.647356).  Saving model ...
Epoch: 2 cost time: 4.156239748001099
Epoch: 2, Steps: 67 | Train Loss: 5.611 Vali Loss: 10.205 Vali Acc: 0.486 Test Loss: 10.205 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.291859149932861
Epoch: 3, Steps: 67 | Train Loss: 1.302 Vali Loss: 6.753 Vali Acc: 0.676 Test Loss: 6.753 Test Acc: 0.676
Validation loss decreased (-0.647356 --> -0.676233).  Saving model ...
Epoch: 4 cost time: 4.407581329345703
Epoch: 4, Steps: 67 | Train Loss: 0.664 Vali Loss: 1.232 Vali Acc: 0.844 Test Loss: 1.232 Test Acc: 0.844
Validation loss decreased (-0.676233 --> -0.843918).  Saving model ...
Epoch: 5 cost time: 4.3761982917785645
Epoch: 5, Steps: 67 | Train Loss: 0.227 Vali Loss: 2.135 Vali Acc: 0.832 Test Loss: 2.135 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.328782796859741
Epoch: 6, Steps: 67 | Train Loss: 0.103 Vali Loss: 4.852 Vali Acc: 0.711 Test Loss: 4.852 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.262969732284546
Epoch: 7, Steps: 67 | Train Loss: 0.438 Vali Loss: 3.751 Vali Acc: 0.705 Test Loss: 3.751 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.277112245559692
Epoch: 8, Steps: 67 | Train Loss: 0.343 Vali Loss: 5.437 Vali Acc: 0.751 Test Loss: 5.437 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.533649921417236
Epoch: 9, Steps: 67 | Train Loss: 0.602 Vali Loss: 1.409 Vali Acc: 0.844 Test Loss: 1.409 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.591852903366089
Epoch: 10, Steps: 67 | Train Loss: 0.112 Vali Loss: 3.153 Vali Acc: 0.757 Test Loss: 3.153 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.291205883026123
Epoch: 11, Steps: 67 | Train Loss: 0.001 Vali Loss: 3.955 Vali Acc: 0.740 Test Loss: 3.955 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.3636085987091064
Epoch: 12, Steps: 67 | Train Loss: 0.007 Vali Loss: 1.771 Vali Acc: 0.861 Test Loss: 1.771 Test Acc: 0.861
Validation loss decreased (-0.843918 --> -0.861254).  Saving model ...
Epoch: 13 cost time: 4.423335552215576
Epoch: 13, Steps: 67 | Train Loss: 0.034 Vali Loss: 2.818 Vali Acc: 0.844 Test Loss: 2.818 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.48379373550415
Epoch: 14, Steps: 67 | Train Loss: 0.057 Vali Loss: 4.926 Vali Acc: 0.740 Test Loss: 4.926 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.4079039096832275
Epoch: 15, Steps: 67 | Train Loss: 0.037 Vali Loss: 2.578 Vali Acc: 0.844 Test Loss: 2.578 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.287127733230591
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.794 Vali Acc: 0.728 Test Loss: 12.794 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.368557929992676
Epoch: 17, Steps: 67 | Train Loss: 0.670 Vali Loss: 3.494 Vali Acc: 0.751 Test Loss: 3.494 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.33307409286499
Epoch: 18, Steps: 67 | Train Loss: 0.328 Vali Loss: 16.733 Vali Acc: 0.618 Test Loss: 16.733 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.302184820175171
Epoch: 19, Steps: 67 | Train Loss: 1.939 Vali Loss: 24.266 Vali Acc: 0.549 Test Loss: 24.266 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.385305404663086
Epoch: 20, Steps: 67 | Train Loss: 0.350 Vali Loss: 9.932 Vali Acc: 0.734 Test Loss: 9.932 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.319182395935059
Epoch: 21, Steps: 67 | Train Loss: 1.332 Vali Loss: 92.898 Vali Acc: 0.197 Test Loss: 92.898 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.204747200012207
Epoch: 22, Steps: 67 | Train Loss: 0.896 Vali Loss: 20.526 Vali Acc: 0.595 Test Loss: 20.526 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3553799
model size : 14.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 165.4887238
	speed: 0.2617s/iter; left time: 3480.2439s
Epoch: 1 cost time: 34.67403793334961
Epoch: 1, Steps: 134 | Train Loss: 156.276 Vali Loss: 130.036 Vali Acc: 0.341 Test Loss: 130.036 Test Acc: 0.341
Validation loss decreased (inf --> -0.339740).  Saving model ...
	iters: 100, epoch: 2 | loss: 4.5338130
	speed: 0.5384s/iter; left time: 7088.9023s
Epoch: 2 cost time: 33.750577449798584
Epoch: 2, Steps: 134 | Train Loss: 17.634 Vali Loss: 4.375 Vali Acc: 0.601 Test Loss: 4.375 Test Acc: 0.601
Validation loss decreased (-0.339740 --> -0.601112).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.5480s/iter; left time: 7142.3665s
Epoch: 3 cost time: 33.37734889984131
Epoch: 3, Steps: 134 | Train Loss: 2.988 Vali Loss: 9.593 Vali Acc: 0.688 Test Loss: 9.593 Test Acc: 0.688
Validation loss decreased (-0.601112 --> -0.687765).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.5486s/iter; left time: 7076.0624s
Epoch: 4 cost time: 33.74604535102844
Epoch: 4, Steps: 134 | Train Loss: 2.567 Vali Loss: 6.258 Vali Acc: 0.723 Test Loss: 6.258 Test Acc: 0.723
Validation loss decreased (-0.687765 --> -0.722481).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.5613s/iter; left time: 7164.8404s
Epoch: 5 cost time: 33.9650456905365
Epoch: 5, Steps: 134 | Train Loss: 2.310 Vali Loss: 31.134 Vali Acc: 0.572 Test Loss: 31.134 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.5469s/iter; left time: 6907.4307s
Epoch: 6 cost time: 34.54513740539551
Epoch: 6, Steps: 134 | Train Loss: 1.922 Vali Loss: 5.741 Vali Acc: 0.844 Test Loss: 5.741 Test Acc: 0.844
Validation loss decreased (-0.722481 --> -0.843873).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.5682s/iter; left time: 7100.7138s
Epoch: 7 cost time: 34.21699857711792
Epoch: 7, Steps: 134 | Train Loss: 0.340 Vali Loss: 13.451 Vali Acc: 0.809 Test Loss: 13.451 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 35.6158676
	speed: 0.5452s/iter; left time: 6740.1759s
Epoch: 8 cost time: 34.130693197250366
Epoch: 8, Steps: 134 | Train Loss: 1.970 Vali Loss: 21.209 Vali Acc: 0.705 Test Loss: 21.209 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5386s/iter; left time: 6586.4219s
Epoch: 9 cost time: 33.720174074172974
Epoch: 9, Steps: 134 | Train Loss: 1.529 Vali Loss: 21.493 Vali Acc: 0.647 Test Loss: 21.493 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.5381s/iter; left time: 6508.2365s
Epoch: 10 cost time: 34.14745879173279
Epoch: 10, Steps: 134 | Train Loss: 2.791 Vali Loss: 7.403 Vali Acc: 0.751 Test Loss: 7.403 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5364s/iter; left time: 6415.9792s
Epoch: 11 cost time: 34.018893241882324
Epoch: 11, Steps: 134 | Train Loss: 0.382 Vali Loss: 11.685 Vali Acc: 0.734 Test Loss: 11.685 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5427s/iter; left time: 6418.6708s
Epoch: 12 cost time: 34.11364197731018
Epoch: 12, Steps: 134 | Train Loss: 0.622 Vali Loss: 19.730 Vali Acc: 0.723 Test Loss: 19.730 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 19.4864082
	speed: 0.5427s/iter; left time: 6345.3522s
Epoch: 13 cost time: 34.11118984222412
Epoch: 13, Steps: 134 | Train Loss: 2.479 Vali Loss: 41.748 Vali Acc: 0.410 Test Loss: 41.748 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5519s/iter; left time: 6379.6684s
Epoch: 14 cost time: 34.53739619255066
Epoch: 14, Steps: 134 | Train Loss: 2.622 Vali Loss: 21.826 Vali Acc: 0.723 Test Loss: 21.826 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5562s/iter; left time: 6354.5174s
Epoch: 15 cost time: 34.65137505531311
Epoch: 15, Steps: 134 | Train Loss: 0.692 Vali Loss: 21.324 Vali Acc: 0.763 Test Loss: 21.324 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.5508s/iter; left time: 6219.3968s
Epoch: 16 cost time: 34.15573501586914
Epoch: 16, Steps: 134 | Train Loss: 0.010 Vali Loss: 16.587 Vali Acc: 0.815 Test Loss: 16.587 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 31129863
model size : 119.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.989640951156616
Epoch: 1, Steps: 67 | Train Loss: 30.438 Vali Loss: 66.425 Vali Acc: 0.468 Test Loss: 66.425 Test Acc: 0.468
Validation loss decreased (inf --> -0.467544).  Saving model ...
Epoch: 2 cost time: 13.848562002182007
Epoch: 2, Steps: 67 | Train Loss: 28.496 Vali Loss: 13.106 Vali Acc: 0.590 Test Loss: 13.106 Test Acc: 0.590
Validation loss decreased (-0.467544 --> -0.589464).  Saving model ...
Epoch: 3 cost time: 14.06860065460205
Epoch: 3, Steps: 67 | Train Loss: 4.039 Vali Loss: 13.014 Vali Acc: 0.717 Test Loss: 13.014 Test Acc: 0.717
Validation loss decreased (-0.589464 --> -0.716633).  Saving model ...
Epoch: 4 cost time: 14.148748636245728
Epoch: 4, Steps: 67 | Train Loss: 1.283 Vali Loss: 9.339 Vali Acc: 0.705 Test Loss: 9.339 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.330124139785767
Epoch: 5, Steps: 67 | Train Loss: 0.792 Vali Loss: 9.293 Vali Acc: 0.769 Test Loss: 9.293 Test Acc: 0.769
Validation loss decreased (-0.716633 --> -0.768693).  Saving model ...
Epoch: 6 cost time: 14.128348588943481
Epoch: 6, Steps: 67 | Train Loss: 0.843 Vali Loss: 4.317 Vali Acc: 0.740 Test Loss: 4.317 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.213601350784302
Epoch: 7, Steps: 67 | Train Loss: 0.087 Vali Loss: 6.829 Vali Acc: 0.705 Test Loss: 6.829 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 14.220931768417358
Epoch: 8, Steps: 67 | Train Loss: 0.339 Vali Loss: 13.586 Vali Acc: 0.723 Test Loss: 13.586 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 14.323171377182007
Epoch: 9, Steps: 67 | Train Loss: 0.824 Vali Loss: 5.206 Vali Acc: 0.763 Test Loss: 5.206 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 14.141634464263916
Epoch: 10, Steps: 67 | Train Loss: 0.202 Vali Loss: 7.775 Vali Acc: 0.757 Test Loss: 7.775 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 14.18592381477356
Epoch: 11, Steps: 67 | Train Loss: 0.618 Vali Loss: 18.446 Vali Acc: 0.659 Test Loss: 18.446 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.265827178955078
Epoch: 12, Steps: 67 | Train Loss: 0.529 Vali Loss: 23.211 Vali Acc: 0.671 Test Loss: 23.211 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.523595333099365
Epoch: 13, Steps: 67 | Train Loss: 0.950 Vali Loss: 6.381 Vali Acc: 0.734 Test Loss: 6.381 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 14.353027582168579
Epoch: 14, Steps: 67 | Train Loss: 0.958 Vali Loss: 6.874 Vali Acc: 0.803 Test Loss: 6.874 Test Acc: 0.803
Validation loss decreased (-0.768693 --> -0.803399).  Saving model ...
Epoch: 15 cost time: 14.3395254611969
Epoch: 15, Steps: 67 | Train Loss: 0.367 Vali Loss: 22.030 Vali Acc: 0.699 Test Loss: 22.030 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.269657135009766
Epoch: 16, Steps: 67 | Train Loss: 0.090 Vali Loss: 18.707 Vali Acc: 0.711 Test Loss: 18.707 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 14.324918270111084
Epoch: 17, Steps: 67 | Train Loss: 0.162 Vali Loss: 13.261 Vali Acc: 0.775 Test Loss: 13.261 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.22785496711731
Epoch: 18, Steps: 67 | Train Loss: 0.284 Vali Loss: 23.223 Vali Acc: 0.665 Test Loss: 23.223 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.388437271118164
Epoch: 19, Steps: 67 | Train Loss: 0.594 Vali Loss: 12.711 Vali Acc: 0.798 Test Loss: 12.711 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 14.16411542892456
Epoch: 20, Steps: 67 | Train Loss: 0.323 Vali Loss: 11.994 Vali Acc: 0.780 Test Loss: 11.994 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 14.308634042739868
Epoch: 21, Steps: 67 | Train Loss: 0.001 Vali Loss: 25.482 Vali Acc: 0.746 Test Loss: 25.482 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 14.25886607170105
Epoch: 22, Steps: 67 | Train Loss: 1.431 Vali Loss: 16.748 Vali Acc: 0.711 Test Loss: 16.748 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.284432172775269
Epoch: 23, Steps: 67 | Train Loss: 1.514 Vali Loss: 20.280 Vali Acc: 0.688 Test Loss: 20.280 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 14.351849555969238
Epoch: 24, Steps: 67 | Train Loss: 0.574 Vali Loss: 14.480 Vali Acc: 0.798 Test Loss: 14.480 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 15598855
model size : 60.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.176814317703247
Epoch: 1, Steps: 67 | Train Loss: 29.768 Vali Loss: 21.145 Vali Acc: 0.497 Test Loss: 21.145 Test Acc: 0.497
Validation loss decreased (inf --> -0.496898).  Saving model ...
Epoch: 2 cost time: 8.892073154449463
Epoch: 2, Steps: 67 | Train Loss: 12.108 Vali Loss: 14.939 Vali Acc: 0.659 Test Loss: 14.939 Test Acc: 0.659
Validation loss decreased (-0.496898 --> -0.658810).  Saving model ...
Epoch: 3 cost time: 8.949779987335205
Epoch: 3, Steps: 67 | Train Loss: 9.597 Vali Loss: 12.444 Vali Acc: 0.705 Test Loss: 12.444 Test Acc: 0.705
Validation loss decreased (-0.658810 --> -0.705078).  Saving model ...
Epoch: 4 cost time: 8.995018243789673
Epoch: 4, Steps: 67 | Train Loss: 0.936 Vali Loss: 2.666 Vali Acc: 0.740 Test Loss: 2.666 Test Acc: 0.740
Validation loss decreased (-0.705078 --> -0.739858).  Saving model ...
Epoch: 5 cost time: 9.029366254806519
Epoch: 5, Steps: 67 | Train Loss: 0.007 Vali Loss: 2.379 Vali Acc: 0.798 Test Loss: 2.379 Test Acc: 0.798
Validation loss decreased (-0.739858 --> -0.797664).  Saving model ...
Epoch: 6 cost time: 9.01230001449585
Epoch: 6, Steps: 67 | Train Loss: 0.014 Vali Loss: 2.593 Vali Acc: 0.855 Test Loss: 2.593 Test Acc: 0.855
Validation loss decreased (-0.797664 --> -0.855465).  Saving model ...
Epoch: 7 cost time: 9.08870530128479
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.656 Vali Acc: 0.855 Test Loss: 2.656 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.070852518081665
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.649 Vali Acc: 0.855 Test Loss: 2.649 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.047737836837769
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.644 Vali Acc: 0.855 Test Loss: 2.644 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.124608755111694
Epoch: 10, Steps: 67 | Train Loss: 0.091 Vali Loss: 4.946 Vali Acc: 0.803 Test Loss: 4.946 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.934888124465942
Epoch: 11, Steps: 67 | Train Loss: 0.116 Vali Loss: 3.887 Vali Acc: 0.832 Test Loss: 3.887 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.133750915527344
Epoch: 12, Steps: 67 | Train Loss: 0.363 Vali Loss: 8.372 Vali Acc: 0.740 Test Loss: 8.372 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.121363878250122
Epoch: 13, Steps: 67 | Train Loss: 0.647 Vali Loss: 7.340 Vali Acc: 0.769 Test Loss: 7.340 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.970089673995972
Epoch: 14, Steps: 67 | Train Loss: 1.282 Vali Loss: 9.843 Vali Acc: 0.746 Test Loss: 9.843 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.084271669387817
Epoch: 15, Steps: 67 | Train Loss: 1.185 Vali Loss: 10.224 Vali Acc: 0.746 Test Loss: 10.224 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.007527828216553
Epoch: 16, Steps: 67 | Train Loss: 0.688 Vali Loss: 22.165 Vali Acc: 0.751 Test Loss: 22.165 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 10421959
model size : 40.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.108786582946777
Epoch: 1, Steps: 67 | Train Loss: 13.480 Vali Loss: 22.759 Vali Acc: 0.462 Test Loss: 22.759 Test Acc: 0.462
Validation loss decreased (inf --> -0.462200).  Saving model ...
Epoch: 2 cost time: 7.755473375320435
Epoch: 2, Steps: 67 | Train Loss: 11.228 Vali Loss: 13.342 Vali Acc: 0.653 Test Loss: 13.342 Test Acc: 0.653
Validation loss decreased (-0.462200 --> -0.653046).  Saving model ...
Epoch: 3 cost time: 7.821418523788452
Epoch: 3, Steps: 67 | Train Loss: 2.626 Vali Loss: 7.184 Vali Acc: 0.740 Test Loss: 7.184 Test Acc: 0.740
Validation loss decreased (-0.653046 --> -0.739813).  Saving model ...
Epoch: 4 cost time: 7.829079627990723
Epoch: 4, Steps: 67 | Train Loss: 0.495 Vali Loss: 5.545 Vali Acc: 0.746 Test Loss: 5.545 Test Acc: 0.746
Validation loss decreased (-0.739813 --> -0.745609).  Saving model ...
Epoch: 5 cost time: 7.744647979736328
Epoch: 5, Steps: 67 | Train Loss: 0.870 Vali Loss: 8.549 Vali Acc: 0.688 Test Loss: 8.549 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.010255575180054
Epoch: 6, Steps: 67 | Train Loss: 0.372 Vali Loss: 5.855 Vali Acc: 0.746 Test Loss: 5.855 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.887638330459595
Epoch: 7, Steps: 67 | Train Loss: 0.458 Vali Loss: 10.566 Vali Acc: 0.699 Test Loss: 10.566 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.893551588058472
Epoch: 8, Steps: 67 | Train Loss: 0.535 Vali Loss: 4.272 Vali Acc: 0.769 Test Loss: 4.272 Test Acc: 0.769
Validation loss decreased (-0.745609 --> -0.768743).  Saving model ...
Epoch: 9 cost time: 7.8293023109436035
Epoch: 9, Steps: 67 | Train Loss: 0.220 Vali Loss: 5.396 Vali Acc: 0.757 Test Loss: 5.396 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.978068590164185
Epoch: 10, Steps: 67 | Train Loss: 0.100 Vali Loss: 3.123 Vali Acc: 0.786 Test Loss: 3.123 Test Acc: 0.786
Validation loss decreased (-0.768743 --> -0.786096).  Saving model ...
Epoch: 11 cost time: 7.967888355255127
Epoch: 11, Steps: 67 | Train Loss: 0.238 Vali Loss: 2.760 Vali Acc: 0.838 Test Loss: 2.760 Test Acc: 0.838
Validation loss decreased (-0.786096 --> -0.838123).  Saving model ...
Epoch: 12 cost time: 7.871329307556152
Epoch: 12, Steps: 67 | Train Loss: 0.109 Vali Loss: 5.046 Vali Acc: 0.786 Test Loss: 5.046 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.952775955200195
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.995 Vali Acc: 0.844 Test Loss: 2.995 Test Acc: 0.844
Validation loss decreased (-0.838123 --> -0.843901).  Saving model ...
Epoch: 14 cost time: 7.870082855224609
Epoch: 14, Steps: 67 | Train Loss: 0.007 Vali Loss: 4.832 Vali Acc: 0.827 Test Loss: 4.832 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.161611080169678
Epoch: 15, Steps: 67 | Train Loss: 0.097 Vali Loss: 3.129 Vali Acc: 0.850 Test Loss: 3.129 Test Acc: 0.850
Validation loss decreased (-0.843901 --> -0.849680).  Saving model ...
Epoch: 16 cost time: 8.044891119003296
Epoch: 16, Steps: 67 | Train Loss: 0.305 Vali Loss: 2.771 Vali Acc: 0.838 Test Loss: 2.771 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.038186073303223
Epoch: 17, Steps: 67 | Train Loss: 0.406 Vali Loss: 4.419 Vali Acc: 0.786 Test Loss: 4.419 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.971702337265015
Epoch: 18, Steps: 67 | Train Loss: 1.365 Vali Loss: 8.852 Vali Acc: 0.740 Test Loss: 8.852 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.930938005447388
Epoch: 19, Steps: 67 | Train Loss: 0.545 Vali Loss: 8.226 Vali Acc: 0.780 Test Loss: 8.226 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.064293384552002
Epoch: 20, Steps: 67 | Train Loss: 0.522 Vali Loss: 9.644 Vali Acc: 0.815 Test Loss: 9.644 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.837101459503174
Epoch: 21, Steps: 67 | Train Loss: 0.333 Vali Loss: 7.162 Vali Acc: 0.809 Test Loss: 7.162 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.11187744140625
Epoch: 22, Steps: 67 | Train Loss: 0.073 Vali Loss: 24.861 Vali Acc: 0.746 Test Loss: 24.861 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.18416976928711
Epoch: 23, Steps: 67 | Train Loss: 0.749 Vali Loss: 14.509 Vali Acc: 0.676 Test Loss: 14.509 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.136389970779419
Epoch: 24, Steps: 67 | Train Loss: 0.185 Vali Loss: 16.100 Vali Acc: 0.786 Test Loss: 16.100 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.177412748336792
Epoch: 25, Steps: 67 | Train Loss: 0.361 Vali Loss: 7.474 Vali Acc: 0.821 Test Loss: 7.474 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 7833671
model size : 31.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.018798828125
Epoch: 1, Steps: 67 | Train Loss: 8.221 Vali Loss: 18.651 Vali Acc: 0.514 Test Loss: 18.651 Test Acc: 0.514
Validation loss decreased (inf --> -0.514264).  Saving model ...
Epoch: 2 cost time: 5.483988046646118
Epoch: 2, Steps: 67 | Train Loss: 9.479 Vali Loss: 7.122 Vali Acc: 0.613 Test Loss: 7.122 Test Acc: 0.613
Validation loss decreased (-0.514264 --> -0.612646).  Saving model ...
Epoch: 3 cost time: 5.370361566543579
Epoch: 3, Steps: 67 | Train Loss: 3.398 Vali Loss: 4.436 Vali Acc: 0.786 Test Loss: 4.436 Test Acc: 0.786
Validation loss decreased (-0.612646 --> -0.786083).  Saving model ...
Epoch: 4 cost time: 5.356390953063965
Epoch: 4, Steps: 67 | Train Loss: 0.994 Vali Loss: 3.006 Vali Acc: 0.827 Test Loss: 3.006 Test Acc: 0.827
Validation loss decreased (-0.786083 --> -0.826560).  Saving model ...
Epoch: 5 cost time: 5.430897951126099
Epoch: 5, Steps: 67 | Train Loss: 1.277 Vali Loss: 9.343 Vali Acc: 0.751 Test Loss: 9.343 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.439639329910278
Epoch: 6, Steps: 67 | Train Loss: 0.673 Vali Loss: 5.862 Vali Acc: 0.775 Test Loss: 5.862 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.483240842819214
Epoch: 7, Steps: 67 | Train Loss: 0.114 Vali Loss: 5.476 Vali Acc: 0.792 Test Loss: 5.476 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.474215269088745
Epoch: 8, Steps: 67 | Train Loss: 0.477 Vali Loss: 2.693 Vali Acc: 0.803 Test Loss: 2.693 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.479020118713379
Epoch: 9, Steps: 67 | Train Loss: 0.120 Vali Loss: 3.196 Vali Acc: 0.792 Test Loss: 3.196 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.528017044067383
Epoch: 10, Steps: 67 | Train Loss: 0.019 Vali Loss: 7.291 Vali Acc: 0.786 Test Loss: 7.291 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.416722774505615
Epoch: 11, Steps: 67 | Train Loss: 0.220 Vali Loss: 6.172 Vali Acc: 0.734 Test Loss: 6.172 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.4379236698150635
Epoch: 12, Steps: 67 | Train Loss: 0.090 Vali Loss: 8.382 Vali Acc: 0.746 Test Loss: 8.382 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.505018711090088
Epoch: 13, Steps: 67 | Train Loss: 0.168 Vali Loss: 2.657 Vali Acc: 0.786 Test Loss: 2.657 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.3685643672943115
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.699 Vali Acc: 0.798 Test Loss: 2.699 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5676999
model size : 22.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.32909369468689
Epoch: 1, Steps: 67 | Train Loss: 8.961 Vali Loss: 13.654 Vali Acc: 0.480 Test Loss: 13.654 Test Acc: 0.480
Validation loss decreased (inf --> -0.479632).  Saving model ...
Epoch: 2 cost time: 4.556558609008789
Epoch: 2, Steps: 67 | Train Loss: 5.497 Vali Loss: 5.513 Vali Acc: 0.538 Test Loss: 5.513 Test Acc: 0.538
Validation loss decreased (-0.479632 --> -0.537517).  Saving model ...
Epoch: 3 cost time: 4.567153215408325
Epoch: 3, Steps: 67 | Train Loss: 1.116 Vali Loss: 2.015 Vali Acc: 0.705 Test Loss: 2.015 Test Acc: 0.705
Validation loss decreased (-0.537517 --> -0.705182).  Saving model ...
Epoch: 4 cost time: 4.73740816116333
Epoch: 4, Steps: 67 | Train Loss: 0.227 Vali Loss: 1.658 Vali Acc: 0.803 Test Loss: 1.658 Test Acc: 0.803
Validation loss decreased (-0.705182 --> -0.803452).  Saving model ...
Epoch: 5 cost time: 4.585357666015625
Epoch: 5, Steps: 67 | Train Loss: 0.154 Vali Loss: 2.044 Vali Acc: 0.757 Test Loss: 2.044 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.917591571807861
Epoch: 6, Steps: 67 | Train Loss: 0.182 Vali Loss: 1.848 Vali Acc: 0.792 Test Loss: 1.848 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.819331645965576
Epoch: 7, Steps: 67 | Train Loss: 0.073 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
Validation loss decreased (-0.803452 --> -0.809238).  Saving model ...
Epoch: 8 cost time: 4.559393405914307
Epoch: 8, Steps: 67 | Train Loss: 0.025 Vali Loss: 0.780 Vali Acc: 0.815 Test Loss: 0.780 Test Acc: 0.815
Validation loss decreased (-0.809238 --> -0.815021).  Saving model ...
Epoch: 9 cost time: 4.725796937942505
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.815 Test Loss: 0.935 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.61133337020874
Epoch: 10, Steps: 67 | Train Loss: 0.082 Vali Loss: 2.477 Vali Acc: 0.786 Test Loss: 2.477 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.628162622451782
Epoch: 11, Steps: 67 | Train Loss: 0.252 Vali Loss: 4.097 Vali Acc: 0.769 Test Loss: 4.097 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.788849353790283
Epoch: 12, Steps: 67 | Train Loss: 0.051 Vali Loss: 6.937 Vali Acc: 0.636 Test Loss: 6.937 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.643025159835815
Epoch: 13, Steps: 67 | Train Loss: 0.311 Vali Loss: 5.410 Vali Acc: 0.775 Test Loss: 5.410 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.6176886558532715
Epoch: 14, Steps: 67 | Train Loss: 0.224 Vali Loss: 3.362 Vali Acc: 0.780 Test Loss: 3.362 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.659503221511841
Epoch: 15, Steps: 67 | Train Loss: 0.183 Vali Loss: 5.853 Vali Acc: 0.798 Test Loss: 5.853 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.672690153121948
Epoch: 16, Steps: 67 | Train Loss: 0.432 Vali Loss: 11.841 Vali Acc: 0.613 Test Loss: 11.841 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.733095169067383
Epoch: 17, Steps: 67 | Train Loss: 0.135 Vali Loss: 7.929 Vali Acc: 0.769 Test Loss: 7.929 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.622234582901001
Epoch: 18, Steps: 67 | Train Loss: 1.152 Vali Loss: 6.052 Vali Acc: 0.723 Test Loss: 6.052 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 3951751
model size : 16.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.804068088531494
Epoch: 1, Steps: 67 | Train Loss: 7.943 Vali Loss: 10.794 Vali Acc: 0.445 Test Loss: 10.794 Test Acc: 0.445
Validation loss decreased (inf --> -0.444979).  Saving model ...
Epoch: 2 cost time: 3.841306209564209
Epoch: 2, Steps: 67 | Train Loss: 3.614 Vali Loss: 3.189 Vali Acc: 0.728 Test Loss: 3.189 Test Acc: 0.728
Validation loss decreased (-0.444979 --> -0.728292).  Saving model ...
Epoch: 3 cost time: 3.8811182975769043
Epoch: 3, Steps: 67 | Train Loss: 1.667 Vali Loss: 2.388 Vali Acc: 0.775 Test Loss: 2.388 Test Acc: 0.775
Validation loss decreased (-0.728292 --> -0.774543).  Saving model ...
Epoch: 4 cost time: 3.944507598876953
Epoch: 4, Steps: 67 | Train Loss: 0.277 Vali Loss: 2.768 Vali Acc: 0.827 Test Loss: 2.768 Test Acc: 0.827
Validation loss decreased (-0.774543 --> -0.826562).  Saving model ...
Epoch: 5 cost time: 3.737025499343872
Epoch: 5, Steps: 67 | Train Loss: 0.190 Vali Loss: 4.925 Vali Acc: 0.757 Test Loss: 4.925 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8514723777770996
Epoch: 6, Steps: 67 | Train Loss: 0.099 Vali Loss: 3.067 Vali Acc: 0.780 Test Loss: 3.067 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8691368103027344
Epoch: 7, Steps: 67 | Train Loss: 0.271 Vali Loss: 7.239 Vali Acc: 0.647 Test Loss: 7.239 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.7866456508636475
Epoch: 8, Steps: 67 | Train Loss: 0.427 Vali Loss: 4.969 Vali Acc: 0.694 Test Loss: 4.969 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.8874311447143555
Epoch: 9, Steps: 67 | Train Loss: 0.113 Vali Loss: 4.577 Vali Acc: 0.734 Test Loss: 4.577 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9223461151123047
Epoch: 10, Steps: 67 | Train Loss: 0.152 Vali Loss: 5.293 Vali Acc: 0.734 Test Loss: 5.293 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.892847776412964
Epoch: 11, Steps: 67 | Train Loss: 0.327 Vali Loss: 6.142 Vali Acc: 0.723 Test Loss: 6.142 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.067849397659302
Epoch: 12, Steps: 67 | Train Loss: 0.279 Vali Loss: 3.513 Vali Acc: 0.763 Test Loss: 3.513 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.8612983226776123
Epoch: 13, Steps: 67 | Train Loss: 0.018 Vali Loss: 2.945 Vali Acc: 0.769 Test Loss: 2.945 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.9133808612823486
Epoch: 14, Steps: 67 | Train Loss: 0.014 Vali Loss: 3.062 Vali Acc: 0.751 Test Loss: 3.062 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3520775
model size : 14.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 248.1854858
	speed: 0.2488s/iter; left time: 3309.5761s
Epoch: 1 cost time: 32.80846881866455
Epoch: 1, Steps: 134 | Train Loss: 131.874 Vali Loss: 242.751 Vali Acc: 0.347 Test Loss: 242.751 Test Acc: 0.347
Validation loss decreased (inf --> -0.344393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.5150s/iter; left time: 6780.6714s
Epoch: 2 cost time: 32.23992967605591
Epoch: 2, Steps: 134 | Train Loss: 48.253 Vali Loss: 5.245 Vali Acc: 0.590 Test Loss: 5.245 Test Acc: 0.590
Validation loss decreased (-0.344393 --> -0.589543).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.5345s/iter; left time: 6966.0431s
Epoch: 3 cost time: 32.62717580795288
Epoch: 3, Steps: 134 | Train Loss: 2.200 Vali Loss: 9.618 Vali Acc: 0.607 Test Loss: 9.618 Test Acc: 0.607
Validation loss decreased (-0.589543 --> -0.606840).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.5292s/iter; left time: 6825.9365s
Epoch: 4 cost time: 32.18871307373047
Epoch: 4, Steps: 134 | Train Loss: 0.961 Vali Loss: 4.763 Vali Acc: 0.757 Test Loss: 4.763 Test Acc: 0.757
Validation loss decreased (-0.606840 --> -0.757178).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.5381s/iter; left time: 6869.2352s
Epoch: 5 cost time: 32.769001960754395
Epoch: 5, Steps: 134 | Train Loss: 3.042 Vali Loss: 5.549 Vali Acc: 0.821 Test Loss: 5.549 Test Acc: 0.821
Validation loss decreased (-0.757178 --> -0.820754).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.5394s/iter; left time: 6813.5095s
Epoch: 6 cost time: 32.3510217666626
Epoch: 6, Steps: 134 | Train Loss: 1.534 Vali Loss: 6.727 Vali Acc: 0.815 Test Loss: 6.727 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 9.1545258
	speed: 0.5255s/iter; left time: 6567.3133s
Epoch: 7 cost time: 32.49310898780823
Epoch: 7, Steps: 134 | Train Loss: 0.917 Vali Loss: 11.691 Vali Acc: 0.792 Test Loss: 11.691 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.5260s/iter; left time: 6503.4572s
Epoch: 8 cost time: 32.63780617713928
Epoch: 8, Steps: 134 | Train Loss: 1.511 Vali Loss: 14.142 Vali Acc: 0.780 Test Loss: 14.142 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.5270s/iter; left time: 6444.1712s
Epoch: 9 cost time: 32.6432626247406
Epoch: 9, Steps: 134 | Train Loss: 0.129 Vali Loss: 20.532 Vali Acc: 0.780 Test Loss: 20.532 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0045771
	speed: 0.5314s/iter; left time: 6427.4117s
Epoch: 10 cost time: 32.844265937805176
Epoch: 10, Steps: 134 | Train Loss: 2.335 Vali Loss: 58.610 Vali Acc: 0.491 Test Loss: 58.610 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5307s/iter; left time: 6347.5395s
Epoch: 11 cost time: 32.6822783946991
Epoch: 11, Steps: 134 | Train Loss: 5.727 Vali Loss: 20.389 Vali Acc: 0.711 Test Loss: 20.389 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.5275s/iter; left time: 6238.2790s
Epoch: 12 cost time: 32.571741580963135
Epoch: 12, Steps: 134 | Train Loss: 1.995 Vali Loss: 7.591 Vali Acc: 0.786 Test Loss: 7.591 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.5224s/iter; left time: 6108.7703s
Epoch: 13 cost time: 32.52064538002014
Epoch: 13, Steps: 134 | Train Loss: 1.264 Vali Loss: 21.189 Vali Acc: 0.734 Test Loss: 21.189 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5179s/iter; left time: 5986.9485s
Epoch: 14 cost time: 32.16576552391052
Epoch: 14, Steps: 134 | Train Loss: 0.343 Vali Loss: 22.887 Vali Acc: 0.792 Test Loss: 22.887 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.5294s/iter; left time: 6048.6611s
Epoch: 15 cost time: 32.62497043609619
Epoch: 15, Steps: 134 | Train Loss: 1.115 Vali Loss: 51.027 Vali Acc: 0.711 Test Loss: 51.027 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 31113351
model size : 119.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.036216020584106
Epoch: 1, Steps: 67 | Train Loss: 34.006 Vali Loss: 83.908 Vali Acc: 0.376 Test Loss: 83.908 Test Acc: 0.376
Validation loss decreased (inf --> -0.374883).  Saving model ...
Epoch: 2 cost time: 12.56565260887146
Epoch: 2, Steps: 67 | Train Loss: 28.923 Vali Loss: 17.289 Vali Acc: 0.671 Test Loss: 17.289 Test Acc: 0.671
Validation loss decreased (-0.374883 --> -0.670347).  Saving model ...
Epoch: 3 cost time: 12.89790678024292
Epoch: 3, Steps: 67 | Train Loss: 7.896 Vali Loss: 17.383 Vali Acc: 0.566 Test Loss: 17.383 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.692769050598145
Epoch: 4, Steps: 67 | Train Loss: 2.163 Vali Loss: 2.459 Vali Acc: 0.792 Test Loss: 2.459 Test Acc: 0.792
Validation loss decreased (-0.670347 --> -0.791883).  Saving model ...
Epoch: 5 cost time: 12.851417541503906
Epoch: 5, Steps: 67 | Train Loss: 0.213 Vali Loss: 2.736 Vali Acc: 0.815 Test Loss: 2.736 Test Acc: 0.815
Validation loss decreased (-0.791883 --> -0.815002).  Saving model ...
Epoch: 6 cost time: 12.707785367965698
Epoch: 6, Steps: 67 | Train Loss: 0.282 Vali Loss: 4.499 Vali Acc: 0.786 Test Loss: 4.499 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.543836832046509
Epoch: 7, Steps: 67 | Train Loss: 0.268 Vali Loss: 4.240 Vali Acc: 0.775 Test Loss: 4.240 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.509578227996826
Epoch: 8, Steps: 67 | Train Loss: 0.432 Vali Loss: 12.178 Vali Acc: 0.671 Test Loss: 12.178 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.515790939331055
Epoch: 9, Steps: 67 | Train Loss: 0.344 Vali Loss: 9.288 Vali Acc: 0.734 Test Loss: 9.288 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 12.7767653465271
Epoch: 10, Steps: 67 | Train Loss: 0.918 Vali Loss: 9.709 Vali Acc: 0.775 Test Loss: 9.709 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.846223831176758
Epoch: 11, Steps: 67 | Train Loss: 0.277 Vali Loss: 6.994 Vali Acc: 0.769 Test Loss: 6.994 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.542121648788452
Epoch: 12, Steps: 67 | Train Loss: 0.306 Vali Loss: 16.628 Vali Acc: 0.746 Test Loss: 16.628 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 12.551427364349365
Epoch: 13, Steps: 67 | Train Loss: 1.349 Vali Loss: 9.343 Vali Acc: 0.717 Test Loss: 9.343 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 12.790863990783691
Epoch: 14, Steps: 67 | Train Loss: 1.669 Vali Loss: 31.467 Vali Acc: 0.538 Test Loss: 31.467 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 12.518046617507935
Epoch: 15, Steps: 67 | Train Loss: 2.218 Vali Loss: 11.273 Vali Acc: 0.780 Test Loss: 11.273 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15582343
model size : 60.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.941161155700684
Epoch: 1, Steps: 67 | Train Loss: 25.262 Vali Loss: 42.532 Vali Acc: 0.422 Test Loss: 42.532 Test Acc: 0.422
Validation loss decreased (inf --> -0.421540).  Saving model ...
Epoch: 2 cost time: 8.546199560165405
Epoch: 2, Steps: 67 | Train Loss: 24.163 Vali Loss: 20.497 Vali Acc: 0.578 Test Loss: 20.497 Test Acc: 0.578
Validation loss decreased (-0.421540 --> -0.577830).  Saving model ...
Epoch: 3 cost time: 8.516954898834229
Epoch: 3, Steps: 67 | Train Loss: 7.199 Vali Loss: 21.845 Vali Acc: 0.659 Test Loss: 21.845 Test Acc: 0.659
Validation loss decreased (-0.577830 --> -0.658741).  Saving model ...
Epoch: 4 cost time: 8.684218406677246
Epoch: 4, Steps: 67 | Train Loss: 4.455 Vali Loss: 9.762 Vali Acc: 0.699 Test Loss: 9.762 Test Acc: 0.699
Validation loss decreased (-0.658741 --> -0.699324).  Saving model ...
Epoch: 5 cost time: 8.762884140014648
Epoch: 5, Steps: 67 | Train Loss: 0.179 Vali Loss: 5.001 Vali Acc: 0.751 Test Loss: 5.001 Test Acc: 0.751
Validation loss decreased (-0.699324 --> -0.751395).  Saving model ...
Epoch: 6 cost time: 8.653438091278076
Epoch: 6, Steps: 67 | Train Loss: 0.137 Vali Loss: 8.933 Vali Acc: 0.798 Test Loss: 8.933 Test Acc: 0.798
Validation loss decreased (-0.751395 --> -0.797599).  Saving model ...
Epoch: 7 cost time: 8.603117942810059
Epoch: 7, Steps: 67 | Train Loss: 0.236 Vali Loss: 8.361 Vali Acc: 0.803 Test Loss: 8.361 Test Acc: 0.803
Validation loss decreased (-0.797599 --> -0.803385).  Saving model ...
Epoch: 8 cost time: 8.689919471740723
Epoch: 8, Steps: 67 | Train Loss: 0.021 Vali Loss: 7.276 Vali Acc: 0.717 Test Loss: 7.276 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.79665207862854
Epoch: 9, Steps: 67 | Train Loss: 0.074 Vali Loss: 4.493 Vali Acc: 0.780 Test Loss: 4.493 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.849503755569458
Epoch: 10, Steps: 67 | Train Loss: 0.333 Vali Loss: 2.989 Vali Acc: 0.873 Test Loss: 2.989 Test Acc: 0.873
Validation loss decreased (-0.803385 --> -0.872802).  Saving model ...
Epoch: 11 cost time: 8.741681814193726
Epoch: 11, Steps: 67 | Train Loss: 0.202 Vali Loss: 6.283 Vali Acc: 0.746 Test Loss: 6.283 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.064978122711182
Epoch: 12, Steps: 67 | Train Loss: 0.366 Vali Loss: 5.398 Vali Acc: 0.798 Test Loss: 5.398 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.139409303665161
Epoch: 13, Steps: 67 | Train Loss: 0.208 Vali Loss: 3.133 Vali Acc: 0.815 Test Loss: 3.133 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.80233097076416
Epoch: 14, Steps: 67 | Train Loss: 0.501 Vali Loss: 3.350 Vali Acc: 0.855 Test Loss: 3.350 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.00726866722107
Epoch: 15, Steps: 67 | Train Loss: 0.031 Vali Loss: 9.206 Vali Acc: 0.798 Test Loss: 9.206 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.943608522415161
Epoch: 16, Steps: 67 | Train Loss: 0.045 Vali Loss: 16.107 Vali Acc: 0.751 Test Loss: 16.107 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.820396661758423
Epoch: 17, Steps: 67 | Train Loss: 0.618 Vali Loss: 5.891 Vali Acc: 0.815 Test Loss: 5.891 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.865844249725342
Epoch: 18, Steps: 67 | Train Loss: 1.523 Vali Loss: 6.015 Vali Acc: 0.775 Test Loss: 6.015 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 8.983937978744507
Epoch: 19, Steps: 67 | Train Loss: 0.889 Vali Loss: 8.661 Vali Acc: 0.769 Test Loss: 8.661 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.0771164894104
Epoch: 20, Steps: 67 | Train Loss: 0.833 Vali Loss: 30.921 Vali Acc: 0.694 Test Loss: 30.921 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 10405447
model size : 40.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.332694292068481
Epoch: 1, Steps: 67 | Train Loss: 13.176 Vali Loss: 15.838 Vali Acc: 0.393 Test Loss: 15.838 Test Acc: 0.393
Validation loss decreased (inf --> -0.392905).  Saving model ...
Epoch: 2 cost time: 7.508504867553711
Epoch: 2, Steps: 67 | Train Loss: 14.871 Vali Loss: 5.980 Vali Acc: 0.763 Test Loss: 5.980 Test Acc: 0.763
Validation loss decreased (-0.392905 --> -0.762946).  Saving model ...
Epoch: 3 cost time: 7.4721314907073975
Epoch: 3, Steps: 67 | Train Loss: 2.862 Vali Loss: 3.318 Vali Acc: 0.734 Test Loss: 3.318 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.577277660369873
Epoch: 4, Steps: 67 | Train Loss: 1.481 Vali Loss: 4.352 Vali Acc: 0.751 Test Loss: 4.352 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.760615110397339
Epoch: 5, Steps: 67 | Train Loss: 0.795 Vali Loss: 6.700 Vali Acc: 0.763 Test Loss: 6.700 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.8376123905181885
Epoch: 6, Steps: 67 | Train Loss: 0.888 Vali Loss: 3.054 Vali Acc: 0.809 Test Loss: 3.054 Test Acc: 0.809
Validation loss decreased (-0.762946 --> -0.809218).  Saving model ...
Epoch: 7 cost time: 7.752420425415039
Epoch: 7, Steps: 67 | Train Loss: 0.200 Vali Loss: 7.482 Vali Acc: 0.699 Test Loss: 7.482 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.728685140609741
Epoch: 8, Steps: 67 | Train Loss: 0.421 Vali Loss: 7.096 Vali Acc: 0.746 Test Loss: 7.096 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.746896028518677
Epoch: 9, Steps: 67 | Train Loss: 0.389 Vali Loss: 6.912 Vali Acc: 0.786 Test Loss: 6.912 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.639392137527466
Epoch: 10, Steps: 67 | Train Loss: 0.003 Vali Loss: 5.735 Vali Acc: 0.786 Test Loss: 5.735 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.858647108078003
Epoch: 11, Steps: 67 | Train Loss: 0.185 Vali Loss: 6.561 Vali Acc: 0.792 Test Loss: 6.561 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.743035793304443
Epoch: 12, Steps: 67 | Train Loss: 0.526 Vali Loss: 3.480 Vali Acc: 0.832 Test Loss: 3.480 Test Acc: 0.832
Validation loss decreased (-0.809218 --> -0.832335).  Saving model ...
Epoch: 13 cost time: 7.89608359336853
Epoch: 13, Steps: 67 | Train Loss: 0.234 Vali Loss: 12.012 Vali Acc: 0.746 Test Loss: 12.012 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.647443771362305
Epoch: 14, Steps: 67 | Train Loss: 0.166 Vali Loss: 7.763 Vali Acc: 0.780 Test Loss: 7.763 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.642316579818726
Epoch: 15, Steps: 67 | Train Loss: 0.110 Vali Loss: 16.153 Vali Acc: 0.728 Test Loss: 16.153 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.500654697418213
Epoch: 16, Steps: 67 | Train Loss: 0.078 Vali Loss: 9.050 Vali Acc: 0.688 Test Loss: 9.050 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.538170337677002
Epoch: 17, Steps: 67 | Train Loss: 0.681 Vali Loss: 5.106 Vali Acc: 0.786 Test Loss: 5.106 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.786705017089844
Epoch: 18, Steps: 67 | Train Loss: 0.208 Vali Loss: 3.851 Vali Acc: 0.838 Test Loss: 3.851 Test Acc: 0.838
Validation loss decreased (-0.832335 --> -0.838112).  Saving model ...
Epoch: 19 cost time: 7.67406153678894
Epoch: 19, Steps: 67 | Train Loss: 0.533 Vali Loss: 8.694 Vali Acc: 0.763 Test Loss: 8.694 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.5733044147491455
Epoch: 20, Steps: 67 | Train Loss: 0.709 Vali Loss: 8.309 Vali Acc: 0.838 Test Loss: 8.309 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.634839057922363
Epoch: 21, Steps: 67 | Train Loss: 0.072 Vali Loss: 10.028 Vali Acc: 0.792 Test Loss: 10.028 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.778468370437622
Epoch: 22, Steps: 67 | Train Loss: 0.517 Vali Loss: 7.849 Vali Acc: 0.798 Test Loss: 7.849 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.733348608016968
Epoch: 23, Steps: 67 | Train Loss: 0.440 Vali Loss: 10.134 Vali Acc: 0.775 Test Loss: 10.134 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.603144407272339
Epoch: 24, Steps: 67 | Train Loss: 0.837 Vali Loss: 9.315 Vali Acc: 0.809 Test Loss: 9.315 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.580749988555908
Epoch: 25, Steps: 67 | Train Loss: 0.104 Vali Loss: 8.377 Vali Acc: 0.827 Test Loss: 8.377 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.638729810714722
Epoch: 26, Steps: 67 | Train Loss: 0.107 Vali Loss: 10.837 Vali Acc: 0.832 Test Loss: 10.837 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.830271244049072
Epoch: 27, Steps: 67 | Train Loss: 0.185 Vali Loss: 4.402 Vali Acc: 0.850 Test Loss: 4.402 Test Acc: 0.850
Validation loss decreased (-0.838112 --> -0.849667).  Saving model ...
Epoch: 28 cost time: 7.890240669250488
Epoch: 28, Steps: 67 | Train Loss: 0.325 Vali Loss: 11.840 Vali Acc: 0.751 Test Loss: 11.840 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.698353052139282
Epoch: 29, Steps: 67 | Train Loss: 0.240 Vali Loss: 9.783 Vali Acc: 0.780 Test Loss: 9.783 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.706319332122803
Epoch: 30, Steps: 67 | Train Loss: 0.026 Vali Loss: 18.423 Vali Acc: 0.734 Test Loss: 18.423 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.6736321449279785
Epoch: 31, Steps: 67 | Train Loss: 0.501 Vali Loss: 7.715 Vali Acc: 0.838 Test Loss: 7.715 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 7.537409067153931
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.756 Vali Acc: 0.803 Test Loss: 7.756 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 7.633875131607056
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.780 Vali Acc: 0.803 Test Loss: 7.780 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 7.652802228927612
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.776 Vali Acc: 0.803 Test Loss: 7.776 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 7.872086763381958
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.762 Vali Acc: 0.803 Test Loss: 7.762 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 7.858050346374512
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.771 Vali Acc: 0.803 Test Loss: 7.771 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.767409563064575
Epoch: 37, Steps: 67 | Train Loss: 0.089 Vali Loss: 11.819 Vali Acc: 0.815 Test Loss: 11.819 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 7817159
model size : 31.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.6011645793914795
Epoch: 1, Steps: 67 | Train Loss: 8.419 Vali Loss: 29.018 Vali Acc: 0.486 Test Loss: 29.018 Test Acc: 0.486
Validation loss decreased (inf --> -0.485259).  Saving model ...
Epoch: 2 cost time: 5.4578166007995605
Epoch: 2, Steps: 67 | Train Loss: 8.853 Vali Loss: 8.280 Vali Acc: 0.688 Test Loss: 8.280 Test Acc: 0.688
Validation loss decreased (-0.485259 --> -0.687778).  Saving model ...
Epoch: 3 cost time: 5.232254981994629
Epoch: 3, Steps: 67 | Train Loss: 7.935 Vali Loss: 26.009 Vali Acc: 0.538 Test Loss: 26.009 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.128432989120483
Epoch: 4, Steps: 67 | Train Loss: 4.019 Vali Loss: 8.724 Vali Acc: 0.792 Test Loss: 8.724 Test Acc: 0.792
Validation loss decreased (-0.687778 --> -0.791820).  Saving model ...
Epoch: 5 cost time: 5.319130182266235
Epoch: 5, Steps: 67 | Train Loss: 1.302 Vali Loss: 3.289 Vali Acc: 0.821 Test Loss: 3.289 Test Acc: 0.821
Validation loss decreased (-0.791820 --> -0.820776).  Saving model ...
Epoch: 6 cost time: 5.302429914474487
Epoch: 6, Steps: 67 | Train Loss: 0.995 Vali Loss: 4.751 Vali Acc: 0.757 Test Loss: 4.751 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.360447645187378
Epoch: 7, Steps: 67 | Train Loss: 0.287 Vali Loss: 10.784 Vali Acc: 0.676 Test Loss: 10.784 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.183103322982788
Epoch: 8, Steps: 67 | Train Loss: 0.045 Vali Loss: 5.772 Vali Acc: 0.751 Test Loss: 5.772 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.141961336135864
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.871 Vali Acc: 0.763 Test Loss: 4.871 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.276064395904541
Epoch: 10, Steps: 67 | Train Loss: 0.360 Vali Loss: 4.725 Vali Acc: 0.792 Test Loss: 4.725 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.23161506652832
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.398 Vali Acc: 0.734 Test Loss: 8.398 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.200474500656128
Epoch: 12, Steps: 67 | Train Loss: 0.007 Vali Loss: 4.556 Vali Acc: 0.757 Test Loss: 4.556 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.1711106300354
Epoch: 13, Steps: 67 | Train Loss: 0.005 Vali Loss: 5.516 Vali Acc: 0.751 Test Loss: 5.516 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.193652629852295
Epoch: 14, Steps: 67 | Train Loss: 0.123 Vali Loss: 7.682 Vali Acc: 0.775 Test Loss: 7.682 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.447026252746582
Epoch: 15, Steps: 67 | Train Loss: 0.149 Vali Loss: 7.188 Vali Acc: 0.734 Test Loss: 7.188 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5660487
model size : 22.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.300667762756348
Epoch: 1, Steps: 67 | Train Loss: 8.174 Vali Loss: 11.523 Vali Acc: 0.509 Test Loss: 11.523 Test Acc: 0.509
Validation loss decreased (inf --> -0.508555).  Saving model ...
Epoch: 2 cost time: 4.428334474563599
Epoch: 2, Steps: 67 | Train Loss: 5.679 Vali Loss: 2.942 Vali Acc: 0.607 Test Loss: 2.942 Test Acc: 0.607
Validation loss decreased (-0.508555 --> -0.606907).  Saving model ...
Epoch: 3 cost time: 4.384119033813477
Epoch: 3, Steps: 67 | Train Loss: 1.233 Vali Loss: 1.684 Vali Acc: 0.792 Test Loss: 1.684 Test Acc: 0.792
Validation loss decreased (-0.606907 --> -0.791891).  Saving model ...
Epoch: 4 cost time: 4.498607873916626
Epoch: 4, Steps: 67 | Train Loss: 0.250 Vali Loss: 1.906 Vali Acc: 0.786 Test Loss: 1.906 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.38396430015564
Epoch: 5, Steps: 67 | Train Loss: 0.325 Vali Loss: 1.956 Vali Acc: 0.792 Test Loss: 1.956 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.40431022644043
Epoch: 6, Steps: 67 | Train Loss: 0.166 Vali Loss: 1.527 Vali Acc: 0.809 Test Loss: 1.527 Test Acc: 0.809
Validation loss decreased (-0.791891 --> -0.809233).  Saving model ...
Epoch: 7 cost time: 4.4728240966796875
Epoch: 7, Steps: 67 | Train Loss: 0.070 Vali Loss: 3.219 Vali Acc: 0.728 Test Loss: 3.219 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.296467304229736
Epoch: 8, Steps: 67 | Train Loss: 0.254 Vali Loss: 5.678 Vali Acc: 0.734 Test Loss: 5.678 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.429553747177124
Epoch: 9, Steps: 67 | Train Loss: 0.205 Vali Loss: 3.411 Vali Acc: 0.775 Test Loss: 3.411 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.316832542419434
Epoch: 10, Steps: 67 | Train Loss: 0.101 Vali Loss: 3.647 Vali Acc: 0.775 Test Loss: 3.647 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.376651287078857
Epoch: 11, Steps: 67 | Train Loss: 0.086 Vali Loss: 2.600 Vali Acc: 0.827 Test Loss: 2.600 Test Acc: 0.827
Validation loss decreased (-0.809233 --> -0.826564).  Saving model ...
Epoch: 12 cost time: 4.310809373855591
Epoch: 12, Steps: 67 | Train Loss: 0.094 Vali Loss: 1.715 Vali Acc: 0.832 Test Loss: 1.715 Test Acc: 0.832
Validation loss decreased (-0.826564 --> -0.832353).  Saving model ...
Epoch: 13 cost time: 4.411389589309692
Epoch: 13, Steps: 67 | Train Loss: 0.120 Vali Loss: 5.285 Vali Acc: 0.769 Test Loss: 5.285 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.428103685379028
Epoch: 14, Steps: 67 | Train Loss: 0.121 Vali Loss: 4.819 Vali Acc: 0.803 Test Loss: 4.819 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.3603010177612305
Epoch: 15, Steps: 67 | Train Loss: 0.092 Vali Loss: 11.503 Vali Acc: 0.717 Test Loss: 11.503 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.409217596054077
Epoch: 16, Steps: 67 | Train Loss: 0.627 Vali Loss: 7.920 Vali Acc: 0.601 Test Loss: 7.920 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.503913164138794
Epoch: 17, Steps: 67 | Train Loss: 0.516 Vali Loss: 3.296 Vali Acc: 0.809 Test Loss: 3.296 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.516753911972046
Epoch: 18, Steps: 67 | Train Loss: 0.050 Vali Loss: 9.593 Vali Acc: 0.757 Test Loss: 9.593 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.366012811660767
Epoch: 19, Steps: 67 | Train Loss: 0.382 Vali Loss: 5.361 Vali Acc: 0.803 Test Loss: 5.361 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.445969820022583
Epoch: 20, Steps: 67 | Train Loss: 0.189 Vali Loss: 14.057 Vali Acc: 0.659 Test Loss: 14.057 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.632752180099487
Epoch: 21, Steps: 67 | Train Loss: 0.156 Vali Loss: 5.520 Vali Acc: 0.775 Test Loss: 5.520 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.567318439483643
Epoch: 22, Steps: 67 | Train Loss: 0.152 Vali Loss: 9.061 Vali Acc: 0.780 Test Loss: 9.061 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3935239
model size : 16.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.567898273468018
Epoch: 1, Steps: 67 | Train Loss: 9.770 Vali Loss: 5.667 Vali Acc: 0.549 Test Loss: 5.667 Test Acc: 0.549
Validation loss decreased (inf --> -0.549076).  Saving model ...
Epoch: 2 cost time: 3.8540821075439453
Epoch: 2, Steps: 67 | Train Loss: 5.296 Vali Loss: 1.690 Vali Acc: 0.763 Test Loss: 1.690 Test Acc: 0.763
Validation loss decreased (-0.549076 --> -0.762989).  Saving model ...
Epoch: 3 cost time: 3.857477903366089
Epoch: 3, Steps: 67 | Train Loss: 1.684 Vali Loss: 9.154 Vali Acc: 0.514 Test Loss: 9.154 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.026280879974365
Epoch: 4, Steps: 67 | Train Loss: 0.564 Vali Loss: 2.848 Vali Acc: 0.803 Test Loss: 2.848 Test Acc: 0.803
Validation loss decreased (-0.762989 --> -0.803440).  Saving model ...
Epoch: 5 cost time: 3.9869778156280518
Epoch: 5, Steps: 67 | Train Loss: 0.051 Vali Loss: 2.180 Vali Acc: 0.798 Test Loss: 2.180 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9027411937713623
Epoch: 6, Steps: 67 | Train Loss: 0.237 Vali Loss: 5.129 Vali Acc: 0.636 Test Loss: 5.129 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.933238983154297
Epoch: 7, Steps: 67 | Train Loss: 0.233 Vali Loss: 2.846 Vali Acc: 0.705 Test Loss: 2.846 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.8176231384277344
Epoch: 8, Steps: 67 | Train Loss: 0.309 Vali Loss: 2.936 Vali Acc: 0.676 Test Loss: 2.936 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.047670125961304
Epoch: 9, Steps: 67 | Train Loss: 0.002 Vali Loss: 2.049 Vali Acc: 0.798 Test Loss: 2.049 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.884348154067993
Epoch: 10, Steps: 67 | Train Loss: 0.036 Vali Loss: 4.761 Vali Acc: 0.665 Test Loss: 4.761 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.954526662826538
Epoch: 11, Steps: 67 | Train Loss: 0.125 Vali Loss: 2.208 Vali Acc: 0.786 Test Loss: 2.208 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9575412273406982
Epoch: 12, Steps: 67 | Train Loss: 0.136 Vali Loss: 9.506 Vali Acc: 0.642 Test Loss: 9.506 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.1599907875061035
Epoch: 13, Steps: 67 | Train Loss: 0.860 Vali Loss: 7.623 Vali Acc: 0.769 Test Loss: 7.623 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.033838987350464
Epoch: 14, Steps: 67 | Train Loss: 0.128 Vali Loss: 3.285 Vali Acc: 0.838 Test Loss: 3.285 Test Acc: 0.838
Validation loss decreased (-0.803440 --> -0.838117).  Saving model ...
Epoch: 15 cost time: 4.043389558792114
Epoch: 15, Steps: 67 | Train Loss: 0.180 Vali Loss: 3.292 Vali Acc: 0.850 Test Loss: 3.292 Test Acc: 0.850
Validation loss decreased (-0.838117 --> -0.849678).  Saving model ...
Epoch: 16 cost time: 3.968073606491089
Epoch: 16, Steps: 67 | Train Loss: 0.289 Vali Loss: 6.541 Vali Acc: 0.775 Test Loss: 6.541 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.135711431503296
Epoch: 17, Steps: 67 | Train Loss: 0.302 Vali Loss: 6.076 Vali Acc: 0.746 Test Loss: 6.076 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.982628345489502
Epoch: 18, Steps: 67 | Train Loss: 0.272 Vali Loss: 11.245 Vali Acc: 0.751 Test Loss: 11.245 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9832494258880615
Epoch: 19, Steps: 67 | Train Loss: 0.200 Vali Loss: 4.508 Vali Acc: 0.809 Test Loss: 4.508 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.882021427154541
Epoch: 20, Steps: 67 | Train Loss: 0.035 Vali Loss: 4.215 Vali Acc: 0.884 Test Loss: 4.215 Test Acc: 0.884
Validation loss decreased (-0.849678 --> -0.884351).  Saving model ...
Epoch: 21 cost time: 4.114493131637573
Epoch: 21, Steps: 67 | Train Loss: 0.107 Vali Loss: 3.092 Vali Acc: 0.838 Test Loss: 3.092 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9419660568237305
Epoch: 22, Steps: 67 | Train Loss: 0.119 Vali Loss: 13.317 Vali Acc: 0.780 Test Loss: 13.317 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.006635427474976
Epoch: 23, Steps: 67 | Train Loss: 0.144 Vali Loss: 4.884 Vali Acc: 0.798 Test Loss: 4.884 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9228525161743164
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.593 Vali Acc: 0.821 Test Loss: 5.593 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.995332956314087
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.610 Vali Acc: 0.821 Test Loss: 5.610 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.050303936004639
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.569 Vali Acc: 0.821 Test Loss: 5.569 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.082622051239014
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.646 Vali Acc: 0.821 Test Loss: 5.646 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.168294668197632
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.622 Vali Acc: 0.821 Test Loss: 5.622 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.925264358520508
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.206 Vali Acc: 0.838 Test Loss: 4.206 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.8989453315734863
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.257 Vali Acc: 0.827 Test Loss: 4.257 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 3504263
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 12.2222519
	speed: 0.1365s/iter; left time: 1816.0317s
Epoch: 1 cost time: 17.604528665542603
Epoch: 1, Steps: 134 | Train Loss: 79.818 Vali Loss: 133.790 Vali Acc: 0.457 Test Loss: 133.790 Test Acc: 0.457
Validation loss decreased (inf --> -0.455310).  Saving model ...
	iters: 100, epoch: 2 | loss: 106.3010788
	speed: 0.2772s/iter; left time: 3650.2156s
Epoch: 2 cost time: 15.769564628601074
Epoch: 2, Steps: 134 | Train Loss: 46.814 Vali Loss: 51.189 Vali Acc: 0.555 Test Loss: 51.189 Test Acc: 0.555
Validation loss decreased (-0.455310 --> -0.554401).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.2911s/iter; left time: 3793.5471s
Epoch: 3 cost time: 16.02060055732727
Epoch: 3, Steps: 134 | Train Loss: 15.069 Vali Loss: 21.319 Vali Acc: 0.723 Test Loss: 21.319 Test Acc: 0.723
Validation loss decreased (-0.554401 --> -0.722330).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.2881s/iter; left time: 3716.4998s
Epoch: 4 cost time: 16.222129583358765
Epoch: 4, Steps: 134 | Train Loss: 0.326 Vali Loss: 9.205 Vali Acc: 0.803 Test Loss: 9.205 Test Acc: 0.803
Validation loss decreased (-0.722330 --> -0.803376).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0009253
	speed: 0.2913s/iter; left time: 3718.2422s
Epoch: 5 cost time: 16.36082887649536
Epoch: 5, Steps: 134 | Train Loss: 1.208 Vali Loss: 17.831 Vali Acc: 0.688 Test Loss: 17.831 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.2980s/iter; left time: 3764.0463s
Epoch: 6 cost time: 17.26814579963684
Epoch: 6, Steps: 134 | Train Loss: 2.428 Vali Loss: 10.606 Vali Acc: 0.775 Test Loss: 10.606 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3291s/iter; left time: 4112.3093s
Epoch: 7 cost time: 20.947932243347168
Epoch: 7, Steps: 134 | Train Loss: 0.573 Vali Loss: 12.792 Vali Acc: 0.647 Test Loss: 12.792 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3713s/iter; left time: 4589.9127s
Epoch: 8 cost time: 21.50344967842102
Epoch: 8, Steps: 134 | Train Loss: 1.382 Vali Loss: 10.317 Vali Acc: 0.763 Test Loss: 10.317 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3617s/iter; left time: 4422.7730s
Epoch: 9 cost time: 20.916869640350342
Epoch: 9, Steps: 134 | Train Loss: 0.280 Vali Loss: 5.566 Vali Acc: 0.780 Test Loss: 5.566 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4318s/iter; left time: 5222.4345s
Epoch: 10 cost time: 31.42339777946472
Epoch: 10, Steps: 134 | Train Loss: 0.230 Vali Loss: 22.871 Vali Acc: 0.723 Test Loss: 22.871 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.5785s/iter; left time: 6919.2034s
Epoch: 11 cost time: 34.61093354225159
Epoch: 11, Steps: 134 | Train Loss: 2.103 Vali Loss: 26.961 Vali Acc: 0.491 Test Loss: 26.961 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4882s/iter; left time: 5773.5004s
Epoch: 12 cost time: 26.757646799087524
Epoch: 12, Steps: 134 | Train Loss: 1.761 Vali Loss: 53.845 Vali Acc: 0.647 Test Loss: 53.845 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4691s/iter; left time: 5485.5737s
Epoch: 13 cost time: 29.762355089187622
Epoch: 13, Steps: 134 | Train Loss: 3.021 Vali Loss: 11.118 Vali Acc: 0.763 Test Loss: 11.118 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.5729s/iter; left time: 6622.0655s
Epoch: 14 cost time: 33.57929706573486
Epoch: 14, Steps: 134 | Train Loss: 0.702 Vali Loss: 12.559 Vali Acc: 0.798 Test Loss: 12.559 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 15573511
model size : 60.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.75291657447815
Epoch: 1, Steps: 67 | Train Loss: 18.990 Vali Loss: 24.414 Vali Acc: 0.399 Test Loss: 24.414 Test Acc: 0.399
Validation loss decreased (inf --> -0.398600).  Saving model ...
Epoch: 2 cost time: 14.98176097869873
Epoch: 2, Steps: 67 | Train Loss: 17.439 Vali Loss: 17.972 Vali Acc: 0.538 Test Loss: 17.972 Test Acc: 0.538
Validation loss decreased (-0.398600 --> -0.537393).  Saving model ...
Epoch: 3 cost time: 18.819838523864746
Epoch: 3, Steps: 67 | Train Loss: 10.733 Vali Loss: 6.481 Vali Acc: 0.682 Test Loss: 6.481 Test Acc: 0.682
Validation loss decreased (-0.537393 --> -0.682016).  Saving model ...
Epoch: 4 cost time: 13.014333724975586
Epoch: 4, Steps: 67 | Train Loss: 1.656 Vali Loss: 4.268 Vali Acc: 0.786 Test Loss: 4.268 Test Acc: 0.786
Validation loss decreased (-0.682016 --> -0.786084).  Saving model ...
Epoch: 5 cost time: 11.445499181747437
Epoch: 5, Steps: 67 | Train Loss: 0.192 Vali Loss: 14.147 Vali Acc: 0.647 Test Loss: 14.147 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.962257862091064
Epoch: 6, Steps: 67 | Train Loss: 0.646 Vali Loss: 4.054 Vali Acc: 0.792 Test Loss: 4.054 Test Acc: 0.792
Validation loss decreased (-0.786084 --> -0.791867).  Saving model ...
Epoch: 7 cost time: 17.742283582687378
Epoch: 7, Steps: 67 | Train Loss: 0.569 Vali Loss: 2.824 Vali Acc: 0.809 Test Loss: 2.824 Test Acc: 0.809
Validation loss decreased (-0.791867 --> -0.809220).  Saving model ...
Epoch: 8 cost time: 14.770469188690186
Epoch: 8, Steps: 67 | Train Loss: 0.133 Vali Loss: 4.262 Vali Acc: 0.769 Test Loss: 4.262 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.398273468017578
Epoch: 9, Steps: 67 | Train Loss: 0.360 Vali Loss: 3.946 Vali Acc: 0.786 Test Loss: 3.946 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.770317316055298
Epoch: 10, Steps: 67 | Train Loss: 0.091 Vali Loss: 8.963 Vali Acc: 0.734 Test Loss: 8.963 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.517180919647217
Epoch: 11, Steps: 67 | Train Loss: 0.573 Vali Loss: 11.052 Vali Acc: 0.694 Test Loss: 11.052 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.217804908752441
Epoch: 12, Steps: 67 | Train Loss: 0.084 Vali Loss: 6.565 Vali Acc: 0.798 Test Loss: 6.565 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.899823904037476
Epoch: 13, Steps: 67 | Train Loss: 0.025 Vali Loss: 4.529 Vali Acc: 0.786 Test Loss: 4.529 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 15.62049126625061
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.701 Vali Acc: 0.786 Test Loss: 4.701 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.995229959487915
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.368 Vali Acc: 0.809 Test Loss: 5.368 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 16.841280221939087
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.325 Vali Acc: 0.809 Test Loss: 5.325 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 19.613129377365112
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.361 Vali Acc: 0.809 Test Loss: 5.361 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 7808007
model size : 30.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.791722774505615
Epoch: 1, Steps: 67 | Train Loss: 13.763 Vali Loss: 6.568 Vali Acc: 0.613 Test Loss: 6.568 Test Acc: 0.613
Validation loss decreased (inf --> -0.612651).  Saving model ...
Epoch: 2 cost time: 11.22153353691101
Epoch: 2, Steps: 67 | Train Loss: 6.363 Vali Loss: 14.338 Vali Acc: 0.584 Test Loss: 14.338 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.343516826629639
Epoch: 3, Steps: 67 | Train Loss: 3.687 Vali Loss: 9.046 Vali Acc: 0.647 Test Loss: 9.046 Test Acc: 0.647
Validation loss decreased (-0.612651 --> -0.647308).  Saving model ...
Epoch: 4 cost time: 12.297718286514282
Epoch: 4, Steps: 67 | Train Loss: 2.556 Vali Loss: 13.189 Vali Acc: 0.601 Test Loss: 13.189 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.167059659957886
Epoch: 5, Steps: 67 | Train Loss: 0.629 Vali Loss: 2.909 Vali Acc: 0.780 Test Loss: 2.909 Test Acc: 0.780
Validation loss decreased (-0.647308 --> -0.780318).  Saving model ...
Epoch: 6 cost time: 12.32253360748291
Epoch: 6, Steps: 67 | Train Loss: 0.191 Vali Loss: 3.323 Vali Acc: 0.821 Test Loss: 3.323 Test Acc: 0.821
Validation loss decreased (-0.780318 --> -0.820776).  Saving model ...
Epoch: 7 cost time: 8.392046689987183
Epoch: 7, Steps: 67 | Train Loss: 0.068 Vali Loss: 4.561 Vali Acc: 0.803 Test Loss: 4.561 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.67939567565918
Epoch: 8, Steps: 67 | Train Loss: 0.047 Vali Loss: 3.149 Vali Acc: 0.855 Test Loss: 3.149 Test Acc: 0.855
Validation loss decreased (-0.820776 --> -0.855460).  Saving model ...
Epoch: 9 cost time: 7.699765682220459
Epoch: 9, Steps: 67 | Train Loss: 0.003 Vali Loss: 4.313 Vali Acc: 0.815 Test Loss: 4.313 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.350459337234497
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.740 Vali Acc: 0.832 Test Loss: 3.740 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.542607069015503
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.767 Vali Acc: 0.832 Test Loss: 3.767 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.433254718780518
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.832 Test Loss: 3.720 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.156442880630493
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.138 Vali Acc: 0.850 Test Loss: 3.138 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.667861461639404
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.156 Vali Acc: 0.850 Test Loss: 3.156 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.266170978546143
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.140 Vali Acc: 0.850 Test Loss: 3.140 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 12.942842721939087
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.128 Vali Acc: 0.850 Test Loss: 3.128 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 8.143909215927124
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.139 Vali Acc: 0.850 Test Loss: 3.139 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.845431804656982
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.136 Vali Acc: 0.850 Test Loss: 3.136 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 5219559
model size : 20.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.82204794883728
Epoch: 1, Steps: 67 | Train Loss: 6.350 Vali Loss: 11.815 Vali Acc: 0.486 Test Loss: 11.815 Test Acc: 0.486
Validation loss decreased (inf --> -0.485431).  Saving model ...
Epoch: 2 cost time: 7.654252290725708
Epoch: 2, Steps: 67 | Train Loss: 5.183 Vali Loss: 7.729 Vali Acc: 0.653 Test Loss: 7.729 Test Acc: 0.653
Validation loss decreased (-0.485431 --> -0.653102).  Saving model ...
Epoch: 3 cost time: 10.965778350830078
Epoch: 3, Steps: 67 | Train Loss: 2.048 Vali Loss: 8.615 Vali Acc: 0.642 Test Loss: 8.615 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.407673597335815
Epoch: 4, Steps: 67 | Train Loss: 1.474 Vali Loss: 3.810 Vali Acc: 0.809 Test Loss: 3.810 Test Acc: 0.809
Validation loss decreased (-0.653102 --> -0.809210).  Saving model ...
Epoch: 5 cost time: 10.231721639633179
Epoch: 5, Steps: 67 | Train Loss: 0.933 Vali Loss: 5.783 Vali Acc: 0.746 Test Loss: 5.783 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.410827398300171
Epoch: 6, Steps: 67 | Train Loss: 0.154 Vali Loss: 1.683 Vali Acc: 0.850 Test Loss: 1.683 Test Acc: 0.850
Validation loss decreased (-0.809210 --> -0.849694).  Saving model ...
Epoch: 7 cost time: 7.887202978134155
Epoch: 7, Steps: 67 | Train Loss: 0.161 Vali Loss: 6.708 Vali Acc: 0.723 Test Loss: 6.708 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.242301940917969
Epoch: 8, Steps: 67 | Train Loss: 0.292 Vali Loss: 3.624 Vali Acc: 0.803 Test Loss: 3.624 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.47929048538208
Epoch: 9, Steps: 67 | Train Loss: 0.058 Vali Loss: 3.415 Vali Acc: 0.786 Test Loss: 3.415 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.100896835327148
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.967 Vali Acc: 0.786 Test Loss: 3.967 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.790729522705078
Epoch: 11, Steps: 67 | Train Loss: 0.006 Vali Loss: 3.803 Vali Acc: 0.792 Test Loss: 3.803 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.271124362945557
Epoch: 12, Steps: 67 | Train Loss: 0.057 Vali Loss: 4.412 Vali Acc: 0.792 Test Loss: 4.412 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.257799863815308
Epoch: 13, Steps: 67 | Train Loss: 0.045 Vali Loss: 3.837 Vali Acc: 0.827 Test Loss: 3.837 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.516624212265015
Epoch: 14, Steps: 67 | Train Loss: 0.122 Vali Loss: 3.594 Vali Acc: 0.827 Test Loss: 3.594 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.196216106414795
Epoch: 15, Steps: 67 | Train Loss: 0.022 Vali Loss: 5.159 Vali Acc: 0.763 Test Loss: 5.159 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.580662488937378
Epoch: 16, Steps: 67 | Train Loss: 0.054 Vali Loss: 4.950 Vali Acc: 0.803 Test Loss: 4.950 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 3925415
model size : 15.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.191816091537476
Epoch: 1, Steps: 67 | Train Loss: 6.174 Vali Loss: 7.817 Vali Acc: 0.526 Test Loss: 7.817 Test Acc: 0.526
Validation loss decreased (inf --> -0.525933).  Saving model ...
Epoch: 2 cost time: 6.378963232040405
Epoch: 2, Steps: 67 | Train Loss: 4.438 Vali Loss: 6.524 Vali Acc: 0.705 Test Loss: 6.524 Test Acc: 0.705
Validation loss decreased (-0.525933 --> -0.705137).  Saving model ...
Epoch: 3 cost time: 7.46953558921814
Epoch: 3, Steps: 67 | Train Loss: 0.951 Vali Loss: 1.577 Vali Acc: 0.746 Test Loss: 1.577 Test Acc: 0.746
Validation loss decreased (-0.705137 --> -0.745649).  Saving model ...
Epoch: 4 cost time: 5.797119617462158
Epoch: 4, Steps: 67 | Train Loss: 0.307 Vali Loss: 3.239 Vali Acc: 0.763 Test Loss: 3.239 Test Acc: 0.763
Validation loss decreased (-0.745649 --> -0.762973).  Saving model ...
Epoch: 5 cost time: 6.981501579284668
Epoch: 5, Steps: 67 | Train Loss: 0.693 Vali Loss: 6.489 Vali Acc: 0.618 Test Loss: 6.489 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5956337451934814
Epoch: 6, Steps: 67 | Train Loss: 0.677 Vali Loss: 5.285 Vali Acc: 0.728 Test Loss: 5.285 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.773982048034668
Epoch: 7, Steps: 67 | Train Loss: 0.583 Vali Loss: 2.619 Vali Acc: 0.740 Test Loss: 2.619 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.966609239578247
Epoch: 8, Steps: 67 | Train Loss: 0.005 Vali Loss: 5.940 Vali Acc: 0.717 Test Loss: 5.940 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.115057945251465
Epoch: 9, Steps: 67 | Train Loss: 0.124 Vali Loss: 3.466 Vali Acc: 0.763 Test Loss: 3.466 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.112720966339111
Epoch: 10, Steps: 67 | Train Loss: 0.053 Vali Loss: 3.698 Vali Acc: 0.763 Test Loss: 3.698 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.421236038208008
Epoch: 11, Steps: 67 | Train Loss: 0.172 Vali Loss: 5.203 Vali Acc: 0.780 Test Loss: 5.203 Test Acc: 0.780
Validation loss decreased (-0.762973 --> -0.780295).  Saving model ...
Epoch: 12 cost time: 7.6232850551605225
Epoch: 12, Steps: 67 | Train Loss: 0.105 Vali Loss: 5.058 Vali Acc: 0.734 Test Loss: 5.058 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.836843967437744
Epoch: 13, Steps: 67 | Train Loss: 0.047 Vali Loss: 2.959 Vali Acc: 0.798 Test Loss: 2.959 Test Acc: 0.798
Validation loss decreased (-0.780295 --> -0.797658).  Saving model ...
Epoch: 14 cost time: 6.421067953109741
Epoch: 14, Steps: 67 | Train Loss: 0.112 Vali Loss: 2.437 Vali Acc: 0.821 Test Loss: 2.437 Test Acc: 0.821
Validation loss decreased (-0.797658 --> -0.820785).  Saving model ...
Epoch: 15 cost time: 7.179840326309204
Epoch: 15, Steps: 67 | Train Loss: 0.064 Vali Loss: 3.155 Vali Acc: 0.786 Test Loss: 3.155 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.575608968734741
Epoch: 16, Steps: 67 | Train Loss: 0.073 Vali Loss: 4.157 Vali Acc: 0.786 Test Loss: 4.157 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.558575630187988
Epoch: 17, Steps: 67 | Train Loss: 0.004 Vali Loss: 4.228 Vali Acc: 0.728 Test Loss: 4.228 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.396551847457886
Epoch: 18, Steps: 67 | Train Loss: 0.158 Vali Loss: 4.385 Vali Acc: 0.786 Test Loss: 4.385 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.976718425750732
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.224 Vali Acc: 0.798 Test Loss: 4.224 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.727540969848633
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.236 Vali Acc: 0.798 Test Loss: 4.236 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.6768317222595215
Epoch: 21, Steps: 67 | Train Loss: 2.391 Vali Loss: 4.138 Vali Acc: 0.780 Test Loss: 4.138 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.582475900650024
Epoch: 22, Steps: 67 | Train Loss: 0.538 Vali Loss: 6.228 Vali Acc: 0.803 Test Loss: 6.228 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.575943946838379
Epoch: 23, Steps: 67 | Train Loss: 0.206 Vali Loss: 7.300 Vali Acc: 0.798 Test Loss: 7.300 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.1099255084991455
Epoch: 24, Steps: 67 | Train Loss: 0.496 Vali Loss: 3.589 Vali Acc: 0.786 Test Loss: 3.589 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2847079
model size : 11.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.951818466186523
Epoch: 1, Steps: 67 | Train Loss: 4.852 Vali Loss: 5.366 Vali Acc: 0.520 Test Loss: 5.366 Test Acc: 0.520
Validation loss decreased (inf --> -0.520178).  Saving model ...
Epoch: 2 cost time: 5.665663480758667
Epoch: 2, Steps: 67 | Train Loss: 3.177 Vali Loss: 3.504 Vali Acc: 0.676 Test Loss: 3.504 Test Acc: 0.676
Validation loss decreased (-0.520178 --> -0.676266).  Saving model ...
Epoch: 3 cost time: 5.257187366485596
Epoch: 3, Steps: 67 | Train Loss: 0.886 Vali Loss: 2.111 Vali Acc: 0.740 Test Loss: 2.111 Test Acc: 0.740
Validation loss decreased (-0.676266 --> -0.739863).  Saving model ...
Epoch: 4 cost time: 7.032814025878906
Epoch: 4, Steps: 67 | Train Loss: 0.295 Vali Loss: 3.269 Vali Acc: 0.751 Test Loss: 3.269 Test Acc: 0.751
Validation loss decreased (-0.739863 --> -0.751412).  Saving model ...
Epoch: 5 cost time: 5.210771799087524
Epoch: 5, Steps: 67 | Train Loss: 0.344 Vali Loss: 3.547 Vali Acc: 0.769 Test Loss: 3.547 Test Acc: 0.769
Validation loss decreased (-0.751412 --> -0.768751).  Saving model ...
Epoch: 6 cost time: 5.476700782775879
Epoch: 6, Steps: 67 | Train Loss: 0.044 Vali Loss: 0.884 Vali Acc: 0.844 Test Loss: 0.884 Test Acc: 0.844
Validation loss decreased (-0.768751 --> -0.843922).  Saving model ...
Epoch: 7 cost time: 6.931916952133179
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.821 Test Loss: 0.893 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.85474705696106
Epoch: 8, Steps: 67 | Train Loss: 0.004 Vali Loss: 1.594 Vali Acc: 0.798 Test Loss: 1.594 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.7076096534729
Epoch: 9, Steps: 67 | Train Loss: 0.039 Vali Loss: 3.178 Vali Acc: 0.780 Test Loss: 3.178 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.946826219558716
Epoch: 10, Steps: 67 | Train Loss: 0.052 Vali Loss: 3.391 Vali Acc: 0.688 Test Loss: 3.391 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.886179447174072
Epoch: 11, Steps: 67 | Train Loss: 0.072 Vali Loss: 1.840 Vali Acc: 0.803 Test Loss: 1.840 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.418384313583374
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 2.394 Vali Acc: 0.827 Test Loss: 2.394 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.20253324508667
Epoch: 13, Steps: 67 | Train Loss: 0.188 Vali Loss: 2.611 Vali Acc: 0.769 Test Loss: 2.611 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.88666558265686
Epoch: 14, Steps: 67 | Train Loss: 0.844 Vali Loss: 3.761 Vali Acc: 0.728 Test Loss: 3.761 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.138200521469116
Epoch: 15, Steps: 67 | Train Loss: 0.232 Vali Loss: 4.825 Vali Acc: 0.763 Test Loss: 4.825 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.94015908241272
Epoch: 16, Steps: 67 | Train Loss: 0.044 Vali Loss: 2.076 Vali Acc: 0.815 Test Loss: 2.076 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1984455
model size : 8.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.409481763839722
Epoch: 1, Steps: 67 | Train Loss: 3.430 Vali Loss: 2.572 Vali Acc: 0.590 Test Loss: 2.572 Test Acc: 0.590
Validation loss decreased (inf --> -0.589570).  Saving model ...
Epoch: 2 cost time: 5.353102684020996
Epoch: 2, Steps: 67 | Train Loss: 1.484 Vali Loss: 2.244 Vali Acc: 0.746 Test Loss: 2.244 Test Acc: 0.746
Validation loss decreased (-0.589570 --> -0.745642).  Saving model ...
Epoch: 3 cost time: 6.259463310241699
Epoch: 3, Steps: 67 | Train Loss: 0.757 Vali Loss: 3.130 Vali Acc: 0.751 Test Loss: 3.130 Test Acc: 0.751
Validation loss decreased (-0.745642 --> -0.751414).  Saving model ...
Epoch: 4 cost time: 5.773785591125488
Epoch: 4, Steps: 67 | Train Loss: 0.094 Vali Loss: 3.107 Vali Acc: 0.740 Test Loss: 3.107 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.323840618133545
Epoch: 5, Steps: 67 | Train Loss: 0.122 Vali Loss: 2.905 Vali Acc: 0.775 Test Loss: 2.905 Test Acc: 0.775
Validation loss decreased (-0.751414 --> -0.774537).  Saving model ...
Epoch: 6 cost time: 4.650748014450073
Epoch: 6, Steps: 67 | Train Loss: 0.087 Vali Loss: 3.393 Vali Acc: 0.734 Test Loss: 3.393 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.458935737609863
Epoch: 7, Steps: 67 | Train Loss: 0.119 Vali Loss: 2.106 Vali Acc: 0.780 Test Loss: 2.106 Test Acc: 0.780
Validation loss decreased (-0.774537 --> -0.780326).  Saving model ...
Epoch: 8 cost time: 6.243038892745972
Epoch: 8, Steps: 67 | Train Loss: 0.072 Vali Loss: 2.588 Vali Acc: 0.775 Test Loss: 2.588 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.946129560470581
Epoch: 9, Steps: 67 | Train Loss: 0.184 Vali Loss: 1.528 Vali Acc: 0.821 Test Loss: 1.528 Test Acc: 0.821
Validation loss decreased (-0.780326 --> -0.820794).  Saving model ...
Epoch: 10 cost time: 5.304811954498291
Epoch: 10, Steps: 67 | Train Loss: 0.035 Vali Loss: 3.508 Vali Acc: 0.763 Test Loss: 3.508 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.060650110244751
Epoch: 11, Steps: 67 | Train Loss: 0.057 Vali Loss: 3.943 Vali Acc: 0.694 Test Loss: 3.943 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.350584983825684
Epoch: 12, Steps: 67 | Train Loss: 0.043 Vali Loss: 2.459 Vali Acc: 0.786 Test Loss: 2.459 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.278505325317383
Epoch: 13, Steps: 67 | Train Loss: 0.151 Vali Loss: 1.474 Vali Acc: 0.815 Test Loss: 1.474 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.580885410308838
Epoch: 14, Steps: 67 | Train Loss: 0.063 Vali Loss: 3.182 Vali Acc: 0.821 Test Loss: 3.182 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.97133731842041
Epoch: 15, Steps: 67 | Train Loss: 0.413 Vali Loss: 3.709 Vali Acc: 0.803 Test Loss: 3.709 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.976351976394653
Epoch: 16, Steps: 67 | Train Loss: 0.232 Vali Loss: 3.310 Vali Acc: 0.798 Test Loss: 3.310 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.206908941268921
Epoch: 17, Steps: 67 | Train Loss: 0.246 Vali Loss: 6.041 Vali Acc: 0.746 Test Loss: 6.041 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.181971549987793
Epoch: 18, Steps: 67 | Train Loss: 0.084 Vali Loss: 2.441 Vali Acc: 0.786 Test Loss: 2.441 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.804630994796753
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.382 Vali Acc: 0.827 Test Loss: 2.382 Test Acc: 0.827
Validation loss decreased (-0.820794 --> -0.826566).  Saving model ...
Epoch: 20 cost time: 6.545715093612671
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.306 Vali Acc: 0.832 Test Loss: 2.306 Test Acc: 0.832
Validation loss decreased (-0.826566 --> -0.832347).  Saving model ...
Epoch: 21 cost time: 5.960163831710815
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.318 Vali Acc: 0.832 Test Loss: 2.318 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.53157901763916
Epoch: 22, Steps: 67 | Train Loss: 0.114 Vali Loss: 1.546 Vali Acc: 0.815 Test Loss: 1.546 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.719491720199585
Epoch: 23, Steps: 67 | Train Loss: 0.016 Vali Loss: 1.970 Vali Acc: 0.832 Test Loss: 1.970 Test Acc: 0.832
Validation loss decreased (-0.832347 --> -0.832350).  Saving model ...
Epoch: 24 cost time: 5.773048162460327
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.850 Test Loss: 1.834 Test Acc: 0.850
Validation loss decreased (-0.832350 --> -0.849693).  Saving model ...
Epoch: 25 cost time: 5.644481182098389
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.844 Test Loss: 1.849 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.062015056610107
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.850 Test Loss: 2.158 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.1533215045928955
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.850 Test Loss: 2.146 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.095714569091797
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.170 Vali Acc: 0.844 Test Loss: 2.170 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.982213735580444
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.151 Vali Acc: 0.850 Test Loss: 2.151 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.18312931060791
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.167 Vali Acc: 0.850 Test Loss: 2.167 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.023782014846802
Epoch: 31, Steps: 67 | Train Loss: 0.248 Vali Loss: 8.057 Vali Acc: 0.676 Test Loss: 8.057 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.576011657714844
Epoch: 32, Steps: 67 | Train Loss: 1.339 Vali Loss: 32.941 Vali Acc: 0.324 Test Loss: 32.941 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.535996675491333
Epoch: 33, Steps: 67 | Train Loss: 1.289 Vali Loss: 8.629 Vali Acc: 0.659 Test Loss: 8.629 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.280024766921997
Epoch: 34, Steps: 67 | Train Loss: 0.330 Vali Loss: 15.335 Vali Acc: 0.717 Test Loss: 15.335 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1768967
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 73.4838257
	speed: 0.2070s/iter; left time: 2753.3192s
Epoch: 1 cost time: 27.230494260787964
Epoch: 1, Steps: 134 | Train Loss: 87.837 Vali Loss: 24.663 Vali Acc: 0.578 Test Loss: 24.663 Test Acc: 0.578
Validation loss decreased (inf --> -0.577788).  Saving model ...
	iters: 100, epoch: 2 | loss: 10.1617918
	speed: 0.4590s/iter; left time: 6043.4208s
Epoch: 2 cost time: 24.89711332321167
Epoch: 2, Steps: 134 | Train Loss: 32.030 Vali Loss: 7.760 Vali Acc: 0.699 Test Loss: 7.760 Test Acc: 0.699
Validation loss decreased (-0.577788 --> -0.699344).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.4389s/iter; left time: 5720.1675s
Epoch: 3 cost time: 22.656603813171387
Epoch: 3, Steps: 134 | Train Loss: 1.355 Vali Loss: 5.122 Vali Acc: 0.728 Test Loss: 5.122 Test Acc: 0.728
Validation loss decreased (-0.699344 --> -0.728272).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4395s/iter; left time: 5669.4391s
Epoch: 4 cost time: 26.21687340736389
Epoch: 4, Steps: 134 | Train Loss: 0.144 Vali Loss: 10.824 Vali Acc: 0.653 Test Loss: 10.824 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4674s/iter; left time: 5966.7312s
Epoch: 5 cost time: 27.86949324607849
Epoch: 5, Steps: 134 | Train Loss: 1.332 Vali Loss: 7.309 Vali Acc: 0.653 Test Loss: 7.309 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4878s/iter; left time: 6161.5162s
Epoch: 6 cost time: 28.851296186447144
Epoch: 6, Steps: 134 | Train Loss: 1.741 Vali Loss: 8.391 Vali Acc: 0.751 Test Loss: 8.391 Test Acc: 0.751
Validation loss decreased (-0.728272 --> -0.751361).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4474s/iter; left time: 5590.8133s
Epoch: 7 cost time: 25.88081169128418
Epoch: 7, Steps: 134 | Train Loss: 0.824 Vali Loss: 18.924 Vali Acc: 0.734 Test Loss: 18.924 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.4060s/iter; left time: 5018.8631s
Epoch: 8 cost time: 21.41051959991455
Epoch: 8, Steps: 134 | Train Loss: 2.652 Vali Loss: 17.003 Vali Acc: 0.717 Test Loss: 17.003 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3892s/iter; left time: 4759.6366s
Epoch: 9 cost time: 20.355285167694092
Epoch: 9, Steps: 134 | Train Loss: 1.247 Vali Loss: 24.181 Vali Acc: 0.676 Test Loss: 24.181 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4051s/iter; left time: 4899.7646s
Epoch: 10 cost time: 21.8613383769989
Epoch: 10, Steps: 134 | Train Loss: 0.978 Vali Loss: 7.549 Vali Acc: 0.803 Test Loss: 7.549 Test Acc: 0.803
Validation loss decreased (-0.751361 --> -0.803393).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4524s/iter; left time: 5410.6869s
Epoch: 11 cost time: 22.849754810333252
Epoch: 11, Steps: 134 | Train Loss: 0.433 Vali Loss: 25.855 Vali Acc: 0.659 Test Loss: 25.855 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3508s/iter; left time: 4148.5211s
Epoch: 12 cost time: 19.186084747314453
Epoch: 12, Steps: 134 | Train Loss: 1.615 Vali Loss: 25.228 Vali Acc: 0.572 Test Loss: 25.228 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3830s/iter; left time: 4478.0111s
Epoch: 13 cost time: 26.08337926864624
Epoch: 13, Steps: 134 | Train Loss: 1.513 Vali Loss: 20.238 Vali Acc: 0.746 Test Loss: 20.238 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4671s/iter; left time: 5398.8483s
Epoch: 14 cost time: 28.714436531066895
Epoch: 14, Steps: 134 | Train Loss: 1.025 Vali Loss: 8.977 Vali Acc: 0.792 Test Loss: 8.977 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4719s/iter; left time: 5391.3417s
Epoch: 15 cost time: 27.750505685806274
Epoch: 15, Steps: 134 | Train Loss: 0.590 Vali Loss: 7.071 Vali Acc: 0.769 Test Loss: 7.071 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4160s/iter; left time: 4697.2771s
Epoch: 16 cost time: 21.237342357635498
Epoch: 16, Steps: 134 | Train Loss: 0.783 Vali Loss: 9.288 Vali Acc: 0.815 Test Loss: 9.288 Test Acc: 0.815
Validation loss decreased (-0.803393 --> -0.814936).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3921s/iter; left time: 4374.5228s
Epoch: 17 cost time: 19.275225162506104
Epoch: 17, Steps: 134 | Train Loss: 0.166 Vali Loss: 10.238 Vali Acc: 0.809 Test Loss: 10.238 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3882s/iter; left time: 4279.3807s
Epoch: 18 cost time: 19.395037174224854
Epoch: 18, Steps: 134 | Train Loss: 3.641 Vali Loss: 16.539 Vali Acc: 0.636 Test Loss: 16.539 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4146s/iter; left time: 4515.0717s
Epoch: 19 cost time: 24.71839189529419
Epoch: 19, Steps: 134 | Train Loss: 0.586 Vali Loss: 13.951 Vali Acc: 0.757 Test Loss: 13.951 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.5002s/iter; left time: 5380.1481s
Epoch: 20 cost time: 29.333314657211304
Epoch: 20, Steps: 134 | Train Loss: 0.428 Vali Loss: 16.670 Vali Acc: 0.763 Test Loss: 16.670 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.4795s/iter; left time: 5092.2408s
Epoch: 21 cost time: 28.844877243041992
Epoch: 21, Steps: 134 | Train Loss: 0.502 Vali Loss: 21.091 Vali Acc: 0.757 Test Loss: 21.091 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.4392s/iter; left time: 4606.2500s
Epoch: 22 cost time: 25.392139673233032
Epoch: 22, Steps: 134 | Train Loss: 0.029 Vali Loss: 14.334 Vali Acc: 0.798 Test Loss: 14.334 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.4197s/iter; left time: 4345.4289s
Epoch: 23 cost time: 23.143572568893433
Epoch: 23, Steps: 134 | Train Loss: 0.090 Vali Loss: 28.097 Vali Acc: 0.751 Test Loss: 28.097 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.4010s/iter; left time: 4098.2990s
Epoch: 24 cost time: 19.3095440864563
Epoch: 24, Steps: 134 | Train Loss: 0.781 Vali Loss: 14.320 Vali Acc: 0.763 Test Loss: 14.320 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.3897s/iter; left time: 3930.3700s
Epoch: 25 cost time: 20.655441522598267
Epoch: 25, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.659 Vali Acc: 0.728 Test Loss: 19.659 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.4022s/iter; left time: 4002.6233s
Epoch: 26 cost time: 22.300830364227295
Epoch: 26, Steps: 134 | Train Loss: 0.472 Vali Loss: 31.042 Vali Acc: 0.717 Test Loss: 31.042 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 15556871
model size : 59.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.74896502494812
Epoch: 1, Steps: 67 | Train Loss: 13.980 Vali Loss: 17.472 Vali Acc: 0.451 Test Loss: 17.472 Test Acc: 0.451
Validation loss decreased (inf --> -0.450692).  Saving model ...
Epoch: 2 cost time: 10.660764932632446
Epoch: 2, Steps: 67 | Train Loss: 22.232 Vali Loss: 30.755 Vali Acc: 0.584 Test Loss: 30.755 Test Acc: 0.584
Validation loss decreased (-0.450692 --> -0.583507).  Saving model ...
Epoch: 3 cost time: 12.722625732421875
Epoch: 3, Steps: 67 | Train Loss: 9.705 Vali Loss: 12.789 Vali Acc: 0.682 Test Loss: 12.789 Test Acc: 0.682
Validation loss decreased (-0.583507 --> -0.681953).  Saving model ...
Epoch: 4 cost time: 13.73361349105835
Epoch: 4, Steps: 67 | Train Loss: 1.485 Vali Loss: 7.501 Vali Acc: 0.763 Test Loss: 7.501 Test Acc: 0.763
Validation loss decreased (-0.681953 --> -0.762931).  Saving model ...
Epoch: 5 cost time: 10.324753999710083
Epoch: 5, Steps: 67 | Train Loss: 0.073 Vali Loss: 4.916 Vali Acc: 0.751 Test Loss: 4.916 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.245515823364258
Epoch: 6, Steps: 67 | Train Loss: 0.078 Vali Loss: 4.790 Vali Acc: 0.786 Test Loss: 4.790 Test Acc: 0.786
Validation loss decreased (-0.762931 --> -0.786079).  Saving model ...
Epoch: 7 cost time: 12.718772649765015
Epoch: 7, Steps: 67 | Train Loss: 0.239 Vali Loss: 6.537 Vali Acc: 0.775 Test Loss: 6.537 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.02658748626709
Epoch: 8, Steps: 67 | Train Loss: 0.103 Vali Loss: 7.276 Vali Acc: 0.751 Test Loss: 7.276 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.680859565734863
Epoch: 9, Steps: 67 | Train Loss: 0.116 Vali Loss: 2.123 Vali Acc: 0.827 Test Loss: 2.123 Test Acc: 0.827
Validation loss decreased (-0.786079 --> -0.826568).  Saving model ...
Epoch: 10 cost time: 14.119828701019287
Epoch: 10, Steps: 67 | Train Loss: 0.113 Vali Loss: 6.256 Vali Acc: 0.723 Test Loss: 6.256 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.801273822784424
Epoch: 11, Steps: 67 | Train Loss: 0.397 Vali Loss: 2.246 Vali Acc: 0.821 Test Loss: 2.246 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.278444051742554
Epoch: 12, Steps: 67 | Train Loss: 0.052 Vali Loss: 1.826 Vali Acc: 0.832 Test Loss: 1.826 Test Acc: 0.832
Validation loss decreased (-0.826568 --> -0.832352).  Saving model ...
Epoch: 13 cost time: 13.561467409133911
Epoch: 13, Steps: 67 | Train Loss: 0.571 Vali Loss: 5.013 Vali Acc: 0.775 Test Loss: 5.013 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.776325225830078
Epoch: 14, Steps: 67 | Train Loss: 0.638 Vali Loss: 5.636 Vali Acc: 0.705 Test Loss: 5.636 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.142841339111328
Epoch: 15, Steps: 67 | Train Loss: 0.239 Vali Loss: 17.747 Vali Acc: 0.624 Test Loss: 17.747 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.28470230102539
Epoch: 16, Steps: 67 | Train Loss: 1.514 Vali Loss: 6.807 Vali Acc: 0.763 Test Loss: 6.807 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.595766544342041
Epoch: 17, Steps: 67 | Train Loss: 0.221 Vali Loss: 13.896 Vali Acc: 0.757 Test Loss: 13.896 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.278820991516113
Epoch: 18, Steps: 67 | Train Loss: 0.668 Vali Loss: 3.995 Vali Acc: 0.786 Test Loss: 3.995 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.57523798942566
Epoch: 19, Steps: 67 | Train Loss: 0.009 Vali Loss: 11.987 Vali Acc: 0.740 Test Loss: 11.987 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.008890867233276
Epoch: 20, Steps: 67 | Train Loss: 0.433 Vali Loss: 6.180 Vali Acc: 0.757 Test Loss: 6.180 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.694909811019897
Epoch: 21, Steps: 67 | Train Loss: 0.134 Vali Loss: 7.052 Vali Acc: 0.757 Test Loss: 7.052 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.627655029296875
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.152 Vali Acc: 0.838 Test Loss: 3.152 Test Acc: 0.838
Validation loss decreased (-0.832352 --> -0.838119).  Saving model ...
Epoch: 23 cost time: 11.189752578735352
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.048 Vali Acc: 0.838 Test Loss: 3.048 Test Acc: 0.838
Validation loss decreased (-0.838119 --> -0.838120).  Saving model ...
Epoch: 24 cost time: 11.06302785873413
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.846 Vali Acc: 0.861 Test Loss: 3.846 Test Acc: 0.861
Validation loss decreased (-0.838120 --> -0.861233).  Saving model ...
Epoch: 25 cost time: 9.609108448028564
Epoch: 25, Steps: 67 | Train Loss: 0.125 Vali Loss: 5.223 Vali Acc: 0.803 Test Loss: 5.223 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.502297639846802
Epoch: 26, Steps: 67 | Train Loss: 0.485 Vali Loss: 18.631 Vali Acc: 0.780 Test Loss: 18.631 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.831723690032959
Epoch: 27, Steps: 67 | Train Loss: 1.357 Vali Loss: 7.305 Vali Acc: 0.763 Test Loss: 7.305 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 13.449239492416382
Epoch: 28, Steps: 67 | Train Loss: 0.235 Vali Loss: 18.020 Vali Acc: 0.699 Test Loss: 18.020 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 11.47143292427063
Epoch: 29, Steps: 67 | Train Loss: 1.570 Vali Loss: 14.448 Vali Acc: 0.746 Test Loss: 14.448 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 12.386236190795898
Epoch: 30, Steps: 67 | Train Loss: 0.802 Vali Loss: 13.661 Vali Acc: 0.769 Test Loss: 13.661 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 12.292947769165039
Epoch: 31, Steps: 67 | Train Loss: 0.083 Vali Loss: 9.677 Vali Acc: 0.792 Test Loss: 9.677 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 12.312268257141113
Epoch: 32, Steps: 67 | Train Loss: 0.191 Vali Loss: 7.160 Vali Acc: 0.786 Test Loss: 7.160 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 12.963860988616943
Epoch: 33, Steps: 67 | Train Loss: 0.468 Vali Loss: 9.192 Vali Acc: 0.786 Test Loss: 9.192 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.12283706665039
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.605 Vali Acc: 0.798 Test Loss: 8.605 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 7791367
model size : 30.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.433160305023193
Epoch: 1, Steps: 67 | Train Loss: 13.140 Vali Loss: 24.139 Vali Acc: 0.503 Test Loss: 24.139 Test Acc: 0.503
Validation loss decreased (inf --> -0.502649).  Saving model ...
Epoch: 2 cost time: 7.929531574249268
Epoch: 2, Steps: 67 | Train Loss: 10.355 Vali Loss: 5.904 Vali Acc: 0.746 Test Loss: 5.904 Test Acc: 0.746
Validation loss decreased (-0.502649 --> -0.745606).  Saving model ...
Epoch: 3 cost time: 6.068541765213013
Epoch: 3, Steps: 67 | Train Loss: 6.209 Vali Loss: 8.538 Vali Acc: 0.688 Test Loss: 8.538 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.803430557250977
Epoch: 4, Steps: 67 | Train Loss: 4.235 Vali Loss: 5.036 Vali Acc: 0.780 Test Loss: 5.036 Test Acc: 0.780
Validation loss decreased (-0.745606 --> -0.780296).  Saving model ...
Epoch: 5 cost time: 7.344953536987305
Epoch: 5, Steps: 67 | Train Loss: 1.943 Vali Loss: 9.259 Vali Acc: 0.740 Test Loss: 9.259 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.149847984313965
Epoch: 6, Steps: 67 | Train Loss: 1.495 Vali Loss: 2.585 Vali Acc: 0.855 Test Loss: 2.585 Test Acc: 0.855
Validation loss decreased (-0.780296 --> -0.855465).  Saving model ...
Epoch: 7 cost time: 7.64608097076416
Epoch: 7, Steps: 67 | Train Loss: 0.102 Vali Loss: 2.073 Vali Acc: 0.855 Test Loss: 2.073 Test Acc: 0.855
Validation loss decreased (-0.855465 --> -0.855471).  Saving model ...
Epoch: 8 cost time: 9.287685632705688
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.429 Vali Acc: 0.850 Test Loss: 2.429 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.369515419006348
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.105 Vali Acc: 0.844 Test Loss: 2.105 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.536515712738037
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.786 Test Loss: 3.294 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.887367248535156
Epoch: 11, Steps: 67 | Train Loss: 0.342 Vali Loss: 2.691 Vali Acc: 0.809 Test Loss: 2.691 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.34280276298523
Epoch: 12, Steps: 67 | Train Loss: 0.109 Vali Loss: 1.759 Vali Acc: 0.815 Test Loss: 1.759 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.858111619949341
Epoch: 13, Steps: 67 | Train Loss: 0.172 Vali Loss: 4.774 Vali Acc: 0.775 Test Loss: 4.774 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.668102979660034
Epoch: 14, Steps: 67 | Train Loss: 0.378 Vali Loss: 7.116 Vali Acc: 0.734 Test Loss: 7.116 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 7.282418489456177
Epoch: 15, Steps: 67 | Train Loss: 0.335 Vali Loss: 4.120 Vali Acc: 0.809 Test Loss: 4.120 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.800325632095337
Epoch: 16, Steps: 67 | Train Loss: 0.258 Vali Loss: 7.949 Vali Acc: 0.740 Test Loss: 7.949 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.302698850631714
Epoch: 17, Steps: 67 | Train Loss: 0.662 Vali Loss: 5.854 Vali Acc: 0.705 Test Loss: 5.854 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 5202919
model size : 20.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.346895933151245
Epoch: 1, Steps: 67 | Train Loss: 6.026 Vali Loss: 14.422 Vali Acc: 0.514 Test Loss: 14.422 Test Acc: 0.514
Validation loss decreased (inf --> -0.514307).  Saving model ...
Epoch: 2 cost time: 6.137689590454102
Epoch: 2, Steps: 67 | Train Loss: 7.011 Vali Loss: 21.393 Vali Acc: 0.410 Test Loss: 21.393 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.91556978225708
Epoch: 3, Steps: 67 | Train Loss: 2.663 Vali Loss: 18.616 Vali Acc: 0.526 Test Loss: 18.616 Test Acc: 0.526
Validation loss decreased (-0.514307 --> -0.525825).  Saving model ...
Epoch: 4 cost time: 6.23488187789917
Epoch: 4, Steps: 67 | Train Loss: 2.812 Vali Loss: 11.284 Vali Acc: 0.699 Test Loss: 11.284 Test Acc: 0.699
Validation loss decreased (-0.525825 --> -0.699309).  Saving model ...
Epoch: 5 cost time: 7.837477445602417
Epoch: 5, Steps: 67 | Train Loss: 1.543 Vali Loss: 4.263 Vali Acc: 0.832 Test Loss: 4.263 Test Acc: 0.832
Validation loss decreased (-0.699309 --> -0.832327).  Saving model ...
Epoch: 6 cost time: 6.03335165977478
Epoch: 6, Steps: 67 | Train Loss: 0.185 Vali Loss: 13.368 Vali Acc: 0.630 Test Loss: 13.368 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.087007522583008
Epoch: 7, Steps: 67 | Train Loss: 0.930 Vali Loss: 6.461 Vali Acc: 0.740 Test Loss: 6.461 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.694096565246582
Epoch: 8, Steps: 67 | Train Loss: 0.377 Vali Loss: 3.879 Vali Acc: 0.815 Test Loss: 3.879 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.01988959312439
Epoch: 9, Steps: 67 | Train Loss: 0.347 Vali Loss: 5.310 Vali Acc: 0.803 Test Loss: 5.310 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.840217351913452
Epoch: 10, Steps: 67 | Train Loss: 0.096 Vali Loss: 2.588 Vali Acc: 0.832 Test Loss: 2.588 Test Acc: 0.832
Validation loss decreased (-0.832327 --> -0.832344).  Saving model ...
Epoch: 11 cost time: 6.722156524658203
Epoch: 11, Steps: 67 | Train Loss: 0.045 Vali Loss: 3.810 Vali Acc: 0.821 Test Loss: 3.810 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.370869398117065
Epoch: 12, Steps: 67 | Train Loss: 0.008 Vali Loss: 6.759 Vali Acc: 0.792 Test Loss: 6.759 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.263183355331421
Epoch: 13, Steps: 67 | Train Loss: 0.074 Vali Loss: 3.034 Vali Acc: 0.850 Test Loss: 3.034 Test Acc: 0.850
Validation loss decreased (-0.832344 --> -0.849681).  Saving model ...
Epoch: 14 cost time: 6.246960878372192
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.867 Test Loss: 2.731 Test Acc: 0.867
Validation loss decreased (-0.849681 --> -0.867025).  Saving model ...
Epoch: 15 cost time: 7.613306760787964
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.739 Vali Acc: 0.867 Test Loss: 2.739 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.531436204910278
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.748 Vali Acc: 0.867 Test Loss: 2.748 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.051009893417358
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.759 Vali Acc: 0.867 Test Loss: 2.759 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.24902081489563
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.771 Vali Acc: 0.867 Test Loss: 2.771 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.672298908233643
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.739 Vali Acc: 0.867 Test Loss: 2.739 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.056800842285156
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.767 Vali Acc: 0.867 Test Loss: 2.767 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.282866954803467
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.728 Vali Acc: 0.867 Test Loss: 2.728 Test Acc: 0.867
Validation loss decreased (-0.867025 --> -0.867025).  Saving model ...
Epoch: 22 cost time: 5.2915358543396
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.867 Test Loss: 2.726 Test Acc: 0.867
Validation loss decreased (-0.867025 --> -0.867025).  Saving model ...
Epoch: 23 cost time: 5.2947609424591064
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.737 Vali Acc: 0.867 Test Loss: 2.737 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.46401834487915
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.808 Vali Acc: 0.867 Test Loss: 2.808 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.216569185256958
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.830 Vali Acc: 0.867 Test Loss: 2.830 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.685011863708496
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.772 Vali Acc: 0.867 Test Loss: 2.772 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.199808120727539
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.782 Vali Acc: 0.867 Test Loss: 2.782 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.976206541061401
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.779 Vali Acc: 0.867 Test Loss: 2.779 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.404720306396484
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.800 Vali Acc: 0.867 Test Loss: 2.800 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.44885516166687
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.798 Vali Acc: 0.867 Test Loss: 2.798 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.537577152252197
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.804 Vali Acc: 0.867 Test Loss: 2.804 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.660433053970337
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.413 Vali Acc: 0.838 Test Loss: 2.413 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 3908775
model size : 15.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.539419174194336
Epoch: 1, Steps: 67 | Train Loss: 5.955 Vali Loss: 9.075 Vali Acc: 0.595 Test Loss: 9.075 Test Acc: 0.595
Validation loss decreased (inf --> -0.595285).  Saving model ...
Epoch: 2 cost time: 4.916740894317627
Epoch: 2, Steps: 67 | Train Loss: 3.220 Vali Loss: 6.044 Vali Acc: 0.659 Test Loss: 6.044 Test Acc: 0.659
Validation loss decreased (-0.595285 --> -0.658899).  Saving model ...
Epoch: 3 cost time: 5.048868894577026
Epoch: 3, Steps: 67 | Train Loss: 1.437 Vali Loss: 3.587 Vali Acc: 0.775 Test Loss: 3.587 Test Acc: 0.775
Validation loss decreased (-0.658899 --> -0.774531).  Saving model ...
Epoch: 4 cost time: 7.045429944992065
Epoch: 4, Steps: 67 | Train Loss: 0.624 Vali Loss: 7.218 Vali Acc: 0.682 Test Loss: 7.218 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.990919589996338
Epoch: 5, Steps: 67 | Train Loss: 1.339 Vali Loss: 2.134 Vali Acc: 0.792 Test Loss: 2.134 Test Acc: 0.792
Validation loss decreased (-0.774531 --> -0.791886).  Saving model ...
Epoch: 6 cost time: 6.8665783405303955
Epoch: 6, Steps: 67 | Train Loss: 0.255 Vali Loss: 3.885 Vali Acc: 0.775 Test Loss: 3.885 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.201887130737305
Epoch: 7, Steps: 67 | Train Loss: 0.161 Vali Loss: 6.004 Vali Acc: 0.711 Test Loss: 6.004 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.942911386489868
Epoch: 8, Steps: 67 | Train Loss: 0.235 Vali Loss: 6.475 Vali Acc: 0.751 Test Loss: 6.475 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.266048908233643
Epoch: 9, Steps: 67 | Train Loss: 0.033 Vali Loss: 3.929 Vali Acc: 0.775 Test Loss: 3.929 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.161872386932373
Epoch: 10, Steps: 67 | Train Loss: 0.398 Vali Loss: 2.350 Vali Acc: 0.827 Test Loss: 2.350 Test Acc: 0.827
Validation loss decreased (-0.791886 --> -0.826566).  Saving model ...
Epoch: 11 cost time: 7.53139853477478
Epoch: 11, Steps: 67 | Train Loss: 0.430 Vali Loss: 1.914 Vali Acc: 0.792 Test Loss: 1.914 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.929715633392334
Epoch: 12, Steps: 67 | Train Loss: 0.348 Vali Loss: 1.787 Vali Acc: 0.821 Test Loss: 1.787 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.777066230773926
Epoch: 13, Steps: 67 | Train Loss: 0.172 Vali Loss: 2.179 Vali Acc: 0.809 Test Loss: 2.179 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.0301594734191895
Epoch: 14, Steps: 67 | Train Loss: 0.236 Vali Loss: 5.692 Vali Acc: 0.728 Test Loss: 5.692 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.099840402603149
Epoch: 15, Steps: 67 | Train Loss: 0.160 Vali Loss: 4.973 Vali Acc: 0.792 Test Loss: 4.973 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.253300428390503
Epoch: 16, Steps: 67 | Train Loss: 0.250 Vali Loss: 3.726 Vali Acc: 0.798 Test Loss: 3.726 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.958631992340088
Epoch: 17, Steps: 67 | Train Loss: 0.151 Vali Loss: 1.842 Vali Acc: 0.827 Test Loss: 1.842 Test Acc: 0.827
Validation loss decreased (-0.826566 --> -0.826571).  Saving model ...
Epoch: 18 cost time: 7.618617296218872
Epoch: 18, Steps: 67 | Train Loss: 0.207 Vali Loss: 1.881 Vali Acc: 0.850 Test Loss: 1.881 Test Acc: 0.850
Validation loss decreased (-0.826571 --> -0.849692).  Saving model ...
Epoch: 19 cost time: 5.711041688919067
Epoch: 19, Steps: 67 | Train Loss: 0.018 Vali Loss: 5.996 Vali Acc: 0.769 Test Loss: 5.996 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.420274257659912
Epoch: 20, Steps: 67 | Train Loss: 0.079 Vali Loss: 7.352 Vali Acc: 0.751 Test Loss: 7.352 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.01942777633667
Epoch: 21, Steps: 67 | Train Loss: 0.108 Vali Loss: 3.274 Vali Acc: 0.798 Test Loss: 3.274 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.528512954711914
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.276 Vali Acc: 0.798 Test Loss: 3.276 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.785030841827393
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.248 Vali Acc: 0.798 Test Loss: 3.248 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.866554260253906
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.001 Vali Acc: 0.815 Test Loss: 3.001 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.398791313171387
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.979 Vali Acc: 0.827 Test Loss: 2.979 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.641791343688965
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.961 Vali Acc: 0.827 Test Loss: 2.961 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.151405096054077
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.827 Test Loss: 2.945 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.283534526824951
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.967 Vali Acc: 0.827 Test Loss: 2.967 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2830439
model size : 11.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.242141008377075
Epoch: 1, Steps: 67 | Train Loss: 5.045 Vali Loss: 3.836 Vali Acc: 0.561 Test Loss: 3.836 Test Acc: 0.561
Validation loss decreased (inf --> -0.560655).  Saving model ...
Epoch: 2 cost time: 5.036565542221069
Epoch: 2, Steps: 67 | Train Loss: 2.533 Vali Loss: 6.630 Vali Acc: 0.607 Test Loss: 6.630 Test Acc: 0.607
Validation loss decreased (-0.560655 --> -0.606870).  Saving model ...
Epoch: 3 cost time: 5.492767333984375
Epoch: 3, Steps: 67 | Train Loss: 1.151 Vali Loss: 2.635 Vali Acc: 0.780 Test Loss: 2.635 Test Acc: 0.780
Validation loss decreased (-0.606870 --> -0.780320).  Saving model ...
Epoch: 4 cost time: 5.320532560348511
Epoch: 4, Steps: 67 | Train Loss: 0.604 Vali Loss: 2.656 Vali Acc: 0.780 Test Loss: 2.656 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.289720058441162
Epoch: 5, Steps: 67 | Train Loss: 0.212 Vali Loss: 1.249 Vali Acc: 0.850 Test Loss: 1.249 Test Acc: 0.850
Validation loss decreased (-0.780320 --> -0.849698).  Saving model ...
Epoch: 6 cost time: 6.6885762214660645
Epoch: 6, Steps: 67 | Train Loss: 0.037 Vali Loss: 3.101 Vali Acc: 0.792 Test Loss: 3.101 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.302700519561768
Epoch: 7, Steps: 67 | Train Loss: 0.226 Vali Loss: 2.228 Vali Acc: 0.809 Test Loss: 2.228 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.8505940437316895
Epoch: 8, Steps: 67 | Train Loss: 0.022 Vali Loss: 1.862 Vali Acc: 0.832 Test Loss: 1.862 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.221057891845703
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.589 Vali Acc: 0.832 Test Loss: 1.589 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.200126886367798
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.832 Test Loss: 1.579 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.635159492492676
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.563 Vali Acc: 0.832 Test Loss: 1.563 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.52667760848999
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.832 Test Loss: 1.542 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.8801820278167725
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.832 Test Loss: 1.538 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.199290990829468
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.832 Test Loss: 1.436 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.172643184661865
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.832 Test Loss: 1.440 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1967815
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.70041036605835
Epoch: 1, Steps: 67 | Train Loss: 4.662 Vali Loss: 7.485 Vali Acc: 0.335 Test Loss: 7.485 Test Acc: 0.335
Validation loss decreased (inf --> -0.335185).  Saving model ...
Epoch: 2 cost time: 4.270914554595947
Epoch: 2, Steps: 67 | Train Loss: 3.128 Vali Loss: 7.362 Vali Acc: 0.595 Test Loss: 7.362 Test Acc: 0.595
Validation loss decreased (-0.335185 --> -0.595302).  Saving model ...
Epoch: 3 cost time: 5.096678972244263
Epoch: 3, Steps: 67 | Train Loss: 1.291 Vali Loss: 3.665 Vali Acc: 0.728 Test Loss: 3.665 Test Acc: 0.728
Validation loss decreased (-0.595302 --> -0.728287).  Saving model ...
Epoch: 4 cost time: 4.049635887145996
Epoch: 4, Steps: 67 | Train Loss: 0.185 Vali Loss: 1.540 Vali Acc: 0.775 Test Loss: 1.540 Test Acc: 0.775
Validation loss decreased (-0.728287 --> -0.774551).  Saving model ...
Epoch: 5 cost time: 3.9450433254241943
Epoch: 5, Steps: 67 | Train Loss: 0.020 Vali Loss: 0.820 Vali Acc: 0.844 Test Loss: 0.820 Test Acc: 0.844
Validation loss decreased (-0.774551 --> -0.843922).  Saving model ...
Epoch: 6 cost time: 3.637739896774292
Epoch: 6, Steps: 67 | Train Loss: 0.093 Vali Loss: 1.611 Vali Acc: 0.821 Test Loss: 1.611 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8481075763702393
Epoch: 7, Steps: 67 | Train Loss: 0.136 Vali Loss: 2.693 Vali Acc: 0.769 Test Loss: 2.693 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.123456001281738
Epoch: 8, Steps: 67 | Train Loss: 0.261 Vali Loss: 6.946 Vali Acc: 0.647 Test Loss: 6.946 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.302009105682373
Epoch: 9, Steps: 67 | Train Loss: 0.256 Vali Loss: 2.029 Vali Acc: 0.832 Test Loss: 2.029 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6734695434570312
Epoch: 10, Steps: 67 | Train Loss: 0.120 Vali Loss: 2.261 Vali Acc: 0.798 Test Loss: 2.261 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.940530776977539
Epoch: 11, Steps: 67 | Train Loss: 0.006 Vali Loss: 2.083 Vali Acc: 0.838 Test Loss: 2.083 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.5931994915008545
Epoch: 12, Steps: 67 | Train Loss: 0.002 Vali Loss: 3.864 Vali Acc: 0.775 Test Loss: 3.864 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.336597204208374
Epoch: 13, Steps: 67 | Train Loss: 0.050 Vali Loss: 1.640 Vali Acc: 0.844 Test Loss: 1.640 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.19209361076355
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.844 Test Loss: 1.642 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.442826271057129
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.844 Test Loss: 1.646 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1752327
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 87.2259827
	speed: 0.1752s/iter; left time: 2330.4125s
Epoch: 1 cost time: 24.397650480270386
Epoch: 1, Steps: 134 | Train Loss: 87.086 Vali Loss: 34.429 Vali Acc: 0.538 Test Loss: 34.429 Test Acc: 0.538
Validation loss decreased (inf --> -0.537228).  Saving model ...
	iters: 100, epoch: 2 | loss: 91.6795807
	speed: 0.4129s/iter; left time: 5436.0625s
Epoch: 2 cost time: 21.466851472854614
Epoch: 2, Steps: 134 | Train Loss: 66.213 Vali Loss: 45.326 Vali Acc: 0.584 Test Loss: 45.326 Test Acc: 0.584
Validation loss decreased (-0.537228 --> -0.583362).  Saving model ...
	iters: 100, epoch: 3 | loss: 40.0142746
	speed: 0.4313s/iter; left time: 5621.3258s
Epoch: 3 cost time: 22.447935104370117
Epoch: 3, Steps: 134 | Train Loss: 7.070 Vali Loss: 17.770 Vali Acc: 0.682 Test Loss: 17.770 Test Acc: 0.682
Validation loss decreased (-0.583362 --> -0.681903).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4376s/iter; left time: 5645.0710s
Epoch: 4 cost time: 24.270769119262695
Epoch: 4, Steps: 134 | Train Loss: 1.663 Vali Loss: 5.281 Vali Acc: 0.734 Test Loss: 5.281 Test Acc: 0.734
Validation loss decreased (-0.681903 --> -0.734051).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4461s/iter; left time: 5694.0314s
Epoch: 5 cost time: 24.539317846298218
Epoch: 5, Steps: 134 | Train Loss: 0.533 Vali Loss: 18.379 Vali Acc: 0.671 Test Loss: 18.379 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4197s/iter; left time: 5301.1281s
Epoch: 6 cost time: 25.75261092185974
Epoch: 6, Steps: 134 | Train Loss: 1.173 Vali Loss: 21.438 Vali Acc: 0.746 Test Loss: 21.438 Test Acc: 0.746
Validation loss decreased (-0.734051 --> -0.745450).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4178s/iter; left time: 5221.5321s
Epoch: 7 cost time: 23.260640144348145
Epoch: 7, Steps: 134 | Train Loss: 0.251 Vali Loss: 13.949 Vali Acc: 0.746 Test Loss: 13.949 Test Acc: 0.746
Validation loss decreased (-0.745450 --> -0.745525).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3887s/iter; left time: 4805.7113s
Epoch: 8 cost time: 19.071887731552124
Epoch: 8, Steps: 134 | Train Loss: 0.501 Vali Loss: 13.641 Vali Acc: 0.728 Test Loss: 13.641 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3848s/iter; left time: 4705.2233s
Epoch: 9 cost time: 19.989665746688843
Epoch: 9, Steps: 134 | Train Loss: 0.502 Vali Loss: 11.037 Vali Acc: 0.763 Test Loss: 11.037 Test Acc: 0.763
Validation loss decreased (-0.745525 --> -0.762895).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3950s/iter; left time: 4777.8202s
Epoch: 10 cost time: 20.222862005233765
Epoch: 10, Steps: 134 | Train Loss: 0.865 Vali Loss: 7.701 Vali Acc: 0.780 Test Loss: 7.701 Test Acc: 0.780
Validation loss decreased (-0.762895 --> -0.780270).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3976s/iter; left time: 4755.9746s
Epoch: 11 cost time: 20.210506439208984
Epoch: 11, Steps: 134 | Train Loss: 4.024 Vali Loss: 21.910 Vali Acc: 0.584 Test Loss: 21.910 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4064s/iter; left time: 4806.9124s
Epoch: 12 cost time: 19.847447395324707
Epoch: 12, Steps: 134 | Train Loss: 1.871 Vali Loss: 18.335 Vali Acc: 0.746 Test Loss: 18.335 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3889s/iter; left time: 4547.0210s
Epoch: 13 cost time: 18.99327278137207
Epoch: 13, Steps: 134 | Train Loss: 1.188 Vali Loss: 15.249 Vali Acc: 0.728 Test Loss: 15.249 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 25.0787392
	speed: 0.3936s/iter; left time: 4550.1780s
Epoch: 14 cost time: 18.760770082473755
Epoch: 14, Steps: 134 | Train Loss: 0.906 Vali Loss: 14.263 Vali Acc: 0.809 Test Loss: 14.263 Test Acc: 0.809
Validation loss decreased (-0.780270 --> -0.809106).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3933s/iter; left time: 4493.4054s
Epoch: 15 cost time: 17.87484073638916
Epoch: 15, Steps: 134 | Train Loss: 0.076 Vali Loss: 27.676 Vali Acc: 0.757 Test Loss: 27.676 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3686s/iter; left time: 4161.9606s
Epoch: 16 cost time: 17.843047857284546
Epoch: 16, Steps: 134 | Train Loss: 1.012 Vali Loss: 22.832 Vali Acc: 0.734 Test Loss: 22.832 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3659s/iter; left time: 4082.6574s
Epoch: 17 cost time: 17.261414766311646
Epoch: 17, Steps: 134 | Train Loss: 0.360 Vali Loss: 17.893 Vali Acc: 0.792 Test Loss: 17.893 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3594s/iter; left time: 3961.8847s
Epoch: 18 cost time: 17.635056257247925
Epoch: 18, Steps: 134 | Train Loss: 0.333 Vali Loss: 29.119 Vali Acc: 0.775 Test Loss: 29.119 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3651s/iter; left time: 3975.3454s
Epoch: 19 cost time: 17.889961004257202
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 29.331 Vali Acc: 0.775 Test Loss: 29.331 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3860s/iter; left time: 4151.4538s
Epoch: 20 cost time: 19.607670545578003
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 29.662 Vali Acc: 0.786 Test Loss: 29.662 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.4003s/iter; left time: 4251.5328s
Epoch: 21 cost time: 18.64551067352295
Epoch: 21, Steps: 134 | Train Loss: 0.074 Vali Loss: 54.728 Vali Acc: 0.711 Test Loss: 54.728 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3806s/iter; left time: 3991.5043s
Epoch: 22 cost time: 18.268794536590576
Epoch: 22, Steps: 134 | Train Loss: 1.727 Vali Loss: 31.083 Vali Acc: 0.769 Test Loss: 31.083 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.4066s/iter; left time: 4209.3384s
Epoch: 23 cost time: 21.391069650650024
Epoch: 23, Steps: 134 | Train Loss: 1.162 Vali Loss: 41.545 Vali Acc: 0.682 Test Loss: 41.545 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.4130s/iter; left time: 4220.9426s
Epoch: 24 cost time: 22.060582160949707
Epoch: 24, Steps: 134 | Train Loss: 1.115 Vali Loss: 38.455 Vali Acc: 0.746 Test Loss: 38.455 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 15548551
model size : 59.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.575110912322998
Epoch: 1, Steps: 67 | Train Loss: 15.560 Vali Loss: 42.922 Vali Acc: 0.399 Test Loss: 42.922 Test Acc: 0.399
Validation loss decreased (inf --> -0.398415).  Saving model ...
Epoch: 2 cost time: 9.705918788909912
Epoch: 2, Steps: 67 | Train Loss: 24.109 Vali Loss: 62.603 Vali Acc: 0.462 Test Loss: 62.603 Test Acc: 0.462
Validation loss decreased (-0.398415 --> -0.461802).  Saving model ...
Epoch: 3 cost time: 8.670367956161499
Epoch: 3, Steps: 67 | Train Loss: 11.521 Vali Loss: 18.075 Vali Acc: 0.647 Test Loss: 18.075 Test Acc: 0.647
Validation loss decreased (-0.461802 --> -0.647218).  Saving model ...
Epoch: 4 cost time: 12.42622971534729
Epoch: 4, Steps: 67 | Train Loss: 4.343 Vali Loss: 21.070 Vali Acc: 0.682 Test Loss: 21.070 Test Acc: 0.682
Validation loss decreased (-0.647218 --> -0.681870).  Saving model ...
Epoch: 5 cost time: 8.292734146118164
Epoch: 5, Steps: 67 | Train Loss: 2.015 Vali Loss: 14.114 Vali Acc: 0.618 Test Loss: 14.114 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.20076060295105
Epoch: 6, Steps: 67 | Train Loss: 0.516 Vali Loss: 4.563 Vali Acc: 0.861 Test Loss: 4.563 Test Acc: 0.861
Validation loss decreased (-0.681870 --> -0.861226).  Saving model ...
Epoch: 7 cost time: 9.272754430770874
Epoch: 7, Steps: 67 | Train Loss: 0.563 Vali Loss: 9.525 Vali Acc: 0.723 Test Loss: 9.525 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.709912776947021
Epoch: 8, Steps: 67 | Train Loss: 0.135 Vali Loss: 4.807 Vali Acc: 0.803 Test Loss: 4.807 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.168903112411499
Epoch: 9, Steps: 67 | Train Loss: 0.196 Vali Loss: 7.319 Vali Acc: 0.740 Test Loss: 7.319 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.204080581665039
Epoch: 10, Steps: 67 | Train Loss: 0.108 Vali Loss: 4.326 Vali Acc: 0.792 Test Loss: 4.326 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.146808385848999
Epoch: 11, Steps: 67 | Train Loss: 0.152 Vali Loss: 5.203 Vali Acc: 0.803 Test Loss: 5.203 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.1225426197052
Epoch: 12, Steps: 67 | Train Loss: 0.177 Vali Loss: 7.598 Vali Acc: 0.786 Test Loss: 7.598 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.261928796768188
Epoch: 13, Steps: 67 | Train Loss: 0.015 Vali Loss: 3.870 Vali Acc: 0.803 Test Loss: 3.870 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.017439126968384
Epoch: 14, Steps: 67 | Train Loss: 0.155 Vali Loss: 13.464 Vali Acc: 0.769 Test Loss: 13.464 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.487268447875977
Epoch: 15, Steps: 67 | Train Loss: 0.232 Vali Loss: 15.509 Vali Acc: 0.734 Test Loss: 15.509 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.904917478561401
Epoch: 16, Steps: 67 | Train Loss: 0.292 Vali Loss: 7.315 Vali Acc: 0.780 Test Loss: 7.315 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 7783047
model size : 30.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.794819831848145
Epoch: 1, Steps: 67 | Train Loss: 9.217 Vali Loss: 13.629 Vali Acc: 0.445 Test Loss: 13.629 Test Acc: 0.445
Validation loss decreased (inf --> -0.444950).  Saving model ...
Epoch: 2 cost time: 5.988644123077393
Epoch: 2, Steps: 67 | Train Loss: 10.779 Vali Loss: 26.137 Vali Acc: 0.393 Test Loss: 26.137 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.68272852897644
Epoch: 3, Steps: 67 | Train Loss: 5.284 Vali Loss: 28.660 Vali Acc: 0.607 Test Loss: 28.660 Test Acc: 0.607
Validation loss decreased (-0.444950 --> -0.606650).  Saving model ...
Epoch: 4 cost time: 6.535489082336426
Epoch: 4, Steps: 67 | Train Loss: 3.166 Vali Loss: 17.985 Vali Acc: 0.624 Test Loss: 17.985 Test Acc: 0.624
Validation loss decreased (-0.606650 --> -0.624098).  Saving model ...
Epoch: 5 cost time: 8.020363330841064
Epoch: 5, Steps: 67 | Train Loss: 5.347 Vali Loss: 8.787 Vali Acc: 0.705 Test Loss: 8.787 Test Acc: 0.705
Validation loss decreased (-0.624098 --> -0.705114).  Saving model ...
Epoch: 6 cost time: 6.154874324798584
Epoch: 6, Steps: 67 | Train Loss: 1.331 Vali Loss: 9.601 Vali Acc: 0.728 Test Loss: 9.601 Test Acc: 0.728
Validation loss decreased (-0.705114 --> -0.728228).  Saving model ...
Epoch: 7 cost time: 7.925137281417847
Epoch: 7, Steps: 67 | Train Loss: 0.229 Vali Loss: 9.556 Vali Acc: 0.763 Test Loss: 9.556 Test Acc: 0.763
Validation loss decreased (-0.728228 --> -0.762910).  Saving model ...
Epoch: 8 cost time: 6.79927921295166
Epoch: 8, Steps: 67 | Train Loss: 0.060 Vali Loss: 6.755 Vali Acc: 0.832 Test Loss: 6.755 Test Acc: 0.832
Validation loss decreased (-0.762910 --> -0.832302).  Saving model ...
Epoch: 9 cost time: 7.705676794052124
Epoch: 9, Steps: 67 | Train Loss: 0.168 Vali Loss: 5.305 Vali Acc: 0.815 Test Loss: 5.305 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.61741304397583
Epoch: 10, Steps: 67 | Train Loss: 0.070 Vali Loss: 4.284 Vali Acc: 0.827 Test Loss: 4.284 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.139453649520874
Epoch: 11, Steps: 67 | Train Loss: 0.012 Vali Loss: 5.953 Vali Acc: 0.792 Test Loss: 5.953 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.871339321136475
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.877 Vali Acc: 0.792 Test Loss: 5.877 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.621679067611694
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.846 Vali Acc: 0.792 Test Loss: 5.846 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.0194621086120605
Epoch: 14, Steps: 67 | Train Loss: 0.447 Vali Loss: 16.332 Vali Acc: 0.734 Test Loss: 16.332 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.930577754974365
Epoch: 15, Steps: 67 | Train Loss: 0.454 Vali Loss: 8.543 Vali Acc: 0.780 Test Loss: 8.543 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.614877223968506
Epoch: 16, Steps: 67 | Train Loss: 0.128 Vali Loss: 8.204 Vali Acc: 0.740 Test Loss: 8.204 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.727588891983032
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.592 Vali Acc: 0.809 Test Loss: 3.592 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 8.649138689041138
Epoch: 18, Steps: 67 | Train Loss: 0.084 Vali Loss: 9.095 Vali Acc: 0.780 Test Loss: 9.095 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 5194599
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.52084994316101
Epoch: 1, Steps: 67 | Train Loss: 7.321 Vali Loss: 19.899 Vali Acc: 0.434 Test Loss: 19.899 Test Acc: 0.434
Validation loss decreased (inf --> -0.433327).  Saving model ...
Epoch: 2 cost time: 7.083202362060547
Epoch: 2, Steps: 67 | Train Loss: 8.286 Vali Loss: 11.256 Vali Acc: 0.566 Test Loss: 11.256 Test Acc: 0.566
Validation loss decreased (-0.433327 --> -0.566361).  Saving model ...
Epoch: 3 cost time: 6.278958559036255
Epoch: 3, Steps: 67 | Train Loss: 3.696 Vali Loss: 8.728 Vali Acc: 0.514 Test Loss: 8.728 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1465654373168945
Epoch: 4, Steps: 67 | Train Loss: 1.634 Vali Loss: 7.868 Vali Acc: 0.728 Test Loss: 7.868 Test Acc: 0.728
Validation loss decreased (-0.566361 --> -0.728245).  Saving model ...
Epoch: 5 cost time: 6.800942420959473
Epoch: 5, Steps: 67 | Train Loss: 0.553 Vali Loss: 7.290 Vali Acc: 0.780 Test Loss: 7.290 Test Acc: 0.780
Validation loss decreased (-0.728245 --> -0.780274).  Saving model ...
Epoch: 6 cost time: 5.769001483917236
Epoch: 6, Steps: 67 | Train Loss: 0.394 Vali Loss: 9.801 Vali Acc: 0.746 Test Loss: 9.801 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.300424098968506
Epoch: 7, Steps: 67 | Train Loss: 1.265 Vali Loss: 12.211 Vali Acc: 0.671 Test Loss: 12.211 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.133309364318848
Epoch: 8, Steps: 67 | Train Loss: 0.952 Vali Loss: 5.725 Vali Acc: 0.769 Test Loss: 5.725 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.917574405670166
Epoch: 9, Steps: 67 | Train Loss: 0.093 Vali Loss: 6.869 Vali Acc: 0.751 Test Loss: 6.869 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.558938980102539
Epoch: 10, Steps: 67 | Train Loss: 0.006 Vali Loss: 9.751 Vali Acc: 0.769 Test Loss: 9.751 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.206757307052612
Epoch: 11, Steps: 67 | Train Loss: 0.299 Vali Loss: 2.820 Vali Acc: 0.792 Test Loss: 2.820 Test Acc: 0.792
Validation loss decreased (-0.780274 --> -0.791879).  Saving model ...
Epoch: 12 cost time: 6.3325207233428955
Epoch: 12, Steps: 67 | Train Loss: 0.087 Vali Loss: 5.658 Vali Acc: 0.803 Test Loss: 5.658 Test Acc: 0.803
Validation loss decreased (-0.791879 --> -0.803412).  Saving model ...
Epoch: 13 cost time: 5.60377049446106
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.057 Vali Acc: 0.821 Test Loss: 4.057 Test Acc: 0.821
Validation loss decreased (-0.803412 --> -0.820769).  Saving model ...
Epoch: 14 cost time: 6.129138946533203
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.934 Vali Acc: 0.821 Test Loss: 3.934 Test Acc: 0.821
Validation loss decreased (-0.820769 --> -0.820770).  Saving model ...
Epoch: 15 cost time: 6.315704584121704
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.931 Vali Acc: 0.821 Test Loss: 3.931 Test Acc: 0.821
Validation loss decreased (-0.820770 --> -0.820770).  Saving model ...
Epoch: 16 cost time: 6.874340295791626
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.926 Vali Acc: 0.821 Test Loss: 3.926 Test Acc: 0.821
Validation loss decreased (-0.820770 --> -0.820770).  Saving model ...
Epoch: 17 cost time: 5.308181524276733
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.934 Vali Acc: 0.821 Test Loss: 3.934 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.7354559898376465
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.937 Vali Acc: 0.821 Test Loss: 3.937 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.806806564331055
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.874 Vali Acc: 0.821 Test Loss: 3.874 Test Acc: 0.821
Validation loss decreased (-0.820770 --> -0.820771).  Saving model ...
Epoch: 20 cost time: 6.2711193561553955
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.864 Vali Acc: 0.821 Test Loss: 3.864 Test Acc: 0.821
Validation loss decreased (-0.820771 --> -0.820771).  Saving model ...
Epoch: 21 cost time: 6.9491612911224365
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.864 Vali Acc: 0.821 Test Loss: 3.864 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.66858983039856
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.821 Test Loss: 3.858 Test Acc: 0.821
Validation loss decreased (-0.820771 --> -0.820771).  Saving model ...
Epoch: 23 cost time: 8.128322839736938
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.869 Vali Acc: 0.821 Test Loss: 3.869 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.77940559387207
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.857 Vali Acc: 0.821 Test Loss: 3.857 Test Acc: 0.821
Validation loss decreased (-0.820771 --> -0.820771).  Saving model ...
Epoch: 25 cost time: 6.0205278396606445
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.872 Vali Acc: 0.821 Test Loss: 3.872 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.696778297424316
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.866 Vali Acc: 0.821 Test Loss: 3.866 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.866963624954224
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.867 Vali Acc: 0.821 Test Loss: 3.867 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 8.863600969314575
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.860 Vali Acc: 0.821 Test Loss: 3.860 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.696777582168579
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.862 Vali Acc: 0.821 Test Loss: 3.862 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.327151298522949
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.866 Vali Acc: 0.821 Test Loss: 3.866 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.482586860656738
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.865 Vali Acc: 0.821 Test Loss: 3.865 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.340924978256226
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.821 Test Loss: 3.870 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 8.23042893409729
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.872 Vali Acc: 0.821 Test Loss: 3.872 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.230786085128784
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.858 Vali Acc: 0.821 Test Loss: 3.858 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3900455
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.060896873474121
Epoch: 1, Steps: 67 | Train Loss: 4.744 Vali Loss: 3.015 Vali Acc: 0.624 Test Loss: 3.015 Test Acc: 0.624
Validation loss decreased (inf --> -0.624247).  Saving model ...
Epoch: 2 cost time: 5.505315542221069
Epoch: 2, Steps: 67 | Train Loss: 3.928 Vali Loss: 4.769 Vali Acc: 0.723 Test Loss: 4.769 Test Acc: 0.723
Validation loss decreased (-0.624247 --> -0.722496).  Saving model ...
Epoch: 3 cost time: 7.127903938293457
Epoch: 3, Steps: 67 | Train Loss: 2.086 Vali Loss: 2.284 Vali Acc: 0.815 Test Loss: 2.284 Test Acc: 0.815
Validation loss decreased (-0.722496 --> -0.815006).  Saving model ...
Epoch: 4 cost time: 5.720000982284546
Epoch: 4, Steps: 67 | Train Loss: 0.542 Vali Loss: 1.891 Vali Acc: 0.827 Test Loss: 1.891 Test Acc: 0.827
Validation loss decreased (-0.815006 --> -0.826571).  Saving model ...
Epoch: 5 cost time: 5.778197288513184
Epoch: 5, Steps: 67 | Train Loss: 0.189 Vali Loss: 3.393 Vali Acc: 0.815 Test Loss: 3.393 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.9476728439331055
Epoch: 6, Steps: 67 | Train Loss: 0.385 Vali Loss: 2.784 Vali Acc: 0.798 Test Loss: 2.784 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.177547931671143
Epoch: 7, Steps: 67 | Train Loss: 0.992 Vali Loss: 9.877 Vali Acc: 0.694 Test Loss: 9.877 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.525387763977051
Epoch: 8, Steps: 67 | Train Loss: 0.889 Vali Loss: 3.709 Vali Acc: 0.786 Test Loss: 3.709 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.467344284057617
Epoch: 9, Steps: 67 | Train Loss: 0.316 Vali Loss: 2.929 Vali Acc: 0.884 Test Loss: 2.929 Test Acc: 0.884
Validation loss decreased (-0.826571 --> -0.884364).  Saving model ...
Epoch: 10 cost time: 5.435630798339844
Epoch: 10, Steps: 67 | Train Loss: 0.058 Vali Loss: 6.282 Vali Acc: 0.803 Test Loss: 6.282 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.92069673538208
Epoch: 11, Steps: 67 | Train Loss: 0.104 Vali Loss: 7.990 Vali Acc: 0.734 Test Loss: 7.990 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.39723801612854
Epoch: 12, Steps: 67 | Train Loss: 0.015 Vali Loss: 5.897 Vali Acc: 0.792 Test Loss: 5.897 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.100590467453003
Epoch: 13, Steps: 67 | Train Loss: 0.090 Vali Loss: 7.287 Vali Acc: 0.815 Test Loss: 7.287 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.009108066558838
Epoch: 14, Steps: 67 | Train Loss: 0.114 Vali Loss: 5.296 Vali Acc: 0.803 Test Loss: 5.296 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.24213171005249
Epoch: 15, Steps: 67 | Train Loss: 0.050 Vali Loss: 5.510 Vali Acc: 0.786 Test Loss: 5.510 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.3189520835876465
Epoch: 16, Steps: 67 | Train Loss: 0.012 Vali Loss: 4.338 Vali Acc: 0.798 Test Loss: 4.338 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.757444620132446
Epoch: 17, Steps: 67 | Train Loss: 0.275 Vali Loss: 8.102 Vali Acc: 0.769 Test Loss: 8.102 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.844258069992065
Epoch: 18, Steps: 67 | Train Loss: 0.778 Vali Loss: 11.371 Vali Acc: 0.676 Test Loss: 11.371 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.274064540863037
Epoch: 19, Steps: 67 | Train Loss: 0.497 Vali Loss: 4.553 Vali Acc: 0.798 Test Loss: 4.553 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 2822119
model size : 11.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.22747540473938
Epoch: 1, Steps: 67 | Train Loss: 4.608 Vali Loss: 4.284 Vali Acc: 0.578 Test Loss: 4.284 Test Acc: 0.578
Validation loss decreased (inf --> -0.577992).  Saving model ...
Epoch: 2 cost time: 4.391194105148315
Epoch: 2, Steps: 67 | Train Loss: 2.918 Vali Loss: 6.208 Vali Acc: 0.618 Test Loss: 6.208 Test Acc: 0.618
Validation loss decreased (-0.577992 --> -0.618435).  Saving model ...
Epoch: 3 cost time: 4.242819547653198
Epoch: 3, Steps: 67 | Train Loss: 1.094 Vali Loss: 2.065 Vali Acc: 0.763 Test Loss: 2.065 Test Acc: 0.763
Validation loss decreased (-0.618435 --> -0.762985).  Saving model ...
Epoch: 4 cost time: 6.322392463684082
Epoch: 4, Steps: 67 | Train Loss: 0.407 Vali Loss: 2.563 Vali Acc: 0.780 Test Loss: 2.563 Test Acc: 0.780
Validation loss decreased (-0.762985 --> -0.780321).  Saving model ...
Epoch: 5 cost time: 4.06001877784729
Epoch: 5, Steps: 67 | Train Loss: 0.480 Vali Loss: 3.038 Vali Acc: 0.746 Test Loss: 3.038 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.755104064941406
Epoch: 6, Steps: 67 | Train Loss: 0.783 Vali Loss: 6.205 Vali Acc: 0.682 Test Loss: 6.205 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.3676369190216064
Epoch: 7, Steps: 67 | Train Loss: 0.246 Vali Loss: 8.150 Vali Acc: 0.728 Test Loss: 8.150 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.448140859603882
Epoch: 8, Steps: 67 | Train Loss: 0.238 Vali Loss: 3.473 Vali Acc: 0.786 Test Loss: 3.473 Test Acc: 0.786
Validation loss decreased (-0.780321 --> -0.786092).  Saving model ...
Epoch: 9 cost time: 6.508040428161621
Epoch: 9, Steps: 67 | Train Loss: 0.062 Vali Loss: 2.664 Vali Acc: 0.844 Test Loss: 2.664 Test Acc: 0.844
Validation loss decreased (-0.786092 --> -0.843904).  Saving model ...
Epoch: 10 cost time: 4.491316795349121
Epoch: 10, Steps: 67 | Train Loss: 0.038 Vali Loss: 2.227 Vali Acc: 0.832 Test Loss: 2.227 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.55424952507019
Epoch: 11, Steps: 67 | Train Loss: 0.102 Vali Loss: 2.414 Vali Acc: 0.850 Test Loss: 2.414 Test Acc: 0.850
Validation loss decreased (-0.843904 --> -0.849687).  Saving model ...
Epoch: 12 cost time: 5.787694692611694
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.855 Test Loss: 2.249 Test Acc: 0.855
Validation loss decreased (-0.849687 --> -0.855469).  Saving model ...
Epoch: 13 cost time: 4.896284103393555
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.855 Test Loss: 2.197 Test Acc: 0.855
Validation loss decreased (-0.855469 --> -0.855469).  Saving model ...
Epoch: 14 cost time: 6.5843048095703125
Epoch: 14, Steps: 67 | Train Loss: 0.353 Vali Loss: 3.673 Vali Acc: 0.694 Test Loss: 3.673 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5505290031433105
Epoch: 15, Steps: 67 | Train Loss: 0.040 Vali Loss: 2.046 Vali Acc: 0.850 Test Loss: 2.046 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.741598606109619
Epoch: 16, Steps: 67 | Train Loss: 0.156 Vali Loss: 8.101 Vali Acc: 0.746 Test Loss: 8.101 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.4546308517456055
Epoch: 17, Steps: 67 | Train Loss: 0.331 Vali Loss: 5.649 Vali Acc: 0.775 Test Loss: 5.649 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.546305418014526
Epoch: 18, Steps: 67 | Train Loss: 0.059 Vali Loss: 3.288 Vali Acc: 0.815 Test Loss: 3.288 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.574115753173828
Epoch: 19, Steps: 67 | Train Loss: 0.012 Vali Loss: 2.531 Vali Acc: 0.844 Test Loss: 2.531 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.642931222915649
Epoch: 20, Steps: 67 | Train Loss: 0.046 Vali Loss: 4.103 Vali Acc: 0.809 Test Loss: 4.103 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.868905067443848
Epoch: 21, Steps: 67 | Train Loss: 0.060 Vali Loss: 2.800 Vali Acc: 0.827 Test Loss: 2.800 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.74876856803894
Epoch: 22, Steps: 67 | Train Loss: 0.100 Vali Loss: 4.174 Vali Acc: 0.780 Test Loss: 4.174 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.337168216705322
Epoch: 23, Steps: 67 | Train Loss: 0.030 Vali Loss: 3.614 Vali Acc: 0.809 Test Loss: 3.614 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1959495
model size : 8.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.845269441604614
Epoch: 1, Steps: 67 | Train Loss: 4.247 Vali Loss: 3.223 Vali Acc: 0.642 Test Loss: 3.223 Test Acc: 0.642
Validation loss decreased (inf --> -0.641586).  Saving model ...
Epoch: 2 cost time: 4.343291759490967
Epoch: 2, Steps: 67 | Train Loss: 2.906 Vali Loss: 2.525 Vali Acc: 0.699 Test Loss: 2.525 Test Acc: 0.699
Validation loss decreased (-0.641586 --> -0.699397).  Saving model ...
Epoch: 3 cost time: 5.924028396606445
Epoch: 3, Steps: 67 | Train Loss: 0.513 Vali Loss: 3.807 Vali Acc: 0.699 Test Loss: 3.807 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.188721418380737
Epoch: 4, Steps: 67 | Train Loss: 1.326 Vali Loss: 2.779 Vali Acc: 0.717 Test Loss: 2.779 Test Acc: 0.717
Validation loss decreased (-0.699397 --> -0.716735).  Saving model ...
Epoch: 5 cost time: 4.87566351890564
Epoch: 5, Steps: 67 | Train Loss: 1.366 Vali Loss: 5.779 Vali Acc: 0.566 Test Loss: 5.779 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7582106590271
Epoch: 6, Steps: 67 | Train Loss: 0.076 Vali Loss: 3.058 Vali Acc: 0.699 Test Loss: 3.058 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.294151067733765
Epoch: 7, Steps: 67 | Train Loss: 0.234 Vali Loss: 3.443 Vali Acc: 0.751 Test Loss: 3.443 Test Acc: 0.751
Validation loss decreased (-0.716735 --> -0.751411).  Saving model ...
Epoch: 8 cost time: 6.146570920944214
Epoch: 8, Steps: 67 | Train Loss: 0.097 Vali Loss: 2.278 Vali Acc: 0.786 Test Loss: 2.278 Test Acc: 0.786
Validation loss decreased (-0.751411 --> -0.786104).  Saving model ...
Epoch: 9 cost time: 5.564276695251465
Epoch: 9, Steps: 67 | Train Loss: 0.062 Vali Loss: 2.288 Vali Acc: 0.821 Test Loss: 2.288 Test Acc: 0.821
Validation loss decreased (-0.786104 --> -0.820786).  Saving model ...
Epoch: 10 cost time: 5.288900375366211
Epoch: 10, Steps: 67 | Train Loss: 0.056 Vali Loss: 4.086 Vali Acc: 0.786 Test Loss: 4.086 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.155439138412476
Epoch: 11, Steps: 67 | Train Loss: 0.064 Vali Loss: 3.288 Vali Acc: 0.757 Test Loss: 3.288 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.212335586547852
Epoch: 12, Steps: 67 | Train Loss: 0.046 Vali Loss: 3.788 Vali Acc: 0.757 Test Loss: 3.788 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.120935440063477
Epoch: 13, Steps: 67 | Train Loss: 0.073 Vali Loss: 5.033 Vali Acc: 0.740 Test Loss: 5.033 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.273085832595825
Epoch: 14, Steps: 67 | Train Loss: 0.130 Vali Loss: 2.527 Vali Acc: 0.775 Test Loss: 2.527 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.930447816848755
Epoch: 15, Steps: 67 | Train Loss: 0.025 Vali Loss: 2.791 Vali Acc: 0.786 Test Loss: 2.791 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.244813442230225
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.845 Vali Acc: 0.780 Test Loss: 2.845 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.973706483840942
Epoch: 17, Steps: 67 | Train Loss: 0.072 Vali Loss: 2.419 Vali Acc: 0.769 Test Loss: 2.419 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.459989070892334
Epoch: 18, Steps: 67 | Train Loss: 0.825 Vali Loss: 5.070 Vali Acc: 0.676 Test Loss: 5.070 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.401855945587158
Epoch: 19, Steps: 67 | Train Loss: 0.324 Vali Loss: 4.335 Vali Acc: 0.734 Test Loss: 4.335 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1744007
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 26.0887985
	speed: 0.2110s/iter; left time: 2806.5893s
Epoch: 1 cost time: 26.48592519760132
Epoch: 1, Steps: 134 | Train Loss: 37.165 Vali Loss: 46.001 Vali Acc: 0.451 Test Loss: 46.001 Test Acc: 0.451
Validation loss decreased (inf --> -0.450407).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.3848s/iter; left time: 5066.4482s
Epoch: 2 cost time: 22.0037624835968
Epoch: 2, Steps: 134 | Train Loss: 32.033 Vali Loss: 32.595 Vali Acc: 0.636 Test Loss: 32.595 Test Acc: 0.636
Validation loss decreased (-0.450407 --> -0.635512).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034218
	speed: 0.4158s/iter; left time: 5418.8428s
Epoch: 3 cost time: 25.017992973327637
Epoch: 3, Steps: 134 | Train Loss: 3.232 Vali Loss: 4.258 Vali Acc: 0.746 Test Loss: 4.258 Test Acc: 0.746
Validation loss decreased (-0.635512 --> -0.745622).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4292s/iter; left time: 5535.7789s
Epoch: 4 cost time: 26.143651485443115
Epoch: 4, Steps: 134 | Train Loss: 0.636 Vali Loss: 2.116 Vali Acc: 0.815 Test Loss: 2.116 Test Acc: 0.815
Validation loss decreased (-0.745622 --> -0.815008).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4580s/iter; left time: 5845.7475s
Epoch: 5 cost time: 26.73813557624817
Epoch: 5, Steps: 134 | Train Loss: 0.037 Vali Loss: 1.637 Vali Acc: 0.844 Test Loss: 1.637 Test Acc: 0.844
Validation loss decreased (-0.815008 --> -0.843914).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3979s/iter; left time: 5025.9312s
Epoch: 6 cost time: 23.61257791519165
Epoch: 6, Steps: 134 | Train Loss: 0.041 Vali Loss: 1.379 Vali Acc: 0.855 Test Loss: 1.379 Test Acc: 0.855
Validation loss decreased (-0.843914 --> -0.855478).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3765s/iter; left time: 4705.4803s
Epoch: 7 cost time: 21.097063064575195
Epoch: 7, Steps: 134 | Train Loss: 1.620 Vali Loss: 11.932 Vali Acc: 0.613 Test Loss: 11.932 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3754s/iter; left time: 4640.6998s
Epoch: 8 cost time: 20.670538187026978
Epoch: 8, Steps: 134 | Train Loss: 1.027 Vali Loss: 6.763 Vali Acc: 0.815 Test Loss: 6.763 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3695s/iter; left time: 4518.5078s
Epoch: 9 cost time: 20.575599670410156
Epoch: 9, Steps: 134 | Train Loss: 1.941 Vali Loss: 6.307 Vali Acc: 0.821 Test Loss: 6.307 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3820s/iter; left time: 4619.7301s
Epoch: 10 cost time: 20.52824640274048
Epoch: 10, Steps: 134 | Train Loss: 0.536 Vali Loss: 4.493 Vali Acc: 0.809 Test Loss: 4.493 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3785s/iter; left time: 4527.3145s
Epoch: 11 cost time: 20.868489980697632
Epoch: 11, Steps: 134 | Train Loss: 0.350 Vali Loss: 13.948 Vali Acc: 0.694 Test Loss: 13.948 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3806s/iter; left time: 4500.9771s
Epoch: 12 cost time: 21.022459983825684
Epoch: 12, Steps: 134 | Train Loss: 0.450 Vali Loss: 7.707 Vali Acc: 0.809 Test Loss: 7.707 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4025s/iter; left time: 4706.2832s
Epoch: 13 cost time: 22.99525737762451
Epoch: 13, Steps: 134 | Train Loss: 0.038 Vali Loss: 10.665 Vali Acc: 0.803 Test Loss: 10.665 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3704s/iter; left time: 4281.4050s
Epoch: 14 cost time: 19.949546337127686
Epoch: 14, Steps: 134 | Train Loss: 0.001 Vali Loss: 11.094 Vali Acc: 0.786 Test Loss: 11.094 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3851s/iter; left time: 4399.6857s
Epoch: 15 cost time: 20.547950506210327
Epoch: 15, Steps: 134 | Train Loss: 0.740 Vali Loss: 7.034 Vali Acc: 0.803 Test Loss: 7.034 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3863s/iter; left time: 4361.9152s
Epoch: 16 cost time: 21.668509006500244
Epoch: 16, Steps: 134 | Train Loss: 1.148 Vali Loss: 17.743 Vali Acc: 0.659 Test Loss: 17.743 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 7784967
model size : 30.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.527382135391235
Epoch: 1, Steps: 67 | Train Loss: 13.036 Vali Loss: 11.242 Vali Acc: 0.532 Test Loss: 11.242 Test Acc: 0.532
Validation loss decreased (inf --> -0.531679).  Saving model ...
Epoch: 2 cost time: 11.298633098602295
Epoch: 2, Steps: 67 | Train Loss: 7.548 Vali Loss: 13.480 Vali Acc: 0.468 Test Loss: 13.480 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.01035451889038
Epoch: 3, Steps: 67 | Train Loss: 2.443 Vali Loss: 6.943 Vali Acc: 0.705 Test Loss: 6.943 Test Acc: 0.705
Validation loss decreased (-0.531679 --> -0.705133).  Saving model ...
Epoch: 4 cost time: 8.982540369033813
Epoch: 4, Steps: 67 | Train Loss: 1.771 Vali Loss: 3.674 Vali Acc: 0.792 Test Loss: 3.674 Test Acc: 0.792
Validation loss decreased (-0.705133 --> -0.791871).  Saving model ...
Epoch: 5 cost time: 8.118775606155396
Epoch: 5, Steps: 67 | Train Loss: 0.410 Vali Loss: 1.649 Vali Acc: 0.803 Test Loss: 1.649 Test Acc: 0.803
Validation loss decreased (-0.791871 --> -0.803452).  Saving model ...
Epoch: 6 cost time: 7.9425787925720215
Epoch: 6, Steps: 67 | Train Loss: 0.173 Vali Loss: 2.882 Vali Acc: 0.769 Test Loss: 2.882 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.170607566833496
Epoch: 7, Steps: 67 | Train Loss: 0.039 Vali Loss: 2.959 Vali Acc: 0.751 Test Loss: 2.959 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.240241050720215
Epoch: 8, Steps: 67 | Train Loss: 0.277 Vali Loss: 6.603 Vali Acc: 0.728 Test Loss: 6.603 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 12.287998914718628
Epoch: 9, Steps: 67 | Train Loss: 0.243 Vali Loss: 4.661 Vali Acc: 0.803 Test Loss: 4.661 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.472921133041382
Epoch: 10, Steps: 67 | Train Loss: 0.158 Vali Loss: 2.891 Vali Acc: 0.769 Test Loss: 2.891 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.327703952789307
Epoch: 11, Steps: 67 | Train Loss: 0.077 Vali Loss: 3.630 Vali Acc: 0.792 Test Loss: 3.630 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 14.784752607345581
Epoch: 12, Steps: 67 | Train Loss: 0.075 Vali Loss: 5.476 Vali Acc: 0.746 Test Loss: 5.476 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.384419441223145
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.870 Vali Acc: 0.832 Test Loss: 3.870 Test Acc: 0.832
Validation loss decreased (-0.803452 --> -0.832331).  Saving model ...
Epoch: 14 cost time: 12.39569878578186
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.891 Vali Acc: 0.832 Test Loss: 3.891 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.622597694396973
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.843 Vali Acc: 0.832 Test Loss: 3.843 Test Acc: 0.832
Validation loss decreased (-0.832331 --> -0.832332).  Saving model ...
Epoch: 16 cost time: 10.310042142868042
Epoch: 16, Steps: 67 | Train Loss: 0.085 Vali Loss: 2.981 Vali Acc: 0.809 Test Loss: 2.981 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 13.91468620300293
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.020 Vali Acc: 0.809 Test Loss: 3.020 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.49671721458435
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.017 Vali Acc: 0.809 Test Loss: 3.017 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.163058519363403
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.014 Vali Acc: 0.809 Test Loss: 3.014 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 11.170321464538574
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.009 Vali Acc: 0.809 Test Loss: 3.009 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.173762083053589
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.025 Vali Acc: 0.809 Test Loss: 3.025 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 12.998207092285156
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.996 Vali Acc: 0.815 Test Loss: 2.996 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 11.964215755462646
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.003 Vali Acc: 0.815 Test Loss: 3.003 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 13.343762159347534
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.047 Vali Acc: 0.815 Test Loss: 3.047 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 11.526902198791504
Epoch: 25, Steps: 67 | Train Loss: 1.302 Vali Loss: 15.180 Vali Acc: 0.618 Test Loss: 15.180 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3902215
model size : 15.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.506834506988525
Epoch: 1, Steps: 67 | Train Loss: 6.547 Vali Loss: 14.375 Vali Acc: 0.347 Test Loss: 14.375 Test Acc: 0.347
Validation loss decreased (inf --> -0.346677).  Saving model ...
Epoch: 2 cost time: 9.649574995040894
Epoch: 2, Steps: 67 | Train Loss: 6.793 Vali Loss: 8.832 Vali Acc: 0.555 Test Loss: 8.832 Test Acc: 0.555
Validation loss decreased (-0.346677 --> -0.554825).  Saving model ...
Epoch: 3 cost time: 6.931031227111816
Epoch: 3, Steps: 67 | Train Loss: 4.019 Vali Loss: 4.020 Vali Acc: 0.676 Test Loss: 4.020 Test Acc: 0.676
Validation loss decreased (-0.554825 --> -0.676260).  Saving model ...
Epoch: 4 cost time: 9.305114984512329
Epoch: 4, Steps: 67 | Train Loss: 0.853 Vali Loss: 2.973 Vali Acc: 0.734 Test Loss: 2.973 Test Acc: 0.734
Validation loss decreased (-0.676260 --> -0.734074).  Saving model ...
Epoch: 5 cost time: 6.5452189445495605
Epoch: 5, Steps: 67 | Train Loss: 0.147 Vali Loss: 1.258 Vali Acc: 0.792 Test Loss: 1.258 Test Acc: 0.792
Validation loss decreased (-0.734074 --> -0.791895).  Saving model ...
Epoch: 6 cost time: 8.766695499420166
Epoch: 6, Steps: 67 | Train Loss: 0.151 Vali Loss: 2.600 Vali Acc: 0.699 Test Loss: 2.600 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.328423023223877
Epoch: 7, Steps: 67 | Train Loss: 0.139 Vali Loss: 2.910 Vali Acc: 0.780 Test Loss: 2.910 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.526272296905518
Epoch: 8, Steps: 67 | Train Loss: 0.082 Vali Loss: 2.762 Vali Acc: 0.757 Test Loss: 2.762 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.118583917617798
Epoch: 9, Steps: 67 | Train Loss: 0.003 Vali Loss: 2.866 Vali Acc: 0.775 Test Loss: 2.866 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.038847208023071
Epoch: 10, Steps: 67 | Train Loss: 0.027 Vali Loss: 1.525 Vali Acc: 0.815 Test Loss: 1.525 Test Acc: 0.815
Validation loss decreased (-0.791895 --> -0.815014).  Saving model ...
Epoch: 11 cost time: 6.596659183502197
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.809 Test Loss: 1.536 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.48171091079712
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.803 Test Loss: 1.506 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.7642199993133545
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.504 Vali Acc: 0.803 Test Loss: 1.504 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.428327560424805
Epoch: 14, Steps: 67 | Train Loss: 0.008 Vali Loss: 3.299 Vali Acc: 0.827 Test Loss: 3.299 Test Acc: 0.827
Validation loss decreased (-0.815014 --> -0.826557).  Saving model ...
Epoch: 15 cost time: 6.593026399612427
Epoch: 15, Steps: 67 | Train Loss: 0.266 Vali Loss: 5.849 Vali Acc: 0.671 Test Loss: 5.849 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 10.271106958389282
Epoch: 16, Steps: 67 | Train Loss: 0.694 Vali Loss: 5.739 Vali Acc: 0.746 Test Loss: 5.739 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.4992289543151855
Epoch: 17, Steps: 67 | Train Loss: 0.360 Vali Loss: 4.754 Vali Acc: 0.809 Test Loss: 4.754 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.79588270187378
Epoch: 18, Steps: 67 | Train Loss: 0.059 Vali Loss: 6.997 Vali Acc: 0.763 Test Loss: 6.997 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.905996561050415
Epoch: 19, Steps: 67 | Train Loss: 0.098 Vali Loss: 7.142 Vali Acc: 0.723 Test Loss: 7.142 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.563049793243408
Epoch: 20, Steps: 67 | Train Loss: 0.060 Vali Loss: 3.965 Vali Acc: 0.809 Test Loss: 3.965 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.420673608779907
Epoch: 21, Steps: 67 | Train Loss: 0.012 Vali Loss: 2.627 Vali Acc: 0.786 Test Loss: 2.627 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.67953085899353
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.363 Vali Acc: 0.798 Test Loss: 4.363 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.866422414779663
Epoch: 23, Steps: 67 | Train Loss: 0.133 Vali Loss: 2.665 Vali Acc: 0.803 Test Loss: 2.665 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.958621263504028
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.653 Vali Acc: 0.809 Test Loss: 2.653 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2607991
model size : 10.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.384194135665894
Epoch: 1, Steps: 67 | Train Loss: 4.046 Vali Loss: 4.569 Vali Acc: 0.520 Test Loss: 4.569 Test Acc: 0.520
Validation loss decreased (inf --> -0.520186).  Saving model ...
Epoch: 2 cost time: 5.441908359527588
Epoch: 2, Steps: 67 | Train Loss: 3.270 Vali Loss: 6.168 Vali Acc: 0.694 Test Loss: 6.168 Test Acc: 0.694
Validation loss decreased (-0.520186 --> -0.693580).  Saving model ...
Epoch: 3 cost time: 7.202384948730469
Epoch: 3, Steps: 67 | Train Loss: 2.689 Vali Loss: 5.209 Vali Acc: 0.642 Test Loss: 5.209 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.825937986373901
Epoch: 4, Steps: 67 | Train Loss: 0.573 Vali Loss: 2.246 Vali Acc: 0.821 Test Loss: 2.246 Test Acc: 0.821
Validation loss decreased (-0.693580 --> -0.820787).  Saving model ...
Epoch: 5 cost time: 8.995160818099976
Epoch: 5, Steps: 67 | Train Loss: 0.222 Vali Loss: 2.482 Vali Acc: 0.786 Test Loss: 2.482 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.807095289230347
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.753 Vali Acc: 0.688 Test Loss: 3.753 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.980882167816162
Epoch: 7, Steps: 67 | Train Loss: 1.261 Vali Loss: 4.993 Vali Acc: 0.717 Test Loss: 4.993 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.335938453674316
Epoch: 8, Steps: 67 | Train Loss: 0.771 Vali Loss: 2.852 Vali Acc: 0.792 Test Loss: 2.852 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.157430171966553
Epoch: 9, Steps: 67 | Train Loss: 0.363 Vali Loss: 2.183 Vali Acc: 0.780 Test Loss: 2.183 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.2155046463012695
Epoch: 10, Steps: 67 | Train Loss: 0.061 Vali Loss: 2.546 Vali Acc: 0.740 Test Loss: 2.546 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.847211122512817
Epoch: 11, Steps: 67 | Train Loss: 0.087 Vali Loss: 6.628 Vali Acc: 0.705 Test Loss: 6.628 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.131747722625732
Epoch: 12, Steps: 67 | Train Loss: 0.194 Vali Loss: 3.550 Vali Acc: 0.757 Test Loss: 3.550 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.11200475692749
Epoch: 13, Steps: 67 | Train Loss: 0.091 Vali Loss: 2.565 Vali Acc: 0.775 Test Loss: 2.565 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.658413887023926
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.773 Vali Acc: 0.763 Test Loss: 2.773 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1960919
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.102019548416138
Epoch: 1, Steps: 67 | Train Loss: 3.164 Vali Loss: 2.293 Vali Acc: 0.497 Test Loss: 2.293 Test Acc: 0.497
Validation loss decreased (inf --> -0.497087).  Saving model ...
Epoch: 2 cost time: 5.386814832687378
Epoch: 2, Steps: 67 | Train Loss: 2.048 Vali Loss: 2.531 Vali Acc: 0.682 Test Loss: 2.531 Test Acc: 0.682
Validation loss decreased (-0.497087 --> -0.682056).  Saving model ...
Epoch: 3 cost time: 6.691141605377197
Epoch: 3, Steps: 67 | Train Loss: 1.022 Vali Loss: 3.707 Vali Acc: 0.584 Test Loss: 3.707 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.382734298706055
Epoch: 4, Steps: 67 | Train Loss: 0.502 Vali Loss: 4.881 Vali Acc: 0.682 Test Loss: 4.881 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.402421951293945
Epoch: 5, Steps: 67 | Train Loss: 0.072 Vali Loss: 0.822 Vali Acc: 0.821 Test Loss: 0.822 Test Acc: 0.821
Validation loss decreased (-0.682056 --> -0.820801).  Saving model ...
Epoch: 6 cost time: 5.8481645584106445
Epoch: 6, Steps: 67 | Train Loss: 0.138 Vali Loss: 2.549 Vali Acc: 0.740 Test Loss: 2.549 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.030590057373047
Epoch: 7, Steps: 67 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.827 Test Loss: 1.532 Test Acc: 0.827
Validation loss decreased (-0.820801 --> -0.826574).  Saving model ...
Epoch: 8 cost time: 4.1835572719573975
Epoch: 8, Steps: 67 | Train Loss: 0.059 Vali Loss: 1.491 Vali Acc: 0.809 Test Loss: 1.491 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.347585678100586
Epoch: 9, Steps: 67 | Train Loss: 0.042 Vali Loss: 1.683 Vali Acc: 0.809 Test Loss: 1.683 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.409445762634277
Epoch: 10, Steps: 67 | Train Loss: 0.034 Vali Loss: 1.185 Vali Acc: 0.867 Test Loss: 1.185 Test Acc: 0.867
Validation loss decreased (-0.826574 --> -0.867040).  Saving model ...
Epoch: 11 cost time: 5.426623106002808
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.821 Test Loss: 1.236 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.529042482376099
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.231 Vali Acc: 0.821 Test Loss: 1.231 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.10884165763855
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.821 Test Loss: 1.228 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.884942293167114
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.232 Vali Acc: 0.821 Test Loss: 1.232 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.249232292175293
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.809 Test Loss: 1.307 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.556845188140869
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.803 Test Loss: 1.333 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.5402281284332275
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.803 Test Loss: 1.318 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.567825078964233
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.815 Test Loss: 1.128 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.100474834442139
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.821 Test Loss: 1.128 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.500025272369385
Epoch: 20, Steps: 67 | Train Loss: 0.042 Vali Loss: 4.446 Vali Acc: 0.624 Test Loss: 4.446 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1421751
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.950857639312744
Epoch: 1, Steps: 67 | Train Loss: 2.088 Vali Loss: 1.874 Vali Acc: 0.561 Test Loss: 1.874 Test Acc: 0.561
Validation loss decreased (inf --> -0.560675).  Saving model ...
Epoch: 2 cost time: 5.098679780960083
Epoch: 2, Steps: 67 | Train Loss: 1.540 Vali Loss: 2.400 Vali Acc: 0.694 Test Loss: 2.400 Test Acc: 0.694
Validation loss decreased (-0.560675 --> -0.693618).  Saving model ...
Epoch: 3 cost time: 5.986429214477539
Epoch: 3, Steps: 67 | Train Loss: 1.097 Vali Loss: 2.538 Vali Acc: 0.717 Test Loss: 2.538 Test Acc: 0.717
Validation loss decreased (-0.693618 --> -0.716738).  Saving model ...
Epoch: 4 cost time: 4.386305332183838
Epoch: 4, Steps: 67 | Train Loss: 0.569 Vali Loss: 1.552 Vali Acc: 0.769 Test Loss: 1.552 Test Acc: 0.769
Validation loss decreased (-0.716738 --> -0.768771).  Saving model ...
Epoch: 5 cost time: 5.2935802936553955
Epoch: 5, Steps: 67 | Train Loss: 0.113 Vali Loss: 1.211 Vali Acc: 0.769 Test Loss: 1.211 Test Acc: 0.769
Validation loss decreased (-0.768771 --> -0.768774).  Saving model ...
Epoch: 6 cost time: 5.823231935501099
Epoch: 6, Steps: 67 | Train Loss: 0.035 Vali Loss: 1.330 Vali Acc: 0.827 Test Loss: 1.330 Test Acc: 0.827
Validation loss decreased (-0.768774 --> -0.826576).  Saving model ...
Epoch: 7 cost time: 4.731231451034546
Epoch: 7, Steps: 67 | Train Loss: 0.067 Vali Loss: 3.159 Vali Acc: 0.728 Test Loss: 3.159 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.8152782917022705
Epoch: 8, Steps: 67 | Train Loss: 0.037 Vali Loss: 2.109 Vali Acc: 0.780 Test Loss: 2.109 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.59431529045105
Epoch: 9, Steps: 67 | Train Loss: 0.046 Vali Loss: 2.243 Vali Acc: 0.740 Test Loss: 2.243 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.716883420944214
Epoch: 10, Steps: 67 | Train Loss: 0.040 Vali Loss: 1.842 Vali Acc: 0.792 Test Loss: 1.842 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.417299509048462
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.780 Test Loss: 1.794 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.931023359298706
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.786 Test Loss: 1.628 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.2730042934417725
Epoch: 13, Steps: 67 | Train Loss: 0.016 Vali Loss: 1.904 Vali Acc: 0.798 Test Loss: 1.904 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.237638235092163
Epoch: 14, Steps: 67 | Train Loss: 0.004 Vali Loss: 1.325 Vali Acc: 0.809 Test Loss: 1.325 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.15219521522522
Epoch: 15, Steps: 67 | Train Loss: 0.008 Vali Loss: 1.489 Vali Acc: 0.763 Test Loss: 1.489 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.441474437713623
Epoch: 16, Steps: 67 | Train Loss: 0.015 Vali Loss: 1.687 Vali Acc: 0.775 Test Loss: 1.687 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 990439
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.931384086608887
Epoch: 1, Steps: 67 | Train Loss: 3.069 Vali Loss: 3.818 Vali Acc: 0.503 Test Loss: 3.818 Test Acc: 0.503
Validation loss decreased (inf --> -0.502852).  Saving model ...
Epoch: 2 cost time: 5.265589237213135
Epoch: 2, Steps: 67 | Train Loss: 2.219 Vali Loss: 1.878 Vali Acc: 0.740 Test Loss: 1.878 Test Acc: 0.740
Validation loss decreased (-0.502852 --> -0.739866).  Saving model ...
Epoch: 3 cost time: 4.989193439483643
Epoch: 3, Steps: 67 | Train Loss: 0.722 Vali Loss: 0.785 Vali Acc: 0.798 Test Loss: 0.785 Test Acc: 0.798
Validation loss decreased (-0.739866 --> -0.797680).  Saving model ...
Epoch: 4 cost time: 5.646852493286133
Epoch: 4, Steps: 67 | Train Loss: 0.285 Vali Loss: 1.396 Vali Acc: 0.803 Test Loss: 1.396 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803454).  Saving model ...
Epoch: 5 cost time: 4.543445348739624
Epoch: 5, Steps: 67 | Train Loss: 0.076 Vali Loss: 1.294 Vali Acc: 0.861 Test Loss: 1.294 Test Acc: 0.861
Validation loss decreased (-0.803454 --> -0.861259).  Saving model ...
Epoch: 6 cost time: 6.226088285446167
Epoch: 6, Steps: 67 | Train Loss: 0.140 Vali Loss: 2.219 Vali Acc: 0.751 Test Loss: 2.219 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.417333602905273
Epoch: 7, Steps: 67 | Train Loss: 0.104 Vali Loss: 1.009 Vali Acc: 0.809 Test Loss: 1.009 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.3086466789245605
Epoch: 8, Steps: 67 | Train Loss: 0.046 Vali Loss: 0.806 Vali Acc: 0.890 Test Loss: 0.806 Test Acc: 0.890
Validation loss decreased (-0.861259 --> -0.890165).  Saving model ...
Epoch: 9 cost time: 4.794127702713013
Epoch: 9, Steps: 67 | Train Loss: 0.010 Vali Loss: 0.898 Vali Acc: 0.838 Test Loss: 0.898 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.326535224914551
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0419020652770996
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 0.456 Vali Acc: 0.884 Test Loss: 0.456 Test Acc: 0.884
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9368720054626465
Epoch: 12, Steps: 67 | Train Loss: 0.003 Vali Loss: 0.855 Vali Acc: 0.815 Test Loss: 0.855 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9510865211486816
Epoch: 13, Steps: 67 | Train Loss: 0.046 Vali Loss: 1.781 Vali Acc: 0.798 Test Loss: 1.781 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.8971383571624756
Epoch: 14, Steps: 67 | Train Loss: 0.290 Vali Loss: 5.575 Vali Acc: 0.601 Test Loss: 5.575 Test Acc: 0.601
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9511058330535889
Epoch: 15, Steps: 67 | Train Loss: 0.571 Vali Loss: 2.454 Vali Acc: 0.798 Test Loss: 2.454 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8869500160217285
Epoch: 16, Steps: 67 | Train Loss: 0.129 Vali Loss: 1.802 Vali Acc: 0.803 Test Loss: 1.802 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9272680282592773
Epoch: 17, Steps: 67 | Train Loss: 0.100 Vali Loss: 3.682 Vali Acc: 0.723 Test Loss: 3.682 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9388313293457031
Epoch: 18, Steps: 67 | Train Loss: 0.155 Vali Loss: 1.918 Vali Acc: 0.780 Test Loss: 1.918 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8901734104046243
model parameter : 882695
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 78.9290466
	speed: 0.2006s/iter; left time: 2668.4197s
Epoch: 1 cost time: 26.375486135482788
Epoch: 1, Steps: 134 | Train Loss: 51.311 Vali Loss: 39.721 Vali Acc: 0.543 Test Loss: 39.721 Test Acc: 0.543
Validation loss decreased (inf --> -0.542955).  Saving model ...
	iters: 100, epoch: 2 | loss: 50.2688522
	speed: 0.4538s/iter; left time: 5975.3874s
Epoch: 2 cost time: 25.15746235847473
Epoch: 2, Steps: 134 | Train Loss: 33.026 Vali Loss: 33.526 Vali Acc: 0.618 Test Loss: 33.526 Test Acc: 0.618
Validation loss decreased (-0.542955 --> -0.618162).  Saving model ...
	iters: 100, epoch: 3 | loss: 36.0375214
	speed: 0.6168s/iter; left time: 8039.0063s
Epoch: 3 cost time: 39.932934284210205
Epoch: 3, Steps: 134 | Train Loss: 6.140 Vali Loss: 10.335 Vali Acc: 0.751 Test Loss: 10.335 Test Acc: 0.751
Validation loss decreased (-0.618162 --> -0.751342).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.6186s/iter; left time: 7979.8645s
Epoch: 4 cost time: 33.28638458251953
Epoch: 4, Steps: 134 | Train Loss: 2.263 Vali Loss: 8.239 Vali Acc: 0.757 Test Loss: 8.239 Test Acc: 0.757
Validation loss decreased (-0.751342 --> -0.757143).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.6643s/iter; left time: 8479.7938s
Epoch: 5 cost time: 40.247700214385986
Epoch: 5, Steps: 134 | Train Loss: 0.467 Vali Loss: 6.145 Vali Acc: 0.699 Test Loss: 6.145 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.6513s/iter; left time: 8227.0724s
Epoch: 6 cost time: 33.16705846786499
Epoch: 6, Steps: 134 | Train Loss: 2.108 Vali Loss: 3.772 Vali Acc: 0.780 Test Loss: 3.772 Test Acc: 0.780
Validation loss decreased (-0.757143 --> -0.780309).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.6065s/iter; left time: 7579.5206s
Epoch: 7 cost time: 40.50050616264343
Epoch: 7, Steps: 134 | Train Loss: 0.264 Vali Loss: 8.510 Vali Acc: 0.757 Test Loss: 8.510 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.6564s/iter; left time: 8114.6294s
Epoch: 8 cost time: 39.565438985824585
Epoch: 8, Steps: 134 | Train Loss: 0.447 Vali Loss: 6.362 Vali Acc: 0.757 Test Loss: 6.362 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.6637s/iter; left time: 8116.0876s
Epoch: 9 cost time: 43.37837290763855
Epoch: 9, Steps: 134 | Train Loss: 1.815 Vali Loss: 41.681 Vali Acc: 0.457 Test Loss: 41.681 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 23.1932297
	speed: 0.7051s/iter; left time: 8528.3426s
Epoch: 10 cost time: 42.79721474647522
Epoch: 10, Steps: 134 | Train Loss: 1.040 Vali Loss: 8.091 Vali Acc: 0.723 Test Loss: 8.091 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6777s/iter; left time: 8106.5424s
Epoch: 11 cost time: 39.641064405441284
Epoch: 11, Steps: 134 | Train Loss: 0.336 Vali Loss: 10.653 Vali Acc: 0.705 Test Loss: 10.653 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7407s/iter; left time: 8760.8154s
Epoch: 12 cost time: 48.13081359863281
Epoch: 12, Steps: 134 | Train Loss: 0.521 Vali Loss: 7.443 Vali Acc: 0.763 Test Loss: 7.443 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7382s/iter; left time: 8632.1786s
Epoch: 13 cost time: 49.82465481758118
Epoch: 13, Steps: 134 | Train Loss: 0.288 Vali Loss: 10.409 Vali Acc: 0.723 Test Loss: 10.409 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7136s/iter; left time: 8248.3710s
Epoch: 14 cost time: 45.32263374328613
Epoch: 14, Steps: 134 | Train Loss: 0.434 Vali Loss: 16.726 Vali Acc: 0.694 Test Loss: 16.726 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7472s/iter; left time: 8536.7858s
Epoch: 15 cost time: 40.94074296951294
Epoch: 15, Steps: 134 | Train Loss: 1.174 Vali Loss: 29.376 Vali Acc: 0.647 Test Loss: 29.376 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7464s/iter; left time: 8427.4820s
Epoch: 16 cost time: 48.426286935806274
Epoch: 16, Steps: 134 | Train Loss: 0.965 Vali Loss: 17.554 Vali Acc: 0.769 Test Loss: 17.554 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 7776519
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 27.59490394592285
Epoch: 1, Steps: 67 | Train Loss: 10.216 Vali Loss: 13.776 Vali Acc: 0.370 Test Loss: 13.776 Test Acc: 0.370
Validation loss decreased (inf --> -0.369804).  Saving model ...
Epoch: 2 cost time: 19.020191431045532
Epoch: 2, Steps: 67 | Train Loss: 15.223 Vali Loss: 12.664 Vali Acc: 0.572 Test Loss: 12.664 Test Acc: 0.572
Validation loss decreased (-0.369804 --> -0.572128).  Saving model ...
Epoch: 3 cost time: 23.759231567382812
Epoch: 3, Steps: 67 | Train Loss: 6.271 Vali Loss: 10.726 Vali Acc: 0.688 Test Loss: 10.726 Test Acc: 0.688
Validation loss decreased (-0.572128 --> -0.687754).  Saving model ...
Epoch: 4 cost time: 25.104036569595337
Epoch: 4, Steps: 67 | Train Loss: 3.863 Vali Loss: 9.326 Vali Acc: 0.751 Test Loss: 9.326 Test Acc: 0.751
Validation loss decreased (-0.687754 --> -0.751352).  Saving model ...
Epoch: 5 cost time: 14.108543634414673
Epoch: 5, Steps: 67 | Train Loss: 1.296 Vali Loss: 11.975 Vali Acc: 0.653 Test Loss: 11.975 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 27.071254014968872
Epoch: 6, Steps: 67 | Train Loss: 2.116 Vali Loss: 5.834 Vali Acc: 0.734 Test Loss: 5.834 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.82433819770813
Epoch: 7, Steps: 67 | Train Loss: 0.440 Vali Loss: 4.524 Vali Acc: 0.734 Test Loss: 4.524 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.791425704956055
Epoch: 8, Steps: 67 | Train Loss: 0.211 Vali Loss: 3.687 Vali Acc: 0.821 Test Loss: 3.687 Test Acc: 0.821
Validation loss decreased (-0.751352 --> -0.820772).  Saving model ...
Epoch: 9 cost time: 21.939544439315796
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.818 Vali Acc: 0.821 Test Loss: 3.818 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.531184434890747
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.815 Vali Acc: 0.821 Test Loss: 3.815 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.920171976089478
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.816 Vali Acc: 0.821 Test Loss: 3.816 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 23.4719340801239
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.824 Vali Acc: 0.821 Test Loss: 3.824 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 23.27522587776184
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.816 Vali Acc: 0.821 Test Loss: 3.816 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.28026270866394
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.830 Vali Acc: 0.821 Test Loss: 3.830 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.19089651107788
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.810 Vali Acc: 0.821 Test Loss: 3.810 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 20.9830265045166
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.829 Vali Acc: 0.821 Test Loss: 3.829 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 22.192370176315308
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.817 Vali Acc: 0.821 Test Loss: 3.817 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 17.161893606185913
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.810 Vali Acc: 0.815 Test Loss: 3.810 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3893767
model size : 15.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.22826385498047
Epoch: 1, Steps: 67 | Train Loss: 5.738 Vali Loss: 10.936 Vali Acc: 0.422 Test Loss: 10.936 Test Acc: 0.422
Validation loss decreased (inf --> -0.421856).  Saving model ...
Epoch: 2 cost time: 12.076703786849976
Epoch: 2, Steps: 67 | Train Loss: 10.796 Vali Loss: 16.609 Vali Acc: 0.503 Test Loss: 16.609 Test Acc: 0.503
Validation loss decreased (-0.421856 --> -0.502724).  Saving model ...
Epoch: 3 cost time: 14.84740138053894
Epoch: 3, Steps: 67 | Train Loss: 3.681 Vali Loss: 6.249 Vali Acc: 0.590 Test Loss: 6.249 Test Acc: 0.590
Validation loss decreased (-0.502724 --> -0.589533).  Saving model ...
Epoch: 4 cost time: 14.167421102523804
Epoch: 4, Steps: 67 | Train Loss: 2.120 Vali Loss: 4.015 Vali Acc: 0.740 Test Loss: 4.015 Test Acc: 0.740
Validation loss decreased (-0.589533 --> -0.739844).  Saving model ...
Epoch: 5 cost time: 15.160088300704956
Epoch: 5, Steps: 67 | Train Loss: 1.237 Vali Loss: 6.239 Vali Acc: 0.740 Test Loss: 6.239 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.959233283996582
Epoch: 6, Steps: 67 | Train Loss: 0.029 Vali Loss: 3.721 Vali Acc: 0.751 Test Loss: 3.721 Test Acc: 0.751
Validation loss decreased (-0.739844 --> -0.751408).  Saving model ...
Epoch: 7 cost time: 15.796465396881104
Epoch: 7, Steps: 67 | Train Loss: 0.011 Vali Loss: 4.687 Vali Acc: 0.734 Test Loss: 4.687 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.543301582336426
Epoch: 8, Steps: 67 | Train Loss: 0.107 Vali Loss: 5.784 Vali Acc: 0.746 Test Loss: 5.784 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.4509220123291
Epoch: 9, Steps: 67 | Train Loss: 0.028 Vali Loss: 3.870 Vali Acc: 0.740 Test Loss: 3.870 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.614893436431885
Epoch: 10, Steps: 67 | Train Loss: 0.118 Vali Loss: 3.050 Vali Acc: 0.757 Test Loss: 3.050 Test Acc: 0.757
Validation loss decreased (-0.751408 --> -0.757195).  Saving model ...
Epoch: 11 cost time: 16.962401151657104
Epoch: 11, Steps: 67 | Train Loss: 0.019 Vali Loss: 3.698 Vali Acc: 0.734 Test Loss: 3.698 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.470160484313965
Epoch: 12, Steps: 67 | Train Loss: 0.193 Vali Loss: 4.574 Vali Acc: 0.757 Test Loss: 4.574 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 12.427334308624268
Epoch: 13, Steps: 67 | Train Loss: 0.047 Vali Loss: 4.416 Vali Acc: 0.740 Test Loss: 4.416 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 15.094280242919922
Epoch: 14, Steps: 67 | Train Loss: 0.059 Vali Loss: 2.939 Vali Acc: 0.763 Test Loss: 2.939 Test Acc: 0.763
Validation loss decreased (-0.757195 --> -0.762976).  Saving model ...
Epoch: 15 cost time: 14.98700475692749
Epoch: 15, Steps: 67 | Train Loss: 0.120 Vali Loss: 7.708 Vali Acc: 0.676 Test Loss: 7.708 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 18.0986225605011
Epoch: 16, Steps: 67 | Train Loss: 0.064 Vali Loss: 5.899 Vali Acc: 0.763 Test Loss: 5.899 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 16.846545457839966
Epoch: 17, Steps: 67 | Train Loss: 0.043 Vali Loss: 4.646 Vali Acc: 0.734 Test Loss: 4.646 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 14.843592643737793
Epoch: 18, Steps: 67 | Train Loss: 0.013 Vali Loss: 2.923 Vali Acc: 0.751 Test Loss: 2.923 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 13.136127948760986
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.257 Vali Acc: 0.798 Test Loss: 2.257 Test Acc: 0.798
Validation loss decreased (-0.762976 --> -0.797665).  Saving model ...
Epoch: 20 cost time: 17.664774179458618
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.260 Vali Acc: 0.798 Test Loss: 2.260 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 12.761600255966187
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.266 Vali Acc: 0.798 Test Loss: 2.266 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.196916818618774
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.258 Vali Acc: 0.798 Test Loss: 2.258 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 13.640236139297485
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.262 Vali Acc: 0.798 Test Loss: 2.262 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 15.626394271850586
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.243 Vali Acc: 0.798 Test Loss: 2.243 Test Acc: 0.798
Validation loss decreased (-0.797665 --> -0.797665).  Saving model ...
Epoch: 25 cost time: 13.737698078155518
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.240 Vali Acc: 0.798 Test Loss: 2.240 Test Acc: 0.798
Validation loss decreased (-0.797665 --> -0.797665).  Saving model ...
Epoch: 26 cost time: 18.406626224517822
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.236 Vali Acc: 0.798 Test Loss: 2.236 Test Acc: 0.798
Validation loss decreased (-0.797665 --> -0.797665).  Saving model ...
Epoch: 27 cost time: 14.187813520431519
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.122 Vali Acc: 0.763 Test Loss: 2.122 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 12.989680051803589
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.101 Vali Acc: 0.763 Test Loss: 2.101 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 16.291036367416382
Epoch: 29, Steps: 67 | Train Loss: 1.605 Vali Loss: 5.526 Vali Acc: 0.711 Test Loss: 5.526 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 16.83453106880188
Epoch: 30, Steps: 67 | Train Loss: 0.995 Vali Loss: 4.934 Vali Acc: 0.717 Test Loss: 4.934 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 15.210026502609253
Epoch: 31, Steps: 67 | Train Loss: 0.844 Vali Loss: 4.242 Vali Acc: 0.815 Test Loss: 4.242 Test Acc: 0.815
Validation loss decreased (-0.797665 --> -0.814986).  Saving model ...
Epoch: 32 cost time: 17.29076838493347
Epoch: 32, Steps: 67 | Train Loss: 0.465 Vali Loss: 14.418 Vali Acc: 0.659 Test Loss: 14.418 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 15.957092761993408
Epoch: 33, Steps: 67 | Train Loss: 0.930 Vali Loss: 6.365 Vali Acc: 0.717 Test Loss: 6.365 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 17.364710330963135
Epoch: 34, Steps: 67 | Train Loss: 0.212 Vali Loss: 10.664 Vali Acc: 0.769 Test Loss: 10.664 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 16.631565809249878
Epoch: 35, Steps: 67 | Train Loss: 0.268 Vali Loss: 4.343 Vali Acc: 0.786 Test Loss: 4.343 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 17.438981771469116
Epoch: 36, Steps: 67 | Train Loss: 0.180 Vali Loss: 8.421 Vali Acc: 0.792 Test Loss: 8.421 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 17.385759353637695
Epoch: 37, Steps: 67 | Train Loss: 0.289 Vali Loss: 5.431 Vali Acc: 0.798 Test Loss: 5.431 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 14.768677711486816
Epoch: 38, Steps: 67 | Train Loss: 0.078 Vali Loss: 3.228 Vali Acc: 0.821 Test Loss: 3.228 Test Acc: 0.821
Validation loss decreased (-0.814986 --> -0.820777).  Saving model ...
Epoch: 39 cost time: 18.109033584594727
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.959 Vali Acc: 0.815 Test Loss: 4.959 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 13.738025188446045
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.366 Vali Acc: 0.809 Test Loss: 5.366 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 14.432227373123169
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.904 Vali Acc: 0.815 Test Loss: 4.904 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 16.35965061187744
Epoch: 42, Steps: 67 | Train Loss: 0.028 Vali Loss: 5.412 Vali Acc: 0.838 Test Loss: 5.412 Test Acc: 0.838
Validation loss decreased (-0.820777 --> -0.838096).  Saving model ...
Epoch: 43 cost time: 11.781769275665283
Epoch: 43, Steps: 67 | Train Loss: 0.134 Vali Loss: 14.809 Vali Acc: 0.780 Test Loss: 14.809 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 13.388342380523682
Epoch: 44, Steps: 67 | Train Loss: 0.049 Vali Loss: 3.735 Vali Acc: 0.792 Test Loss: 3.735 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 15.43690037727356
Epoch: 45, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.531 Vali Acc: 0.798 Test Loss: 3.531 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 17.843412160873413
Epoch: 46, Steps: 67 | Train Loss: 0.041 Vali Loss: 4.364 Vali Acc: 0.815 Test Loss: 4.364 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 16.17735004425049
Epoch: 47, Steps: 67 | Train Loss: 0.030 Vali Loss: 7.211 Vali Acc: 0.757 Test Loss: 7.211 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 16.098507165908813
Epoch: 48, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.554 Vali Acc: 0.757 Test Loss: 6.554 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 13.084035158157349
Epoch: 49, Steps: 67 | Train Loss: 1.100 Vali Loss: 10.068 Vali Acc: 0.751 Test Loss: 10.068 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 16.94257402420044
Epoch: 50, Steps: 67 | Train Loss: 0.099 Vali Loss: 6.247 Vali Acc: 0.757 Test Loss: 6.247 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 16.212513208389282
Epoch: 51, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.495 Vali Acc: 0.757 Test Loss: 6.495 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 14.654798030853271
Epoch: 52, Steps: 67 | Train Loss: 0.031 Vali Loss: 6.633 Vali Acc: 0.838 Test Loss: 6.633 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2599543
model size : 10.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.7111759185791
Epoch: 1, Steps: 67 | Train Loss: 5.026 Vali Loss: 6.752 Vali Acc: 0.451 Test Loss: 6.752 Test Acc: 0.451
Validation loss decreased (inf --> -0.450800).  Saving model ...
Epoch: 2 cost time: 12.471698999404907
Epoch: 2, Steps: 67 | Train Loss: 4.493 Vali Loss: 4.633 Vali Acc: 0.636 Test Loss: 4.633 Test Acc: 0.636
Validation loss decreased (-0.450800 --> -0.635792).  Saving model ...
Epoch: 3 cost time: 14.469387531280518
Epoch: 3, Steps: 67 | Train Loss: 1.836 Vali Loss: 4.037 Vali Acc: 0.682 Test Loss: 4.037 Test Acc: 0.682
Validation loss decreased (-0.635792 --> -0.682041).  Saving model ...
Epoch: 4 cost time: 9.510597229003906
Epoch: 4, Steps: 67 | Train Loss: 0.894 Vali Loss: 5.969 Vali Acc: 0.566 Test Loss: 5.969 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.860621929168701
Epoch: 5, Steps: 67 | Train Loss: 1.539 Vali Loss: 5.121 Vali Acc: 0.734 Test Loss: 5.121 Test Acc: 0.734
Validation loss decreased (-0.682041 --> -0.734053).  Saving model ...
Epoch: 6 cost time: 14.85797119140625
Epoch: 6, Steps: 67 | Train Loss: 0.485 Vali Loss: 4.100 Vali Acc: 0.757 Test Loss: 4.100 Test Acc: 0.757
Validation loss decreased (-0.734053 --> -0.757184).  Saving model ...
Epoch: 7 cost time: 12.354387044906616
Epoch: 7, Steps: 67 | Train Loss: 0.203 Vali Loss: 8.513 Vali Acc: 0.682 Test Loss: 8.513 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.4263596534729
Epoch: 8, Steps: 67 | Train Loss: 0.522 Vali Loss: 3.549 Vali Acc: 0.792 Test Loss: 3.549 Test Acc: 0.792
Validation loss decreased (-0.757184 --> -0.791872).  Saving model ...
Epoch: 9 cost time: 14.373533725738525
Epoch: 9, Steps: 67 | Train Loss: 0.159 Vali Loss: 4.064 Vali Acc: 0.728 Test Loss: 4.064 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.029746294021606
Epoch: 10, Steps: 67 | Train Loss: 0.052 Vali Loss: 3.981 Vali Acc: 0.827 Test Loss: 3.981 Test Acc: 0.827
Validation loss decreased (-0.791872 --> -0.826550).  Saving model ...
Epoch: 11 cost time: 15.615671873092651
Epoch: 11, Steps: 67 | Train Loss: 0.075 Vali Loss: 4.905 Vali Acc: 0.775 Test Loss: 4.905 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.757728815078735
Epoch: 12, Steps: 67 | Train Loss: 0.195 Vali Loss: 2.928 Vali Acc: 0.798 Test Loss: 2.928 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.902954578399658
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.871 Vali Acc: 0.803 Test Loss: 2.871 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.487481594085693
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.772 Vali Acc: 0.803 Test Loss: 2.772 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.95645260810852
Epoch: 15, Steps: 67 | Train Loss: 0.030 Vali Loss: 1.994 Vali Acc: 0.855 Test Loss: 1.994 Test Acc: 0.855
Validation loss decreased (-0.826550 --> -0.855471).  Saving model ...
Epoch: 16 cost time: 11.629816770553589
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.582 Vali Acc: 0.832 Test Loss: 2.582 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 12.38826322555542
Epoch: 17, Steps: 67 | Train Loss: 0.039 Vali Loss: 4.773 Vali Acc: 0.786 Test Loss: 4.773 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 11.733922243118286
Epoch: 18, Steps: 67 | Train Loss: 0.152 Vali Loss: 1.787 Vali Acc: 0.815 Test Loss: 1.787 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 13.91018271446228
Epoch: 19, Steps: 67 | Train Loss: 0.116 Vali Loss: 4.246 Vali Acc: 0.775 Test Loss: 4.246 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 12.036429643630981
Epoch: 20, Steps: 67 | Train Loss: 0.123 Vali Loss: 5.890 Vali Acc: 0.746 Test Loss: 5.890 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.016791582107544
Epoch: 21, Steps: 67 | Train Loss: 0.183 Vali Loss: 1.233 Vali Acc: 0.867 Test Loss: 1.233 Test Acc: 0.867
Validation loss decreased (-0.855471 --> -0.867040).  Saving model ...
Epoch: 22 cost time: 8.284418106079102
Epoch: 22, Steps: 67 | Train Loss: 0.027 Vali Loss: 1.615 Vali Acc: 0.867 Test Loss: 1.615 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 13.23317575454712
Epoch: 23, Steps: 67 | Train Loss: 0.004 Vali Loss: 5.084 Vali Acc: 0.821 Test Loss: 5.084 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 13.437752962112427
Epoch: 24, Steps: 67 | Train Loss: 0.285 Vali Loss: 4.491 Vali Acc: 0.757 Test Loss: 4.491 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 12.478001356124878
Epoch: 25, Steps: 67 | Train Loss: 1.731 Vali Loss: 4.187 Vali Acc: 0.763 Test Loss: 4.187 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 12.363123893737793
Epoch: 26, Steps: 67 | Train Loss: 1.400 Vali Loss: 5.974 Vali Acc: 0.803 Test Loss: 5.974 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 14.240626573562622
Epoch: 27, Steps: 67 | Train Loss: 1.023 Vali Loss: 2.489 Vali Acc: 0.884 Test Loss: 2.489 Test Acc: 0.884
Validation loss decreased (-0.867040 --> -0.884368).  Saving model ...
Epoch: 28 cost time: 11.615194082260132
Epoch: 28, Steps: 67 | Train Loss: 0.102 Vali Loss: 6.768 Vali Acc: 0.780 Test Loss: 6.768 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 15.684466123580933
Epoch: 29, Steps: 67 | Train Loss: 0.164 Vali Loss: 6.242 Vali Acc: 0.751 Test Loss: 6.242 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 12.910603761672974
Epoch: 30, Steps: 67 | Train Loss: 0.076 Vali Loss: 4.809 Vali Acc: 0.798 Test Loss: 4.809 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 14.1878182888031
Epoch: 31, Steps: 67 | Train Loss: 0.205 Vali Loss: 7.110 Vali Acc: 0.803 Test Loss: 7.110 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 13.903414487838745
Epoch: 32, Steps: 67 | Train Loss: 0.046 Vali Loss: 3.804 Vali Acc: 0.884 Test Loss: 3.804 Test Acc: 0.884
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 12.693989515304565
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.788 Vali Acc: 0.884 Test Loss: 3.788 Test Acc: 0.884
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 14.952649593353271
Epoch: 34, Steps: 67 | Train Loss: 0.071 Vali Loss: 4.311 Vali Acc: 0.815 Test Loss: 4.311 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 13.635637044906616
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.919 Vali Acc: 0.867 Test Loss: 3.919 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 14.422341108322144
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.897 Vali Acc: 0.867 Test Loss: 3.897 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 15.904128551483154
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.950 Vali Acc: 0.867 Test Loss: 3.950 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 1952471
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.090106964111328
Epoch: 1, Steps: 67 | Train Loss: 2.945 Vali Loss: 4.065 Vali Acc: 0.538 Test Loss: 4.065 Test Acc: 0.538
Validation loss decreased (inf --> -0.537532).  Saving model ...
Epoch: 2 cost time: 12.063157320022583
Epoch: 2, Steps: 67 | Train Loss: 3.266 Vali Loss: 3.227 Vali Acc: 0.642 Test Loss: 3.227 Test Acc: 0.642
Validation loss decreased (-0.537532 --> -0.641586).  Saving model ...
Epoch: 3 cost time: 9.727044582366943
Epoch: 3, Steps: 67 | Train Loss: 2.116 Vali Loss: 5.188 Vali Acc: 0.630 Test Loss: 5.188 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.329765796661377
Epoch: 4, Steps: 67 | Train Loss: 0.706 Vali Loss: 1.645 Vali Acc: 0.803 Test Loss: 1.645 Test Acc: 0.803
Validation loss decreased (-0.641586 --> -0.803452).  Saving model ...
Epoch: 5 cost time: 9.970312356948853
Epoch: 5, Steps: 67 | Train Loss: 0.616 Vali Loss: 3.934 Vali Acc: 0.728 Test Loss: 3.934 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.481362581253052
Epoch: 6, Steps: 67 | Train Loss: 0.341 Vali Loss: 5.807 Vali Acc: 0.659 Test Loss: 5.807 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.411517858505249
Epoch: 7, Steps: 67 | Train Loss: 0.294 Vali Loss: 1.866 Vali Acc: 0.850 Test Loss: 1.866 Test Acc: 0.850
Validation loss decreased (-0.803452 --> -0.849692).  Saving model ...
Epoch: 8 cost time: 6.048585891723633
Epoch: 8, Steps: 67 | Train Loss: 0.074 Vali Loss: 1.822 Vali Acc: 0.809 Test Loss: 1.822 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.595025300979614
Epoch: 9, Steps: 67 | Train Loss: 0.099 Vali Loss: 3.123 Vali Acc: 0.763 Test Loss: 3.123 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.455695629119873
Epoch: 10, Steps: 67 | Train Loss: 0.052 Vali Loss: 3.063 Vali Acc: 0.769 Test Loss: 3.063 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.724488019943237
Epoch: 11, Steps: 67 | Train Loss: 0.165 Vali Loss: 1.733 Vali Acc: 0.844 Test Loss: 1.733 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.620886087417603
Epoch: 12, Steps: 67 | Train Loss: 0.030 Vali Loss: 2.740 Vali Acc: 0.815 Test Loss: 2.740 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.657706260681152
Epoch: 13, Steps: 67 | Train Loss: 0.001 Vali Loss: 3.063 Vali Acc: 0.786 Test Loss: 3.063 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.900407314300537
Epoch: 14, Steps: 67 | Train Loss: 0.097 Vali Loss: 7.965 Vali Acc: 0.746 Test Loss: 7.965 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.688746213912964
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.037 Vali Acc: 0.798 Test Loss: 2.037 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.998526096343994
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.079 Vali Acc: 0.792 Test Loss: 2.079 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 8.223952770233154
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.045 Vali Acc: 0.786 Test Loss: 2.045 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1413303
model size : 5.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.303234338760376
Epoch: 1, Steps: 67 | Train Loss: 1.883 Vali Loss: 1.202 Vali Acc: 0.636 Test Loss: 1.202 Test Acc: 0.636
Validation loss decreased (inf --> -0.635826).  Saving model ...
Epoch: 2 cost time: 8.693289756774902
Epoch: 2, Steps: 67 | Train Loss: 1.955 Vali Loss: 1.331 Vali Acc: 0.717 Test Loss: 1.331 Test Acc: 0.717
Validation loss decreased (-0.635826 --> -0.716750).  Saving model ...
Epoch: 3 cost time: 9.739737749099731
Epoch: 3, Steps: 67 | Train Loss: 0.986 Vali Loss: 2.531 Vali Acc: 0.630 Test Loss: 2.531 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.25174069404602
Epoch: 4, Steps: 67 | Train Loss: 0.237 Vali Loss: 1.978 Vali Acc: 0.798 Test Loss: 1.978 Test Acc: 0.798
Validation loss decreased (-0.716750 --> -0.797668).  Saving model ...
Epoch: 5 cost time: 7.1382896900177
Epoch: 5, Steps: 67 | Train Loss: 0.159 Vali Loss: 2.074 Vali Acc: 0.821 Test Loss: 2.074 Test Acc: 0.821
Validation loss decreased (-0.797668 --> -0.820789).  Saving model ...
Epoch: 6 cost time: 8.196133613586426
Epoch: 6, Steps: 67 | Train Loss: 0.477 Vali Loss: 1.966 Vali Acc: 0.769 Test Loss: 1.966 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.15865159034729
Epoch: 7, Steps: 67 | Train Loss: 0.172 Vali Loss: 1.500 Vali Acc: 0.746 Test Loss: 1.500 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.638103008270264
Epoch: 8, Steps: 67 | Train Loss: 0.052 Vali Loss: 2.866 Vali Acc: 0.728 Test Loss: 2.866 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.240232706069946
Epoch: 9, Steps: 67 | Train Loss: 0.057 Vali Loss: 2.711 Vali Acc: 0.740 Test Loss: 2.711 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.28409481048584
Epoch: 10, Steps: 67 | Train Loss: 0.010 Vali Loss: 2.219 Vali Acc: 0.809 Test Loss: 2.219 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 12.87458062171936
Epoch: 11, Steps: 67 | Train Loss: 0.017 Vali Loss: 2.004 Vali Acc: 0.786 Test Loss: 2.004 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.987070322036743
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.786 Test Loss: 1.744 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.087518215179443
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.786 Test Loss: 1.693 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.20935344696045
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.786 Test Loss: 1.704 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.117791175842285
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.786 Test Loss: 1.697 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 981991
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.213370561599731
Epoch: 1, Steps: 67 | Train Loss: 2.847 Vali Loss: 2.312 Vali Acc: 0.543 Test Loss: 2.312 Test Acc: 0.543
Validation loss decreased (inf --> -0.543329).  Saving model ...
Epoch: 2 cost time: 6.769638299942017
Epoch: 2, Steps: 67 | Train Loss: 1.625 Vali Loss: 3.759 Vali Acc: 0.543 Test Loss: 3.759 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.85019588470459
Epoch: 3, Steps: 67 | Train Loss: 0.967 Vali Loss: 2.681 Vali Acc: 0.636 Test Loss: 2.681 Test Acc: 0.636
Validation loss decreased (-0.543329 --> -0.635811).  Saving model ...
Epoch: 4 cost time: 7.480008363723755
Epoch: 4, Steps: 67 | Train Loss: 0.368 Vali Loss: 1.609 Vali Acc: 0.676 Test Loss: 1.609 Test Acc: 0.676
Validation loss decreased (-0.635811 --> -0.676284).  Saving model ...
Epoch: 5 cost time: 7.058954954147339
Epoch: 5, Steps: 67 | Train Loss: 0.128 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.676284 --> -0.849704).  Saving model ...
Epoch: 6 cost time: 8.217960834503174
Epoch: 6, Steps: 67 | Train Loss: 0.036 Vali Loss: 2.099 Vali Acc: 0.809 Test Loss: 2.099 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.5406718254089355
Epoch: 7, Steps: 67 | Train Loss: 0.925 Vali Loss: 1.317 Vali Acc: 0.798 Test Loss: 1.317 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.394855260848999
Epoch: 8, Steps: 67 | Train Loss: 0.066 Vali Loss: 1.401 Vali Acc: 0.827 Test Loss: 1.401 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.738207340240479
Epoch: 9, Steps: 67 | Train Loss: 0.089 Vali Loss: 1.260 Vali Acc: 0.798 Test Loss: 1.260 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.891552209854126
Epoch: 10, Steps: 67 | Train Loss: 0.015 Vali Loss: 1.616 Vali Acc: 0.809 Test Loss: 1.616 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.96610951423645
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.832 Test Loss: 1.078 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.096312046051025
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.218 Vali Acc: 0.821 Test Loss: 1.218 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.454838037490845
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.821 Test Loss: 1.204 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.522941827774048
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.821 Test Loss: 1.204 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.710542440414429
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.821 Test Loss: 1.187 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 874247
model size : 3.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 67.1478577
	speed: 0.3222s/iter; left time: 4285.1548s
Epoch: 1 cost time: 46.85158109664917
Epoch: 1, Steps: 134 | Train Loss: 47.137 Vali Loss: 41.396 Vali Acc: 0.387 Test Loss: 41.396 Test Acc: 0.387
Validation loss decreased (inf --> -0.386869).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0339775
	speed: 0.6746s/iter; left time: 8883.0461s
Epoch: 2 cost time: 35.69691777229309
Epoch: 2, Steps: 134 | Train Loss: 33.855 Vali Loss: 98.760 Vali Acc: 0.474 Test Loss: 98.760 Test Acc: 0.474
Validation loss decreased (-0.386869 --> -0.473001).  Saving model ...
	iters: 100, epoch: 3 | loss: 53.6104126
	speed: 0.8546s/iter; left time: 11138.3848s
Epoch: 3 cost time: 54.143906593322754
Epoch: 3, Steps: 134 | Train Loss: 20.134 Vali Loss: 15.678 Vali Acc: 0.671 Test Loss: 15.678 Test Acc: 0.671
Validation loss decreased (-0.473001 --> -0.670363).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.8070s/iter; left time: 10409.6528s
Epoch: 4 cost time: 45.5686514377594
Epoch: 4, Steps: 134 | Train Loss: 1.627 Vali Loss: 11.126 Vali Acc: 0.751 Test Loss: 11.126 Test Acc: 0.751
Validation loss decreased (-0.670363 --> -0.751334).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.8134s/iter; left time: 10383.5309s
Epoch: 5 cost time: 53.58197212219238
Epoch: 5, Steps: 134 | Train Loss: 0.585 Vali Loss: 3.952 Vali Acc: 0.821 Test Loss: 3.952 Test Acc: 0.821
Validation loss decreased (-0.751334 --> -0.820770).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7248s/iter; left time: 9155.1252s
Epoch: 6 cost time: 42.75433540344238
Epoch: 6, Steps: 134 | Train Loss: 0.874 Vali Loss: 19.813 Vali Acc: 0.694 Test Loss: 19.813 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7097s/iter; left time: 8869.1062s
Epoch: 7 cost time: 38.61418628692627
Epoch: 7, Steps: 134 | Train Loss: 0.459 Vali Loss: 12.232 Vali Acc: 0.740 Test Loss: 12.232 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7171s/iter; left time: 8865.1386s
Epoch: 8 cost time: 43.399681091308594
Epoch: 8, Steps: 134 | Train Loss: 0.294 Vali Loss: 7.399 Vali Acc: 0.780 Test Loss: 7.399 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7556s/iter; left time: 9240.3491s
Epoch: 9 cost time: 39.96697235107422
Epoch: 9, Steps: 134 | Train Loss: 0.284 Vali Loss: 6.200 Vali Acc: 0.809 Test Loss: 6.200 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7034s/iter; left time: 8508.2004s
Epoch: 10 cost time: 47.18687558174133
Epoch: 10, Steps: 134 | Train Loss: 0.161 Vali Loss: 7.858 Vali Acc: 0.792 Test Loss: 7.858 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 43.5001144
	speed: 0.7368s/iter; left time: 8812.9295s
Epoch: 11 cost time: 44.74409580230713
Epoch: 11, Steps: 134 | Train Loss: 1.088 Vali Loss: 7.053 Vali Acc: 0.728 Test Loss: 7.053 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0129519
	speed: 0.6592s/iter; left time: 7796.6234s
Epoch: 12 cost time: 30.08073139190674
Epoch: 12, Steps: 134 | Train Loss: 1.705 Vali Loss: 14.206 Vali Acc: 0.682 Test Loss: 14.206 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7434s/iter; left time: 8692.5258s
Epoch: 13 cost time: 44.502328872680664
Epoch: 13, Steps: 134 | Train Loss: 0.625 Vali Loss: 15.701 Vali Acc: 0.688 Test Loss: 15.701 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7263s/iter; left time: 8395.4484s
Epoch: 14 cost time: 44.05123567581177
Epoch: 14, Steps: 134 | Train Loss: 0.682 Vali Loss: 8.016 Vali Acc: 0.746 Test Loss: 8.016 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.8024s/iter; left time: 9167.6653s
Epoch: 15 cost time: 49.32285475730896
Epoch: 15, Steps: 134 | Train Loss: 0.253 Vali Loss: 12.902 Vali Acc: 0.728 Test Loss: 12.902 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 7772295
model size : 29.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.42001438140869
Epoch: 1, Steps: 67 | Train Loss: 7.831 Vali Loss: 27.312 Vali Acc: 0.341 Test Loss: 27.312 Test Acc: 0.341
Validation loss decreased (inf --> -0.340767).  Saving model ...
Epoch: 2 cost time: 19.351410150527954
Epoch: 2, Steps: 67 | Train Loss: 16.605 Vali Loss: 31.967 Vali Acc: 0.520 Test Loss: 31.967 Test Acc: 0.520
Validation loss decreased (-0.340767 --> -0.519912).  Saving model ...
Epoch: 3 cost time: 16.379971742630005
Epoch: 3, Steps: 67 | Train Loss: 14.628 Vali Loss: 6.718 Vali Acc: 0.653 Test Loss: 6.718 Test Acc: 0.653
Validation loss decreased (-0.519912 --> -0.653112).  Saving model ...
Epoch: 4 cost time: 22.97342014312744
Epoch: 4, Steps: 67 | Train Loss: 3.794 Vali Loss: 16.230 Vali Acc: 0.618 Test Loss: 16.230 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.482007026672363
Epoch: 5, Steps: 67 | Train Loss: 1.253 Vali Loss: 10.527 Vali Acc: 0.630 Test Loss: 10.527 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.949723720550537
Epoch: 6, Steps: 67 | Train Loss: 0.698 Vali Loss: 5.460 Vali Acc: 0.792 Test Loss: 5.460 Test Acc: 0.792
Validation loss decreased (-0.653112 --> -0.791853).  Saving model ...
Epoch: 7 cost time: 19.16511821746826
Epoch: 7, Steps: 67 | Train Loss: 0.300 Vali Loss: 2.457 Vali Acc: 0.844 Test Loss: 2.457 Test Acc: 0.844
Validation loss decreased (-0.791853 --> -0.843906).  Saving model ...
Epoch: 8 cost time: 22.334540367126465
Epoch: 8, Steps: 67 | Train Loss: 0.204 Vali Loss: 2.280 Vali Acc: 0.850 Test Loss: 2.280 Test Acc: 0.850
Validation loss decreased (-0.843906 --> -0.849688).  Saving model ...
Epoch: 9 cost time: 14.304833889007568
Epoch: 9, Steps: 67 | Train Loss: 0.361 Vali Loss: 2.094 Vali Acc: 0.769 Test Loss: 2.094 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.901075839996338
Epoch: 10, Steps: 67 | Train Loss: 0.126 Vali Loss: 3.691 Vali Acc: 0.769 Test Loss: 3.691 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.850311517715454
Epoch: 11, Steps: 67 | Train Loss: 0.002 Vali Loss: 3.895 Vali Acc: 0.775 Test Loss: 3.895 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.684940099716187
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.908 Vali Acc: 0.775 Test Loss: 3.908 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.490506172180176
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.900 Vali Acc: 0.775 Test Loss: 3.900 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 17.0084331035614
Epoch: 14, Steps: 67 | Train Loss: 0.167 Vali Loss: 4.391 Vali Acc: 0.769 Test Loss: 4.391 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 20.211347579956055
Epoch: 15, Steps: 67 | Train Loss: 0.987 Vali Loss: 6.638 Vali Acc: 0.786 Test Loss: 6.638 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 18.399538278579712
Epoch: 16, Steps: 67 | Train Loss: 0.404 Vali Loss: 4.365 Vali Acc: 0.763 Test Loss: 4.365 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.569564580917358
Epoch: 17, Steps: 67 | Train Loss: 0.668 Vali Loss: 2.861 Vali Acc: 0.815 Test Loss: 2.861 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 19.631392240524292
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.792 Test Loss: 3.485 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 3889543
model size : 15.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.75703525543213
Epoch: 1, Steps: 67 | Train Loss: 5.304 Vali Loss: 11.255 Vali Acc: 0.480 Test Loss: 11.255 Test Acc: 0.480
Validation loss decreased (inf --> -0.479656).  Saving model ...
Epoch: 2 cost time: 15.793424606323242
Epoch: 2, Steps: 67 | Train Loss: 10.481 Vali Loss: 12.666 Vali Acc: 0.410 Test Loss: 12.666 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.102030515670776
Epoch: 3, Steps: 67 | Train Loss: 6.040 Vali Loss: 17.031 Vali Acc: 0.491 Test Loss: 17.031 Test Acc: 0.491
Validation loss decreased (-0.479656 --> -0.491159).  Saving model ...
Epoch: 4 cost time: 15.028908491134644
Epoch: 4, Steps: 67 | Train Loss: 7.104 Vali Loss: 6.663 Vali Acc: 0.740 Test Loss: 6.663 Test Acc: 0.740
Validation loss decreased (-0.491159 --> -0.739818).  Saving model ...
Epoch: 5 cost time: 11.670771360397339
Epoch: 5, Steps: 67 | Train Loss: 1.155 Vali Loss: 6.166 Vali Acc: 0.740 Test Loss: 6.166 Test Acc: 0.740
Validation loss decreased (-0.739818 --> -0.739823).  Saving model ...
Epoch: 6 cost time: 17.03835964202881
Epoch: 6, Steps: 67 | Train Loss: 0.227 Vali Loss: 3.630 Vali Acc: 0.775 Test Loss: 3.630 Test Acc: 0.775
Validation loss decreased (-0.739823 --> -0.774530).  Saving model ...
Epoch: 7 cost time: 15.297660827636719
Epoch: 7, Steps: 67 | Train Loss: 0.534 Vali Loss: 3.186 Vali Acc: 0.803 Test Loss: 3.186 Test Acc: 0.803
Validation loss decreased (-0.774530 --> -0.803436).  Saving model ...
Epoch: 8 cost time: 11.102227687835693
Epoch: 8, Steps: 67 | Train Loss: 0.124 Vali Loss: 3.991 Vali Acc: 0.809 Test Loss: 3.991 Test Acc: 0.809
Validation loss decreased (-0.803436 --> -0.809209).  Saving model ...
Epoch: 9 cost time: 19.306171894073486
Epoch: 9, Steps: 67 | Train Loss: 0.047 Vali Loss: 5.723 Vali Acc: 0.728 Test Loss: 5.723 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.318601608276367
Epoch: 10, Steps: 67 | Train Loss: 0.126 Vali Loss: 4.125 Vali Acc: 0.775 Test Loss: 4.125 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.03462028503418
Epoch: 11, Steps: 67 | Train Loss: 0.094 Vali Loss: 4.803 Vali Acc: 0.792 Test Loss: 4.803 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.421264410018921
Epoch: 12, Steps: 67 | Train Loss: 0.332 Vali Loss: 1.847 Vali Acc: 0.792 Test Loss: 1.847 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 17.501230716705322
Epoch: 13, Steps: 67 | Train Loss: 0.035 Vali Loss: 3.154 Vali Acc: 0.775 Test Loss: 3.154 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 15.753132104873657
Epoch: 14, Steps: 67 | Train Loss: 0.156 Vali Loss: 6.301 Vali Acc: 0.757 Test Loss: 6.301 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.05866050720215
Epoch: 15, Steps: 67 | Train Loss: 0.095 Vali Loss: 5.861 Vali Acc: 0.723 Test Loss: 5.861 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.979044198989868
Epoch: 16, Steps: 67 | Train Loss: 0.119 Vali Loss: 2.287 Vali Acc: 0.821 Test Loss: 2.287 Test Acc: 0.821
Validation loss decreased (-0.809209 --> -0.820786).  Saving model ...
Epoch: 17 cost time: 12.674944877624512
Epoch: 17, Steps: 67 | Train Loss: 0.026 Vali Loss: 4.345 Vali Acc: 0.757 Test Loss: 4.345 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.151129245758057
Epoch: 18, Steps: 67 | Train Loss: 0.066 Vali Loss: 4.490 Vali Acc: 0.769 Test Loss: 4.490 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 18.21060299873352
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.859 Vali Acc: 0.775 Test Loss: 3.859 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.290760040283203
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.375 Vali Acc: 0.786 Test Loss: 3.375 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.526909351348877
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.312 Vali Acc: 0.786 Test Loss: 3.312 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 14.41154408454895
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.313 Vali Acc: 0.786 Test Loss: 3.313 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 16.839780807495117
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.225 Vali Acc: 0.803 Test Loss: 3.225 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.854882717132568
Epoch: 24, Steps: 67 | Train Loss: 0.007 Vali Loss: 9.824 Vali Acc: 0.711 Test Loss: 9.824 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 15.187212467193604
Epoch: 25, Steps: 67 | Train Loss: 0.045 Vali Loss: 4.114 Vali Acc: 0.763 Test Loss: 4.114 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 17.89013171195984
Epoch: 26, Steps: 67 | Train Loss: 0.162 Vali Loss: 6.328 Vali Acc: 0.728 Test Loss: 6.328 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2595319
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.287102222442627
Epoch: 1, Steps: 67 | Train Loss: 4.403 Vali Loss: 5.709 Vali Acc: 0.410 Test Loss: 5.709 Test Acc: 0.410
Validation loss decreased (inf --> -0.410348).  Saving model ...
Epoch: 2 cost time: 9.798193216323853
Epoch: 2, Steps: 67 | Train Loss: 4.385 Vali Loss: 6.041 Vali Acc: 0.642 Test Loss: 6.041 Test Acc: 0.642
Validation loss decreased (-0.410348 --> -0.641558).  Saving model ...
Epoch: 3 cost time: 9.461047649383545
Epoch: 3, Steps: 67 | Train Loss: 2.215 Vali Loss: 8.985 Vali Acc: 0.630 Test Loss: 8.985 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.809149026870728
Epoch: 4, Steps: 67 | Train Loss: 1.928 Vali Loss: 4.190 Vali Acc: 0.723 Test Loss: 4.190 Test Acc: 0.723
Validation loss decreased (-0.641558 --> -0.722501).  Saving model ...
Epoch: 5 cost time: 13.223834753036499
Epoch: 5, Steps: 67 | Train Loss: 1.383 Vali Loss: 4.935 Vali Acc: 0.798 Test Loss: 4.935 Test Acc: 0.798
Validation loss decreased (-0.722501 --> -0.797639).  Saving model ...
Epoch: 6 cost time: 9.783921957015991
Epoch: 6, Steps: 67 | Train Loss: 0.295 Vali Loss: 0.897 Vali Acc: 0.873 Test Loss: 0.897 Test Acc: 0.873
Validation loss decreased (-0.797639 --> -0.872823).  Saving model ...
Epoch: 7 cost time: 13.640135288238525
Epoch: 7, Steps: 67 | Train Loss: 0.016 Vali Loss: 2.679 Vali Acc: 0.838 Test Loss: 2.679 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.315567970275879
Epoch: 8, Steps: 67 | Train Loss: 0.022 Vali Loss: 1.710 Vali Acc: 0.873 Test Loss: 1.710 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.16711974143982
Epoch: 9, Steps: 67 | Train Loss: 0.127 Vali Loss: 3.221 Vali Acc: 0.792 Test Loss: 3.221 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.80718731880188
Epoch: 10, Steps: 67 | Train Loss: 0.401 Vali Loss: 5.592 Vali Acc: 0.769 Test Loss: 5.592 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.621296167373657
Epoch: 11, Steps: 67 | Train Loss: 0.111 Vali Loss: 1.213 Vali Acc: 0.855 Test Loss: 1.213 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 15.416908025741577
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.420 Vali Acc: 0.827 Test Loss: 2.420 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.754041910171509
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.405 Vali Acc: 0.827 Test Loss: 2.405 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.203541278839111
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.412 Vali Acc: 0.827 Test Loss: 2.412 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 15.594809532165527
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.414 Vali Acc: 0.827 Test Loss: 2.414 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.936796188354492
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.402 Vali Acc: 0.827 Test Loss: 2.402 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1948247
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.493343591690063
Epoch: 1, Steps: 67 | Train Loss: 3.441 Vali Loss: 1.808 Vali Acc: 0.613 Test Loss: 1.808 Test Acc: 0.613
Validation loss decreased (inf --> -0.612699).  Saving model ...
Epoch: 2 cost time: 11.477884292602539
Epoch: 2, Steps: 67 | Train Loss: 3.525 Vali Loss: 3.946 Vali Acc: 0.520 Test Loss: 3.946 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.546152114868164
Epoch: 3, Steps: 67 | Train Loss: 1.215 Vali Loss: 4.776 Vali Acc: 0.682 Test Loss: 4.776 Test Acc: 0.682
Validation loss decreased (-0.612699 --> -0.682033).  Saving model ...
Epoch: 4 cost time: 10.951578378677368
Epoch: 4, Steps: 67 | Train Loss: 0.796 Vali Loss: 2.167 Vali Acc: 0.746 Test Loss: 2.167 Test Acc: 0.746
Validation loss decreased (-0.682033 --> -0.745643).  Saving model ...
Epoch: 5 cost time: 10.674575805664062
Epoch: 5, Steps: 67 | Train Loss: 0.143 Vali Loss: 1.913 Vali Acc: 0.763 Test Loss: 1.913 Test Acc: 0.763
Validation loss decreased (-0.745643 --> -0.762987).  Saving model ...
Epoch: 6 cost time: 14.852662086486816
Epoch: 6, Steps: 67 | Train Loss: 0.271 Vali Loss: 4.132 Vali Acc: 0.734 Test Loss: 4.132 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.007795095443726
Epoch: 7, Steps: 67 | Train Loss: 0.127 Vali Loss: 4.396 Vali Acc: 0.751 Test Loss: 4.396 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.137621641159058
Epoch: 8, Steps: 67 | Train Loss: 0.151 Vali Loss: 2.468 Vali Acc: 0.780 Test Loss: 2.468 Test Acc: 0.780
Validation loss decreased (-0.762987 --> -0.780322).  Saving model ...
Epoch: 9 cost time: 15.339738130569458
Epoch: 9, Steps: 67 | Train Loss: 0.207 Vali Loss: 2.303 Vali Acc: 0.803 Test Loss: 2.303 Test Acc: 0.803
Validation loss decreased (-0.780322 --> -0.803445).  Saving model ...
Epoch: 10 cost time: 9.718496322631836
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.096 Vali Acc: 0.803 Test Loss: 2.096 Test Acc: 0.803
Validation loss decreased (-0.803445 --> -0.803447).  Saving model ...
Epoch: 11 cost time: 13.688076972961426
Epoch: 11, Steps: 67 | Train Loss: 0.211 Vali Loss: 3.835 Vali Acc: 0.723 Test Loss: 3.835 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 12.294879674911499
Epoch: 12, Steps: 67 | Train Loss: 0.151 Vali Loss: 5.435 Vali Acc: 0.711 Test Loss: 5.435 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.764722347259521
Epoch: 13, Steps: 67 | Train Loss: 0.046 Vali Loss: 1.977 Vali Acc: 0.809 Test Loss: 1.977 Test Acc: 0.809
Validation loss decreased (-0.803447 --> -0.809229).  Saving model ...
Epoch: 14 cost time: 13.901939630508423
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.790 Vali Acc: 0.809 Test Loss: 3.790 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.884675979614258
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.969 Vali Acc: 0.798 Test Loss: 3.969 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.322622060775757
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.972 Vali Acc: 0.803 Test Loss: 3.972 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.868995189666748
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.960 Vali Acc: 0.798 Test Loss: 3.960 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 13.013020038604736
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.294 Vali Acc: 0.821 Test Loss: 3.294 Test Acc: 0.821
Validation loss decreased (-0.809229 --> -0.820776).  Saving model ...
Epoch: 19 cost time: 11.393718481063843
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.472 Vali Acc: 0.769 Test Loss: 4.472 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.53583574295044
Epoch: 20, Steps: 67 | Train Loss: 0.472 Vali Loss: 9.078 Vali Acc: 0.578 Test Loss: 9.078 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.456827163696289
Epoch: 21, Steps: 67 | Train Loss: 0.123 Vali Loss: 2.800 Vali Acc: 0.803 Test Loss: 2.800 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 14.523114442825317
Epoch: 22, Steps: 67 | Train Loss: 0.065 Vali Loss: 4.616 Vali Acc: 0.740 Test Loss: 4.616 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.845612525939941
Epoch: 23, Steps: 67 | Train Loss: 0.005 Vali Loss: 4.270 Vali Acc: 0.780 Test Loss: 4.270 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.754143238067627
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.066 Vali Acc: 0.775 Test Loss: 3.066 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 15.908942222595215
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.780 Vali Acc: 0.792 Test Loss: 3.780 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 8.840949773788452
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.351 Vali Acc: 0.769 Test Loss: 3.351 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 8.004509925842285
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.347 Vali Acc: 0.769 Test Loss: 3.347 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.688246011734009
Epoch: 28, Steps: 67 | Train Loss: 0.020 Vali Loss: 2.828 Vali Acc: 0.786 Test Loss: 2.828 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1409079
model size : 5.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.247766494750977
Epoch: 1, Steps: 67 | Train Loss: 3.136 Vali Loss: 8.061 Vali Acc: 0.532 Test Loss: 8.061 Test Acc: 0.532
Validation loss decreased (inf --> -0.531711).  Saving model ...
Epoch: 2 cost time: 10.787683963775635
Epoch: 2, Steps: 67 | Train Loss: 3.181 Vali Loss: 2.822 Vali Acc: 0.705 Test Loss: 2.822 Test Acc: 0.705
Validation loss decreased (-0.531711 --> -0.705174).  Saving model ...
Epoch: 3 cost time: 10.745038270950317
Epoch: 3, Steps: 67 | Train Loss: 0.975 Vali Loss: 3.869 Vali Acc: 0.699 Test Loss: 3.869 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.394090890884399
Epoch: 4, Steps: 67 | Train Loss: 1.058 Vali Loss: 1.717 Vali Acc: 0.740 Test Loss: 1.717 Test Acc: 0.740
Validation loss decreased (-0.705174 --> -0.739867).  Saving model ...
Epoch: 5 cost time: 8.93799114227295
Epoch: 5, Steps: 67 | Train Loss: 0.167 Vali Loss: 3.366 Vali Acc: 0.786 Test Loss: 3.366 Test Acc: 0.786
Validation loss decreased (-0.739867 --> -0.786094).  Saving model ...
Epoch: 6 cost time: 8.016215801239014
Epoch: 6, Steps: 67 | Train Loss: 0.288 Vali Loss: 2.430 Vali Acc: 0.751 Test Loss: 2.430 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.53370976448059
Epoch: 7, Steps: 67 | Train Loss: 0.130 Vali Loss: 1.349 Vali Acc: 0.757 Test Loss: 1.349 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.821099996566772
Epoch: 8, Steps: 67 | Train Loss: 0.220 Vali Loss: 3.190 Vali Acc: 0.711 Test Loss: 3.190 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 13.423341751098633
Epoch: 9, Steps: 67 | Train Loss: 0.089 Vali Loss: 2.655 Vali Acc: 0.803 Test Loss: 2.655 Test Acc: 0.803
Validation loss decreased (-0.786094 --> -0.803442).  Saving model ...
Epoch: 10 cost time: 13.442833185195923
Epoch: 10, Steps: 67 | Train Loss: 0.021 Vali Loss: 1.946 Vali Acc: 0.861 Test Loss: 1.946 Test Acc: 0.861
Validation loss decreased (-0.803442 --> -0.861252).  Saving model ...
Epoch: 11 cost time: 13.912741661071777
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.861 Test Loss: 1.939 Test Acc: 0.861
Validation loss decreased (-0.861252 --> -0.861252).  Saving model ...
Epoch: 12 cost time: 14.202428102493286
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.861 Test Loss: 1.938 Test Acc: 0.861
Validation loss decreased (-0.861252 --> -0.861252).  Saving model ...
Epoch: 13 cost time: 11.6454598903656
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.861 Test Loss: 1.954 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.17059850692749
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.861 Test Loss: 1.954 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.863487720489502
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.861 Test Loss: 1.939 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.566702604293823
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.945 Vali Acc: 0.861 Test Loss: 1.945 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.238601684570312
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.844 Test Loss: 1.562 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.927337884902954
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.850 Test Loss: 1.447 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.840777158737183
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.850 Test Loss: 1.407 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.269827127456665
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.850 Test Loss: 1.415 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.657926082611084
Epoch: 21, Steps: 67 | Train Loss: 0.356 Vali Loss: 2.691 Vali Acc: 0.717 Test Loss: 2.691 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.357271671295166
Epoch: 22, Steps: 67 | Train Loss: 2.222 Vali Loss: 3.855 Vali Acc: 0.815 Test Loss: 3.855 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 977767
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.51075792312622
Epoch: 1, Steps: 67 | Train Loss: 2.530 Vali Loss: 2.409 Vali Acc: 0.497 Test Loss: 2.409 Test Acc: 0.497
Validation loss decreased (inf --> -0.497086).  Saving model ...
Epoch: 2 cost time: 12.729398727416992
Epoch: 2, Steps: 67 | Train Loss: 1.926 Vali Loss: 1.224 Vali Acc: 0.734 Test Loss: 1.224 Test Acc: 0.734
Validation loss decreased (-0.497086 --> -0.734092).  Saving model ...
Epoch: 3 cost time: 10.891833066940308
Epoch: 3, Steps: 67 | Train Loss: 1.865 Vali Loss: 5.607 Vali Acc: 0.590 Test Loss: 5.607 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.605031490325928
Epoch: 4, Steps: 67 | Train Loss: 0.887 Vali Loss: 2.589 Vali Acc: 0.723 Test Loss: 2.589 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.758721113204956
Epoch: 5, Steps: 67 | Train Loss: 0.210 Vali Loss: 2.695 Vali Acc: 0.734 Test Loss: 2.695 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.448047876358032
Epoch: 6, Steps: 67 | Train Loss: 0.093 Vali Loss: 1.157 Vali Acc: 0.809 Test Loss: 1.157 Test Acc: 0.809
Validation loss decreased (-0.734092 --> -0.809237).  Saving model ...
Epoch: 7 cost time: 8.863276481628418
Epoch: 7, Steps: 67 | Train Loss: 0.034 Vali Loss: 2.608 Vali Acc: 0.717 Test Loss: 2.608 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.659780502319336
Epoch: 8, Steps: 67 | Train Loss: 0.056 Vali Loss: 3.707 Vali Acc: 0.705 Test Loss: 3.707 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.617862701416016
Epoch: 9, Steps: 67 | Train Loss: 0.181 Vali Loss: 2.165 Vali Acc: 0.763 Test Loss: 2.165 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.188072681427002
Epoch: 10, Steps: 67 | Train Loss: 0.080 Vali Loss: 1.447 Vali Acc: 0.821 Test Loss: 1.447 Test Acc: 0.821
Validation loss decreased (-0.809237 --> -0.820795).  Saving model ...
Epoch: 11 cost time: 11.849804878234863
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.451 Vali Acc: 0.821 Test Loss: 1.451 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.80157995223999
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.437 Vali Acc: 0.821 Test Loss: 1.437 Test Acc: 0.821
Validation loss decreased (-0.820795 --> -0.820795).  Saving model ...
Epoch: 13 cost time: 10.747417449951172
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.392 Vali Acc: 0.821 Test Loss: 1.392 Test Acc: 0.821
Validation loss decreased (-0.820795 --> -0.820795).  Saving model ...
Epoch: 14 cost time: 14.031771183013916
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.832 Test Loss: 1.379 Test Acc: 0.832
Validation loss decreased (-0.820795 --> -0.832356).  Saving model ...
Epoch: 15 cost time: 11.909437417984009
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.821 Test Loss: 1.397 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.491817712783813
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.383 Vali Acc: 0.832 Test Loss: 1.383 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.100106477737427
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.352 Vali Acc: 0.844 Test Loss: 1.352 Test Acc: 0.844
Validation loss decreased (-0.832356 --> -0.843917).  Saving model ...
Epoch: 18 cost time: 10.297666549682617
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.844 Test Loss: 1.320 Test Acc: 0.844
Validation loss decreased (-0.843917 --> -0.843917).  Saving model ...
Epoch: 19 cost time: 9.417367219924927
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.815 Test Loss: 1.419 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 14.277009963989258
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.815 Test Loss: 1.412 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.782951354980469
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.827 Test Loss: 1.384 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.26361894607544
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.307 Vali Acc: 0.838 Test Loss: 1.307 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.72146487236023
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.838 Test Loss: 1.229 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.3024582862854
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.838 Test Loss: 1.228 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.598682403564453
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.250 Vali Acc: 0.838 Test Loss: 1.250 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 12.180556297302246
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.838 Test Loss: 1.256 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 10.334353685379028
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.838 Test Loss: 1.245 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.543732166290283
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.838 Test Loss: 1.224 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 870023
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 0.0000000
	speed: 0.3576s/iter; left time: 4756.5379s
Epoch: 1 cost time: 46.47061252593994
Epoch: 1, Steps: 134 | Train Loss: 239.126 Vali Loss: 125.141 Vali Acc: 0.486 Test Loss: 125.141 Test Acc: 0.486
Validation loss decreased (inf --> -0.484298).  Saving model ...
	iters: 100, epoch: 2 | loss: 57.0064049
	speed: 0.7164s/iter; left time: 9433.0457s
Epoch: 2 cost time: 45.370317697525024
Epoch: 2, Steps: 134 | Train Loss: 32.856 Vali Loss: 15.006 Vali Acc: 0.682 Test Loss: 15.006 Test Acc: 0.682
Validation loss decreased (-0.484298 --> -0.681931).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.7587s/iter; left time: 9887.7620s
Epoch: 3 cost time: 46.44926619529724
Epoch: 3, Steps: 134 | Train Loss: 3.029 Vali Loss: 9.106 Vali Acc: 0.728 Test Loss: 9.106 Test Acc: 0.728
Validation loss decreased (-0.681931 --> -0.728233).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1159544
	speed: 0.6916s/iter; left time: 8920.3200s
Epoch: 4 cost time: 40.16561794281006
Epoch: 4, Steps: 134 | Train Loss: 0.791 Vali Loss: 20.521 Vali Acc: 0.728 Test Loss: 20.521 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7031s/iter; left time: 8975.0712s
Epoch: 5 cost time: 44.936073541641235
Epoch: 5, Steps: 134 | Train Loss: 1.013 Vali Loss: 15.749 Vali Acc: 0.728 Test Loss: 15.749 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7076s/iter; left time: 8937.5834s
Epoch: 6 cost time: 44.53152632713318
Epoch: 6, Steps: 134 | Train Loss: 1.667 Vali Loss: 99.477 Vali Acc: 0.295 Test Loss: 99.477 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7418s/iter; left time: 9270.4134s
Epoch: 7 cost time: 48.255483865737915
Epoch: 7, Steps: 134 | Train Loss: 2.101 Vali Loss: 27.235 Vali Acc: 0.717 Test Loss: 27.235 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7335s/iter; left time: 9068.1327s
Epoch: 8 cost time: 46.520148038864136
Epoch: 8, Steps: 134 | Train Loss: 2.656 Vali Loss: 106.297 Vali Acc: 0.341 Test Loss: 106.297 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7170s/iter; left time: 8768.3576s
Epoch: 9 cost time: 46.02343988418579
Epoch: 9, Steps: 134 | Train Loss: 4.032 Vali Loss: 55.638 Vali Acc: 0.636 Test Loss: 55.638 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.6905s/iter; left time: 8351.0390s
Epoch: 10 cost time: 36.96813917160034
Epoch: 10, Steps: 134 | Train Loss: 1.757 Vali Loss: 48.041 Vali Acc: 0.676 Test Loss: 48.041 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4519s/iter; left time: 5405.4186s
Epoch: 11 cost time: 29.156826734542847
Epoch: 11, Steps: 134 | Train Loss: 2.649 Vali Loss: 25.838 Vali Acc: 0.705 Test Loss: 25.838 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4486s/iter; left time: 5305.3803s
Epoch: 12 cost time: 28.95287799835205
Epoch: 12, Steps: 134 | Train Loss: 1.432 Vali Loss: 46.085 Vali Acc: 0.647 Test Loss: 46.085 Test Acc: 0.647
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4467s/iter; left time: 5223.0445s
Epoch: 13 cost time: 28.933988094329834
Epoch: 13, Steps: 134 | Train Loss: 2.704 Vali Loss: 69.695 Vali Acc: 0.740 Test Loss: 69.695 Test Acc: 0.740
Validation loss decreased (-0.728233 --> -0.739187).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4693s/iter; left time: 5424.5613s
Epoch: 14 cost time: 28.778752326965332
Epoch: 14, Steps: 134 | Train Loss: 2.261 Vali Loss: 49.843 Vali Acc: 0.763 Test Loss: 49.843 Test Acc: 0.763
Validation loss decreased (-0.739187 --> -0.762507).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4720s/iter; left time: 5392.2352s
Epoch: 15 cost time: 28.707404136657715
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 46.568 Vali Acc: 0.763 Test Loss: 46.568 Test Acc: 0.763
Validation loss decreased (-0.762507 --> -0.762540).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4727s/iter; left time: 5337.5776s
Epoch: 16 cost time: 28.752277135849
Epoch: 16, Steps: 134 | Train Loss: 1.623 Vali Loss: 170.967 Vali Acc: 0.486 Test Loss: 170.967 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.4490s/iter; left time: 5009.2853s
Epoch: 17 cost time: 28.656606912612915
Epoch: 17, Steps: 134 | Train Loss: 1.641 Vali Loss: 92.532 Vali Acc: 0.613 Test Loss: 92.532 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 7.7566299
	speed: 0.4426s/iter; left time: 4879.2488s
Epoch: 18 cost time: 28.635003328323364
Epoch: 18, Steps: 134 | Train Loss: 1.860 Vali Loss: 64.359 Vali Acc: 0.682 Test Loss: 64.359 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4444s/iter; left time: 4839.5025s
Epoch: 19 cost time: 28.719905614852905
Epoch: 19, Steps: 134 | Train Loss: 5.086 Vali Loss: 105.649 Vali Acc: 0.659 Test Loss: 105.649 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.4454s/iter; left time: 4789.8559s
Epoch: 20 cost time: 28.652293920516968
Epoch: 20, Steps: 134 | Train Loss: 2.148 Vali Loss: 65.669 Vali Acc: 0.699 Test Loss: 65.669 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.4467s/iter; left time: 4744.4843s
Epoch: 21 cost time: 28.724576234817505
Epoch: 21, Steps: 134 | Train Loss: 0.144 Vali Loss: 165.694 Vali Acc: 0.618 Test Loss: 165.694 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.4470s/iter; left time: 4687.5447s
Epoch: 22 cost time: 28.78169345855713
Epoch: 22, Steps: 134 | Train Loss: 3.483 Vali Loss: 84.453 Vali Acc: 0.607 Test Loss: 84.453 Test Acc: 0.607
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.4463s/iter; left time: 4620.4101s
Epoch: 23 cost time: 28.71080231666565
Epoch: 23, Steps: 134 | Train Loss: 3.203 Vali Loss: 147.288 Vali Acc: 0.549 Test Loss: 147.288 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.4457s/iter; left time: 4554.4685s
Epoch: 24 cost time: 28.63142156600952
Epoch: 24, Steps: 134 | Train Loss: 1.212 Vali Loss: 315.634 Vali Acc: 0.566 Test Loss: 315.634 Test Acc: 0.566
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.4437s/iter; left time: 4474.5552s
Epoch: 25 cost time: 28.629879236221313
Epoch: 25, Steps: 134 | Train Loss: 0.902 Vali Loss: 190.494 Vali Acc: 0.595 Test Loss: 190.494 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 62258311
model size : 239.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 52.35206127166748
Epoch: 1, Steps: 67 | Train Loss: 61.058 Vali Loss: 146.386 Vali Acc: 0.353 Test Loss: 146.386 Test Acc: 0.353
Validation loss decreased (inf --> -0.351137).  Saving model ...
Epoch: 2 cost time: 46.11598253250122
Epoch: 2, Steps: 67 | Train Loss: 51.530 Vali Loss: 20.350 Vali Acc: 0.659 Test Loss: 20.350 Test Acc: 0.659
Validation loss decreased (-0.351137 --> -0.658756).  Saving model ...
Epoch: 3 cost time: 47.2547709941864
Epoch: 3, Steps: 67 | Train Loss: 9.990 Vali Loss: 36.269 Vali Acc: 0.486 Test Loss: 36.269 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 44.00320267677307
Epoch: 4, Steps: 67 | Train Loss: 2.994 Vali Loss: 9.033 Vali Acc: 0.792 Test Loss: 9.033 Test Acc: 0.792
Validation loss decreased (-0.658756 --> -0.791817).  Saving model ...
Epoch: 5 cost time: 35.760191202163696
Epoch: 5, Steps: 67 | Train Loss: 0.621 Vali Loss: 10.209 Vali Acc: 0.769 Test Loss: 10.209 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 33.96465349197388
Epoch: 6, Steps: 67 | Train Loss: 0.133 Vali Loss: 17.210 Vali Acc: 0.705 Test Loss: 17.210 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 39.64668798446655
Epoch: 7, Steps: 67 | Train Loss: 0.159 Vali Loss: 7.153 Vali Acc: 0.792 Test Loss: 7.153 Test Acc: 0.792
Validation loss decreased (-0.791817 --> -0.791836).  Saving model ...
Epoch: 8 cost time: 38.35451889038086
Epoch: 8, Steps: 67 | Train Loss: 0.164 Vali Loss: 10.159 Vali Acc: 0.798 Test Loss: 10.159 Test Acc: 0.798
Validation loss decreased (-0.791836 --> -0.797586).  Saving model ...
Epoch: 9 cost time: 42.40221643447876
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.754 Vali Acc: 0.775 Test Loss: 13.754 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 36.71645975112915
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.725 Vali Acc: 0.775 Test Loss: 13.725 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 41.23467755317688
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.635 Vali Acc: 0.775 Test Loss: 13.635 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 46.524537801742554
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.674 Vali Acc: 0.775 Test Loss: 13.674 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 45.635571002960205
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 13.670 Vali Acc: 0.775 Test Loss: 13.670 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 40.37346267700195
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.092 Vali Acc: 0.769 Test Loss: 9.092 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 32.37000584602356
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.792 Vali Acc: 0.769 Test Loss: 7.792 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 36.26868987083435
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.792 Vali Acc: 0.769 Test Loss: 7.792 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 34.96363878250122
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.800 Vali Acc: 0.769 Test Loss: 7.800 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 43.19816303253174
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.806 Vali Acc: 0.769 Test Loss: 7.806 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 31196295
model size : 121.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 35.045907497406006
Epoch: 1, Steps: 67 | Train Loss: 50.224 Vali Loss: 64.281 Vali Acc: 0.422 Test Loss: 64.281 Test Acc: 0.422
Validation loss decreased (inf --> -0.421323).  Saving model ...
Epoch: 2 cost time: 30.249910831451416
Epoch: 2, Steps: 67 | Train Loss: 33.066 Vali Loss: 39.270 Vali Acc: 0.595 Test Loss: 39.270 Test Acc: 0.595
Validation loss decreased (-0.421323 --> -0.594983).  Saving model ...
Epoch: 3 cost time: 29.25489330291748
Epoch: 3, Steps: 67 | Train Loss: 7.961 Vali Loss: 18.621 Vali Acc: 0.734 Test Loss: 18.621 Test Acc: 0.734
Validation loss decreased (-0.594983 --> -0.733918).  Saving model ...
Epoch: 4 cost time: 30.328611612319946
Epoch: 4, Steps: 67 | Train Loss: 2.204 Vali Loss: 11.755 Vali Acc: 0.671 Test Loss: 11.755 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 34.34082889556885
Epoch: 5, Steps: 67 | Train Loss: 3.590 Vali Loss: 13.601 Vali Acc: 0.711 Test Loss: 13.601 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.483936071395874
Epoch: 6, Steps: 67 | Train Loss: 0.849 Vali Loss: 10.878 Vali Acc: 0.734 Test Loss: 10.878 Test Acc: 0.734
Validation loss decreased (-0.733918 --> -0.733995).  Saving model ...
Epoch: 7 cost time: 27.0892174243927
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.310 Vali Acc: 0.780 Test Loss: 8.310 Test Acc: 0.780
Validation loss decreased (-0.733995 --> -0.780264).  Saving model ...
Epoch: 8 cost time: 31.00912594795227
Epoch: 8, Steps: 67 | Train Loss: 0.346 Vali Loss: 11.680 Vali Acc: 0.746 Test Loss: 11.680 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.62831401824951
Epoch: 9, Steps: 67 | Train Loss: 0.096 Vali Loss: 6.284 Vali Acc: 0.803 Test Loss: 6.284 Test Acc: 0.803
Validation loss decreased (-0.780264 --> -0.803405).  Saving model ...
Epoch: 10 cost time: 29.806928634643555
Epoch: 10, Steps: 67 | Train Loss: 0.243 Vali Loss: 4.562 Vali Acc: 0.861 Test Loss: 4.562 Test Acc: 0.861
Validation loss decreased (-0.803405 --> -0.861226).  Saving model ...
Epoch: 11 cost time: 21.520820140838623
Epoch: 11, Steps: 67 | Train Loss: 0.095 Vali Loss: 8.153 Vali Acc: 0.809 Test Loss: 8.153 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 24.49497365951538
Epoch: 12, Steps: 67 | Train Loss: 0.247 Vali Loss: 15.466 Vali Acc: 0.671 Test Loss: 15.466 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 32.14979648590088
Epoch: 13, Steps: 67 | Train Loss: 0.264 Vali Loss: 11.103 Vali Acc: 0.786 Test Loss: 11.103 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 27.597980976104736
Epoch: 14, Steps: 67 | Train Loss: 0.457 Vali Loss: 6.683 Vali Acc: 0.838 Test Loss: 6.683 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 27.822534322738647
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.399 Vali Acc: 0.850 Test Loss: 6.399 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 31.730429649353027
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 19.701 Vali Acc: 0.763 Test Loss: 19.701 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 29.271689891815186
Epoch: 17, Steps: 67 | Train Loss: 2.160 Vali Loss: 25.944 Vali Acc: 0.590 Test Loss: 25.944 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 25.324451208114624
Epoch: 18, Steps: 67 | Train Loss: 1.535 Vali Loss: 96.007 Vali Acc: 0.434 Test Loss: 96.007 Test Acc: 0.434
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 29.526477813720703
Epoch: 19, Steps: 67 | Train Loss: 0.839 Vali Loss: 15.226 Vali Acc: 0.792 Test Loss: 15.226 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 29.956223964691162
Epoch: 20, Steps: 67 | Train Loss: 0.985 Vali Loss: 31.697 Vali Acc: 0.682 Test Loss: 31.697 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 20842503
model size : 81.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 28.08095693588257
Epoch: 1, Steps: 67 | Train Loss: 29.794 Vali Loss: 26.788 Vali Acc: 0.601 Test Loss: 26.788 Test Acc: 0.601
Validation loss decreased (inf --> -0.600888).  Saving model ...
Epoch: 2 cost time: 26.661498069763184
Epoch: 2, Steps: 67 | Train Loss: 14.102 Vali Loss: 36.637 Vali Acc: 0.555 Test Loss: 36.637 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 24.086893796920776
Epoch: 3, Steps: 67 | Train Loss: 7.627 Vali Loss: 17.111 Vali Acc: 0.676 Test Loss: 17.111 Test Acc: 0.676
Validation loss decreased (-0.600888 --> -0.676129).  Saving model ...
Epoch: 4 cost time: 19.180262804031372
Epoch: 4, Steps: 67 | Train Loss: 1.205 Vali Loss: 6.202 Vali Acc: 0.792 Test Loss: 6.202 Test Acc: 0.792
Validation loss decreased (-0.676129 --> -0.791845).  Saving model ...
Epoch: 5 cost time: 26.15466284751892
Epoch: 5, Steps: 67 | Train Loss: 0.867 Vali Loss: 9.814 Vali Acc: 0.728 Test Loss: 9.814 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.510714292526245
Epoch: 6, Steps: 67 | Train Loss: 0.357 Vali Loss: 5.269 Vali Acc: 0.815 Test Loss: 5.269 Test Acc: 0.815
Validation loss decreased (-0.791845 --> -0.814976).  Saving model ...
Epoch: 7 cost time: 30.517528295516968
Epoch: 7, Steps: 67 | Train Loss: 0.022 Vali Loss: 4.099 Vali Acc: 0.861 Test Loss: 4.099 Test Acc: 0.861
Validation loss decreased (-0.814976 --> -0.861231).  Saving model ...
Epoch: 8 cost time: 25.872103691101074
Epoch: 8, Steps: 67 | Train Loss: 0.071 Vali Loss: 9.147 Vali Acc: 0.775 Test Loss: 9.147 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.67385482788086
Epoch: 9, Steps: 67 | Train Loss: 0.017 Vali Loss: 2.590 Vali Acc: 0.861 Test Loss: 2.590 Test Acc: 0.861
Validation loss decreased (-0.861231 --> -0.861246).  Saving model ...
Epoch: 10 cost time: 21.21327304840088
Epoch: 10, Steps: 67 | Train Loss: 0.060 Vali Loss: 7.314 Vali Acc: 0.751 Test Loss: 7.314 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 27.885412216186523
Epoch: 11, Steps: 67 | Train Loss: 0.134 Vali Loss: 6.415 Vali Acc: 0.780 Test Loss: 6.415 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 26.01967716217041
Epoch: 12, Steps: 67 | Train Loss: 0.674 Vali Loss: 5.375 Vali Acc: 0.827 Test Loss: 5.375 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.296432733535767
Epoch: 13, Steps: 67 | Train Loss: 0.756 Vali Loss: 13.162 Vali Acc: 0.711 Test Loss: 13.162 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 24.959065675735474
Epoch: 14, Steps: 67 | Train Loss: 0.047 Vali Loss: 8.468 Vali Acc: 0.705 Test Loss: 8.468 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 27.186371088027954
Epoch: 15, Steps: 67 | Train Loss: 0.093 Vali Loss: 6.762 Vali Acc: 0.803 Test Loss: 6.762 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 30.619672536849976
Epoch: 16, Steps: 67 | Train Loss: 0.891 Vali Loss: 18.690 Vali Acc: 0.653 Test Loss: 18.690 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 26.53865909576416
Epoch: 17, Steps: 67 | Train Loss: 1.149 Vali Loss: 40.584 Vali Acc: 0.410 Test Loss: 40.584 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 21.15711998939514
Epoch: 18, Steps: 67 | Train Loss: 0.714 Vali Loss: 9.705 Vali Acc: 0.792 Test Loss: 9.705 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 27.60063123703003
Epoch: 19, Steps: 67 | Train Loss: 1.394 Vali Loss: 10.240 Vali Acc: 0.775 Test Loss: 10.240 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 15665927
model size : 62.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 24.84371542930603
Epoch: 1, Steps: 67 | Train Loss: 17.408 Vali Loss: 39.201 Vali Acc: 0.410 Test Loss: 39.201 Test Acc: 0.410
Validation loss decreased (inf --> -0.410013).  Saving model ...
Epoch: 2 cost time: 17.562405347824097
Epoch: 2, Steps: 67 | Train Loss: 22.377 Vali Loss: 11.373 Vali Acc: 0.682 Test Loss: 11.373 Test Acc: 0.682
Validation loss decreased (-0.410013 --> -0.681967).  Saving model ...
Epoch: 3 cost time: 21.300859212875366
Epoch: 3, Steps: 67 | Train Loss: 3.344 Vali Loss: 8.589 Vali Acc: 0.763 Test Loss: 8.589 Test Acc: 0.763
Validation loss decreased (-0.681967 --> -0.762920).  Saving model ...
Epoch: 4 cost time: 17.023807764053345
Epoch: 4, Steps: 67 | Train Loss: 0.721 Vali Loss: 5.081 Vali Acc: 0.769 Test Loss: 5.081 Test Acc: 0.769
Validation loss decreased (-0.762920 --> -0.768735).  Saving model ...
Epoch: 5 cost time: 18.989939212799072
Epoch: 5, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.837 Vali Acc: 0.798 Test Loss: 2.837 Test Acc: 0.798
Validation loss decreased (-0.768735 --> -0.797659).  Saving model ...
Epoch: 6 cost time: 10.556699991226196
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.810 Vali Acc: 0.803 Test Loss: 2.810 Test Acc: 0.803
Validation loss decreased (-0.797659 --> -0.803440).  Saving model ...
Epoch: 7 cost time: 18.23234248161316
Epoch: 7, Steps: 67 | Train Loss: 0.157 Vali Loss: 8.998 Vali Acc: 0.723 Test Loss: 8.998 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 18.187512159347534
Epoch: 8, Steps: 67 | Train Loss: 1.872 Vali Loss: 5.420 Vali Acc: 0.757 Test Loss: 5.420 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.735252141952515
Epoch: 9, Steps: 67 | Train Loss: 0.921 Vali Loss: 17.894 Vali Acc: 0.647 Test Loss: 17.894 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.86646294593811
Epoch: 10, Steps: 67 | Train Loss: 0.416 Vali Loss: 12.929 Vali Acc: 0.711 Test Loss: 12.929 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 14.421200513839722
Epoch: 11, Steps: 67 | Train Loss: 0.527 Vali Loss: 7.300 Vali Acc: 0.699 Test Loss: 7.300 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 19.51341938972473
Epoch: 12, Steps: 67 | Train Loss: 0.811 Vali Loss: 9.041 Vali Acc: 0.699 Test Loss: 9.041 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.346789836883545
Epoch: 13, Steps: 67 | Train Loss: 0.908 Vali Loss: 7.235 Vali Acc: 0.792 Test Loss: 7.235 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 19.863263607025146
Epoch: 14, Steps: 67 | Train Loss: 0.667 Vali Loss: 6.376 Vali Acc: 0.827 Test Loss: 6.376 Test Acc: 0.827
Validation loss decreased (-0.803440 --> -0.826526).  Saving model ...
Epoch: 15 cost time: 16.45348310470581
Epoch: 15, Steps: 67 | Train Loss: 0.132 Vali Loss: 11.220 Vali Acc: 0.798 Test Loss: 11.220 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.37564730644226
Epoch: 16, Steps: 67 | Train Loss: 0.062 Vali Loss: 12.453 Vali Acc: 0.775 Test Loss: 12.453 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.237895488739014
Epoch: 17, Steps: 67 | Train Loss: 0.089 Vali Loss: 15.663 Vali Acc: 0.751 Test Loss: 15.663 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 17.217129707336426
Epoch: 18, Steps: 67 | Train Loss: 0.382 Vali Loss: 13.903 Vali Acc: 0.798 Test Loss: 13.903 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 18.076560974121094
Epoch: 19, Steps: 67 | Train Loss: 0.091 Vali Loss: 12.563 Vali Acc: 0.780 Test Loss: 12.563 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.532246351242065
Epoch: 20, Steps: 67 | Train Loss: 0.424 Vali Loss: 12.857 Vali Acc: 0.682 Test Loss: 12.857 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 18.3547043800354
Epoch: 21, Steps: 67 | Train Loss: 0.229 Vali Loss: 13.515 Vali Acc: 0.763 Test Loss: 13.515 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 21.2618145942688
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.542 Vali Acc: 0.780 Test Loss: 7.542 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 15.193974018096924
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.618 Vali Acc: 0.780 Test Loss: 7.618 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 17.012078285217285
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.612 Vali Acc: 0.780 Test Loss: 7.612 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 11352583
model size : 45.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 19.89731001853943
Epoch: 1, Steps: 67 | Train Loss: 12.615 Vali Loss: 25.880 Vali Acc: 0.474 Test Loss: 25.880 Test Acc: 0.474
Validation loss decreased (inf --> -0.473730).  Saving model ...
Epoch: 2 cost time: 16.96769881248474
Epoch: 2, Steps: 67 | Train Loss: 8.990 Vali Loss: 3.798 Vali Acc: 0.798 Test Loss: 3.798 Test Acc: 0.798
Validation loss decreased (-0.473730 --> -0.797650).  Saving model ...
Epoch: 3 cost time: 18.0982666015625
Epoch: 3, Steps: 67 | Train Loss: 1.850 Vali Loss: 9.516 Vali Acc: 0.705 Test Loss: 9.516 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.304059505462646
Epoch: 4, Steps: 67 | Train Loss: 0.984 Vali Loss: 12.192 Vali Acc: 0.676 Test Loss: 12.192 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.88921022415161
Epoch: 5, Steps: 67 | Train Loss: 0.568 Vali Loss: 2.509 Vali Acc: 0.879 Test Loss: 2.509 Test Acc: 0.879
Validation loss decreased (-0.797650 --> -0.878588).  Saving model ...
Epoch: 6 cost time: 14.151378154754639
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.990 Vali Acc: 0.821 Test Loss: 2.990 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 15.296770811080933
Epoch: 7, Steps: 67 | Train Loss: 0.108 Vali Loss: 2.990 Vali Acc: 0.832 Test Loss: 2.990 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 16.358707904815674
Epoch: 8, Steps: 67 | Train Loss: 0.029 Vali Loss: 2.263 Vali Acc: 0.838 Test Loss: 2.263 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 16.25668740272522
Epoch: 9, Steps: 67 | Train Loss: 0.221 Vali Loss: 2.808 Vali Acc: 0.827 Test Loss: 2.808 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.896223306655884
Epoch: 10, Steps: 67 | Train Loss: 1.230 Vali Loss: 11.354 Vali Acc: 0.671 Test Loss: 11.354 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 17.01359510421753
Epoch: 11, Steps: 67 | Train Loss: 1.338 Vali Loss: 3.867 Vali Acc: 0.809 Test Loss: 3.867 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 16.099166870117188
Epoch: 12, Steps: 67 | Train Loss: 0.379 Vali Loss: 4.249 Vali Acc: 0.757 Test Loss: 4.249 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 14.913371086120605
Epoch: 13, Steps: 67 | Train Loss: 0.465 Vali Loss: 13.754 Vali Acc: 0.751 Test Loss: 13.754 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 17.565513849258423
Epoch: 14, Steps: 67 | Train Loss: 0.265 Vali Loss: 17.664 Vali Acc: 0.636 Test Loss: 17.664 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 14.888957023620605
Epoch: 15, Steps: 67 | Train Loss: 0.644 Vali Loss: 10.859 Vali Acc: 0.780 Test Loss: 10.859 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 7902087
model size : 32.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.511951684951782
Epoch: 1, Steps: 67 | Train Loss: 12.572 Vali Loss: 16.580 Vali Acc: 0.451 Test Loss: 16.580 Test Acc: 0.451
Validation loss decreased (inf --> -0.450701).  Saving model ...
Epoch: 2 cost time: 16.250012159347534
Epoch: 2, Steps: 67 | Train Loss: 5.474 Vali Loss: 12.842 Vali Acc: 0.590 Test Loss: 12.842 Test Acc: 0.590
Validation loss decreased (-0.450701 --> -0.589467).  Saving model ...
Epoch: 3 cost time: 11.590022087097168
Epoch: 3, Steps: 67 | Train Loss: 1.857 Vali Loss: 7.068 Vali Acc: 0.566 Test Loss: 7.068 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.406174182891846
Epoch: 4, Steps: 67 | Train Loss: 1.095 Vali Loss: 3.874 Vali Acc: 0.821 Test Loss: 3.874 Test Acc: 0.821
Validation loss decreased (-0.589467 --> -0.820771).  Saving model ...
Epoch: 5 cost time: 12.310850620269775
Epoch: 5, Steps: 67 | Train Loss: 0.643 Vali Loss: 2.975 Vali Acc: 0.769 Test Loss: 2.975 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.742741823196411
Epoch: 6, Steps: 67 | Train Loss: 0.688 Vali Loss: 3.433 Vali Acc: 0.798 Test Loss: 3.433 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.295839309692383
Epoch: 7, Steps: 67 | Train Loss: 0.449 Vali Loss: 3.176 Vali Acc: 0.809 Test Loss: 3.176 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.916608095169067
Epoch: 8, Steps: 67 | Train Loss: 0.136 Vali Loss: 6.074 Vali Acc: 0.780 Test Loss: 6.074 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.048450469970703
Epoch: 9, Steps: 67 | Train Loss: 0.077 Vali Loss: 7.820 Vali Acc: 0.780 Test Loss: 7.820 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.908044338226318
Epoch: 10, Steps: 67 | Train Loss: 0.063 Vali Loss: 10.571 Vali Acc: 0.705 Test Loss: 10.571 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 14.223308801651001
Epoch: 11, Steps: 67 | Train Loss: 0.825 Vali Loss: 5.273 Vali Acc: 0.757 Test Loss: 5.273 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 15.488569259643555
Epoch: 12, Steps: 67 | Train Loss: 0.450 Vali Loss: 3.743 Vali Acc: 0.780 Test Loss: 3.743 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.614547491073608
Epoch: 13, Steps: 67 | Train Loss: 0.072 Vali Loss: 11.107 Vali Acc: 0.746 Test Loss: 11.107 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 16.76555061340332
Epoch: 14, Steps: 67 | Train Loss: 0.389 Vali Loss: 9.389 Vali Acc: 0.728 Test Loss: 9.389 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 7040135
model size : 29.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 323.9810486
	speed: 0.2139s/iter; left time: 2844.6855s
Epoch: 1 cost time: 28.256905555725098
Epoch: 1, Steps: 134 | Train Loss: 237.568 Vali Loss: 202.373 Vali Acc: 0.520 Test Loss: 202.373 Test Acc: 0.520
Validation loss decreased (inf --> -0.518207).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.4418s/iter; left time: 5817.4187s
Epoch: 2 cost time: 27.30590581893921
Epoch: 2, Steps: 134 | Train Loss: 58.258 Vali Loss: 13.965 Vali Acc: 0.694 Test Loss: 13.965 Test Acc: 0.694
Validation loss decreased (-0.518207 --> -0.693502).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.4611s/iter; left time: 6009.4304s
Epoch: 3 cost time: 27.347800970077515
Epoch: 3, Steps: 134 | Train Loss: 1.893 Vali Loss: 20.437 Vali Acc: 0.659 Test Loss: 20.437 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4368s/iter; left time: 5634.4655s
Epoch: 4 cost time: 27.3228702545166
Epoch: 4, Steps: 134 | Train Loss: 0.541 Vali Loss: 6.442 Vali Acc: 0.855 Test Loss: 6.442 Test Acc: 0.855
Validation loss decreased (-0.693502 --> -0.855427).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0375534
	speed: 0.4583s/iter; left time: 5849.5867s
Epoch: 5 cost time: 27.33949875831604
Epoch: 5, Steps: 134 | Train Loss: 1.961 Vali Loss: 13.275 Vali Acc: 0.763 Test Loss: 13.275 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4353s/iter; left time: 5498.3079s
Epoch: 6 cost time: 27.348400115966797
Epoch: 6, Steps: 134 | Train Loss: 0.969 Vali Loss: 10.148 Vali Acc: 0.763 Test Loss: 10.148 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4342s/iter; left time: 5426.0424s
Epoch: 7 cost time: 27.31245994567871
Epoch: 7, Steps: 134 | Train Loss: 0.171 Vali Loss: 24.421 Vali Acc: 0.763 Test Loss: 24.421 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.4360s/iter; left time: 5390.1564s
Epoch: 8 cost time: 27.391577005386353
Epoch: 8, Steps: 134 | Train Loss: 3.130 Vali Loss: 70.793 Vali Acc: 0.578 Test Loss: 70.793 Test Acc: 0.578
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4384s/iter; left time: 5360.7297s
Epoch: 9 cost time: 27.42439317703247
Epoch: 9, Steps: 134 | Train Loss: 7.802 Vali Loss: 52.659 Vali Acc: 0.688 Test Loss: 52.659 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4373s/iter; left time: 5289.5062s
Epoch: 10 cost time: 27.398513078689575
Epoch: 10, Steps: 134 | Train Loss: 2.520 Vali Loss: 56.545 Vali Acc: 0.705 Test Loss: 56.545 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 10.2303314
	speed: 0.4345s/iter; left time: 5197.3676s
Epoch: 11 cost time: 27.328558444976807
Epoch: 11, Steps: 134 | Train Loss: 3.937 Vali Loss: 33.483 Vali Acc: 0.699 Test Loss: 33.483 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4351s/iter; left time: 5145.7458s
Epoch: 12 cost time: 27.317180156707764
Epoch: 12, Steps: 134 | Train Loss: 2.595 Vali Loss: 45.875 Vali Acc: 0.699 Test Loss: 45.875 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4349s/iter; left time: 5085.7032s
Epoch: 13 cost time: 27.35399603843689
Epoch: 13, Steps: 134 | Train Loss: 2.963 Vali Loss: 48.998 Vali Acc: 0.757 Test Loss: 48.998 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4356s/iter; left time: 5035.0891s
Epoch: 14 cost time: 27.339569330215454
Epoch: 14, Steps: 134 | Train Loss: 0.000 Vali Loss: 57.750 Vali Acc: 0.711 Test Loss: 57.750 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 62225415
model size : 239.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 51.87440848350525
Epoch: 1, Steps: 67 | Train Loss: 64.206 Vali Loss: 76.710 Vali Acc: 0.526 Test Loss: 76.710 Test Acc: 0.526
Validation loss decreased (inf --> -0.525244).  Saving model ...
Epoch: 2 cost time: 42.06912541389465
Epoch: 2, Steps: 67 | Train Loss: 55.121 Vali Loss: 39.575 Vali Acc: 0.694 Test Loss: 39.575 Test Acc: 0.694
Validation loss decreased (-0.525244 --> -0.693246).  Saving model ...
Epoch: 3 cost time: 40.50514006614685
Epoch: 3, Steps: 67 | Train Loss: 15.840 Vali Loss: 37.434 Vali Acc: 0.607 Test Loss: 37.434 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 41.88256025314331
Epoch: 4, Steps: 67 | Train Loss: 4.690 Vali Loss: 25.136 Vali Acc: 0.717 Test Loss: 25.136 Test Acc: 0.717
Validation loss decreased (-0.693246 --> -0.716512).  Saving model ...
Epoch: 5 cost time: 43.870299100875854
Epoch: 5, Steps: 67 | Train Loss: 1.027 Vali Loss: 19.220 Vali Acc: 0.723 Test Loss: 19.220 Test Acc: 0.723
Validation loss decreased (-0.716512 --> -0.722351).  Saving model ...
Epoch: 6 cost time: 49.405184507369995
Epoch: 6, Steps: 67 | Train Loss: 0.502 Vali Loss: 10.116 Vali Acc: 0.798 Test Loss: 10.116 Test Acc: 0.798
Validation loss decreased (-0.722351 --> -0.797587).  Saving model ...
Epoch: 7 cost time: 44.02579355239868
Epoch: 7, Steps: 67 | Train Loss: 0.103 Vali Loss: 26.300 Vali Acc: 0.723 Test Loss: 26.300 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 51.724464416503906
Epoch: 8, Steps: 67 | Train Loss: 1.060 Vali Loss: 11.737 Vali Acc: 0.792 Test Loss: 11.737 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 48.23238658905029
Epoch: 9, Steps: 67 | Train Loss: 0.228 Vali Loss: 16.423 Vali Acc: 0.763 Test Loss: 16.423 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 39.58765435218811
Epoch: 10, Steps: 67 | Train Loss: 1.666 Vali Loss: 26.247 Vali Acc: 0.717 Test Loss: 26.247 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 42.38087177276611
Epoch: 11, Steps: 67 | Train Loss: 1.214 Vali Loss: 10.672 Vali Acc: 0.769 Test Loss: 10.672 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 29.939897298812866
Epoch: 12, Steps: 67 | Train Loss: 0.224 Vali Loss: 11.243 Vali Acc: 0.769 Test Loss: 11.243 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 37.01147508621216
Epoch: 13, Steps: 67 | Train Loss: 1.583 Vali Loss: 17.975 Vali Acc: 0.746 Test Loss: 17.975 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 50.16384482383728
Epoch: 14, Steps: 67 | Train Loss: 0.404 Vali Loss: 16.552 Vali Acc: 0.757 Test Loss: 16.552 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 44.66105556488037
Epoch: 15, Steps: 67 | Train Loss: 1.411 Vali Loss: 17.737 Vali Acc: 0.757 Test Loss: 17.737 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 38.070613384246826
Epoch: 16, Steps: 67 | Train Loss: 0.813 Vali Loss: 44.555 Vali Acc: 0.630 Test Loss: 44.555 Test Acc: 0.630
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 31163399
model size : 121.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 21.884713172912598
Epoch: 1, Steps: 67 | Train Loss: 54.077 Vali Loss: 33.610 Vali Acc: 0.532 Test Loss: 33.610 Test Acc: 0.532
Validation loss decreased (inf --> -0.531456).  Saving model ...
Epoch: 2 cost time: 16.39053177833557
Epoch: 2, Steps: 67 | Train Loss: 32.460 Vali Loss: 90.702 Vali Acc: 0.514 Test Loss: 90.702 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.049546241760254
Epoch: 3, Steps: 67 | Train Loss: 14.395 Vali Loss: 23.438 Vali Acc: 0.665 Test Loss: 23.438 Test Acc: 0.665
Validation loss decreased (-0.531456 --> -0.664506).  Saving model ...
Epoch: 4 cost time: 26.967848300933838
Epoch: 4, Steps: 67 | Train Loss: 1.949 Vali Loss: 16.441 Vali Acc: 0.734 Test Loss: 16.441 Test Acc: 0.734
Validation loss decreased (-0.664506 --> -0.733940).  Saving model ...
Epoch: 5 cost time: 27.277281761169434
Epoch: 5, Steps: 67 | Train Loss: 0.889 Vali Loss: 13.658 Vali Acc: 0.757 Test Loss: 13.658 Test Acc: 0.757
Validation loss decreased (-0.733940 --> -0.757089).  Saving model ...
Epoch: 6 cost time: 26.37644624710083
Epoch: 6, Steps: 67 | Train Loss: 1.548 Vali Loss: 25.802 Vali Acc: 0.647 Test Loss: 25.802 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.028542518615723
Epoch: 7, Steps: 67 | Train Loss: 1.801 Vali Loss: 11.137 Vali Acc: 0.809 Test Loss: 11.137 Test Acc: 0.809
Validation loss decreased (-0.757089 --> -0.809137).  Saving model ...
Epoch: 8 cost time: 24.36101460456848
Epoch: 8, Steps: 67 | Train Loss: 1.390 Vali Loss: 10.102 Vali Acc: 0.751 Test Loss: 10.102 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 30.504265546798706
Epoch: 9, Steps: 67 | Train Loss: 0.053 Vali Loss: 10.781 Vali Acc: 0.757 Test Loss: 10.781 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.754920721054077
Epoch: 10, Steps: 67 | Train Loss: 0.230 Vali Loss: 10.680 Vali Acc: 0.757 Test Loss: 10.680 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 22.91406488418579
Epoch: 11, Steps: 67 | Train Loss: 0.046 Vali Loss: 11.556 Vali Acc: 0.798 Test Loss: 11.556 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 26.714807271957397
Epoch: 12, Steps: 67 | Train Loss: 0.476 Vali Loss: 18.036 Vali Acc: 0.769 Test Loss: 18.036 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.219467163085938
Epoch: 13, Steps: 67 | Train Loss: 0.076 Vali Loss: 16.057 Vali Acc: 0.723 Test Loss: 16.057 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 19.90660285949707
Epoch: 14, Steps: 67 | Train Loss: 0.800 Vali Loss: 12.088 Vali Acc: 0.699 Test Loss: 12.088 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 29.102206468582153
Epoch: 15, Steps: 67 | Train Loss: 0.341 Vali Loss: 5.794 Vali Acc: 0.827 Test Loss: 5.794 Test Acc: 0.827
Validation loss decreased (-0.809137 --> -0.826532).  Saving model ...
Epoch: 16 cost time: 23.61200761795044
Epoch: 16, Steps: 67 | Train Loss: 0.011 Vali Loss: 8.757 Vali Acc: 0.786 Test Loss: 8.757 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.935453414916992
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.329 Vali Acc: 0.798 Test Loss: 9.329 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.568500518798828
Epoch: 18, Steps: 67 | Train Loss: 0.171 Vali Loss: 16.026 Vali Acc: 0.717 Test Loss: 16.026 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.796254634857178
Epoch: 19, Steps: 67 | Train Loss: 0.565 Vali Loss: 16.597 Vali Acc: 0.746 Test Loss: 16.597 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 28.269451141357422
Epoch: 20, Steps: 67 | Train Loss: 0.217 Vali Loss: 43.196 Vali Acc: 0.561 Test Loss: 43.196 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 26.757063388824463
Epoch: 21, Steps: 67 | Train Loss: 3.141 Vali Loss: 22.849 Vali Acc: 0.630 Test Loss: 22.849 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 22.336134910583496
Epoch: 22, Steps: 67 | Train Loss: 0.438 Vali Loss: 14.824 Vali Acc: 0.780 Test Loss: 14.824 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 25.00420594215393
Epoch: 23, Steps: 67 | Train Loss: 1.217 Vali Loss: 33.974 Vali Acc: 0.699 Test Loss: 33.974 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 28.746803522109985
Epoch: 24, Steps: 67 | Train Loss: 1.531 Vali Loss: 16.756 Vali Acc: 0.821 Test Loss: 16.756 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 25.094562530517578
Epoch: 25, Steps: 67 | Train Loss: 0.478 Vali Loss: 20.377 Vali Acc: 0.734 Test Loss: 20.377 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 20809607
model size : 81.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 30.127782821655273
Epoch: 1, Steps: 67 | Train Loss: 23.760 Vali Loss: 15.418 Vali Acc: 0.636 Test Loss: 15.418 Test Acc: 0.636
Validation loss decreased (inf --> -0.635684).  Saving model ...
Epoch: 2 cost time: 24.01326560974121
Epoch: 2, Steps: 67 | Train Loss: 23.181 Vali Loss: 33.088 Vali Acc: 0.618 Test Loss: 33.088 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.38163185119629
Epoch: 3, Steps: 67 | Train Loss: 10.018 Vali Loss: 15.777 Vali Acc: 0.699 Test Loss: 15.777 Test Acc: 0.699
Validation loss decreased (-0.635684 --> -0.699264).  Saving model ...
Epoch: 4 cost time: 27.42908763885498
Epoch: 4, Steps: 67 | Train Loss: 1.190 Vali Loss: 11.064 Vali Acc: 0.757 Test Loss: 11.064 Test Acc: 0.757
Validation loss decreased (-0.699264 --> -0.757115).  Saving model ...
Epoch: 5 cost time: 22.64810037612915
Epoch: 5, Steps: 67 | Train Loss: 0.275 Vali Loss: 6.469 Vali Acc: 0.809 Test Loss: 6.469 Test Acc: 0.809
Validation loss decreased (-0.757115 --> -0.809184).  Saving model ...
Epoch: 6 cost time: 22.59546399116516
Epoch: 6, Steps: 67 | Train Loss: 0.039 Vali Loss: 5.028 Vali Acc: 0.832 Test Loss: 5.028 Test Acc: 0.832
Validation loss decreased (-0.809184 --> -0.832320).  Saving model ...
Epoch: 7 cost time: 18.528960466384888
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.747 Vali Acc: 0.861 Test Loss: 4.747 Test Acc: 0.861
Validation loss decreased (-0.832320 --> -0.861224).  Saving model ...
Epoch: 8 cost time: 18.736170053482056
Epoch: 8, Steps: 67 | Train Loss: 0.219 Vali Loss: 24.533 Vali Acc: 0.682 Test Loss: 24.533 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 26.379662036895752
Epoch: 9, Steps: 67 | Train Loss: 1.701 Vali Loss: 9.006 Vali Acc: 0.699 Test Loss: 9.006 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.853725910186768
Epoch: 10, Steps: 67 | Train Loss: 0.291 Vali Loss: 11.247 Vali Acc: 0.740 Test Loss: 11.247 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.953878164291382
Epoch: 11, Steps: 67 | Train Loss: 1.049 Vali Loss: 12.642 Vali Acc: 0.688 Test Loss: 12.642 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.017882823944092
Epoch: 12, Steps: 67 | Train Loss: 0.572 Vali Loss: 8.868 Vali Acc: 0.792 Test Loss: 8.868 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 22.166293382644653
Epoch: 13, Steps: 67 | Train Loss: 1.669 Vali Loss: 7.151 Vali Acc: 0.792 Test Loss: 7.151 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 19.374186992645264
Epoch: 14, Steps: 67 | Train Loss: 0.119 Vali Loss: 10.156 Vali Acc: 0.803 Test Loss: 10.156 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 19.82071018218994
Epoch: 15, Steps: 67 | Train Loss: 0.340 Vali Loss: 4.729 Vali Acc: 0.832 Test Loss: 4.729 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 19.526264429092407
Epoch: 16, Steps: 67 | Train Loss: 0.159 Vali Loss: 7.550 Vali Acc: 0.780 Test Loss: 7.550 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 25.151390552520752
Epoch: 17, Steps: 67 | Train Loss: 0.138 Vali Loss: 19.893 Vali Acc: 0.699 Test Loss: 19.893 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 15633031
model size : 62.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.00914478302002
Epoch: 1, Steps: 67 | Train Loss: 22.234 Vali Loss: 49.791 Vali Acc: 0.434 Test Loss: 49.791 Test Acc: 0.434
Validation loss decreased (inf --> -0.433028).  Saving model ...
Epoch: 2 cost time: 12.461132526397705
Epoch: 2, Steps: 67 | Train Loss: 13.482 Vali Loss: 13.402 Vali Acc: 0.705 Test Loss: 13.402 Test Acc: 0.705
Validation loss decreased (-0.433028 --> -0.705068).  Saving model ...
Epoch: 3 cost time: 15.827794790267944
Epoch: 3, Steps: 67 | Train Loss: 4.948 Vali Loss: 12.323 Vali Acc: 0.671 Test Loss: 12.323 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.949820041656494
Epoch: 4, Steps: 67 | Train Loss: 2.272 Vali Loss: 5.847 Vali Acc: 0.769 Test Loss: 5.847 Test Acc: 0.769
Validation loss decreased (-0.705068 --> -0.768728).  Saving model ...
Epoch: 5 cost time: 15.890006303787231
Epoch: 5, Steps: 67 | Train Loss: 0.174 Vali Loss: 7.224 Vali Acc: 0.723 Test Loss: 7.224 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.842382192611694
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.142 Vali Acc: 0.723 Test Loss: 7.142 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.960259437561035
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.644 Vali Acc: 0.728 Test Loss: 6.644 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 15.111568450927734
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.632 Vali Acc: 0.740 Test Loss: 6.632 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 15.482586145401001
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.647 Vali Acc: 0.728 Test Loss: 6.647 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.971494674682617
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.644 Vali Acc: 0.728 Test Loss: 6.644 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 17.121220111846924
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.634 Vali Acc: 0.740 Test Loss: 6.634 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.619037866592407
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.664 Vali Acc: 0.728 Test Loss: 6.664 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 16.1103937625885
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.697 Vali Acc: 0.728 Test Loss: 6.697 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 15.56478214263916
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.657 Vali Acc: 0.734 Test Loss: 6.657 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 11319687
model size : 45.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.11882472038269
Epoch: 1, Steps: 67 | Train Loss: 13.055 Vali Loss: 17.304 Vali Acc: 0.566 Test Loss: 17.304 Test Acc: 0.566
Validation loss decreased (inf --> -0.566301).  Saving model ...
Epoch: 2 cost time: 11.464660882949829
Epoch: 2, Steps: 67 | Train Loss: 13.266 Vali Loss: 10.150 Vali Acc: 0.682 Test Loss: 10.150 Test Acc: 0.682
Validation loss decreased (-0.566301 --> -0.681979).  Saving model ...
Epoch: 3 cost time: 16.749974012374878
Epoch: 3, Steps: 67 | Train Loss: 1.979 Vali Loss: 11.225 Vali Acc: 0.642 Test Loss: 11.225 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.771934986114502
Epoch: 4, Steps: 67 | Train Loss: 1.707 Vali Loss: 3.495 Vali Acc: 0.821 Test Loss: 3.495 Test Acc: 0.821
Validation loss decreased (-0.681979 --> -0.820774).  Saving model ...
Epoch: 5 cost time: 16.97298240661621
Epoch: 5, Steps: 67 | Train Loss: 0.191 Vali Loss: 5.474 Vali Acc: 0.769 Test Loss: 5.474 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.645559787750244
Epoch: 6, Steps: 67 | Train Loss: 0.538 Vali Loss: 17.666 Vali Acc: 0.601 Test Loss: 17.666 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.660848617553711
Epoch: 7, Steps: 67 | Train Loss: 1.039 Vali Loss: 4.556 Vali Acc: 0.734 Test Loss: 4.556 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.063202381134033
Epoch: 8, Steps: 67 | Train Loss: 0.342 Vali Loss: 6.166 Vali Acc: 0.711 Test Loss: 6.166 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.556362390518188
Epoch: 9, Steps: 67 | Train Loss: 0.126 Vali Loss: 12.577 Vali Acc: 0.757 Test Loss: 12.577 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.757740497589111
Epoch: 10, Steps: 67 | Train Loss: 0.206 Vali Loss: 6.565 Vali Acc: 0.775 Test Loss: 6.565 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.592293500900269
Epoch: 11, Steps: 67 | Train Loss: 0.056 Vali Loss: 5.591 Vali Acc: 0.786 Test Loss: 5.591 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.586199283599854
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.988 Vali Acc: 0.809 Test Loss: 4.988 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 15.732343912124634
Epoch: 13, Steps: 67 | Train Loss: 0.002 Vali Loss: 6.062 Vali Acc: 0.769 Test Loss: 6.062 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.679865837097168
Epoch: 14, Steps: 67 | Train Loss: 0.105 Vali Loss: 4.215 Vali Acc: 0.809 Test Loss: 4.215 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 7869191
model size : 32.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.056099891662598
Epoch: 1, Steps: 67 | Train Loss: 16.058 Vali Loss: 26.811 Vali Acc: 0.410 Test Loss: 26.811 Test Acc: 0.410
Validation loss decreased (inf --> -0.410137).  Saving model ...
Epoch: 2 cost time: 11.763495206832886
Epoch: 2, Steps: 67 | Train Loss: 12.778 Vali Loss: 15.816 Vali Acc: 0.387 Test Loss: 15.816 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.713690042495728
Epoch: 3, Steps: 67 | Train Loss: 1.852 Vali Loss: 6.133 Vali Acc: 0.717 Test Loss: 6.133 Test Acc: 0.717
Validation loss decreased (-0.410137 --> -0.716702).  Saving model ...
Epoch: 4 cost time: 6.849772214889526
Epoch: 4, Steps: 67 | Train Loss: 0.396 Vali Loss: 5.389 Vali Acc: 0.671 Test Loss: 5.389 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.496399164199829
Epoch: 5, Steps: 67 | Train Loss: 0.636 Vali Loss: 1.824 Vali Acc: 0.757 Test Loss: 1.824 Test Acc: 0.757
Validation loss decreased (-0.716702 --> -0.757207).  Saving model ...
Epoch: 6 cost time: 11.833553791046143
Epoch: 6, Steps: 67 | Train Loss: 0.030 Vali Loss: 2.787 Vali Acc: 0.786 Test Loss: 2.787 Test Acc: 0.786
Validation loss decreased (-0.757207 --> -0.786099).  Saving model ...
Epoch: 7 cost time: 12.937074899673462
Epoch: 7, Steps: 67 | Train Loss: 0.166 Vali Loss: 5.470 Vali Acc: 0.798 Test Loss: 5.470 Test Acc: 0.798
Validation loss decreased (-0.786099 --> -0.797633).  Saving model ...
Epoch: 8 cost time: 13.550284147262573
Epoch: 8, Steps: 67 | Train Loss: 0.365 Vali Loss: 2.116 Vali Acc: 0.809 Test Loss: 2.116 Test Acc: 0.809
Validation loss decreased (-0.797633 --> -0.809227).  Saving model ...
Epoch: 9 cost time: 12.520303010940552
Epoch: 9, Steps: 67 | Train Loss: 0.078 Vali Loss: 4.201 Vali Acc: 0.723 Test Loss: 4.201 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.279531002044678
Epoch: 10, Steps: 67 | Train Loss: 0.256 Vali Loss: 8.677 Vali Acc: 0.775 Test Loss: 8.677 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.612479448318481
Epoch: 11, Steps: 67 | Train Loss: 0.541 Vali Loss: 3.288 Vali Acc: 0.803 Test Loss: 3.288 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 12.887403964996338
Epoch: 12, Steps: 67 | Train Loss: 0.440 Vali Loss: 12.451 Vali Acc: 0.682 Test Loss: 12.451 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.800635814666748
Epoch: 13, Steps: 67 | Train Loss: 0.812 Vali Loss: 4.724 Vali Acc: 0.740 Test Loss: 4.724 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 12.07496953010559
Epoch: 14, Steps: 67 | Train Loss: 0.329 Vali Loss: 14.676 Vali Acc: 0.723 Test Loss: 14.676 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 15.656292915344238
Epoch: 15, Steps: 67 | Train Loss: 0.594 Vali Loss: 9.267 Vali Acc: 0.699 Test Loss: 9.267 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 11.089625120162964
Epoch: 16, Steps: 67 | Train Loss: 0.275 Vali Loss: 9.473 Vali Acc: 0.780 Test Loss: 9.473 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.247775554656982
Epoch: 17, Steps: 67 | Train Loss: 0.025 Vali Loss: 9.136 Vali Acc: 0.798 Test Loss: 9.136 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.949341535568237
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.264 Vali Acc: 0.809 Test Loss: 9.264 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 7007239
model size : 29.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 769.5533447
	speed: 0.2035s/iter; left time: 2706.8904s
Epoch: 1 cost time: 26.871098041534424
Epoch: 1, Steps: 134 | Train Loss: 287.684 Vali Loss: 139.243 Vali Acc: 0.364 Test Loss: 139.243 Test Acc: 0.364
Validation loss decreased (inf --> -0.362769).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.4241s/iter; left time: 5584.7376s
Epoch: 2 cost time: 25.897149085998535
Epoch: 2, Steps: 134 | Train Loss: 54.711 Vali Loss: 19.317 Vali Acc: 0.647 Test Loss: 19.317 Test Acc: 0.647
Validation loss decreased (-0.362769 --> -0.647206).  Saving model ...
	iters: 100, epoch: 3 | loss: 37.8287735
	speed: 0.4441s/iter; left time: 5787.7084s
Epoch: 3 cost time: 25.9927499294281
Epoch: 3, Steps: 134 | Train Loss: 2.831 Vali Loss: 31.364 Vali Acc: 0.618 Test Loss: 31.364 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.4185s/iter; left time: 5397.8036s
Epoch: 4 cost time: 25.901962995529175
Epoch: 4, Steps: 134 | Train Loss: 2.054 Vali Loss: 8.840 Vali Acc: 0.821 Test Loss: 8.840 Test Acc: 0.821
Validation loss decreased (-0.647206 --> -0.820721).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4455s/iter; left time: 5687.1124s
Epoch: 5 cost time: 25.981959342956543
Epoch: 5, Steps: 134 | Train Loss: 4.754 Vali Loss: 32.608 Vali Acc: 0.746 Test Loss: 32.608 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4187s/iter; left time: 5288.0974s
Epoch: 6 cost time: 25.896028757095337
Epoch: 6, Steps: 134 | Train Loss: 3.222 Vali Loss: 27.652 Vali Acc: 0.711 Test Loss: 27.652 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4210s/iter; left time: 5261.3904s
Epoch: 7 cost time: 25.930639505386353
Epoch: 7, Steps: 134 | Train Loss: 0.944 Vali Loss: 77.754 Vali Acc: 0.561 Test Loss: 77.754 Test Acc: 0.561
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.4200s/iter; left time: 5192.0745s
Epoch: 8 cost time: 25.89652442932129
Epoch: 8, Steps: 134 | Train Loss: 3.671 Vali Loss: 30.591 Vali Acc: 0.595 Test Loss: 30.591 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4208s/iter; left time: 5145.6106s
Epoch: 9 cost time: 25.92442536354065
Epoch: 9, Steps: 134 | Train Loss: 0.478 Vali Loss: 22.549 Vali Acc: 0.682 Test Loss: 22.549 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4191s/iter; left time: 5069.2605s
Epoch: 10 cost time: 25.92247486114502
Epoch: 10, Steps: 134 | Train Loss: 0.725 Vali Loss: 43.396 Vali Acc: 0.705 Test Loss: 43.396 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4193s/iter; left time: 5014.7292s
Epoch: 11 cost time: 25.87255096435547
Epoch: 11, Steps: 134 | Train Loss: 2.918 Vali Loss: 90.653 Vali Acc: 0.717 Test Loss: 90.653 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4194s/iter; left time: 4960.7771s
Epoch: 12 cost time: 26.039260625839233
Epoch: 12, Steps: 134 | Train Loss: 3.894 Vali Loss: 33.720 Vali Acc: 0.757 Test Loss: 33.720 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4202s/iter; left time: 4913.9293s
Epoch: 13 cost time: 25.959489822387695
Epoch: 13, Steps: 134 | Train Loss: 2.594 Vali Loss: 78.604 Vali Acc: 0.688 Test Loss: 78.604 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4214s/iter; left time: 4871.2827s
Epoch: 14 cost time: 25.96183443069458
Epoch: 14, Steps: 134 | Train Loss: 4.270 Vali Loss: 32.559 Vali Acc: 0.694 Test Loss: 32.559 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 62208967
model size : 239.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 42.74038124084473
Epoch: 1, Steps: 67 | Train Loss: 76.026 Vali Loss: 137.706 Vali Acc: 0.382 Test Loss: 137.706 Test Acc: 0.382
Validation loss decreased (inf --> -0.380126).  Saving model ...
Epoch: 2 cost time: 37.2741584777832
Epoch: 2, Steps: 67 | Train Loss: 54.691 Vali Loss: 57.466 Vali Acc: 0.538 Test Loss: 57.466 Test Acc: 0.538
Validation loss decreased (-0.380126 --> -0.536998).  Saving model ...
Epoch: 3 cost time: 31.234245538711548
Epoch: 3, Steps: 67 | Train Loss: 20.420 Vali Loss: 82.136 Vali Acc: 0.584 Test Loss: 82.136 Test Acc: 0.584
Validation loss decreased (-0.536998 --> -0.582994).  Saving model ...
Epoch: 4 cost time: 31.59353542327881
Epoch: 4, Steps: 67 | Train Loss: 7.290 Vali Loss: 17.281 Vali Acc: 0.763 Test Loss: 17.281 Test Acc: 0.763
Validation loss decreased (-0.582994 --> -0.762833).  Saving model ...
Epoch: 5 cost time: 25.68731117248535
Epoch: 5, Steps: 67 | Train Loss: 0.866 Vali Loss: 19.508 Vali Acc: 0.751 Test Loss: 19.508 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 41.71863055229187
Epoch: 6, Steps: 67 | Train Loss: 1.456 Vali Loss: 41.234 Vali Acc: 0.676 Test Loss: 41.234 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 43.82676649093628
Epoch: 7, Steps: 67 | Train Loss: 3.241 Vali Loss: 14.092 Vali Acc: 0.798 Test Loss: 14.092 Test Acc: 0.798
Validation loss decreased (-0.762833 --> -0.797547).  Saving model ...
Epoch: 8 cost time: 42.29356503486633
Epoch: 8, Steps: 67 | Train Loss: 1.903 Vali Loss: 11.283 Vali Acc: 0.792 Test Loss: 11.283 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 42.3986291885376
Epoch: 9, Steps: 67 | Train Loss: 0.887 Vali Loss: 15.794 Vali Acc: 0.786 Test Loss: 15.794 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 39.63316082954407
Epoch: 10, Steps: 67 | Train Loss: 1.137 Vali Loss: 15.438 Vali Acc: 0.723 Test Loss: 15.438 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 42.577162981033325
Epoch: 11, Steps: 67 | Train Loss: 0.134 Vali Loss: 17.099 Vali Acc: 0.740 Test Loss: 17.099 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 42.37802839279175
Epoch: 12, Steps: 67 | Train Loss: 0.930 Vali Loss: 8.831 Vali Acc: 0.850 Test Loss: 8.831 Test Acc: 0.850
Validation loss decreased (-0.797547 --> -0.849623).  Saving model ...
Epoch: 13 cost time: 41.64239764213562
Epoch: 13, Steps: 67 | Train Loss: 0.436 Vali Loss: 23.865 Vali Acc: 0.751 Test Loss: 23.865 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 38.43079876899719
Epoch: 14, Steps: 67 | Train Loss: 2.728 Vali Loss: 33.545 Vali Acc: 0.688 Test Loss: 33.545 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 35.57724905014038
Epoch: 15, Steps: 67 | Train Loss: 0.572 Vali Loss: 28.842 Vali Acc: 0.590 Test Loss: 28.842 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 32.03521203994751
Epoch: 16, Steps: 67 | Train Loss: 2.170 Vali Loss: 31.052 Vali Acc: 0.636 Test Loss: 31.052 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 38.80696702003479
Epoch: 17, Steps: 67 | Train Loss: 2.462 Vali Loss: 13.115 Vali Acc: 0.798 Test Loss: 13.115 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 33.72104525566101
Epoch: 18, Steps: 67 | Train Loss: 1.183 Vali Loss: 11.665 Vali Acc: 0.815 Test Loss: 11.665 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 39.1685893535614
Epoch: 19, Steps: 67 | Train Loss: 1.271 Vali Loss: 35.325 Vali Acc: 0.734 Test Loss: 35.325 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 42.224865674972534
Epoch: 20, Steps: 67 | Train Loss: 1.057 Vali Loss: 35.003 Vali Acc: 0.705 Test Loss: 35.003 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 43.81295037269592
Epoch: 21, Steps: 67 | Train Loss: 0.009 Vali Loss: 48.296 Vali Acc: 0.711 Test Loss: 48.296 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 38.80505967140198
Epoch: 22, Steps: 67 | Train Loss: 1.656 Vali Loss: 22.058 Vali Acc: 0.792 Test Loss: 22.058 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 31146951
model size : 121.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 33.76236152648926
Epoch: 1, Steps: 67 | Train Loss: 54.364 Vali Loss: 41.244 Vali Acc: 0.474 Test Loss: 41.244 Test Acc: 0.474
Validation loss decreased (inf --> -0.473576).  Saving model ...
Epoch: 2 cost time: 18.052762746810913
Epoch: 2, Steps: 67 | Train Loss: 25.119 Vali Loss: 40.248 Vali Acc: 0.624 Test Loss: 40.248 Test Acc: 0.624
Validation loss decreased (-0.473576 --> -0.623875).  Saving model ...
Epoch: 3 cost time: 20.458187103271484
Epoch: 3, Steps: 67 | Train Loss: 10.864 Vali Loss: 15.648 Vali Acc: 0.694 Test Loss: 15.648 Test Acc: 0.694
Validation loss decreased (-0.623875 --> -0.693485).  Saving model ...
Epoch: 4 cost time: 28.05944037437439
Epoch: 4, Steps: 67 | Train Loss: 4.758 Vali Loss: 28.940 Vali Acc: 0.636 Test Loss: 28.940 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.473125219345093
Epoch: 5, Steps: 67 | Train Loss: 1.413 Vali Loss: 27.037 Vali Acc: 0.624 Test Loss: 27.037 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.623470067977905
Epoch: 6, Steps: 67 | Train Loss: 1.384 Vali Loss: 7.729 Vali Acc: 0.780 Test Loss: 7.729 Test Acc: 0.780
Validation loss decreased (-0.693485 --> -0.780270).  Saving model ...
Epoch: 7 cost time: 30.80728030204773
Epoch: 7, Steps: 67 | Train Loss: 0.659 Vali Loss: 7.455 Vali Acc: 0.757 Test Loss: 7.455 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.441208839416504
Epoch: 8, Steps: 67 | Train Loss: 0.490 Vali Loss: 14.993 Vali Acc: 0.740 Test Loss: 14.993 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.9660964012146
Epoch: 9, Steps: 67 | Train Loss: 0.019 Vali Loss: 10.133 Vali Acc: 0.769 Test Loss: 10.133 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 27.19623613357544
Epoch: 10, Steps: 67 | Train Loss: 0.318 Vali Loss: 4.224 Vali Acc: 0.850 Test Loss: 4.224 Test Acc: 0.850
Validation loss decreased (-0.780270 --> -0.849669).  Saving model ...
Epoch: 11 cost time: 21.965664386749268
Epoch: 11, Steps: 67 | Train Loss: 0.567 Vali Loss: 6.883 Vali Acc: 0.821 Test Loss: 6.883 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.883435249328613
Epoch: 12, Steps: 67 | Train Loss: 0.156 Vali Loss: 10.833 Vali Acc: 0.717 Test Loss: 10.833 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 28.0189790725708
Epoch: 13, Steps: 67 | Train Loss: 1.166 Vali Loss: 21.332 Vali Acc: 0.734 Test Loss: 21.332 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.94534659385681
Epoch: 14, Steps: 67 | Train Loss: 2.289 Vali Loss: 6.690 Vali Acc: 0.821 Test Loss: 6.690 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 22.36570453643799
Epoch: 15, Steps: 67 | Train Loss: 0.442 Vali Loss: 17.657 Vali Acc: 0.659 Test Loss: 17.657 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 28.272709369659424
Epoch: 16, Steps: 67 | Train Loss: 1.033 Vali Loss: 9.996 Vali Acc: 0.809 Test Loss: 9.996 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 23.864039659500122
Epoch: 17, Steps: 67 | Train Loss: 0.165 Vali Loss: 11.672 Vali Acc: 0.821 Test Loss: 11.672 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 19.87417197227478
Epoch: 18, Steps: 67 | Train Loss: 0.149 Vali Loss: 10.823 Vali Acc: 0.821 Test Loss: 10.823 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 28.197898149490356
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 18.850 Vali Acc: 0.780 Test Loss: 18.850 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 18.920449256896973
Epoch: 20, Steps: 67 | Train Loss: 0.557 Vali Loss: 14.439 Vali Acc: 0.815 Test Loss: 14.439 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 20793159
model size : 81.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.187193870544434
Epoch: 1, Steps: 67 | Train Loss: 38.509 Vali Loss: 49.555 Vali Acc: 0.358 Test Loss: 49.555 Test Acc: 0.358
Validation loss decreased (inf --> -0.357886).  Saving model ...
Epoch: 2 cost time: 18.52767777442932
Epoch: 2, Steps: 67 | Train Loss: 24.566 Vali Loss: 21.684 Vali Acc: 0.636 Test Loss: 21.684 Test Acc: 0.636
Validation loss decreased (-0.357886 --> -0.635621).  Saving model ...
Epoch: 3 cost time: 23.587531805038452
Epoch: 3, Steps: 67 | Train Loss: 9.413 Vali Loss: 15.299 Vali Acc: 0.642 Test Loss: 15.299 Test Acc: 0.642
Validation loss decreased (-0.635621 --> -0.641466).  Saving model ...
Epoch: 4 cost time: 18.016858100891113
Epoch: 4, Steps: 67 | Train Loss: 0.988 Vali Loss: 8.168 Vali Acc: 0.775 Test Loss: 8.168 Test Acc: 0.775
Validation loss decreased (-0.641466 --> -0.774485).  Saving model ...
Epoch: 5 cost time: 20.131958961486816
Epoch: 5, Steps: 67 | Train Loss: 0.811 Vali Loss: 9.572 Vali Acc: 0.786 Test Loss: 9.572 Test Acc: 0.786
Validation loss decreased (-0.774485 --> -0.786031).  Saving model ...
Epoch: 6 cost time: 16.386937141418457
Epoch: 6, Steps: 67 | Train Loss: 0.556 Vali Loss: 11.313 Vali Acc: 0.746 Test Loss: 11.313 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.378991603851318
Epoch: 7, Steps: 67 | Train Loss: 0.092 Vali Loss: 4.545 Vali Acc: 0.803 Test Loss: 4.545 Test Acc: 0.803
Validation loss decreased (-0.786031 --> -0.803423).  Saving model ...
Epoch: 8 cost time: 25.320353746414185
Epoch: 8, Steps: 67 | Train Loss: 0.091 Vali Loss: 2.551 Vali Acc: 0.884 Test Loss: 2.551 Test Acc: 0.884
Validation loss decreased (-0.803423 --> -0.884368).  Saving model ...
Epoch: 9 cost time: 21.57236957550049
Epoch: 9, Steps: 67 | Train Loss: 0.810 Vali Loss: 11.714 Vali Acc: 0.757 Test Loss: 11.714 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.691117763519287
Epoch: 10, Steps: 67 | Train Loss: 0.665 Vali Loss: 12.541 Vali Acc: 0.728 Test Loss: 12.541 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.46200966835022
Epoch: 11, Steps: 67 | Train Loss: 0.380 Vali Loss: 6.446 Vali Acc: 0.821 Test Loss: 6.446 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.91139817237854
Epoch: 12, Steps: 67 | Train Loss: 0.500 Vali Loss: 7.564 Vali Acc: 0.792 Test Loss: 7.564 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 24.523454189300537
Epoch: 13, Steps: 67 | Train Loss: 0.212 Vali Loss: 5.972 Vali Acc: 0.821 Test Loss: 5.972 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 15.559454202651978
Epoch: 14, Steps: 67 | Train Loss: 0.149 Vali Loss: 19.664 Vali Acc: 0.746 Test Loss: 19.664 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 25.06859302520752
Epoch: 15, Steps: 67 | Train Loss: 0.142 Vali Loss: 25.841 Vali Acc: 0.538 Test Loss: 25.841 Test Acc: 0.538
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.91488027572632
Epoch: 16, Steps: 67 | Train Loss: 2.152 Vali Loss: 10.441 Vali Acc: 0.705 Test Loss: 10.441 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 18.005447149276733
Epoch: 17, Steps: 67 | Train Loss: 0.010 Vali Loss: 14.699 Vali Acc: 0.659 Test Loss: 14.699 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 14.360951662063599
Epoch: 18, Steps: 67 | Train Loss: 2.315 Vali Loss: 20.185 Vali Acc: 0.728 Test Loss: 20.185 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.884393063583815
model parameter : 15616583
model size : 62.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.999532461166382
Epoch: 1, Steps: 67 | Train Loss: 26.480 Vali Loss: 20.625 Vali Acc: 0.474 Test Loss: 20.625 Test Acc: 0.474
Validation loss decreased (inf --> -0.473782).  Saving model ...
Epoch: 2 cost time: 10.113659143447876
Epoch: 2, Steps: 67 | Train Loss: 11.080 Vali Loss: 30.222 Vali Acc: 0.514 Test Loss: 30.222 Test Acc: 0.514
Validation loss decreased (-0.473782 --> -0.514149).  Saving model ...
Epoch: 3 cost time: 13.7023344039917
Epoch: 3, Steps: 67 | Train Loss: 18.894 Vali Loss: 24.224 Vali Acc: 0.723 Test Loss: 24.224 Test Acc: 0.723
Validation loss decreased (-0.514149 --> -0.722301).  Saving model ...
Epoch: 4 cost time: 13.73840856552124
Epoch: 4, Steps: 67 | Train Loss: 1.583 Vali Loss: 2.444 Vali Acc: 0.809 Test Loss: 2.444 Test Acc: 0.809
Validation loss decreased (-0.722301 --> -0.809224).  Saving model ...
Epoch: 5 cost time: 13.309454679489136
Epoch: 5, Steps: 67 | Train Loss: 0.073 Vali Loss: 4.634 Vali Acc: 0.751 Test Loss: 4.634 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.475777626037598
Epoch: 6, Steps: 67 | Train Loss: 0.191 Vali Loss: 11.299 Vali Acc: 0.728 Test Loss: 11.299 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.21642255783081
Epoch: 7, Steps: 67 | Train Loss: 1.251 Vali Loss: 15.598 Vali Acc: 0.659 Test Loss: 15.598 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.915926933288574
Epoch: 8, Steps: 67 | Train Loss: 0.596 Vali Loss: 7.398 Vali Acc: 0.694 Test Loss: 7.398 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.087374687194824
Epoch: 9, Steps: 67 | Train Loss: 0.355 Vali Loss: 6.154 Vali Acc: 0.717 Test Loss: 6.154 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 14.445613861083984
Epoch: 10, Steps: 67 | Train Loss: 0.093 Vali Loss: 5.312 Vali Acc: 0.786 Test Loss: 5.312 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 16.49242329597473
Epoch: 11, Steps: 67 | Train Loss: 0.072 Vali Loss: 6.067 Vali Acc: 0.763 Test Loss: 6.067 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 14.641036748886108
Epoch: 12, Steps: 67 | Train Loss: 1.089 Vali Loss: 7.059 Vali Acc: 0.775 Test Loss: 7.059 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.402602672576904
Epoch: 13, Steps: 67 | Train Loss: 0.105 Vali Loss: 15.083 Vali Acc: 0.711 Test Loss: 15.083 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 12.841361284255981
Epoch: 14, Steps: 67 | Train Loss: 0.436 Vali Loss: 12.636 Vali Acc: 0.699 Test Loss: 12.636 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 11303239
model size : 45.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.862082958221436
Epoch: 1, Steps: 67 | Train Loss: 15.347 Vali Loss: 5.154 Vali Acc: 0.676 Test Loss: 5.154 Test Acc: 0.676
Validation loss decreased (inf --> -0.676249).  Saving model ...
Epoch: 2 cost time: 13.749261140823364
Epoch: 2, Steps: 67 | Train Loss: 8.556 Vali Loss: 7.707 Vali Acc: 0.728 Test Loss: 7.707 Test Acc: 0.728
Validation loss decreased (-0.676249 --> -0.728247).  Saving model ...
Epoch: 3 cost time: 8.717677593231201
Epoch: 3, Steps: 67 | Train Loss: 3.747 Vali Loss: 7.282 Vali Acc: 0.717 Test Loss: 7.282 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.07860541343689
Epoch: 4, Steps: 67 | Train Loss: 1.487 Vali Loss: 11.084 Vali Acc: 0.688 Test Loss: 11.084 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.594736099243164
Epoch: 5, Steps: 67 | Train Loss: 0.745 Vali Loss: 4.001 Vali Acc: 0.751 Test Loss: 4.001 Test Acc: 0.751
Validation loss decreased (-0.728247 --> -0.751405).  Saving model ...
Epoch: 6 cost time: 14.456159830093384
Epoch: 6, Steps: 67 | Train Loss: 0.079 Vali Loss: 4.806 Vali Acc: 0.775 Test Loss: 4.806 Test Acc: 0.775
Validation loss decreased (-0.751405 --> -0.774518).  Saving model ...
Epoch: 7 cost time: 9.13015079498291
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.148 Vali Acc: 0.780 Test Loss: 5.148 Test Acc: 0.780
Validation loss decreased (-0.774518 --> -0.780295).  Saving model ...
Epoch: 8 cost time: 10.813408851623535
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.005 Vali Acc: 0.792 Test Loss: 5.005 Test Acc: 0.792
Validation loss decreased (-0.780295 --> -0.791857).  Saving model ...
Epoch: 9 cost time: 14.567897319793701
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.908 Vali Acc: 0.792 Test Loss: 4.908 Test Acc: 0.792
Validation loss decreased (-0.791857 --> -0.791858).  Saving model ...
Epoch: 10 cost time: 8.554408073425293
Epoch: 10, Steps: 67 | Train Loss: 0.019 Vali Loss: 4.683 Vali Acc: 0.803 Test Loss: 4.683 Test Acc: 0.803
Validation loss decreased (-0.791858 --> -0.803421).  Saving model ...
Epoch: 11 cost time: 9.787262439727783
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.821 Vali Acc: 0.798 Test Loss: 4.821 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.157914161682129
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.809 Vali Acc: 0.798 Test Loss: 4.809 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.42812991142273
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.787 Vali Acc: 0.798 Test Loss: 4.787 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.936646223068237
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.780 Vali Acc: 0.798 Test Loss: 4.780 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 12.287497997283936
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.209 Vali Acc: 0.815 Test Loss: 4.209 Test Acc: 0.815
Validation loss decreased (-0.803421 --> -0.814987).  Saving model ...
Epoch: 16 cost time: 15.176155805587769
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.785 Vali Acc: 0.821 Test Loss: 3.785 Test Acc: 0.821
Validation loss decreased (-0.814987 --> -0.820771).  Saving model ...
Epoch: 17 cost time: 8.473649978637695
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.769 Vali Acc: 0.809 Test Loss: 3.769 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.699747800827026
Epoch: 18, Steps: 67 | Train Loss: 2.187 Vali Loss: 64.976 Vali Acc: 0.191 Test Loss: 64.976 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.697363138198853
Epoch: 19, Steps: 67 | Train Loss: 3.262 Vali Loss: 9.724 Vali Acc: 0.775 Test Loss: 9.724 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 14.980463027954102
Epoch: 20, Steps: 67 | Train Loss: 1.697 Vali Loss: 14.276 Vali Acc: 0.734 Test Loss: 14.276 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.253867626190186
Epoch: 21, Steps: 67 | Train Loss: 2.034 Vali Loss: 28.080 Vali Acc: 0.717 Test Loss: 28.080 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 11.928668975830078
Epoch: 22, Steps: 67 | Train Loss: 2.154 Vali Loss: 19.222 Vali Acc: 0.769 Test Loss: 19.222 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 10.400826692581177
Epoch: 23, Steps: 67 | Train Loss: 0.713 Vali Loss: 5.826 Vali Acc: 0.827 Test Loss: 5.826 Test Acc: 0.827
Validation loss decreased (-0.820771 --> -0.826531).  Saving model ...
Epoch: 24 cost time: 8.909035921096802
Epoch: 24, Steps: 67 | Train Loss: 0.516 Vali Loss: 6.738 Vali Acc: 0.809 Test Loss: 6.738 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 12.16974687576294
Epoch: 25, Steps: 67 | Train Loss: 0.134 Vali Loss: 14.965 Vali Acc: 0.844 Test Loss: 14.965 Test Acc: 0.844
Validation loss decreased (-0.826531 --> -0.843781).  Saving model ...
Epoch: 26 cost time: 10.474788904190063
Epoch: 26, Steps: 67 | Train Loss: 0.573 Vali Loss: 11.584 Vali Acc: 0.775 Test Loss: 11.584 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.366164207458496
Epoch: 27, Steps: 67 | Train Loss: 0.341 Vali Loss: 23.414 Vali Acc: 0.763 Test Loss: 23.414 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.591502904891968
Epoch: 28, Steps: 67 | Train Loss: 0.808 Vali Loss: 7.260 Vali Acc: 0.815 Test Loss: 7.260 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 10.040606260299683
Epoch: 29, Steps: 67 | Train Loss: 0.547 Vali Loss: 6.706 Vali Acc: 0.832 Test Loss: 6.706 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 11.46152949333191
Epoch: 30, Steps: 67 | Train Loss: 0.189 Vali Loss: 17.769 Vali Acc: 0.792 Test Loss: 17.769 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 11.533225536346436
Epoch: 31, Steps: 67 | Train Loss: 0.240 Vali Loss: 7.138 Vali Acc: 0.855 Test Loss: 7.138 Test Acc: 0.855
Validation loss decreased (-0.843781 --> -0.855420).  Saving model ...
Epoch: 32 cost time: 8.561214923858643
Epoch: 32, Steps: 67 | Train Loss: 0.684 Vali Loss: 17.208 Vali Acc: 0.786 Test Loss: 17.208 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 12.694063663482666
Epoch: 33, Steps: 67 | Train Loss: 0.180 Vali Loss: 14.531 Vali Acc: 0.798 Test Loss: 14.531 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.1067163944244385
Epoch: 34, Steps: 67 | Train Loss: 0.231 Vali Loss: 16.660 Vali Acc: 0.792 Test Loss: 16.660 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 8.374436378479004
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 39.895 Vali Acc: 0.624 Test Loss: 39.895 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 11.79700493812561
Epoch: 36, Steps: 67 | Train Loss: 0.071 Vali Loss: 16.793 Vali Acc: 0.827 Test Loss: 16.793 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 10.073348760604858
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 16.683 Vali Acc: 0.827 Test Loss: 16.683 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 16.420599937438965
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 16.680 Vali Acc: 0.827 Test Loss: 16.680 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 9.843989610671997
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 16.746 Vali Acc: 0.827 Test Loss: 16.746 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 15.401841640472412
Epoch: 40, Steps: 67 | Train Loss: 1.270 Vali Loss: 47.818 Vali Acc: 0.572 Test Loss: 47.818 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 8.759697437286377
Epoch: 41, Steps: 67 | Train Loss: 1.929 Vali Loss: 17.611 Vali Acc: 0.780 Test Loss: 17.611 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 7852743
model size : 32.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.26686716079712
Epoch: 1, Steps: 67 | Train Loss: 16.961 Vali Loss: 9.152 Vali Acc: 0.549 Test Loss: 9.152 Test Acc: 0.549
Validation loss decreased (inf --> -0.549041).  Saving model ...
Epoch: 2 cost time: 13.040043354034424
Epoch: 2, Steps: 67 | Train Loss: 11.780 Vali Loss: 5.086 Vali Acc: 0.711 Test Loss: 5.086 Test Acc: 0.711
Validation loss decreased (-0.549041 --> -0.710932).  Saving model ...
Epoch: 3 cost time: 9.027127742767334
Epoch: 3, Steps: 67 | Train Loss: 4.683 Vali Loss: 4.272 Vali Acc: 0.769 Test Loss: 4.272 Test Acc: 0.769
Validation loss decreased (-0.710932 --> -0.768743).  Saving model ...
Epoch: 4 cost time: 8.181863784790039
Epoch: 4, Steps: 67 | Train Loss: 0.573 Vali Loss: 9.156 Vali Acc: 0.740 Test Loss: 9.156 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.982236623764038
Epoch: 5, Steps: 67 | Train Loss: 0.353 Vali Loss: 8.630 Vali Acc: 0.746 Test Loss: 8.630 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.699618577957153
Epoch: 6, Steps: 67 | Train Loss: 0.554 Vali Loss: 6.243 Vali Acc: 0.792 Test Loss: 6.243 Test Acc: 0.792
Validation loss decreased (-0.768743 --> -0.791845).  Saving model ...
Epoch: 7 cost time: 10.721736192703247
Epoch: 7, Steps: 67 | Train Loss: 0.358 Vali Loss: 2.016 Vali Acc: 0.844 Test Loss: 2.016 Test Acc: 0.844
Validation loss decreased (-0.791845 --> -0.843910).  Saving model ...
Epoch: 8 cost time: 10.016580820083618
Epoch: 8, Steps: 67 | Train Loss: 0.018 Vali Loss: 1.467 Vali Acc: 0.815 Test Loss: 1.467 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.083198547363281
Epoch: 9, Steps: 67 | Train Loss: 0.102 Vali Loss: 6.550 Vali Acc: 0.775 Test Loss: 6.550 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.607751846313477
Epoch: 10, Steps: 67 | Train Loss: 0.314 Vali Loss: 4.110 Vali Acc: 0.792 Test Loss: 4.110 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.736109733581543
Epoch: 11, Steps: 67 | Train Loss: 0.043 Vali Loss: 4.036 Vali Acc: 0.780 Test Loss: 4.036 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.341921329498291
Epoch: 12, Steps: 67 | Train Loss: 1.110 Vali Loss: 5.167 Vali Acc: 0.746 Test Loss: 5.167 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.022358655929565
Epoch: 13, Steps: 67 | Train Loss: 0.602 Vali Loss: 10.542 Vali Acc: 0.728 Test Loss: 10.542 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.125749588012695
Epoch: 14, Steps: 67 | Train Loss: 0.299 Vali Loss: 14.088 Vali Acc: 0.676 Test Loss: 14.088 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.000102281570435
Epoch: 15, Steps: 67 | Train Loss: 0.595 Vali Loss: 7.107 Vali Acc: 0.832 Test Loss: 7.107 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 8.235240936279297
Epoch: 16, Steps: 67 | Train Loss: 0.473 Vali Loss: 7.292 Vali Acc: 0.780 Test Loss: 7.292 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.641174793243408
Epoch: 17, Steps: 67 | Train Loss: 0.422 Vali Loss: 6.660 Vali Acc: 0.780 Test Loss: 6.660 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 6990791
model size : 29.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 0.0000000
	speed: 0.4770s/iter; left time: 6343.9343s
Epoch: 1 cost time: 59.80429553985596
Epoch: 1, Steps: 134 | Train Loss: 144.169 Vali Loss: 156.212 Vali Acc: 0.301 Test Loss: 156.212 Test Acc: 0.301
Validation loss decreased (inf --> -0.299016).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.9255s/iter; left time: 12186.3467s
Epoch: 2 cost time: 59.85080432891846
Epoch: 2, Steps: 134 | Train Loss: 81.850 Vali Loss: 51.844 Vali Acc: 0.723 Test Loss: 51.844 Test Acc: 0.723
Validation loss decreased (-0.299016 --> -0.722025).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 1.0773s/iter; left time: 14041.0691s
Epoch: 3 cost time: 61.98796820640564
Epoch: 3, Steps: 134 | Train Loss: 12.480 Vali Loss: 14.293 Vali Acc: 0.694 Test Loss: 14.293 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.8291s/iter; left time: 10694.8672s
Epoch: 4 cost time: 46.03327298164368
Epoch: 4, Steps: 134 | Train Loss: 1.196 Vali Loss: 14.821 Vali Acc: 0.815 Test Loss: 14.821 Test Acc: 0.815
Validation loss decreased (-0.722025 --> -0.814881).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 1.0956s/iter; left time: 13985.1615s
Epoch: 5 cost time: 68.82560563087463
Epoch: 5, Steps: 134 | Train Loss: 1.659 Vali Loss: 27.968 Vali Acc: 0.717 Test Loss: 27.968 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 1.0680s/iter; left time: 13490.1073s
Epoch: 6 cost time: 65.1174418926239
Epoch: 6, Steps: 134 | Train Loss: 0.561 Vali Loss: 42.072 Vali Acc: 0.717 Test Loss: 42.072 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.8863s/iter; left time: 11075.8977s
Epoch: 7 cost time: 53.92955923080444
Epoch: 7, Steps: 134 | Train Loss: 7.790 Vali Loss: 25.217 Vali Acc: 0.717 Test Loss: 25.217 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 1.0572s/iter; left time: 13070.3285s
Epoch: 8 cost time: 61.996010065078735
Epoch: 8, Steps: 134 | Train Loss: 1.178 Vali Loss: 8.762 Vali Acc: 0.780 Test Loss: 8.762 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 1.1170s/iter; left time: 13659.7490s
Epoch: 9 cost time: 67.00112080574036
Epoch: 9, Steps: 134 | Train Loss: 0.222 Vali Loss: 14.045 Vali Acc: 0.746 Test Loss: 14.045 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.9157s/iter; left time: 11075.9546s
Epoch: 10 cost time: 53.20225763320923
Epoch: 10, Steps: 134 | Train Loss: 0.164 Vali Loss: 18.551 Vali Acc: 0.775 Test Loss: 18.551 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.9684s/iter; left time: 11582.8422s
Epoch: 11 cost time: 63.928741693496704
Epoch: 11, Steps: 134 | Train Loss: 0.247 Vali Loss: 6.864 Vali Acc: 0.844 Test Loss: 6.864 Test Acc: 0.844
Validation loss decreased (-0.814881 --> -0.843862).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.9913s/iter; left time: 11724.3789s
Epoch: 12 cost time: 56.84440207481384
Epoch: 12, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.916 Vali Acc: 0.844 Test Loss: 6.916 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 1.0452s/iter; left time: 12221.3747s
Epoch: 13 cost time: 70.8569233417511
Epoch: 13, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.883 Vali Acc: 0.844 Test Loss: 6.883 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 1.1230s/iter; left time: 12980.2046s
Epoch: 14 cost time: 65.03192472457886
Epoch: 14, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.897 Vali Acc: 0.838 Test Loss: 6.897 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 1.0819s/iter; left time: 12360.9534s
Epoch: 15 cost time: 64.06042337417603
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.918 Vali Acc: 0.838 Test Loss: 6.918 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.9347s/iter; left time: 10553.8773s
Epoch: 16 cost time: 62.20145273208618
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.853 Vali Acc: 0.838 Test Loss: 6.853 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 1.0641s/iter; left time: 11872.3212s
Epoch: 17 cost time: 71.33588719367981
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 6.932 Vali Acc: 0.838 Test Loss: 6.932 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 1.0717s/iter; left time: 11813.4620s
Epoch: 18 cost time: 64.44965028762817
Epoch: 18, Steps: 134 | Train Loss: 5.520 Vali Loss: 83.601 Vali Acc: 0.543 Test Loss: 83.601 Test Acc: 0.543
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000001
	speed: 1.0976s/iter; left time: 11952.1732s
Epoch: 19 cost time: 62.81935095787048
Epoch: 19, Steps: 134 | Train Loss: 4.679 Vali Loss: 36.018 Vali Acc: 0.618 Test Loss: 36.018 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.9813s/iter; left time: 10553.4715s
Epoch: 20 cost time: 62.86181330680847
Epoch: 20, Steps: 134 | Train Loss: 1.568 Vali Loss: 121.420 Vali Acc: 0.601 Test Loss: 121.420 Test Acc: 0.601
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 1.0977s/iter; left time: 11658.7471s
Epoch: 21 cost time: 69.05301356315613
Epoch: 21, Steps: 134 | Train Loss: 6.358 Vali Loss: 62.792 Vali Acc: 0.659 Test Loss: 62.792 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 31112903
model size : 119.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 34.289350509643555
Epoch: 1, Steps: 67 | Train Loss: 31.375 Vali Loss: 21.420 Vali Acc: 0.532 Test Loss: 21.420 Test Acc: 0.532
Validation loss decreased (inf --> -0.531578).  Saving model ...
Epoch: 2 cost time: 30.864043712615967
Epoch: 2, Steps: 67 | Train Loss: 36.329 Vali Loss: 42.472 Vali Acc: 0.561 Test Loss: 42.472 Test Acc: 0.561
Validation loss decreased (-0.531578 --> -0.560269).  Saving model ...
Epoch: 3 cost time: 32.40040826797485
Epoch: 3, Steps: 67 | Train Loss: 10.835 Vali Loss: 12.867 Vali Acc: 0.699 Test Loss: 12.867 Test Acc: 0.699
Validation loss decreased (-0.560269 --> -0.699293).  Saving model ...
Epoch: 4 cost time: 24.301665782928467
Epoch: 4, Steps: 67 | Train Loss: 6.273 Vali Loss: 26.342 Vali Acc: 0.717 Test Loss: 26.342 Test Acc: 0.717
Validation loss decreased (-0.699293 --> -0.716500).  Saving model ...
Epoch: 5 cost time: 24.586122512817383
Epoch: 5, Steps: 67 | Train Loss: 2.377 Vali Loss: 35.414 Vali Acc: 0.740 Test Loss: 35.414 Test Acc: 0.740
Validation loss decreased (-0.716500 --> -0.739530).  Saving model ...
Epoch: 6 cost time: 25.882160663604736
Epoch: 6, Steps: 67 | Train Loss: 4.300 Vali Loss: 23.104 Vali Acc: 0.757 Test Loss: 23.104 Test Acc: 0.757
Validation loss decreased (-0.739530 --> -0.756994).  Saving model ...
Epoch: 7 cost time: 19.750060319900513
Epoch: 7, Steps: 67 | Train Loss: 1.505 Vali Loss: 21.669 Vali Acc: 0.792 Test Loss: 21.669 Test Acc: 0.792
Validation loss decreased (-0.756994 --> -0.791691).  Saving model ...
Epoch: 8 cost time: 28.932734966278076
Epoch: 8, Steps: 67 | Train Loss: 3.407 Vali Loss: 42.633 Vali Acc: 0.682 Test Loss: 42.633 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 27.270186185836792
Epoch: 9, Steps: 67 | Train Loss: 2.220 Vali Loss: 24.672 Vali Acc: 0.757 Test Loss: 24.672 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.759401559829712
Epoch: 10, Steps: 67 | Train Loss: 0.811 Vali Loss: 15.716 Vali Acc: 0.827 Test Loss: 15.716 Test Acc: 0.827
Validation loss decreased (-0.791691 --> -0.826432).  Saving model ...
Epoch: 11 cost time: 27.615408182144165
Epoch: 11, Steps: 67 | Train Loss: 1.475 Vali Loss: 39.536 Vali Acc: 0.728 Test Loss: 39.536 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 23.342339754104614
Epoch: 12, Steps: 67 | Train Loss: 0.335 Vali Loss: 29.176 Vali Acc: 0.780 Test Loss: 29.176 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 28.670793056488037
Epoch: 13, Steps: 67 | Train Loss: 0.080 Vali Loss: 12.064 Vali Acc: 0.850 Test Loss: 12.064 Test Acc: 0.850
Validation loss decreased (-0.826432 --> -0.849590).  Saving model ...
Epoch: 14 cost time: 26.97564721107483
Epoch: 14, Steps: 67 | Train Loss: 0.506 Vali Loss: 30.381 Vali Acc: 0.775 Test Loss: 30.381 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.181612253189087
Epoch: 15, Steps: 67 | Train Loss: 0.741 Vali Loss: 12.860 Vali Acc: 0.832 Test Loss: 12.860 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 22.505033016204834
Epoch: 16, Steps: 67 | Train Loss: 0.202 Vali Loss: 8.971 Vali Acc: 0.798 Test Loss: 8.971 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 30.514763593673706
Epoch: 17, Steps: 67 | Train Loss: 1.169 Vali Loss: 17.709 Vali Acc: 0.798 Test Loss: 17.709 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 35.836692571640015
Epoch: 18, Steps: 67 | Train Loss: 0.985 Vali Loss: 11.642 Vali Acc: 0.815 Test Loss: 11.642 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 26.935808420181274
Epoch: 19, Steps: 67 | Train Loss: 4.379 Vali Loss: 16.347 Vali Acc: 0.775 Test Loss: 16.347 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 19.230164051055908
Epoch: 20, Steps: 67 | Train Loss: 0.637 Vali Loss: 15.335 Vali Acc: 0.751 Test Loss: 15.335 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 22.41637635231018
Epoch: 21, Steps: 67 | Train Loss: 0.272 Vali Loss: 21.314 Vali Acc: 0.717 Test Loss: 21.314 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 30.15227222442627
Epoch: 22, Steps: 67 | Train Loss: 0.305 Vali Loss: 22.236 Vali Acc: 0.769 Test Loss: 22.236 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 28.728371143341064
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 26.627 Vali Acc: 0.780 Test Loss: 26.627 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 15581895
model size : 60.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.039206981658936
Epoch: 1, Steps: 67 | Train Loss: 23.123 Vali Loss: 46.931 Vali Acc: 0.561 Test Loss: 46.931 Test Acc: 0.561
Validation loss decreased (inf --> -0.560224).  Saving model ...
Epoch: 2 cost time: 20.706034660339355
Epoch: 2, Steps: 67 | Train Loss: 16.505 Vali Loss: 30.948 Vali Acc: 0.595 Test Loss: 30.948 Test Acc: 0.595
Validation loss decreased (-0.560224 --> -0.595066).  Saving model ...
Epoch: 3 cost time: 17.868138551712036
Epoch: 3, Steps: 67 | Train Loss: 7.714 Vali Loss: 45.589 Vali Acc: 0.555 Test Loss: 45.589 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.561450242996216
Epoch: 4, Steps: 67 | Train Loss: 4.371 Vali Loss: 16.387 Vali Acc: 0.728 Test Loss: 16.387 Test Acc: 0.728
Validation loss decreased (-0.595066 --> -0.728160).  Saving model ...
Epoch: 5 cost time: 19.99893355369568
Epoch: 5, Steps: 67 | Train Loss: 2.465 Vali Loss: 10.722 Vali Acc: 0.769 Test Loss: 10.722 Test Acc: 0.769
Validation loss decreased (-0.728160 --> -0.768679).  Saving model ...
Epoch: 6 cost time: 15.177261114120483
Epoch: 6, Steps: 67 | Train Loss: 0.284 Vali Loss: 12.411 Vali Acc: 0.769 Test Loss: 12.411 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.00793218612671
Epoch: 7, Steps: 67 | Train Loss: 0.574 Vali Loss: 5.026 Vali Acc: 0.838 Test Loss: 5.026 Test Acc: 0.838
Validation loss decreased (-0.768679 --> -0.838100).  Saving model ...
Epoch: 8 cost time: 20.08535408973694
Epoch: 8, Steps: 67 | Train Loss: 1.285 Vali Loss: 5.627 Vali Acc: 0.850 Test Loss: 5.627 Test Acc: 0.850
Validation loss decreased (-0.838100 --> -0.849655).  Saving model ...
Epoch: 9 cost time: 18.40315556526184
Epoch: 9, Steps: 67 | Train Loss: 0.422 Vali Loss: 5.127 Vali Acc: 0.855 Test Loss: 5.127 Test Acc: 0.855
Validation loss decreased (-0.849655 --> -0.855440).  Saving model ...
Epoch: 10 cost time: 11.41808271408081
Epoch: 10, Steps: 67 | Train Loss: 0.277 Vali Loss: 10.067 Vali Acc: 0.786 Test Loss: 10.067 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.808437824249268
Epoch: 11, Steps: 67 | Train Loss: 0.057 Vali Loss: 11.576 Vali Acc: 0.780 Test Loss: 11.576 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.723973512649536
Epoch: 12, Steps: 67 | Train Loss: 0.515 Vali Loss: 16.315 Vali Acc: 0.757 Test Loss: 16.315 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 20.1490478515625
Epoch: 13, Steps: 67 | Train Loss: 0.312 Vali Loss: 11.097 Vali Acc: 0.769 Test Loss: 11.097 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.289955139160156
Epoch: 14, Steps: 67 | Train Loss: 0.193 Vali Loss: 27.856 Vali Acc: 0.613 Test Loss: 27.856 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 17.61824893951416
Epoch: 15, Steps: 67 | Train Loss: 2.283 Vali Loss: 10.347 Vali Acc: 0.769 Test Loss: 10.347 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 20.59596037864685
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.477 Vali Acc: 0.751 Test Loss: 9.477 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.320839881896973
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.483 Vali Acc: 0.751 Test Loss: 9.483 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 16.738513231277466
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.492 Vali Acc: 0.751 Test Loss: 9.492 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 15.564382791519165
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.486 Vali Acc: 0.751 Test Loss: 9.486 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 10404999
model size : 40.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.974580764770508
Epoch: 1, Steps: 67 | Train Loss: 16.733 Vali Loss: 29.306 Vali Acc: 0.353 Test Loss: 29.306 Test Acc: 0.353
Validation loss decreased (inf --> -0.352308).  Saving model ...
Epoch: 2 cost time: 16.778172254562378
Epoch: 2, Steps: 67 | Train Loss: 16.619 Vali Loss: 13.946 Vali Acc: 0.671 Test Loss: 13.946 Test Acc: 0.671
Validation loss decreased (-0.352308 --> -0.670381).  Saving model ...
Epoch: 3 cost time: 18.62691307067871
Epoch: 3, Steps: 67 | Train Loss: 3.215 Vali Loss: 8.712 Vali Acc: 0.723 Test Loss: 8.712 Test Acc: 0.723
Validation loss decreased (-0.670381 --> -0.722456).  Saving model ...
Epoch: 4 cost time: 16.802836418151855
Epoch: 4, Steps: 67 | Train Loss: 1.801 Vali Loss: 6.848 Vali Acc: 0.746 Test Loss: 6.848 Test Acc: 0.746
Validation loss decreased (-0.722456 --> -0.745596).  Saving model ...
Epoch: 5 cost time: 11.42667841911316
Epoch: 5, Steps: 67 | Train Loss: 0.961 Vali Loss: 6.773 Vali Acc: 0.792 Test Loss: 6.773 Test Acc: 0.792
Validation loss decreased (-0.745596 --> -0.791840).  Saving model ...
Epoch: 6 cost time: 17.4875009059906
Epoch: 6, Steps: 67 | Train Loss: 0.458 Vali Loss: 15.728 Vali Acc: 0.740 Test Loss: 15.728 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.793384313583374
Epoch: 7, Steps: 67 | Train Loss: 0.230 Vali Loss: 7.064 Vali Acc: 0.803 Test Loss: 7.064 Test Acc: 0.803
Validation loss decreased (-0.791840 --> -0.803398).  Saving model ...
Epoch: 8 cost time: 18.53219962120056
Epoch: 8, Steps: 67 | Train Loss: 0.180 Vali Loss: 6.220 Vali Acc: 0.775 Test Loss: 6.220 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.22322416305542
Epoch: 9, Steps: 67 | Train Loss: 0.110 Vali Loss: 9.169 Vali Acc: 0.780 Test Loss: 9.169 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.278854131698608
Epoch: 10, Steps: 67 | Train Loss: 0.089 Vali Loss: 9.145 Vali Acc: 0.717 Test Loss: 9.145 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.574556112289429
Epoch: 11, Steps: 67 | Train Loss: 0.522 Vali Loss: 8.765 Vali Acc: 0.711 Test Loss: 8.765 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.957488298416138
Epoch: 12, Steps: 67 | Train Loss: 1.185 Vali Loss: 21.566 Vali Acc: 0.520 Test Loss: 21.566 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.27243947982788
Epoch: 13, Steps: 67 | Train Loss: 0.443 Vali Loss: 5.004 Vali Acc: 0.803 Test Loss: 5.004 Test Acc: 0.803
Validation loss decreased (-0.803398 --> -0.803418).  Saving model ...
Epoch: 14 cost time: 11.70442819595337
Epoch: 14, Steps: 67 | Train Loss: 0.434 Vali Loss: 5.373 Vali Acc: 0.751 Test Loss: 5.373 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.693705081939697
Epoch: 15, Steps: 67 | Train Loss: 0.139 Vali Loss: 5.366 Vali Acc: 0.775 Test Loss: 5.366 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 18.315292358398438
Epoch: 16, Steps: 67 | Train Loss: 0.197 Vali Loss: 7.652 Vali Acc: 0.751 Test Loss: 7.652 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 15.29042387008667
Epoch: 17, Steps: 67 | Train Loss: 0.254 Vali Loss: 10.552 Vali Acc: 0.711 Test Loss: 10.552 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.682515859603882
Epoch: 18, Steps: 67 | Train Loss: 0.652 Vali Loss: 18.834 Vali Acc: 0.746 Test Loss: 18.834 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 19.05402445793152
Epoch: 19, Steps: 67 | Train Loss: 1.153 Vali Loss: 9.943 Vali Acc: 0.780 Test Loss: 9.943 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.850248575210571
Epoch: 20, Steps: 67 | Train Loss: 1.111 Vali Loss: 13.107 Vali Acc: 0.740 Test Loss: 13.107 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 18.3779034614563
Epoch: 21, Steps: 67 | Train Loss: 0.139 Vali Loss: 8.541 Vali Acc: 0.792 Test Loss: 8.541 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 12.503147840499878
Epoch: 22, Steps: 67 | Train Loss: 0.220 Vali Loss: 9.348 Vali Acc: 0.780 Test Loss: 9.348 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.87405753135681
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.718 Vali Acc: 0.775 Test Loss: 9.718 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 7816711
model size : 31.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.303935050964355
Epoch: 1, Steps: 67 | Train Loss: 12.662 Vali Loss: 9.977 Vali Acc: 0.497 Test Loss: 9.977 Test Acc: 0.497
Validation loss decreased (inf --> -0.497010).  Saving model ...
Epoch: 2 cost time: 11.51563310623169
Epoch: 2, Steps: 67 | Train Loss: 9.964 Vali Loss: 16.602 Vali Acc: 0.543 Test Loss: 16.602 Test Acc: 0.543
Validation loss decreased (-0.497010 --> -0.543187).  Saving model ...
Epoch: 3 cost time: 8.064813375473022
Epoch: 3, Steps: 67 | Train Loss: 4.360 Vali Loss: 3.007 Vali Acc: 0.734 Test Loss: 3.007 Test Acc: 0.734
Validation loss decreased (-0.543187 --> -0.734074).  Saving model ...
Epoch: 4 cost time: 11.399159669876099
Epoch: 4, Steps: 67 | Train Loss: 1.104 Vali Loss: 10.203 Vali Acc: 0.682 Test Loss: 10.203 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.5908308029174805
Epoch: 5, Steps: 67 | Train Loss: 1.176 Vali Loss: 11.336 Vali Acc: 0.723 Test Loss: 11.336 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.7633376121521
Epoch: 6, Steps: 67 | Train Loss: 1.123 Vali Loss: 7.024 Vali Acc: 0.780 Test Loss: 7.024 Test Acc: 0.780
Validation loss decreased (-0.734074 --> -0.780277).  Saving model ...
Epoch: 7 cost time: 9.997708797454834
Epoch: 7, Steps: 67 | Train Loss: 0.085 Vali Loss: 8.261 Vali Acc: 0.775 Test Loss: 8.261 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.88689112663269
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.909 Vali Acc: 0.780 Test Loss: 7.909 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.886990785598755
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.206 Vali Acc: 0.792 Test Loss: 7.206 Test Acc: 0.792
Validation loss decreased (-0.780277 --> -0.791835).  Saving model ...
Epoch: 10 cost time: 10.1404869556427
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.204 Vali Acc: 0.792 Test Loss: 7.204 Test Acc: 0.792
Validation loss decreased (-0.791835 --> -0.791835).  Saving model ...
Epoch: 11 cost time: 15.96751356124878
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.192 Vali Acc: 0.792 Test Loss: 7.192 Test Acc: 0.792
Validation loss decreased (-0.791835 --> -0.791836).  Saving model ...
Epoch: 12 cost time: 9.03209900856018
Epoch: 12, Steps: 67 | Train Loss: 0.096 Vali Loss: 5.448 Vali Acc: 0.798 Test Loss: 5.448 Test Acc: 0.798
Validation loss decreased (-0.791836 --> -0.797633).  Saving model ...
Epoch: 13 cost time: 11.91267204284668
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.492 Vali Acc: 0.798 Test Loss: 5.492 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.743214130401611
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.484 Vali Acc: 0.798 Test Loss: 5.484 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.373292207717896
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.489 Vali Acc: 0.798 Test Loss: 5.489 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.230839967727661
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.476 Vali Acc: 0.798 Test Loss: 5.476 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.099401950836182
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.481 Vali Acc: 0.798 Test Loss: 5.481 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.664388418197632
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.492 Vali Acc: 0.798 Test Loss: 5.492 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.257415771484375
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.485 Vali Acc: 0.798 Test Loss: 5.485 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 13.862255811691284
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.479 Vali Acc: 0.798 Test Loss: 5.479 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.269182205200195
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.473 Vali Acc: 0.798 Test Loss: 5.473 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.21524429321289
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.486 Vali Acc: 0.798 Test Loss: 5.486 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 5660039
model size : 22.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.306796073913574
Epoch: 1, Steps: 67 | Train Loss: 8.488 Vali Loss: 10.891 Vali Acc: 0.410 Test Loss: 10.891 Test Acc: 0.410
Validation loss decreased (inf --> -0.410296).  Saving model ...
Epoch: 2 cost time: 6.403242111206055
Epoch: 2, Steps: 67 | Train Loss: 4.871 Vali Loss: 5.072 Vali Acc: 0.659 Test Loss: 5.072 Test Acc: 0.659
Validation loss decreased (-0.410296 --> -0.658909).  Saving model ...
Epoch: 3 cost time: 9.022801399230957
Epoch: 3, Steps: 67 | Train Loss: 2.473 Vali Loss: 7.515 Vali Acc: 0.671 Test Loss: 7.515 Test Acc: 0.671
Validation loss decreased (-0.658909 --> -0.670445).  Saving model ...
Epoch: 4 cost time: 10.972292423248291
Epoch: 4, Steps: 67 | Train Loss: 0.494 Vali Loss: 7.936 Vali Acc: 0.746 Test Loss: 7.936 Test Acc: 0.746
Validation loss decreased (-0.670445 --> -0.745585).  Saving model ...
Epoch: 5 cost time: 10.640618801116943
Epoch: 5, Steps: 67 | Train Loss: 0.720 Vali Loss: 6.689 Vali Acc: 0.699 Test Loss: 6.689 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.988948822021484
Epoch: 6, Steps: 67 | Train Loss: 0.444 Vali Loss: 7.608 Vali Acc: 0.734 Test Loss: 7.608 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.755599021911621
Epoch: 7, Steps: 67 | Train Loss: 0.262 Vali Loss: 4.333 Vali Acc: 0.763 Test Loss: 4.333 Test Acc: 0.763
Validation loss decreased (-0.745585 --> -0.762962).  Saving model ...
Epoch: 8 cost time: 8.964183330535889
Epoch: 8, Steps: 67 | Train Loss: 0.170 Vali Loss: 1.704 Vali Acc: 0.827 Test Loss: 1.704 Test Acc: 0.827
Validation loss decreased (-0.762962 --> -0.826573).  Saving model ...
Epoch: 9 cost time: 11.02839708328247
Epoch: 9, Steps: 67 | Train Loss: 0.151 Vali Loss: 5.471 Vali Acc: 0.769 Test Loss: 5.471 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.239213466644287
Epoch: 10, Steps: 67 | Train Loss: 0.052 Vali Loss: 4.092 Vali Acc: 0.786 Test Loss: 4.092 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.509033441543579
Epoch: 11, Steps: 67 | Train Loss: 0.050 Vali Loss: 4.391 Vali Acc: 0.792 Test Loss: 4.391 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.321943759918213
Epoch: 12, Steps: 67 | Train Loss: 0.124 Vali Loss: 4.345 Vali Acc: 0.734 Test Loss: 4.345 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 13.54267692565918
Epoch: 13, Steps: 67 | Train Loss: 0.152 Vali Loss: 4.498 Vali Acc: 0.786 Test Loss: 4.498 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.957768440246582
Epoch: 14, Steps: 67 | Train Loss: 0.414 Vali Loss: 5.074 Vali Acc: 0.769 Test Loss: 5.074 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 12.859833478927612
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.904 Vali Acc: 0.757 Test Loss: 3.904 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.373517513275146
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.926 Vali Acc: 0.757 Test Loss: 3.926 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 12.636408567428589
Epoch: 17, Steps: 67 | Train Loss: 0.040 Vali Loss: 4.926 Vali Acc: 0.746 Test Loss: 4.926 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.39280080795288
Epoch: 18, Steps: 67 | Train Loss: 0.212 Vali Loss: 4.998 Vali Acc: 0.769 Test Loss: 4.998 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3934791
model size : 16.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.613335847854614
Epoch: 1, Steps: 67 | Train Loss: 6.320 Vali Loss: 10.927 Vali Acc: 0.491 Test Loss: 10.927 Test Acc: 0.491
Validation loss decreased (inf --> -0.491220).  Saving model ...
Epoch: 2 cost time: 6.737063407897949
Epoch: 2, Steps: 67 | Train Loss: 3.975 Vali Loss: 3.548 Vali Acc: 0.682 Test Loss: 3.548 Test Acc: 0.682
Validation loss decreased (-0.491220 --> -0.682045).  Saving model ...
Epoch: 3 cost time: 7.489699602127075
Epoch: 3, Steps: 67 | Train Loss: 1.462 Vali Loss: 4.215 Vali Acc: 0.740 Test Loss: 4.215 Test Acc: 0.740
Validation loss decreased (-0.682045 --> -0.739842).  Saving model ...
Epoch: 4 cost time: 5.336367845535278
Epoch: 4, Steps: 67 | Train Loss: 1.004 Vali Loss: 5.089 Vali Acc: 0.746 Test Loss: 5.089 Test Acc: 0.746
Validation loss decreased (-0.739842 --> -0.745614).  Saving model ...
Epoch: 5 cost time: 4.529968738555908
Epoch: 5, Steps: 67 | Train Loss: 1.052 Vali Loss: 5.177 Vali Acc: 0.763 Test Loss: 5.177 Test Acc: 0.763
Validation loss decreased (-0.745614 --> -0.762954).  Saving model ...
Epoch: 6 cost time: 8.872379302978516
Epoch: 6, Steps: 67 | Train Loss: 0.667 Vali Loss: 4.422 Vali Acc: 0.763 Test Loss: 4.422 Test Acc: 0.763
Validation loss decreased (-0.762954 --> -0.762962).  Saving model ...
Epoch: 7 cost time: 5.797402381896973
Epoch: 7, Steps: 67 | Train Loss: 0.389 Vali Loss: 4.912 Vali Acc: 0.798 Test Loss: 4.912 Test Acc: 0.798
Validation loss decreased (-0.762962 --> -0.797639).  Saving model ...
Epoch: 8 cost time: 6.318396806716919
Epoch: 8, Steps: 67 | Train Loss: 0.419 Vali Loss: 4.877 Vali Acc: 0.803 Test Loss: 4.877 Test Acc: 0.803
Validation loss decreased (-0.797639 --> -0.803419).  Saving model ...
Epoch: 9 cost time: 9.758527994155884
Epoch: 9, Steps: 67 | Train Loss: 0.057 Vali Loss: 4.152 Vali Acc: 0.827 Test Loss: 4.152 Test Acc: 0.827
Validation loss decreased (-0.803419 --> -0.826548).  Saving model ...
Epoch: 10 cost time: 7.054656028747559
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.345 Vali Acc: 0.815 Test Loss: 4.345 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.296802759170532
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.340 Vali Acc: 0.815 Test Loss: 4.340 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.467312812805176
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.346 Vali Acc: 0.815 Test Loss: 4.346 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.056394815444946
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.344 Vali Acc: 0.815 Test Loss: 4.344 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.954957246780396
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.341 Vali Acc: 0.815 Test Loss: 4.341 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.389239072799683
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.344 Vali Acc: 0.815 Test Loss: 4.344 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.448181867599487
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.344 Vali Acc: 0.815 Test Loss: 4.344 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.00727653503418
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.341 Vali Acc: 0.815 Test Loss: 4.341 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.277359485626221
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.348 Vali Acc: 0.815 Test Loss: 4.348 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.18693494796753
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.346 Vali Acc: 0.815 Test Loss: 4.346 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3503815
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 502.3090210
	speed: 0.3875s/iter; left time: 5154.4241s
Epoch: 1 cost time: 57.10225868225098
Epoch: 1, Steps: 134 | Train Loss: 186.117 Vali Loss: 199.589 Vali Acc: 0.416 Test Loss: 199.589 Test Acc: 0.416
Validation loss decreased (inf --> -0.414189).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.8900s/iter; left time: 11718.2069s
Epoch: 2 cost time: 48.41080641746521
Epoch: 2, Steps: 134 | Train Loss: 135.608 Vali Loss: 44.341 Vali Acc: 0.711 Test Loss: 44.341 Test Acc: 0.711
Validation loss decreased (-0.414189 --> -0.710539).  Saving model ...
	iters: 100, epoch: 3 | loss: 19.1544342
	speed: 0.9419s/iter; left time: 12276.3261s
Epoch: 3 cost time: 54.61744046211243
Epoch: 3, Steps: 134 | Train Loss: 8.103 Vali Loss: 46.434 Vali Acc: 0.671 Test Loss: 46.434 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.9445s/iter; left time: 12183.4854s
Epoch: 4 cost time: 53.651657581329346
Epoch: 4, Steps: 134 | Train Loss: 1.288 Vali Loss: 20.424 Vali Acc: 0.763 Test Loss: 20.424 Test Acc: 0.763
Validation loss decreased (-0.710539 --> -0.762802).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.8272s/iter; left time: 10558.8893s
Epoch: 5 cost time: 51.25140142440796
Epoch: 5, Steps: 134 | Train Loss: 4.269 Vali Loss: 15.030 Vali Acc: 0.757 Test Loss: 15.030 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.9793s/iter; left time: 12369.9550s
Epoch: 6 cost time: 60.978431701660156
Epoch: 6, Steps: 134 | Train Loss: 0.720 Vali Loss: 9.495 Vali Acc: 0.832 Test Loss: 9.495 Test Acc: 0.832
Validation loss decreased (-0.762802 --> -0.832275).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7847s/iter; left time: 9805.9519s
Epoch: 7 cost time: 41.59194588661194
Epoch: 7, Steps: 134 | Train Loss: 1.320 Vali Loss: 29.435 Vali Acc: 0.676 Test Loss: 29.435 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7340s/iter; left time: 9074.5533s
Epoch: 8 cost time: 45.21579122543335
Epoch: 8, Steps: 134 | Train Loss: 1.225 Vali Loss: 31.934 Vali Acc: 0.705 Test Loss: 31.934 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.9387s/iter; left time: 11479.7570s
Epoch: 9 cost time: 56.90827560424805
Epoch: 9, Steps: 134 | Train Loss: 0.174 Vali Loss: 22.206 Vali Acc: 0.751 Test Loss: 22.206 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.8745s/iter; left time: 10577.3862s
Epoch: 10 cost time: 47.326699018478394
Epoch: 10, Steps: 134 | Train Loss: 2.000 Vali Loss: 23.771 Vali Acc: 0.676 Test Loss: 23.771 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.8863s/iter; left time: 10600.9338s
Epoch: 11 cost time: 59.05517244338989
Epoch: 11, Steps: 134 | Train Loss: 2.273 Vali Loss: 51.948 Vali Acc: 0.520 Test Loss: 51.948 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.8889s/iter; left time: 10512.6127s
Epoch: 12 cost time: 53.57306361198425
Epoch: 12, Steps: 134 | Train Loss: 1.876 Vali Loss: 22.708 Vali Acc: 0.769 Test Loss: 22.708 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7250s/iter; left time: 8477.5980s
Epoch: 13 cost time: 40.34686255455017
Epoch: 13, Steps: 134 | Train Loss: 0.224 Vali Loss: 11.197 Vali Acc: 0.832 Test Loss: 11.197 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.9874s/iter; left time: 11413.3709s
Epoch: 14 cost time: 58.42855429649353
Epoch: 14, Steps: 134 | Train Loss: 0.372 Vali Loss: 28.470 Vali Acc: 0.786 Test Loss: 28.470 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.9077s/iter; left time: 10370.7105s
Epoch: 15 cost time: 50.09801888465881
Epoch: 15, Steps: 134 | Train Loss: 0.792 Vali Loss: 22.321 Vali Acc: 0.855 Test Loss: 22.321 Test Acc: 0.855
Validation loss decreased (-0.832275 --> -0.855268).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.9355s/iter; left time: 10563.0095s
Epoch: 16 cost time: 53.5598361492157
Epoch: 16, Steps: 134 | Train Loss: 0.021 Vali Loss: 23.054 Vali Acc: 0.798 Test Loss: 23.054 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.9188s/iter; left time: 10250.6686s
Epoch: 17 cost time: 59.099725008010864
Epoch: 17, Steps: 134 | Train Loss: 0.942 Vali Loss: 45.559 Vali Acc: 0.723 Test Loss: 45.559 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.9410s/iter; left time: 10372.9180s
Epoch: 18 cost time: 59.416276693344116
Epoch: 18, Steps: 134 | Train Loss: 0.715 Vali Loss: 28.069 Vali Acc: 0.665 Test Loss: 28.069 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.9828s/iter; left time: 10701.6299s
Epoch: 19 cost time: 58.22725486755371
Epoch: 19, Steps: 134 | Train Loss: 0.504 Vali Loss: 25.260 Vali Acc: 0.815 Test Loss: 25.260 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.8243s/iter; left time: 8865.1463s
Epoch: 20 cost time: 50.325368881225586
Epoch: 20, Steps: 134 | Train Loss: 0.324 Vali Loss: 21.110 Vali Acc: 0.728 Test Loss: 21.110 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.9887s/iter; left time: 10501.1563s
Epoch: 21 cost time: 63.29968786239624
Epoch: 21, Steps: 134 | Train Loss: 1.028 Vali Loss: 56.879 Vali Acc: 0.653 Test Loss: 56.879 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.8223s/iter; left time: 8623.2065s
Epoch: 22 cost time: 42.805931091308594
Epoch: 22, Steps: 134 | Train Loss: 4.430 Vali Loss: 35.678 Vali Acc: 0.717 Test Loss: 35.678 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.9868s/iter; left time: 10216.8476s
Epoch: 23 cost time: 59.968106508255005
Epoch: 23, Steps: 134 | Train Loss: 0.706 Vali Loss: 43.125 Vali Acc: 0.624 Test Loss: 43.125 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.9063s/iter; left time: 9261.1277s
Epoch: 24 cost time: 47.57466912269592
Epoch: 24, Steps: 134 | Train Loss: 0.379 Vali Loss: 31.978 Vali Acc: 0.746 Test Loss: 31.978 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.9100s/iter; left time: 9177.0289s
Epoch: 25 cost time: 58.941001653671265
Epoch: 25, Steps: 134 | Train Loss: 0.930 Vali Loss: 41.070 Vali Acc: 0.671 Test Loss: 41.070 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 31096391
model size : 119.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 18.2119140625
Epoch: 1, Steps: 67 | Train Loss: 38.566 Vali Loss: 84.247 Vali Acc: 0.422 Test Loss: 84.247 Test Acc: 0.422
Validation loss decreased (inf --> -0.421123).  Saving model ...
Epoch: 2 cost time: 28.211892127990723
Epoch: 2, Steps: 67 | Train Loss: 60.205 Vali Loss: 64.039 Vali Acc: 0.590 Test Loss: 64.039 Test Acc: 0.590
Validation loss decreased (-0.421123 --> -0.588955).  Saving model ...
Epoch: 3 cost time: 30.692850828170776
Epoch: 3, Steps: 67 | Train Loss: 26.749 Vali Loss: 36.726 Vali Acc: 0.613 Test Loss: 36.726 Test Acc: 0.613
Validation loss decreased (-0.588955 --> -0.612350).  Saving model ...
Epoch: 4 cost time: 15.121068477630615
Epoch: 4, Steps: 67 | Train Loss: 4.580 Vali Loss: 17.465 Vali Acc: 0.763 Test Loss: 17.465 Test Acc: 0.763
Validation loss decreased (-0.612350 --> -0.762831).  Saving model ...
Epoch: 5 cost time: 16.10019302368164
Epoch: 5, Steps: 67 | Train Loss: 1.604 Vali Loss: 10.706 Vali Acc: 0.734 Test Loss: 10.706 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.73133611679077
Epoch: 6, Steps: 67 | Train Loss: 10.185 Vali Loss: 52.980 Vali Acc: 0.653 Test Loss: 52.980 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.557482957839966
Epoch: 7, Steps: 67 | Train Loss: 3.862 Vali Loss: 17.918 Vali Acc: 0.751 Test Loss: 17.918 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 22.112682580947876
Epoch: 8, Steps: 67 | Train Loss: 2.462 Vali Loss: 8.933 Vali Acc: 0.815 Test Loss: 8.933 Test Acc: 0.815
Validation loss decreased (-0.762831 --> -0.814940).  Saving model ...
Epoch: 9 cost time: 27.504899501800537
Epoch: 9, Steps: 67 | Train Loss: 0.981 Vali Loss: 11.564 Vali Acc: 0.815 Test Loss: 11.564 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 24.85297465324402
Epoch: 10, Steps: 67 | Train Loss: 1.176 Vali Loss: 26.888 Vali Acc: 0.647 Test Loss: 26.888 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 25.15012526512146
Epoch: 11, Steps: 67 | Train Loss: 0.308 Vali Loss: 21.260 Vali Acc: 0.769 Test Loss: 21.260 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 20.55685305595398
Epoch: 12, Steps: 67 | Train Loss: 0.066 Vali Loss: 10.736 Vali Acc: 0.838 Test Loss: 10.736 Test Acc: 0.838
Validation loss decreased (-0.814940 --> -0.838043).  Saving model ...
Epoch: 13 cost time: 27.88632845878601
Epoch: 13, Steps: 67 | Train Loss: 0.032 Vali Loss: 11.901 Vali Acc: 0.809 Test Loss: 11.901 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.03218364715576
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.999 Vali Acc: 0.815 Test Loss: 11.999 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.908780813217163
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.996 Vali Acc: 0.815 Test Loss: 11.996 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 18.616830110549927
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.941 Vali Acc: 0.815 Test Loss: 11.941 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.889304637908936
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.968 Vali Acc: 0.815 Test Loss: 11.968 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 18.222304105758667
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.972 Vali Acc: 0.815 Test Loss: 11.972 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 24.97423219680786
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.986 Vali Acc: 0.815 Test Loss: 11.986 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 21.153210163116455
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.969 Vali Acc: 0.815 Test Loss: 11.969 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 20.129777908325195
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.941 Vali Acc: 0.815 Test Loss: 11.941 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 21.94715118408203
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.966 Vali Acc: 0.815 Test Loss: 11.966 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 15565383
model size : 60.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.164917945861816
Epoch: 1, Steps: 67 | Train Loss: 28.634 Vali Loss: 15.122 Vali Acc: 0.584 Test Loss: 15.122 Test Acc: 0.584
Validation loss decreased (inf --> -0.583664).  Saving model ...
Epoch: 2 cost time: 12.297783851623535
Epoch: 2, Steps: 67 | Train Loss: 17.965 Vali Loss: 14.793 Vali Acc: 0.705 Test Loss: 14.793 Test Acc: 0.705
Validation loss decreased (-0.583664 --> -0.705054).  Saving model ...
Epoch: 3 cost time: 16.5571346282959
Epoch: 3, Steps: 67 | Train Loss: 10.057 Vali Loss: 12.264 Vali Acc: 0.688 Test Loss: 12.264 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.884622573852539
Epoch: 4, Steps: 67 | Train Loss: 4.807 Vali Loss: 18.101 Vali Acc: 0.763 Test Loss: 18.101 Test Acc: 0.763
Validation loss decreased (-0.705054 --> -0.762825).  Saving model ...
Epoch: 5 cost time: 14.13429045677185
Epoch: 5, Steps: 67 | Train Loss: 2.760 Vali Loss: 20.153 Vali Acc: 0.723 Test Loss: 20.153 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.47746253013611
Epoch: 6, Steps: 67 | Train Loss: 1.998 Vali Loss: 10.713 Vali Acc: 0.757 Test Loss: 10.713 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.526999473571777
Epoch: 7, Steps: 67 | Train Loss: 1.225 Vali Loss: 21.839 Vali Acc: 0.746 Test Loss: 21.839 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.650594711303711
Epoch: 8, Steps: 67 | Train Loss: 0.886 Vali Loss: 9.341 Vali Acc: 0.821 Test Loss: 9.341 Test Acc: 0.821
Validation loss decreased (-0.762825 --> -0.820716).  Saving model ...
Epoch: 9 cost time: 16.956809282302856
Epoch: 9, Steps: 67 | Train Loss: 0.202 Vali Loss: 12.699 Vali Acc: 0.769 Test Loss: 12.699 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.221749067306519
Epoch: 10, Steps: 67 | Train Loss: 0.886 Vali Loss: 15.502 Vali Acc: 0.809 Test Loss: 15.502 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 18.043715476989746
Epoch: 11, Steps: 67 | Train Loss: 0.305 Vali Loss: 15.474 Vali Acc: 0.775 Test Loss: 15.474 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.844810009002686
Epoch: 12, Steps: 67 | Train Loss: 0.959 Vali Loss: 25.214 Vali Acc: 0.682 Test Loss: 25.214 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 12.075014352798462
Epoch: 13, Steps: 67 | Train Loss: 0.814 Vali Loss: 24.564 Vali Acc: 0.694 Test Loss: 24.564 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 19.111549854278564
Epoch: 14, Steps: 67 | Train Loss: 0.505 Vali Loss: 20.642 Vali Acc: 0.751 Test Loss: 20.642 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.50101590156555
Epoch: 15, Steps: 67 | Train Loss: 0.640 Vali Loss: 34.021 Vali Acc: 0.705 Test Loss: 34.021 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 15.906805992126465
Epoch: 16, Steps: 67 | Train Loss: 0.304 Vali Loss: 9.238 Vali Acc: 0.827 Test Loss: 9.238 Test Acc: 0.827
Validation loss decreased (-0.820716 --> -0.826497).  Saving model ...
Epoch: 17 cost time: 13.825798749923706
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.034 Vali Acc: 0.803 Test Loss: 8.034 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.779214143753052
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.021 Vali Acc: 0.803 Test Loss: 8.021 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.35754895210266
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.029 Vali Acc: 0.803 Test Loss: 8.029 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.721965551376343
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.023 Vali Acc: 0.803 Test Loss: 8.023 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.58981490135193
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.036 Vali Acc: 0.803 Test Loss: 8.036 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 18.216282844543457
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.032 Vali Acc: 0.803 Test Loss: 8.032 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 17.468897819519043
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.034 Vali Acc: 0.803 Test Loss: 8.034 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 14.829859972000122
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.022 Vali Acc: 0.803 Test Loss: 8.022 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.589735507965088
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.030 Vali Acc: 0.803 Test Loss: 8.030 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 13.392847061157227
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.024 Vali Acc: 0.803 Test Loss: 8.024 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 10388487
model size : 40.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 15.555290699005127
Epoch: 1, Steps: 67 | Train Loss: 21.960 Vali Loss: 41.303 Vali Acc: 0.382 Test Loss: 41.303 Test Acc: 0.382
Validation loss decreased (inf --> -0.381090).  Saving model ...
Epoch: 2 cost time: 14.459563732147217
Epoch: 2, Steps: 67 | Train Loss: 20.557 Vali Loss: 18.706 Vali Acc: 0.578 Test Loss: 18.706 Test Acc: 0.578
Validation loss decreased (-0.381090 --> -0.577848).  Saving model ...
Epoch: 3 cost time: 9.8870689868927
Epoch: 3, Steps: 67 | Train Loss: 6.549 Vali Loss: 10.245 Vali Acc: 0.682 Test Loss: 10.245 Test Acc: 0.682
Validation loss decreased (-0.577848 --> -0.681978).  Saving model ...
Epoch: 4 cost time: 16.59709405899048
Epoch: 4, Steps: 67 | Train Loss: 2.303 Vali Loss: 4.959 Vali Acc: 0.757 Test Loss: 4.959 Test Acc: 0.757
Validation loss decreased (-0.681978 --> -0.757176).  Saving model ...
Epoch: 5 cost time: 12.48028039932251
Epoch: 5, Steps: 67 | Train Loss: 0.747 Vali Loss: 31.730 Vali Acc: 0.578 Test Loss: 31.730 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.291240215301514
Epoch: 6, Steps: 67 | Train Loss: 3.100 Vali Loss: 3.662 Vali Acc: 0.775 Test Loss: 3.662 Test Acc: 0.775
Validation loss decreased (-0.757176 --> -0.774530).  Saving model ...
Epoch: 7 cost time: 18.437355041503906
Epoch: 7, Steps: 67 | Train Loss: 0.375 Vali Loss: 9.139 Vali Acc: 0.786 Test Loss: 9.139 Test Acc: 0.786
Validation loss decreased (-0.774530 --> -0.786036).  Saving model ...
Epoch: 8 cost time: 11.42223858833313
Epoch: 8, Steps: 67 | Train Loss: 0.321 Vali Loss: 17.891 Vali Acc: 0.647 Test Loss: 17.891 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.427525043487549
Epoch: 9, Steps: 67 | Train Loss: 0.490 Vali Loss: 9.882 Vali Acc: 0.740 Test Loss: 9.882 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.374990463256836
Epoch: 10, Steps: 67 | Train Loss: 0.154 Vali Loss: 5.955 Vali Acc: 0.775 Test Loss: 5.955 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.468325853347778
Epoch: 11, Steps: 67 | Train Loss: 0.190 Vali Loss: 6.337 Vali Acc: 0.775 Test Loss: 6.337 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.325461626052856
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 9.108 Vali Acc: 0.751 Test Loss: 9.108 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.054949283599854
Epoch: 13, Steps: 67 | Train Loss: 0.234 Vali Loss: 8.579 Vali Acc: 0.792 Test Loss: 8.579 Test Acc: 0.792
Validation loss decreased (-0.786036 --> -0.791822).  Saving model ...
Epoch: 14 cost time: 11.714687585830688
Epoch: 14, Steps: 67 | Train Loss: 0.345 Vali Loss: 9.517 Vali Acc: 0.740 Test Loss: 9.517 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.7928946018219
Epoch: 15, Steps: 67 | Train Loss: 0.483 Vali Loss: 7.093 Vali Acc: 0.734 Test Loss: 7.093 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.723138809204102
Epoch: 16, Steps: 67 | Train Loss: 0.055 Vali Loss: 11.768 Vali Acc: 0.642 Test Loss: 11.768 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.434550762176514
Epoch: 17, Steps: 67 | Train Loss: 0.276 Vali Loss: 10.679 Vali Acc: 0.740 Test Loss: 10.679 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.090798377990723
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.417 Vali Acc: 0.792 Test Loss: 5.417 Test Acc: 0.792
Validation loss decreased (-0.791822 --> -0.791853).  Saving model ...
Epoch: 19 cost time: 14.706980466842651
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.357 Vali Acc: 0.792 Test Loss: 5.357 Test Acc: 0.792
Validation loss decreased (-0.791853 --> -0.791854).  Saving model ...
Epoch: 20 cost time: 16.140113592147827
Epoch: 20, Steps: 67 | Train Loss: 2.625 Vali Loss: 24.804 Vali Acc: 0.671 Test Loss: 24.804 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.78975772857666
Epoch: 21, Steps: 67 | Train Loss: 1.866 Vali Loss: 8.225 Vali Acc: 0.798 Test Loss: 8.225 Test Acc: 0.798
Validation loss decreased (-0.791854 --> -0.797606).  Saving model ...
Epoch: 22 cost time: 17.110435009002686
Epoch: 22, Steps: 67 | Train Loss: 0.105 Vali Loss: 6.719 Vali Acc: 0.815 Test Loss: 6.719 Test Acc: 0.815
Validation loss decreased (-0.797606 --> -0.814962).  Saving model ...
Epoch: 23 cost time: 11.196830034255981
Epoch: 23, Steps: 67 | Train Loss: 0.183 Vali Loss: 9.929 Vali Acc: 0.786 Test Loss: 9.929 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 15.868246078491211
Epoch: 24, Steps: 67 | Train Loss: 0.129 Vali Loss: 9.401 Vali Acc: 0.763 Test Loss: 9.401 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 10.890665292739868
Epoch: 25, Steps: 67 | Train Loss: 0.148 Vali Loss: 13.003 Vali Acc: 0.780 Test Loss: 13.003 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 14.389799118041992
Epoch: 26, Steps: 67 | Train Loss: 0.246 Vali Loss: 13.431 Vali Acc: 0.751 Test Loss: 13.431 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 10.882066249847412
Epoch: 27, Steps: 67 | Train Loss: 0.525 Vali Loss: 13.722 Vali Acc: 0.803 Test Loss: 13.722 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 17.725525856018066
Epoch: 28, Steps: 67 | Train Loss: 0.376 Vali Loss: 12.250 Vali Acc: 0.844 Test Loss: 12.250 Test Acc: 0.844
Validation loss decreased (-0.814962 --> -0.843808).  Saving model ...
Epoch: 29 cost time: 9.876912832260132
Epoch: 29, Steps: 67 | Train Loss: 0.178 Vali Loss: 10.150 Vali Acc: 0.815 Test Loss: 10.150 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 15.277695655822754
Epoch: 30, Steps: 67 | Train Loss: 0.029 Vali Loss: 13.505 Vali Acc: 0.798 Test Loss: 13.505 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 13.561853885650635
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 14.832 Vali Acc: 0.798 Test Loss: 14.832 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 14.003645658493042
Epoch: 32, Steps: 67 | Train Loss: 0.085 Vali Loss: 16.086 Vali Acc: 0.775 Test Loss: 16.086 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 10.604184865951538
Epoch: 33, Steps: 67 | Train Loss: 1.074 Vali Loss: 23.465 Vali Acc: 0.671 Test Loss: 23.465 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 14.974095582962036
Epoch: 34, Steps: 67 | Train Loss: 0.742 Vali Loss: 23.990 Vali Acc: 0.780 Test Loss: 23.990 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 10.550269603729248
Epoch: 35, Steps: 67 | Train Loss: 0.333 Vali Loss: 35.218 Vali Acc: 0.717 Test Loss: 35.218 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 12.296995639801025
Epoch: 36, Steps: 67 | Train Loss: 0.461 Vali Loss: 34.430 Vali Acc: 0.746 Test Loss: 34.430 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 12.176398754119873
Epoch: 37, Steps: 67 | Train Loss: 0.881 Vali Loss: 10.665 Vali Acc: 0.821 Test Loss: 10.665 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 10.57425570487976
Epoch: 38, Steps: 67 | Train Loss: 0.056 Vali Loss: 21.234 Vali Acc: 0.763 Test Loss: 21.234 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 7800199
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.60693645477295
Epoch: 1, Steps: 67 | Train Loss: 15.498 Vali Loss: 11.520 Vali Acc: 0.613 Test Loss: 11.520 Test Acc: 0.613
Validation loss decreased (inf --> -0.612602).  Saving model ...
Epoch: 2 cost time: 9.0023775100708
Epoch: 2, Steps: 67 | Train Loss: 9.037 Vali Loss: 14.745 Vali Acc: 0.601 Test Loss: 14.745 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.415015697479248
Epoch: 3, Steps: 67 | Train Loss: 3.416 Vali Loss: 10.057 Vali Acc: 0.734 Test Loss: 10.057 Test Acc: 0.734
Validation loss decreased (-0.612602 --> -0.734003).  Saving model ...
Epoch: 4 cost time: 8.369018316268921
Epoch: 4, Steps: 67 | Train Loss: 2.066 Vali Loss: 10.720 Vali Acc: 0.757 Test Loss: 10.720 Test Acc: 0.757
Validation loss decreased (-0.734003 --> -0.757118).  Saving model ...
Epoch: 5 cost time: 12.557548761367798
Epoch: 5, Steps: 67 | Train Loss: 1.445 Vali Loss: 13.013 Vali Acc: 0.653 Test Loss: 13.013 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.3664491176605225
Epoch: 6, Steps: 67 | Train Loss: 0.941 Vali Loss: 4.815 Vali Acc: 0.838 Test Loss: 4.815 Test Acc: 0.838
Validation loss decreased (-0.757118 --> -0.838102).  Saving model ...
Epoch: 7 cost time: 9.551119089126587
Epoch: 7, Steps: 67 | Train Loss: 0.248 Vali Loss: 6.470 Vali Acc: 0.798 Test Loss: 6.470 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.541737794876099
Epoch: 8, Steps: 67 | Train Loss: 0.071 Vali Loss: 9.026 Vali Acc: 0.711 Test Loss: 9.026 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.612733602523804
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.536 Vali Acc: 0.780 Test Loss: 10.536 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.8534517288208
Epoch: 10, Steps: 67 | Train Loss: 0.244 Vali Loss: 10.469 Vali Acc: 0.775 Test Loss: 10.469 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.641242980957031
Epoch: 11, Steps: 67 | Train Loss: 0.293 Vali Loss: 14.505 Vali Acc: 0.740 Test Loss: 14.505 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.18187427520752
Epoch: 12, Steps: 67 | Train Loss: 2.202 Vali Loss: 17.319 Vali Acc: 0.723 Test Loss: 17.319 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.591960191726685
Epoch: 13, Steps: 67 | Train Loss: 2.015 Vali Loss: 7.958 Vali Acc: 0.775 Test Loss: 7.958 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.89569640159607
Epoch: 14, Steps: 67 | Train Loss: 0.106 Vali Loss: 3.559 Vali Acc: 0.821 Test Loss: 3.559 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.357659816741943
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.471 Vali Acc: 0.815 Test Loss: 4.471 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.41170334815979
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.797 Vali Acc: 0.798 Test Loss: 5.797 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 5643527
model size : 22.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.006918668746948
Epoch: 1, Steps: 67 | Train Loss: 5.940 Vali Loss: 4.012 Vali Acc: 0.561 Test Loss: 4.012 Test Acc: 0.561
Validation loss decreased (inf --> -0.560654).  Saving model ...
Epoch: 2 cost time: 6.691018581390381
Epoch: 2, Steps: 67 | Train Loss: 5.435 Vali Loss: 16.769 Vali Acc: 0.543 Test Loss: 16.769 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.919862270355225
Epoch: 3, Steps: 67 | Train Loss: 2.465 Vali Loss: 5.618 Vali Acc: 0.682 Test Loss: 5.618 Test Acc: 0.682
Validation loss decreased (-0.560654 --> -0.682025).  Saving model ...
Epoch: 4 cost time: 7.6611974239349365
Epoch: 4, Steps: 67 | Train Loss: 0.558 Vali Loss: 8.948 Vali Acc: 0.671 Test Loss: 8.948 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.631918907165527
Epoch: 5, Steps: 67 | Train Loss: 1.061 Vali Loss: 16.473 Vali Acc: 0.618 Test Loss: 16.473 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.119143009185791
Epoch: 6, Steps: 67 | Train Loss: 1.802 Vali Loss: 8.820 Vali Acc: 0.763 Test Loss: 8.820 Test Acc: 0.763
Validation loss decreased (-0.682025 --> -0.762918).  Saving model ...
Epoch: 7 cost time: 6.535309076309204
Epoch: 7, Steps: 67 | Train Loss: 1.508 Vali Loss: 7.720 Vali Acc: 0.740 Test Loss: 7.720 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.382138967514038
Epoch: 8, Steps: 67 | Train Loss: 0.445 Vali Loss: 7.174 Vali Acc: 0.775 Test Loss: 7.174 Test Acc: 0.775
Validation loss decreased (-0.762918 --> -0.774495).  Saving model ...
Epoch: 9 cost time: 8.594327926635742
Epoch: 9, Steps: 67 | Train Loss: 0.289 Vali Loss: 6.751 Vali Acc: 0.803 Test Loss: 6.751 Test Acc: 0.803
Validation loss decreased (-0.774495 --> -0.803401).  Saving model ...
Epoch: 10 cost time: 6.50787353515625
Epoch: 10, Steps: 67 | Train Loss: 0.087 Vali Loss: 8.386 Vali Acc: 0.775 Test Loss: 8.386 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.148715734481812
Epoch: 11, Steps: 67 | Train Loss: 0.156 Vali Loss: 4.549 Vali Acc: 0.792 Test Loss: 4.549 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.589188098907471
Epoch: 12, Steps: 67 | Train Loss: 0.280 Vali Loss: 10.954 Vali Acc: 0.763 Test Loss: 10.954 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.14844536781311
Epoch: 13, Steps: 67 | Train Loss: 0.111 Vali Loss: 4.838 Vali Acc: 0.827 Test Loss: 4.838 Test Acc: 0.827
Validation loss decreased (-0.803401 --> -0.826541).  Saving model ...
Epoch: 14 cost time: 8.43290090560913
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.380 Vali Acc: 0.798 Test Loss: 5.380 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.022502660751343
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.325 Vali Acc: 0.798 Test Loss: 5.325 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.306914329528809
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.348 Vali Acc: 0.798 Test Loss: 5.348 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.6770265102386475
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.313 Vali Acc: 0.798 Test Loss: 5.313 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.888280153274536
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.274 Vali Acc: 0.798 Test Loss: 5.274 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.573580741882324
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.321 Vali Acc: 0.798 Test Loss: 5.321 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.985842227935791
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.291 Vali Acc: 0.798 Test Loss: 5.291 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.289273262023926
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.225 Vali Acc: 0.803 Test Loss: 5.225 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.936599493026733
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.251 Vali Acc: 0.803 Test Loss: 5.251 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.231652498245239
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.220 Vali Acc: 0.803 Test Loss: 5.220 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3918279
model size : 16.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.010061502456665
Epoch: 1, Steps: 67 | Train Loss: 8.295 Vali Loss: 7.124 Vali Acc: 0.642 Test Loss: 7.124 Test Acc: 0.642
Validation loss decreased (inf --> -0.641547).  Saving model ...
Epoch: 2 cost time: 7.185788869857788
Epoch: 2, Steps: 67 | Train Loss: 4.723 Vali Loss: 8.414 Vali Acc: 0.590 Test Loss: 8.414 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.689830541610718
Epoch: 3, Steps: 67 | Train Loss: 1.869 Vali Loss: 4.654 Vali Acc: 0.728 Test Loss: 4.654 Test Acc: 0.728
Validation loss decreased (-0.641547 --> -0.728277).  Saving model ...
Epoch: 4 cost time: 6.979124307632446
Epoch: 4, Steps: 67 | Train Loss: 1.430 Vali Loss: 6.331 Vali Acc: 0.688 Test Loss: 6.331 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.346797227859497
Epoch: 5, Steps: 67 | Train Loss: 0.557 Vali Loss: 4.849 Vali Acc: 0.694 Test Loss: 4.849 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.585632801055908
Epoch: 6, Steps: 67 | Train Loss: 0.424 Vali Loss: 6.041 Vali Acc: 0.705 Test Loss: 6.041 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.581340551376343
Epoch: 7, Steps: 67 | Train Loss: 0.694 Vali Loss: 11.340 Vali Acc: 0.694 Test Loss: 11.340 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.541569471359253
Epoch: 8, Steps: 67 | Train Loss: 0.663 Vali Loss: 5.883 Vali Acc: 0.734 Test Loss: 5.883 Test Acc: 0.734
Validation loss decreased (-0.728277 --> -0.734045).  Saving model ...
Epoch: 9 cost time: 6.613687992095947
Epoch: 9, Steps: 67 | Train Loss: 0.113 Vali Loss: 3.342 Vali Acc: 0.780 Test Loss: 3.342 Test Acc: 0.780
Validation loss decreased (-0.734045 --> -0.780313).  Saving model ...
Epoch: 10 cost time: 6.602787971496582
Epoch: 10, Steps: 67 | Train Loss: 0.061 Vali Loss: 6.407 Vali Acc: 0.780 Test Loss: 6.407 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.9738359451293945
Epoch: 11, Steps: 67 | Train Loss: 0.035 Vali Loss: 2.763 Vali Acc: 0.803 Test Loss: 2.763 Test Acc: 0.803
Validation loss decreased (-0.780313 --> -0.803441).  Saving model ...
Epoch: 12 cost time: 7.402941942214966
Epoch: 12, Steps: 67 | Train Loss: 0.078 Vali Loss: 7.223 Vali Acc: 0.763 Test Loss: 7.223 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.005955696105957
Epoch: 13, Steps: 67 | Train Loss: 0.173 Vali Loss: 9.562 Vali Acc: 0.763 Test Loss: 9.562 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.96202278137207
Epoch: 14, Steps: 67 | Train Loss: 0.746 Vali Loss: 9.402 Vali Acc: 0.688 Test Loss: 9.402 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.791898250579834
Epoch: 15, Steps: 67 | Train Loss: 0.242 Vali Loss: 4.179 Vali Acc: 0.815 Test Loss: 4.179 Test Acc: 0.815
Validation loss decreased (-0.803441 --> -0.814987).  Saving model ...
Epoch: 16 cost time: 5.910764694213867
Epoch: 16, Steps: 67 | Train Loss: 0.223 Vali Loss: 5.355 Vali Acc: 0.792 Test Loss: 5.355 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.94380259513855
Epoch: 17, Steps: 67 | Train Loss: 0.011 Vali Loss: 6.793 Vali Acc: 0.815 Test Loss: 6.793 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.734620809555054
Epoch: 18, Steps: 67 | Train Loss: 0.065 Vali Loss: 8.058 Vali Acc: 0.775 Test Loss: 8.058 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.990666389465332
Epoch: 19, Steps: 67 | Train Loss: 0.061 Vali Loss: 9.734 Vali Acc: 0.746 Test Loss: 9.734 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.490333557128906
Epoch: 20, Steps: 67 | Train Loss: 0.067 Vali Loss: 3.765 Vali Acc: 0.850 Test Loss: 3.765 Test Acc: 0.850
Validation loss decreased (-0.814987 --> -0.849673).  Saving model ...
Epoch: 21 cost time: 6.405841827392578
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.587 Vali Acc: 0.792 Test Loss: 3.587 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.107134103775024
Epoch: 22, Steps: 67 | Train Loss: 0.536 Vali Loss: 24.244 Vali Acc: 0.613 Test Loss: 24.244 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.00723147392273
Epoch: 23, Steps: 67 | Train Loss: 1.524 Vali Loss: 10.454 Vali Acc: 0.763 Test Loss: 10.454 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.4096925258636475
Epoch: 24, Steps: 67 | Train Loss: 0.198 Vali Loss: 8.706 Vali Acc: 0.763 Test Loss: 8.706 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.9981529712677
Epoch: 25, Steps: 67 | Train Loss: 0.227 Vali Loss: 17.817 Vali Acc: 0.682 Test Loss: 17.817 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.402841567993164
Epoch: 26, Steps: 67 | Train Loss: 0.029 Vali Loss: 7.785 Vali Acc: 0.775 Test Loss: 7.785 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.487623453140259
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.611 Vali Acc: 0.786 Test Loss: 7.611 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.7350640296936035
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.453 Vali Acc: 0.786 Test Loss: 7.453 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.292346239089966
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.383 Vali Acc: 0.786 Test Loss: 7.383 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.7880027294158936
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.440 Vali Acc: 0.786 Test Loss: 7.440 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 3487303
model size : 14.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 219.4132538
	speed: 0.4035s/iter; left time: 5367.2555s
Epoch: 1 cost time: 49.31740069389343
Epoch: 1, Steps: 134 | Train Loss: 150.495 Vali Loss: 152.844 Vali Acc: 0.503 Test Loss: 152.844 Test Acc: 0.503
Validation loss decreased (inf --> -0.501362).  Saving model ...
	iters: 100, epoch: 2 | loss: 285.5737305
	speed: 0.8288s/iter; left time: 10912.2399s
Epoch: 2 cost time: 45.74926257133484
Epoch: 2, Steps: 134 | Train Loss: 123.634 Vali Loss: 39.121 Vali Acc: 0.636 Test Loss: 39.121 Test Acc: 0.636
Validation loss decreased (-0.501362 --> -0.635447).  Saving model ...
	iters: 100, epoch: 3 | loss: 106.2587204
	speed: 0.7797s/iter; left time: 10161.4489s
Epoch: 3 cost time: 40.53823137283325
Epoch: 3, Steps: 134 | Train Loss: 13.394 Vali Loss: 80.981 Vali Acc: 0.457 Test Loss: 80.981 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 78.7097626
	speed: 0.8356s/iter; left time: 10777.9197s
Epoch: 4 cost time: 46.085100173950195
Epoch: 4, Steps: 134 | Train Loss: 2.760 Vali Loss: 20.923 Vali Acc: 0.775 Test Loss: 20.923 Test Acc: 0.775
Validation loss decreased (-0.635447 --> -0.774357).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.8044s/iter; left time: 10268.1465s
Epoch: 5 cost time: 45.674147844314575
Epoch: 5, Steps: 134 | Train Loss: 1.426 Vali Loss: 22.804 Vali Acc: 0.746 Test Loss: 22.804 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.8620s/iter; left time: 10887.7146s
Epoch: 6 cost time: 47.96437907218933
Epoch: 6, Steps: 134 | Train Loss: 0.558 Vali Loss: 23.705 Vali Acc: 0.728 Test Loss: 23.705 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7059s/iter; left time: 8822.2165s
Epoch: 7 cost time: 29.874361991882324
Epoch: 7, Steps: 134 | Train Loss: 2.489 Vali Loss: 16.677 Vali Acc: 0.815 Test Loss: 16.677 Test Acc: 0.815
Validation loss decreased (-0.774357 --> -0.814862).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.8309s/iter; left time: 10271.9863s
Epoch: 8 cost time: 46.46274971961975
Epoch: 8, Steps: 134 | Train Loss: 2.505 Vali Loss: 13.031 Vali Acc: 0.786 Test Loss: 13.031 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.8060s/iter; left time: 9856.3587s
Epoch: 9 cost time: 45.847705602645874
Epoch: 9, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.781 Vali Acc: 0.723 Test Loss: 18.781 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.8739s/iter; left time: 10569.3538s
Epoch: 10 cost time: 51.95325994491577
Epoch: 10, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.280 Vali Acc: 0.717 Test Loss: 19.280 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.8450s/iter; left time: 10107.0186s
Epoch: 11 cost time: 49.964497327804565
Epoch: 11, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.083 Vali Acc: 0.717 Test Loss: 19.083 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.8355s/iter; left time: 9881.6813s
Epoch: 12 cost time: 47.94463348388672
Epoch: 12, Steps: 134 | Train Loss: 0.824 Vali Loss: 69.782 Vali Acc: 0.642 Test Loss: 69.782 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7452s/iter; left time: 8713.3627s
Epoch: 13 cost time: 40.49946427345276
Epoch: 13, Steps: 134 | Train Loss: 4.622 Vali Loss: 33.961 Vali Acc: 0.705 Test Loss: 33.961 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6791s/iter; left time: 7849.7679s
Epoch: 14 cost time: 42.168734073638916
Epoch: 14, Steps: 134 | Train Loss: 2.503 Vali Loss: 27.058 Vali Acc: 0.775 Test Loss: 27.058 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.8520s/iter; left time: 9733.8503s
Epoch: 15 cost time: 48.146042585372925
Epoch: 15, Steps: 134 | Train Loss: 1.234 Vali Loss: 19.833 Vali Acc: 0.763 Test Loss: 19.833 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7182s/iter; left time: 8109.1271s
Epoch: 16 cost time: 38.85882568359375
Epoch: 16, Steps: 134 | Train Loss: 0.873 Vali Loss: 39.991 Vali Acc: 0.792 Test Loss: 39.991 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.8683s/iter; left time: 9687.5574s
Epoch: 17 cost time: 49.75867795944214
Epoch: 17, Steps: 134 | Train Loss: 2.052 Vali Loss: 28.768 Vali Acc: 0.803 Test Loss: 28.768 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 31088135
model size : 119.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 23.439035892486572
Epoch: 1, Steps: 67 | Train Loss: 39.854 Vali Loss: 59.822 Vali Acc: 0.595 Test Loss: 59.822 Test Acc: 0.595
Validation loss decreased (inf --> -0.594778).  Saving model ...
Epoch: 2 cost time: 14.868889570236206
Epoch: 2, Steps: 67 | Train Loss: 37.768 Vali Loss: 21.175 Vali Acc: 0.671 Test Loss: 21.175 Test Acc: 0.671
Validation loss decreased (-0.594778 --> -0.670308).  Saving model ...
Epoch: 3 cost time: 19.15478253364563
Epoch: 3, Steps: 67 | Train Loss: 12.482 Vali Loss: 42.613 Vali Acc: 0.595 Test Loss: 42.613 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.006836414337158
Epoch: 4, Steps: 67 | Train Loss: 13.069 Vali Loss: 34.514 Vali Acc: 0.728 Test Loss: 34.514 Test Acc: 0.728
Validation loss decreased (-0.670308 --> -0.727979).  Saving model ...
Epoch: 5 cost time: 15.492979764938354
Epoch: 5, Steps: 67 | Train Loss: 10.372 Vali Loss: 25.223 Vali Acc: 0.717 Test Loss: 25.223 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.042035579681396
Epoch: 6, Steps: 67 | Train Loss: 3.055 Vali Loss: 29.919 Vali Acc: 0.717 Test Loss: 29.919 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.24552845954895
Epoch: 7, Steps: 67 | Train Loss: 2.970 Vali Loss: 10.662 Vali Acc: 0.780 Test Loss: 10.662 Test Acc: 0.780
Validation loss decreased (-0.727979 --> -0.780240).  Saving model ...
Epoch: 8 cost time: 17.05358648300171
Epoch: 8, Steps: 67 | Train Loss: 3.647 Vali Loss: 16.635 Vali Acc: 0.723 Test Loss: 16.635 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.377875566482544
Epoch: 9, Steps: 67 | Train Loss: 0.270 Vali Loss: 17.323 Vali Acc: 0.821 Test Loss: 17.323 Test Acc: 0.821
Validation loss decreased (-0.780240 --> -0.820636).  Saving model ...
Epoch: 10 cost time: 13.522290229797363
Epoch: 10, Steps: 67 | Train Loss: 0.210 Vali Loss: 15.938 Vali Acc: 0.798 Test Loss: 15.938 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.773515462875366
Epoch: 11, Steps: 67 | Train Loss: 0.192 Vali Loss: 14.939 Vali Acc: 0.821 Test Loss: 14.939 Test Acc: 0.821
Validation loss decreased (-0.820636 --> -0.820660).  Saving model ...
Epoch: 12 cost time: 18.691663026809692
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 19.743 Vali Acc: 0.798 Test Loss: 19.743 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.369237184524536
Epoch: 13, Steps: 67 | Train Loss: 0.457 Vali Loss: 11.093 Vali Acc: 0.827 Test Loss: 11.093 Test Acc: 0.827
Validation loss decreased (-0.820660 --> -0.826479).  Saving model ...
Epoch: 14 cost time: 23.653385877609253
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.670 Vali Acc: 0.832 Test Loss: 15.670 Test Acc: 0.832
Validation loss decreased (-0.826479 --> -0.832213).  Saving model ...
Epoch: 15 cost time: 15.031709671020508
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.661 Vali Acc: 0.832 Test Loss: 15.661 Test Acc: 0.832
Validation loss decreased (-0.832213 --> -0.832213).  Saving model ...
Epoch: 16 cost time: 14.23926830291748
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.667 Vali Acc: 0.832 Test Loss: 15.667 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 19.352463960647583
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.654 Vali Acc: 0.832 Test Loss: 15.654 Test Acc: 0.832
Validation loss decreased (-0.832213 --> -0.832213).  Saving model ...
Epoch: 18 cost time: 15.298349618911743
Epoch: 18, Steps: 67 | Train Loss: 1.047 Vali Loss: 43.090 Vali Acc: 0.705 Test Loss: 43.090 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 17.476160526275635
Epoch: 19, Steps: 67 | Train Loss: 2.909 Vali Loss: 14.081 Vali Acc: 0.792 Test Loss: 14.081 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.774083137512207
Epoch: 20, Steps: 67 | Train Loss: 0.143 Vali Loss: 10.315 Vali Acc: 0.838 Test Loss: 10.315 Test Acc: 0.838
Validation loss decreased (-0.832213 --> -0.838047).  Saving model ...
Epoch: 21 cost time: 18.71648931503296
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.654 Vali Acc: 0.838 Test Loss: 10.654 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 18.953279733657837
Epoch: 22, Steps: 67 | Train Loss: 0.158 Vali Loss: 11.826 Vali Acc: 0.827 Test Loss: 11.826 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 16.039276123046875
Epoch: 23, Steps: 67 | Train Loss: 0.182 Vali Loss: 24.605 Vali Acc: 0.757 Test Loss: 24.605 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.611743688583374
Epoch: 24, Steps: 67 | Train Loss: 1.014 Vali Loss: 15.145 Vali Acc: 0.792 Test Loss: 15.145 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 20.097514152526855
Epoch: 25, Steps: 67 | Train Loss: 1.083 Vali Loss: 6.961 Vali Acc: 0.803 Test Loss: 6.961 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 17.848840951919556
Epoch: 26, Steps: 67 | Train Loss: 0.034 Vali Loss: 25.228 Vali Acc: 0.740 Test Loss: 25.228 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 18.868395566940308
Epoch: 27, Steps: 67 | Train Loss: 0.626 Vali Loss: 20.655 Vali Acc: 0.746 Test Loss: 20.655 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 21.47042489051819
Epoch: 28, Steps: 67 | Train Loss: 1.261 Vali Loss: 13.474 Vali Acc: 0.775 Test Loss: 13.474 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 17.693559408187866
Epoch: 29, Steps: 67 | Train Loss: 1.786 Vali Loss: 17.758 Vali Acc: 0.792 Test Loss: 17.758 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 14.057465553283691
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 21.313 Vali Acc: 0.792 Test Loss: 21.313 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 15557127
model size : 60.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 17.168213605880737
Epoch: 1, Steps: 67 | Train Loss: 28.587 Vali Loss: 59.094 Vali Acc: 0.405 Test Loss: 59.094 Test Acc: 0.405
Validation loss decreased (inf --> -0.404033).  Saving model ...
Epoch: 2 cost time: 11.488365173339844
Epoch: 2, Steps: 67 | Train Loss: 22.399 Vali Loss: 14.957 Vali Acc: 0.711 Test Loss: 14.957 Test Acc: 0.711
Validation loss decreased (-0.404033 --> -0.710833).  Saving model ...
Epoch: 3 cost time: 13.721497535705566
Epoch: 3, Steps: 67 | Train Loss: 5.911 Vali Loss: 10.848 Vali Acc: 0.751 Test Loss: 10.848 Test Acc: 0.751
Validation loss decreased (-0.710833 --> -0.751337).  Saving model ...
Epoch: 4 cost time: 11.558487892150879
Epoch: 4, Steps: 67 | Train Loss: 1.975 Vali Loss: 9.998 Vali Acc: 0.717 Test Loss: 9.998 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.395377397537231
Epoch: 5, Steps: 67 | Train Loss: 4.356 Vali Loss: 16.798 Vali Acc: 0.653 Test Loss: 16.798 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.509309768676758
Epoch: 6, Steps: 67 | Train Loss: 5.655 Vali Loss: 16.564 Vali Acc: 0.751 Test Loss: 16.564 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.651957035064697
Epoch: 7, Steps: 67 | Train Loss: 0.779 Vali Loss: 12.752 Vali Acc: 0.803 Test Loss: 12.752 Test Acc: 0.803
Validation loss decreased (-0.751337 --> -0.803341).  Saving model ...
Epoch: 8 cost time: 15.72019362449646
Epoch: 8, Steps: 67 | Train Loss: 0.674 Vali Loss: 12.297 Vali Acc: 0.780 Test Loss: 12.297 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.961141586303711
Epoch: 9, Steps: 67 | Train Loss: 0.372 Vali Loss: 13.973 Vali Acc: 0.751 Test Loss: 13.973 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.792951345443726
Epoch: 10, Steps: 67 | Train Loss: 0.638 Vali Loss: 11.783 Vali Acc: 0.780 Test Loss: 11.783 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.319753885269165
Epoch: 11, Steps: 67 | Train Loss: 0.553 Vali Loss: 21.979 Vali Acc: 0.763 Test Loss: 21.979 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.684692859649658
Epoch: 12, Steps: 67 | Train Loss: 0.739 Vali Loss: 16.309 Vali Acc: 0.769 Test Loss: 16.309 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.650909185409546
Epoch: 13, Steps: 67 | Train Loss: 0.194 Vali Loss: 11.212 Vali Acc: 0.803 Test Loss: 11.212 Test Acc: 0.803
Validation loss decreased (-0.803341 --> -0.803356).  Saving model ...
Epoch: 14 cost time: 7.864894390106201
Epoch: 14, Steps: 67 | Train Loss: 0.133 Vali Loss: 16.550 Vali Acc: 0.757 Test Loss: 16.550 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.227923393249512
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 17.435 Vali Acc: 0.757 Test Loss: 17.435 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.202477216720581
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 17.437 Vali Acc: 0.757 Test Loss: 17.437 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 12.365483522415161
Epoch: 17, Steps: 67 | Train Loss: 0.055 Vali Loss: 12.310 Vali Acc: 0.798 Test Loss: 12.310 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.238380908966064
Epoch: 18, Steps: 67 | Train Loss: 1.991 Vali Loss: 11.850 Vali Acc: 0.763 Test Loss: 11.850 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.084495782852173
Epoch: 19, Steps: 67 | Train Loss: 0.432 Vali Loss: 23.346 Vali Acc: 0.740 Test Loss: 23.346 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.678516864776611
Epoch: 20, Steps: 67 | Train Loss: 0.592 Vali Loss: 13.933 Vali Acc: 0.775 Test Loss: 13.933 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.676624774932861
Epoch: 21, Steps: 67 | Train Loss: 0.137 Vali Loss: 13.214 Vali Acc: 0.769 Test Loss: 13.214 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.191020965576172
Epoch: 22, Steps: 67 | Train Loss: 0.134 Vali Loss: 14.336 Vali Acc: 0.769 Test Loss: 14.336 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 14.05247688293457
Epoch: 23, Steps: 67 | Train Loss: 1.053 Vali Loss: 12.175 Vali Acc: 0.792 Test Loss: 12.175 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 10380231
model size : 40.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.950400352478027
Epoch: 1, Steps: 67 | Train Loss: 19.348 Vali Loss: 18.129 Vali Acc: 0.572 Test Loss: 18.129 Test Acc: 0.572
Validation loss decreased (inf --> -0.572073).  Saving model ...
Epoch: 2 cost time: 11.224606990814209
Epoch: 2, Steps: 67 | Train Loss: 10.998 Vali Loss: 28.010 Vali Acc: 0.393 Test Loss: 28.010 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.815134286880493
Epoch: 3, Steps: 67 | Train Loss: 9.892 Vali Loss: 13.381 Vali Acc: 0.728 Test Loss: 13.381 Test Acc: 0.728
Validation loss decreased (-0.572073 --> -0.728190).  Saving model ...
Epoch: 4 cost time: 12.845682859420776
Epoch: 4, Steps: 67 | Train Loss: 4.215 Vali Loss: 10.420 Vali Acc: 0.763 Test Loss: 10.420 Test Acc: 0.763
Validation loss decreased (-0.728190 --> -0.762902).  Saving model ...
Epoch: 5 cost time: 11.535781860351562
Epoch: 5, Steps: 67 | Train Loss: 0.411 Vali Loss: 5.004 Vali Acc: 0.775 Test Loss: 5.004 Test Acc: 0.775
Validation loss decreased (-0.762902 --> -0.774516).  Saving model ...
Epoch: 6 cost time: 11.26059365272522
Epoch: 6, Steps: 67 | Train Loss: 4.292 Vali Loss: 23.053 Vali Acc: 0.769 Test Loss: 23.053 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.762043714523315
Epoch: 7, Steps: 67 | Train Loss: 1.375 Vali Loss: 8.252 Vali Acc: 0.746 Test Loss: 8.252 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.975183963775635
Epoch: 8, Steps: 67 | Train Loss: 0.483 Vali Loss: 11.822 Vali Acc: 0.803 Test Loss: 11.822 Test Acc: 0.803
Validation loss decreased (-0.774516 --> -0.803350).  Saving model ...
Epoch: 9 cost time: 15.16889214515686
Epoch: 9, Steps: 67 | Train Loss: 0.582 Vali Loss: 7.838 Vali Acc: 0.792 Test Loss: 7.838 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.369223356246948
Epoch: 10, Steps: 67 | Train Loss: 0.159 Vali Loss: 8.593 Vali Acc: 0.803 Test Loss: 8.593 Test Acc: 0.803
Validation loss decreased (-0.803350 --> -0.803382).  Saving model ...
Epoch: 11 cost time: 12.804901123046875
Epoch: 11, Steps: 67 | Train Loss: 0.088 Vali Loss: 6.325 Vali Acc: 0.798 Test Loss: 6.325 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.280941009521484
Epoch: 12, Steps: 67 | Train Loss: 0.325 Vali Loss: 10.334 Vali Acc: 0.792 Test Loss: 10.334 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.101406812667847
Epoch: 13, Steps: 67 | Train Loss: 0.199 Vali Loss: 10.646 Vali Acc: 0.746 Test Loss: 10.646 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.706469535827637
Epoch: 14, Steps: 67 | Train Loss: 0.791 Vali Loss: 9.133 Vali Acc: 0.775 Test Loss: 9.133 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.898634910583496
Epoch: 15, Steps: 67 | Train Loss: 0.957 Vali Loss: 6.270 Vali Acc: 0.792 Test Loss: 6.270 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.360768556594849
Epoch: 16, Steps: 67 | Train Loss: 0.194 Vali Loss: 5.212 Vali Acc: 0.798 Test Loss: 5.212 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 12.431655406951904
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.504 Vali Acc: 0.798 Test Loss: 5.504 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.303580045700073
Epoch: 18, Steps: 67 | Train Loss: 0.468 Vali Loss: 5.477 Vali Acc: 0.723 Test Loss: 5.477 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.657821893692017
Epoch: 19, Steps: 67 | Train Loss: 0.939 Vali Loss: 5.116 Vali Acc: 0.827 Test Loss: 5.116 Test Acc: 0.827
Validation loss decreased (-0.803382 --> -0.826538).  Saving model ...
Epoch: 20 cost time: 12.759238719940186
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.099 Vali Acc: 0.827 Test Loss: 5.099 Test Acc: 0.827
Validation loss decreased (-0.826538 --> -0.826539).  Saving model ...
Epoch: 21 cost time: 11.089580059051514
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.108 Vali Acc: 0.827 Test Loss: 5.108 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.093749523162842
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.102 Vali Acc: 0.827 Test Loss: 5.102 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.352846384048462
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.097 Vali Acc: 0.827 Test Loss: 5.097 Test Acc: 0.827
Validation loss decreased (-0.826539 --> -0.826539).  Saving model ...
Epoch: 24 cost time: 13.654883861541748
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.095 Vali Acc: 0.827 Test Loss: 5.095 Test Acc: 0.827
Validation loss decreased (-0.826539 --> -0.826539).  Saving model ...
Epoch: 25 cost time: 10.005492210388184
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.098 Vali Acc: 0.827 Test Loss: 5.098 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 15.683264970779419
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.093 Vali Acc: 0.827 Test Loss: 5.093 Test Acc: 0.827
Validation loss decreased (-0.826539 --> -0.826539).  Saving model ...
Epoch: 27 cost time: 10.959166049957275
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.099 Vali Acc: 0.827 Test Loss: 5.099 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 11.676116704940796
Epoch: 28, Steps: 67 | Train Loss: 0.226 Vali Loss: 15.056 Vali Acc: 0.734 Test Loss: 15.056 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 12.492135286331177
Epoch: 29, Steps: 67 | Train Loss: 1.134 Vali Loss: 4.831 Vali Acc: 0.844 Test Loss: 4.831 Test Acc: 0.844
Validation loss decreased (-0.826539 --> -0.843882).  Saving model ...
Epoch: 30 cost time: 10.084571838378906
Epoch: 30, Steps: 67 | Train Loss: 1.119 Vali Loss: 11.118 Vali Acc: 0.792 Test Loss: 11.118 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 12.770780324935913
Epoch: 31, Steps: 67 | Train Loss: 0.443 Vali Loss: 16.906 Vali Acc: 0.815 Test Loss: 16.906 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 9.364685773849487
Epoch: 32, Steps: 67 | Train Loss: 0.996 Vali Loss: 8.219 Vali Acc: 0.850 Test Loss: 8.219 Test Acc: 0.850
Validation loss decreased (-0.843882 --> -0.849629).  Saving model ...
Epoch: 33 cost time: 12.142839908599854
Epoch: 33, Steps: 67 | Train Loss: 0.400 Vali Loss: 17.031 Vali Acc: 0.763 Test Loss: 17.031 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 12.247447490692139
Epoch: 34, Steps: 67 | Train Loss: 0.567 Vali Loss: 22.265 Vali Acc: 0.769 Test Loss: 22.265 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 12.709225177764893
Epoch: 35, Steps: 67 | Train Loss: 2.870 Vali Loss: 14.290 Vali Acc: 0.780 Test Loss: 14.290 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 12.836311101913452
Epoch: 36, Steps: 67 | Train Loss: 1.673 Vali Loss: 24.688 Vali Acc: 0.699 Test Loss: 24.688 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 16.16700267791748
Epoch: 37, Steps: 67 | Train Loss: 1.427 Vali Loss: 12.796 Vali Acc: 0.798 Test Loss: 12.796 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 9.395131349563599
Epoch: 38, Steps: 67 | Train Loss: 1.390 Vali Loss: 16.397 Vali Acc: 0.792 Test Loss: 16.397 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 17.741409301757812
Epoch: 39, Steps: 67 | Train Loss: 0.452 Vali Loss: 14.835 Vali Acc: 0.815 Test Loss: 14.835 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 10.334665536880493
Epoch: 40, Steps: 67 | Train Loss: 0.200 Vali Loss: 10.837 Vali Acc: 0.815 Test Loss: 10.837 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 15.144630432128906
Epoch: 41, Steps: 67 | Train Loss: 0.057 Vali Loss: 22.067 Vali Acc: 0.740 Test Loss: 22.067 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 12.597038984298706
Epoch: 42, Steps: 67 | Train Loss: 0.066 Vali Loss: 8.667 Vali Acc: 0.873 Test Loss: 8.667 Test Acc: 0.873
Validation loss decreased (-0.849629 --> -0.872746).  Saving model ...
Epoch: 43 cost time: 9.933910369873047
Epoch: 43, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.636 Vali Acc: 0.867 Test Loss: 8.636 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 12.061830520629883
Epoch: 44, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.643 Vali Acc: 0.867 Test Loss: 8.643 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 9.786641359329224
Epoch: 45, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.635 Vali Acc: 0.867 Test Loss: 8.635 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 11.095750331878662
Epoch: 46, Steps: 67 | Train Loss: 0.002 Vali Loss: 34.834 Vali Acc: 0.751 Test Loss: 34.834 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 12.400934219360352
Epoch: 47, Steps: 67 | Train Loss: 0.000 Vali Loss: 35.539 Vali Acc: 0.751 Test Loss: 35.539 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 11.094128847122192
Epoch: 48, Steps: 67 | Train Loss: 0.000 Vali Loss: 35.713 Vali Acc: 0.751 Test Loss: 35.713 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 10.24798035621643
Epoch: 49, Steps: 67 | Train Loss: 0.212 Vali Loss: 19.716 Vali Acc: 0.803 Test Loss: 19.716 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 15.669460535049438
Epoch: 50, Steps: 67 | Train Loss: 0.000 Vali Loss: 19.374 Vali Acc: 0.798 Test Loss: 19.374 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 9.842363357543945
Epoch: 51, Steps: 67 | Train Loss: 0.000 Vali Loss: 19.396 Vali Acc: 0.792 Test Loss: 19.396 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 14.128301858901978
Epoch: 52, Steps: 67 | Train Loss: 0.000 Vali Loss: 19.429 Vali Acc: 0.798 Test Loss: 19.429 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 7791943
model size : 30.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.287144899368286
Epoch: 1, Steps: 67 | Train Loss: 13.599 Vali Loss: 13.756 Vali Acc: 0.451 Test Loss: 13.756 Test Acc: 0.451
Validation loss decreased (inf --> -0.450729).  Saving model ...
Epoch: 2 cost time: 8.865157127380371
Epoch: 2, Steps: 67 | Train Loss: 9.123 Vali Loss: 7.774 Vali Acc: 0.653 Test Loss: 7.774 Test Acc: 0.653
Validation loss decreased (-0.450729 --> -0.653101).  Saving model ...
Epoch: 3 cost time: 7.712402582168579
Epoch: 3, Steps: 67 | Train Loss: 4.941 Vali Loss: 6.257 Vali Acc: 0.763 Test Loss: 6.257 Test Acc: 0.763
Validation loss decreased (-0.653101 --> -0.762943).  Saving model ...
Epoch: 4 cost time: 7.591245651245117
Epoch: 4, Steps: 67 | Train Loss: 3.199 Vali Loss: 5.492 Vali Acc: 0.792 Test Loss: 5.492 Test Acc: 0.792
Validation loss decreased (-0.762943 --> -0.791853).  Saving model ...
Epoch: 5 cost time: 8.789303302764893
Epoch: 5, Steps: 67 | Train Loss: 2.002 Vali Loss: 11.849 Vali Acc: 0.705 Test Loss: 11.849 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.643509387969971
Epoch: 6, Steps: 67 | Train Loss: 0.719 Vali Loss: 9.698 Vali Acc: 0.780 Test Loss: 9.698 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.62999701499939
Epoch: 7, Steps: 67 | Train Loss: 0.756 Vali Loss: 9.413 Vali Acc: 0.792 Test Loss: 9.413 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.249378442764282
Epoch: 8, Steps: 67 | Train Loss: 0.228 Vali Loss: 7.576 Vali Acc: 0.746 Test Loss: 7.576 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.454116344451904
Epoch: 9, Steps: 67 | Train Loss: 0.459 Vali Loss: 22.695 Vali Acc: 0.775 Test Loss: 22.695 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.385915756225586
Epoch: 10, Steps: 67 | Train Loss: 1.978 Vali Loss: 19.985 Vali Acc: 0.665 Test Loss: 19.985 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.333370923995972
Epoch: 11, Steps: 67 | Train Loss: 0.146 Vali Loss: 10.082 Vali Acc: 0.763 Test Loss: 10.082 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.42778491973877
Epoch: 12, Steps: 67 | Train Loss: 0.408 Vali Loss: 8.548 Vali Acc: 0.751 Test Loss: 8.548 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.141498327255249
Epoch: 13, Steps: 67 | Train Loss: 0.176 Vali Loss: 10.645 Vali Acc: 0.717 Test Loss: 10.645 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.261498212814331
Epoch: 14, Steps: 67 | Train Loss: 0.137 Vali Loss: 6.514 Vali Acc: 0.803 Test Loss: 6.514 Test Acc: 0.803
Validation loss decreased (-0.791853 --> -0.803403).  Saving model ...
Epoch: 15 cost time: 8.027711868286133
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.061 Vali Acc: 0.821 Test Loss: 5.061 Test Acc: 0.821
Validation loss decreased (-0.803403 --> -0.820759).  Saving model ...
Epoch: 16 cost time: 7.830812692642212
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.022 Vali Acc: 0.821 Test Loss: 5.022 Test Acc: 0.821
Validation loss decreased (-0.820759 --> -0.820759).  Saving model ...
Epoch: 17 cost time: 8.43428659439087
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.107 Vali Acc: 0.821 Test Loss: 5.107 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.039674282073975
Epoch: 18, Steps: 67 | Train Loss: 0.117 Vali Loss: 4.587 Vali Acc: 0.815 Test Loss: 4.587 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.645251512527466
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.557 Vali Acc: 0.827 Test Loss: 4.557 Test Acc: 0.827
Validation loss decreased (-0.820759 --> -0.826544).  Saving model ...
Epoch: 20 cost time: 8.26033091545105
Epoch: 20, Steps: 67 | Train Loss: 0.209 Vali Loss: 4.346 Vali Acc: 0.815 Test Loss: 4.346 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.380221128463745
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.314 Vali Acc: 0.815 Test Loss: 4.314 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.231343746185303
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.347 Vali Acc: 0.815 Test Loss: 4.347 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.221376895904541
Epoch: 23, Steps: 67 | Train Loss: 1.038 Vali Loss: 5.725 Vali Acc: 0.809 Test Loss: 5.725 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.037075281143188
Epoch: 24, Steps: 67 | Train Loss: 0.350 Vali Loss: 4.958 Vali Acc: 0.792 Test Loss: 4.958 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.878011226654053
Epoch: 25, Steps: 67 | Train Loss: 0.346 Vali Loss: 10.965 Vali Acc: 0.763 Test Loss: 10.965 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.673818588256836
Epoch: 26, Steps: 67 | Train Loss: 1.458 Vali Loss: 16.051 Vali Acc: 0.723 Test Loss: 16.051 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.33332085609436
Epoch: 27, Steps: 67 | Train Loss: 0.907 Vali Loss: 6.215 Vali Acc: 0.809 Test Loss: 6.215 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.88420033454895
Epoch: 28, Steps: 67 | Train Loss: 0.422 Vali Loss: 10.044 Vali Acc: 0.792 Test Loss: 10.044 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.016912937164307
Epoch: 29, Steps: 67 | Train Loss: 0.690 Vali Loss: 10.442 Vali Acc: 0.763 Test Loss: 10.442 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5635271
model size : 22.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.866889715194702
Epoch: 1, Steps: 67 | Train Loss: 9.457 Vali Loss: 16.732 Vali Acc: 0.341 Test Loss: 16.732 Test Acc: 0.341
Validation loss decreased (inf --> -0.340873).  Saving model ...
Epoch: 2 cost time: 8.117906093597412
Epoch: 2, Steps: 67 | Train Loss: 6.681 Vali Loss: 9.037 Vali Acc: 0.532 Test Loss: 9.037 Test Acc: 0.532
Validation loss decreased (-0.340873 --> -0.531702).  Saving model ...
Epoch: 3 cost time: 8.70188283920288
Epoch: 3, Steps: 67 | Train Loss: 3.440 Vali Loss: 7.320 Vali Acc: 0.682 Test Loss: 7.320 Test Acc: 0.682
Validation loss decreased (-0.531702 --> -0.682008).  Saving model ...
Epoch: 4 cost time: 7.164248704910278
Epoch: 4, Steps: 67 | Train Loss: 0.642 Vali Loss: 3.948 Vali Acc: 0.746 Test Loss: 3.948 Test Acc: 0.746
Validation loss decreased (-0.682008 --> -0.745625).  Saving model ...
Epoch: 5 cost time: 7.247654438018799
Epoch: 5, Steps: 67 | Train Loss: 0.343 Vali Loss: 5.803 Vali Acc: 0.746 Test Loss: 5.803 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.658214330673218
Epoch: 6, Steps: 67 | Train Loss: 0.234 Vali Loss: 2.772 Vali Acc: 0.821 Test Loss: 2.772 Test Acc: 0.821
Validation loss decreased (-0.745625 --> -0.820782).  Saving model ...
Epoch: 7 cost time: 6.024895429611206
Epoch: 7, Steps: 67 | Train Loss: 0.069 Vali Loss: 6.390 Vali Acc: 0.780 Test Loss: 6.390 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.965557813644409
Epoch: 8, Steps: 67 | Train Loss: 0.120 Vali Loss: 7.050 Vali Acc: 0.769 Test Loss: 7.050 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.607255697250366
Epoch: 9, Steps: 67 | Train Loss: 0.333 Vali Loss: 4.207 Vali Acc: 0.694 Test Loss: 4.207 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.623503923416138
Epoch: 10, Steps: 67 | Train Loss: 0.223 Vali Loss: 7.432 Vali Acc: 0.728 Test Loss: 7.432 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.716628551483154
Epoch: 11, Steps: 67 | Train Loss: 0.087 Vali Loss: 3.126 Vali Acc: 0.821 Test Loss: 3.126 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.441619873046875
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.982 Vali Acc: 0.821 Test Loss: 2.982 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.347164630889893
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.962 Vali Acc: 0.821 Test Loss: 2.962 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.306746482849121
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.963 Vali Acc: 0.821 Test Loss: 2.963 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.207557678222656
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.972 Vali Acc: 0.821 Test Loss: 2.972 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.7127320766448975
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.958 Vali Acc: 0.821 Test Loss: 2.958 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3910023
model size : 16.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.03097128868103
Epoch: 1, Steps: 67 | Train Loss: 10.633 Vali Loss: 12.163 Vali Acc: 0.353 Test Loss: 12.163 Test Acc: 0.353
Validation loss decreased (inf --> -0.352480).  Saving model ...
Epoch: 2 cost time: 7.136423587799072
Epoch: 2, Steps: 67 | Train Loss: 9.510 Vali Loss: 14.198 Vali Acc: 0.561 Test Loss: 14.198 Test Acc: 0.561
Validation loss decreased (-0.352480 --> -0.560552).  Saving model ...
Epoch: 3 cost time: 5.407001972198486
Epoch: 3, Steps: 67 | Train Loss: 2.689 Vali Loss: 13.558 Vali Acc: 0.601 Test Loss: 13.558 Test Acc: 0.601
Validation loss decreased (-0.560552 --> -0.601020).  Saving model ...
Epoch: 4 cost time: 6.151673316955566
Epoch: 4, Steps: 67 | Train Loss: 1.300 Vali Loss: 3.803 Vali Acc: 0.757 Test Loss: 3.803 Test Acc: 0.757
Validation loss decreased (-0.601020 --> -0.757187).  Saving model ...
Epoch: 5 cost time: 6.460769176483154
Epoch: 5, Steps: 67 | Train Loss: 0.595 Vali Loss: 2.984 Vali Acc: 0.780 Test Loss: 2.984 Test Acc: 0.780
Validation loss decreased (-0.757187 --> -0.780317).  Saving model ...
Epoch: 6 cost time: 4.9237635135650635
Epoch: 6, Steps: 67 | Train Loss: 0.163 Vali Loss: 4.370 Vali Acc: 0.821 Test Loss: 4.370 Test Acc: 0.821
Validation loss decreased (-0.780317 --> -0.820766).  Saving model ...
Epoch: 7 cost time: 5.535938024520874
Epoch: 7, Steps: 67 | Train Loss: 0.275 Vali Loss: 2.711 Vali Acc: 0.763 Test Loss: 2.711 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.007684707641602
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.780 Test Loss: 4.006 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.92530632019043
Epoch: 9, Steps: 67 | Train Loss: 0.232 Vali Loss: 4.020 Vali Acc: 0.792 Test Loss: 4.020 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.394077301025391
Epoch: 10, Steps: 67 | Train Loss: 1.008 Vali Loss: 8.741 Vali Acc: 0.671 Test Loss: 8.741 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.865872621536255
Epoch: 11, Steps: 67 | Train Loss: 0.776 Vali Loss: 19.974 Vali Acc: 0.613 Test Loss: 19.974 Test Acc: 0.613
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.3729472160339355
Epoch: 12, Steps: 67 | Train Loss: 0.733 Vali Loss: 4.580 Vali Acc: 0.746 Test Loss: 4.580 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.370277404785156
Epoch: 13, Steps: 67 | Train Loss: 0.074 Vali Loss: 8.440 Vali Acc: 0.780 Test Loss: 8.440 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.380753755569458
Epoch: 14, Steps: 67 | Train Loss: 0.036 Vali Loss: 8.218 Vali Acc: 0.757 Test Loss: 8.218 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.766394376754761
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.102 Vali Acc: 0.723 Test Loss: 10.102 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.820188760757446
Epoch: 16, Steps: 67 | Train Loss: 0.010 Vali Loss: 4.690 Vali Acc: 0.832 Test Loss: 4.690 Test Acc: 0.832
Validation loss decreased (-0.820766 --> -0.832323).  Saving model ...
Epoch: 17 cost time: 8.825565576553345
Epoch: 17, Steps: 67 | Train Loss: 0.041 Vali Loss: 13.143 Vali Acc: 0.723 Test Loss: 13.143 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.8631861209869385
Epoch: 18, Steps: 67 | Train Loss: 0.201 Vali Loss: 8.031 Vali Acc: 0.798 Test Loss: 8.031 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.176661968231201
Epoch: 19, Steps: 67 | Train Loss: 0.144 Vali Loss: 6.297 Vali Acc: 0.763 Test Loss: 6.297 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.427005767822266
Epoch: 20, Steps: 67 | Train Loss: 0.270 Vali Loss: 4.462 Vali Acc: 0.803 Test Loss: 4.462 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.226668357849121
Epoch: 21, Steps: 67 | Train Loss: 0.417 Vali Loss: 11.665 Vali Acc: 0.734 Test Loss: 11.665 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.6804211139678955
Epoch: 22, Steps: 67 | Train Loss: 0.105 Vali Loss: 5.218 Vali Acc: 0.815 Test Loss: 5.218 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.585423469543457
Epoch: 23, Steps: 67 | Train Loss: 0.427 Vali Loss: 14.365 Vali Acc: 0.728 Test Loss: 14.365 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.920047283172607
Epoch: 24, Steps: 67 | Train Loss: 0.630 Vali Loss: 14.181 Vali Acc: 0.751 Test Loss: 14.181 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.3903515338897705
Epoch: 25, Steps: 67 | Train Loss: 0.387 Vali Loss: 9.049 Vali Acc: 0.751 Test Loss: 9.049 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.8899827003479
Epoch: 26, Steps: 67 | Train Loss: 0.196 Vali Loss: 9.289 Vali Acc: 0.723 Test Loss: 9.289 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3479047
model size : 14.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 15.8155365
	speed: 0.2168s/iter; left time: 2883.6820s
Epoch: 1 cost time: 25.971776485443115
Epoch: 1, Steps: 134 | Train Loss: 76.094 Vali Loss: 29.848 Vali Acc: 0.555 Test Loss: 29.848 Test Acc: 0.555
Validation loss decreased (inf --> -0.554615).  Saving model ...
	iters: 100, epoch: 2 | loss: 41.6361923
	speed: 0.4348s/iter; left time: 5725.4401s
Epoch: 2 cost time: 22.949012517929077
Epoch: 2, Steps: 134 | Train Loss: 42.346 Vali Loss: 108.733 Vali Acc: 0.566 Test Loss: 108.733 Test Acc: 0.566
Validation loss decreased (-0.554615 --> -0.565387).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.4387s/iter; left time: 5718.0830s
Epoch: 3 cost time: 23.79975700378418
Epoch: 3, Steps: 134 | Train Loss: 48.397 Vali Loss: 66.275 Vali Acc: 0.647 Test Loss: 66.275 Test Acc: 0.647
Validation loss decreased (-0.565387 --> -0.646736).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3655s/iter; left time: 4714.4355s
Epoch: 4 cost time: 18.038914680480957
Epoch: 4, Steps: 134 | Train Loss: 4.917 Vali Loss: 32.751 Vali Acc: 0.757 Test Loss: 32.751 Test Acc: 0.757
Validation loss decreased (-0.646736 --> -0.756898).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4366s/iter; left time: 5573.0461s
Epoch: 5 cost time: 23.395361185073853
Epoch: 5, Steps: 134 | Train Loss: 1.211 Vali Loss: 71.026 Vali Acc: 0.694 Test Loss: 71.026 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4398s/iter; left time: 5555.0529s
Epoch: 6 cost time: 22.63865637779236
Epoch: 6, Steps: 134 | Train Loss: 4.506 Vali Loss: 22.958 Vali Acc: 0.798 Test Loss: 22.958 Test Acc: 0.798
Validation loss decreased (-0.756898 --> -0.797458).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4449s/iter; left time: 5560.4752s
Epoch: 7 cost time: 23.44240713119507
Epoch: 7, Steps: 134 | Train Loss: 0.571 Vali Loss: 27.910 Vali Acc: 0.746 Test Loss: 27.910 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.4538s/iter; left time: 5609.7390s
Epoch: 8 cost time: 25.600217580795288
Epoch: 8, Steps: 134 | Train Loss: 1.028 Vali Loss: 35.868 Vali Acc: 0.769 Test Loss: 35.868 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.4223s/iter; left time: 5163.8189s
Epoch: 9 cost time: 23.442079782485962
Epoch: 9, Steps: 134 | Train Loss: 4.876 Vali Loss: 53.251 Vali Acc: 0.688 Test Loss: 53.251 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.4313s/iter; left time: 5216.9794s
Epoch: 10 cost time: 26.53391122817993
Epoch: 10, Steps: 134 | Train Loss: 3.884 Vali Loss: 16.002 Vali Acc: 0.844 Test Loss: 16.002 Test Acc: 0.844
Validation loss decreased (-0.797458 --> -0.843771).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.4620s/iter; left time: 5525.4851s
Epoch: 11 cost time: 26.33606767654419
Epoch: 11, Steps: 134 | Train Loss: 0.889 Vali Loss: 29.850 Vali Acc: 0.798 Test Loss: 29.850 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.4432s/iter; left time: 5241.8835s
Epoch: 12 cost time: 26.05844783782959
Epoch: 12, Steps: 134 | Train Loss: 2.196 Vali Loss: 19.061 Vali Acc: 0.821 Test Loss: 19.061 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.4374s/iter; left time: 5114.9006s
Epoch: 13 cost time: 24.42320442199707
Epoch: 13, Steps: 134 | Train Loss: 0.940 Vali Loss: 20.414 Vali Acc: 0.757 Test Loss: 20.414 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.4963s/iter; left time: 5736.4902s
Epoch: 14 cost time: 27.468929052352905
Epoch: 14, Steps: 134 | Train Loss: 0.068 Vali Loss: 38.082 Vali Acc: 0.734 Test Loss: 38.082 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.4751s/iter; left time: 5428.5372s
Epoch: 15 cost time: 25.912596225738525
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 38.133 Vali Acc: 0.734 Test Loss: 38.133 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4517s/iter; left time: 5099.9510s
Epoch: 16 cost time: 22.49252438545227
Epoch: 16, Steps: 134 | Train Loss: 0.809 Vali Loss: 41.166 Vali Acc: 0.688 Test Loss: 41.166 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.4060s/iter; left time: 4529.4728s
Epoch: 17 cost time: 20.37444758415222
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 38.003 Vali Acc: 0.699 Test Loss: 38.003 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.4269s/iter; left time: 4705.4063s
Epoch: 18 cost time: 19.04380965232849
Epoch: 18, Steps: 134 | Train Loss: 0.000 Vali Loss: 37.648 Vali Acc: 0.711 Test Loss: 37.648 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.4220s/iter; left time: 4594.9284s
Epoch: 19 cost time: 18.740610599517822
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 37.376 Vali Acc: 0.717 Test Loss: 37.376 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.4230s/iter; left time: 4549.4256s
Epoch: 20 cost time: 21.958931922912598
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 37.438 Vali Acc: 0.717 Test Loss: 37.438 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 15552487
model size : 59.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.19168996810913
Epoch: 1, Steps: 67 | Train Loss: 14.258 Vali Loss: 48.815 Vali Acc: 0.416 Test Loss: 48.815 Test Acc: 0.416
Validation loss decreased (inf --> -0.415697).  Saving model ...
Epoch: 2 cost time: 9.192493438720703
Epoch: 2, Steps: 67 | Train Loss: 37.204 Vali Loss: 41.689 Vali Acc: 0.422 Test Loss: 41.689 Test Acc: 0.422
Validation loss decreased (-0.415697 --> -0.421548).  Saving model ...
Epoch: 3 cost time: 14.068876028060913
Epoch: 3, Steps: 67 | Train Loss: 16.254 Vali Loss: 43.297 Vali Acc: 0.595 Test Loss: 43.297 Test Acc: 0.595
Validation loss decreased (-0.421548 --> -0.594943).  Saving model ...
Epoch: 4 cost time: 8.23790431022644
Epoch: 4, Steps: 67 | Train Loss: 5.239 Vali Loss: 16.110 Vali Acc: 0.711 Test Loss: 16.110 Test Acc: 0.711
Validation loss decreased (-0.594943 --> -0.710822).  Saving model ...
Epoch: 5 cost time: 14.198859453201294
Epoch: 5, Steps: 67 | Train Loss: 1.350 Vali Loss: 6.985 Vali Acc: 0.809 Test Loss: 6.985 Test Acc: 0.809
Validation loss decreased (-0.710822 --> -0.809179).  Saving model ...
Epoch: 6 cost time: 8.826647996902466
Epoch: 6, Steps: 67 | Train Loss: 0.535 Vali Loss: 16.932 Vali Acc: 0.705 Test Loss: 16.932 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.64506483078003
Epoch: 7, Steps: 67 | Train Loss: 1.106 Vali Loss: 12.135 Vali Acc: 0.746 Test Loss: 12.135 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 13.326910734176636
Epoch: 8, Steps: 67 | Train Loss: 0.554 Vali Loss: 28.493 Vali Acc: 0.659 Test Loss: 28.493 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.965590953826904
Epoch: 9, Steps: 67 | Train Loss: 1.498 Vali Loss: 11.499 Vali Acc: 0.775 Test Loss: 11.499 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 13.32368516921997
Epoch: 10, Steps: 67 | Train Loss: 1.389 Vali Loss: 10.515 Vali Acc: 0.798 Test Loss: 10.515 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.052013635635376
Epoch: 11, Steps: 67 | Train Loss: 0.678 Vali Loss: 10.986 Vali Acc: 0.769 Test Loss: 10.986 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 12.074667930603027
Epoch: 12, Steps: 67 | Train Loss: 0.156 Vali Loss: 20.482 Vali Acc: 0.705 Test Loss: 20.482 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.758675813674927
Epoch: 13, Steps: 67 | Train Loss: 0.160 Vali Loss: 20.861 Vali Acc: 0.723 Test Loss: 20.861 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.922873497009277
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 18.059 Vali Acc: 0.757 Test Loss: 18.059 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.709029912948608
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 18.089 Vali Acc: 0.757 Test Loss: 18.089 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 7786983
model size : 30.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.685341835021973
Epoch: 1, Steps: 67 | Train Loss: 12.691 Vali Loss: 28.520 Vali Acc: 0.468 Test Loss: 28.520 Test Acc: 0.468
Validation loss decreased (inf --> -0.467923).  Saving model ...
Epoch: 2 cost time: 6.919354438781738
Epoch: 2, Steps: 67 | Train Loss: 15.181 Vali Loss: 17.699 Vali Acc: 0.595 Test Loss: 17.699 Test Acc: 0.595
Validation loss decreased (-0.467923 --> -0.595199).  Saving model ...
Epoch: 3 cost time: 8.624462366104126
Epoch: 3, Steps: 67 | Train Loss: 5.478 Vali Loss: 3.280 Vali Acc: 0.827 Test Loss: 3.280 Test Acc: 0.827
Validation loss decreased (-0.595199 --> -0.826557).  Saving model ...
Epoch: 4 cost time: 8.080097675323486
Epoch: 4, Steps: 67 | Train Loss: 2.008 Vali Loss: 8.043 Vali Acc: 0.728 Test Loss: 8.043 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.472424030303955
Epoch: 5, Steps: 67 | Train Loss: 1.906 Vali Loss: 6.093 Vali Acc: 0.798 Test Loss: 6.093 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.324084758758545
Epoch: 6, Steps: 67 | Train Loss: 1.440 Vali Loss: 6.053 Vali Acc: 0.792 Test Loss: 6.053 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.7244179248809814
Epoch: 7, Steps: 67 | Train Loss: 0.127 Vali Loss: 9.221 Vali Acc: 0.734 Test Loss: 9.221 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.948027849197388
Epoch: 8, Steps: 67 | Train Loss: 0.194 Vali Loss: 5.850 Vali Acc: 0.809 Test Loss: 5.850 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.227172374725342
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.790 Vali Acc: 0.803 Test Loss: 5.790 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.7215611934661865
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.784 Vali Acc: 0.803 Test Loss: 5.784 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 8.672512531280518
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.795 Vali Acc: 0.803 Test Loss: 5.795 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.462090969085693
Epoch: 12, Steps: 67 | Train Loss: 0.371 Vali Loss: 13.135 Vali Acc: 0.769 Test Loss: 13.135 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.904693126678467
Epoch: 13, Steps: 67 | Train Loss: 0.347 Vali Loss: 7.575 Vali Acc: 0.786 Test Loss: 7.575 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5198535
model size : 20.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.527531862258911
Epoch: 1, Steps: 67 | Train Loss: 6.978 Vali Loss: 28.977 Vali Acc: 0.451 Test Loss: 28.977 Test Acc: 0.451
Validation loss decreased (inf --> -0.450577).  Saving model ...
Epoch: 2 cost time: 2.3258776664733887
Epoch: 2, Steps: 67 | Train Loss: 7.629 Vali Loss: 3.047 Vali Acc: 0.775 Test Loss: 3.047 Test Acc: 0.775
Validation loss decreased (-0.450577 --> -0.774536).  Saving model ...
Epoch: 3 cost time: 2.3151586055755615
Epoch: 3, Steps: 67 | Train Loss: 2.807 Vali Loss: 8.566 Vali Acc: 0.688 Test Loss: 8.566 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2996978759765625
Epoch: 4, Steps: 67 | Train Loss: 1.466 Vali Loss: 8.329 Vali Acc: 0.642 Test Loss: 8.329 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4507076740264893
Epoch: 5, Steps: 67 | Train Loss: 2.929 Vali Loss: 4.895 Vali Acc: 0.815 Test Loss: 4.895 Test Acc: 0.815
Validation loss decreased (-0.774536 --> -0.814980).  Saving model ...
Epoch: 6 cost time: 2.3087868690490723
Epoch: 6, Steps: 67 | Train Loss: 0.893 Vali Loss: 23.273 Vali Acc: 0.538 Test Loss: 23.273 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3808798789978027
Epoch: 7, Steps: 67 | Train Loss: 0.341 Vali Loss: 13.571 Vali Acc: 0.728 Test Loss: 13.571 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2949235439300537
Epoch: 8, Steps: 67 | Train Loss: 0.174 Vali Loss: 8.600 Vali Acc: 0.746 Test Loss: 8.600 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3134233951568604
Epoch: 9, Steps: 67 | Train Loss: 0.060 Vali Loss: 9.814 Vali Acc: 0.792 Test Loss: 9.814 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.367936372756958
Epoch: 10, Steps: 67 | Train Loss: 0.320 Vali Loss: 7.864 Vali Acc: 0.803 Test Loss: 7.864 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.302886962890625
Epoch: 11, Steps: 67 | Train Loss: 0.155 Vali Loss: 11.223 Vali Acc: 0.780 Test Loss: 11.223 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.326526403427124
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 11.195 Vali Acc: 0.780 Test Loss: 11.195 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.293837308883667
Epoch: 13, Steps: 67 | Train Loss: 0.037 Vali Loss: 9.116 Vali Acc: 0.803 Test Loss: 9.116 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.324002265930176
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.494 Vali Acc: 0.798 Test Loss: 9.494 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.300063371658325
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 9.547 Vali Acc: 0.798 Test Loss: 9.547 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 3904391
model size : 15.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.926597356796265
Epoch: 1, Steps: 67 | Train Loss: 7.338 Vali Loss: 16.236 Vali Acc: 0.468 Test Loss: 16.236 Test Acc: 0.468
Validation loss decreased (inf --> -0.468046).  Saving model ...
Epoch: 2 cost time: 5.2438719272613525
Epoch: 2, Steps: 67 | Train Loss: 4.976 Vali Loss: 2.886 Vali Acc: 0.792 Test Loss: 2.886 Test Acc: 0.792
Validation loss decreased (-0.468046 --> -0.791879).  Saving model ...
Epoch: 3 cost time: 7.849761486053467
Epoch: 3, Steps: 67 | Train Loss: 3.191 Vali Loss: 12.081 Vali Acc: 0.590 Test Loss: 12.081 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.302541255950928
Epoch: 4, Steps: 67 | Train Loss: 2.109 Vali Loss: 3.350 Vali Acc: 0.746 Test Loss: 3.350 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.709641218185425
Epoch: 5, Steps: 67 | Train Loss: 0.099 Vali Loss: 2.059 Vali Acc: 0.786 Test Loss: 2.059 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.707286596298218
Epoch: 6, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.838 Test Loss: 1.724 Test Acc: 0.838
Validation loss decreased (-0.791879 --> -0.838133).  Saving model ...
Epoch: 7 cost time: 5.192573547363281
Epoch: 7, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.838 Test Loss: 1.676 Test Acc: 0.838
Validation loss decreased (-0.838133 --> -0.838134).  Saving model ...
Epoch: 8 cost time: 5.190098285675049
Epoch: 8, Steps: 67 | Train Loss: 0.063 Vali Loss: 2.370 Vali Acc: 0.838 Test Loss: 2.370 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.365780830383301
Epoch: 9, Steps: 67 | Train Loss: 0.043 Vali Loss: 7.605 Vali Acc: 0.711 Test Loss: 7.605 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.596981763839722
Epoch: 10, Steps: 67 | Train Loss: 1.843 Vali Loss: 20.228 Vali Acc: 0.486 Test Loss: 20.228 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.310512065887451
Epoch: 11, Steps: 67 | Train Loss: 1.713 Vali Loss: 8.403 Vali Acc: 0.694 Test Loss: 8.403 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.965870380401611
Epoch: 12, Steps: 67 | Train Loss: 0.412 Vali Loss: 8.604 Vali Acc: 0.688 Test Loss: 8.604 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.1125688552856445
Epoch: 13, Steps: 67 | Train Loss: 0.203 Vali Loss: 3.360 Vali Acc: 0.803 Test Loss: 3.360 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.3462607860565186
Epoch: 14, Steps: 67 | Train Loss: 0.049 Vali Loss: 3.368 Vali Acc: 0.821 Test Loss: 3.368 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.270332336425781
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.594 Vali Acc: 0.792 Test Loss: 3.594 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.598042011260986
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.488 Vali Acc: 0.803 Test Loss: 3.488 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.9936792850494385
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.470 Vali Acc: 0.803 Test Loss: 3.470 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2826055
model size : 11.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.2829248905181885
Epoch: 1, Steps: 67 | Train Loss: 5.080 Vali Loss: 7.166 Vali Acc: 0.451 Test Loss: 7.166 Test Acc: 0.451
Validation loss decreased (inf --> -0.450795).  Saving model ...
Epoch: 2 cost time: 4.549302816390991
Epoch: 2, Steps: 67 | Train Loss: 4.095 Vali Loss: 2.765 Vali Acc: 0.717 Test Loss: 2.765 Test Acc: 0.717
Validation loss decreased (-0.450795 --> -0.716735).  Saving model ...
Epoch: 3 cost time: 6.5382983684539795
Epoch: 3, Steps: 67 | Train Loss: 0.848 Vali Loss: 2.054 Vali Acc: 0.786 Test Loss: 2.054 Test Acc: 0.786
Validation loss decreased (-0.716735 --> -0.786107).  Saving model ...
Epoch: 4 cost time: 5.371190786361694
Epoch: 4, Steps: 67 | Train Loss: 0.743 Vali Loss: 3.383 Vali Acc: 0.746 Test Loss: 3.383 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.20343017578125
Epoch: 5, Steps: 67 | Train Loss: 0.786 Vali Loss: 4.423 Vali Acc: 0.728 Test Loss: 4.423 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.972955703735352
Epoch: 6, Steps: 67 | Train Loss: 0.357 Vali Loss: 2.754 Vali Acc: 0.780 Test Loss: 2.754 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.852950572967529
Epoch: 7, Steps: 67 | Train Loss: 0.011 Vali Loss: 6.306 Vali Acc: 0.699 Test Loss: 6.306 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.423803091049194
Epoch: 8, Steps: 67 | Train Loss: 0.214 Vali Loss: 5.826 Vali Acc: 0.711 Test Loss: 5.826 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.446399927139282
Epoch: 9, Steps: 67 | Train Loss: 0.396 Vali Loss: 3.154 Vali Acc: 0.792 Test Loss: 3.154 Test Acc: 0.792
Validation loss decreased (-0.786107 --> -0.791876).  Saving model ...
Epoch: 10 cost time: 5.374491214752197
Epoch: 10, Steps: 67 | Train Loss: 0.176 Vali Loss: 8.830 Vali Acc: 0.751 Test Loss: 8.830 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.147581338882446
Epoch: 11, Steps: 67 | Train Loss: 0.260 Vali Loss: 3.054 Vali Acc: 0.798 Test Loss: 3.054 Test Acc: 0.798
Validation loss decreased (-0.791876 --> -0.797657).  Saving model ...
Epoch: 12 cost time: 4.183126926422119
Epoch: 12, Steps: 67 | Train Loss: 0.248 Vali Loss: 3.218 Vali Acc: 0.803 Test Loss: 3.218 Test Acc: 0.803
Validation loss decreased (-0.797657 --> -0.803436).  Saving model ...
Epoch: 13 cost time: 5.451483726501465
Epoch: 13, Steps: 67 | Train Loss: 0.057 Vali Loss: 3.444 Vali Acc: 0.803 Test Loss: 3.444 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.082003116607666
Epoch: 14, Steps: 67 | Train Loss: 0.129 Vali Loss: 4.227 Vali Acc: 0.757 Test Loss: 4.227 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.8507490158081055
Epoch: 15, Steps: 67 | Train Loss: 0.093 Vali Loss: 5.117 Vali Acc: 0.728 Test Loss: 5.117 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.348994970321655
Epoch: 16, Steps: 67 | Train Loss: 0.066 Vali Loss: 4.186 Vali Acc: 0.780 Test Loss: 4.186 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.213221311569214
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.996 Vali Acc: 0.786 Test Loss: 2.996 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.245226621627808
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.057 Vali Acc: 0.798 Test Loss: 3.057 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.820368051528931
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.030 Vali Acc: 0.798 Test Loss: 3.030 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.677690744400024
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.029 Vali Acc: 0.798 Test Loss: 3.029 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.609523773193359
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.558 Vali Acc: 0.775 Test Loss: 2.558 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.225650787353516
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.629 Vali Acc: 0.775 Test Loss: 2.629 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1963431
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.862337589263916
Epoch: 1, Steps: 67 | Train Loss: 4.111 Vali Loss: 4.953 Vali Acc: 0.422 Test Loss: 4.953 Test Acc: 0.422
Validation loss decreased (inf --> -0.421916).  Saving model ...
Epoch: 2 cost time: 4.6324005126953125
Epoch: 2, Steps: 67 | Train Loss: 3.809 Vali Loss: 9.471 Vali Acc: 0.549 Test Loss: 9.471 Test Acc: 0.549
Validation loss decreased (-0.421916 --> -0.549038).  Saving model ...
Epoch: 3 cost time: 5.1637122631073
Epoch: 3, Steps: 67 | Train Loss: 0.529 Vali Loss: 2.736 Vali Acc: 0.705 Test Loss: 2.736 Test Acc: 0.705
Validation loss decreased (-0.549038 --> -0.705175).  Saving model ...
Epoch: 4 cost time: 6.663833379745483
Epoch: 4, Steps: 67 | Train Loss: 0.348 Vali Loss: 4.681 Vali Acc: 0.723 Test Loss: 4.681 Test Acc: 0.723
Validation loss decreased (-0.705175 --> -0.722497).  Saving model ...
Epoch: 5 cost time: 4.361786365509033
Epoch: 5, Steps: 67 | Train Loss: 0.569 Vali Loss: 2.914 Vali Acc: 0.792 Test Loss: 2.914 Test Acc: 0.792
Validation loss decreased (-0.722497 --> -0.791878).  Saving model ...
Epoch: 6 cost time: 5.724039316177368
Epoch: 6, Steps: 67 | Train Loss: 0.033 Vali Loss: 4.119 Vali Acc: 0.705 Test Loss: 4.119 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.428882598876953
Epoch: 7, Steps: 67 | Train Loss: 0.065 Vali Loss: 5.792 Vali Acc: 0.711 Test Loss: 5.792 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.580793857574463
Epoch: 8, Steps: 67 | Train Loss: 0.482 Vali Loss: 2.453 Vali Acc: 0.815 Test Loss: 2.453 Test Acc: 0.815
Validation loss decreased (-0.791878 --> -0.815004).  Saving model ...
Epoch: 9 cost time: 4.677440166473389
Epoch: 9, Steps: 67 | Train Loss: 0.076 Vali Loss: 4.719 Vali Acc: 0.723 Test Loss: 4.719 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.972681045532227
Epoch: 10, Steps: 67 | Train Loss: 0.256 Vali Loss: 2.813 Vali Acc: 0.827 Test Loss: 2.813 Test Acc: 0.827
Validation loss decreased (-0.815004 --> -0.826561).  Saving model ...
Epoch: 11 cost time: 4.8255181312561035
Epoch: 11, Steps: 67 | Train Loss: 0.081 Vali Loss: 4.569 Vali Acc: 0.757 Test Loss: 4.569 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.378950834274292
Epoch: 12, Steps: 67 | Train Loss: 0.033 Vali Loss: 1.377 Vali Acc: 0.844 Test Loss: 1.377 Test Acc: 0.844
Validation loss decreased (-0.826561 --> -0.843917).  Saving model ...
Epoch: 13 cost time: 6.520952939987183
Epoch: 13, Steps: 67 | Train Loss: 0.003 Vali Loss: 3.832 Vali Acc: 0.769 Test Loss: 3.832 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.5118021965026855
Epoch: 14, Steps: 67 | Train Loss: 0.075 Vali Loss: 3.379 Vali Acc: 0.815 Test Loss: 3.379 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.40733528137207
Epoch: 15, Steps: 67 | Train Loss: 0.211 Vali Loss: 4.541 Vali Acc: 0.728 Test Loss: 4.541 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.95005464553833
Epoch: 16, Steps: 67 | Train Loss: 1.069 Vali Loss: 4.310 Vali Acc: 0.798 Test Loss: 4.310 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.417562246322632
Epoch: 17, Steps: 67 | Train Loss: 0.244 Vali Loss: 3.519 Vali Acc: 0.855 Test Loss: 3.519 Test Acc: 0.855
Validation loss decreased (-0.843917 --> -0.855456).  Saving model ...
Epoch: 18 cost time: 5.067074298858643
Epoch: 18, Steps: 67 | Train Loss: 0.365 Vali Loss: 3.757 Vali Acc: 0.815 Test Loss: 3.757 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.384080171585083
Epoch: 19, Steps: 67 | Train Loss: 0.170 Vali Loss: 2.836 Vali Acc: 0.809 Test Loss: 2.836 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.740683555603027
Epoch: 20, Steps: 67 | Train Loss: 0.021 Vali Loss: 7.502 Vali Acc: 0.711 Test Loss: 7.502 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.719637393951416
Epoch: 21, Steps: 67 | Train Loss: 0.339 Vali Loss: 1.765 Vali Acc: 0.861 Test Loss: 1.765 Test Acc: 0.861
Validation loss decreased (-0.855456 --> -0.861254).  Saving model ...
Epoch: 22 cost time: 4.743770122528076
Epoch: 22, Steps: 67 | Train Loss: 0.124 Vali Loss: 6.900 Vali Acc: 0.705 Test Loss: 6.900 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.301969766616821
Epoch: 23, Steps: 67 | Train Loss: 1.420 Vali Loss: 10.409 Vali Acc: 0.717 Test Loss: 10.409 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.083323001861572
Epoch: 24, Steps: 67 | Train Loss: 0.820 Vali Loss: 5.288 Vali Acc: 0.827 Test Loss: 5.288 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.025641679763794
Epoch: 25, Steps: 67 | Train Loss: 0.009 Vali Loss: 8.571 Vali Acc: 0.734 Test Loss: 8.571 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.818277359008789
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.917 Vali Acc: 0.740 Test Loss: 7.917 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.586179971694946
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.939 Vali Acc: 0.740 Test Loss: 7.939 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.092656850814819
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.864 Vali Acc: 0.740 Test Loss: 7.864 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.119507789611816
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.949 Vali Acc: 0.751 Test Loss: 7.949 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.848431587219238
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.792 Vali Acc: 0.740 Test Loss: 7.792 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.226861238479614
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.603 Vali Acc: 0.873 Test Loss: 3.603 Test Acc: 0.873
Validation loss decreased (-0.861254 --> -0.872796).  Saving model ...
Epoch: 32 cost time: 5.962616920471191
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.696 Vali Acc: 0.873 Test Loss: 3.696 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.60336446762085
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.729 Vali Acc: 0.855 Test Loss: 3.729 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.547482252120972
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.716 Vali Acc: 0.855 Test Loss: 3.716 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.161412000656128
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.742 Vali Acc: 0.855 Test Loss: 3.742 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.254116058349609
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.718 Vali Acc: 0.855 Test Loss: 3.718 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.900342702865601
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.717 Vali Acc: 0.855 Test Loss: 3.717 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.901755094528198
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.690 Vali Acc: 0.867 Test Loss: 3.690 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 5.347614526748657
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.694 Vali Acc: 0.855 Test Loss: 3.694 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.5263917446136475
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.721 Vali Acc: 0.867 Test Loss: 3.721 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.563666343688965
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.691 Vali Acc: 0.855 Test Loss: 3.691 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1747943
model size : 7.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 113.4487381
	speed: 0.2105s/iter; left time: 2799.2555s
Epoch: 1 cost time: 27.050463914871216
Epoch: 1, Steps: 134 | Train Loss: 102.426 Vali Loss: 116.565 Vali Acc: 0.445 Test Loss: 116.565 Test Acc: 0.445
Validation loss decreased (inf --> -0.443921).  Saving model ...
	iters: 100, epoch: 2 | loss: 21.5004864
	speed: 0.4208s/iter; left time: 5541.0980s
Epoch: 2 cost time: 19.550893783569336
Epoch: 2, Steps: 134 | Train Loss: 60.544 Vali Loss: 152.276 Vali Acc: 0.416 Test Loss: 152.276 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.3881s/iter; left time: 5057.9567s
Epoch: 3 cost time: 18.796130418777466
Epoch: 3, Steps: 134 | Train Loss: 33.637 Vali Loss: 20.438 Vali Acc: 0.740 Test Loss: 20.438 Test Acc: 0.740
Validation loss decreased (-0.443921 --> -0.739680).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3993s/iter; left time: 5150.7212s
Epoch: 4 cost time: 18.266575574874878
Epoch: 4, Steps: 134 | Train Loss: 12.075 Vali Loss: 28.647 Vali Acc: 0.694 Test Loss: 28.647 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.4219s/iter; left time: 5385.6367s
Epoch: 5 cost time: 21.897478342056274
Epoch: 5, Steps: 134 | Train Loss: 14.467 Vali Loss: 29.842 Vali Acc: 0.653 Test Loss: 29.842 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.4333s/iter; left time: 5473.0294s
Epoch: 6 cost time: 24.95693039894104
Epoch: 6, Steps: 134 | Train Loss: 4.250 Vali Loss: 24.359 Vali Acc: 0.699 Test Loss: 24.359 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.4183s/iter; left time: 5227.3711s
Epoch: 7 cost time: 23.876495838165283
Epoch: 7, Steps: 134 | Train Loss: 0.052 Vali Loss: 18.771 Vali Acc: 0.728 Test Loss: 18.771 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3955s/iter; left time: 4889.2480s
Epoch: 8 cost time: 23.22616720199585
Epoch: 8, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.776 Vali Acc: 0.728 Test Loss: 18.776 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3750s/iter; left time: 4585.6011s
Epoch: 9 cost time: 18.37831449508667
Epoch: 9, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.979 Vali Acc: 0.728 Test Loss: 18.979 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3818s/iter; left time: 4617.7616s
Epoch: 10 cost time: 15.955105066299438
Epoch: 10, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.899 Vali Acc: 0.728 Test Loss: 18.899 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2989s/iter; left time: 3574.9577s
Epoch: 11 cost time: 15.352974891662598
Epoch: 11, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.035 Vali Acc: 0.728 Test Loss: 19.035 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3731s/iter; left time: 4412.2675s
Epoch: 12 cost time: 16.621304988861084
Epoch: 12, Steps: 134 | Train Loss: 0.000 Vali Loss: 18.849 Vali Acc: 0.728 Test Loss: 18.849 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3815s/iter; left time: 4460.6885s
Epoch: 13 cost time: 18.146061182022095
Epoch: 13, Steps: 134 | Train Loss: 0.000 Vali Loss: 19.071 Vali Acc: 0.728 Test Loss: 19.071 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 15544167
model size : 59.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 13.893164873123169
Epoch: 1, Steps: 67 | Train Loss: 14.748 Vali Loss: 28.443 Vali Acc: 0.410 Test Loss: 28.443 Test Acc: 0.410
Validation loss decreased (inf --> -0.410120).  Saving model ...
Epoch: 2 cost time: 8.499401569366455
Epoch: 2, Steps: 67 | Train Loss: 28.452 Vali Loss: 29.660 Vali Acc: 0.520 Test Loss: 29.660 Test Acc: 0.520
Validation loss decreased (-0.410120 --> -0.519935).  Saving model ...
Epoch: 3 cost time: 10.749100923538208
Epoch: 3, Steps: 67 | Train Loss: 7.463 Vali Loss: 20.963 Vali Acc: 0.682 Test Loss: 20.963 Test Acc: 0.682
Validation loss decreased (-0.519935 --> -0.681871).  Saving model ...
Epoch: 4 cost time: 7.298231840133667
Epoch: 4, Steps: 67 | Train Loss: 15.596 Vali Loss: 15.760 Vali Acc: 0.682 Test Loss: 15.760 Test Acc: 0.682
Validation loss decreased (-0.681871 --> -0.681923).  Saving model ...
Epoch: 5 cost time: 12.438796997070312
Epoch: 5, Steps: 67 | Train Loss: 5.094 Vali Loss: 18.782 Vali Acc: 0.734 Test Loss: 18.782 Test Acc: 0.734
Validation loss decreased (-0.681923 --> -0.733916).  Saving model ...
Epoch: 6 cost time: 7.588273763656616
Epoch: 6, Steps: 67 | Train Loss: 0.461 Vali Loss: 7.994 Vali Acc: 0.809 Test Loss: 7.994 Test Acc: 0.809
Validation loss decreased (-0.733916 --> -0.809169).  Saving model ...
Epoch: 7 cost time: 12.1288743019104
Epoch: 7, Steps: 67 | Train Loss: 0.501 Vali Loss: 8.670 Vali Acc: 0.798 Test Loss: 8.670 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.78471565246582
Epoch: 8, Steps: 67 | Train Loss: 1.374 Vali Loss: 25.566 Vali Acc: 0.717 Test Loss: 25.566 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.923361539840698
Epoch: 9, Steps: 67 | Train Loss: 0.666 Vali Loss: 7.406 Vali Acc: 0.832 Test Loss: 7.406 Test Acc: 0.832
Validation loss decreased (-0.809169 --> -0.832296).  Saving model ...
Epoch: 10 cost time: 8.04149341583252
Epoch: 10, Steps: 67 | Train Loss: 0.496 Vali Loss: 23.832 Vali Acc: 0.740 Test Loss: 23.832 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.82812237739563
Epoch: 11, Steps: 67 | Train Loss: 2.967 Vali Loss: 7.847 Vali Acc: 0.798 Test Loss: 7.847 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.161716938018799
Epoch: 12, Steps: 67 | Train Loss: 6.826 Vali Loss: 10.603 Vali Acc: 0.792 Test Loss: 10.603 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.871499061584473
Epoch: 13, Steps: 67 | Train Loss: 0.839 Vali Loss: 7.997 Vali Acc: 0.832 Test Loss: 7.997 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.081554889678955
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.672 Vali Acc: 0.815 Test Loss: 6.672 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.538139581680298
Epoch: 15, Steps: 67 | Train Loss: 0.253 Vali Loss: 8.616 Vali Acc: 0.821 Test Loss: 8.616 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.817302227020264
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.639 Vali Acc: 0.803 Test Loss: 10.639 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.550210237503052
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.624 Vali Acc: 0.803 Test Loss: 10.624 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.601031541824341
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.632 Vali Acc: 0.803 Test Loss: 10.632 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.49360728263855
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.642 Vali Acc: 0.803 Test Loss: 10.642 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7778663
model size : 30.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.35654592514038
Epoch: 1, Steps: 67 | Train Loss: 11.163 Vali Loss: 19.687 Vali Acc: 0.439 Test Loss: 19.687 Test Acc: 0.439
Validation loss decreased (inf --> -0.439109).  Saving model ...
Epoch: 2 cost time: 6.275073766708374
Epoch: 2, Steps: 67 | Train Loss: 15.995 Vali Loss: 13.730 Vali Acc: 0.642 Test Loss: 13.730 Test Acc: 0.642
Validation loss decreased (-0.439109 --> -0.641481).  Saving model ...
Epoch: 3 cost time: 7.654785871505737
Epoch: 3, Steps: 67 | Train Loss: 7.706 Vali Loss: 8.511 Vali Acc: 0.711 Test Loss: 8.511 Test Acc: 0.711
Validation loss decreased (-0.641481 --> -0.710898).  Saving model ...
Epoch: 4 cost time: 7.1849212646484375
Epoch: 4, Steps: 67 | Train Loss: 5.023 Vali Loss: 14.616 Vali Acc: 0.740 Test Loss: 14.616 Test Acc: 0.740
Validation loss decreased (-0.710898 --> -0.739738).  Saving model ...
Epoch: 5 cost time: 7.437731742858887
Epoch: 5, Steps: 67 | Train Loss: 2.052 Vali Loss: 9.997 Vali Acc: 0.763 Test Loss: 9.997 Test Acc: 0.763
Validation loss decreased (-0.739738 --> -0.762906).  Saving model ...
Epoch: 6 cost time: 7.1002278327941895
Epoch: 6, Steps: 67 | Train Loss: 1.832 Vali Loss: 17.695 Vali Acc: 0.676 Test Loss: 17.695 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.557520151138306
Epoch: 7, Steps: 67 | Train Loss: 0.687 Vali Loss: 8.404 Vali Acc: 0.780 Test Loss: 8.404 Test Acc: 0.780
Validation loss decreased (-0.762906 --> -0.780263).  Saving model ...
Epoch: 8 cost time: 5.516174793243408
Epoch: 8, Steps: 67 | Train Loss: 0.162 Vali Loss: 18.169 Vali Acc: 0.757 Test Loss: 18.169 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.175012350082397
Epoch: 9, Steps: 67 | Train Loss: 0.329 Vali Loss: 8.369 Vali Acc: 0.711 Test Loss: 8.369 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.53338360786438
Epoch: 10, Steps: 67 | Train Loss: 1.929 Vali Loss: 13.788 Vali Acc: 0.792 Test Loss: 13.788 Test Acc: 0.792
Validation loss decreased (-0.780263 --> -0.791770).  Saving model ...
Epoch: 11 cost time: 8.553547143936157
Epoch: 11, Steps: 67 | Train Loss: 0.214 Vali Loss: 12.799 Vali Acc: 0.746 Test Loss: 12.799 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.773169755935669
Epoch: 12, Steps: 67 | Train Loss: 0.342 Vali Loss: 7.983 Vali Acc: 0.798 Test Loss: 7.983 Test Acc: 0.798
Validation loss decreased (-0.791770 --> -0.797608).  Saving model ...
Epoch: 13 cost time: 6.289637327194214
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.034 Vali Acc: 0.798 Test Loss: 8.034 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.089481830596924
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.056 Vali Acc: 0.798 Test Loss: 8.056 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.986088514328003
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 8.017 Vali Acc: 0.798 Test Loss: 8.017 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.3292834758758545
Epoch: 16, Steps: 67 | Train Loss: 0.279 Vali Loss: 15.011 Vali Acc: 0.757 Test Loss: 15.011 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.444915771484375
Epoch: 17, Steps: 67 | Train Loss: 1.251 Vali Loss: 9.435 Vali Acc: 0.751 Test Loss: 9.435 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.748605966567993
Epoch: 18, Steps: 67 | Train Loss: 0.972 Vali Loss: 18.147 Vali Acc: 0.734 Test Loss: 18.147 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.392034292221069
Epoch: 19, Steps: 67 | Train Loss: 0.937 Vali Loss: 15.359 Vali Acc: 0.769 Test Loss: 15.359 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.167889833450317
Epoch: 20, Steps: 67 | Train Loss: 0.166 Vali Loss: 9.901 Vali Acc: 0.803 Test Loss: 9.901 Test Acc: 0.803
Validation loss decreased (-0.797608 --> -0.803369).  Saving model ...
Epoch: 21 cost time: 5.93109655380249
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 10.376 Vali Acc: 0.803 Test Loss: 10.376 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.114869832992554
Epoch: 22, Steps: 67 | Train Loss: 0.349 Vali Loss: 11.821 Vali Acc: 0.757 Test Loss: 11.821 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.986224889755249
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.833 Vali Acc: 0.740 Test Loss: 12.833 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.744379281997681
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.827 Vali Acc: 0.746 Test Loss: 12.827 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.710087537765503
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.819 Vali Acc: 0.740 Test Loss: 12.819 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.85329794883728
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.832 Vali Acc: 0.740 Test Loss: 12.832 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.4240500926971436
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 12.839 Vali Acc: 0.740 Test Loss: 12.839 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.173851490020752
Epoch: 28, Steps: 67 | Train Loss: 0.119 Vali Loss: 10.420 Vali Acc: 0.798 Test Loss: 10.420 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.428964138031006
Epoch: 29, Steps: 67 | Train Loss: 0.058 Vali Loss: 16.059 Vali Acc: 0.775 Test Loss: 16.059 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.763370513916016
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 16.033 Vali Acc: 0.775 Test Loss: 16.033 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 5190215
model size : 20.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.55504298210144
Epoch: 1, Steps: 67 | Train Loss: 9.152 Vali Loss: 19.705 Vali Acc: 0.347 Test Loss: 19.705 Test Acc: 0.347
Validation loss decreased (inf --> -0.346624).  Saving model ...
Epoch: 2 cost time: 5.85673189163208
Epoch: 2, Steps: 67 | Train Loss: 12.246 Vali Loss: 7.671 Vali Acc: 0.688 Test Loss: 7.671 Test Acc: 0.688
Validation loss decreased (-0.346624 --> -0.687785).  Saving model ...
Epoch: 3 cost time: 6.8382887840271
Epoch: 3, Steps: 67 | Train Loss: 3.166 Vali Loss: 9.955 Vali Acc: 0.624 Test Loss: 9.955 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.481604099273682
Epoch: 4, Steps: 67 | Train Loss: 3.886 Vali Loss: 10.015 Vali Acc: 0.705 Test Loss: 10.015 Test Acc: 0.705
Validation loss decreased (-0.687785 --> -0.705102).  Saving model ...
Epoch: 5 cost time: 7.955624341964722
Epoch: 5, Steps: 67 | Train Loss: 1.775 Vali Loss: 5.530 Vali Acc: 0.809 Test Loss: 5.530 Test Acc: 0.809
Validation loss decreased (-0.705102 --> -0.809193).  Saving model ...
Epoch: 6 cost time: 5.350066184997559
Epoch: 6, Steps: 67 | Train Loss: 0.577 Vali Loss: 10.721 Vali Acc: 0.676 Test Loss: 10.721 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.758315563201904
Epoch: 7, Steps: 67 | Train Loss: 1.329 Vali Loss: 13.318 Vali Acc: 0.688 Test Loss: 13.318 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.188776969909668
Epoch: 8, Steps: 67 | Train Loss: 1.216 Vali Loss: 11.296 Vali Acc: 0.694 Test Loss: 11.296 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.991243124008179
Epoch: 9, Steps: 67 | Train Loss: 0.180 Vali Loss: 7.127 Vali Acc: 0.832 Test Loss: 7.127 Test Acc: 0.832
Validation loss decreased (-0.809193 --> -0.832299).  Saving model ...
Epoch: 10 cost time: 6.588780879974365
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.813 Vali Acc: 0.809 Test Loss: 7.813 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.427223205566406
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.807 Vali Acc: 0.809 Test Loss: 7.807 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.90030837059021
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.791 Vali Acc: 0.809 Test Loss: 7.791 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.852834463119507
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.782 Vali Acc: 0.809 Test Loss: 7.782 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.977117538452148
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.809 Vali Acc: 0.809 Test Loss: 7.809 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.602281093597412
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.784 Vali Acc: 0.809 Test Loss: 7.784 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.595357179641724
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.795 Vali Acc: 0.809 Test Loss: 7.795 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.396609306335449
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.808 Vali Acc: 0.809 Test Loss: 7.808 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.26233434677124
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.735 Vali Acc: 0.809 Test Loss: 7.735 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.95273756980896
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.754 Vali Acc: 0.809 Test Loss: 7.754 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3896071
model size : 15.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.099076509475708
Epoch: 1, Steps: 67 | Train Loss: 5.719 Vali Loss: 7.701 Vali Acc: 0.543 Test Loss: 7.701 Test Acc: 0.543
Validation loss decreased (inf --> -0.543276).  Saving model ...
Epoch: 2 cost time: 4.161808252334595
Epoch: 2, Steps: 67 | Train Loss: 7.499 Vali Loss: 4.854 Vali Acc: 0.618 Test Loss: 4.854 Test Acc: 0.618
Validation loss decreased (-0.543276 --> -0.618449).  Saving model ...
Epoch: 3 cost time: 5.679224967956543
Epoch: 3, Steps: 67 | Train Loss: 1.928 Vali Loss: 3.321 Vali Acc: 0.723 Test Loss: 3.321 Test Acc: 0.723
Validation loss decreased (-0.618449 --> -0.722510).  Saving model ...
Epoch: 4 cost time: 5.01601243019104
Epoch: 4, Steps: 67 | Train Loss: 2.490 Vali Loss: 4.894 Vali Acc: 0.688 Test Loss: 4.894 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.850390911102295
Epoch: 5, Steps: 67 | Train Loss: 0.866 Vali Loss: 5.958 Vali Acc: 0.699 Test Loss: 5.958 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.285184144973755
Epoch: 6, Steps: 67 | Train Loss: 0.472 Vali Loss: 3.136 Vali Acc: 0.803 Test Loss: 3.136 Test Acc: 0.803
Validation loss decreased (-0.722510 --> -0.803437).  Saving model ...
Epoch: 7 cost time: 4.249929904937744
Epoch: 7, Steps: 67 | Train Loss: 1.013 Vali Loss: 7.543 Vali Acc: 0.757 Test Loss: 7.543 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.4555487632751465
Epoch: 8, Steps: 67 | Train Loss: 0.453 Vali Loss: 4.113 Vali Acc: 0.803 Test Loss: 4.113 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.15111231803894
Epoch: 9, Steps: 67 | Train Loss: 0.005 Vali Loss: 5.600 Vali Acc: 0.769 Test Loss: 5.600 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.564448833465576
Epoch: 10, Steps: 67 | Train Loss: 0.018 Vali Loss: 3.831 Vali Acc: 0.798 Test Loss: 3.831 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.00903058052063
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.809 Test Loss: 2.945 Test Acc: 0.809
Validation loss decreased (-0.803437 --> -0.809219).  Saving model ...
Epoch: 12 cost time: 5.791790246963501
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.935 Vali Acc: 0.809 Test Loss: 2.935 Test Acc: 0.809
Validation loss decreased (-0.809219 --> -0.809219).  Saving model ...
Epoch: 13 cost time: 4.446775913238525
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.964 Vali Acc: 0.809 Test Loss: 2.964 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.217191457748413
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.938 Vali Acc: 0.809 Test Loss: 2.938 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.2956154346466064
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.809 Test Loss: 2.930 Test Acc: 0.809
Validation loss decreased (-0.809219 --> -0.809219).  Saving model ...
Epoch: 16 cost time: 4.459801197052002
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.943 Vali Acc: 0.809 Test Loss: 2.943 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.2047107219696045
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.951 Vali Acc: 0.809 Test Loss: 2.951 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.068927049636841
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.933 Vali Acc: 0.809 Test Loss: 2.933 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.073566436767578
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.931 Vali Acc: 0.809 Test Loss: 2.931 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.166880130767822
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.931 Vali Acc: 0.809 Test Loss: 2.931 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.02782678604126
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.945 Vali Acc: 0.809 Test Loss: 2.945 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.4364635944366455
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.927 Vali Acc: 0.809 Test Loss: 2.927 Test Acc: 0.809
Validation loss decreased (-0.809219 --> -0.809219).  Saving model ...
Epoch: 23 cost time: 4.5695412158966064
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.931 Vali Acc: 0.815 Test Loss: 2.931 Test Acc: 0.815
Validation loss decreased (-0.809219 --> -0.815000).  Saving model ...
Epoch: 24 cost time: 5.987492561340332
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.944 Vali Acc: 0.809 Test Loss: 2.944 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.541559934616089
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.809 Test Loss: 2.948 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.42055606842041
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.941 Vali Acc: 0.815 Test Loss: 2.941 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.607441425323486
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.930 Vali Acc: 0.809 Test Loss: 2.930 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.704540491104126
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.943 Vali Acc: 0.809 Test Loss: 2.943 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.160808801651001
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.934 Vali Acc: 0.815 Test Loss: 2.934 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.057579278945923
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.968 Vali Acc: 0.809 Test Loss: 2.968 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.9432079792022705
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.948 Vali Acc: 0.815 Test Loss: 2.948 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.678875684738159
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.960 Vali Acc: 0.815 Test Loss: 2.960 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.408758640289307
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.963 Vali Acc: 0.809 Test Loss: 2.963 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2817735
model size : 11.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.120073080062866
Epoch: 1, Steps: 67 | Train Loss: 5.281 Vali Loss: 4.077 Vali Acc: 0.497 Test Loss: 4.077 Test Acc: 0.497
Validation loss decreased (inf --> -0.497069).  Saving model ...
Epoch: 2 cost time: 4.271501779556274
Epoch: 2, Steps: 67 | Train Loss: 3.836 Vali Loss: 4.612 Vali Acc: 0.647 Test Loss: 4.612 Test Acc: 0.647
Validation loss decreased (-0.497069 --> -0.647353).  Saving model ...
Epoch: 3 cost time: 4.459809064865112
Epoch: 3, Steps: 67 | Train Loss: 1.776 Vali Loss: 3.878 Vali Acc: 0.699 Test Loss: 3.878 Test Acc: 0.699
Validation loss decreased (-0.647353 --> -0.699383).  Saving model ...
Epoch: 4 cost time: 4.656339883804321
Epoch: 4, Steps: 67 | Train Loss: 1.359 Vali Loss: 2.066 Vali Acc: 0.780 Test Loss: 2.066 Test Acc: 0.780
Validation loss decreased (-0.699383 --> -0.780326).  Saving model ...
Epoch: 5 cost time: 3.986056089401245
Epoch: 5, Steps: 67 | Train Loss: 0.179 Vali Loss: 2.127 Vali Acc: 0.798 Test Loss: 2.127 Test Acc: 0.798
Validation loss decreased (-0.780326 --> -0.797667).  Saving model ...
Epoch: 6 cost time: 4.633070945739746
Epoch: 6, Steps: 67 | Train Loss: 0.058 Vali Loss: 4.875 Vali Acc: 0.786 Test Loss: 4.875 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.6765124797821045
Epoch: 7, Steps: 67 | Train Loss: 0.145 Vali Loss: 3.857 Vali Acc: 0.792 Test Loss: 3.857 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.130486011505127
Epoch: 8, Steps: 67 | Train Loss: 0.142 Vali Loss: 2.990 Vali Acc: 0.838 Test Loss: 2.990 Test Acc: 0.838
Validation loss decreased (-0.797667 --> -0.838120).  Saving model ...
Epoch: 9 cost time: 4.912143707275391
Epoch: 9, Steps: 67 | Train Loss: 0.046 Vali Loss: 13.207 Vali Acc: 0.682 Test Loss: 13.207 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.920382738113403
Epoch: 10, Steps: 67 | Train Loss: 1.852 Vali Loss: 6.797 Vali Acc: 0.694 Test Loss: 6.797 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8626418113708496
Epoch: 11, Steps: 67 | Train Loss: 0.569 Vali Loss: 2.968 Vali Acc: 0.815 Test Loss: 2.968 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.354276180267334
Epoch: 12, Steps: 67 | Train Loss: 0.052 Vali Loss: 3.752 Vali Acc: 0.746 Test Loss: 3.752 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.396852016448975
Epoch: 13, Steps: 67 | Train Loss: 0.076 Vali Loss: 2.640 Vali Acc: 0.803 Test Loss: 2.640 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.944009304046631
Epoch: 14, Steps: 67 | Train Loss: 0.041 Vali Loss: 1.511 Vali Acc: 0.844 Test Loss: 1.511 Test Acc: 0.844
Validation loss decreased (-0.838120 --> -0.843916).  Saving model ...
Epoch: 15 cost time: 5.0416882038116455
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.501 Vali Acc: 0.832 Test Loss: 2.501 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.5518858432769775
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.054 Vali Acc: 0.861 Test Loss: 2.054 Test Acc: 0.861
Validation loss decreased (-0.843916 --> -0.861251).  Saving model ...
Epoch: 17 cost time: 3.804204225540161
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.861 Test Loss: 2.042 Test Acc: 0.861
Validation loss decreased (-0.861251 --> -0.861251).  Saving model ...
Epoch: 18 cost time: 5.2011518478393555
Epoch: 18, Steps: 67 | Train Loss: 0.055 Vali Loss: 2.513 Vali Acc: 0.827 Test Loss: 2.513 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.180091619491577
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.621 Vali Acc: 0.827 Test Loss: 2.621 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9417059421539307
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.622 Vali Acc: 0.832 Test Loss: 2.622 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.096588611602783
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.585 Vali Acc: 0.832 Test Loss: 2.585 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.8907196521759033
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.328 Vali Acc: 0.803 Test Loss: 3.328 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.673600912094116
Epoch: 23, Steps: 67 | Train Loss: 0.066 Vali Loss: 3.749 Vali Acc: 0.740 Test Loss: 3.749 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.968652009963989
Epoch: 24, Steps: 67 | Train Loss: 0.028 Vali Loss: 5.051 Vali Acc: 0.723 Test Loss: 5.051 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.94750714302063
Epoch: 25, Steps: 67 | Train Loss: 0.287 Vali Loss: 4.645 Vali Acc: 0.786 Test Loss: 4.645 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3567283153533936
Epoch: 26, Steps: 67 | Train Loss: 0.298 Vali Loss: 7.103 Vali Acc: 0.757 Test Loss: 7.103 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.080919504165649
Epoch: 27, Steps: 67 | Train Loss: 0.382 Vali Loss: 10.304 Vali Acc: 0.757 Test Loss: 10.304 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1955111
model size : 8.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.5028462409973145
Epoch: 1, Steps: 67 | Train Loss: 4.014 Vali Loss: 7.837 Vali Acc: 0.561 Test Loss: 7.837 Test Acc: 0.561
Validation loss decreased (inf --> -0.560615).  Saving model ...
Epoch: 2 cost time: 3.5233638286590576
Epoch: 2, Steps: 67 | Train Loss: 4.321 Vali Loss: 2.957 Vali Acc: 0.728 Test Loss: 2.957 Test Acc: 0.728
Validation loss decreased (-0.560615 --> -0.728294).  Saving model ...
Epoch: 3 cost time: 4.24509072303772
Epoch: 3, Steps: 67 | Train Loss: 1.863 Vali Loss: 2.949 Vali Acc: 0.792 Test Loss: 2.949 Test Acc: 0.792
Validation loss decreased (-0.728294 --> -0.791878).  Saving model ...
Epoch: 4 cost time: 4.071784734725952
Epoch: 4, Steps: 67 | Train Loss: 0.422 Vali Loss: 2.646 Vali Acc: 0.763 Test Loss: 2.646 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.03487491607666
Epoch: 5, Steps: 67 | Train Loss: 0.165 Vali Loss: 4.903 Vali Acc: 0.769 Test Loss: 4.903 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9980366230010986
Epoch: 6, Steps: 67 | Train Loss: 0.119 Vali Loss: 3.184 Vali Acc: 0.757 Test Loss: 3.184 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.320594310760498
Epoch: 7, Steps: 67 | Train Loss: 0.216 Vali Loss: 4.107 Vali Acc: 0.647 Test Loss: 4.107 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2450053691864014
Epoch: 8, Steps: 67 | Train Loss: 0.264 Vali Loss: 4.948 Vali Acc: 0.694 Test Loss: 4.948 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.9651615619659424
Epoch: 9, Steps: 67 | Train Loss: 0.887 Vali Loss: 4.432 Vali Acc: 0.775 Test Loss: 4.432 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.006876468658447
Epoch: 10, Steps: 67 | Train Loss: 0.741 Vali Loss: 4.609 Vali Acc: 0.734 Test Loss: 4.609 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.7595386505126953
Epoch: 11, Steps: 67 | Train Loss: 0.179 Vali Loss: 4.824 Vali Acc: 0.740 Test Loss: 4.824 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.306612730026245
Epoch: 12, Steps: 67 | Train Loss: 0.161 Vali Loss: 4.161 Vali Acc: 0.786 Test Loss: 4.161 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7723195552825928
Epoch: 13, Steps: 67 | Train Loss: 0.029 Vali Loss: 3.504 Vali Acc: 0.803 Test Loss: 3.504 Test Acc: 0.803
Validation loss decreased (-0.791878 --> -0.803433).  Saving model ...
Epoch: 14 cost time: 3.9957690238952637
Epoch: 14, Steps: 67 | Train Loss: 0.107 Vali Loss: 4.750 Vali Acc: 0.786 Test Loss: 4.750 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.013256788253784
Epoch: 15, Steps: 67 | Train Loss: 0.095 Vali Loss: 10.724 Vali Acc: 0.630 Test Loss: 10.724 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6024677753448486
Epoch: 16, Steps: 67 | Train Loss: 0.098 Vali Loss: 4.603 Vali Acc: 0.775 Test Loss: 4.603 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7386951446533203
Epoch: 17, Steps: 67 | Train Loss: 0.452 Vali Loss: 5.970 Vali Acc: 0.792 Test Loss: 5.970 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.277124643325806
Epoch: 18, Steps: 67 | Train Loss: 0.317 Vali Loss: 2.332 Vali Acc: 0.838 Test Loss: 2.332 Test Acc: 0.838
Validation loss decreased (-0.803433 --> -0.838127).  Saving model ...
Epoch: 19 cost time: 4.057204246520996
Epoch: 19, Steps: 67 | Train Loss: 0.054 Vali Loss: 3.939 Vali Acc: 0.792 Test Loss: 3.939 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.527851819992065
Epoch: 20, Steps: 67 | Train Loss: 0.094 Vali Loss: 3.819 Vali Acc: 0.792 Test Loss: 3.819 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.825798273086548
Epoch: 21, Steps: 67 | Train Loss: 0.008 Vali Loss: 3.374 Vali Acc: 0.821 Test Loss: 3.374 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.248571395874023
Epoch: 22, Steps: 67 | Train Loss: 0.282 Vali Loss: 6.855 Vali Acc: 0.786 Test Loss: 6.855 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.377975225448608
Epoch: 23, Steps: 67 | Train Loss: 0.355 Vali Loss: 8.863 Vali Acc: 0.711 Test Loss: 8.863 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.557321548461914
Epoch: 24, Steps: 67 | Train Loss: 0.416 Vali Loss: 13.360 Vali Acc: 0.636 Test Loss: 13.360 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8954148292541504
Epoch: 25, Steps: 67 | Train Loss: 0.266 Vali Loss: 10.680 Vali Acc: 0.665 Test Loss: 10.680 Test Acc: 0.665
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.7342076301574707
Epoch: 26, Steps: 67 | Train Loss: 0.250 Vali Loss: 7.996 Vali Acc: 0.740 Test Loss: 7.996 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.9653549194335938
Epoch: 27, Steps: 67 | Train Loss: 0.369 Vali Loss: 7.471 Vali Acc: 0.775 Test Loss: 7.471 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.014910459518433
Epoch: 28, Steps: 67 | Train Loss: 0.158 Vali Loss: 6.182 Vali Acc: 0.746 Test Loss: 6.182 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1739623
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 529.4589844
	speed: 0.1222s/iter; left time: 1625.8583s
Epoch: 1 cost time: 16.300062656402588
Epoch: 1, Steps: 134 | Train Loss: 91.690 Vali Loss: 82.205 Vali Acc: 0.445 Test Loss: 82.205 Test Acc: 0.445
Validation loss decreased (inf --> -0.444265).  Saving model ...
	iters: 100, epoch: 2 | loss: 77.3571320
	speed: 0.3071s/iter; left time: 4044.1683s
Epoch: 2 cost time: 12.975757122039795
Epoch: 2, Steps: 134 | Train Loss: 60.128 Vali Loss: 138.788 Vali Acc: 0.497 Test Loss: 138.788 Test Acc: 0.497
Validation loss decreased (-0.444265 --> -0.495722).  Saving model ...
	iters: 100, epoch: 3 | loss: 41.4550781
	speed: 0.3202s/iter; left time: 4173.7547s
Epoch: 3 cost time: 13.782654762268066
Epoch: 3, Steps: 134 | Train Loss: 41.834 Vali Loss: 93.041 Vali Acc: 0.462 Test Loss: 93.041 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 76.1492081
	speed: 0.2981s/iter; left time: 3845.7283s
Epoch: 4 cost time: 12.708972692489624
Epoch: 4, Steps: 134 | Train Loss: 15.395 Vali Loss: 99.532 Vali Acc: 0.601 Test Loss: 99.532 Test Acc: 0.601
Validation loss decreased (-0.495722 --> -0.600161).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.2937s/iter; left time: 3748.7015s
Epoch: 5 cost time: 12.974786043167114
Epoch: 5, Steps: 134 | Train Loss: 9.658 Vali Loss: 32.373 Vali Acc: 0.699 Test Loss: 32.373 Test Acc: 0.699
Validation loss decreased (-0.600161 --> -0.699098).  Saving model ...
	iters: 100, epoch: 6 | loss: 32.2463455
	speed: 0.3063s/iter; left time: 3868.4752s
Epoch: 6 cost time: 13.128551483154297
Epoch: 6, Steps: 134 | Train Loss: 4.004 Vali Loss: 42.571 Vali Acc: 0.723 Test Loss: 42.571 Test Acc: 0.723
Validation loss decreased (-0.699098 --> -0.722118).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3159s/iter; left time: 3947.7709s
Epoch: 7 cost time: 15.008530139923096
Epoch: 7, Steps: 134 | Train Loss: 1.433 Vali Loss: 35.576 Vali Acc: 0.757 Test Loss: 35.576 Test Acc: 0.757
Validation loss decreased (-0.722118 --> -0.756870).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3177s/iter; left time: 3927.2143s
Epoch: 8 cost time: 15.824649095535278
Epoch: 8, Steps: 134 | Train Loss: 1.849 Vali Loss: 33.799 Vali Acc: 0.717 Test Loss: 33.799 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3164s/iter; left time: 3869.1406s
Epoch: 9 cost time: 16.776539087295532
Epoch: 9, Steps: 134 | Train Loss: 0.490 Vali Loss: 15.758 Vali Acc: 0.792 Test Loss: 15.758 Test Acc: 0.792
Validation loss decreased (-0.756870 --> -0.791750).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3428s/iter; left time: 4146.0060s
Epoch: 10 cost time: 17.851803302764893
Epoch: 10, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.744 Vali Acc: 0.798 Test Loss: 21.744 Test Acc: 0.798
Validation loss decreased (-0.791750 --> -0.797470).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3466s/iter; left time: 4145.1409s
Epoch: 11 cost time: 18.213922262191772
Epoch: 11, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.741 Vali Acc: 0.798 Test Loss: 21.741 Test Acc: 0.798
Validation loss decreased (-0.797470 --> -0.797470).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3480s/iter; left time: 4115.2314s
Epoch: 12 cost time: 18.24944496154785
Epoch: 12, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.744 Vali Acc: 0.798 Test Loss: 21.744 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3032s/iter; left time: 3545.0644s
Epoch: 13 cost time: 14.931399583816528
Epoch: 13, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.772 Vali Acc: 0.798 Test Loss: 21.772 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.2987s/iter; left time: 3452.5912s
Epoch: 14 cost time: 17.00326442718506
Epoch: 14, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.739 Vali Acc: 0.798 Test Loss: 21.739 Test Acc: 0.798
Validation loss decreased (-0.797470 --> -0.797470).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3232s/iter; left time: 3692.7529s
Epoch: 15 cost time: 16.41918635368347
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.720 Vali Acc: 0.798 Test Loss: 21.720 Test Acc: 0.798
Validation loss decreased (-0.797470 --> -0.797471).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3249s/iter; left time: 3668.8275s
Epoch: 16 cost time: 17.169527292251587
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.804 Vali Acc: 0.798 Test Loss: 21.804 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3070s/iter; left time: 3424.9299s
Epoch: 17 cost time: 18.697417497634888
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.742 Vali Acc: 0.798 Test Loss: 21.742 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3007s/iter; left time: 3314.6877s
Epoch: 18 cost time: 16.698330402374268
Epoch: 18, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.730 Vali Acc: 0.798 Test Loss: 21.730 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3079s/iter; left time: 3352.3253s
Epoch: 19 cost time: 15.592082262039185
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.735 Vali Acc: 0.798 Test Loss: 21.735 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.2803s/iter; left time: 3014.5832s
Epoch: 20 cost time: 13.25940465927124
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.805 Vali Acc: 0.798 Test Loss: 21.805 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.2983s/iter; left time: 3167.9250s
Epoch: 21 cost time: 14.448223352432251
Epoch: 21, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.720 Vali Acc: 0.798 Test Loss: 21.720 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3038s/iter; left time: 3185.6679s
Epoch: 22 cost time: 13.115665674209595
Epoch: 22, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.694 Vali Acc: 0.798 Test Loss: 21.694 Test Acc: 0.798
Validation loss decreased (-0.797471 --> -0.797471).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3106s/iter; left time: 3215.6025s
Epoch: 23 cost time: 12.485140800476074
Epoch: 23, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.675 Vali Acc: 0.798 Test Loss: 21.675 Test Acc: 0.798
Validation loss decreased (-0.797471 --> -0.797471).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3107s/iter; left time: 3174.8392s
Epoch: 24 cost time: 14.577327489852905
Epoch: 24, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.714 Vali Acc: 0.798 Test Loss: 21.714 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.3044s/iter; left time: 3069.8685s
Epoch: 25 cost time: 14.415421724319458
Epoch: 25, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.681 Vali Acc: 0.798 Test Loss: 21.681 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.2993s/iter; left time: 2978.0260s
Epoch: 26 cost time: 14.268362760543823
Epoch: 26, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.752 Vali Acc: 0.798 Test Loss: 21.752 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3004s/iter; left time: 2949.0490s
Epoch: 27 cost time: 14.662343978881836
Epoch: 27, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.638 Vali Acc: 0.798 Test Loss: 21.638 Test Acc: 0.798
Validation loss decreased (-0.797471 --> -0.797471).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3018s/iter; left time: 2921.8672s
Epoch: 28 cost time: 15.40986680984497
Epoch: 28, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.710 Vali Acc: 0.798 Test Loss: 21.710 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.3095s/iter; left time: 2955.1796s
Epoch: 29 cost time: 15.728987216949463
Epoch: 29, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.737 Vali Acc: 0.798 Test Loss: 21.737 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3172s/iter; left time: 2986.5524s
Epoch: 30 cost time: 16.311770915985107
Epoch: 30, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.718 Vali Acc: 0.798 Test Loss: 21.718 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.3140s/iter; left time: 2914.1221s
Epoch: 31 cost time: 15.786668300628662
Epoch: 31, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.699 Vali Acc: 0.798 Test Loss: 21.699 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.2958s/iter; left time: 2706.0102s
Epoch: 32 cost time: 13.622469425201416
Epoch: 32, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.683 Vali Acc: 0.798 Test Loss: 21.683 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2978s/iter; left time: 2684.0832s
Epoch: 33 cost time: 13.465221405029297
Epoch: 33, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.648 Vali Acc: 0.798 Test Loss: 21.648 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.3023s/iter; left time: 2683.9100s
Epoch: 34 cost time: 12.764024496078491
Epoch: 34, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.294 Vali Acc: 0.798 Test Loss: 21.294 Test Acc: 0.798
Validation loss decreased (-0.797471 --> -0.797475).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.3001s/iter; left time: 2624.0579s
Epoch: 35 cost time: 12.312739610671997
Epoch: 35, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.249 Vali Acc: 0.803 Test Loss: 21.249 Test Acc: 0.803
Validation loss decreased (-0.797475 --> -0.803256).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.3138s/iter; left time: 2702.2875s
Epoch: 36 cost time: 13.430436372756958
Epoch: 36, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.276 Vali Acc: 0.798 Test Loss: 21.276 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.2936s/iter; left time: 2488.9462s
Epoch: 37 cost time: 13.754214763641357
Epoch: 37, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.375 Vali Acc: 0.798 Test Loss: 21.375 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.3129s/iter; left time: 2610.1983s
Epoch: 38 cost time: 15.367409944534302
Epoch: 38, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.262 Vali Acc: 0.803 Test Loss: 21.262 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.3225s/iter; left time: 2647.4338s
Epoch: 39 cost time: 15.353732824325562
Epoch: 39, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.272 Vali Acc: 0.798 Test Loss: 21.272 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.3332s/iter; left time: 2690.7084s
Epoch: 40 cost time: 15.566691160202026
Epoch: 40, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.204 Vali Acc: 0.798 Test Loss: 21.204 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.3202s/iter; left time: 2542.9938s
Epoch: 41 cost time: 13.771106243133545
Epoch: 41, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.369 Vali Acc: 0.798 Test Loss: 21.369 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.3177s/iter; left time: 2479.9033s
Epoch: 42 cost time: 14.932683944702148
Epoch: 42, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.239 Vali Acc: 0.803 Test Loss: 21.239 Test Acc: 0.803
Validation loss decreased (-0.803256 --> -0.803256).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.3332s/iter; left time: 2556.7574s
Epoch: 43 cost time: 14.487826347351074
Epoch: 43, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.332 Vali Acc: 0.803 Test Loss: 21.332 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.3508s/iter; left time: 2644.6922s
Epoch: 44 cost time: 17.263208627700806
Epoch: 44, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.307 Vali Acc: 0.798 Test Loss: 21.307 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.3353s/iter; left time: 2483.0382s
Epoch: 45 cost time: 15.660914421081543
Epoch: 45, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.247 Vali Acc: 0.803 Test Loss: 21.247 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.3616s/iter; left time: 2629.3427s
Epoch: 46 cost time: 17.404189586639404
Epoch: 46, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.297 Vali Acc: 0.798 Test Loss: 21.297 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.3398s/iter; left time: 2425.0911s
Epoch: 47 cost time: 16.792139053344727
Epoch: 47, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.213 Vali Acc: 0.803 Test Loss: 21.213 Test Acc: 0.803
Validation loss decreased (-0.803256 --> -0.803256).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.3302s/iter; left time: 2312.5600s
Epoch: 48 cost time: 14.85999870300293
Epoch: 48, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.237 Vali Acc: 0.803 Test Loss: 21.237 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 0.0000000
	speed: 0.3349s/iter; left time: 2300.5261s
Epoch: 49 cost time: 14.738116979598999
Epoch: 49, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.252 Vali Acc: 0.798 Test Loss: 21.252 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 50 | loss: 0.0000000
	speed: 0.3288s/iter; left time: 2214.2099s
Epoch: 50 cost time: 15.775060176849365
Epoch: 50, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.258 Vali Acc: 0.798 Test Loss: 21.258 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.3365s/iter; left time: 2221.2464s
Epoch: 51 cost time: 14.81765627861023
Epoch: 51, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.247 Vali Acc: 0.803 Test Loss: 21.247 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 52 | loss: 0.0000000
	speed: 0.3293s/iter; left time: 2129.7967s
Epoch: 52 cost time: 15.12779951095581
Epoch: 52, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.249 Vali Acc: 0.803 Test Loss: 21.249 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 53 | loss: 0.0000000
	speed: 0.3433s/iter; left time: 2174.0387s
Epoch: 53 cost time: 15.104067087173462
Epoch: 53, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.242 Vali Acc: 0.803 Test Loss: 21.242 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 54 | loss: 0.0000000
	speed: 0.3342s/iter; left time: 2071.4570s
Epoch: 54 cost time: 15.693630695343018
Epoch: 54, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.210 Vali Acc: 0.803 Test Loss: 21.210 Test Acc: 0.803
Validation loss decreased (-0.803256 --> -0.803256).  Saving model ...
	iters: 100, epoch: 55 | loss: 0.0000000
	speed: 0.3831s/iter; left time: 2323.4087s
Epoch: 55 cost time: 16.55550241470337
Epoch: 55, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.306 Vali Acc: 0.798 Test Loss: 21.306 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 56 | loss: 0.0000000
	speed: 0.3055s/iter; left time: 1811.9571s
Epoch: 56 cost time: 15.45490288734436
Epoch: 56, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.246 Vali Acc: 0.803 Test Loss: 21.246 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 57 | loss: 0.0000000
	speed: 0.3506s/iter; left time: 2032.1652s
Epoch: 57 cost time: 18.037156105041504
Epoch: 57, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.255 Vali Acc: 0.803 Test Loss: 21.255 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 58 | loss: 0.0000000
	speed: 0.3506s/iter; left time: 1985.3269s
Epoch: 58 cost time: 17.114387035369873
Epoch: 58, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.290 Vali Acc: 0.803 Test Loss: 21.290 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 59 | loss: 0.0000000
	speed: 0.3619s/iter; left time: 2000.8746s
Epoch: 59 cost time: 18.21495032310486
Epoch: 59, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.283 Vali Acc: 0.803 Test Loss: 21.283 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 60 | loss: 0.0000000
	speed: 0.3395s/iter; left time: 1831.6230s
Epoch: 60 cost time: 15.556384801864624
Epoch: 60, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.264 Vali Acc: 0.803 Test Loss: 21.264 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 61 | loss: 0.0000000
	speed: 0.3212s/iter; left time: 1689.7175s
Epoch: 61 cost time: 14.010831117630005
Epoch: 61, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.314 Vali Acc: 0.798 Test Loss: 21.314 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 62 | loss: 0.0000000
	speed: 0.3214s/iter; left time: 1647.9197s
Epoch: 62 cost time: 13.196500778198242
Epoch: 62, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.287 Vali Acc: 0.798 Test Loss: 21.287 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 63 | loss: 0.0000000
	speed: 0.3235s/iter; left time: 1615.3877s
Epoch: 63 cost time: 14.137792348861694
Epoch: 63, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.331 Vali Acc: 0.798 Test Loss: 21.331 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 64 | loss: 0.0000000
	speed: 0.3310s/iter; left time: 1608.3166s
Epoch: 64 cost time: 14.534251689910889
Epoch: 64, Steps: 134 | Train Loss: 0.000 Vali Loss: 21.355 Vali Acc: 0.798 Test Loss: 21.355 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 15540007
model size : 59.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.331815481185913
Epoch: 1, Steps: 67 | Train Loss: 29.112 Vali Loss: 28.902 Vali Acc: 0.376 Test Loss: 28.902 Test Acc: 0.376
Validation loss decreased (inf --> -0.375434).  Saving model ...
Epoch: 2 cost time: 6.088947057723999
Epoch: 2, Steps: 67 | Train Loss: 24.649 Vali Loss: 51.865 Vali Acc: 0.428 Test Loss: 51.865 Test Acc: 0.428
Validation loss decreased (-0.375434 --> -0.427227).  Saving model ...
Epoch: 3 cost time: 6.911012172698975
Epoch: 3, Steps: 67 | Train Loss: 22.189 Vali Loss: 19.935 Vali Acc: 0.694 Test Loss: 19.935 Test Acc: 0.694
Validation loss decreased (-0.427227 --> -0.693442).  Saving model ...
Epoch: 4 cost time: 8.096624374389648
Epoch: 4, Steps: 67 | Train Loss: 15.602 Vali Loss: 29.683 Vali Acc: 0.642 Test Loss: 29.683 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.863189935684204
Epoch: 5, Steps: 67 | Train Loss: 6.159 Vali Loss: 8.150 Vali Acc: 0.792 Test Loss: 8.150 Test Acc: 0.792
Validation loss decreased (-0.693442 --> -0.791826).  Saving model ...
Epoch: 6 cost time: 8.270444393157959
Epoch: 6, Steps: 67 | Train Loss: 3.737 Vali Loss: 33.182 Vali Acc: 0.699 Test Loss: 33.182 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.698151588439941
Epoch: 7, Steps: 67 | Train Loss: 3.963 Vali Loss: 32.567 Vali Acc: 0.676 Test Loss: 32.567 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.553232669830322
Epoch: 8, Steps: 67 | Train Loss: 3.317 Vali Loss: 30.731 Vali Acc: 0.618 Test Loss: 30.731 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.449052810668945
Epoch: 9, Steps: 67 | Train Loss: 0.694 Vali Loss: 15.603 Vali Acc: 0.786 Test Loss: 15.603 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.084840297698975
Epoch: 10, Steps: 67 | Train Loss: 0.561 Vali Loss: 25.083 Vali Acc: 0.746 Test Loss: 25.083 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.623206853866577
Epoch: 11, Steps: 67 | Train Loss: 1.473 Vali Loss: 53.202 Vali Acc: 0.630 Test Loss: 53.202 Test Acc: 0.630
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.62886905670166
Epoch: 12, Steps: 67 | Train Loss: 2.053 Vali Loss: 36.046 Vali Acc: 0.636 Test Loss: 36.046 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.352336883544922
Epoch: 13, Steps: 67 | Train Loss: 1.011 Vali Loss: 37.758 Vali Acc: 0.682 Test Loss: 37.758 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.295020580291748
Epoch: 14, Steps: 67 | Train Loss: 0.934 Vali Loss: 25.217 Vali Acc: 0.746 Test Loss: 25.217 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.574852705001831
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 25.473 Vali Acc: 0.751 Test Loss: 25.473 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 7774503
model size : 30.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.338767051696777
Epoch: 1, Steps: 67 | Train Loss: 12.356 Vali Loss: 13.584 Vali Acc: 0.474 Test Loss: 13.584 Test Acc: 0.474
Validation loss decreased (inf --> -0.473853).  Saving model ...
Epoch: 2 cost time: 6.015219449996948
Epoch: 2, Steps: 67 | Train Loss: 9.647 Vali Loss: 14.788 Vali Acc: 0.636 Test Loss: 14.788 Test Acc: 0.636
Validation loss decreased (-0.473853 --> -0.635690).  Saving model ...
Epoch: 3 cost time: 5.811796188354492
Epoch: 3, Steps: 67 | Train Loss: 6.290 Vali Loss: 15.984 Vali Acc: 0.699 Test Loss: 15.984 Test Acc: 0.699
Validation loss decreased (-0.635690 --> -0.699262).  Saving model ...
Epoch: 4 cost time: 5.568588018417358
Epoch: 4, Steps: 67 | Train Loss: 6.194 Vali Loss: 16.244 Vali Acc: 0.659 Test Loss: 16.244 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.745149374008179
Epoch: 5, Steps: 67 | Train Loss: 3.537 Vali Loss: 19.299 Vali Acc: 0.642 Test Loss: 19.299 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.515512943267822
Epoch: 6, Steps: 67 | Train Loss: 1.891 Vali Loss: 10.661 Vali Acc: 0.763 Test Loss: 10.661 Test Acc: 0.763
Validation loss decreased (-0.699262 --> -0.762899).  Saving model ...
Epoch: 7 cost time: 5.7257044315338135
Epoch: 7, Steps: 67 | Train Loss: 2.374 Vali Loss: 12.024 Vali Acc: 0.780 Test Loss: 12.024 Test Acc: 0.780
Validation loss decreased (-0.762899 --> -0.780227).  Saving model ...
Epoch: 8 cost time: 7.090310573577881
Epoch: 8, Steps: 67 | Train Loss: 0.560 Vali Loss: 29.985 Vali Acc: 0.699 Test Loss: 29.985 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.408389568328857
Epoch: 9, Steps: 67 | Train Loss: 0.625 Vali Loss: 13.297 Vali Acc: 0.746 Test Loss: 13.297 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.429922103881836
Epoch: 10, Steps: 67 | Train Loss: 0.311 Vali Loss: 10.562 Vali Acc: 0.809 Test Loss: 10.562 Test Acc: 0.809
Validation loss decreased (-0.780227 --> -0.809143).  Saving model ...
Epoch: 11 cost time: 6.084168434143066
Epoch: 11, Steps: 67 | Train Loss: 0.536 Vali Loss: 18.413 Vali Acc: 0.775 Test Loss: 18.413 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.2022669315338135
Epoch: 12, Steps: 67 | Train Loss: 0.381 Vali Loss: 16.567 Vali Acc: 0.809 Test Loss: 16.567 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.15096640586853
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 16.543 Vali Acc: 0.809 Test Loss: 16.543 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.858866453170776
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.931 Vali Acc: 0.792 Test Loss: 15.931 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.652598142623901
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.829 Vali Acc: 0.780 Test Loss: 15.829 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.722360372543335
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.821 Vali Acc: 0.780 Test Loss: 15.821 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.032176971435547
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.803 Vali Acc: 0.780 Test Loss: 15.803 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.990175247192383
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.832 Vali Acc: 0.780 Test Loss: 15.832 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.471206903457642
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.788 Vali Acc: 0.780 Test Loss: 15.788 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.160506725311279
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 15.783 Vali Acc: 0.780 Test Loss: 15.783 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 5186055
model size : 20.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.431692600250244
Epoch: 1, Steps: 67 | Train Loss: 7.577 Vali Loss: 16.183 Vali Acc: 0.457 Test Loss: 16.183 Test Acc: 0.457
Validation loss decreased (inf --> -0.456486).  Saving model ...
Epoch: 2 cost time: 5.102711915969849
Epoch: 2, Steps: 67 | Train Loss: 12.012 Vali Loss: 11.389 Vali Acc: 0.578 Test Loss: 11.389 Test Acc: 0.578
Validation loss decreased (-0.456486 --> -0.577921).  Saving model ...
Epoch: 3 cost time: 5.009559392929077
Epoch: 3, Steps: 67 | Train Loss: 5.282 Vali Loss: 8.654 Vali Acc: 0.694 Test Loss: 8.654 Test Acc: 0.694
Validation loss decreased (-0.577921 --> -0.693555).  Saving model ...
Epoch: 4 cost time: 4.260554313659668
Epoch: 4, Steps: 67 | Train Loss: 1.513 Vali Loss: 12.205 Vali Acc: 0.723 Test Loss: 12.205 Test Acc: 0.723
Validation loss decreased (-0.693555 --> -0.722421).  Saving model ...
Epoch: 5 cost time: 6.584547996520996
Epoch: 5, Steps: 67 | Train Loss: 2.910 Vali Loss: 11.885 Vali Acc: 0.717 Test Loss: 11.885 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.205837726593018
Epoch: 6, Steps: 67 | Train Loss: 2.534 Vali Loss: 28.088 Vali Acc: 0.642 Test Loss: 28.088 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.620590686798096
Epoch: 7, Steps: 67 | Train Loss: 1.768 Vali Loss: 4.940 Vali Acc: 0.803 Test Loss: 4.940 Test Acc: 0.803
Validation loss decreased (-0.722421 --> -0.803419).  Saving model ...
Epoch: 8 cost time: 8.553911447525024
Epoch: 8, Steps: 67 | Train Loss: 0.099 Vali Loss: 6.544 Vali Acc: 0.780 Test Loss: 6.544 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1638407707214355
Epoch: 9, Steps: 67 | Train Loss: 0.010 Vali Loss: 9.631 Vali Acc: 0.803 Test Loss: 9.631 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.749478816986084
Epoch: 10, Steps: 67 | Train Loss: 0.176 Vali Loss: 15.223 Vali Acc: 0.705 Test Loss: 15.223 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.051348686218262
Epoch: 11, Steps: 67 | Train Loss: 0.482 Vali Loss: 6.300 Vali Acc: 0.775 Test Loss: 6.300 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.847106695175171
Epoch: 12, Steps: 67 | Train Loss: 0.007 Vali Loss: 5.451 Vali Acc: 0.769 Test Loss: 5.451 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.819679021835327
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.407 Vali Acc: 0.775 Test Loss: 5.407 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.328749895095825
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.338 Vali Acc: 0.775 Test Loss: 5.338 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.434430360794067
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.423 Vali Acc: 0.775 Test Loss: 5.423 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.6451709270477295
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.279 Vali Acc: 0.786 Test Loss: 5.279 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.358892202377319
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.388 Vali Acc: 0.775 Test Loss: 5.388 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3891911
model size : 15.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.327545166015625
Epoch: 1, Steps: 67 | Train Loss: 6.235 Vali Loss: 4.114 Vali Acc: 0.532 Test Loss: 4.114 Test Acc: 0.532
Validation loss decreased (inf --> -0.531751).  Saving model ...
Epoch: 2 cost time: 4.964609622955322
Epoch: 2, Steps: 67 | Train Loss: 5.987 Vali Loss: 2.694 Vali Acc: 0.763 Test Loss: 2.694 Test Acc: 0.763
Validation loss decreased (-0.531751 --> -0.762979).  Saving model ...
Epoch: 3 cost time: 5.321439504623413
Epoch: 3, Steps: 67 | Train Loss: 1.885 Vali Loss: 2.748 Vali Acc: 0.734 Test Loss: 2.748 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.4942686557769775
Epoch: 4, Steps: 67 | Train Loss: 3.257 Vali Loss: 7.826 Vali Acc: 0.699 Test Loss: 7.826 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.725306272506714
Epoch: 5, Steps: 67 | Train Loss: 1.230 Vali Loss: 1.266 Vali Acc: 0.844 Test Loss: 1.266 Test Acc: 0.844
Validation loss decreased (-0.762979 --> -0.843918).  Saving model ...
Epoch: 6 cost time: 5.994325637817383
Epoch: 6, Steps: 67 | Train Loss: 0.698 Vali Loss: 2.528 Vali Acc: 0.751 Test Loss: 2.528 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.511511325836182
Epoch: 7, Steps: 67 | Train Loss: 0.237 Vali Loss: 6.757 Vali Acc: 0.751 Test Loss: 6.757 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.486944675445557
Epoch: 8, Steps: 67 | Train Loss: 0.514 Vali Loss: 8.949 Vali Acc: 0.699 Test Loss: 8.949 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.560231685638428
Epoch: 9, Steps: 67 | Train Loss: 0.304 Vali Loss: 6.564 Vali Acc: 0.769 Test Loss: 6.564 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.345742225646973
Epoch: 10, Steps: 67 | Train Loss: 0.063 Vali Loss: 2.778 Vali Acc: 0.786 Test Loss: 2.778 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.601044654846191
Epoch: 11, Steps: 67 | Train Loss: 0.084 Vali Loss: 6.426 Vali Acc: 0.705 Test Loss: 6.426 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.298146486282349
Epoch: 12, Steps: 67 | Train Loss: 0.065 Vali Loss: 6.965 Vali Acc: 0.757 Test Loss: 6.965 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.926746606826782
Epoch: 13, Steps: 67 | Train Loss: 0.190 Vali Loss: 6.589 Vali Acc: 0.775 Test Loss: 6.589 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.214227199554443
Epoch: 14, Steps: 67 | Train Loss: 0.241 Vali Loss: 4.445 Vali Acc: 0.786 Test Loss: 4.445 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.463679790496826
Epoch: 15, Steps: 67 | Train Loss: 0.001 Vali Loss: 5.220 Vali Acc: 0.746 Test Loss: 5.220 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2813575
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.673166275024414
Epoch: 1, Steps: 67 | Train Loss: 4.597 Vali Loss: 4.219 Vali Acc: 0.514 Test Loss: 4.219 Test Acc: 0.514
Validation loss decreased (inf --> -0.514409).  Saving model ...
Epoch: 2 cost time: 5.072349548339844
Epoch: 2, Steps: 67 | Train Loss: 4.792 Vali Loss: 8.205 Vali Acc: 0.451 Test Loss: 8.205 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.678252696990967
Epoch: 3, Steps: 67 | Train Loss: 2.752 Vali Loss: 3.606 Vali Acc: 0.723 Test Loss: 3.606 Test Acc: 0.723
Validation loss decreased (-0.514409 --> -0.722507).  Saving model ...
Epoch: 4 cost time: 5.189019441604614
Epoch: 4, Steps: 67 | Train Loss: 0.511 Vali Loss: 2.631 Vali Acc: 0.775 Test Loss: 2.631 Test Acc: 0.775
Validation loss decreased (-0.722507 --> -0.774540).  Saving model ...
Epoch: 5 cost time: 4.684189558029175
Epoch: 5, Steps: 67 | Train Loss: 0.500 Vali Loss: 2.942 Vali Acc: 0.763 Test Loss: 2.942 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.476501226425171
Epoch: 6, Steps: 67 | Train Loss: 0.473 Vali Loss: 3.824 Vali Acc: 0.821 Test Loss: 3.824 Test Acc: 0.821
Validation loss decreased (-0.774540 --> -0.820771).  Saving model ...
Epoch: 7 cost time: 4.569353103637695
Epoch: 7, Steps: 67 | Train Loss: 0.232 Vali Loss: 2.510 Vali Acc: 0.832 Test Loss: 2.510 Test Acc: 0.832
Validation loss decreased (-0.820771 --> -0.832345).  Saving model ...
Epoch: 8 cost time: 5.2930748462677
Epoch: 8, Steps: 67 | Train Loss: 0.014 Vali Loss: 2.516 Vali Acc: 0.844 Test Loss: 2.516 Test Acc: 0.844
Validation loss decreased (-0.832345 --> -0.843905).  Saving model ...
Epoch: 9 cost time: 5.560973644256592
Epoch: 9, Steps: 67 | Train Loss: 0.077 Vali Loss: 2.251 Vali Acc: 0.792 Test Loss: 2.251 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.222242116928101
Epoch: 10, Steps: 67 | Train Loss: 0.273 Vali Loss: 3.079 Vali Acc: 0.792 Test Loss: 3.079 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.859205722808838
Epoch: 11, Steps: 67 | Train Loss: 0.650 Vali Loss: 5.498 Vali Acc: 0.769 Test Loss: 5.498 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.699023246765137
Epoch: 12, Steps: 67 | Train Loss: 0.035 Vali Loss: 4.715 Vali Acc: 0.792 Test Loss: 4.715 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.009957790374756
Epoch: 13, Steps: 67 | Train Loss: 0.084 Vali Loss: 4.464 Vali Acc: 0.786 Test Loss: 4.464 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.878651142120361
Epoch: 14, Steps: 67 | Train Loss: 0.226 Vali Loss: 4.118 Vali Acc: 0.775 Test Loss: 4.118 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.741974115371704
Epoch: 15, Steps: 67 | Train Loss: 0.136 Vali Loss: 6.238 Vali Acc: 0.769 Test Loss: 6.238 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.95487117767334
Epoch: 16, Steps: 67 | Train Loss: 0.105 Vali Loss: 4.423 Vali Acc: 0.769 Test Loss: 4.423 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.756402969360352
Epoch: 17, Steps: 67 | Train Loss: 0.099 Vali Loss: 2.526 Vali Acc: 0.832 Test Loss: 2.526 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.426992654800415
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.561 Vali Acc: 0.832 Test Loss: 2.561 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1950951
model size : 8.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.449923276901245
Epoch: 1, Steps: 67 | Train Loss: 4.257 Vali Loss: 4.624 Vali Acc: 0.491 Test Loss: 4.624 Test Acc: 0.491
Validation loss decreased (inf --> -0.491283).  Saving model ...
Epoch: 2 cost time: 4.964988708496094
Epoch: 2, Steps: 67 | Train Loss: 3.111 Vali Loss: 4.278 Vali Acc: 0.647 Test Loss: 4.278 Test Acc: 0.647
Validation loss decreased (-0.491283 --> -0.647356).  Saving model ...
Epoch: 3 cost time: 5.0208330154418945
Epoch: 3, Steps: 67 | Train Loss: 2.013 Vali Loss: 3.864 Vali Acc: 0.699 Test Loss: 3.864 Test Acc: 0.699
Validation loss decreased (-0.647356 --> -0.699383).  Saving model ...
Epoch: 4 cost time: 4.550204753875732
Epoch: 4, Steps: 67 | Train Loss: 0.659 Vali Loss: 5.708 Vali Acc: 0.717 Test Loss: 5.708 Test Acc: 0.717
Validation loss decreased (-0.699383 --> -0.716706).  Saving model ...
Epoch: 5 cost time: 4.434708833694458
Epoch: 5, Steps: 67 | Train Loss: 0.302 Vali Loss: 3.243 Vali Acc: 0.699 Test Loss: 3.243 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.234578371047974
Epoch: 6, Steps: 67 | Train Loss: 0.288 Vali Loss: 6.073 Vali Acc: 0.705 Test Loss: 6.073 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.716815233230591
Epoch: 7, Steps: 67 | Train Loss: 0.216 Vali Loss: 1.996 Vali Acc: 0.803 Test Loss: 1.996 Test Acc: 0.803
Validation loss decreased (-0.716706 --> -0.803448).  Saving model ...
Epoch: 8 cost time: 5.082103490829468
Epoch: 8, Steps: 67 | Train Loss: 0.382 Vali Loss: 3.116 Vali Acc: 0.792 Test Loss: 3.116 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9660565853118896
Epoch: 9, Steps: 67 | Train Loss: 0.412 Vali Loss: 3.154 Vali Acc: 0.792 Test Loss: 3.154 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.66048002243042
Epoch: 10, Steps: 67 | Train Loss: 0.288 Vali Loss: 2.498 Vali Acc: 0.815 Test Loss: 2.498 Test Acc: 0.815
Validation loss decreased (-0.803448 --> -0.815004).  Saving model ...
Epoch: 11 cost time: 4.281310081481934
Epoch: 11, Steps: 67 | Train Loss: 0.208 Vali Loss: 1.980 Vali Acc: 0.844 Test Loss: 1.980 Test Acc: 0.844
Validation loss decreased (-0.815004 --> -0.843911).  Saving model ...
Epoch: 12 cost time: 4.786746263504028
Epoch: 12, Steps: 67 | Train Loss: 0.112 Vali Loss: 3.295 Vali Acc: 0.786 Test Loss: 3.295 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.34236216545105
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.827 Test Loss: 1.834 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.766534090042114
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.827 Test Loss: 1.838 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.441759824752808
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.827 Test Loss: 1.835 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.1966636180877686
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.827 Test Loss: 1.837 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.824345827102661
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.827 Test Loss: 1.821 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.0982465744018555
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.827 Test Loss: 1.843 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.798146963119507
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.838 Test Loss: 1.811 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.054420471191406
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.838 Test Loss: 1.824 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.320605754852295
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.850 Test Loss: 1.779 Test Acc: 0.850
Validation loss decreased (-0.843911 --> -0.849693).  Saving model ...
Epoch: 22 cost time: 4.756601333618164
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.838 Test Loss: 1.824 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.257897138595581
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.838 Test Loss: 1.825 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.326524257659912
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.838 Test Loss: 1.793 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.101941108703613
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.838 Test Loss: 1.816 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.255290508270264
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.838 Test Loss: 1.799 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.055848598480225
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.867 Test Loss: 1.739 Test Acc: 0.867
Validation loss decreased (-0.849693 --> -0.867035).  Saving model ...
Epoch: 28 cost time: 5.497039318084717
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.879 Test Loss: 1.787 Test Acc: 0.879
Validation loss decreased (-0.867035 --> -0.878595).  Saving model ...
Epoch: 29 cost time: 5.399814128875732
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.724 Vali Acc: 0.873 Test Loss: 1.724 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.935847997665405
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.873 Test Loss: 1.735 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.888730525970459
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.879 Test Loss: 1.769 Test Acc: 0.879
Validation loss decreased (-0.878595 --> -0.878595).  Saving model ...
Epoch: 32 cost time: 4.7767252922058105
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.873 Test Loss: 1.763 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.989176034927368
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.873 Test Loss: 1.723 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.6657984256744385
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.753 Vali Acc: 0.879 Test Loss: 1.753 Test Acc: 0.879
Validation loss decreased (-0.878595 --> -0.878595).  Saving model ...
Epoch: 35 cost time: 5.285395860671997
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.873 Test Loss: 1.768 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.444840669631958
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.873 Test Loss: 1.742 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.060276746749878
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.775 Vali Acc: 0.867 Test Loss: 1.775 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.939307451248169
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.873 Test Loss: 1.752 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.8831470012664795
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.873 Test Loss: 1.773 Test Acc: 0.873
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 6.136364221572876
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.755 Vali Acc: 0.873 Test Loss: 1.755 Test Acc: 0.873
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.049542427062988
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.873 Test Loss: 1.802 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.4435224533081055
Epoch: 42, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.873 Test Loss: 1.763 Test Acc: 0.873
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.1649110317230225
Epoch: 43, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.879 Test Loss: 1.779 Test Acc: 0.879
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 5.184917211532593
Epoch: 44, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.867 Test Loss: 1.797 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1735463
model size : 7.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 46.5440979
	speed: 0.1780s/iter; left time: 2367.8261s
Epoch: 1 cost time: 22.153884410858154
Epoch: 1, Steps: 134 | Train Loss: 46.734 Vali Loss: 28.433 Vali Acc: 0.491 Test Loss: 28.433 Test Acc: 0.491
Validation loss decreased (inf --> -0.491045).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.3348s/iter; left time: 4408.8233s
Epoch: 2 cost time: 18.873069763183594
Epoch: 2, Steps: 134 | Train Loss: 39.301 Vali Loss: 45.564 Vali Acc: 0.630 Test Loss: 45.564 Test Acc: 0.630
Validation loss decreased (-0.491045 --> -0.629602).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.3325s/iter; left time: 4333.5361s
Epoch: 3 cost time: 18.6252019405365
Epoch: 3, Steps: 134 | Train Loss: 15.000 Vali Loss: 21.096 Vali Acc: 0.728 Test Loss: 21.096 Test Acc: 0.728
Validation loss decreased (-0.629602 --> -0.728113).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.3215s/iter; left time: 4147.1766s
Epoch: 4 cost time: 13.483098983764648
Epoch: 4, Steps: 134 | Train Loss: 8.228 Vali Loss: 17.391 Vali Acc: 0.734 Test Loss: 17.391 Test Acc: 0.734
Validation loss decreased (-0.728113 --> -0.733930).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7061941
	speed: 0.3045s/iter; left time: 3886.3137s
Epoch: 5 cost time: 13.67116379737854
Epoch: 5, Steps: 134 | Train Loss: 1.740 Vali Loss: 15.124 Vali Acc: 0.757 Test Loss: 15.124 Test Acc: 0.757
Validation loss decreased (-0.733930 --> -0.757074).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3257s/iter; left time: 4114.0581s
Epoch: 6 cost time: 15.364589929580688
Epoch: 6, Steps: 134 | Train Loss: 0.713 Vali Loss: 12.252 Vali Acc: 0.815 Test Loss: 12.252 Test Acc: 0.815
Validation loss decreased (-0.757074 --> -0.814906).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000006
	speed: 0.3303s/iter; left time: 4128.1774s
Epoch: 7 cost time: 15.738688468933105
Epoch: 7, Steps: 134 | Train Loss: 0.412 Vali Loss: 8.304 Vali Acc: 0.815 Test Loss: 8.304 Test Acc: 0.815
Validation loss decreased (-0.814906 --> -0.814946).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.3370s/iter; left time: 4165.7940s
Epoch: 8 cost time: 17.835325956344604
Epoch: 8, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.287 Vali Acc: 0.815 Test Loss: 8.287 Test Acc: 0.815
Validation loss decreased (-0.814946 --> -0.814946).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.3486s/iter; left time: 4263.3251s
Epoch: 9 cost time: 17.08788800239563
Epoch: 9, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.295 Vali Acc: 0.815 Test Loss: 8.295 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3324s/iter; left time: 4020.0134s
Epoch: 10 cost time: 17.372670650482178
Epoch: 10, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.271 Vali Acc: 0.815 Test Loss: 8.271 Test Acc: 0.815
Validation loss decreased (-0.814946 --> -0.814946).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.2733s/iter; left time: 3268.5132s
Epoch: 11 cost time: 12.900825500488281
Epoch: 11, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.301 Vali Acc: 0.815 Test Loss: 8.301 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3164s/iter; left time: 3742.4599s
Epoch: 12 cost time: 19.92585301399231
Epoch: 12, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.273 Vali Acc: 0.815 Test Loss: 8.273 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.3382s/iter; left time: 3954.5576s
Epoch: 13 cost time: 19.037368535995483
Epoch: 13, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.281 Vali Acc: 0.815 Test Loss: 8.281 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3255s/iter; left time: 3762.2394s
Epoch: 14 cost time: 18.762471675872803
Epoch: 14, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.287 Vali Acc: 0.815 Test Loss: 8.287 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3535s/iter; left time: 4039.2161s
Epoch: 15 cost time: 16.60891318321228
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.293 Vali Acc: 0.815 Test Loss: 8.293 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3368s/iter; left time: 3803.0771s
Epoch: 16 cost time: 16.888373374938965
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.294 Vali Acc: 0.815 Test Loss: 8.294 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3150s/iter; left time: 3514.5368s
Epoch: 17 cost time: 15.862732410430908
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.299 Vali Acc: 0.815 Test Loss: 8.299 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.3028s/iter; left time: 3337.2463s
Epoch: 18 cost time: 16.859581232070923
Epoch: 18, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.193 Vali Acc: 0.815 Test Loss: 8.193 Test Acc: 0.815
Validation loss decreased (-0.814946 --> -0.814947).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3601s/iter; left time: 3920.5854s
Epoch: 19 cost time: 18.100425243377686
Epoch: 19, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.237 Vali Acc: 0.815 Test Loss: 8.237 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3450s/iter; left time: 3710.0589s
Epoch: 20 cost time: 18.534063816070557
Epoch: 20, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.191 Vali Acc: 0.815 Test Loss: 8.191 Test Acc: 0.815
Validation loss decreased (-0.814947 --> -0.814947).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.3274s/iter; left time: 3477.0692s
Epoch: 21 cost time: 16.9176082611084
Epoch: 21, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.232 Vali Acc: 0.815 Test Loss: 8.232 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3525s/iter; left time: 3696.6410s
Epoch: 22 cost time: 19.72938585281372
Epoch: 22, Steps: 134 | Train Loss: 0.000 Vali Loss: 8.218 Vali Acc: 0.815 Test Loss: 8.218 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 17.7427540
	speed: 0.3882s/iter; left time: 4019.1160s
Epoch: 23 cost time: 19.369541883468628
Epoch: 23, Steps: 134 | Train Loss: 53.307 Vali Loss: 43.030 Vali Acc: 0.572 Test Loss: 43.030 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3217s/iter; left time: 3287.2147s
Epoch: 24 cost time: 13.967195987701416
Epoch: 24, Steps: 134 | Train Loss: 5.931 Vali Loss: 47.201 Vali Acc: 0.543 Test Loss: 47.201 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.3462s/iter; left time: 3491.2050s
Epoch: 25 cost time: 16.14967632293701
Epoch: 25, Steps: 134 | Train Loss: 1.740 Vali Loss: 47.584 Vali Acc: 0.590 Test Loss: 47.584 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.3368s/iter; left time: 3351.2225s
Epoch: 26 cost time: 15.846792936325073
Epoch: 26, Steps: 134 | Train Loss: 1.796 Vali Loss: 35.031 Vali Acc: 0.595 Test Loss: 35.031 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.3538s/iter; left time: 3473.3399s
Epoch: 27 cost time: 17.91035747528076
Epoch: 27, Steps: 134 | Train Loss: 1.125 Vali Loss: 66.970 Vali Acc: 0.566 Test Loss: 66.970 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.3746s/iter; left time: 3627.6871s
Epoch: 28 cost time: 18.84004855155945
Epoch: 28, Steps: 134 | Train Loss: 1.425 Vali Loss: 40.631 Vali Acc: 0.647 Test Loss: 40.631 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.3823s/iter; left time: 3650.8750s
Epoch: 29 cost time: 19.115031003952026
Epoch: 29, Steps: 134 | Train Loss: 0.307 Vali Loss: 59.019 Vali Acc: 0.618 Test Loss: 59.019 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3103s/iter; left time: 2921.2132s
Epoch: 30 cost time: 13.905342817306519
Epoch: 30, Steps: 134 | Train Loss: 1.194 Vali Loss: 67.187 Vali Acc: 0.578 Test Loss: 67.187 Test Acc: 0.578
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 7775351
model size : 29.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.672424554824829
Epoch: 1, Steps: 67 | Train Loss: 9.283 Vali Loss: 22.628 Vali Acc: 0.364 Test Loss: 22.628 Test Acc: 0.364
Validation loss decreased (inf --> -0.363936).  Saving model ...
Epoch: 2 cost time: 11.804888248443604
Epoch: 2, Steps: 67 | Train Loss: 12.120 Vali Loss: 10.092 Vali Acc: 0.671 Test Loss: 10.092 Test Acc: 0.671
Validation loss decreased (-0.363936 --> -0.670419).  Saving model ...
Epoch: 3 cost time: 8.72646951675415
Epoch: 3, Steps: 67 | Train Loss: 4.454 Vali Loss: 7.249 Vali Acc: 0.740 Test Loss: 7.249 Test Acc: 0.740
Validation loss decreased (-0.670419 --> -0.739812).  Saving model ...
Epoch: 4 cost time: 9.922350883483887
Epoch: 4, Steps: 67 | Train Loss: 3.773 Vali Loss: 17.256 Vali Acc: 0.520 Test Loss: 17.256 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.23085331916809
Epoch: 5, Steps: 67 | Train Loss: 2.056 Vali Loss: 9.077 Vali Acc: 0.653 Test Loss: 9.077 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.2404091358184814
Epoch: 6, Steps: 67 | Train Loss: 2.675 Vali Loss: 3.969 Vali Acc: 0.821 Test Loss: 3.969 Test Acc: 0.821
Validation loss decreased (-0.739812 --> -0.820770).  Saving model ...
Epoch: 7 cost time: 12.108951330184937
Epoch: 7, Steps: 67 | Train Loss: 0.802 Vali Loss: 8.934 Vali Acc: 0.734 Test Loss: 8.934 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.874955654144287
Epoch: 8, Steps: 67 | Train Loss: 0.213 Vali Loss: 9.853 Vali Acc: 0.723 Test Loss: 9.853 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.27942967414856
Epoch: 9, Steps: 67 | Train Loss: 0.026 Vali Loss: 10.770 Vali Acc: 0.728 Test Loss: 10.770 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.682391881942749
Epoch: 10, Steps: 67 | Train Loss: 0.133 Vali Loss: 6.183 Vali Acc: 0.780 Test Loss: 6.183 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.98180866241455
Epoch: 11, Steps: 67 | Train Loss: 0.010 Vali Loss: 5.235 Vali Acc: 0.746 Test Loss: 5.235 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.86906909942627
Epoch: 12, Steps: 67 | Train Loss: 0.012 Vali Loss: 3.597 Vali Acc: 0.821 Test Loss: 3.597 Test Acc: 0.821
Validation loss decreased (-0.820770 --> -0.820773).  Saving model ...
Epoch: 13 cost time: 9.104667901992798
Epoch: 13, Steps: 67 | Train Loss: 0.022 Vali Loss: 3.563 Vali Acc: 0.827 Test Loss: 3.563 Test Acc: 0.827
Validation loss decreased (-0.820773 --> -0.826554).  Saving model ...
Epoch: 14 cost time: 9.914693117141724
Epoch: 14, Steps: 67 | Train Loss: 0.018 Vali Loss: 3.896 Vali Acc: 0.775 Test Loss: 3.896 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.200645923614502
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.039 Vali Acc: 0.775 Test Loss: 4.039 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.086925983428955
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.038 Vali Acc: 0.775 Test Loss: 4.038 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.19577956199646
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.148 Vali Acc: 0.780 Test Loss: 7.148 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.167752504348755
Epoch: 18, Steps: 67 | Train Loss: 1.258 Vali Loss: 18.569 Vali Acc: 0.694 Test Loss: 18.569 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.289506673812866
Epoch: 19, Steps: 67 | Train Loss: 0.837 Vali Loss: 7.421 Vali Acc: 0.809 Test Loss: 7.421 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.129845380783081
Epoch: 20, Steps: 67 | Train Loss: 0.053 Vali Loss: 7.248 Vali Acc: 0.775 Test Loss: 7.248 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.549383878707886
Epoch: 21, Steps: 67 | Train Loss: 0.065 Vali Loss: 9.268 Vali Acc: 0.763 Test Loss: 9.268 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.847827672958374
Epoch: 22, Steps: 67 | Train Loss: 0.010 Vali Loss: 4.498 Vali Acc: 0.827 Test Loss: 4.498 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.194408655166626
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.095 Vali Acc: 0.815 Test Loss: 5.095 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3892599
model size : 15.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.281263589859009
Epoch: 1, Steps: 67 | Train Loss: 9.769 Vali Loss: 14.417 Vali Acc: 0.272 Test Loss: 14.417 Test Acc: 0.272
Validation loss decreased (inf --> -0.271532).  Saving model ...
Epoch: 2 cost time: 5.775233268737793
Epoch: 2, Steps: 67 | Train Loss: 6.560 Vali Loss: 10.047 Vali Acc: 0.532 Test Loss: 10.047 Test Acc: 0.532
Validation loss decreased (-0.271532 --> -0.531691).  Saving model ...
Epoch: 3 cost time: 6.163156509399414
Epoch: 3, Steps: 67 | Train Loss: 7.377 Vali Loss: 8.447 Vali Acc: 0.613 Test Loss: 8.447 Test Acc: 0.613
Validation loss decreased (-0.531691 --> -0.612632).  Saving model ...
Epoch: 4 cost time: 6.231889724731445
Epoch: 4, Steps: 67 | Train Loss: 2.507 Vali Loss: 5.593 Vali Acc: 0.711 Test Loss: 5.593 Test Acc: 0.711
Validation loss decreased (-0.612632 --> -0.710927).  Saving model ...
Epoch: 5 cost time: 5.958788633346558
Epoch: 5, Steps: 67 | Train Loss: 1.004 Vali Loss: 4.304 Vali Acc: 0.746 Test Loss: 4.304 Test Acc: 0.746
Validation loss decreased (-0.710927 --> -0.745622).  Saving model ...
Epoch: 6 cost time: 5.533565521240234
Epoch: 6, Steps: 67 | Train Loss: 0.592 Vali Loss: 16.888 Vali Acc: 0.595 Test Loss: 16.888 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.231310129165649
Epoch: 7, Steps: 67 | Train Loss: 1.590 Vali Loss: 2.889 Vali Acc: 0.815 Test Loss: 2.889 Test Acc: 0.815
Validation loss decreased (-0.745622 --> -0.815000).  Saving model ...
Epoch: 8 cost time: 6.273694276809692
Epoch: 8, Steps: 67 | Train Loss: 0.263 Vali Loss: 2.727 Vali Acc: 0.844 Test Loss: 2.727 Test Acc: 0.844
Validation loss decreased (-0.815000 --> -0.843903).  Saving model ...
Epoch: 9 cost time: 6.036048650741577
Epoch: 9, Steps: 67 | Train Loss: 0.033 Vali Loss: 6.113 Vali Acc: 0.803 Test Loss: 6.113 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.214467763900757
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.232 Vali Acc: 0.838 Test Loss: 4.232 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.36610221862793
Epoch: 11, Steps: 67 | Train Loss: 0.210 Vali Loss: 4.898 Vali Acc: 0.798 Test Loss: 4.898 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.776136159896851
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.727 Vali Acc: 0.786 Test Loss: 3.727 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.078433275222778
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.725 Vali Acc: 0.798 Test Loss: 3.725 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.131765127182007
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.721 Vali Acc: 0.786 Test Loss: 3.721 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.95431661605835
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.719 Vali Acc: 0.786 Test Loss: 3.719 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.514543056488037
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.786 Test Loss: 3.720 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.888706207275391
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.726 Vali Acc: 0.786 Test Loss: 3.726 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.461709260940552
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.720 Vali Acc: 0.786 Test Loss: 3.720 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2598375
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.290346384048462
Epoch: 1, Steps: 67 | Train Loss: 6.403 Vali Loss: 7.490 Vali Acc: 0.468 Test Loss: 7.490 Test Acc: 0.468
Validation loss decreased (inf --> -0.468133).  Saving model ...
Epoch: 2 cost time: 7.048624515533447
Epoch: 2, Steps: 67 | Train Loss: 3.719 Vali Loss: 2.931 Vali Acc: 0.694 Test Loss: 2.931 Test Acc: 0.694
Validation loss decreased (-0.468133 --> -0.693612).  Saving model ...
Epoch: 3 cost time: 5.599812269210815
Epoch: 3, Steps: 67 | Train Loss: 0.782 Vali Loss: 3.765 Vali Acc: 0.728 Test Loss: 3.765 Test Acc: 0.728
Validation loss decreased (-0.693612 --> -0.728286).  Saving model ...
Epoch: 4 cost time: 6.889010190963745
Epoch: 4, Steps: 67 | Train Loss: 0.913 Vali Loss: 3.835 Vali Acc: 0.694 Test Loss: 3.835 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.289988040924072
Epoch: 5, Steps: 67 | Train Loss: 0.586 Vali Loss: 5.179 Vali Acc: 0.705 Test Loss: 5.179 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.6444902420043945
Epoch: 6, Steps: 67 | Train Loss: 0.123 Vali Loss: 3.784 Vali Acc: 0.786 Test Loss: 3.784 Test Acc: 0.786
Validation loss decreased (-0.728286 --> -0.786089).  Saving model ...
Epoch: 7 cost time: 5.312265872955322
Epoch: 7, Steps: 67 | Train Loss: 0.270 Vali Loss: 3.894 Vali Acc: 0.740 Test Loss: 3.894 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.070398569107056
Epoch: 8, Steps: 67 | Train Loss: 0.049 Vali Loss: 2.362 Vali Acc: 0.803 Test Loss: 2.362 Test Acc: 0.803
Validation loss decreased (-0.786089 --> -0.803445).  Saving model ...
Epoch: 9 cost time: 6.192192792892456
Epoch: 9, Steps: 67 | Train Loss: 0.057 Vali Loss: 2.553 Vali Acc: 0.792 Test Loss: 2.553 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.111633062362671
Epoch: 10, Steps: 67 | Train Loss: 0.042 Vali Loss: 2.725 Vali Acc: 0.798 Test Loss: 2.725 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.9845216274261475
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.073 Vali Acc: 0.803 Test Loss: 2.073 Test Acc: 0.803
Validation loss decreased (-0.803445 --> -0.803447).  Saving model ...
Epoch: 12 cost time: 7.76990532875061
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.815 Test Loss: 1.960 Test Acc: 0.815
Validation loss decreased (-0.803447 --> -0.815009).  Saving model ...
Epoch: 13 cost time: 5.553228855133057
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.815 Test Loss: 1.927 Test Acc: 0.815
Validation loss decreased (-0.815009 --> -0.815010).  Saving model ...
Epoch: 14 cost time: 6.576642036437988
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.815 Test Loss: 1.906 Test Acc: 0.815
Validation loss decreased (-0.815010 --> -0.815010).  Saving model ...
Epoch: 15 cost time: 6.319814920425415
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.815 Test Loss: 1.906 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.572777032852173
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.815 Test Loss: 1.904 Test Acc: 0.815
Validation loss decreased (-0.815010 --> -0.815010).  Saving model ...
Epoch: 17 cost time: 6.14413046836853
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.815 Test Loss: 1.904 Test Acc: 0.815
Validation loss decreased (-0.815010 --> -0.815010).  Saving model ...
Epoch: 18 cost time: 6.608187437057495
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.815 Test Loss: 1.900 Test Acc: 0.815
Validation loss decreased (-0.815010 --> -0.815010).  Saving model ...
Epoch: 19 cost time: 5.1644792556762695
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.821 Test Loss: 1.662 Test Acc: 0.821
Validation loss decreased (-0.815010 --> -0.820793).  Saving model ...
Epoch: 20 cost time: 5.74567723274231
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.821 Test Loss: 1.624 Test Acc: 0.821
Validation loss decreased (-0.820793 --> -0.820793).  Saving model ...
Epoch: 21 cost time: 6.501065015792847
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.821 Test Loss: 1.629 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.286230087280273
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.821 Test Loss: 1.628 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.006795883178711
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.626 Vali Acc: 0.821 Test Loss: 1.626 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.873375654220581
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.821 Test Loss: 1.625 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.55921483039856
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.623 Vali Acc: 0.827 Test Loss: 1.623 Test Acc: 0.827
Validation loss decreased (-0.820793 --> -0.826573).  Saving model ...
Epoch: 26 cost time: 6.340545415878296
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.827 Test Loss: 1.618 Test Acc: 0.827
Validation loss decreased (-0.826573 --> -0.826573).  Saving model ...
Epoch: 27 cost time: 6.349560260772705
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.631 Vali Acc: 0.821 Test Loss: 1.631 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.880212306976318
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.821 Test Loss: 1.619 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 7.635874509811401
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.827 Test Loss: 1.617 Test Acc: 0.827
Validation loss decreased (-0.826573 --> -0.826573).  Saving model ...
Epoch: 30 cost time: 4.954916000366211
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.827 Test Loss: 1.603 Test Acc: 0.827
Validation loss decreased (-0.826573 --> -0.826574).  Saving model ...
Epoch: 31 cost time: 7.394967555999756
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.827 Test Loss: 1.612 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.580689907073975
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.827 Test Loss: 1.617 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.298733711242676
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.827 Test Loss: 1.612 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 5.943047761917114
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.827 Test Loss: 1.617 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.659362554550171
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.827 Test Loss: 1.614 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.670199394226074
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.619 Vali Acc: 0.827 Test Loss: 1.619 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 7.493128776550293
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.618 Vali Acc: 0.827 Test Loss: 1.618 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.548189640045166
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.827 Test Loss: 1.605 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.820121765136719
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.827 Test Loss: 1.616 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.793431758880615
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.608 Vali Acc: 0.827 Test Loss: 1.608 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1951303
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.073698282241821
Epoch: 1, Steps: 67 | Train Loss: 2.948 Vali Loss: 2.536 Vali Acc: 0.491 Test Loss: 2.536 Test Acc: 0.491
Validation loss decreased (inf --> -0.491304).  Saving model ...
Epoch: 2 cost time: 4.5223939418792725
Epoch: 2, Steps: 67 | Train Loss: 2.970 Vali Loss: 3.452 Vali Acc: 0.659 Test Loss: 3.452 Test Acc: 0.659
Validation loss decreased (-0.491304 --> -0.658925).  Saving model ...
Epoch: 3 cost time: 4.2131407260894775
Epoch: 3, Steps: 67 | Train Loss: 1.085 Vali Loss: 2.676 Vali Acc: 0.763 Test Loss: 2.676 Test Acc: 0.763
Validation loss decreased (-0.658925 --> -0.762979).  Saving model ...
Epoch: 4 cost time: 4.541054964065552
Epoch: 4, Steps: 67 | Train Loss: 1.077 Vali Loss: 11.099 Vali Acc: 0.497 Test Loss: 11.099 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.830523729324341
Epoch: 5, Steps: 67 | Train Loss: 0.698 Vali Loss: 1.629 Vali Acc: 0.780 Test Loss: 1.629 Test Acc: 0.780
Validation loss decreased (-0.762979 --> -0.780331).  Saving model ...
Epoch: 6 cost time: 4.7351789474487305
Epoch: 6, Steps: 67 | Train Loss: 0.112 Vali Loss: 2.549 Vali Acc: 0.734 Test Loss: 2.549 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.980012655258179
Epoch: 7, Steps: 67 | Train Loss: 0.282 Vali Loss: 2.659 Vali Acc: 0.815 Test Loss: 2.659 Test Acc: 0.815
Validation loss decreased (-0.780331 --> -0.815002).  Saving model ...
Epoch: 8 cost time: 5.290149211883545
Epoch: 8, Steps: 67 | Train Loss: 0.333 Vali Loss: 1.992 Vali Acc: 0.827 Test Loss: 1.992 Test Acc: 0.827
Validation loss decreased (-0.815002 --> -0.826570).  Saving model ...
Epoch: 9 cost time: 4.856579542160034
Epoch: 9, Steps: 67 | Train Loss: 0.060 Vali Loss: 1.867 Vali Acc: 0.792 Test Loss: 1.867 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.309155464172363
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.913 Vali Acc: 0.775 Test Loss: 1.913 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.569315195083618
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.775 Test Loss: 1.911 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.026929140090942
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.775 Test Loss: 1.873 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.350169658660889
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.798 Test Loss: 1.835 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.877213001251221
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.798 Test Loss: 1.839 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.428587913513184
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.798 Test Loss: 1.827 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.38955545425415
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.798 Test Loss: 1.823 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.489537000656128
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.515 Vali Acc: 0.780 Test Loss: 1.515 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.291706085205078
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.798 Test Loss: 1.630 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1412135
model size : 5.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.263294219970703
Epoch: 1, Steps: 67 | Train Loss: 2.303 Vali Loss: 2.109 Vali Acc: 0.578 Test Loss: 2.109 Test Acc: 0.578
Validation loss decreased (inf --> -0.578014).  Saving model ...
Epoch: 2 cost time: 4.884819746017456
Epoch: 2, Steps: 67 | Train Loss: 1.341 Vali Loss: 1.235 Vali Acc: 0.746 Test Loss: 1.235 Test Acc: 0.746
Validation loss decreased (-0.578014 --> -0.745652).  Saving model ...
Epoch: 3 cost time: 5.005848407745361
Epoch: 3, Steps: 67 | Train Loss: 1.002 Vali Loss: 4.806 Vali Acc: 0.653 Test Loss: 4.806 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.062596559524536
Epoch: 4, Steps: 67 | Train Loss: 0.657 Vali Loss: 4.729 Vali Acc: 0.642 Test Loss: 4.729 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.1284356117248535
Epoch: 5, Steps: 67 | Train Loss: 0.692 Vali Loss: 4.132 Vali Acc: 0.688 Test Loss: 4.132 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.966979742050171
Epoch: 6, Steps: 67 | Train Loss: 0.996 Vali Loss: 2.166 Vali Acc: 0.775 Test Loss: 2.166 Test Acc: 0.775
Validation loss decreased (-0.745652 --> -0.774545).  Saving model ...
Epoch: 7 cost time: 4.436243534088135
Epoch: 7, Steps: 67 | Train Loss: 0.014 Vali Loss: 2.234 Vali Acc: 0.792 Test Loss: 2.234 Test Acc: 0.792
Validation loss decreased (-0.774545 --> -0.791885).  Saving model ...
Epoch: 8 cost time: 4.728285074234009
Epoch: 8, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.780 Test Loss: 2.056 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.795072793960571
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.780 Test Loss: 2.055 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.45193338394165
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.780 Test Loss: 2.032 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.543739080429077
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.780 Test Loss: 2.000 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.721160173416138
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.780 Test Loss: 1.994 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.7370336055755615
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.780 Test Loss: 1.978 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.880105257034302
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.780 Test Loss: 1.972 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.870894908905029
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.780 Test Loss: 1.962 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.80238151550293
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.780 Test Loss: 1.954 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.378849029541016
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.948 Vali Acc: 0.780 Test Loss: 1.948 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 980823
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.627673149108887
Epoch: 1, Steps: 67 | Train Loss: 2.545 Vali Loss: 1.557 Vali Acc: 0.601 Test Loss: 1.557 Test Acc: 0.601
Validation loss decreased (inf --> -0.601140).  Saving model ...
Epoch: 2 cost time: 3.932593822479248
Epoch: 2, Steps: 67 | Train Loss: 1.644 Vali Loss: 2.095 Vali Acc: 0.688 Test Loss: 2.095 Test Acc: 0.688
Validation loss decreased (-0.601140 --> -0.687840).  Saving model ...
Epoch: 3 cost time: 4.973568677902222
Epoch: 3, Steps: 67 | Train Loss: 0.876 Vali Loss: 1.065 Vali Acc: 0.803 Test Loss: 1.065 Test Acc: 0.803
Validation loss decreased (-0.687840 --> -0.803458).  Saving model ...
Epoch: 4 cost time: 4.704335689544678
Epoch: 4, Steps: 67 | Train Loss: 0.262 Vali Loss: 2.493 Vali Acc: 0.699 Test Loss: 2.493 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.143202066421509
Epoch: 5, Steps: 67 | Train Loss: 0.182 Vali Loss: 1.328 Vali Acc: 0.792 Test Loss: 1.328 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.469571828842163
Epoch: 6, Steps: 67 | Train Loss: 0.099 Vali Loss: 4.574 Vali Acc: 0.694 Test Loss: 4.574 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.815032243728638
Epoch: 7, Steps: 67 | Train Loss: 0.377 Vali Loss: 4.670 Vali Acc: 0.659 Test Loss: 4.670 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.560129165649414
Epoch: 8, Steps: 67 | Train Loss: 0.427 Vali Loss: 2.995 Vali Acc: 0.705 Test Loss: 2.995 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.161323070526123
Epoch: 9, Steps: 67 | Train Loss: 0.084 Vali Loss: 1.853 Vali Acc: 0.803 Test Loss: 1.853 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.999526500701904
Epoch: 10, Steps: 67 | Train Loss: 0.009 Vali Loss: 3.548 Vali Acc: 0.757 Test Loss: 3.548 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.634135007858276
Epoch: 11, Steps: 67 | Train Loss: 0.206 Vali Loss: 3.424 Vali Acc: 0.682 Test Loss: 3.424 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.689582347869873
Epoch: 12, Steps: 67 | Train Loss: 0.003 Vali Loss: 1.945 Vali Acc: 0.757 Test Loss: 1.945 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.628307580947876
Epoch: 13, Steps: 67 | Train Loss: 0.125 Vali Loss: 2.891 Vali Acc: 0.728 Test Loss: 2.891 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 873079
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 221.3580017
	speed: 0.1476s/iter; left time: 1963.4391s
Epoch: 1 cost time: 17.79339337348938
Epoch: 1, Steps: 134 | Train Loss: 47.588 Vali Loss: 46.943 Vali Acc: 0.480 Test Loss: 46.943 Test Acc: 0.480
Validation loss decreased (inf --> -0.479299).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.2876s/iter; left time: 3786.7090s
Epoch: 2 cost time: 12.672638654708862
Epoch: 2, Steps: 134 | Train Loss: 67.629 Vali Loss: 79.893 Vali Acc: 0.451 Test Loss: 79.893 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.3075s/iter; left time: 4007.2326s
Epoch: 3 cost time: 16.160775661468506
Epoch: 3, Steps: 134 | Train Loss: 34.179 Vali Loss: 35.235 Vali Acc: 0.659 Test Loss: 35.235 Test Acc: 0.659
Validation loss decreased (-0.479299 --> -0.658607).  Saving model ...
	iters: 100, epoch: 4 | loss: 136.8679657
	speed: 0.3419s/iter; left time: 4409.9965s
Epoch: 4 cost time: 16.54572606086731
Epoch: 4, Steps: 134 | Train Loss: 15.567 Vali Loss: 41.909 Vali Acc: 0.636 Test Loss: 41.909 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.3226s/iter; left time: 4118.2196s
Epoch: 5 cost time: 17.3017258644104
Epoch: 5, Steps: 134 | Train Loss: 6.355 Vali Loss: 10.340 Vali Acc: 0.844 Test Loss: 10.340 Test Acc: 0.844
Validation loss decreased (-0.658607 --> -0.843827).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.3260s/iter; left time: 4117.5120s
Epoch: 6 cost time: 16.60438871383667
Epoch: 6, Steps: 134 | Train Loss: 1.927 Vali Loss: 20.548 Vali Acc: 0.803 Test Loss: 20.548 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.3279s/iter; left time: 4098.1960s
Epoch: 7 cost time: 16.87131142616272
Epoch: 7, Steps: 134 | Train Loss: 0.771 Vali Loss: 14.010 Vali Acc: 0.763 Test Loss: 14.010 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000001
	speed: 0.3207s/iter; left time: 3964.9728s
Epoch: 8 cost time: 17.32091212272644
Epoch: 8, Steps: 134 | Train Loss: 0.000 Vali Loss: 11.314 Vali Acc: 0.815 Test Loss: 11.314 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.2965s/iter; left time: 3625.7098s
Epoch: 9 cost time: 13.457792520523071
Epoch: 9, Steps: 134 | Train Loss: 0.162 Vali Loss: 20.963 Vali Acc: 0.746 Test Loss: 20.963 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.3034s/iter; left time: 3670.1851s
Epoch: 10 cost time: 12.076279401779175
Epoch: 10, Steps: 134 | Train Loss: 4.264 Vali Loss: 15.196 Vali Acc: 0.746 Test Loss: 15.196 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.3008s/iter; left time: 3598.0860s
Epoch: 11 cost time: 14.3286714553833
Epoch: 11, Steps: 134 | Train Loss: 0.607 Vali Loss: 14.334 Vali Acc: 0.786 Test Loss: 14.334 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.3208s/iter; left time: 3793.6777s
Epoch: 12 cost time: 14.314569234848022
Epoch: 12, Steps: 134 | Train Loss: 1.644 Vali Loss: 24.159 Vali Acc: 0.717 Test Loss: 24.159 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.2997s/iter; left time: 3504.0585s
Epoch: 13 cost time: 13.398334264755249
Epoch: 13, Steps: 134 | Train Loss: 1.458 Vali Loss: 9.508 Vali Acc: 0.815 Test Loss: 9.508 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.3219s/iter; left time: 3720.9582s
Epoch: 14 cost time: 15.484902620315552
Epoch: 14, Steps: 134 | Train Loss: 0.196 Vali Loss: 15.452 Vali Acc: 0.792 Test Loss: 15.452 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.3275s/iter; left time: 3742.0578s
Epoch: 15 cost time: 16.52944850921631
Epoch: 15, Steps: 134 | Train Loss: 0.044 Vali Loss: 51.281 Vali Acc: 0.676 Test Loss: 51.281 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 7771127
model size : 29.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.874810695648193
Epoch: 1, Steps: 67 | Train Loss: 9.726 Vali Loss: 13.436 Vali Acc: 0.387 Test Loss: 13.436 Test Acc: 0.387
Validation loss decreased (inf --> -0.387149).  Saving model ...
Epoch: 2 cost time: 6.645715713500977
Epoch: 2, Steps: 67 | Train Loss: 12.161 Vali Loss: 8.198 Vali Acc: 0.561 Test Loss: 8.198 Test Acc: 0.561
Validation loss decreased (-0.387149 --> -0.560612).  Saving model ...
Epoch: 3 cost time: 5.928260803222656
Epoch: 3, Steps: 67 | Train Loss: 10.691 Vali Loss: 19.311 Vali Acc: 0.578 Test Loss: 19.311 Test Acc: 0.578
Validation loss decreased (-0.560612 --> -0.577842).  Saving model ...
Epoch: 4 cost time: 6.944700002670288
Epoch: 4, Steps: 67 | Train Loss: 8.431 Vali Loss: 6.163 Vali Acc: 0.705 Test Loss: 6.163 Test Acc: 0.705
Validation loss decreased (-0.577842 --> -0.705141).  Saving model ...
Epoch: 5 cost time: 6.6954193115234375
Epoch: 5, Steps: 67 | Train Loss: 2.060 Vali Loss: 21.633 Vali Acc: 0.705 Test Loss: 21.633 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.787878751754761
Epoch: 6, Steps: 67 | Train Loss: 4.978 Vali Loss: 16.481 Vali Acc: 0.642 Test Loss: 16.481 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.760388374328613
Epoch: 7, Steps: 67 | Train Loss: 0.476 Vali Loss: 8.446 Vali Acc: 0.746 Test Loss: 8.446 Test Acc: 0.746
Validation loss decreased (-0.705141 --> -0.745580).  Saving model ...
Epoch: 8 cost time: 7.4042346477508545
Epoch: 8, Steps: 67 | Train Loss: 0.378 Vali Loss: 9.592 Vali Acc: 0.751 Test Loss: 9.592 Test Acc: 0.751
Validation loss decreased (-0.745580 --> -0.751349).  Saving model ...
Epoch: 9 cost time: 6.0245537757873535
Epoch: 9, Steps: 67 | Train Loss: 0.354 Vali Loss: 5.443 Vali Acc: 0.740 Test Loss: 5.443 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.103973388671875
Epoch: 10, Steps: 67 | Train Loss: 0.245 Vali Loss: 17.781 Vali Acc: 0.659 Test Loss: 17.781 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.52925968170166
Epoch: 11, Steps: 67 | Train Loss: 0.506 Vali Loss: 5.345 Vali Acc: 0.803 Test Loss: 5.345 Test Acc: 0.803
Validation loss decreased (-0.751349 --> -0.803415).  Saving model ...
Epoch: 12 cost time: 6.929412126541138
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.336 Vali Acc: 0.803 Test Loss: 5.336 Test Acc: 0.803
Validation loss decreased (-0.803415 --> -0.803415).  Saving model ...
Epoch: 13 cost time: 7.637673616409302
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.263 Vali Acc: 0.803 Test Loss: 5.263 Test Acc: 0.803
Validation loss decreased (-0.803415 --> -0.803416).  Saving model ...
Epoch: 14 cost time: 7.7285685539245605
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.307 Vali Acc: 0.803 Test Loss: 5.307 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.120338678359985
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.371 Vali Acc: 0.803 Test Loss: 5.371 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.458974361419678
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.304 Vali Acc: 0.803 Test Loss: 5.304 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.859375476837158
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.355 Vali Acc: 0.803 Test Loss: 5.355 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.269872903823853
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.267 Vali Acc: 0.803 Test Loss: 5.267 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.8073506355285645
Epoch: 19, Steps: 67 | Train Loss: 0.428 Vali Loss: 12.065 Vali Acc: 0.676 Test Loss: 12.065 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.76601243019104
Epoch: 20, Steps: 67 | Train Loss: 0.836 Vali Loss: 19.248 Vali Acc: 0.717 Test Loss: 19.248 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.622651815414429
Epoch: 21, Steps: 67 | Train Loss: 0.691 Vali Loss: 17.736 Vali Acc: 0.676 Test Loss: 17.736 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.4476706981658936
Epoch: 22, Steps: 67 | Train Loss: 0.327 Vali Loss: 6.739 Vali Acc: 0.740 Test Loss: 6.739 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.940097093582153
Epoch: 23, Steps: 67 | Train Loss: 0.215 Vali Loss: 8.194 Vali Acc: 0.676 Test Loss: 8.194 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3888375
model size : 15.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.68618631362915
Epoch: 1, Steps: 67 | Train Loss: 6.948 Vali Loss: 8.875 Vali Acc: 0.393 Test Loss: 8.875 Test Acc: 0.393
Validation loss decreased (inf --> -0.392975).  Saving model ...
Epoch: 2 cost time: 4.650972604751587
Epoch: 2, Steps: 67 | Train Loss: 7.860 Vali Loss: 15.144 Vali Acc: 0.543 Test Loss: 15.144 Test Acc: 0.543
Validation loss decreased (-0.392975 --> -0.543201).  Saving model ...
Epoch: 3 cost time: 4.169155120849609
Epoch: 3, Steps: 67 | Train Loss: 5.618 Vali Loss: 13.590 Vali Acc: 0.590 Test Loss: 13.590 Test Acc: 0.590
Validation loss decreased (-0.543201 --> -0.589459).  Saving model ...
Epoch: 4 cost time: 4.814028978347778
Epoch: 4, Steps: 67 | Train Loss: 3.061 Vali Loss: 23.151 Vali Acc: 0.566 Test Loss: 23.151 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9669065475463867
Epoch: 5, Steps: 67 | Train Loss: 4.020 Vali Loss: 3.402 Vali Acc: 0.809 Test Loss: 3.402 Test Acc: 0.809
Validation loss decreased (-0.589459 --> -0.809215).  Saving model ...
Epoch: 6 cost time: 4.711126089096069
Epoch: 6, Steps: 67 | Train Loss: 0.517 Vali Loss: 5.168 Vali Acc: 0.803 Test Loss: 5.168 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.244889974594116
Epoch: 7, Steps: 67 | Train Loss: 1.230 Vali Loss: 4.654 Vali Acc: 0.757 Test Loss: 4.654 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.736902713775635
Epoch: 8, Steps: 67 | Train Loss: 0.823 Vali Loss: 2.947 Vali Acc: 0.832 Test Loss: 2.947 Test Acc: 0.832
Validation loss decreased (-0.809215 --> -0.832340).  Saving model ...
Epoch: 9 cost time: 4.929837942123413
Epoch: 9, Steps: 67 | Train Loss: 1.019 Vali Loss: 8.001 Vali Acc: 0.763 Test Loss: 8.001 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.02201247215271
Epoch: 10, Steps: 67 | Train Loss: 0.375 Vali Loss: 3.900 Vali Acc: 0.786 Test Loss: 3.900 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.618573188781738
Epoch: 11, Steps: 67 | Train Loss: 0.125 Vali Loss: 5.040 Vali Acc: 0.798 Test Loss: 5.040 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.102491617202759
Epoch: 12, Steps: 67 | Train Loss: 0.001 Vali Loss: 10.686 Vali Acc: 0.717 Test Loss: 10.686 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.5299787521362305
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.674 Vali Acc: 0.780 Test Loss: 3.674 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.854782819747925
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.181 Vali Acc: 0.734 Test Loss: 4.181 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.5240514278411865
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.526 Vali Acc: 0.780 Test Loss: 3.526 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.534877777099609
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.469 Vali Acc: 0.780 Test Loss: 3.469 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.584150791168213
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.477 Vali Acc: 0.792 Test Loss: 3.477 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.108701944351196
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.478 Vali Acc: 0.780 Test Loss: 3.478 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2594151
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.716913223266602
Epoch: 1, Steps: 67 | Train Loss: 4.219 Vali Loss: 5.521 Vali Acc: 0.439 Test Loss: 5.521 Test Acc: 0.439
Validation loss decreased (inf --> -0.439251).  Saving model ...
Epoch: 2 cost time: 6.5058512687683105
Epoch: 2, Steps: 67 | Train Loss: 5.150 Vali Loss: 16.095 Vali Acc: 0.399 Test Loss: 16.095 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.860289812088013
Epoch: 3, Steps: 67 | Train Loss: 3.148 Vali Loss: 2.537 Vali Acc: 0.688 Test Loss: 2.537 Test Acc: 0.688
Validation loss decreased (-0.439251 --> -0.687836).  Saving model ...
Epoch: 4 cost time: 4.7074809074401855
Epoch: 4, Steps: 67 | Train Loss: 1.950 Vali Loss: 7.999 Vali Acc: 0.688 Test Loss: 7.999 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.613316774368286
Epoch: 5, Steps: 67 | Train Loss: 0.368 Vali Loss: 1.512 Vali Acc: 0.867 Test Loss: 1.512 Test Acc: 0.867
Validation loss decreased (-0.687836 --> -0.867037).  Saving model ...
Epoch: 6 cost time: 4.4950950145721436
Epoch: 6, Steps: 67 | Train Loss: 0.408 Vali Loss: 12.862 Vali Acc: 0.665 Test Loss: 12.862 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.813810110092163
Epoch: 7, Steps: 67 | Train Loss: 2.353 Vali Loss: 12.620 Vali Acc: 0.671 Test Loss: 12.620 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.6039721965789795
Epoch: 8, Steps: 67 | Train Loss: 0.447 Vali Loss: 2.976 Vali Acc: 0.780 Test Loss: 2.976 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.332674503326416
Epoch: 9, Steps: 67 | Train Loss: 0.512 Vali Loss: 1.772 Vali Acc: 0.827 Test Loss: 1.772 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.7823286056518555
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.832 Test Loss: 1.784 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.912264585494995
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.832 Test Loss: 1.777 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.021578311920166
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.778 Vali Acc: 0.832 Test Loss: 1.778 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.731797933578491
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.832 Test Loss: 1.772 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.322033882141113
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.832 Test Loss: 1.782 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.761467218399048
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.832 Test Loss: 1.766 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1947079
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.902093887329102
Epoch: 1, Steps: 67 | Train Loss: 3.999 Vali Loss: 4.956 Vali Acc: 0.590 Test Loss: 4.956 Test Acc: 0.590
Validation loss decreased (inf --> -0.589546).  Saving model ...
Epoch: 2 cost time: 5.969483375549316
Epoch: 2, Steps: 67 | Train Loss: 3.415 Vali Loss: 6.849 Vali Acc: 0.572 Test Loss: 6.849 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.8897552490234375
Epoch: 3, Steps: 67 | Train Loss: 3.331 Vali Loss: 3.368 Vali Acc: 0.642 Test Loss: 3.368 Test Acc: 0.642
Validation loss decreased (-0.589546 --> -0.641585).  Saving model ...
Epoch: 4 cost time: 4.519158601760864
Epoch: 4, Steps: 67 | Train Loss: 0.901 Vali Loss: 2.642 Vali Acc: 0.775 Test Loss: 2.642 Test Acc: 0.775
Validation loss decreased (-0.641585 --> -0.774540).  Saving model ...
Epoch: 5 cost time: 4.424635410308838
Epoch: 5, Steps: 67 | Train Loss: 0.801 Vali Loss: 6.161 Vali Acc: 0.688 Test Loss: 6.161 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.334570407867432
Epoch: 6, Steps: 67 | Train Loss: 0.329 Vali Loss: 8.935 Vali Acc: 0.607 Test Loss: 8.935 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.8157758712768555
Epoch: 7, Steps: 67 | Train Loss: 0.536 Vali Loss: 4.567 Vali Acc: 0.723 Test Loss: 4.567 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.39362645149231
Epoch: 8, Steps: 67 | Train Loss: 0.152 Vali Loss: 3.797 Vali Acc: 0.746 Test Loss: 3.797 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.556100130081177
Epoch: 9, Steps: 67 | Train Loss: 0.083 Vali Loss: 6.100 Vali Acc: 0.723 Test Loss: 6.100 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.87490177154541
Epoch: 10, Steps: 67 | Train Loss: 0.151 Vali Loss: 4.491 Vali Acc: 0.769 Test Loss: 4.491 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.325824737548828
Epoch: 11, Steps: 67 | Train Loss: 0.208 Vali Loss: 3.673 Vali Acc: 0.757 Test Loss: 3.673 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9765431880950928
Epoch: 12, Steps: 67 | Train Loss: 0.098 Vali Loss: 4.083 Vali Acc: 0.769 Test Loss: 4.083 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.135668992996216
Epoch: 13, Steps: 67 | Train Loss: 0.150 Vali Loss: 5.938 Vali Acc: 0.653 Test Loss: 5.938 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.83028244972229
Epoch: 14, Steps: 67 | Train Loss: 0.138 Vali Loss: 4.896 Vali Acc: 0.751 Test Loss: 4.896 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 1407911
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.15587306022644
Epoch: 1, Steps: 67 | Train Loss: 3.612 Vali Loss: 2.494 Vali Acc: 0.549 Test Loss: 2.494 Test Acc: 0.549
Validation loss decreased (inf --> -0.549108).  Saving model ...
Epoch: 2 cost time: 3.170445442199707
Epoch: 2, Steps: 67 | Train Loss: 2.221 Vali Loss: 2.128 Vali Acc: 0.682 Test Loss: 2.128 Test Acc: 0.682
Validation loss decreased (-0.549108 --> -0.682060).  Saving model ...
Epoch: 3 cost time: 3.8650124073028564
Epoch: 3, Steps: 67 | Train Loss: 0.861 Vali Loss: 2.408 Vali Acc: 0.711 Test Loss: 2.408 Test Acc: 0.711
Validation loss decreased (-0.682060 --> -0.710959).  Saving model ...
Epoch: 4 cost time: 4.493027925491333
Epoch: 4, Steps: 67 | Train Loss: 0.311 Vali Loss: 1.737 Vali Acc: 0.786 Test Loss: 1.737 Test Acc: 0.786
Validation loss decreased (-0.710959 --> -0.786110).  Saving model ...
Epoch: 5 cost time: 4.247798681259155
Epoch: 5, Steps: 67 | Train Loss: 0.371 Vali Loss: 3.326 Vali Acc: 0.723 Test Loss: 3.326 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0822913646698
Epoch: 6, Steps: 67 | Train Loss: 0.299 Vali Loss: 2.803 Vali Acc: 0.769 Test Loss: 2.803 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.691327095031738
Epoch: 7, Steps: 67 | Train Loss: 0.302 Vali Loss: 2.402 Vali Acc: 0.740 Test Loss: 2.402 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.491219997406006
Epoch: 8, Steps: 67 | Train Loss: 0.285 Vali Loss: 5.601 Vali Acc: 0.671 Test Loss: 5.601 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3739230632781982
Epoch: 9, Steps: 67 | Train Loss: 0.436 Vali Loss: 3.454 Vali Acc: 0.757 Test Loss: 3.454 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.9690937995910645
Epoch: 10, Steps: 67 | Train Loss: 0.030 Vali Loss: 2.332 Vali Acc: 0.775 Test Loss: 2.332 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.527363300323486
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.509 Vali Acc: 0.798 Test Loss: 2.509 Test Acc: 0.798
Validation loss decreased (-0.786110 --> -0.797663).  Saving model ...
Epoch: 12 cost time: 4.093236207962036
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.502 Vali Acc: 0.786 Test Loss: 2.502 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.3411219120025635
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.798 Test Loss: 2.475 Test Acc: 0.798
Validation loss decreased (-0.797663 --> -0.797663).  Saving model ...
Epoch: 14 cost time: 4.102548360824585
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.473 Vali Acc: 0.798 Test Loss: 2.473 Test Acc: 0.798
Validation loss decreased (-0.797663 --> -0.797663).  Saving model ...
Epoch: 15 cost time: 4.656266212463379
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.775 Test Loss: 1.805 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.490123748779297
Epoch: 16, Steps: 67 | Train Loss: 0.648 Vali Loss: 5.625 Vali Acc: 0.711 Test Loss: 5.625 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.9799752235412598
Epoch: 17, Steps: 67 | Train Loss: 0.504 Vali Loss: 6.970 Vali Acc: 0.711 Test Loss: 6.970 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.6391847133636475
Epoch: 18, Steps: 67 | Train Loss: 0.139 Vali Loss: 4.629 Vali Acc: 0.711 Test Loss: 4.629 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.153608083724976
Epoch: 19, Steps: 67 | Train Loss: 0.206 Vali Loss: 5.988 Vali Acc: 0.723 Test Loss: 5.988 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.8408432006835938
Epoch: 20, Steps: 67 | Train Loss: 0.067 Vali Loss: 3.211 Vali Acc: 0.809 Test Loss: 3.211 Test Acc: 0.809
Validation loss decreased (-0.797663 --> -0.809216).  Saving model ...
Epoch: 21 cost time: 3.607809543609619
Epoch: 21, Steps: 67 | Train Loss: 0.097 Vali Loss: 4.169 Vali Acc: 0.780 Test Loss: 4.169 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.50629997253418
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.544 Vali Acc: 0.763 Test Loss: 3.544 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.7217841148376465
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.470 Vali Acc: 0.763 Test Loss: 3.470 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.245566129684448
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.429 Vali Acc: 0.763 Test Loss: 3.429 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.493043422698975
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.265 Vali Acc: 0.769 Test Loss: 3.265 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.210302352905273
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.261 Vali Acc: 0.769 Test Loss: 3.261 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.163512229919434
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.243 Vali Acc: 0.769 Test Loss: 3.243 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.074136018753052
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.212 Vali Acc: 0.780 Test Loss: 3.212 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.25316858291626
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.224 Vali Acc: 0.780 Test Loss: 3.224 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.570221900939941
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.349 Vali Acc: 0.780 Test Loss: 2.349 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 976599
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.714723348617554
Epoch: 1, Steps: 67 | Train Loss: 2.255 Vali Loss: 2.143 Vali Acc: 0.642 Test Loss: 2.143 Test Acc: 0.642
Validation loss decreased (inf --> -0.641597).  Saving model ...
Epoch: 2 cost time: 3.632239818572998
Epoch: 2, Steps: 67 | Train Loss: 2.281 Vali Loss: 2.325 Vali Acc: 0.642 Test Loss: 2.325 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.878925085067749
Epoch: 3, Steps: 67 | Train Loss: 1.016 Vali Loss: 0.976 Vali Acc: 0.780 Test Loss: 0.976 Test Acc: 0.780
Validation loss decreased (-0.641597 --> -0.780337).  Saving model ...
Epoch: 4 cost time: 5.215768575668335
Epoch: 4, Steps: 67 | Train Loss: 0.259 Vali Loss: 4.350 Vali Acc: 0.705 Test Loss: 4.350 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.749650001525879
Epoch: 5, Steps: 67 | Train Loss: 1.242 Vali Loss: 2.229 Vali Acc: 0.792 Test Loss: 2.229 Test Acc: 0.792
Validation loss decreased (-0.780337 --> -0.791885).  Saving model ...
Epoch: 6 cost time: 5.273440837860107
Epoch: 6, Steps: 67 | Train Loss: 0.013 Vali Loss: 1.802 Vali Acc: 0.763 Test Loss: 1.802 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.6666481494903564
Epoch: 7, Steps: 67 | Train Loss: 0.116 Vali Loss: 1.863 Vali Acc: 0.815 Test Loss: 1.863 Test Acc: 0.815
Validation loss decreased (-0.791885 --> -0.815010).  Saving model ...
Epoch: 8 cost time: 4.388012170791626
Epoch: 8, Steps: 67 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.763 Test Loss: 1.836 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0607008934021
Epoch: 9, Steps: 67 | Train Loss: 0.002 Vali Loss: 2.937 Vali Acc: 0.746 Test Loss: 2.937 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5059208869934082
Epoch: 10, Steps: 67 | Train Loss: 0.073 Vali Loss: 1.367 Vali Acc: 0.798 Test Loss: 1.367 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.311286449432373
Epoch: 11, Steps: 67 | Train Loss: 0.151 Vali Loss: 3.983 Vali Acc: 0.751 Test Loss: 3.983 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3206336498260498
Epoch: 12, Steps: 67 | Train Loss: 0.412 Vali Loss: 2.398 Vali Acc: 0.827 Test Loss: 2.398 Test Acc: 0.827
Validation loss decreased (-0.815010 --> -0.826566).  Saving model ...
Epoch: 13 cost time: 1.3951940536499023
Epoch: 13, Steps: 67 | Train Loss: 0.659 Vali Loss: 3.686 Vali Acc: 0.734 Test Loss: 3.686 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3874931335449219
Epoch: 14, Steps: 67 | Train Loss: 0.035 Vali Loss: 4.518 Vali Acc: 0.705 Test Loss: 4.518 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3694837093353271
Epoch: 15, Steps: 67 | Train Loss: 0.062 Vali Loss: 7.260 Vali Acc: 0.682 Test Loss: 7.260 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4630272388458252
Epoch: 16, Steps: 67 | Train Loss: 0.279 Vali Loss: 4.224 Vali Acc: 0.711 Test Loss: 4.224 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3858835697174072
Epoch: 17, Steps: 67 | Train Loss: 0.109 Vali Loss: 3.240 Vali Acc: 0.803 Test Loss: 3.240 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.338224172592163
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.909 Vali Acc: 0.803 Test Loss: 2.909 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3913674354553223
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.923 Vali Acc: 0.803 Test Loss: 2.923 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.368880271911621
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.897 Vali Acc: 0.803 Test Loss: 2.897 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3872478008270264
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.445 Vali Acc: 0.803 Test Loss: 2.445 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.42612886428833
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.328 Vali Acc: 0.809 Test Loss: 2.328 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 868855
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
	iters: 100, epoch: 1 | loss: 58.4026947
	speed: 0.0549s/iter; left time: 730.7541s
Epoch: 1 cost time: 6.959125757217407
Epoch: 1, Steps: 134 | Train Loss: 67.570 Vali Loss: 195.700 Vali Acc: 0.387 Test Loss: 195.700 Test Acc: 0.387
Validation loss decreased (inf --> -0.385326).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.1003s/iter; left time: 1320.7216s
Epoch: 2 cost time: 5.845749855041504
Epoch: 2, Steps: 134 | Train Loss: 84.055 Vali Loss: 147.460 Vali Acc: 0.480 Test Loss: 147.460 Test Acc: 0.480
Validation loss decreased (-0.385326 --> -0.478294).  Saving model ...
	iters: 100, epoch: 3 | loss: 130.4649658
	speed: 0.1021s/iter; left time: 1330.5047s
Epoch: 3 cost time: 5.882616758346558
Epoch: 3, Steps: 134 | Train Loss: 41.883 Vali Loss: 29.341 Vali Acc: 0.688 Test Loss: 29.341 Test Acc: 0.688
Validation loss decreased (-0.478294 --> -0.687568).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.1057s/iter; left time: 1363.0062s
Epoch: 4 cost time: 6.04207444190979
Epoch: 4, Steps: 134 | Train Loss: 20.930 Vali Loss: 21.141 Vali Acc: 0.780 Test Loss: 21.141 Test Acc: 0.780
Validation loss decreased (-0.687568 --> -0.780135).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.1076s/iter; left time: 1373.2383s
Epoch: 5 cost time: 5.991981029510498
Epoch: 5, Steps: 134 | Train Loss: 8.029 Vali Loss: 36.684 Vali Acc: 0.775 Test Loss: 36.684 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.1050s/iter; left time: 1326.8408s
Epoch: 6 cost time: 5.996763229370117
Epoch: 6, Steps: 134 | Train Loss: 8.587 Vali Loss: 48.389 Vali Acc: 0.763 Test Loss: 48.389 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 1345.6115s
Epoch: 7 cost time: 6.087198495864868
Epoch: 7, Steps: 134 | Train Loss: 5.267 Vali Loss: 35.006 Vali Acc: 0.775 Test Loss: 35.006 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.1069s/iter; left time: 1321.2314s
Epoch: 8 cost time: 6.089441537857056
Epoch: 8, Steps: 134 | Train Loss: 1.647 Vali Loss: 26.239 Vali Acc: 0.827 Test Loss: 26.239 Test Acc: 0.827
Validation loss decreased (-0.780135 --> -0.826327).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1077s/iter; left time: 1316.8772s
Epoch: 9 cost time: 6.035980463027954
Epoch: 9, Steps: 134 | Train Loss: 2.417 Vali Loss: 17.791 Vali Acc: 0.786 Test Loss: 17.791 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.1056s/iter; left time: 1277.1402s
Epoch: 10 cost time: 6.039281368255615
Epoch: 10, Steps: 134 | Train Loss: 0.536 Vali Loss: 23.909 Vali Acc: 0.775 Test Loss: 23.909 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 1251.9390s
Epoch: 11 cost time: 6.007342338562012
Epoch: 11, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.392 Vali Acc: 0.769 Test Loss: 25.392 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.1064s/iter; left time: 1258.9549s
Epoch: 12 cost time: 6.059064149856567
Epoch: 12, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.224 Vali Acc: 0.769 Test Loss: 25.224 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1055s/iter; left time: 1233.9808s
Epoch: 13 cost time: 6.0885491371154785
Epoch: 13, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.529 Vali Acc: 0.769 Test Loss: 25.529 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.1070s/iter; left time: 1237.0781s
Epoch: 14 cost time: 6.030437469482422
Epoch: 14, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.111 Vali Acc: 0.769 Test Loss: 25.111 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.1036s/iter; left time: 1184.1530s
Epoch: 15 cost time: 5.995137453079224
Epoch: 15, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.368 Vali Acc: 0.769 Test Loss: 25.368 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.1056s/iter; left time: 1191.9716s
Epoch: 16 cost time: 6.005655527114868
Epoch: 16, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.307 Vali Acc: 0.769 Test Loss: 25.307 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.1033s/iter; left time: 1152.7547s
Epoch: 17 cost time: 5.999372959136963
Epoch: 17, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.384 Vali Acc: 0.769 Test Loss: 25.384 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1031s/iter; left time: 1136.6989s
Epoch: 18 cost time: 6.026828289031982
Epoch: 18, Steps: 134 | Train Loss: 0.000 Vali Loss: 25.426 Vali Acc: 0.769 Test Loss: 25.426 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7769015
model size : 29.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7412567138671875
Epoch: 1, Steps: 67 | Train Loss: 8.156 Vali Loss: 9.211 Vali Acc: 0.474 Test Loss: 9.211 Test Acc: 0.474
Validation loss decreased (inf --> -0.473896).  Saving model ...
Epoch: 2 cost time: 2.669210195541382
Epoch: 2, Steps: 67 | Train Loss: 9.837 Vali Loss: 6.339 Vali Acc: 0.607 Test Loss: 6.339 Test Acc: 0.607
Validation loss decreased (-0.473896 --> -0.606873).  Saving model ...
Epoch: 3 cost time: 2.5862956047058105
Epoch: 3, Steps: 67 | Train Loss: 8.024 Vali Loss: 8.667 Vali Acc: 0.676 Test Loss: 8.667 Test Acc: 0.676
Validation loss decreased (-0.606873 --> -0.676214).  Saving model ...
Epoch: 4 cost time: 2.6699674129486084
Epoch: 4, Steps: 67 | Train Loss: 7.734 Vali Loss: 23.902 Vali Acc: 0.636 Test Loss: 23.902 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.611948251724243
Epoch: 5, Steps: 67 | Train Loss: 7.804 Vali Loss: 23.246 Vali Acc: 0.688 Test Loss: 23.246 Test Acc: 0.688
Validation loss decreased (-0.676214 --> -0.687629).  Saving model ...
Epoch: 6 cost time: 2.592496156692505
Epoch: 6, Steps: 67 | Train Loss: 2.714 Vali Loss: 12.166 Vali Acc: 0.728 Test Loss: 12.166 Test Acc: 0.728
Validation loss decreased (-0.687629 --> -0.728202).  Saving model ...
Epoch: 7 cost time: 2.6355109214782715
Epoch: 7, Steps: 67 | Train Loss: 1.919 Vali Loss: 4.566 Vali Acc: 0.850 Test Loss: 4.566 Test Acc: 0.850
Validation loss decreased (-0.728202 --> -0.849665).  Saving model ...
Epoch: 8 cost time: 2.641244649887085
Epoch: 8, Steps: 67 | Train Loss: 1.494 Vali Loss: 12.464 Vali Acc: 0.798 Test Loss: 12.464 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.648242235183716
Epoch: 9, Steps: 67 | Train Loss: 1.727 Vali Loss: 7.720 Vali Acc: 0.809 Test Loss: 7.720 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6139090061187744
Epoch: 10, Steps: 67 | Train Loss: 0.699 Vali Loss: 14.776 Vali Acc: 0.769 Test Loss: 14.776 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.574451446533203
Epoch: 11, Steps: 67 | Train Loss: 0.713 Vali Loss: 6.763 Vali Acc: 0.832 Test Loss: 6.763 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6421499252319336
Epoch: 12, Steps: 67 | Train Loss: 0.323 Vali Loss: 11.923 Vali Acc: 0.821 Test Loss: 11.923 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5938897132873535
Epoch: 13, Steps: 67 | Train Loss: 0.256 Vali Loss: 6.956 Vali Acc: 0.855 Test Loss: 6.956 Test Acc: 0.855
Validation loss decreased (-0.849665 --> -0.855422).  Saving model ...
Epoch: 14 cost time: 2.628105640411377
Epoch: 14, Steps: 67 | Train Loss: 0.152 Vali Loss: 6.779 Vali Acc: 0.821 Test Loss: 6.779 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.652717113494873
Epoch: 15, Steps: 67 | Train Loss: 0.613 Vali Loss: 27.810 Vali Acc: 0.497 Test Loss: 27.810 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5656795501708984
Epoch: 16, Steps: 67 | Train Loss: 1.306 Vali Loss: 22.828 Vali Acc: 0.711 Test Loss: 22.828 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.816406726837158
Epoch: 17, Steps: 67 | Train Loss: 0.181 Vali Loss: 17.073 Vali Acc: 0.763 Test Loss: 17.073 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6234641075134277
Epoch: 18, Steps: 67 | Train Loss: 0.297 Vali Loss: 7.341 Vali Acc: 0.861 Test Loss: 7.341 Test Acc: 0.861
Validation loss decreased (-0.855422 --> -0.861198).  Saving model ...
Epoch: 19 cost time: 2.608916997909546
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.230 Vali Acc: 0.850 Test Loss: 7.230 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.680037498474121
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.245 Vali Acc: 0.850 Test Loss: 7.245 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5919113159179688
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.374 Vali Acc: 0.855 Test Loss: 7.374 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6102235317230225
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.330 Vali Acc: 0.850 Test Loss: 7.330 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.635289430618286
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.273 Vali Acc: 0.850 Test Loss: 7.273 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5703182220458984
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.280 Vali Acc: 0.850 Test Loss: 7.280 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.606109380722046
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.102 Vali Acc: 0.844 Test Loss: 7.102 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.638993501663208
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.165 Vali Acc: 0.844 Test Loss: 7.165 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.541590929031372
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.100 Vali Acc: 0.850 Test Loss: 7.100 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5961310863494873
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 7.088 Vali Acc: 0.850 Test Loss: 7.088 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3886263
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9800331592559814
Epoch: 1, Steps: 67 | Train Loss: 6.730 Vali Loss: 10.482 Vali Acc: 0.416 Test Loss: 10.482 Test Acc: 0.416
Validation loss decreased (inf --> -0.416080).  Saving model ...
Epoch: 2 cost time: 1.9310991764068604
Epoch: 2, Steps: 67 | Train Loss: 8.469 Vali Loss: 4.997 Vali Acc: 0.711 Test Loss: 4.997 Test Acc: 0.711
Validation loss decreased (-0.416080 --> -0.710933).  Saving model ...
Epoch: 3 cost time: 1.9677014350891113
Epoch: 3, Steps: 67 | Train Loss: 9.433 Vali Loss: 8.167 Vali Acc: 0.688 Test Loss: 8.167 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8948829174041748
Epoch: 4, Steps: 67 | Train Loss: 2.344 Vali Loss: 3.292 Vali Acc: 0.792 Test Loss: 3.292 Test Acc: 0.792
Validation loss decreased (-0.710933 --> -0.791875).  Saving model ...
Epoch: 5 cost time: 1.89015531539917
Epoch: 5, Steps: 67 | Train Loss: 1.301 Vali Loss: 2.474 Vali Acc: 0.815 Test Loss: 2.474 Test Acc: 0.815
Validation loss decreased (-0.791875 --> -0.815004).  Saving model ...
Epoch: 6 cost time: 1.9991540908813477
Epoch: 6, Steps: 67 | Train Loss: 2.391 Vali Loss: 18.488 Vali Acc: 0.503 Test Loss: 18.488 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9277081489562988
Epoch: 7, Steps: 67 | Train Loss: 3.667 Vali Loss: 16.366 Vali Acc: 0.676 Test Loss: 16.366 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8839495182037354
Epoch: 8, Steps: 67 | Train Loss: 1.942 Vali Loss: 9.065 Vali Acc: 0.740 Test Loss: 9.065 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0301733016967773
Epoch: 9, Steps: 67 | Train Loss: 1.190 Vali Loss: 29.500 Vali Acc: 0.676 Test Loss: 29.500 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9385671615600586
Epoch: 10, Steps: 67 | Train Loss: 2.277 Vali Loss: 8.348 Vali Acc: 0.717 Test Loss: 8.348 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9681391716003418
Epoch: 11, Steps: 67 | Train Loss: 0.313 Vali Loss: 14.704 Vali Acc: 0.734 Test Loss: 14.704 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.040245532989502
Epoch: 12, Steps: 67 | Train Loss: 0.834 Vali Loss: 10.678 Vali Acc: 0.775 Test Loss: 10.678 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0220279693603516
Epoch: 13, Steps: 67 | Train Loss: 0.035 Vali Loss: 3.488 Vali Acc: 0.855 Test Loss: 3.488 Test Acc: 0.855
Validation loss decreased (-0.815004 --> -0.855456).  Saving model ...
Epoch: 14 cost time: 1.9831950664520264
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.297 Vali Acc: 0.832 Test Loss: 3.297 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8974182605743408
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.318 Vali Acc: 0.832 Test Loss: 3.318 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9581737518310547
Epoch: 16, Steps: 67 | Train Loss: 0.187 Vali Loss: 3.499 Vali Acc: 0.832 Test Loss: 3.499 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9579577445983887
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 6.072 Vali Acc: 0.815 Test Loss: 6.072 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.892592430114746
Epoch: 18, Steps: 67 | Train Loss: 0.190 Vali Loss: 9.737 Vali Acc: 0.734 Test Loss: 9.737 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8961851596832275
Epoch: 19, Steps: 67 | Train Loss: 0.590 Vali Loss: 5.361 Vali Acc: 0.821 Test Loss: 5.361 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8641600608825684
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.322 Vali Acc: 0.821 Test Loss: 5.322 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8989980220794678
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.319 Vali Acc: 0.821 Test Loss: 5.319 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.899167537689209
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.329 Vali Acc: 0.821 Test Loss: 5.329 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0585074424743652
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 5.307 Vali Acc: 0.809 Test Loss: 5.307 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2592039
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1818583011627197
Epoch: 1, Steps: 67 | Train Loss: 5.705 Vali Loss: 10.340 Vali Acc: 0.410 Test Loss: 10.340 Test Acc: 0.410
Validation loss decreased (inf --> -0.410301).  Saving model ...
Epoch: 2 cost time: 1.7149245738983154
Epoch: 2, Steps: 67 | Train Loss: 6.877 Vali Loss: 4.691 Vali Acc: 0.590 Test Loss: 4.691 Test Acc: 0.590
Validation loss decreased (-0.410301 --> -0.589548).  Saving model ...
Epoch: 3 cost time: 1.7624685764312744
Epoch: 3, Steps: 67 | Train Loss: 3.418 Vali Loss: 2.791 Vali Acc: 0.699 Test Loss: 2.791 Test Acc: 0.699
Validation loss decreased (-0.589548 --> -0.699394).  Saving model ...
Epoch: 4 cost time: 1.7427325248718262
Epoch: 4, Steps: 67 | Train Loss: 3.425 Vali Loss: 6.102 Vali Acc: 0.624 Test Loss: 6.102 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.790198564529419
Epoch: 5, Steps: 67 | Train Loss: 1.733 Vali Loss: 8.292 Vali Acc: 0.642 Test Loss: 8.292 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.686737298965454
Epoch: 6, Steps: 67 | Train Loss: 1.648 Vali Loss: 9.132 Vali Acc: 0.682 Test Loss: 9.132 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7462458610534668
Epoch: 7, Steps: 67 | Train Loss: 0.567 Vali Loss: 7.129 Vali Acc: 0.757 Test Loss: 7.129 Test Acc: 0.757
Validation loss decreased (-0.699394 --> -0.757154).  Saving model ...
Epoch: 8 cost time: 1.7014269828796387
Epoch: 8, Steps: 67 | Train Loss: 0.043 Vali Loss: 5.319 Vali Acc: 0.798 Test Loss: 5.319 Test Acc: 0.798
Validation loss decreased (-0.757154 --> -0.797635).  Saving model ...
Epoch: 9 cost time: 1.8588547706604004
Epoch: 9, Steps: 67 | Train Loss: 0.246 Vali Loss: 3.543 Vali Acc: 0.850 Test Loss: 3.543 Test Acc: 0.850
Validation loss decreased (-0.797635 --> -0.849676).  Saving model ...
Epoch: 10 cost time: 1.692084789276123
Epoch: 10, Steps: 67 | Train Loss: 0.681 Vali Loss: 3.366 Vali Acc: 0.815 Test Loss: 3.366 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7884368896484375
Epoch: 11, Steps: 67 | Train Loss: 0.031 Vali Loss: 2.809 Vali Acc: 0.832 Test Loss: 2.809 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7346580028533936
Epoch: 12, Steps: 67 | Train Loss: 0.063 Vali Loss: 3.668 Vali Acc: 0.786 Test Loss: 3.668 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8843073844909668
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.607 Vali Acc: 0.803 Test Loss: 3.607 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.737114667892456
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.838 Test Loss: 2.056 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6992504596710205
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.838 Test Loss: 2.075 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7762551307678223
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.079 Vali Acc: 0.838 Test Loss: 2.079 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7875564098358154
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.827 Test Loss: 2.023 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7977662086486816
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.003 Vali Acc: 0.827 Test Loss: 2.003 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7583446502685547
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.827 Test Loss: 2.001 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1944967
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9822282791137695
Epoch: 1, Steps: 67 | Train Loss: 4.765 Vali Loss: 7.485 Vali Acc: 0.445 Test Loss: 7.485 Test Acc: 0.445
Validation loss decreased (inf --> -0.445012).  Saving model ...
Epoch: 2 cost time: 1.5091447830200195
Epoch: 2, Steps: 67 | Train Loss: 4.605 Vali Loss: 7.141 Vali Acc: 0.549 Test Loss: 7.141 Test Acc: 0.549
Validation loss decreased (-0.445012 --> -0.549062).  Saving model ...
Epoch: 3 cost time: 1.5847108364105225
Epoch: 3, Steps: 67 | Train Loss: 2.888 Vali Loss: 7.661 Vali Acc: 0.613 Test Loss: 7.661 Test Acc: 0.613
Validation loss decreased (-0.549062 --> -0.612640).  Saving model ...
Epoch: 4 cost time: 1.5492658615112305
Epoch: 4, Steps: 67 | Train Loss: 0.961 Vali Loss: 2.873 Vali Acc: 0.746 Test Loss: 2.873 Test Acc: 0.746
Validation loss decreased (-0.612640 --> -0.745636).  Saving model ...
Epoch: 5 cost time: 1.7175288200378418
Epoch: 5, Steps: 67 | Train Loss: 0.783 Vali Loss: 8.287 Vali Acc: 0.584 Test Loss: 8.287 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5682928562164307
Epoch: 6, Steps: 67 | Train Loss: 0.636 Vali Loss: 6.879 Vali Acc: 0.734 Test Loss: 6.879 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6017751693725586
Epoch: 7, Steps: 67 | Train Loss: 1.418 Vali Loss: 9.155 Vali Acc: 0.699 Test Loss: 9.155 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6301391124725342
Epoch: 8, Steps: 67 | Train Loss: 0.123 Vali Loss: 3.623 Vali Acc: 0.792 Test Loss: 3.623 Test Acc: 0.792
Validation loss decreased (-0.745636 --> -0.791871).  Saving model ...
Epoch: 9 cost time: 1.8956615924835205
Epoch: 9, Steps: 67 | Train Loss: 0.301 Vali Loss: 6.514 Vali Acc: 0.769 Test Loss: 6.514 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.601557970046997
Epoch: 10, Steps: 67 | Train Loss: 0.120 Vali Loss: 4.138 Vali Acc: 0.803 Test Loss: 4.138 Test Acc: 0.803
Validation loss decreased (-0.791871 --> -0.803427).  Saving model ...
Epoch: 11 cost time: 1.7957344055175781
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 4.200 Vali Acc: 0.798 Test Loss: 4.200 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9839963912963867
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.894 Vali Acc: 0.809 Test Loss: 3.894 Test Acc: 0.809
Validation loss decreased (-0.803427 --> -0.809210).  Saving model ...
Epoch: 13 cost time: 1.6967413425445557
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.673 Vali Acc: 0.809 Test Loss: 3.673 Test Acc: 0.809
Validation loss decreased (-0.809210 --> -0.809212).  Saving model ...
Epoch: 14 cost time: 1.9250154495239258
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.650 Vali Acc: 0.809 Test Loss: 3.650 Test Acc: 0.809
Validation loss decreased (-0.809212 --> -0.809212).  Saving model ...
Epoch: 15 cost time: 1.8520786762237549
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.656 Vali Acc: 0.809 Test Loss: 3.656 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7818865776062012
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.661 Vali Acc: 0.809 Test Loss: 3.661 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2049190998077393
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.589 Vali Acc: 0.809 Test Loss: 3.589 Test Acc: 0.809
Validation loss decreased (-0.809212 --> -0.809213).  Saving model ...
Epoch: 18 cost time: 1.6100430488586426
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.602 Vali Acc: 0.809 Test Loss: 3.602 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0023598670959473
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.611 Vali Acc: 0.809 Test Loss: 3.611 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9728045463562012
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.590 Vali Acc: 0.809 Test Loss: 3.590 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.119455575942993
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.809 Test Loss: 3.601 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5907888412475586
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.761 Vali Acc: 0.827 Test Loss: 2.761 Test Acc: 0.827
Validation loss decreased (-0.809213 --> -0.826562).  Saving model ...
Epoch: 23 cost time: 4.381177186965942
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.726 Vali Acc: 0.827 Test Loss: 2.726 Test Acc: 0.827
Validation loss decreased (-0.826562 --> -0.826562).  Saving model ...
Epoch: 24 cost time: 5.436756372451782
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.758 Vali Acc: 0.827 Test Loss: 2.758 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.8110857009887695
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.741 Vali Acc: 0.827 Test Loss: 2.741 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.7939655780792236
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.750 Vali Acc: 0.827 Test Loss: 2.750 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.4553298950195312
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.740 Vali Acc: 0.827 Test Loss: 2.740 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.425868272781372
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.744 Vali Acc: 0.827 Test Loss: 2.744 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.271432638168335
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.742 Vali Acc: 0.827 Test Loss: 2.742 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.318769454956055
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.827 Test Loss: 2.694 Test Acc: 0.827
Validation loss decreased (-0.826562 --> -0.826563).  Saving model ...
Epoch: 31 cost time: 5.441681861877441
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.827 Test Loss: 2.702 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.386843204498291
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.691 Vali Acc: 0.827 Test Loss: 2.691 Test Acc: 0.827
Validation loss decreased (-0.826563 --> -0.826563).  Saving model ...
Epoch: 33 cost time: 5.367387056350708
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.702 Vali Acc: 0.827 Test Loss: 2.702 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.4192211627960205
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.683 Vali Acc: 0.827 Test Loss: 2.683 Test Acc: 0.827
Validation loss decreased (-0.826563 --> -0.826563).  Saving model ...
Epoch: 35 cost time: 3.5561447143554688
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.692 Vali Acc: 0.827 Test Loss: 2.692 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.9716687202453613
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.706 Vali Acc: 0.827 Test Loss: 2.706 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.0382297039031982
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.689 Vali Acc: 0.827 Test Loss: 2.689 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.8630239963531494
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.827 Test Loss: 2.696 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.547709226608276
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.827 Test Loss: 2.694 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.786633491516113
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.696 Vali Acc: 0.827 Test Loss: 2.696 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 5.4127795696258545
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.697 Vali Acc: 0.827 Test Loss: 2.697 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 5.252799034118652
Epoch: 42, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.827 Test Loss: 2.700 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.684523582458496
Epoch: 43, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.699 Vali Acc: 0.827 Test Loss: 2.699 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.96284031867981
Epoch: 44, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.699 Vali Acc: 0.827 Test Loss: 2.699 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1405799
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.174849271774292
Epoch: 1, Steps: 67 | Train Loss: 3.531 Vali Loss: 6.092 Vali Acc: 0.312 Test Loss: 6.092 Test Acc: 0.312
Validation loss decreased (inf --> -0.312078).  Saving model ...
Epoch: 2 cost time: 3.8293514251708984
Epoch: 2, Steps: 67 | Train Loss: 2.246 Vali Loss: 5.304 Vali Acc: 0.572 Test Loss: 5.304 Test Acc: 0.572
Validation loss decreased (-0.312078 --> -0.572201).  Saving model ...
Epoch: 3 cost time: 3.1051180362701416
Epoch: 3, Steps: 67 | Train Loss: 1.458 Vali Loss: 2.154 Vali Acc: 0.694 Test Loss: 2.154 Test Acc: 0.694
Validation loss decreased (-0.572201 --> -0.693620).  Saving model ...
Epoch: 4 cost time: 3.3130109310150146
Epoch: 4, Steps: 67 | Train Loss: 0.395 Vali Loss: 2.361 Vali Acc: 0.682 Test Loss: 2.361 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.379798412322998
Epoch: 5, Steps: 67 | Train Loss: 0.448 Vali Loss: 7.513 Vali Acc: 0.607 Test Loss: 7.513 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.923967599868774
Epoch: 6, Steps: 67 | Train Loss: 0.900 Vali Loss: 3.290 Vali Acc: 0.740 Test Loss: 3.290 Test Acc: 0.740
Validation loss decreased (-0.693620 --> -0.739851).  Saving model ...
Epoch: 7 cost time: 3.691725015640259
Epoch: 7, Steps: 67 | Train Loss: 0.075 Vali Loss: 4.053 Vali Acc: 0.775 Test Loss: 4.053 Test Acc: 0.775
Validation loss decreased (-0.739851 --> -0.774526).  Saving model ...
Epoch: 8 cost time: 4.135793447494507
Epoch: 8, Steps: 67 | Train Loss: 0.131 Vali Loss: 2.242 Vali Acc: 0.815 Test Loss: 2.242 Test Acc: 0.815
Validation loss decreased (-0.774526 --> -0.815006).  Saving model ...
Epoch: 9 cost time: 3.322552442550659
Epoch: 9, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.809 Test Loss: 1.612 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.303583860397339
Epoch: 10, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.809 Test Loss: 1.510 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6007602214813232
Epoch: 11, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.815 Test Loss: 1.386 Test Acc: 0.815
Validation loss decreased (-0.815006 --> -0.815015).  Saving model ...
Epoch: 12 cost time: 2.328324794769287
Epoch: 12, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.821 Test Loss: 1.298 Test Acc: 0.821
Validation loss decreased (-0.815015 --> -0.820796).  Saving model ...
Epoch: 13 cost time: 2.428366184234619
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.299 Vali Acc: 0.821 Test Loss: 1.299 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.281986713409424
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.821 Test Loss: 1.302 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.8089213371276855
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.298 Vali Acc: 0.821 Test Loss: 1.298 Test Acc: 0.821
Validation loss decreased (-0.820796 --> -0.820796).  Saving model ...
Epoch: 16 cost time: 3.2008402347564697
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.821 Test Loss: 1.301 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.297275066375732
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.280 Vali Acc: 0.821 Test Loss: 1.280 Test Acc: 0.821
Validation loss decreased (-0.820796 --> -0.820796).  Saving model ...
Epoch: 18 cost time: 3.2811005115509033
Epoch: 18, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.283 Vali Acc: 0.815 Test Loss: 1.283 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2199389934539795
Epoch: 19, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.262 Vali Acc: 0.815 Test Loss: 1.262 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8362019062042236
Epoch: 20, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.815 Test Loss: 1.253 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.529841184616089
Epoch: 21, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.207 Vali Acc: 0.821 Test Loss: 1.207 Test Acc: 0.821
Validation loss decreased (-0.820796 --> -0.820797).  Saving model ...
Epoch: 22 cost time: 5.266238451004028
Epoch: 22, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.815 Test Loss: 1.215 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.18538498878479
Epoch: 23, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.208 Vali Acc: 0.821 Test Loss: 1.208 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.564085483551025
Epoch: 24, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.821 Test Loss: 1.205 Test Acc: 0.821
Validation loss decreased (-0.820797 --> -0.820797).  Saving model ...
Epoch: 25 cost time: 4.290642738342285
Epoch: 25, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.221 Vali Acc: 0.821 Test Loss: 1.221 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.553348541259766
Epoch: 26, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.815 Test Loss: 1.204 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2771458625793457
Epoch: 27, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.815 Test Loss: 1.189 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.9211835861206055
Epoch: 28, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.815 Test Loss: 1.181 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.257113218307495
Epoch: 29, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.815 Test Loss: 1.182 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6462326049804688
Epoch: 30, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.177 Vali Acc: 0.815 Test Loss: 1.177 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.246032238006592
Epoch: 31, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.821 Test Loss: 1.190 Test Acc: 0.821
Validation loss decreased (-0.820797 --> -0.820797).  Saving model ...
Epoch: 32 cost time: 5.076341867446899
Epoch: 32, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.815 Test Loss: 1.190 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.3421413898468018
Epoch: 33, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.815 Test Loss: 1.183 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.01501202583313
Epoch: 34, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.815 Test Loss: 1.184 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.9762589931488037
Epoch: 35, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.815 Test Loss: 1.184 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.2363619804382324
Epoch: 36, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.815 Test Loss: 1.183 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.2217648029327393
Epoch: 37, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.815 Test Loss: 1.179 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.8464083671569824
Epoch: 38, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.815 Test Loss: 1.184 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.160170793533325
Epoch: 39, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.815 Test Loss: 1.187 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1238627433776855
Epoch: 40, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.815 Test Loss: 1.191 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.917210817337036
Epoch: 41, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.815 Test Loss: 1.195 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 974487
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.357547283172607
Epoch: 1, Steps: 67 | Train Loss: 2.824 Vali Loss: 1.949 Vali Acc: 0.590 Test Loss: 1.949 Test Acc: 0.590
Validation loss decreased (inf --> -0.589576).  Saving model ...
Epoch: 2 cost time: 4.674743413925171
Epoch: 2, Steps: 67 | Train Loss: 3.242 Vali Loss: 4.388 Vali Acc: 0.549 Test Loss: 4.388 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2671895027160645
Epoch: 3, Steps: 67 | Train Loss: 1.757 Vali Loss: 3.067 Vali Acc: 0.647 Test Loss: 3.067 Test Acc: 0.647
Validation loss decreased (-0.589576 --> -0.647368).  Saving model ...
Epoch: 4 cost time: 4.129081964492798
Epoch: 4, Steps: 67 | Train Loss: 0.338 Vali Loss: 1.110 Vali Acc: 0.792 Test Loss: 1.110 Test Acc: 0.792
Validation loss decreased (-0.647368 --> -0.791896).  Saving model ...
Epoch: 5 cost time: 2.532031774520874
Epoch: 5, Steps: 67 | Train Loss: 0.416 Vali Loss: 1.597 Vali Acc: 0.792 Test Loss: 1.597 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6873340606689453
Epoch: 6, Steps: 67 | Train Loss: 0.171 Vali Loss: 2.701 Vali Acc: 0.757 Test Loss: 2.701 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7042198181152344
Epoch: 7, Steps: 67 | Train Loss: 0.130 Vali Loss: 1.299 Vali Acc: 0.861 Test Loss: 1.299 Test Acc: 0.861
Validation loss decreased (-0.791896 --> -0.861259).  Saving model ...
Epoch: 8 cost time: 4.464115858078003
Epoch: 8, Steps: 67 | Train Loss: 0.084 Vali Loss: 2.322 Vali Acc: 0.775 Test Loss: 2.322 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.937133312225342
Epoch: 9, Steps: 67 | Train Loss: 0.063 Vali Loss: 2.705 Vali Acc: 0.786 Test Loss: 2.705 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5005459785461426
Epoch: 10, Steps: 67 | Train Loss: 0.066 Vali Loss: 3.670 Vali Acc: 0.763 Test Loss: 3.670 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.3274245262145996
Epoch: 11, Steps: 67 | Train Loss: 0.035 Vali Loss: 2.017 Vali Acc: 0.827 Test Loss: 2.017 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8639068603515625
Epoch: 12, Steps: 67 | Train Loss: 0.070 Vali Loss: 3.008 Vali Acc: 0.803 Test Loss: 3.008 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.917351007461548
Epoch: 13, Steps: 67 | Train Loss: 0.000 Vali Loss: 2.831 Vali Acc: 0.809 Test Loss: 2.831 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7920515537261963
Epoch: 14, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.827 Test Loss: 1.911 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.289851903915405
Epoch: 15, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.827 Test Loss: 1.916 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.23154354095459
Epoch: 16, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.827 Test Loss: 1.896 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.8360893726348877
Epoch: 17, Steps: 67 | Train Loss: 0.000 Vali Loss: 1.912 Vali Acc: 0.827 Test Loss: 1.912 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 866743
model size : 3.62MB
